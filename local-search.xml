<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>LeetCode 114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</title>
    <link href="/2020/11/25/LeetCode-114-flatten-binary-tree-to-linked-list/"/>
    <url>/2020/11/25/LeetCode-114-flatten-binary-tree-to-linked-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/flatten-binary-tree-to-linked-list/" target="_blank" rel="noopener">114. äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">flatten</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    dfs(root);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    TreeNode right = dfs(root.right);    TreeNode left = dfs(root.left);    <span class="hljs-keyword">if</span> (left != <span class="hljs-keyword">null</span>) &#123;        TreeNode tail = left;        <span class="hljs-comment">// æ‰¾åˆ°å·¦å­æ ‘çš„å°¾éƒ¨</span>        <span class="hljs-keyword">while</span> (tail.right != <span class="hljs-keyword">null</span>) &#123;            tail = tail.right;        &#125;        <span class="hljs-comment">// è¿ä¸Šå³å­æ ‘</span>        tail.right = right;        <span class="hljs-comment">// å·¦å­æ ‘è¿åˆ° root</span>        root.right = left;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// å·¦å­æ ‘ä¸ºç©ºï¼Œroot ç›´æ¥è¿ å³å­æ ‘</span>        root.right = right;    &#125;    <span class="hljs-comment">// å·¦å­æ ‘æ–­å¼€</span>    root.left = <span class="hljs-keyword">null</span>;    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1370. ä¸Šå‡ä¸‹é™å­—ç¬¦ä¸²</title>
    <link href="/2020/11/25/LeetCode-1370-increasing-decreasing-string/"/>
    <url>/2020/11/25/LeetCode-1370-increasing-decreasing-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/increasing-decreasing-string/" target="_blank" rel="noopener">1370. ä¸Šå‡ä¸‹é™å­—ç¬¦ä¸²</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">sortString</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] str = s.toCharArray();    <span class="hljs-keyword">int</span> len = str.length;    <span class="hljs-keyword">int</span>[] count = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : str) &#123;        count[c - <span class="hljs-string">'a'</span>]++;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">int</span> used = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (used &lt; len) &#123;        <span class="hljs-comment">// ä»å‰å¾€åå–</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++) &#123;            <span class="hljs-keyword">if</span> (count[i] &gt; <span class="hljs-number">0</span>) &#123;                count[i]--;                used++;                sb.append((<span class="hljs-keyword">char</span>) (i + <span class="hljs-string">'a'</span>));            &#125;        &#125;        <span class="hljs-comment">// ä»åå¾€å‰å–</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">25</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;            <span class="hljs-keyword">if</span> (count[i] &gt; <span class="hljs-number">0</span>) &#123;                count[i]--;                used++;                sb.append((<span class="hljs-keyword">char</span>) (i + <span class="hljs-string">'a'</span>));            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring AOP å®ç°</title>
    <link href="/2020/11/25/spring-aop-implementation/"/>
    <url>/2020/11/25/spring-aop-implementation/</url>
    
    <content type="html"><![CDATA[<blockquote><p><code>ApplicationContext</code> åŠ è½½å®Œ <code>Bean</code> åï¼Œå…ˆå®ä¾‹åŒ– <code>BeanPostProcessor</code>ï¼Œç„¶åç”± <code>BeanFactory#getBean()</code> å®ä¾‹åŒ–æ™®é€š <code>Bean</code>ï¼Œé€šè¿‡ <code>bean = postProcessAfterInitialization(bean, beanName)</code> å®ç° AOP æ¤å…¥ã€‚</p></blockquote><h1 id="æ€»ä½“æµç¨‹"><a class="markdownIt-Anchor" href="#æ€»ä½“æµç¨‹"></a> æ€»ä½“æµç¨‹</h1><ol><li><p><code>ApplicationContext</code> å®Œæˆäº†ç±»å®šä¹‰çš„è¯»å–å’ŒåŠ è½½ï¼Œå¹¶æ³¨å†Œåˆ° <code>BeanFactory</code> ä¸­å»ã€‚</p></li><li><p><code>ApplicationContext</code> ä» <code>BeanFactory</code> ä¸­å¯»æ‰¾ <code>BeanPostProcessor</code>ï¼Œæ³¨å†Œåˆ° <code>BeanFactory</code><br />ç»´æŠ¤çš„ <code>BeanPostProcessor</code> åˆ—è¡¨ä¸­å»ã€‚</p></li><li><p><code>ApplicationContext</code> ä»¥å•ä¾‹çš„æ¨¡å¼ï¼Œé€šè¿‡ä¸»åŠ¨è°ƒç”¨ <code>getBean</code> å®ä¾‹åŒ–ã€æ³¨å…¥å±æ€§ã€ç„¶ååˆå§‹åŒ– <code>BeanFactory</code> ä¸­æ‰€æœ‰çš„ <code>Bean</code>ã€‚ç”±äºæ‰€æœ‰çš„ <code>BeanPostProcessor</code> éƒ½å·²ç»åœ¨ç¬¬ 2 æ­¥ä¸­å®Œæˆå®ä¾‹åŒ–äº†ï¼Œå› æ­¤æ¥ä¸‹æ¥å®ä¾‹åŒ–çš„æ˜¯æ™®é€š <code>Bean</code>ï¼Œå› æ­¤æ™®é€š <code>Bean</code> çš„åˆå§‹åŒ–è¿‡ç¨‹å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚</p></li><li><p>è°ƒç”¨ <code>getBean</code> æ—¶ï¼Œå§”æ‰˜ç»™ <code>BeanFactory</code>ï¼Œæ­¤æ—¶åªæ˜¯ç®€å•çš„è¿”å›æ¯ä¸ª <code>Bean</code> å•ä¾‹ï¼Œå› ä¸ºæ‰€æœ‰çš„ <code>Bean</code> å®ä¾‹åœ¨ç¬¬ä¸‰æ­¥éƒ½å·²ç»ç”Ÿæˆäº†ã€‚</p></li></ol><h1 id="é‡æ–°åˆ†æ-ioc-å®¹å™¨"><a class="markdownIt-Anchor" href="#é‡æ–°åˆ†æ-ioc-å®¹å™¨"></a> é‡æ–°åˆ†æ IoC å®¹å™¨</h1><h2 id="applicationcontext-çš„æ„é€ å’Œæ‰§è¡Œ"><a class="markdownIt-Anchor" href="#applicationcontext-çš„æ„é€ å’Œæ‰§è¡Œ"></a> <code>ApplicationContext</code> çš„æ„é€ å’Œæ‰§è¡Œ</h2><p><code>ApplicationContext</code> çš„æ ¸å¿ƒæ–¹æ³•æ˜¯ <code>refresh()</code> æ–¹æ³•ï¼Œç”¨äºä»èµ„æºæ–‡ä»¶åŠ è½½ç±»å®šä¹‰ã€æ‰©å±•å®¹å™¨çš„åŠŸèƒ½ã€‚</p><p><a href="https://github.com/LikaiLee/tiny-spring/blob/1e4aa9a589fd57956f9135b06aa8da5b472f9ff2/src/main/java/site/likailee/spring/context/AbstractApplicationContext.java#L29" target="_blank" rel="noopener"><code>refresh</code> çš„æµç¨‹</a>ï¼š</p><ol><li><p><code>loadBeanDefinitions(BeanFactory)</code>ï¼šåŠ è½½ç±»å®šä¹‰ï¼Œå¹¶æ³¨å…¥åˆ°å†…ç½®çš„ <code>BeanFactory</code> ä¸­ï¼Œè¿™é‡Œçš„å¯æ‰©å±•æ€§åœ¨äºï¼Œæœªå¯¹åŠ è½½æ–¹æ³•è¿›è¡Œè¦æ±‚ï¼Œä¹Ÿå°±æ˜¯åŠ è½½æ–¹æ³•ç”±å­ç±»å®ç°ï¼Œå¯ä»¥ä»ä¸åŒæ¥æºçš„ä¸åŒç±»å‹çš„èµ„æºè¿›è¡ŒåŠ è½½ã€‚</p></li><li><p><code>registerBeanPostProcessors(BeanFactory)</code>ï¼šè·å–æ‰€æœ‰çš„ <code>BeanPostProcessor</code>ï¼Œå¹¶æ³¨å†Œåˆ° <code>BeanFactory</code> ç»´æŠ¤çš„ <code>BeanPostProcessor</code> åˆ—è¡¨å»ã€‚</p></li><li><p><code>onRefresh</code>ï¼š</p><ul><li><code>preInstantiateSingletons</code> ï¼šä»¥å•ä¾‹çš„æ–¹å¼ï¼Œåˆå§‹åŒ–æ‰€æœ‰ Beanã€‚</li></ul></li></ol><h2 id="beanfactory-çš„æ„é€ ä¸æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#beanfactory-çš„æ„é€ ä¸æ‰§è¡Œ"></a> <code>BeanFactory</code> çš„æ„é€ ä¸æ‰§è¡Œ</h2><p><code>BeanFactory</code> çš„æ ¸å¿ƒæ–¹æ³•æ˜¯ <code>getBean(String)</code> æ–¹æ³•ï¼Œç”¨äºä»å·¥å‚ä¸­å–å‡ºæ‰€éœ€è¦çš„ <code>Bean</code>ã€‚<code>AbstractBeanFactory</code> è§„å®šäº†åŸºæœ¬çš„æ„é€ å’Œæ‰§è¡Œæµç¨‹ã€‚</p><p><a href="https://github.com/LikaiLee/tiny-spring/blob/1e4aa9a589fd57956f9135b06aa8da5b472f9ff2/src/main/java/site/likailee/spring/ioc/factory/AbstractBeanFactory.java#L26" target="_blank" rel="noopener"><code>getBean</code> çš„æµç¨‹</a>ï¼šåŒ…æ‹¬å®ä¾‹åŒ–å’Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆ <code>Bean</code>ï¼Œå†æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚</p><ol><li><p><code>doCreateBean</code>ï¼šå®ä¾‹åŒ– <code>Bean</code>ã€‚</p><ul><li><code>createInstance</code>ï¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</li><li><code>applyProperties</code>ï¼šæ³¨å…¥å±æ€§ï¼ŒåŒ…æ‹¬ä¾èµ–æ³¨å…¥çš„è¿‡ç¨‹ã€‚åœ¨ä¾èµ–æ³¨å…¥çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ <code>Bean</code> å®ç°äº† <code>BeanFactoryAware</code> æ¥å£ï¼Œåˆ™å°†å®¹å™¨çš„å¼•ç”¨ä¼ å…¥åˆ° <code>Bean</code> ä¸­å»ï¼Œè¿™æ ·ï¼Œ<code>Bean</code> å°†è·å–å¯¹å®¹å™¨æ“ä½œçš„æƒé™ï¼Œä¹Ÿå°±å…è®¸äº† <strong>ç¼–å†™æ‰©å±• IoC å®¹å™¨</strong> çš„åŠŸèƒ½çš„ <code>Bean</code>ã€‚</li></ul></li><li><p><code>initializeBean(bean)</code>ï¼š åˆå§‹åŒ– <code>Bean</code>ã€‚</p><ul><li>ä» <code>BeanPostProcessor</code> åˆ—è¡¨ä¸­ï¼Œä¾æ¬¡å–å‡º <code>BeanPostProcessor</code> æ‰§è¡Œ <code>bean = postProcessBeforeInitialization(bean,beanName)</code>ã€‚</li><li>ä» <code>BeanPostProcessor</code> åˆ—è¡¨ä¸­ï¼Œ ä¾æ¬¡å–å‡º <code>BeanPostProcessor</code> æ‰§è¡Œå…¶ <code>bean = postProcessAfterInitialization(bean, beanName)</code>ã€‚åœ¨è¿™é‡Œè¿”å›äº†ä¸€ä¸ª <code>Bean</code>ï¼Œå°±å¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å®ç° <code>AOP</code> ä»£ç†ï¼Œ<strong>è¿”å›ä»£ç†åçš„å¯¹è±¡</strong>ã€‚</li></ul></li></ol><h1 id="aop-çš„æ¤å…¥ä¸å®ç°ç»†èŠ‚"><a class="markdownIt-Anchor" href="#aop-çš„æ¤å…¥ä¸å®ç°ç»†èŠ‚"></a> AOP çš„æ¤å…¥ä¸å®ç°ç»†èŠ‚</h1><h2 id="åœ¨-bean-åˆå§‹åŒ–è¿‡ç¨‹ä¸­å®Œæˆ-aop-çš„æ¤å…¥"><a class="markdownIt-Anchor" href="#åœ¨-bean-åˆå§‹åŒ–è¿‡ç¨‹ä¸­å®Œæˆ-aop-çš„æ¤å…¥"></a> åœ¨ <code>Bean</code> åˆå§‹åŒ–è¿‡ç¨‹ä¸­å®Œæˆ <code>AOP</code> çš„æ¤å…¥</h2><p>è§£å†³ <code>AOP</code> çš„æ¤å…¥é—®é¢˜ï¼Œé¦–å…ˆè¦è§£å†³ <strong>åœ¨ <code>IoC</code> å®¹å™¨çš„ä½•å¤„æ¤å…¥ AOP</strong> çš„é—®é¢˜ï¼Œå…¶æ¬¡è¦è§£å†³ <strong>ä¸ºå“ªäº›å¯¹è±¡æä¾› <code>AOP</code> çš„æ¤å…¥</strong> çš„é—®é¢˜ã€‚<br /><code>tiny-spring</code> ä¸­ <code>AspectJAwareAdvisorAutoProxyCreator</code> ç±»ï¼ˆä»¥ä¸‹ç®€ç§° <code>AutoProxyCreator</code>ï¼‰æ˜¯å®ç° <code>AOP</code> æ¤å…¥çš„å…³é”®ç±»ï¼Œå®ƒå®ç°äº†ä¸¤ä¸ªæ¥å£ï¼š</p><ol><li><code>BeanPostProcessor</code>ï¼šåœ¨ <code>postProcessorAfterInitialization</code> æ–¹æ³•ä¸­ï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†çš„æ–¹å¼ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡çš„ä»£ç†å¯¹è±¡ã€‚è§£å†³äº† <strong>åœ¨ <code>IoC</code> å®¹å™¨çš„ä½•å¤„æ¤å…¥ AOP</strong> çš„é—®é¢˜ã€‚</li><li><code>BeanFactoryAware</code>ï¼šè¿™ä¸ªæ¥å£æä¾›äº†å¯¹ <code>BeanFactory</code> çš„æ„ŸçŸ¥ï¼Œè¿™æ ·ï¼Œå°½ç®¡å®ƒæ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ª <code>Bean</code>ï¼Œåœ¨å®ä¾‹åŒ–æ—¶å´å¯ä»¥è·å–å®¹å™¨çš„å¼•ç”¨ï¼Œè¿›è€Œè·å–å®¹å™¨ä¸­æ‰€æœ‰çš„åˆ‡ç‚¹å¯¹è±¡ï¼Œå†³å®šå¯¹å“ªäº›å¯¹è±¡çš„å“ªäº›æ–¹æ³•è¿›è¡Œä»£ç†ã€‚è§£å†³äº† <strong>ä¸ºå“ªäº›å¯¹è±¡æä¾› <code>AOP</code> çš„æ¤å…¥</strong> çš„é—®é¢˜ã€‚</li></ol><h2 id="aop-ä¸­åŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤"><a class="markdownIt-Anchor" href="#aop-ä¸­åŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤"></a> AOP ä¸­åŠ¨æ€ä»£ç†çš„å®ç°æ­¥éª¤</h2><h3 id="åŠ¨æ€ä»£ç†çš„å†…å®¹"><a class="markdownIt-Anchor" href="#åŠ¨æ€ä»£ç†çš„å†…å®¹"></a> åŠ¨æ€ä»£ç†çš„å†…å®¹</h3><p>é¦–å…ˆï¼Œè¦çŸ¥é“åŠ¨æ€ä»£ç†çš„å†…å®¹ï¼ˆæ‹¦æˆªå“ªä¸ªå¯¹è±¡ã€åœ¨å“ªä¸ªæ–¹æ³•æ‹¦æˆªã€æ‹¦æˆªå…·ä½“å†…å®¹ï¼‰ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªå…³é”®çš„ç±»ï¼š</p><table><thead><tr><th>ç±»å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>PointcutAdvisor</code></td><td>åˆ‡ç‚¹é€šçŸ¥å™¨ï¼Œç”¨äºæä¾› <strong>å¯¹å“ªä¸ªå¯¹è±¡çš„å“ªä¸ªæ–¹æ³•è¿›è¡Œä»€ä¹ˆæ ·çš„æ‹¦æˆª</strong> çš„å…·ä½“å†…å®¹ã€‚é€šè¿‡å®ƒå¯ä»¥è·å–ä¸€ä¸ªåˆ‡ç‚¹å¯¹è±¡ <code>Pointcut</code> å’Œä¸€ä¸ªé€šçŸ¥å™¨å¯¹è±¡ <code>Advisor</code>ã€‚</td></tr><tr><td><code>Pointcut</code></td><td>åˆ‡ç‚¹å¯¹è±¡å¯ä»¥è·å–ä¸€ä¸ª <code>ClassFilter</code> å¯¹è±¡å’Œä¸€ä¸ª <code>MethodMatcher</code> å¯¹è±¡ã€‚å‰è€…ç”¨äºåˆ¤æ–­æ˜¯å¦å¯¹æŸä¸ªå¯¹è±¡è¿›è¡Œæ‹¦æˆªï¼ˆç”¨äº <strong>ç­›é€‰è¦ä»£ç†çš„ç›®æ ‡å¯¹è±¡</strong>ï¼‰ï¼Œåè€…ç”¨äºåˆ¤æ–­æ˜¯å¦å¯¹æŸä¸ªæ–¹æ³•è¿›è¡Œæ‹¦æˆªï¼ˆç”¨äº <strong>åœ¨ä»£ç†å¯¹è±¡ä¸­å¯¹ä¸åŒçš„æ–¹æ³•è¿›è¡Œä¸åŒçš„æ“ä½œ</strong>ï¼‰ã€‚</td></tr><tr><td><code>Advisor</code></td><td>é€šçŸ¥å™¨å¯¹è±¡å¯ä»¥è·å–ä¸€ä¸ªé€šçŸ¥å¯¹è±¡ <code>Advice</code> ã€‚å°±æ˜¯ç”¨äºå®ç° <strong>å…·ä½“çš„æ–¹æ³•æ‹¦æˆª</strong>ï¼Œéœ€è¦ä½¿ç”¨è€…ç¼–å†™ï¼Œä¹Ÿå°±å¯¹åº”äº† Spring ä¸­çš„å‰ç½®é€šçŸ¥ã€åç½®é€šçŸ¥ã€ç¯åˆ‡é€šçŸ¥ç­‰ã€‚</td></tr></tbody></table><h3 id="åŠ¨æ€ä»£ç†çš„æ­¥éª¤"><a class="markdownIt-Anchor" href="#åŠ¨æ€ä»£ç†çš„æ­¥éª¤"></a> åŠ¨æ€ä»£ç†çš„æ­¥éª¤</h3><p><a href="https://github.com/LikaiLee/tiny-spring/blob/1e4aa9a589fd57956f9135b06aa8da5b472f9ff2/src/main/java/site/likailee/spring/aop/advisor/AspectJAwareAdvisorAutoProxyCreator.java#L39" target="_blank" rel="noopener">å…·ä½“æ­¥éª¤</a></p><ol><li><code>AutoProxyCreator</code>ï¼ˆå®ç°äº† <code>BeanPostProcessor</code> æ¥å£ï¼‰åœ¨å®ä¾‹åŒ–æ‰€æœ‰çš„ <code>Bean</code> å‰ï¼Œæœ€å…ˆè¢«å®ä¾‹åŒ–ã€‚</li><li>å…¶ä»–æ™®é€š <code>Bean</code> è¢«å®ä¾‹åŒ–ã€åˆå§‹åŒ–ï¼Œåœ¨ <code>initializeBean(bean)</code> çš„è¿‡ç¨‹ä¸­ï¼Œ<code>AutoProxyCreator</code> åŠ è½½ <code>BeanFactory</code> ä¸­æ‰€æœ‰çš„ <code>PointcutAdvisor</code>ï¼ˆè¿™ä¹Ÿä¿è¯äº† <code>PointcutAdvisor</code> çš„å®ä¾‹åŒ–é¡ºåºä¼˜äºæ™®é€š <code>Bean</code>ã€‚ï¼‰ï¼Œç„¶åä¾æ¬¡ä½¿ç”¨ <code>PointcutAdvisor</code> å†…ç½®çš„ <code>ClassFilter</code>ï¼Œåˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯ä¸æ˜¯è¦æ‹¦æˆªçš„ç±»ã€‚</li><li>å¦‚æœæ˜¯ï¼Œåˆ™ç”Ÿæˆä¸€ä¸ª <code>TargetSource</code>ï¼ˆè¦æ‹¦æˆªçš„å¯¹è±¡å’Œå…¶ç±»å‹ï¼‰ï¼Œå¹¶å–å‡º <code>AutoProxyCreator</code> çš„ <code>MethodMatcher</code>ï¼ˆå¯¹å“ªäº›æ–¹æ³•è¿›è¡Œæ‹¦æˆªï¼‰ã€<code>Advice</code>ï¼ˆæ‹¦æˆªçš„å…·ä½“æ“ä½œï¼‰ï¼Œå†äº¤ç»™ <code>AopProxy</code> å»ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚</li><li><code>AopProxy</code> ç”Ÿæˆä¸€ä¸ª <code>InvocationHandler</code>ï¼Œåœ¨å®ƒçš„ <code>invoke</code> å‡½æ•°ä¸­ï¼Œé¦–å…ˆä½¿ç”¨ <code>MethodMatcher</code> åˆ¤æ–­æ˜¯ä¸æ˜¯è¦æ‹¦æˆªçš„æ–¹æ³•ï¼Œå¦‚æœæ˜¯åˆ™äº¤ç»™ <code>Advice</code> æ¥æ‰§è¡Œï¼ˆ<code>Advice</code> ç”±ç”¨æˆ·æ¥ç¼–å†™ï¼Œå…¶ä¸­ä¹Ÿè¦æ‰‹åŠ¨/è‡ªåŠ¨è°ƒç”¨åŸå§‹å¯¹è±¡çš„æ–¹æ³•ï¼‰ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥äº¤ç»™ <code>TargetSource</code> çš„åŸå§‹å¯¹è±¡æ¥æ‰§è¡Œã€‚</li></ol><h1 id="è®¾è®¡æ¨¡å¼"><a class="markdownIt-Anchor" href="#è®¾è®¡æ¨¡å¼"></a> è®¾è®¡æ¨¡å¼</h1><h2 id="ä»£ç†æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä»£ç†æ¨¡å¼"></a> ä»£ç†æ¨¡å¼</h2><p>é€šè¿‡åŠ¨æ€ä»£ç†å®ç°ã€‚</p><h2 id="ç­–ç•¥æ¨¡å¼"><a class="markdownIt-Anchor" href="#ç­–ç•¥æ¨¡å¼"></a> ç­–ç•¥æ¨¡å¼</h2><p>ç”Ÿæˆä»£ç†å¯¹è±¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>JDK</code> çš„åŠ¨æ€ä»£ç†å’Œ <code>Cglib</code> çš„åŠ¨æ€ä»£ç†ï¼Œå¯¹äºä¸åŒçš„éœ€æ±‚å¯ä»¥å§”æ‰˜ç»™ä¸åŒçš„ç±»å®ç°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 394. å­—ç¬¦ä¸²è§£ç </title>
    <link href="/2020/11/24/LeetCode-394-decode-string/"/>
    <url>/2020/11/24/LeetCode-394-decode-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/decode-string/" target="_blank" rel="noopener">394. å­—ç¬¦ä¸²è§£ç </a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">decodeString</span><span class="hljs-params">(String s)</span> </span>&#123;    StringBuilder res = <span class="hljs-keyword">new</span> StringBuilder();    LinkedList&lt;Integer&gt; numStack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    LinkedList&lt;String&gt; strStack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : s.toCharArray()) &#123;        <span class="hljs-keyword">if</span> (Character.isDigit(c)) &#123;            <span class="hljs-comment">// æ›´æ–°æ•°å­—</span>            num = num * <span class="hljs-number">10</span> + c - <span class="hljs-string">'0'</span>;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">'['</span>) &#123;            numStack.push(num);            strStack.push(res.toString());            <span class="hljs-comment">// é‡æ–°è®°å½• æ•°å­— å’Œ å­—ç¬¦ä¸²</span>            num = <span class="hljs-number">0</span>;            res.setLength(<span class="hljs-number">0</span>);        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">']'</span>) &#123;            <span class="hljs-keyword">int</span> k = numStack.pop();            StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();            <span class="hljs-keyword">while</span> (k-- &gt; <span class="hljs-number">0</span>) &#123;                sb.append(res);            &#125;            <span class="hljs-comment">// æ‹¼æ¥ [...] å­ä¸²å’ŒåŸæ¥çš„ä¸²</span>            res = <span class="hljs-keyword">new</span> StringBuilder(strStack.pop() + sb.toString());        &#125; <span class="hljs-keyword">else</span> &#123;            res.append(c);        &#125;    &#125;    <span class="hljs-keyword">return</span> res.toString();&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">decodeString</span><span class="hljs-params">(String s)</span> </span>&#123;    LinkedList&lt;String&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-keyword">char</span>[] str = s.toCharArray();    <span class="hljs-keyword">int</span> len = str.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-comment">// 3[a2[c]]</span>    <span class="hljs-keyword">while</span> (i &lt; len) &#123;        <span class="hljs-keyword">char</span> c = str[i];        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">']'</span>) &#123;            LinkedList&lt;String&gt; strList = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();            <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; !<span class="hljs-string">"["</span>.equals(stack.peekLast())) &#123;                strList.addFirst(stack.pollLast());            &#125;            <span class="hljs-comment">// `[` å‡ºæ ˆ</span>            stack.pollLast();            String encodeStr = String.join(<span class="hljs-string">""</span>, strList);            <span class="hljs-comment">// é‡å¤ k æ¬¡ [] å†…çš„ å­—ç¬¦ä¸²</span>            <span class="hljs-keyword">int</span> k = Integer.parseInt(stack.pollLast());            <span class="hljs-keyword">while</span> (k-- &gt; <span class="hljs-number">1</span>) &#123;                strList.addFirst(encodeStr);            &#125;            stack.addLast(String.join(<span class="hljs-string">""</span>, strList));            i++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Character.isDigit(c)) &#123;            <span class="hljs-comment">// å¤„ç†æ˜¯å¦è¿ç»­æ•°å­—</span>            StringBuilder num = <span class="hljs-keyword">new</span> StringBuilder();            <span class="hljs-keyword">while</span> (i &lt; len &amp;&amp; Character.isDigit(str[i])) &#123;                num.append(str[i]);                i++;            &#125;            stack.addLast(num.toString());        &#125; <span class="hljs-keyword">else</span> &#123;            stack.addLast(c + <span class="hljs-string">""</span>);            i++;        &#125;    &#125;    <span class="hljs-keyword">return</span> String.join(<span class="hljs-string">""</span>, stack);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 222. å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°</title>
    <link href="/2020/11/24/LeetCode-222-count-complete-tree-nodes/"/>
    <url>/2020/11/24/LeetCode-222-count-complete-tree-nodes/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/count-complete-tree-nodes/" target="_blank" rel="noopener">222. å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countNodes</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> leftDepth = countDepth(root.left);    <span class="hljs-keyword">int</span> rightDepth = countDepth(root.right);    <span class="hljs-keyword">if</span> (leftDepth == rightDepth) &#123;        <span class="hljs-comment">// å®Œå…¨äºŒå‰æ ‘ï¼Œå·¦å³å­æ ‘é«˜åº¦ç›¸åŒï¼Œåˆ™å·¦è¾¹ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘</span>        <span class="hljs-comment">// 2 ^ leftDepth - 1 + 1 (root) = 2 ^ leftDepth</span>        <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> &lt;&lt; leftDepth) + countNodes(root.right);    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// å³å­æ ‘æ¯”å·¦å­æ ‘å°‘ä¸€å±‚ï¼Œå³è¾¹ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘</span>        <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> &lt;&lt; rightDepth) + countNodes(root.left);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countDepth</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">int</span> depth = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span>) &#123;        depth++;        <span class="hljs-comment">// å®Œå…¨äºŒå‰æ ‘å¶å­èŠ‚ç‚¹éƒ½åœ¨å·¦è¾¹</span>        <span class="hljs-comment">// æ·±åº¦å–å†³äºå·¦å­æ ‘çš„æ·±åº¦</span>        root = root.left;    &#125;    <span class="hljs-keyword">return</span> depth;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</title>
    <link href="/2020/11/23/LeetCode-538-convert-bst-to-greater-tree/"/>
    <url>/2020/11/23/LeetCode-538-convert-bst-to-greater-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree/" target="_blank" rel="noopener">538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">convertBST</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    dfs(root, <span class="hljs-number">0</span>);    <span class="hljs-keyword">return</span> root;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> sum;    &#125;    sum = dfs(root.right, sum);    <span class="hljs-comment">// System.out.println(sum + " " + root.val);</span>    sum += root.val;    root.val = sum;    sum = dfs(root.left, sum);    <span class="hljs-keyword">return</span> sum;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 343. æ•´æ•°æ‹†åˆ†</title>
    <link href="/2020/11/23/LeetCode-343-integer-break/"/>
    <url>/2020/11/23/LeetCode-343-integer-break/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/integer-break/" target="_blank" rel="noopener">343. æ•´æ•°æ‹†åˆ†</a></p><p>å·®ä¸€ç‚¹ğŸ˜­ğŸ˜­ğŸ˜­</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">integerBreak</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;    dp[<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>; i &lt;= n; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; i; j++) &#123;            dp[i] = Math.max(Math.max(j * (i - j), j * dp[i - j]), dp[i]);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[n];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 452. ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</title>
    <link href="/2020/11/23/LeetCode-452-minimum-number-of-arrows-to-burst-balloons/"/>
    <url>/2020/11/23/LeetCode-452-minimum-number-of-arrows-to-burst-balloons/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-number-of-arrows-to-burst-balloons/" target="_blank" rel="noopener">452. ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMinArrowShots</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] points)</span> </span>&#123;    <span class="hljs-comment">// [[10,16],[2,8],[1,6],[7,12]]</span>    <span class="hljs-comment">// [[3,9],[7,12],[3,8],[6,8],[9,10],[2,9],[0,9],[3,9],[0,6],[2,8]]</span>    <span class="hljs-comment">// [[-2147483646,-2147483645],[2147483646,2147483647]]</span>    <span class="hljs-comment">// ä¸èƒ½ç”¨å‡æ³•æ¥æ¯”è¾ƒ &amp;&amp; å­åŒºé—´å†…ä¹Ÿè¦é‡åˆ</span>    Arrays.sort(points, (o1, o2) -&gt; Integer.compare(o1[<span class="hljs-number">1</span>], o2[<span class="hljs-number">1</span>]));    <span class="hljs-comment">// System.out.println(Arrays.deepToString(points));</span>    <span class="hljs-keyword">int</span> len = points.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; len) &#123;        count++;        <span class="hljs-keyword">int</span> end = points[i][<span class="hljs-number">1</span>];        <span class="hljs-comment">// æ¯”è¾ƒçš„æ˜¯ä¸‹ä¸€ä¸ªåŒºé—´</span>        <span class="hljs-keyword">while</span> (i &lt; len - <span class="hljs-number">1</span> &amp;&amp; end &gt;= points[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) &#123;            i++;        &#125;        <span class="hljs-comment">// ç¡®ä¿æ›´æ–° æ–°çš„è¾¹ç•Œ</span>        i++;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 148. æ’åºé“¾è¡¨</title>
    <link href="/2020/11/21/LeetCode-148-sort-list/"/>
    <url>/2020/11/21/LeetCode-148-sort-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-list/" target="_blank" rel="noopener">148. æ’åºé“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">sortList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span> || head.next == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> head;    &#125;    <span class="hljs-comment">// [4,2,1,3]</span>    ListNode slow = head;    ListNode fast = head.next;    <span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹</span>    <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span> &amp;&amp; fast.next != <span class="hljs-keyword">null</span>) &#123;        slow = slow.next;        fast = fast.next.next;    &#125;    <span class="hljs-comment">// åˆ‡åˆ†ä¸¤æ¡é“¾è¡¨</span>    ListNode next = slow.next;    slow.next = <span class="hljs-keyword">null</span>;    ListNode left = sortList(head);    ListNode right = sortList(next);    <span class="hljs-comment">// åˆå¹¶é“¾è¡¨</span>    <span class="hljs-keyword">return</span> merge(left, right);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> ListNode <span class="hljs-title">merge</span><span class="hljs-params">(ListNode left, ListNode right)</span> </span>&#123;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    ListNode head = dummy;    <span class="hljs-keyword">while</span> (left != <span class="hljs-keyword">null</span> &amp;&amp; right != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">if</span> (left.val &lt; right.val) &#123;            head.next = left;            left = left.next;        &#125; <span class="hljs-keyword">else</span> &#123;            head.next = right;            right = right.next;        &#125;        head = head.next;    &#125;    <span class="hljs-keyword">if</span> (left != <span class="hljs-keyword">null</span>) &#123;        head.next = left;    &#125; <span class="hljs-keyword">else</span> &#123;        head.next = right;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ’åº</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 279. å®Œå…¨å¹³æ–¹æ•°</title>
    <link href="/2020/11/20/LeetCode-279-perfect-squares/"/>
    <url>/2020/11/20/LeetCode-279-perfect-squares/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/perfect-squares/" target="_blank" rel="noopener">279. å®Œå…¨å¹³æ–¹æ•°</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numSquares</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n + <span class="hljs-number">1</span>];    Arrays.fill(dp, Integer.MAX_VALUE);    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    dp[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;    <span class="hljs-comment">// dp[i]: ç»„æˆ i æ‰€éœ€çš„æœ€å°‘å®Œå…¨å¹³æ–¹æ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j * j &lt;= i; j++) &#123;            <span class="hljs-keyword">int</span> diff = i - j * j;            dp[i] = Math.min(dp[i], dp[diff] + <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[n];&#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numSquares</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    LinkedList&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    queue.add(n);    <span class="hljs-keyword">boolean</span>[] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n + <span class="hljs-number">1</span>];    visited[n] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        count++;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">int</span> num = queue.poll();            <span class="hljs-comment">// åˆ°è¾¾ç»ˆç‚¹</span>            <span class="hljs-keyword">if</span> (num == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> count - <span class="hljs-number">1</span>;            &#125;            <span class="hljs-comment">// å°è¯•å‡å»æ¯ä¸€ä¸ªå¹³æ–¹æ•°</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i * i &lt;= num; i++) &#123;                <span class="hljs-keyword">int</span> diff = num - i * i;                <span class="hljs-keyword">if</span> (!visited[diff]) &#123;                    queue.add(diff);                    visited[diff] = <span class="hljs-keyword">true</span>;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 147. å¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åº</title>
    <link href="/2020/11/20/LeetCode-147-insertion-sort-list/"/>
    <url>/2020/11/20/LeetCode-147-insertion-sort-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/insertion-sort-list/" target="_blank" rel="noopener">147. å¯¹é“¾è¡¨è¿›è¡Œæ’å…¥æ’åº</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">insertionSortList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    dummy.next = head;    <span class="hljs-comment">// æŒ‡å‘ä»¥æ’åºçš„æœ€åä¸€ä¸ªèŠ‚ç‚¹</span>    ListNode tail = head;    <span class="hljs-comment">// å½“å‰éœ€è¦æ’åºçš„èŠ‚ç‚¹</span>    ListNode cur = head;    <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">// cur &lt; tailï¼Œåˆ™ cur çš„ä½ç½®åœ¨ tail ä¹‹å‰</span>        <span class="hljs-keyword">if</span> (cur.val &lt; tail.val) &#123;            ListNode p = dummy;            <span class="hljs-comment">// p , p.next ä¹‹é—´æ’å…¥ cur</span>            <span class="hljs-keyword">while</span> (p.next.val &lt; cur.val) &#123;                p = p.next;            &#125;            tail.next = cur.next;            <span class="hljs-comment">// æ’å…¥ cur</span>            cur.next = p.next;            p.next = cur;            <span class="hljs-comment">// æ›´æ–° cur</span>            cur = tail.next;        &#125;        <span class="hljs-comment">// cur &gt; tailï¼Œåˆ™ cur ç›´æ¥è¿åœ¨ tail å</span>        <span class="hljs-keyword">else</span> &#123;            tail = cur;            cur = cur.next;        &#125;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ’åº</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring IoC å®ç°</title>
    <link href="/2020/11/20/spring-ioc-implementation/"/>
    <url>/2020/11/20/spring-ioc-implementation/</url>
    
    <content type="html"><![CDATA[<h1 id="ioc-å®ç°"><a class="markdownIt-Anchor" href="#ioc-å®ç°"></a> IoC å®ç°</h1><p><a href="https://github.com/LikaiLee/tiny-spring/tree/945f2f664e66fe7deda29c95ff4e03cfdf08a0b3" target="_blank" rel="noopener">IoC å®ç°æºç </a></p><h2 id="ä¸»è¦é€»è¾‘"><a class="markdownIt-Anchor" href="#ä¸»è¦é€»è¾‘"></a> ä¸»è¦é€»è¾‘</h2><ol><li>é€šè¿‡ <code>ClassPathXmlApplication</code> è¯»å– <code>xml</code> é…ç½®æ–‡ä»¶ï¼Œè¿›è¡Œ <code>bean</code> çš„è·å–ï¼›</li><li><code>XmlBeanDefinitionReader</code> è¯»å– <code>xml</code> ä¸­çš„ <code>bean</code> å…ƒæ•°æ®ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ <code>BeanDefinition</code>ï¼›</li><li><code>BeanFactory</code> å¯¹ <code>BeanDefinition</code> æ³¨å†Œï¼Œå¹¶å®ä¾‹åŒ– <code>bean</code>ã€‚</li></ol><h2 id="resource"><a class="markdownIt-Anchor" href="#resource"></a> Resource</h2><p>ä»¥ <code>Resource</code> æ¥å£ä¸ºæ ¸å¿ƒå‘æ•£å‡ºçš„å‡ ä¸ªç±»ï¼Œéƒ½æ˜¯ç”¨äºè§£å†³ <code>IoC</code> å®¹å™¨ä¸­çš„å†…å®¹ä»å“ªé‡Œæ¥çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ <strong>é…ç½®æ–‡ä»¶ä»å“ªé‡Œè¯»å–ã€é…ç½®æ–‡ä»¶å¦‚ä½•è¯»å–</strong> çš„é—®é¢˜ã€‚</p><table><thead><tr><th>ç±»å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Resource</code></td><td>æ¥å£ï¼Œæ ‡è¯†ä¸€ä¸ªå¤–éƒ¨èµ„æºã€‚é€šè¿‡ <code>getInputStream()</code> æ–¹æ³• è·å–èµ„æºçš„è¾“å…¥æµ ã€‚</td></tr><tr><td><code>UrlResource</code></td><td>å®ç° <code>Resource</code> æ¥å£çš„èµ„æºç±»ï¼Œé€šè¿‡ <code>URL</code> è·å–èµ„æºã€‚</td></tr><tr><td><code>ResourceLoader</code></td><td>èµ„æºåŠ è½½ç±»ã€‚é€šè¿‡ <code>getResource(String)</code> æ–¹æ³•è·å–ä¸€ä¸ª <code>Resouce</code> å¯¹è±¡ï¼Œæ˜¯ <strong>è·å– <code>Resouce</code> çš„ä¸»è¦é€”å¾„</strong> ã€‚</td></tr></tbody></table><h2 id="beandefinition"><a class="markdownIt-Anchor" href="#beandefinition"></a> BeanDefinition</h2><p>ä»¥ <code>BeanDefinition</code> ç±»ä¸ºæ ¸å¿ƒå‘æ•£å‡ºçš„å‡ ä¸ªç±»ï¼Œéƒ½æ˜¯ç”¨äºè§£å†³ <code>Bean</code> çš„å…·ä½“å®šä¹‰é—®é¢˜ï¼ŒåŒ…æ‹¬ <code>Bean</code> çš„åå­—æ˜¯ä»€ä¹ˆã€å®ƒçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œå®ƒçš„å±æ€§èµ‹äºˆäº†å“ªäº›å€¼æˆ–è€…å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯ <strong>å¦‚ä½•åœ¨ <code>IoC</code> å®¹å™¨ä¸­å®šä¹‰ä¸€ä¸ª <code>Bean</code></strong>ï¼Œä½¿å¾— <strong><code>IoC</code> å®¹å™¨å¯ä»¥æ ¹æ®è¿™ä¸ªå®šä¹‰æ¥ç”Ÿæˆå®ä¾‹</strong> çš„é—®é¢˜ã€‚</p><table><thead><tr><th>ç±»å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>BeanDefinition</code></td><td>è¯¥ç±»ä¿å­˜äº† <code>Bean</code> å®šä¹‰ã€‚åŒ…æ‹¬ <code>Bean</code> çš„ åå­— <code>String beanClassName</code>ã€ç±»å‹ <code>Class beanClass</code>ã€å±æ€§ <code>PropertyValues propertyValues</code>ã€‚æ ¹æ®å…¶ <strong>ç±»å‹</strong> å¯ä»¥ç”Ÿæˆä¸€ä¸ªç±»å®ä¾‹ï¼Œç„¶åå¯ä»¥æŠŠ <strong>å±æ€§</strong> æ³¨å…¥è¿›å»ã€‚<code>propertyValues</code> é‡Œé¢åŒ…å«äº†ä¸€ä¸ªä¸ª <code>PropertyValue</code> æ¡ç›®ï¼Œæ¯ä¸ªæ¡ç›®éƒ½æ˜¯é”®å€¼å¯¹ <code>String - Object</code>ï¼Œåˆ†åˆ«å¯¹åº”è¦ç”Ÿæˆå®ä¾‹çš„å±æ€§çš„åå­—ä¸ç±»å‹ã€‚åœ¨ <code>Spring</code> çš„ <code>XML</code> ä¸­çš„ <code>property</code> ä¸­ï¼Œé”®æ˜¯ <code>key</code> ï¼Œå€¼æ˜¯ <code>value</code> æˆ–è€… <code>ref</code>ã€‚å¯¹äº <code>value</code> åªè¦ç›´æ¥æ³¨å…¥å±æ€§å°±è¡Œäº†ï¼Œä½†æ˜¯ <code>ref</code> è¦å…ˆè¿›è¡Œè§£æã€‚<code>Object</code> å¦‚æœæ˜¯ <code>BeanReference</code> ç±»å‹ï¼Œåˆ™è¯´æ˜å…¶æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå…¶ä¸­ä¿å­˜äº†å¼•ç”¨çš„åå­—ï¼Œéœ€è¦ç”¨å…ˆè¿›è¡Œè§£æï¼Œè½¬åŒ–ä¸ºå¯¹åº”çš„å®é™… <code>Object</code>ã€‚</td></tr><tr><td><code>BeanDefinitionReader</code></td><td>è§£æ <code>BeanDefinition</code> çš„æ¥å£ã€‚é€šè¿‡ <code>loadBeanDefinitions(String)</code> æ¥ä»ä¸€ä¸ªåœ°å€åŠ è½½ç±»å®šä¹‰ã€‚</td></tr><tr><td><code>AbstractBeanDefinitionReader</code></td><td>å®ç° <code>BeanDefinitionReader</code> æ¥å£çš„æŠ½è±¡ç±»ï¼ˆæœªå…·ä½“å®ç° <code>loadBeanDefinitions</code>ï¼Œè€Œæ˜¯è§„èŒƒäº† <code>BeanDefinitionReader</code> çš„åŸºæœ¬ç»“æ„ï¼‰ã€‚å†…ç½®ä¸€ä¸ª <code>HashMap rigistry</code>ï¼Œç”¨äºä¿å­˜ <code>String - beanDefinition</code> çš„é”®å€¼å¯¹ã€‚å†…ç½®ä¸€ä¸ª <code>ResourceLoader resourceLoader</code>ï¼Œç”¨äºä¿å­˜ç±»åŠ è½½å™¨ã€‚ç”¨æ„åœ¨äºï¼Œä½¿ç”¨æ—¶ï¼Œåªéœ€è¦å‘å…¶ <code>loadBeanDefinitions()</code> ä¼ å…¥ä¸€ä¸ªèµ„æºåœ°å€ï¼Œå°±å¯ä»¥è‡ªåŠ¨è°ƒç”¨å…¶ç±»åŠ è½½å™¨ï¼Œå¹¶æŠŠè§£æåˆ°çš„ <code>BeanDefinition</code> ä¿å­˜åˆ° <code>registry</code> ä¸­å»ã€‚</td></tr><tr><td><code>XmlBeanDefinitionReader</code></td><td>å…·ä½“å®ç°äº† <code>loadBeanDefinitions()</code> æ–¹æ³•ï¼Œä» <code>XML</code> æ–‡ä»¶ä¸­è¯»å–ç±»å®šä¹‰ã€‚</td></tr></tbody></table><h2 id="beanfactory"><a class="markdownIt-Anchor" href="#beanfactory"></a> BeanFactory</h2><p>ä»¥ <code>BeanFactory</code> æ¥å£ä¸ºæ ¸å¿ƒå‘æ•£å‡ºçš„å‡ ä¸ªç±»ï¼Œéƒ½æ˜¯ç”¨äºè§£å†³ <code>IoC</code> å®¹å™¨åœ¨ <strong>å·²ç»è·å– <code>Bean</code>çš„å®šä¹‰</strong> çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½• <strong>è£…é…ã€è·å– Bean å®ä¾‹</strong> çš„é—®é¢˜ã€‚</p><table><thead><tr><th>ç±»å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>BeanFactory</code></td><td>æ¥å£ï¼Œæ ‡è¯†ä¸€ä¸ª <code>IoC</code> å®¹å™¨ã€‚é€šè¿‡ <code>getBean(String)</code> æ–¹æ³•æ¥ è·å–ä¸€ä¸ªå¯¹è±¡</td></tr><tr><td><code>AbstractBeanFactory</code></td><td><code>BeanFactory</code> çš„ä¸€ç§æŠ½è±¡ç±»å®ç°ï¼Œè§„èŒƒäº† <code>IoC</code> å®¹å™¨çš„åŸºæœ¬ç»“æ„ï¼Œä½†æ˜¯æŠŠ<strong>ç”Ÿæˆ <code>Bean</code> çš„å…·ä½“å®ç°æ–¹å¼ç•™ç»™å­ç±»å®ç°</strong>ã€‚<code>IoC</code> å®¹å™¨çš„ç»“æ„ï¼š<code>AbstractBeanFactory</code> ç»´æŠ¤ä¸€ä¸ª <code>beanDefinitionMap</code> å“ˆå¸Œè¡¨ç”¨äºä¿å­˜ç±»çš„å®šä¹‰ä¿¡æ¯ï¼ˆ<code>BeanDefinition</code>ï¼‰ã€‚è·å– <code>Bean</code> æ—¶ï¼Œå¦‚æœ <code>Bean</code> å·²ç»å­˜åœ¨äºå®¹å™¨ä¸­ï¼Œåˆ™è¿”å›ä¹‹ï¼Œå¦åˆ™åˆ™è°ƒç”¨ <code>doCreateBean</code> æ–¹æ³•è£…é…ä¸€ä¸ª <code>Bean</code>ã€‚ï¼ˆæ‰€è°“å­˜åœ¨äºå®¹å™¨ä¸­ï¼Œæ˜¯æŒ‡å®¹å™¨å¯ä»¥é€šè¿‡ <code>beanDefinitionMap</code> è·å– <code>BeanDefinition</code> è¿›è€Œé€šè¿‡å…¶ <code>getBean()</code> æ–¹æ³•è·å– <code>Bean</code>ã€‚ï¼‰</td></tr><tr><td><code>AutowireCapableBeanFactory</code></td><td>å¯ä»¥å®ç°è‡ªåŠ¨è£…é…çš„ <code>BeanFactory</code>ã€‚åœ¨è¿™ä¸ªå·¥å‚ä¸­ï¼Œå®ç°äº† <code>doCreateBean</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆ†ä¸‰æ­¥ï¼š1ï¼Œé€šè¿‡ <code>BeanDefinition</code> ä¸­ä¿å­˜çš„ç±»ä¿¡æ¯å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼›2ï¼ŒæŠŠå¯¹è±¡ä¿å­˜åœ¨ <code>BeanDefinition</code> ä¸­ï¼Œä»¥å¤‡ä¸‹æ¬¡è·å–ï¼›3ï¼Œä¸ºå…¶è£…é…å±æ€§ã€‚è£…é…å±æ€§æ—¶ï¼Œé€šè¿‡ <code>BeanDefinition</code> ä¸­ç»´æŠ¤çš„ <code>PropertyValues</code> é›†åˆç±»ï¼ŒæŠŠ <code>String - Value</code> é”®å€¼å¯¹æ³¨å…¥åˆ° <code>Bean</code> çš„å±æ€§ä¸­å»ã€‚å¦‚æœ <code>Value</code> çš„ç±»å‹æ˜¯ <code>BeanReference</code> åˆ™è¯´æ˜å…¶æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ˆå¯¹åº”äº <code>XML</code> ä¸­çš„ <code>ref</code>ï¼‰ï¼Œé€šè¿‡ <code>getBean</code> å¯¹å…¶è¿›è¡Œè·å–ï¼Œç„¶åæ³¨å…¥åˆ°å±æ€§ä¸­ã€‚</td></tr></tbody></table><h2 id="applicationcontext"><a class="markdownIt-Anchor" href="#applicationcontext"></a> ApplicationContext</h2><p>ä»¥ <code>ApplicationContext</code> æ¥å£ä¸ºæ ¸å¿ƒå‘æ•£å‡ºçš„å‡ ä¸ªç±»ï¼Œä¸»è¦æ˜¯å¯¹å‰é¢ <code>Resouce</code> ã€ <code>BeanFactory</code>ã€<code>BeanDefinition</code> è¿›è¡Œäº†åŠŸèƒ½çš„å°è£…ï¼Œè§£å†³ <strong>æ ¹æ®åœ°å€è·å– <code>IoC</code> å®¹å™¨å¹¶ä½¿ç”¨</strong> çš„é—®é¢˜ã€‚</p><table><thead><tr><th>ç±»å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>ApplicationContext</code></td><td>æ ‡è®°æ¥å£ï¼Œç»§æ‰¿äº† <code>BeanFactory</code>ã€‚é€šå¸¸ï¼Œè¦å®ç°ä¸€ä¸ª <code>IoC</code> å®¹å™¨æ—¶ï¼Œéœ€è¦å…ˆé€šè¿‡ <code>ResourceLoader</code> è·å–ä¸€ä¸ª <code>Resource</code>ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å®¹å™¨çš„é…ç½®ã€<code>Bean</code> çš„å®šä¹‰ä¿¡æ¯ã€‚æ¥ç€ï¼Œä½¿ç”¨ <code>BeanDefinitionReader</code> è¯»å–è¯¥ <code>Resource</code> ä¸­çš„ <code>BeanDefinition</code> ä¿¡æ¯ã€‚æœ€åï¼ŒæŠŠ <code>BeanDefinition</code> ä¿å­˜åœ¨ <code>BeanFactory</code> ä¸­ï¼Œå®¹å™¨é…ç½®å®Œæ¯•å¯ä»¥ä½¿ç”¨ã€‚æ³¨æ„åˆ° <code>BeanFactory</code> åªå®ç°äº† <code>Bean</code> çš„ è£…é…ã€è·å–ï¼Œå¹¶æœªè¯´æ˜ <code>Bean</code> çš„ æ¥æº ä¹Ÿå°±æ˜¯ <code>BeanDefinition</code> æ˜¯å¦‚ä½• åŠ è½½ çš„ã€‚<strong>è¯¥æ¥å£æŠŠ <code>BeanFactory</code> å’Œ <code>BeanDefinitionReader</code> ç»“åˆåœ¨äº†ä¸€èµ·ã€‚</strong></td></tr><tr><td><code>AbstractApplicationContext</code></td><td><code>ApplicationContext</code> çš„æŠ½è±¡å®ç°ï¼Œå†…éƒ¨åŒ…å«ä¸€ä¸ª <code>BeanFactory</code> ç±»ã€‚ä¸»è¦æ–¹æ³•æœ‰ <code>getBean()</code> å’Œ <code>refresh()</code> æ–¹æ³•ã€‚<code>getBean()</code> ç›´æ¥è°ƒç”¨äº†å†…ç½® <code>BeanFactory</code> çš„ <code>getBean()</code> æ–¹æ³•ï¼Œ<code>refresh()</code> åˆ™ç”¨äºå®ç° <code>BeanFactory</code> çš„åˆ·æ–°ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰ <code>BeanFactory</code> è¯¥ä½¿ç”¨å“ªä¸ªèµ„æºï¼ˆ<code>Resource</code>ï¼‰åŠ è½½ç±»å®šä¹‰ï¼ˆ<code>BeanDefinition</code>ï¼‰ä¿¡æ¯ï¼Œè¯¥æ–¹æ³•ç•™ç»™å­ç±»å®ç°ï¼Œç”¨ä»¥å®ç° <strong>ä»ä¸åŒæ¥æºçš„ä¸åŒç±»å‹çš„èµ„æºåŠ è½½ç±»å®šä¹‰</strong> çš„æ•ˆæœã€‚</td></tr><tr><td><code>ClassPathXmlApplicationContext</code></td><td>ä»ç±»è·¯å¾„åŠ è½½èµ„æºçš„å…·ä½“å®ç°ç±»ã€‚å†…éƒ¨é€šè¿‡ <code>XmlBeanDefinitionReader</code> è§£æ <code>UrlResourceLoader</code> è¯»å–åˆ°çš„ <code>Resource</code>ï¼Œè·å– <code>BeanDefinition</code> ä¿¡æ¯ï¼Œç„¶åå°†å…¶ä¿å­˜åˆ°å†…ç½®çš„ <code>BeanFactory</code> ä¸­ã€‚</td></tr></tbody></table><h2 id="è®¾è®¡æ¨¡å¼"><a class="markdownIt-Anchor" href="#è®¾è®¡æ¨¡å¼"></a> è®¾è®¡æ¨¡å¼</h2><h3 id="æ¨¡æ¿æ–¹æ³•"><a class="markdownIt-Anchor" href="#æ¨¡æ¿æ–¹æ³•"></a> æ¨¡æ¿æ–¹æ³•</h3><p>è¯¥æ¨¡å¼å¤§é‡ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨ <code>BeanFactory</code> ä¸­ï¼ŒæŠŠ <code>getBean()</code> äº¤ç»™å­ç±»å®ç°ï¼Œä¸åŒçš„å­ç±» <strong>BeanFactory</strong> å¯¹å…¶å¯ä»¥é‡‡å–ä¸åŒçš„å®ç°ã€‚</p><h3 id="ä»£ç†æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä»£ç†æ¨¡å¼"></a> ä»£ç†æ¨¡å¼</h3><p><code>ApplicationContext</code> ç»§æ‰¿äº† <code>BeanFactory</code> æ¥å£ï¼Œå…·å¤‡äº† <code>getBean()</code> åŠŸèƒ½ï¼Œä½†æ˜¯åˆå†…ç½®äº†ä¸€ä¸ª <code>BeanFactory</code> å®ä¾‹ï¼Œ<code>getBean()</code> ç›´æ¥è°ƒç”¨ <code>BeanFactory</code> çš„ <code>getBean()</code> ã€‚ä½†æ˜¯ <code>ApplicationContext</code> åŠ å¼ºäº† <code>BeanFactory</code>ï¼Œå®ƒæŠŠç±»å®šä¹‰çš„åŠ è½½ä¹ŸåŒ…å«è¿›å»äº†ã€‚</p><h2 id="å¾ªç¯å¼•ç”¨"><a class="markdownIt-Anchor" href="#å¾ªç¯å¼•ç”¨"></a> å¾ªç¯å¼•ç”¨</h2><p><code>BeanDefinitionReader</code> ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨è¯»å–åˆ°çš„ <code>Bean</code> é…ç½®å¯¹ <code>Bean</code> è¿›è¡Œå®ä¾‹åŒ–ã€‚è¿™é‡Œæä¾›äº†ä¸¤ç§å®ä¾‹åŒ–æ–¹å¼ã€‚</p><ol><li><code>AbstractBeanFactory#getBean()</code> æ—¶åˆ¤æ–­ <code>Bean</code> æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºè¿›è¡Œå®ä¾‹åŒ–ã€‚</li><li><code>AbstractBeanFactory#preInstantiateSingletons()</code>æ‰‹åŠ¨è¿›è¡Œå®ä¾‹åŒ–ã€‚</li></ol><p><a href="https://github.com/LikaiLee/tiny-spring/blob/945f2f664e66fe7deda29c95ff4e03cfdf08a0b3/src/main/java/site/likailee/spring/ioc/factory/AutowireCapableBeanFactory.java#L21" target="_blank" rel="noopener">å®ä¾‹åŒ–è¿‡ç¨‹</a></p><p>æœ€ç»ˆçš„å®ä¾‹åŒ–è¿‡ç¨‹éƒ½åœ¨ <code>AbstractBeanFactory</code> çš„å­ç±» <code>doCreateBean()</code> ä¸­å®Œæˆï¼Œé¦–å…ˆå®ä¾‹åŒ–ä¸€ä¸ªå±æ€§ä¸ºç©ºçš„å¯¹è±¡ï¼Œè¿™æ ·ç›¸äº’å¼•ç”¨çš„å¯¹è±¡éƒ½æŒæœ‰å¯¹æ–¹å®ä¾‹åŒ–è¿‡åçš„å¯¹è±¡ï¼Œåªä¸è¿‡è¯¥å¯¹è±¡çš„å±æ€§ä¸ºç©ºï¼Œä»è€Œé¿å…äº† <code>bean</code> åˆ›å»ºæ­»é”çš„é—®é¢˜ï¼Œç„¶åè¿›è¡Œå„è‡ªçš„å±æ€§æ³¨å…¥è¿‡ç¨‹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</title>
    <link href="/2020/11/19/LeetCode-104-maximum-depth-of-binary-tree/"/>
    <url>/2020/11/19/LeetCode-104-maximum-depth-of-binary-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-depth-of-binary-tree/" target="_blank" rel="noopener">104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxDepth</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> leftDepth = maxDepth(root.left);    <span class="hljs-keyword">int</span> rightDepth = maxDepth(root.right);    <span class="hljs-keyword">return</span> Math.max(leftDepth, rightDepth) + <span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 543. äºŒå‰æ ‘çš„ç›´å¾„</title>
    <link href="/2020/11/19/LeetCode-543-diameter-of-binary-tree/"/>
    <url>/2020/11/19/LeetCode-543-diameter-of-binary-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/diameter-of-binary-tree/" target="_blank" rel="noopener">543. äºŒå‰æ ‘çš„ç›´å¾„</a></p><pre><code class="hljs java"><span class="hljs-keyword">int</span> diameter = <span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">diameterOfBinaryTree</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    depth(root);    <span class="hljs-keyword">return</span> diameter;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">depth</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> left = depth(root.left);    <span class="hljs-keyword">int</span> right = depth(root.right);    <span class="hljs-comment">// æ›´æ–°ç›´å¾„ä¸ºå·¦å³å­æ ‘çš„å’Œ</span>    diameter = Math.max(diameter, left + right);    <span class="hljs-comment">// System.out.println(root.val + " " + left + " " + right + " " + diameter);</span>    <span class="hljs-keyword">return</span> Math.max(left, right) + <span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„</title>
    <link href="/2020/11/18/LeetCode-581-shortest-unsorted-continuous-subarray/"/>
    <url>/2020/11/18/LeetCode-581-shortest-unsorted-continuous-subarray/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/shortest-unsorted-continuous-subarray/" target="_blank" rel="noopener">581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„</a></p><h1 id="æ’åº"><a class="markdownIt-Anchor" href="#æ’åº"></a> æ’åº</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findUnsortedSubarray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] origin = Arrays.copyOf(nums, len);    Arrays.sort(nums);    <span class="hljs-keyword">int</span> left = len, right = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æ’åºåæ¯”è¾ƒæ¯ä¸ªä½ç½®</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] != origin[i]) &#123;            left = Math.min(left, i);            right = Math.max(right, i);        &#125;    &#125;    <span class="hljs-keyword">return</span> right &lt; left ? <span class="hljs-number">0</span> : right - left + <span class="hljs-number">1</span>;&#125;</code></pre><h1 id="æ ˆ"><a class="markdownIt-Anchor" href="#æ ˆ"></a> æ ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findUnsortedSubarray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> left = len, right = <span class="hljs-number">0</span>;    LinkedList&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-comment">// [2, 6, 4, 8, 10, 9, 15]</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// æ‰¾é™åºï¼Œåˆ™ä¸ºå·¦èµ·ç‚¹</span>        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; nums[stack.peek()] &gt; nums[i]) &#123;            left = Math.min(left, stack.pop());        &#125;        stack.push(i);    &#125;    stack.clear();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-comment">// ä»å³å¾€å·¦æ‰¾å‡åºï¼Œåˆ™ä¸ºå³èµ·ç‚¹</span>        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; nums[stack.peek()] &lt; nums[i]) &#123;            right = Math.max(right, stack.pop());        &#125;        stack.push(i);    &#125;    <span class="hljs-keyword">return</span> right &lt; left ? <span class="hljs-number">0</span> : right - left + <span class="hljs-number">1</span>;&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findUnsortedSubarray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> left = len, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> leftMax = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">int</span> rightMin = nums[len - <span class="hljs-number">1</span>];    <span class="hljs-comment">// [2, 6, 4, 8, 10, 9, 15]</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// ä»å·¦å¾€å³å‡åºï¼Œåˆ™æ›´æ–°æœ€å¤§å€¼</span>        <span class="hljs-keyword">if</span> (nums[i] &gt;= leftMax) &#123;            leftMax = nums[i];        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// é™åº</span>            right = i;        &#125;        <span class="hljs-comment">// ä»å³å¾€å·¦é™åºï¼Œåˆ™æ›´æ–°æœ€å°å€¼</span>        <span class="hljs-keyword">if</span> (nums[len - i - <span class="hljs-number">1</span>] &lt;= rightMin) &#123;            rightMin = nums[len - i - <span class="hljs-number">1</span>];        &#125; <span class="hljs-keyword">else</span> &#123;            left = len - i - <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> right &lt; left ? <span class="hljs-number">0</span> : right - left + <span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ’åº</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 134. åŠ æ²¹ç«™</title>
    <link href="/2020/11/18/LeetCode-134-gas-station/"/>
    <url>/2020/11/18/LeetCode-134-gas-station/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/gas-station/" target="_blank" rel="noopener">134. åŠ æ²¹ç«™</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">canCompleteCircuit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] gas, <span class="hljs-keyword">int</span>[] cost)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = gas.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (dfs(i, i, <span class="hljs-number">0</span>, len, gas, cost)) &#123;            <span class="hljs-keyword">return</span> i;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end, <span class="hljs-keyword">int</span> volume, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span>[] gas, <span class="hljs-keyword">int</span>[] cost)</span> </span>&#123;    <span class="hljs-comment">// åˆ°è¾¾æ–°èµ·ç‚¹ï¼ŒåŠ æ²¹</span>    volume += gas[start];    <span class="hljs-comment">// å‰å¾€ä¸‹ä¸€ä¸ªç‚¹</span>    <span class="hljs-keyword">int</span> newVolume = volume - cost[start];    <span class="hljs-comment">// æ²¹ä¸å¤Ÿï¼Œæ— æ³•åˆ°è¾¾ä¸‹ä¸€ä¸ªç‚¹</span>    <span class="hljs-keyword">if</span> (newVolume &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-comment">// ä¸‹ä¸€ä¸ªç‚¹ä¸ºç»ˆç‚¹</span>    <span class="hljs-keyword">int</span> next = (start + <span class="hljs-number">1</span>) % len;    <span class="hljs-keyword">if</span> (next == end) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-keyword">return</span> dfs(next, end, newVolume, len, gas, cost);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 617. åˆå¹¶äºŒå‰æ ‘</title>
    <link href="/2020/11/17/LeetCode-617-merge-two-binary-trees/"/>
    <url>/2020/11/17/LeetCode-617-merge-two-binary-trees/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/merge-two-binary-trees/" target="_blank" rel="noopener">617. åˆå¹¶äºŒå‰æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">mergeTrees</span><span class="hljs-params">(TreeNode t1, TreeNode t2)</span> </span>&#123;    <span class="hljs-keyword">if</span> (t1 == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> t2;    &#125;    <span class="hljs-keyword">if</span> (t2 == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> t1;    &#125;    <span class="hljs-comment">// t1, t2 éƒ½ä¸ä¸º null</span>    <span class="hljs-comment">// åˆå¹¶æ ¹èŠ‚ç‚¹ï¼Œå·¦å³å­æ ‘</span>    t1.val += t2.val;    t1.left = mergeTrees(t1.left, t2.left);    t1.right = mergeTrees(t1.right, t2.right);    <span class="hljs-keyword">return</span> t1;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 647. å›æ–‡å­ä¸²</title>
    <link href="/2020/11/17/LeetCode-647-palindromic-substrings/"/>
    <url>/2020/11/17/LeetCode-647-palindromic-substrings/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/palindromic-substrings/" target="_blank" rel="noopener">647. å›æ–‡å­ä¸²</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countSubstrings</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] str = s.toCharArray();    <span class="hljs-keyword">int</span> len = str.length;    <span class="hljs-keyword">boolean</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len][len];    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æŒ‰åˆ—å¡« dp table</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; len; j++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= j; i++) &#123;            <span class="hljs-comment">// ä¸€ä¸ªå­—ç¬¦</span>            <span class="hljs-keyword">if</span> (i == j) &#123;                dp[i][j] = <span class="hljs-keyword">true</span>;                count++;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j - i == <span class="hljs-number">1</span> &amp;&amp; str[i] == str[j]) &#123;                <span class="hljs-comment">// ä¸¤ä¸ªå­—ç¬¦</span>                dp[i][j] = <span class="hljs-keyword">true</span>;                count++;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (str[i] == str[j] &amp;&amp; dp[i + <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]) &#123;                <span class="hljs-comment">// è¶…è¿‡ä¸¤å­—ç¬¦ï¼Œé¦–å°¾ç›¸åŒ &amp;&amp; å­ä¸²ä¹Ÿä¸ºå›æ–‡ä¸²</span>                count++;                dp[i][j] = <span class="hljs-keyword">true</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1030. è·ç¦»é¡ºåºæ’åˆ—çŸ©é˜µå•å…ƒæ ¼</title>
    <link href="/2020/11/17/LeetCode-1030-matrix-cells-in-distance-order/"/>
    <url>/2020/11/17/LeetCode-1030-matrix-cells-in-distance-order/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/matrix-cells-in-distance-order/" target="_blank" rel="noopener">1030. è·ç¦»é¡ºåºæ’åˆ—çŸ©é˜µå•å…ƒæ ¼</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] allCellsDistOrder(<span class="hljs-keyword">int</span> R, <span class="hljs-keyword">int</span> C, <span class="hljs-keyword">int</span> r0, <span class="hljs-keyword">int</span> c0) &#123;    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[R * C][<span class="hljs-number">2</span>];    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;&#125;;    <span class="hljs-keyword">boolean</span>[][] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[R][C];    LinkedList&lt;<span class="hljs-keyword">int</span>[]&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-comment">// åŠ å…¥é˜Ÿåˆ—</span>    queue.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;r0, c0&#125;);    <span class="hljs-comment">// æ ‡è®°è®¿é—®</span>    visited[r0][c0] = <span class="hljs-keyword">true</span>;    <span class="hljs-comment">// åŠ å…¥ç»“æœé›†</span>    res[i++] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;r0, c0&#125;;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">int</span>[] cur = queue.poll();            <span class="hljs-comment">// å››ä¸ªæ–¹å‘æ¸¸èµ°</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                <span class="hljs-keyword">int</span> newX = cur[<span class="hljs-number">0</span>] + dir[<span class="hljs-number">0</span>];                <span class="hljs-keyword">int</span> newY = cur[<span class="hljs-number">1</span>] + dir[<span class="hljs-number">1</span>];                <span class="hljs-keyword">if</span> (!inArea(newX, newY, R, C) || visited[newX][newY]) &#123;                    <span class="hljs-keyword">continue</span>;                &#125;                visited[newX][newY] = <span class="hljs-keyword">true</span>;                <span class="hljs-keyword">int</span>[] newPos = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;newX, newY&#125;;                queue.add(newPos);                res[i++] = newPos;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> c)</span> </span>&#123;    <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; r &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; c;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 406. æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—</title>
    <link href="/2020/11/16/LeetCode-406-queue-reconstruction-by-height/"/>
    <url>/2020/11/16/LeetCode-406-queue-reconstruction-by-height/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/queue-reconstruction-by-height/" target="_blank" rel="noopener">406. æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] reconstructQueue(<span class="hljs-keyword">int</span>[][] people) &#123;        <span class="hljs-comment">// Arrays.sort(people, (o1, o2) -&gt; o1[0] == o2[0] ? o1[1] - o2[1] : o2[0] - o1[0]);</span>        <span class="hljs-comment">// ä»å¤§åˆ°å°æ’åº</span>        quickSort(people, <span class="hljs-number">0</span>, people.length - <span class="hljs-number">1</span>);        <span class="hljs-comment">// System.out.println(Arrays.deepToString(people));</span>        <span class="hljs-comment">// ä¾æ¬¡å°† p æ’å…¥åˆ°å¯¹åº”ä½ç½®</span>        <span class="hljs-comment">// æœªæ’å…¥çš„å…ƒç´ æ¯”å·²æ’å…¥çš„å…ƒç´ å°ï¼Œä¸ä¼šå½±å“ç›¸å¯¹ä½ç½®</span>        LinkedList&lt;<span class="hljs-keyword">int</span>[]&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] p : people) &#123;            list.add(p[<span class="hljs-number">1</span>], p);        &#125;        <span class="hljs-keyword">return</span> list.toArray(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[list.size()][<span class="hljs-number">2</span>]);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] people, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;        <span class="hljs-keyword">if</span> (low &lt; high) &#123;            <span class="hljs-keyword">int</span> pivotPos = partition(people, low, high);            quickSort(people, low, pivotPos - <span class="hljs-number">1</span>);            quickSort(people, pivotPos + <span class="hljs-number">1</span>, high);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] people, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;        <span class="hljs-keyword">int</span>[] pivot = people[low];        <span class="hljs-keyword">while</span> (low &lt; high) &#123;            <span class="hljs-keyword">while</span> (low &lt; high) &#123;                <span class="hljs-keyword">if</span> (people[high][<span class="hljs-number">0</span>] &lt; pivot[<span class="hljs-number">0</span>] || (people[high][<span class="hljs-number">0</span>] == pivot[<span class="hljs-number">0</span>] &amp;&amp; people[high][<span class="hljs-number">1</span>] &gt; pivot[<span class="hljs-number">1</span>])) &#123;                    high--;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-keyword">break</span>;                &#125;            &#125;            people[low] = people[high];            <span class="hljs-keyword">while</span> (low &lt; high) &#123;                <span class="hljs-keyword">if</span> (people[low][<span class="hljs-number">0</span>] &gt; pivot[<span class="hljs-number">0</span>] || (people[low][<span class="hljs-number">0</span>] == pivot[<span class="hljs-number">0</span>] &amp;&amp; people[low][<span class="hljs-number">1</span>] &lt; pivot[<span class="hljs-number">1</span>])) &#123;                    low++;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-keyword">break</span>;                &#125;            &#125;            people[high] = people[low];        &#125;        people[low] = pivot;        <span class="hljs-keyword">return</span> low;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 784. å­—æ¯å¤§å°å†™å…¨æ’åˆ—</title>
    <link href="/2020/11/14/LeetCode-784-letter-case-permutation/"/>
    <url>/2020/11/14/LeetCode-784-letter-case-permutation/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/letter-case-permutation/" target="_blank" rel="noopener">784. å­—æ¯å¤§å°å†™å…¨æ’åˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">letterCasePermutation</span><span class="hljs-params">(String S)</span> </span>&#123;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = S.length();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-keyword">char</span>[] str = S.toCharArray();    <span class="hljs-comment">// è¦ç‚¹ï¼šstr[i] å¯ä»¥æ”¹å˜å¤§å°å†™ï¼Œä¹Ÿå¯ä»¥ä¸æ”¹å˜</span>    backtrack(str, len, <span class="hljs-number">0</span>, res);    res.add(S);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] str, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> start, List&lt;String&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (start == len) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// ä¸æ”¹å˜ str[start] å›æº¯</span>    backtrack(str, len, start + <span class="hljs-number">1</span>, res);    <span class="hljs-comment">// æ”¹å˜ str[start] å›æº¯</span>    <span class="hljs-keyword">if</span> (Character.isLetter(str[start])) &#123;        <span class="hljs-keyword">char</span> oldChar = str[start];        <span class="hljs-keyword">if</span> (Character.isUpperCase(oldChar)) &#123;            <span class="hljs-comment">// å¤§å†™ =&gt; å°å†™</span>            str[start] = Character.toLowerCase(oldChar);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// å°å†™ =&gt; å¤§å†™</span>            str[start] = Character.toUpperCase(oldChar);        &#125;        res.add(<span class="hljs-keyword">new</span> String(str));        backtrack(str, len, start + <span class="hljs-number">1</span>, res);        str[start] = oldChar;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 93. å¤åŸIPåœ°å€</title>
    <link href="/2020/11/14/LeetCode-93-restore-ip-addresses/"/>
    <url>/2020/11/14/LeetCode-93-restore-ip-addresses/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/restore-ip-addresses/" target="_blank" rel="noopener">93. å¤åŸIPåœ°å€</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">restoreIpAddresses</span><span class="hljs-params">(String s)</span> </span>&#123;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">4</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    backtrack(s, len, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> start, LinkedList&lt;String&gt; path, List&lt;String&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (start == len) &#123;        <span class="hljs-comment">// å››ä¸ªæ•´æ•°æ‰æ˜¯æœ‰æ•ˆ IP</span>        <span class="hljs-keyword">if</span> (path.size() == <span class="hljs-number">4</span>) &#123;            res.add(String.join(<span class="hljs-string">"."</span>, path));        &#125;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// è¿˜æ²¡åˆ‡åˆ†å®Œï¼Œä½†æ˜¯å·²ç»åˆ‡åˆ†çš„æ•°å­—æ•°ç›® &gt;= 4ï¼Œå‰©ä¸‹çš„æ•°å­—ä¸å¯åˆ‡åˆ†</span>    <span class="hljs-keyword">if</span> (path.size() &gt;= <span class="hljs-number">4</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">if</span> (s.charAt(start) == <span class="hljs-string">'0'</span>) &#123;        path.addLast(String.valueOf(s.charAt(start)));        backtrack(s, len, start + <span class="hljs-number">1</span>, path, res);        path.removeLast();    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// [0:255] =&gt; ä½æ•°ï¼š[1:3]</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) &#123;            <span class="hljs-keyword">int</span> end = start + i;            <span class="hljs-keyword">if</span> (end &gt; len) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            String num = s.substring(start, end);            <span class="hljs-comment">// è¶…å‡º 255ï¼Œä¸æ˜¯æœ‰æ•ˆ IP</span>            <span class="hljs-keyword">if</span> (Integer.parseInt(num) &gt; <span class="hljs-number">255</span>) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            path.addLast(num);            backtrack(s, len, end, path, res);            path.removeLast();        &#125;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 328. å¥‡å¶é“¾è¡¨</title>
    <link href="/2020/11/13/LeetCode-328-odd-even-linked-list/"/>
    <url>/2020/11/13/LeetCode-328-odd-even-linked-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/odd-even-linked-list/" target="_blank" rel="noopener">328. å¥‡å¶é“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">oddEvenList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// 1 2 3 4 5 6</span>    <span class="hljs-comment">// o e</span>    ListNode odd = head;    ListNode even = head.next;    ListNode evenHead = even;    <span class="hljs-comment">// even æ€»æ˜¯è¿æ¥å‰©ä½™çš„èŠ‚ç‚¹</span>    <span class="hljs-keyword">while</span> (even != <span class="hljs-keyword">null</span> &amp;&amp; even.next != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">// 1 -&gt; 3 -&gt; 4...</span>        odd.next = even.next;        <span class="hljs-comment">// odd = 3</span>        odd = odd.next;        <span class="hljs-comment">// 2 -&gt; 4...</span>        even.next = odd.next;        <span class="hljs-comment">// even = 4</span>        even = even.next;    &#125;    odd.next = evenHead;    <span class="hljs-keyword">return</span> head;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 437. è·¯å¾„æ€»å’Œ III</title>
    <link href="/2020/11/12/LeetCode-437-path-sum-iii/"/>
    <url>/2020/11/12/LeetCode-437-path-sum-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/path-sum-iii/" target="_blank" rel="noopener">437. è·¯å¾„æ€»å’Œ III</a></p><p>å‰ç¼€å’Œã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pathSum</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-comment">// key: å‰ç¼€å’Œï¼Œvalueï¼šè¯¥å‰ç¼€å’Œçš„å‡ºç°æ¬¡æ•°</span>    Map&lt;Integer, Integer&gt; preSums = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-comment">// å‰ç¼€å’Œä¸º 0 çš„è·¯å¾„æœ‰ä¸€æ¡</span>    preSums.put(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> backtrack(root, <span class="hljs-number">0</span>, preSums, sum);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> curSum, Map&lt;Integer, Integer&gt; preSums, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æ›´æ–°å½“å‰è·¯å¾„å’Œ</span>    curSum += root.val;    <span class="hljs-comment">// curSum - x = sumï¼Œè®¡ç®— x çš„å‡ºç°æ¬¡æ•°</span>    count += preSums.getOrDefault(curSum - sum, <span class="hljs-number">0</span>);    <span class="hljs-comment">// å°† curSum æ”¾å…¥å‰ç¼€å’Œ</span>    preSums.put(curSum, preSums.getOrDefault(curSum, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€å±‚</span>    count += backtrack(root.left, curSum, preSums, sum) + backtrack(root.right, curSum, preSums, sum);    <span class="hljs-comment">// å›æº¯</span>    preSums.put(curSum, preSums.get(curSum) - <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> count;&#125;</code></pre><p>ä»¥æ¯ä¸ªèŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ä¾æ¬¡è®¡ç®—ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pathSum</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">return</span> pathSumFrom(root, sum) + pathSum(root.left, sum) + pathSum(root.right, sum);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pathSumFrom</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    sum -= root.val;    <span class="hljs-keyword">if</span> (sum == <span class="hljs-number">0</span>) &#123;        count++;    &#125;    <span class="hljs-keyword">return</span> count + pathSumFrom(root.left, sum) + pathSumFrom(root.right, sum);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 113. è·¯å¾„æ€»å’Œ II</title>
    <link href="/2020/11/12/LeetCode-113-path-sum-ii/"/>
    <url>/2020/11/12/LeetCode-113-path-sum-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/path-sum-ii/" target="_blank" rel="noopener">113. è·¯å¾„æ€»å’Œ II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; pathSum(TreeNode root, <span class="hljs-keyword">int</span> sum) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    LinkedList&lt;Integer&gt; path = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    backtrack(root, sum, path, res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// æ·»åŠ è·¯å¾„</span>    path.addLast(root.val);    <span class="hljs-comment">// å‡å»å½“å‰èŠ‚ç‚¹çš„å€¼</span>    sum -= root.val;    <span class="hljs-comment">// ç»ˆæ­¢</span>    <span class="hljs-keyword">if</span> (sum == <span class="hljs-number">0</span> &amp;&amp; root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));    &#125;    backtrack(root.left, sum, path, res);    backtrack(root.right, sum, path, res);    <span class="hljs-comment">// å›æº¯</span>    path.removeLast();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 922. æŒ‰å¥‡å¶æ’åºæ•°ç»„ II</title>
    <link href="/2020/11/12/LeetCode-922-sort-array-by-parity-ii/"/>
    <url>/2020/11/12/LeetCode-922-sort-array-by-parity-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-array-by-parity-ii/" target="_blank" rel="noopener">922. æŒ‰å¥‡å¶æ’åºæ•°ç»„ II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortArrayByParityII(<span class="hljs-keyword">int</span>[] A) &#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (i &lt; len &amp;&amp; j &gt;= <span class="hljs-number">0</span>) &#123;        <span class="hljs-comment">// æ‰¾åˆ°ä¸æ»¡è¶³çš„å¶æ•°</span>        <span class="hljs-keyword">while</span> (i &lt; len &amp;&amp; A[i] % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;            i += <span class="hljs-number">2</span>;        &#125;        <span class="hljs-comment">// æ‰¾åˆ°ä¸æ»¡è¶³çš„å¥‡æ•°</span>        <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span> &amp;&amp; A[j] % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;            j -= <span class="hljs-number">2</span>;        &#125;        <span class="hljs-keyword">if</span> (i &lt; len &amp;&amp; j &gt;= <span class="hljs-number">0</span>) &#123;            swap(A, i, j);        &#125;    &#125;    <span class="hljs-keyword">return</span> A;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] a, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = a[i];    a[i] = a[j];    a[j] = t;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 905. æŒ‰å¥‡å¶æ’åºæ•°ç»„</title>
    <link href="/2020/11/12/LeetCode-905-sort-array-by-parity/"/>
    <url>/2020/11/12/LeetCode-905-sort-array-by-parity/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-array-by-parity/" target="_blank" rel="noopener">905. æŒ‰å¥‡å¶æ’åºæ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortArrayByParity(<span class="hljs-keyword">int</span>[] A) &#123;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = A.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (i &lt; j) &#123;        <span class="hljs-keyword">while</span> (i &lt; j &amp;&amp; A[i] % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;            i++;        &#125;        <span class="hljs-keyword">while</span> (i &lt; j &amp;&amp; A[j] % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;            j--;        &#125;        swap(A, i++, j--);    &#125;    <span class="hljs-keyword">return</span> A;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] a, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = a[i];    a[i] = a[j];    a[j] = t;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 60. æ’åˆ—åºåˆ—</title>
    <link href="/2020/11/11/LeetCode-60-permutation-sequence/"/>
    <url>/2020/11/11/LeetCode-60-permutation-sequence/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/permutation-sequence/" target="_blank" rel="noopener">60. æ’åˆ—åºåˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPermutation</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">boolean</span>[] used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">int</span>[] factorial = calcFact(n);    StringBuilder path = <span class="hljs-keyword">new</span> StringBuilder();    dfs(<span class="hljs-number">0</span>, k, n, used, path, factorial);    <span class="hljs-keyword">return</span> path.toString();&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> selectedCount, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">boolean</span>[] used, StringBuilder path, <span class="hljs-keyword">int</span>[] factorial)</span> </span>&#123;    <span class="hljs-keyword">if</span> (path.length() == n) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// å½“å‰åˆ†æ”¯çš„æ’åˆ—æ•°ï¼š(æ€»æ•° - å·²é€‰æ‹©çš„ä¸ªæ•° - 1)!</span>    <span class="hljs-keyword">int</span> count = factorial[n - selectedCount - <span class="hljs-number">1</span>];    <span class="hljs-comment">// 1, 2, 3, 4, ... , n</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;        <span class="hljs-keyword">if</span> (used[i]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// å½“å‰åˆ†æ”¯çš„æ’åˆ—æ•° è¾¾ä¸åˆ° k ä¸ª</span>        <span class="hljs-comment">// åˆ™ç¬¬ k ä¸ªæ’åˆ—ä¸€å®šåœ¨åé¢ï¼Œè·³è¿‡å½“å‰ i</span>        <span class="hljs-keyword">if</span> (count &lt; k) &#123;            k -= count;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// ç¬¬ k ä¸ªæ’åˆ— åœ¨ i çš„åˆ†æ”¯ä¸Š</span>        <span class="hljs-comment">// é€‰æ‹© i è¿›å…¥é€’å½’</span>        used[i] = <span class="hljs-keyword">true</span>;        path.append(i);        dfs(selectedCount + <span class="hljs-number">1</span>, k, n, used, path, factorial);        <span class="hljs-comment">// åé¢çš„æ•°è‹¥è¿›è¡Œæ’åˆ—å·²ç»è¶…å‡º kï¼Œæ— é¡»éå†</span>        <span class="hljs-keyword">return</span>;    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * è®¡ç®— 1...n çš„å…¨æ’åˆ—æ•°</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> n</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] calcFact(<span class="hljs-keyword">int</span> n) &#123;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n + <span class="hljs-number">1</span>];    res[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;        res[i] = i * res[i - <span class="hljs-number">1</span>];    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 90. å­é›† II</title>
    <link href="/2020/11/11/LeetCode-90-subsets-ii/"/>
    <url>/2020/11/11/LeetCode-90-subsets-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/subsets-ii/" target="_blank" rel="noopener">90. å­é›† II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; subsetsWithDup(<span class="hljs-keyword">int</span>[] nums) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    Arrays.sort(nums);    backtrack(nums, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> start, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; nums.length; i++) &#123;        <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        path.addLast(nums[i]);        backtrack(nums, i + <span class="hljs-number">1</span>, path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 78. å­é›†</title>
    <link href="/2020/11/11/LeetCode-78-subsets/"/>
    <url>/2020/11/11/LeetCode-78-subsets/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/subsets/" target="_blank" rel="noopener">78. å­é›†</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; subsets(<span class="hljs-keyword">int</span>[] nums) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    backtrack(nums, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> start, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; nums.length; i++) &#123;        path.addLast(nums[i]);        backtrack(nums, i + <span class="hljs-number">1</span>, path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 2. ä¸¤æ•°ç›¸åŠ </title>
    <link href="/2020/11/11/LeetCode-2-add-two-numbers/"/>
    <url>/2020/11/11/LeetCode-2-add-two-numbers/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/add-two-numbers/" target="_blank" rel="noopener">2. ä¸¤æ•°ç›¸åŠ </a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">addTwoNumbers</span><span class="hljs-params">(ListNode l1, ListNode l2)</span> </span>&#123;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    ListNode cur = dummy;    <span class="hljs-keyword">int</span> carry = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (l1 != <span class="hljs-keyword">null</span> || l2 != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">int</span> x = l1 == <span class="hljs-keyword">null</span> ? <span class="hljs-number">0</span> : l1.val;        <span class="hljs-keyword">int</span> y = l2 == <span class="hljs-keyword">null</span> ? <span class="hljs-number">0</span> : l2.val;        <span class="hljs-keyword">int</span> sum = x + y + carry;        <span class="hljs-comment">// è¿›ä½</span>        carry = sum / <span class="hljs-number">10</span>;        <span class="hljs-comment">// éœ€è¦ä¿å­˜çš„æ•°</span>        sum %= <span class="hljs-number">10</span>;        cur.next = <span class="hljs-keyword">new</span> ListNode(sum);        cur = cur.next;        <span class="hljs-keyword">if</span> (l1 != <span class="hljs-keyword">null</span>) &#123;            l1 = l1.next;        &#125;        <span class="hljs-keyword">if</span> (l2 != <span class="hljs-keyword">null</span>) &#123;            l2 = l2.next;        &#125;    &#125;    <span class="hljs-keyword">if</span> (carry != <span class="hljs-number">0</span>) &#123;        cur.next = <span class="hljs-keyword">new</span> ListNode(carry);    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDK ä¸­çš„è®¾è®¡æ¨¡å¼</title>
    <link href="/2020/11/11/design-patterns-in-JDK/"/>
    <url>/2020/11/11/design-patterns-in-JDK/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆ›å»ºå‹"><a class="markdownIt-Anchor" href="#åˆ›å»ºå‹"></a> åˆ›å»ºå‹</h1><h2 id="å•ä¾‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#å•ä¾‹æ¨¡å¼"></a> å•ä¾‹æ¨¡å¼</h2><p>ç”¨æ¥ç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p><ul><li>java.lang.Runtime#getRuntime()</li><li>java.awt.Toolkit#getDefaultToolkit()</li><li>java.awt.GraphicsEnvironment#getLocalGraphicsEnvironment()</li><li>java.awt.Desktop#getDesktop()</li></ul><h2 id="å·¥å‚æ–¹æ³•"><a class="markdownIt-Anchor" href="#å·¥å‚æ–¹æ³•"></a> å·¥å‚æ–¹æ³•</h2><p>ä¸€ä¸ªè¿”å›å…·ä½“å¯¹è±¡çš„æ–¹æ³•ã€‚</p><ul><li>java.lang.Proxy#newProxyInstance()</li><li>java.lang.Object#toString()</li><li>java.lang.Class#newInstance()</li><li>java.lang.reflect.Array#newInstance()</li><li>java.lang.reflect.Constructor#newInstance()</li><li>java.lang.Boolean#valueOf(String)</li><li>java.lang.Class#forName()</li></ul><h2 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a class="markdownIt-Anchor" href="#æŠ½è±¡å·¥å‚æ¨¡å¼"></a> æŠ½è±¡å·¥å‚æ¨¡å¼</h2><p>æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›äº†ä¸€ä¸ªåè®®æ¥ç”Ÿæˆä¸€ç³»åˆ—çš„ç›¸å…³æˆ–è€…ç‹¬ç«‹çš„å¯¹è±¡ï¼Œè€Œä¸ç”¨æŒ‡å®šå…·ä½“å¯¹è±¡çš„ç±»å‹ã€‚å®ƒä½¿å¾—åº”ç”¨ç¨‹åºèƒ½å¤Ÿå’Œä½¿ç”¨çš„æ¡†æ¶çš„å…·ä½“å®ç°è¿›è¡Œè§£è€¦ã€‚è¿™åœ¨JDKæˆ–è€…è®¸å¤šæ¡†æ¶æ¯”å¦‚Springä¸­éƒ½éšå¤„å¯è§ã€‚å®ƒä»¬ä¹Ÿå¾ˆå®¹æ˜“è¯†åˆ«ï¼Œä¸€ä¸ªåˆ›å»ºæ–°å¯¹è±¡çš„æ–¹æ³•ï¼Œè¿”å›çš„å´æ˜¯æ¥å£æˆ–è€…æŠ½è±¡ç±»çš„ï¼Œå°±æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼äº†ã€‚</p><ul><li>java.util.Calendar#getInstance()</li><li>java.util.Arrays#asList()</li><li>java.util.ResourceBundle#getBundle()</li><li>java.sql.DriverManager#getConnection()</li><li>java.sql.Connection#createStatement()</li><li>java.sql.Statement#executeQuery()</li><li>java.text.NumberFormat#getInstance()</li><li>javax.xml.transform.TransformerFactory#newInstance()</li></ul><h2 id="å»ºé€ æ¨¡å¼"><a class="markdownIt-Anchor" href="#å»ºé€ æ¨¡å¼"></a> å»ºé€ æ¨¡å¼</h2><p>å®šä¹‰äº†ä¸€ä¸ªæ–°çš„ç±»æ¥æ„å»ºå¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œä»¥ç®€åŒ–å¤æ‚å¯¹è±¡çš„åˆ›å»ºã€‚å»ºé€ æ¨¡å¼é€šå¸¸ä¹Ÿä½¿ç”¨æ–¹æ³•é“¾æ¥æ¥å®ç°ã€‚</p><ul><li>java.lang.StringBuilder#append()</li><li>java.lang.StringBuffer#append()</li><li>java.sql.PreparedStatement</li><li>javax.swing.GroupLayout.Group#addComponent()</li></ul><h2 id="åŸå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#åŸå‹æ¨¡å¼"></a> åŸå‹æ¨¡å¼</h2><p>ä½¿å¾—ç±»çš„å®ä¾‹èƒ½å¤Ÿç”Ÿæˆè‡ªèº«çš„æ‹·è´ã€‚å¦‚æœåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹éå¸¸å¤æ‚ä¸”è€—æ—¶æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œè€Œä¸é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œä½ å¯ä»¥æ‹·è´ä¸€ä¸ªå¯¹è±¡å¹¶ç›´æ¥ä¿®æ”¹å®ƒã€‚</p><ul><li>java.lang.Object#clone()</li><li>java.lang.Cloneable</li></ul><h1 id="è¡Œä¸ºå‹"><a class="markdownIt-Anchor" href="#è¡Œä¸ºå‹"></a> è¡Œä¸ºå‹</h1><h2 id="è´£ä»»é“¾æ¨¡å¼"><a class="markdownIt-Anchor" href="#è´£ä»»é“¾æ¨¡å¼"></a> è´£ä»»é“¾æ¨¡å¼</h2><p>é€šè¿‡æŠŠè¯·æ±‚ä»ä¸€ä¸ªå¯¹è±¡ä¼ é€’åˆ°é“¾æ¡ä¸­ä¸‹ä¸€ä¸ªå¯¹è±¡çš„æ–¹å¼ï¼Œç›´åˆ°è¯·æ±‚è¢«å¤„ç†å®Œæ¯•ï¼Œä»¥å®ç°å¯¹è±¡é—´çš„è§£è€¦ã€‚</p><ul><li>java.util.logging.Logger#log()</li><li>javax.servlet.Filter#doFilter()</li></ul><h2 id="å‘½ä»¤æ¨¡å¼"><a class="markdownIt-Anchor" href="#å‘½ä»¤æ¨¡å¼"></a> å‘½ä»¤æ¨¡å¼</h2><p>å°†æ“ä½œå°è£…åˆ°å¯¹è±¡å†…ï¼Œä»¥ä¾¿å­˜å‚¨ï¼Œä¼ é€’å’Œè¿”å›ã€‚</p><ul><li>java.lang.Runnable</li><li>javax.swing.Action</li></ul><h2 id="è§£é‡Šå™¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#è§£é‡Šå™¨æ¨¡å¼"></a> è§£é‡Šå™¨æ¨¡å¼</h2><p>è¿™ä¸ªæ¨¡å¼é€šå¸¸å®šä¹‰äº†ä¸€ä¸ªè¯­è¨€çš„è¯­æ³•ï¼Œç„¶åè§£æç›¸åº”è¯­æ³•çš„è¯­å¥ã€‚</p><ul><li>java.util.Pattern</li><li>java.text.Normalizer</li><li>java.text.Format</li></ul><h2 id="è¿­ä»£å™¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨æ¨¡å¼"></a> è¿­ä»£å™¨æ¨¡å¼</h2><p>æä¾›ä¸€ä¸ªä¸€è‡´çš„æ–¹æ³•æ¥é¡ºåºè®¿é—®é›†åˆä¸­çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•ä¸åº•å±‚çš„é›†åˆçš„å…·ä½“å®ç°æ— å…³ã€‚</p><ul><li>java.util.Iterator</li><li>java.util.Enumeration</li></ul><h2 id="ä¸­ä»‹è€…æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä¸­ä»‹è€…æ¨¡å¼"></a> ä¸­ä»‹è€…æ¨¡å¼</h2><p>é€šè¿‡ä½¿ç”¨ä¸€ä¸ªä¸­é—´å¯¹è±¡æ¥è¿›è¡Œæ¶ˆæ¯åˆ†å‘ä»¥åŠå‡å°‘ç±»ä¹‹é—´çš„ç›´æ¥ä¾èµ–ã€‚</p><ul><li>java.util.Timer</li><li>java.util.concurrent.Executor#execute()</li><li>java.util.concurrent.ExecutorService#submit()</li><li>java.lang.reflect.Method#invoke()</li></ul><h2 id="å¤‡å¿˜å½•æ¨¡å¼"><a class="markdownIt-Anchor" href="#å¤‡å¿˜å½•æ¨¡å¼"></a> å¤‡å¿˜å½•æ¨¡å¼</h2><p>ç”Ÿæˆå¯¹è±¡çŠ¶æ€çš„ä¸€ä¸ªå¿«ç…§ï¼Œä»¥ä¾¿å¯¹è±¡å¯ä»¥æ¢å¤åŸå§‹çŠ¶æ€è€Œä¸ç”¨æš´éœ²è‡ªèº«çš„å†…å®¹ã€‚Dateå¯¹è±¡é€šè¿‡è‡ªèº«å†…éƒ¨çš„ä¸€ä¸ªlongå€¼æ¥å®ç°å¤‡å¿˜å½•æ¨¡å¼ã€‚</p><ul><li>java.util.Date</li><li>java.io.Serializable</li></ul><h2 id="ç©ºå¯¹è±¡æ¨¡å¼"><a class="markdownIt-Anchor" href="#ç©ºå¯¹è±¡æ¨¡å¼"></a> ç©ºå¯¹è±¡æ¨¡å¼</h2><p>è¿™ä¸ªæ¨¡å¼é€šè¿‡ä¸€ä¸ªæ— æ„ä¹‰çš„å¯¹è±¡æ¥ä»£æ›¿æ²¡æœ‰å¯¹è±¡è¿™ä¸ªçŠ¶æ€ã€‚å®ƒä½¿å¾—ä½ ä¸ç”¨é¢å¤–å¯¹ç©ºå¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</p><ul><li>java.util.Collections#emptyList()</li><li>java.util.Collections#emptyMap()</li><li>java.util.Collections#emptySet()</li></ul><h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a class="markdownIt-Anchor" href="#è§‚å¯Ÿè€…æ¨¡å¼"></a> è§‚å¯Ÿè€…æ¨¡å¼</h2><p>å®ƒä½¿å¾—ä¸€ä¸ªå¯¹è±¡å¯ä»¥çµæ´»çš„å°†æ¶ˆæ¯å‘é€ç»™æ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚</p><ul><li>java.util.EventListener</li><li>javax.servlet.http.HttpSessionBindingListener</li><li>javax.servlet.http.HttpSessionAttributeListener</li><li>javax.faces.event.PhaseListener</li></ul><h2 id="çŠ¶æ€æ¨¡å¼"><a class="markdownIt-Anchor" href="#çŠ¶æ€æ¨¡å¼"></a> çŠ¶æ€æ¨¡å¼</h2><p>é€šè¿‡æ”¹å˜å¯¹è±¡å†…éƒ¨çš„çŠ¶æ€ï¼Œä½¿å¾—ä½ å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºã€‚</p><ul><li>java.util.Iterator</li><li>javax.faces.lifecycle.LifeCycle#execute()</li></ul><h2 id="ç­–ç•¥æ¨¡å¼"><a class="markdownIt-Anchor" href="#ç­–ç•¥æ¨¡å¼"></a> ç­–ç•¥æ¨¡å¼</h2><p>ä½¿ç”¨è¿™ä¸ªæ¨¡å¼æ¥å°†ä¸€ç»„ç®—æ³•å°è£…æˆä¸€ç³»åˆ—å¯¹è±¡ã€‚é€šè¿‡ä¼ é€’è¿™äº›å¯¹è±¡å¯ä»¥çµæ´»çš„æ”¹å˜ç¨‹åºçš„åŠŸèƒ½ã€‚</p><ul><li>java.util.Comparator#compare()</li><li>javax.servlet.http.HttpServlet</li><li>javax.servlet.Filter#doFilter()</li></ul><h2 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a class="markdownIt-Anchor" href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a> æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h2><p>è®©å­ç±»å¯ä»¥é‡å†™æ–¹æ³•çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ•´ä¸ªé‡å†™ï¼Œä½ å¯ä»¥æ§åˆ¶å­ç±»éœ€è¦é‡å†™é‚£äº›æ“ä½œã€‚</p><ul><li>java.util.Collections#sort()</li><li>java.io.InputStream#skip()</li><li>java.io.InputStream#read()</li><li>java.util.AbstractList#indexOf()</li></ul><h2 id="è®¿é—®è€…æ¨¡å¼"><a class="markdownIt-Anchor" href="#è®¿é—®è€…æ¨¡å¼"></a> è®¿é—®è€…æ¨¡å¼</h2><p>æä¾›ä¸€ä¸ªæ–¹ä¾¿çš„å¯ç»´æŠ¤çš„æ–¹å¼æ¥æ“ä½œä¸€ç»„å¯¹è±¡ã€‚å®ƒä½¿å¾—ä½ åœ¨ä¸æ”¹å˜æ“ä½œçš„å¯¹è±¡å‰æä¸‹ï¼Œå¯ä»¥ä¿®æ”¹æˆ–è€…æ‰©å±•å¯¹è±¡çš„è¡Œä¸ºã€‚</p><ul><li>javax.lang.model.element.Element and javax.lang.model.element.ElementVisitor</li><li>javax.lang.model.type.TypeMirror and javax.lang.model.type.TypeVisitor</li></ul><h1 id="ç»“æ„å‹"><a class="markdownIt-Anchor" href="#ç»“æ„å‹"></a> ç»“æ„å‹</h1><h2 id="é€‚é…å™¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#é€‚é…å™¨æ¨¡å¼"></a> é€‚é…å™¨æ¨¡å¼</h2><p>ç”¨æ¥æŠŠä¸€ä¸ªæ¥å£è½¬åŒ–æˆå¦ä¸€ä¸ªæ¥å£ã€‚</p><ul><li>java.util.Arrays#asList()</li><li>javax.swing.JTable(TableModel)</li><li>java.io.InputStreamReader(InputStream)</li><li>java.io.OutputStreamWriter(OutputStream)</li><li>javax.xml.bind.annotation.adapters.XmlAdapter#marshal()</li><li>javax.xml.bind.annotation.adapters.XmlAdapter#unmarshal()</li></ul><h2 id="æ¡¥æ¥æ¨¡å¼"><a class="markdownIt-Anchor" href="#æ¡¥æ¥æ¨¡å¼"></a> æ¡¥æ¥æ¨¡å¼</h2><p>è¿™ä¸ªæ¨¡å¼å°†æŠ½è±¡å’ŒæŠ½è±¡æ“ä½œçš„å®ç°è¿›è¡Œäº†è§£è€¦ï¼Œè¿™æ ·ä½¿å¾—æŠ½è±¡å’Œå®ç°å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚</p><ul><li>AWT (It provides an abstraction layer which maps onto the native OS the windowing support.)</li><li>JDBC</li></ul><h2 id="ç»„åˆæ¨¡å¼"><a class="markdownIt-Anchor" href="#ç»„åˆæ¨¡å¼"></a> ç»„åˆæ¨¡å¼</h2><p>ä½¿å¾—å®¢æˆ·ç«¯çœ‹æ¥å•ä¸ªå¯¹è±¡å’Œå¯¹è±¡çš„ç»„åˆæ˜¯åŒç­‰çš„ã€‚æ¢å¥è¯è¯´ï¼ŒæŸä¸ªç±»å‹çš„æ–¹æ³•åŒæ—¶ä¹Ÿæ¥å—è‡ªèº«ç±»å‹ä½œä¸ºå‚æ•°ã€‚</p><ul><li>javax.swing.JComponent#add(Component)</li><li>java.awt.Container#add(Component)</li><li>java.util.Map#putAll(Map)</li><li>java.util.List#addAll(Collection)</li><li>java.util.Set#addAll(Collection)</li></ul><h2 id="è£…é¥°è€…æ¨¡å¼"><a class="markdownIt-Anchor" href="#è£…é¥°è€…æ¨¡å¼"></a> è£…é¥°è€…æ¨¡å¼</h2><p>åŠ¨æ€çš„ç»™ä¸€ä¸ªå¯¹è±¡é™„åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œè¿™ä¹Ÿæ˜¯å­ç±»çš„ä¸€ç§æ›¿ä»£æ–¹å¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªç±»å‹çš„æ—¶å€™ï¼ŒåŒæ—¶ä¹Ÿä¼ å…¥åŒä¸€ç±»å‹çš„å¯¹è±¡ã€‚è¿™åœ¨JDKé‡Œéšå¤„å¯è§ï¼Œä½ ä¼šå‘ç°å®ƒæ— å¤„ä¸åœ¨ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ä¸ªåˆ—è¡¨åªæ˜¯ä¸€å°éƒ¨åˆ†ã€‚</p><ul><li>java.io.BufferedInputStream(InputStream)</li><li>java.io.DataInputStream(InputStream)</li><li>java.io.BufferedOutputStream(OutputStream)</li><li>java.util.zip.ZipOutputStream(OutputStream)</li><li>java.util.Collections#checkedList|Map|Set|SortedSet|SortedMap</li></ul><h2 id="äº«å…ƒæ¨¡å¼"><a class="markdownIt-Anchor" href="#äº«å…ƒæ¨¡å¼"></a> äº«å…ƒæ¨¡å¼</h2><p>ä½¿ç”¨ç¼“å­˜æ¥åŠ é€Ÿå¤§é‡å°å¯¹è±¡çš„è®¿é—®æ—¶é—´ã€‚</p><ul><li>java.lang.Integer#valueOf(int)</li><li>java.lang.Boolean#valueOf(boolean)</li><li>java.lang.Byte#valueOf(byte)</li><li>java.lang.Character#valueOf(char)</li></ul><h2 id="ä»£ç†æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä»£ç†æ¨¡å¼"></a> ä»£ç†æ¨¡å¼</h2><p>ä»£ç†æ¨¡å¼æ˜¯ç”¨ä¸€ä¸ªç®€å•çš„å¯¹è±¡æ¥ä»£æ›¿ä¸€ä¸ªå¤æ‚çš„æˆ–è€…åˆ›å»ºè€—æ—¶çš„å¯¹è±¡ã€‚</p><ul><li>java.lang.reflect.Proxy</li><li>RMI</li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 31. ä¸‹ä¸€ä¸ªæ’åˆ—</title>
    <link href="/2020/11/10/LeetCode-31-next-permutation/"/>
    <url>/2020/11/10/LeetCode-31-next-permutation/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/next-permutation/" target="_blank" rel="noopener">31. ä¸‹ä¸€ä¸ªæ’åˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nextPermutation</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = nums.length;        <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªå‡åºçš„ä½ç½®</span>        <span class="hljs-keyword">int</span> ascPos = -<span class="hljs-number">1</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;            <span class="hljs-keyword">if</span> (nums[i] &lt; nums[i + <span class="hljs-number">1</span>]) &#123;                ascPos = i;                <span class="hljs-keyword">break</span>;            &#125;        &#125;        <span class="hljs-comment">// ascPos....len - 1 é™åº</span>        <span class="hljs-comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ª &gt; nums[ascPos] çš„ä½ç½®ï¼Œå¹¶äº¤æ¢</span>        <span class="hljs-keyword">if</span> (ascPos &gt;= <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">int</span> largePos = binarySearch(nums, ascPos + <span class="hljs-number">1</span>, len - <span class="hljs-number">1</span>, nums[ascPos]);            swap(nums, ascPos, largePos);            <span class="hljs-comment">/*for (int i = len - 1; i &gt; ascPos; i--) &#123;</span><span class="hljs-comment">                if (nums[i] &gt; nums[ascPos]) &#123;</span><span class="hljs-comment">                    swap(nums, i, ascPos);</span><span class="hljs-comment">                    break;</span><span class="hljs-comment">                &#125;</span><span class="hljs-comment">            &#125;*/</span>        &#125;        <span class="hljs-comment">// ç¿»è½¬ [ascPos + 1:len - 1]ï¼Œä½¿å…¶å˜ä¸ºå‡åº</span>        reverse(nums, ascPos + <span class="hljs-number">1</span>, len - <span class="hljs-number">1</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;                left = mid;            &#125; <span class="hljs-keyword">else</span> &#123;                right = mid - <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> left;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reverse</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;        <span class="hljs-keyword">while</span> (i &lt; j) &#123;            swap(nums, i++, j--);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;        <span class="hljs-keyword">int</span> t = nums[i];        nums[i] = nums[j];        nums[j] = t;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-ç»“æ„å‹</title>
    <link href="/2020/11/10/design-patterns-structural/"/>
    <url>/2020/11/10/design-patterns-structural/</url>
    
    <content type="html"><![CDATA[<h1 id="é€‚é…å™¨adapter"><a class="markdownIt-Anchor" href="#é€‚é…å™¨adapter"></a> é€‚é…å™¨ï¼ˆAdapterï¼‰</h1><blockquote><p>æŠŠä¸€ä¸ªç±»æ¥å£è½¬æ¢æˆå¦ä¸€ä¸ªç”¨æˆ·éœ€è¦çš„æ¥å£ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110140916.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Turkey</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gobble</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Duck</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quack</span><span class="hljs-params">()</span></span>;&#125;</code></pre><p>Adapter:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TurkeyAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Duck</span> </span>&#123;    Turkey turkey;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TurkeyAdapter</span><span class="hljs-params">(Turkey turkey)</span> </span>&#123;        <span class="hljs-keyword">this</span>.turkey = turkey;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å°† Turkey#gobble() é€‚é…æˆ Duck#quack()</span><span class="hljs-comment">     */</span>    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quack</span><span class="hljs-params">()</span> </span>&#123;        turkey.gobble();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Turkey turkey = <span class="hljs-keyword">new</span> WildTurkey();        Duck duck = <span class="hljs-keyword">new</span> TurkeyAdapter(turkey);        duck.quack();    &#125;&#125;</code></pre><h1 id="æ¡¥æ¥bridge"><a class="markdownIt-Anchor" href="#æ¡¥æ¥bridge"></a> æ¡¥æ¥ï¼ˆBridgeï¼‰</h1><blockquote><p>å°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»å¼€æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</p></blockquote><ul><li><code>Abstraction</code>ï¼šå®šä¹‰æŠ½è±¡ç±»çš„æ¥å£</li><li><code>Implementor</code>ï¼šå®šä¹‰å®ç°ç±»æ¥å£</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110141335.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TV</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sony</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TV</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Sony.on()"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Sony.off()"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Sony.tuneChannel()"</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RCA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TV</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"RCA.on()"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"RCA.off()"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"RCA.tuneChannel()"</span>);    &#125;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoteControl</span> </span>&#123;    <span class="hljs-keyword">protected</span> TV tv;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RemoteControl</span><span class="hljs-params">(TV tv)</span> </span>&#123;        <span class="hljs-keyword">this</span>.tv = tv;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteRemoteControl1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RemoteControl</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteRemoteControl1</span><span class="hljs-params">(TV tv)</span> </span>&#123;        <span class="hljs-keyword">super</span>(tv);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl1.on()"</span>);        tv.on();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl1.off()"</span>);        tv.off();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl1.tuneChannel()"</span>);        tv.tuneChannel();    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteRemoteControl2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RemoteControl</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteRemoteControl2</span><span class="hljs-params">(TV tv)</span> </span>&#123;        <span class="hljs-keyword">super</span>(tv);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">on</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl2.on()"</span>);        tv.on();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">off</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl2.off()"</span>);        tv.off();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tuneChannel</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"ConcreteRemoteControl2.tuneChannel()"</span>);        tv.tuneChannel();    &#125;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        RemoteControl remoteControl1 = <span class="hljs-keyword">new</span> ConcreteRemoteControl1(<span class="hljs-keyword">new</span> RCA());        remoteControl1.on();        remoteControl1.off();        remoteControl1.tuneChannel();        RemoteControl remoteControl2 = <span class="hljs-keyword">new</span> ConcreteRemoteControl2(<span class="hljs-keyword">new</span> Sony());        remoteControl2.on();        remoteControl2.off();        remoteControl2.tuneChannel();    &#125;&#125;</code></pre><h1 id="ç»„åˆcomposite"><a class="markdownIt-Anchor" href="#ç»„åˆcomposite"></a> ç»„åˆï¼ˆCompositeï¼‰</h1><blockquote><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºâ€œæ•´ä½“/éƒ¨åˆ†â€å±‚æ¬¡å…³ç³»ï¼Œå…è®¸ç”¨æˆ·ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†å•ç‹¬å¯¹è±¡å’Œç»„åˆå¯¹è±¡ã€‚</p></blockquote><p>ç»„ä»¶ï¼ˆComponentï¼‰ç±»æ˜¯ç»„åˆç±»ï¼ˆCompositeï¼‰å’Œå¶å­ç±»ï¼ˆLeafï¼‰çš„çˆ¶ç±»ï¼Œå¯ä»¥æŠŠç»„åˆç±»çœ‹æˆæ˜¯æ ‘çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p><p>ç»„åˆå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªç»„ä»¶å¯¹è±¡ï¼Œå› æ­¤ç»„åˆå¯¹è±¡çš„æ“ä½œå¯ä»¥å§”æ‰˜ç»™ç»„ä»¶å¯¹è±¡å»å¤„ç†ï¼Œè€Œç»„ä»¶å¯¹è±¡å¯ä»¥æ˜¯å¦ä¸€ä¸ªç»„åˆå¯¹è±¡æˆ–è€…å¶å­å¯¹è±¡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110142019.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>&#123;    <span class="hljs-keyword">protected</span> String name;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Component</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">this</span>.name = name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">()</span> </span>&#123;        print(<span class="hljs-number">0</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> level)</span></span>;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Component component)</span></span>;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Component component)</span></span>;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Composite</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;    <span class="hljs-keyword">private</span> List&lt;Component&gt; child;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Composite</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">super</span>(name);        child = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> level)</span> </span>&#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; level; i++) &#123;            System.out.print(<span class="hljs-string">"--"</span>);        &#125;        System.out.println(<span class="hljs-string">"Composite: "</span> + name);        <span class="hljs-keyword">for</span> (Component component : child) &#123;            component.print(level + <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Component component)</span> </span>&#123;        child.add(component);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Component component)</span> </span>&#123;        child.remove(component);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Leaf</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Leaf</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">super</span>(name);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">int</span> level)</span> </span>&#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; level; i++) &#123;            System.out.print(<span class="hljs-string">"--"</span>);        &#125;        System.out.println(<span class="hljs-string">"leaf: "</span> + name);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Component component)</span> </span>&#123;        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Component component)</span> </span>&#123;        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Composite root = <span class="hljs-keyword">new</span> Composite(<span class="hljs-string">"root"</span>);        Component node1 = <span class="hljs-keyword">new</span> Leaf(<span class="hljs-string">"1"</span>);        Component node2 = <span class="hljs-keyword">new</span> Composite(<span class="hljs-string">"2"</span>);        Component node3 = <span class="hljs-keyword">new</span> Leaf(<span class="hljs-string">"3"</span>);        root.add(node1);        root.add(node2);        root.add(node3);        Component node21 = <span class="hljs-keyword">new</span> Leaf(<span class="hljs-string">"21"</span>);        Component node22 = <span class="hljs-keyword">new</span> Composite(<span class="hljs-string">"22"</span>);        node2.add(node21);        node2.add(node22);        Component node221 = <span class="hljs-keyword">new</span> Leaf(<span class="hljs-string">"221"</span>);        node22.add(node221);        root.print();    &#125;&#125;</code></pre><h1 id="è£…é¥°decorator"><a class="markdownIt-Anchor" href="#è£…é¥°decorator"></a> è£…é¥°ï¼ˆDecoratorï¼‰</h1><blockquote><p>ä¸ºå¯¹è±¡åŠ¨æ€æ·»åŠ åŠŸèƒ½ã€‚</p></blockquote><p>è£…é¥°è€…ï¼ˆDecoratorï¼‰å’Œå…·ä½“ç»„ä»¶ï¼ˆConcreteComponentï¼‰éƒ½ç»§æ‰¿è‡ªç»„ä»¶ï¼ˆComponentï¼‰ï¼Œå…·ä½“ç»„ä»¶çš„æ–¹æ³•å®ç°ä¸éœ€è¦ä¾èµ–äºå…¶å®ƒå¯¹è±¡ï¼Œè€Œè£…é¥°è€…ç»„åˆäº†ä¸€ä¸ªç»„ä»¶ï¼Œè¿™æ ·å®ƒå¯ä»¥è£…é¥°å…¶å®ƒè£…é¥°è€…æˆ–è€…å…·ä½“ç»„ä»¶ã€‚æ‰€è°“è£…é¥°ï¼Œå°±æ˜¯æŠŠè¿™ä¸ªè£…é¥°è€…å¥—åœ¨è¢«è£…é¥°è€…ä¹‹ä¸Šï¼Œä»è€ŒåŠ¨æ€æ‰©å±•è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚è£…é¥°è€…çš„æ–¹æ³•æœ‰ä¸€éƒ¨åˆ†æ˜¯è‡ªå·±çš„ï¼Œè¿™å±äºå®ƒçš„åŠŸèƒ½ï¼Œç„¶åè°ƒç”¨è¢«è£…é¥°è€…çš„æ–¹æ³•å®ç°ï¼Œä»è€Œä¹Ÿä¿ç•™äº†è¢«è£…é¥°è€…çš„åŠŸèƒ½ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå…·ä½“ç»„ä»¶åº”å½“æ˜¯è£…é¥°å±‚æ¬¡çš„æœ€ä½å±‚ï¼Œå› ä¸ºåªæœ‰å…·ä½“ç»„ä»¶çš„æ–¹æ³•å®ç°ä¸éœ€è¦ä¾èµ–äºå…¶å®ƒå¯¹è±¡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110144202.png" srcset="/img/loading.gif" alt="" /></p><p>è¢«è£…é¥°è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Beverage</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DarkRoast</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Beverage</span></span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HouseBlend</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Beverage</span></span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;&#125;</code></pre><p>è£…é¥°è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CondimentDecorator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Beverage</span> </span>&#123;    <span class="hljs-keyword">protected</span> Beverage beverage;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Milk</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CondimentDecorator</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Milk</span><span class="hljs-params">(Beverage beverage)</span> </span>&#123;        <span class="hljs-keyword">this</span>.beverage = beverage;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> + beverage.cost();    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mocha</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CondimentDecorator</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Mocha</span><span class="hljs-params">(Beverage beverage)</span> </span>&#123;        <span class="hljs-keyword">this</span>.beverage = beverage;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">cost</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> + beverage.cost();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Beverage beverage = <span class="hljs-keyword">new</span> HouseBlend();        beverage = <span class="hljs-keyword">new</span> Mocha(beverage);        beverage = <span class="hljs-keyword">new</span> Milk(beverage);        System.out.println(beverage.cost());    &#125;&#125;</code></pre><h1 id="å¤–è§‚facade"><a class="markdownIt-Anchor" href="#å¤–è§‚facade"></a> å¤–è§‚ï¼ˆFacadeï¼‰</h1><blockquote><p>æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ï¼Œä»è€Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110145701.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubSystem</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">turnOnTV</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"turnOnTV()"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCD</span><span class="hljs-params">(String cd)</span> </span>&#123;        System.out.println(<span class="hljs-string">"setCD( "</span> + cd + <span class="hljs-string">" )"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startWatching</span><span class="hljs-params">()</span></span>&#123;        System.out.println(<span class="hljs-string">"startWatching()"</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Facade</span> </span>&#123;    <span class="hljs-keyword">private</span> SubSystem subSystem = <span class="hljs-keyword">new</span> SubSystem();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">watchMovie</span><span class="hljs-params">()</span> </span>&#123;        subSystem.turnOnTV();        subSystem.setCD(<span class="hljs-string">"a movie"</span>);        subSystem.startWatching();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Facade facade = <span class="hljs-keyword">new</span> Facade();        facade.watchMovie();    &#125;&#125;</code></pre><h1 id="äº«å…ƒflyweight"><a class="markdownIt-Anchor" href="#äº«å…ƒflyweight"></a> äº«å…ƒï¼ˆFlyweightï¼‰</h1><blockquote><p>åˆ©ç”¨å…±äº«çš„æ–¹å¼æ¥æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡ä¸€éƒ¨åˆ†å†…éƒ¨çŠ¶æ€æ˜¯ç›¸åŒçš„ã€‚</p></blockquote><ul><li><code>Flyweight</code>ï¼šäº«å…ƒå¯¹è±¡</li><li><code>IntrinsicState</code>ï¼šå†…éƒ¨çŠ¶æ€ï¼Œäº«å…ƒå¯¹è±¡å…±äº«å†…éƒ¨çŠ¶æ€</li><li><code>ExtrinsicState</code>ï¼šå¤–éƒ¨çŠ¶æ€ï¼Œæ¯ä¸ªäº«å…ƒå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¸åŒ</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110145918.png" srcset="/img/loading.gif" alt="" /></p><p>äº«å…ƒå¯¹è±¡ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Flyweight</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doOperation</span><span class="hljs-params">(String extrinsicState)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFlyweight</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Flyweight</span> </span>&#123;    <span class="hljs-keyword">private</span> String intrinsicState;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteFlyweight</span><span class="hljs-params">(String intrinsicState)</span> </span>&#123;        <span class="hljs-keyword">this</span>.intrinsicState = intrinsicState;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doOperation</span><span class="hljs-params">(String extrinsicState)</span> </span>&#123;        System.out.println(<span class="hljs-string">"Object address:"</span> + System.identityHashCode(<span class="hljs-keyword">this</span>));        System.out.println(<span class="hljs-string">"IntrinsicState: "</span> + intrinsicState);        System.out.println(<span class="hljs-string">"ExtrinsicState: "</span> + extrinsicState);    &#125;&#125;</code></pre><p>äº«å…ƒå·¥å‚ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FlyweightFactory</span> </span>&#123;    <span class="hljs-keyword">private</span> Map&lt;String, Flyweight&gt; flyweightMap = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-function">Flyweight <span class="hljs-title">getFlyweight</span><span class="hljs-params">(String intrinsicState)</span> </span>&#123;        <span class="hljs-keyword">if</span> (!flyweightMap.containsKey(intrinsicState)) &#123;            Flyweight flyweight = <span class="hljs-keyword">new</span> ConcreteFlyweight(intrinsicState);            flyweightMap.put(intrinsicState, flyweight);        &#125;        <span class="hljs-keyword">return</span> flyweightMap.get(intrinsicState);    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        FlyweightFactory factory = <span class="hljs-keyword">new</span> FlyweightFactory();        Flyweight flyweight1 = factory.getFlyweight(<span class="hljs-string">"aa"</span>);        Flyweight flyweight2 = factory.getFlyweight(<span class="hljs-string">"aa"</span>);        flyweight1.doOperation(<span class="hljs-string">"x"</span>);        flyweight2.doOperation(<span class="hljs-string">"y"</span>);    &#125;&#125;</code></pre><h1 id="ä»£ç†proxy"><a class="markdownIt-Anchor" href="#ä»£ç†proxy"></a> ä»£ç†ï¼ˆProxyï¼‰</h1><blockquote><p>æ§åˆ¶å¯¹å…¶å®ƒå¯¹è±¡çš„è®¿é—®ã€‚</p></blockquote><p>ä»£ç†æœ‰ä»¥ä¸‹å››ç±»ï¼š</p><ul><li><strong>è¿œç¨‹ä»£ç†ï¼ˆRemote Proxyï¼‰</strong>ï¼šæ§åˆ¶å¯¹è¿œç¨‹å¯¹è±¡ï¼ˆä¸åŒåœ°å€ç©ºé—´ï¼‰çš„è®¿é—®ï¼Œå®ƒè´Ÿè´£å°†è¯·æ±‚åŠå…¶å‚æ•°è¿›è¡Œç¼–ç ï¼Œå¹¶å‘ä¸åŒåœ°å€ç©ºé—´ä¸­çš„å¯¹è±¡å‘é€å·²ç»ç¼–ç çš„è¯·æ±‚ã€‚</li><li><strong>è™šæ‹Ÿä»£ç†ï¼ˆVirtual Proxyï¼‰</strong>ï¼šæ ¹æ®éœ€è¦åˆ›å»ºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç¼“å­˜å®ä½“çš„é™„åŠ ä¿¡æ¯ï¼Œä»¥ä¾¿å»¶è¿Ÿå¯¹å®ƒçš„è®¿é—®ï¼Œä¾‹å¦‚åœ¨ç½‘ç«™åŠ è½½ä¸€ä¸ªå¾ˆå¤§å›¾ç‰‡æ—¶ï¼Œä¸èƒ½é©¬ä¸Šå®Œæˆï¼Œå¯ä»¥ç”¨è™šæ‹Ÿä»£ç†ç¼“å­˜å›¾ç‰‡çš„å¤§å°ä¿¡æ¯ï¼Œç„¶åç”Ÿæˆä¸€å¼ ä¸´æ—¶å›¾ç‰‡ä»£æ›¿åŸå§‹å›¾ç‰‡ã€‚</li><li><strong>ä¿æŠ¤ä»£ç†ï¼ˆProtection Proxyï¼‰</strong>ï¼šæŒ‰æƒé™æ§åˆ¶å¯¹è±¡çš„è®¿é—®ï¼Œå®ƒè´Ÿè´£æ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦å…·æœ‰å®ç°ä¸€ä¸ªè¯·æ±‚æ‰€å¿…é¡»çš„è®¿é—®æƒé™ã€‚</li><li><strong>æ™ºèƒ½ä»£ç†ï¼ˆSmart Referenceï¼‰</strong>ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼šè®°å½•å¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°ï¼›å½“ç¬¬ä¸€æ¬¡å¼•ç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°†å®ƒè£…å…¥å†…å­˜ï¼›åœ¨è®¿é—®ä¸€ä¸ªå®é™…å¯¹è±¡å‰ï¼Œæ£€æŸ¥æ˜¯å¦å·²ç»é”å®šäº†å®ƒï¼Œä»¥ç¡®ä¿å…¶å®ƒå¯¹è±¡ä¸èƒ½æ”¹å˜å®ƒã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110151002.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Image</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">showImage</span><span class="hljs-params">()</span></span>;&#125;</code></pre><p>RealObject:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HighResolutionImage</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Image</span> </span>&#123;    <span class="hljs-keyword">private</span> URL imageURL;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> startTime;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> height;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> width;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getHeight</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> height;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getWidth</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> width;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HighResolutionImage</span><span class="hljs-params">(URL imageURL)</span> </span>&#123;        <span class="hljs-keyword">this</span>.imageURL = imageURL;        <span class="hljs-keyword">this</span>.startTime = System.currentTimeMillis();        <span class="hljs-keyword">this</span>.width = <span class="hljs-number">600</span>;        <span class="hljs-keyword">this</span>.height = <span class="hljs-number">600</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isLoad</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// æ¨¡æ‹Ÿå›¾ç‰‡åŠ è½½ï¼Œå»¶è¿Ÿ 3s åŠ è½½å®Œæˆ</span>        <span class="hljs-keyword">long</span> endTime = System.currentTimeMillis();        <span class="hljs-keyword">return</span> endTime - startTime &gt; <span class="hljs-number">3000</span>;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showImage</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Real Image: "</span> + imageURL);    &#125;&#125;</code></pre><p>ProxyObject:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Image</span> </span>&#123;    <span class="hljs-keyword">private</span> HighResolutionImage highResolutionImage;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ImageProxy</span><span class="hljs-params">(HighResolutionImage highResolutionImage)</span> </span>&#123;        <span class="hljs-keyword">this</span>.highResolutionImage = highResolutionImage;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showImage</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">while</span> (!highResolutionImage.isLoad()) &#123;            <span class="hljs-keyword">try</span> &#123;                System.out.println(<span class="hljs-string">"Temp Image: "</span> + highResolutionImage.getWidth() + <span class="hljs-string">" "</span> + highResolutionImage.getHeight());                Thread.sleep(<span class="hljs-number">100</span>);            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;                e.printStackTrace();            &#125;        &#125;        highResolutionImage.showImage();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageViewer</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;        String image = <span class="hljs-string">"http://image.jpg"</span>;        URL url = <span class="hljs-keyword">new</span> URL(image);        HighResolutionImage highResolutionImage = <span class="hljs-keyword">new</span> HighResolutionImage(url);        ImageProxy imageProxy = <span class="hljs-keyword">new</span> ImageProxy(highResolutionImage);        imageProxy.showImage();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 77. ç»„åˆ</title>
    <link href="/2020/11/09/LeetCode-77-combinations/"/>
    <url>/2020/11/09/LeetCode-77-combinations/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/combinations/" target="_blank" rel="noopener">77. ç»„åˆ</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combine(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> k) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    backtrack(<span class="hljs-number">1</span>, n, k, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> begin, <span class="hljs-keyword">int</span> end, <span class="hljs-keyword">int</span> k, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (path.size() == k) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// è¿˜éœ€è¦æœç´¢ = k - size ä¸ªå…ƒç´ </span>    <span class="hljs-comment">// æœ€åçš„èµ·ç‚¹ = n - (k - size) + 1</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = begin; i &lt;= end - (k - path.size()) + <span class="hljs-number">1</span>; i++) &#123;        path.addLast(i);        backtrack(i + <span class="hljs-number">1</span>, end, k, path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 40. ç»„åˆæ€»å’Œ II</title>
    <link href="/2020/11/09/LeetCode-40-combination-sum-ii/"/>
    <url>/2020/11/09/LeetCode-40-combination-sum-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/combination-sum-ii/" target="_blank" rel="noopener">40. ç»„åˆæ€»å’Œ II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum2(<span class="hljs-keyword">int</span>[] candidates, <span class="hljs-keyword">int</span> target) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = candidates.length;    Arrays.sort(candidates);    backtrack(candidates, <span class="hljs-number">0</span>, len, target, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] candidates, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> target, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (target == <span class="hljs-number">0</span>) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">if</span> (target &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; len; i++) &#123;        <span class="hljs-comment">// start å’Œ i é‡å¤ï¼Œstart æ’åˆ—å®Œä¹‹åï¼Œi å‰ªæ</span>        <span class="hljs-comment">// i &gt; 0 &amp;&amp; candidates[i - 1] == candidates[i] &amp;&amp; !used[i - 1]</span>        <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; candidates[i - <span class="hljs-number">1</span>] == candidates[i]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        path.addLast(candidates[i]);        <span class="hljs-comment">// target æ¯æ¬¡éƒ½å‡å» candidate[i]ï¼Œç›´åˆ° == 0</span>        backtrack(candidates, i + <span class="hljs-number">1</span>, len, target - candidates[i], path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 47. å…¨æ’åˆ— II</title>
    <link href="/2020/11/09/LeetCode-47-permutations-ii/"/>
    <url>/2020/11/09/LeetCode-47-permutations-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/permutations-ii/" target="_blank" rel="noopener">47. å…¨æ’åˆ— II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permuteUnique(<span class="hljs-keyword">int</span>[] nums) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">boolean</span>[] used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len];    <span class="hljs-comment">// æ’åºï¼Œè¾…åŠ©åˆ¤æ–­é‡å¤</span>    Arrays.sort(nums);    backtrack(nums, used, len, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">boolean</span>[] used, <span class="hljs-keyword">int</span> len, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (path.size() == len) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (used[i]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// è‹¥å½“å‰å…ƒç´ å’Œä¸Šä¸€å…ƒç´ ç›¸åŒ &amp;&amp; ä¸Šä¸€å…ƒç´ æœªä½¿ç”¨</span>        <span class="hljs-comment">// è¡¨ç¤ºä¸Šä¸€å…ƒç´ å·²ç»å®Œæˆæ’åˆ—ï¼Œå½“å‰å…ƒç´ æ— é¡»å†æ¬¡æ’åˆ—</span>        <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i - <span class="hljs-number">1</span>] == nums[i] &amp;&amp; !used[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        used[i] = <span class="hljs-keyword">true</span>;        path.addLast(nums[i]);        backtrack(nums, used, len, path, res);        path.removeLast();        used[i] = <span class="hljs-keyword">false</span>;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 46. å…¨æ’åˆ—</title>
    <link href="/2020/11/09/LeetCode-46-permutations/"/>
    <url>/2020/11/09/LeetCode-46-permutations/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/permutations/" target="_blank" rel="noopener">46. å…¨æ’åˆ—</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; permute(<span class="hljs-keyword">int</span>[] nums) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    backtrack(nums, nums.length, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> len, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (path.size() == len) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (path.contains(nums[i])) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        path.addLast(nums[i]);        backtrack(nums, len, path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-è¡Œä¸ºå‹</title>
    <link href="/2020/11/09/design-patterns-behavioral/"/>
    <url>/2020/11/09/design-patterns-behavioral/</url>
    
    <content type="html"><![CDATA[<h1 id="è´£ä»»é“¾chain-of-responsibility"><a class="markdownIt-Anchor" href="#è´£ä»»é“¾chain-of-responsibility"></a> è´£ä»»é“¾ï¼ˆChain Of Responsibilityï¼‰</h1><blockquote><p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾å‘é€è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109130237.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handler</span> </span>&#123;    <span class="hljs-keyword">protected</span> Handler successor;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * successor ä½œä¸ºä¸‹ä¸€ä¸ª handler</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> successor</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Handler</span><span class="hljs-params">(Handler successor)</span> </span>&#123;        <span class="hljs-keyword">this</span>.successor = successor;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å½“å‰ handler å¤„ç† request ç»“æŸåï¼Œ</span><span class="hljs-comment">     * è‹¥æœªåˆ°ç»ˆç‚¹ï¼Œåˆ™å°† request ä¼ é€’ç»™ä¸‹ä¸€ä¸ª handler</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span><span class="hljs-params">(Request request)</span></span>;&#125;</code></pre><p>Handler:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteHandler1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Handler</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteHandler1</span><span class="hljs-params">(Handler successor)</span> </span>&#123;        <span class="hljs-keyword">super</span>(successor);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span><span class="hljs-params">(Request request)</span> </span>&#123;        <span class="hljs-comment">// å½“å‰å±‚ä¸ºç»ˆç‚¹</span>        <span class="hljs-keyword">if</span> (request.getType() == RequestType.TYPE1) &#123;            System.out.println(request.getName() + <span class="hljs-string">" is handle by ConcreteHandler1"</span>);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// å½“å‰å±‚éç»ˆç‚¹ï¼Œä¼ é€’ç»™ä¸‹ä¸€ä¸ª handler</span>        <span class="hljs-keyword">if</span> (successor != <span class="hljs-keyword">null</span>) &#123;            successor.handleRequest(request);        &#125;    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteHandler2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Handler</span></span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteHandler2</span><span class="hljs-params">(Handler successor)</span> </span>&#123;        <span class="hljs-keyword">super</span>(successor);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleRequest</span><span class="hljs-params">(Request request)</span> </span>&#123;        <span class="hljs-keyword">if</span> (request.getType() == RequestType.TYPE2) &#123;            System.out.println(request.getName() + <span class="hljs-string">" is handle by ConcreteHandler2"</span>);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">if</span> (successor != <span class="hljs-keyword">null</span>) &#123;            successor.handleRequest(request);        &#125;    &#125;&#125;</code></pre><p>æ¨¡æ‹Ÿè¯·æ±‚ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Request</span> </span>&#123;    <span class="hljs-keyword">private</span> RequestType type;    <span class="hljs-keyword">private</span> String name;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Request</span><span class="hljs-params">(RequestType type, String name)</span> </span>&#123;        <span class="hljs-keyword">this</span>.type = type;        <span class="hljs-keyword">this</span>.name = name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> RequestType <span class="hljs-title">getType</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> type;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> name;    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> RequestType &#123;    TYPE1, TYPE2&#125;</code></pre><p>è°ƒç”¨ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-comment">// handler2 -&gt; handler1 -&gt; null</span>        Handler handler1 = <span class="hljs-keyword">new</span> ConcreteHandler1(<span class="hljs-keyword">null</span>);        Handler handler2 = <span class="hljs-keyword">new</span> ConcreteHandler2(handler1);        Request request1 = <span class="hljs-keyword">new</span> Request(RequestType.TYPE1, <span class="hljs-string">"request 1"</span>);        handler2.handleRequest(request1);        Request request2 = <span class="hljs-keyword">new</span> Request(RequestType.TYPE2, <span class="hljs-string">"request 2"</span>);        handler2.handleRequest(request2);    &#125;&#125;</code></pre><h1 id="å‘½ä»¤command"><a class="markdownIt-Anchor" href="#å‘½ä»¤command"></a> å‘½ä»¤ï¼ˆCommandï¼‰</h1><blockquote><p>å°†å‘½ä»¤å°è£…æˆå¯¹è±¡ä¸­ï¼Œå…·æœ‰ä»¥ä¸‹ä½œç”¨ï¼š</p><ul><li>ä½¿ç”¨å‘½ä»¤æ¥å‚æ•°åŒ–å…¶å®ƒå¯¹è±¡</li><li>å°†å‘½ä»¤æ”¾å…¥é˜Ÿåˆ—ä¸­è¿›è¡Œæ’é˜Ÿ</li><li>å°†å‘½ä»¤çš„æ“ä½œè®°å½•åˆ°æ—¥å¿—ä¸­</li><li>æ”¯æŒå¯æ’¤é”€çš„æ“ä½œ</li></ul></blockquote><p>ç±»å›¾ï¼š</p><ul><li><code>Command</code>ï¼šå‘½ä»¤</li><li><code>Receiver</code>ï¼šå‘½ä»¤æ¥æ”¶è€…ï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤çœŸæ­£çš„æ‰§è¡Œè€…</li><li><code>Invoker</code>ï¼šé€šè¿‡å®ƒæ¥è°ƒç”¨å‘½ä»¤</li><li><code>Client</code>ï¼šå¯ä»¥è®¾ç½®å‘½ä»¤ä¸å‘½ä»¤çš„æ¥æ”¶è€…</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109141050.png" srcset="/img/loading.gif" alt="" /></p><p>å‘½ä»¤ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Command</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ‰§è¡Œå‘½ä»¤</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LightOnCommand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Command</span> </span>&#123;    Light light;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LightOnCommand</span><span class="hljs-params">(Light light)</span> </span>&#123;        <span class="hljs-keyword">this</span>.light = light;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.light.on();    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LightOffCommand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Command</span> </span>&#123;    Light light;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LightOffCommand</span><span class="hljs-params">(Light light)</span> </span>&#123;        <span class="hljs-keyword">this</span>.light = light;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.light.off();    &#125;&#125;</code></pre><p>æ‰§è¡Œè€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Invoker</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å¼€å¯æŒ‰é’®ç»„</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> Command[] onCommands;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å…³é—­æŒ‰é’®ç»„</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> Command[] offCommands;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ‰€æœ‰çš„æŒ‰é’®ä½ç½®</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> slotNum = <span class="hljs-number">7</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Invoker</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.onCommands = <span class="hljs-keyword">new</span> Command[slotNum];        <span class="hljs-keyword">this</span>.offCommands = <span class="hljs-keyword">new</span> Command[slotNum];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½®ç¬¬ slot ä¸ªä½ç½®çš„å¼€å¯å‘½ä»¤ä¸º cmd</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cmd</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> slot</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setOnCommand</span><span class="hljs-params">(Command cmd, <span class="hljs-keyword">int</span> slot)</span> </span>&#123;        onCommands[slot] = cmd;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½®ç¬¬ slot ä¸ªä½ç½®çš„å…³é—­å‘½ä»¤ä¸º cmd</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cmd</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> slot</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setOffCommand</span><span class="hljs-params">(Command cmd, <span class="hljs-keyword">int</span> slot)</span> </span>&#123;        offCommands[slot] = cmd;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‰ä¸‹ç¬¬ slot ä¸ªå¼€å¯æŒ‰é’®</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> slot</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onButtonWasPushed</span><span class="hljs-params">(<span class="hljs-keyword">int</span> slot)</span> </span>&#123;        onCommands[slot].execute();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‰ä¸‹ç¬¬ slot ä¸ªå…³é—­æŒ‰é’®</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> slot</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">offButtonWasPushed</span><span class="hljs-params">(<span class="hljs-keyword">int</span> slot)</span> </span>&#123;        offCommands[slot].execute();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Invoker invoker = <span class="hljs-keyword">new</span> Invoker();        Light light = <span class="hljs-keyword">new</span> Light();        <span class="hljs-comment">// å‘½ä»¤</span>        Command lightOnCmd = <span class="hljs-keyword">new</span> LightOnCommand(light);        Command lightOffCmd = <span class="hljs-keyword">new</span> LightOffCommand(light);        <span class="hljs-comment">// è®¾ç½®æŒ‰é’®ä½ç½®çš„åŠŸèƒ½</span>        invoker.setOnCommand(lightOnCmd, <span class="hljs-number">0</span>);        invoker.setOffCommand(lightOffCmd, <span class="hljs-number">0</span>);        <span class="hljs-comment">// æŒ‰ä¸‹å¼€å¯æˆ–å…³é—­æŒ‰é’®</span>        invoker.onButtonWasPushed(<span class="hljs-number">0</span>);        invoker.offButtonWasPushed(<span class="hljs-number">0</span>);    &#125;&#125;</code></pre><h1 id="è¿­ä»£å™¨iterator"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨iterator"></a> è¿­ä»£å™¨ï¼ˆIteratorï¼‰</h1><blockquote><p>æä¾›ä¸€ç§é¡ºåºè®¿é—®èšåˆå¯¹è±¡å…ƒç´ çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote><ul><li><code>Aggregate</code> æ˜¯èšåˆç±»ï¼Œå…¶ä¸­ <code>createIterator()</code> æ–¹æ³•å¯ä»¥äº§ç”Ÿä¸€ä¸ª <code>Iterator</code>ï¼›</li><li><code>Iterator</code> ä¸»è¦å®šä¹‰äº† <code>hasNext()</code> å’Œ <code>next()</code> æ–¹æ³•ï¼›</li><li><code>Client</code> ç»„åˆäº† <code>Aggregate</code>ï¼Œä¸ºäº†è¿­ä»£éå† <code>Aggregate</code>ï¼Œä¹Ÿéœ€è¦ç»„åˆ <code>Iterator</code>ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109145623.png" srcset="/img/loading.gif" alt="" /></p><p>Iterator:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å–ä¸‹ä¸€ä¸ªå…ƒç´ </span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function">T <span class="hljs-title">next</span><span class="hljs-params">()</span></span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ </span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteIterator</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span> </span>&#123;    <span class="hljs-keyword">private</span> T[] items;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> position = <span class="hljs-number">0</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteIterator</span><span class="hljs-params">(T[] items)</span> </span>&#123;        <span class="hljs-keyword">this</span>.items = items;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> items[position++];    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> position &lt; items.length;    &#125;&#125;</code></pre><p>Aggregate:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Aggregate</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ›å»ºè¿­ä»£å™¨</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function">Iterator <span class="hljs-title">createIterator</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteAggregate</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Aggregate</span> </span>&#123;    <span class="hljs-keyword">private</span> Integer[] items;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteAggregate</span><span class="hljs-params">()</span> </span>&#123;        items = <span class="hljs-keyword">new</span> Integer[<span class="hljs-number">10</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) &#123;            items[i] = i;        &#125;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Iterator <span class="hljs-title">createIterator</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteIterator&lt;Integer&gt;(items);    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;    Aggregate aggregate = <span class="hljs-keyword">new</span> ConcreteAggregate();    Iterator&lt;Integer&gt; iterator = aggregate.createIterator();    <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;        System.out.println(iterator.next());    &#125;&#125;</code></pre><h1 id="ä¸­ä»‹è€…mediator"><a class="markdownIt-Anchor" href="#ä¸­ä»‹è€…mediator"></a> ä¸­ä»‹è€…ï¼ˆMediatorï¼‰</h1><blockquote><p>é›†ä¸­ç›¸å…³å¯¹è±¡ä¹‹é—´å¤æ‚çš„æ²Ÿé€šå’Œæ§åˆ¶æ–¹å¼ã€‚</p></blockquote><ul><li><code>Mediator</code>ï¼šä¸­ä»‹è€…ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£ç”¨äºä¸å„åŒäº‹ï¼ˆ<code>Colleague</code>ï¼‰å¯¹è±¡é€šä¿¡ã€‚</li><li><code>Colleague</code>ï¼šåŒäº‹ï¼Œç›¸å…³å¯¹è±¡</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109145909.png" srcset="/img/loading.gif" alt="" /></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109151648.png" srcset="/img/loading.gif" alt="" /></p><p>å¯¹è±¡ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Colleague</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(Mediator mediator)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Alarm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Colleague</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(Mediator mediator)</span> </span>&#123;        mediator.doEvent(<span class="hljs-string">"alarm"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doAlarm</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"doAlarm()"</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CoffeePot</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Colleague</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(Mediator mediator)</span> </span>&#123;        mediator.doEvent(<span class="hljs-string">"coffeePot"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doCoffeePot</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"doCoffeePot()"</span>);    &#125;&#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(Mediator mediator)</span> </span>&#123;        mediator.doEvent(<span class="hljs-string">"calender"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doCalender</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"doCalender()"</span>);    &#125;&#125;</code></pre><p>ä¸­ä»‹è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mediator</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doEvent</span><span class="hljs-params">(String eventType)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteMediator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Mediator</span> </span>&#123;    <span class="hljs-keyword">private</span> Alarm alarm;    <span class="hljs-keyword">private</span> CoffeePot coffeePot;    <span class="hljs-keyword">private</span> Calender calender;    <span class="hljs-keyword">private</span> Sprinkler sprinkler;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcreteMediator</span><span class="hljs-params">(Alarm alarm, CoffeePot coffeePot, Calender calender, Sprinkler sprinkler)</span> </span>&#123;        <span class="hljs-keyword">this</span>.alarm = alarm;        <span class="hljs-keyword">this</span>.coffeePot = coffeePot;        <span class="hljs-keyword">this</span>.calender = calender;        <span class="hljs-keyword">this</span>.sprinkler = sprinkler;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doEvent</span><span class="hljs-params">(String eventType)</span> </span>&#123;        <span class="hljs-keyword">switch</span> (eventType) &#123;            <span class="hljs-keyword">case</span> <span class="hljs-string">"alarm"</span>:                doAlarmEvent();                <span class="hljs-keyword">break</span>;            <span class="hljs-keyword">case</span> <span class="hljs-string">"coffeePot"</span>:                doCoffeePotEvent();                <span class="hljs-keyword">break</span>;            <span class="hljs-keyword">case</span> <span class="hljs-string">"calender"</span>:                doCalenderEvent();                <span class="hljs-keyword">break</span>;            <span class="hljs-keyword">default</span>:                doSprinklerEvent();        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doAlarmEvent</span><span class="hljs-params">()</span> </span>&#123;        alarm.doAlarm();        coffeePot.doCoffeePot();        calender.doCalender();        sprinkler.doSprinkler();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doCoffeePotEvent</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// ...</span>    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doCalenderEvent</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// ...</span>    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSprinklerEvent</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// ...</span>    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Alarm alarm = <span class="hljs-keyword">new</span> Alarm();        CoffeePot coffeePot = <span class="hljs-keyword">new</span> CoffeePot();        Calender calender = <span class="hljs-keyword">new</span> Calender();        Sprinkler sprinkler = <span class="hljs-keyword">new</span> Sprinkler();        Mediator mediator = <span class="hljs-keyword">new</span> ConcreteMediator(alarm, coffeePot, calender, sprinkler);        <span class="hljs-comment">// é—¹é’Ÿäº‹ä»¶åˆ°è¾¾ï¼Œè°ƒç”¨ä¸­ä»‹è€…å°±å¯ä»¥æ“ä½œç›¸å…³å¯¹è±¡</span>        alarm.onEvent(mediator);    &#125;&#125;</code></pre><h1 id="å¤‡å¿˜å½•memento"><a class="markdownIt-Anchor" href="#å¤‡å¿˜å½•memento"></a> å¤‡å¿˜å½•ï¼ˆMementoï¼‰</h1><blockquote><p>åœ¨ä¸è¿åå°è£…çš„æƒ…å†µä¸‹è·å¾—å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œåœ¨éœ€è¦æ—¶å¯ä»¥å°†å¯¹è±¡æ¢å¤åˆ°æœ€åˆçŠ¶æ€ã€‚</p></blockquote><ul><li><code>Originator</code>ï¼šåŸå§‹å¯¹è±¡</li><li><code>Caretaker</code>ï¼šè´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•</li><li><code>Memento</code>ï¼šå¤‡å¿˜å½•ï¼Œå­˜å‚¨åŸå§‹å¯¹è±¡çš„çš„çŠ¶æ€ã€‚å¤‡å¿˜å½•å®é™…ä¸Šæœ‰ä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ˜¯æä¾›ç»™ <code>Caretaker</code> çš„çª„æ¥å£ï¼šå®ƒåªèƒ½å°†å¤‡å¿˜å½•ä¼ é€’ç»™å…¶å®ƒå¯¹è±¡ï¼›ä¸€ä¸ªæ˜¯æä¾›ç»™ <code>Originator</code> çš„å®½æ¥å£ï¼Œå…è®¸å®ƒè®¿é—®åˆ°å…ˆå‰çŠ¶æ€æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚ç†æƒ³æƒ…å†µæ˜¯åªå…è®¸ <code>Originator</code> è®¿é—®æœ¬å¤‡å¿˜å½•çš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109152140.png" srcset="/img/loading.gif" alt="" /></p><h1 id="è§‚å¯Ÿè€…observer"><a class="markdownIt-Anchor" href="#è§‚å¯Ÿè€…observer"></a> è§‚å¯Ÿè€…ï¼ˆObserverï¼‰</h1><blockquote><p>å®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œå®ƒçš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶ä¸”è‡ªåŠ¨æ›´æ–°çŠ¶æ€ã€‚</p><p>ä¸»é¢˜ï¼ˆ<code>Subject</code>ï¼‰æ˜¯è¢«è§‚å¯Ÿçš„å¯¹è±¡ï¼Œè€Œå…¶æ‰€æœ‰ä¾èµ–è€…ï¼ˆ<code>Observer</code>ï¼‰ç§°ä¸ºè§‚å¯Ÿè€…ã€‚</p></blockquote><p>ä¸»é¢˜ï¼ˆSubjectï¼‰å…·æœ‰æ³¨å†Œå’Œç§»é™¤è§‚å¯Ÿè€…ã€å¹¶é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…çš„åŠŸèƒ½ï¼Œä¸»é¢˜æ˜¯é€šè¿‡ç»´æŠ¤ä¸€å¼ è§‚å¯Ÿè€…åˆ—è¡¨æ¥å®ç°è¿™äº›æ“ä½œçš„ã€‚</p><p>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰çš„æ³¨å†ŒåŠŸèƒ½éœ€è¦è°ƒç”¨ä¸»é¢˜çš„ registerObserver() æ–¹æ³•ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109152656.png" srcset="/img/loading.gif" alt="" /></p><p>è¢«è§‚å¯Ÿå¯¹è±¡ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Subject</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ³¨å†Œè§‚å¯Ÿè€…</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> o</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">registerObserver</span><span class="hljs-params">(Observer o)</span></span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§»é™¤è§‚å¯Ÿè€…</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> o</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(Observer o)</span></span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * é€šçŸ¥è§‚å¯Ÿè€…</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">notifyObserver</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeatherData</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Subject</span> </span>&#123;    List&lt;Observer&gt; observers;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> temperature;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> humidity;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> pressure;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">WeatherData</span><span class="hljs-params">()</span> </span>&#123;        observers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMeasurements</span><span class="hljs-params">(<span class="hljs-keyword">float</span> temperature, <span class="hljs-keyword">float</span> humidity, <span class="hljs-keyword">float</span> pressure)</span> </span>&#123;        <span class="hljs-keyword">this</span>.temperature = temperature;        <span class="hljs-keyword">this</span>.humidity = humidity;        <span class="hljs-keyword">this</span>.pressure = pressure;        <span class="hljs-comment">// æ•°æ®æ›´æ–°å®Œæˆåï¼Œé€šçŸ¥è§‚å¯Ÿè€…</span>        notifyObserver();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">registerObserver</span><span class="hljs-params">(Observer o)</span> </span>&#123;        observers.add(o);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(Observer o)</span> </span>&#123;        observers.remove(o);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notifyObserver</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">for</span> (Observer o : observers) &#123;            o.update(temperature, humidity, pressure);        &#125;    &#125;&#125;</code></pre><p>è§‚å¯Ÿè€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Observer</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ¥æ”¶æ¥è‡ªè§‚å¯Ÿå¯¹è±¡çš„æ›´æ–°æ•°æ®</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> temp</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> humidity</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pressure</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> humidity, <span class="hljs-keyword">float</span> pressure)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StatisticsDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Observer</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">StatisticsDisplay</span><span class="hljs-params">(Subject weatherData)</span> </span>&#123;        <span class="hljs-comment">// æ³¨å†Œè§‚å¯Ÿè€…</span>        weatherData.registerObserver(<span class="hljs-keyword">this</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> humidity, <span class="hljs-keyword">float</span> pressure)</span> </span>&#123;        System.out.println(<span class="hljs-string">"StatisticsDisplay#update: "</span> + temp + <span class="hljs-string">" "</span> + humidity + <span class="hljs-string">" "</span> + pressure);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CurrentConditionsDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Observer</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CurrentConditionsDisplay</span><span class="hljs-params">(Subject weatherData)</span> </span>&#123;        <span class="hljs-comment">// æ³¨å†Œè§‚å¯Ÿè€…</span>        weatherData.registerObserver(<span class="hljs-keyword">this</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">float</span> temp, <span class="hljs-keyword">float</span> humidity, <span class="hljs-keyword">float</span> pressure)</span> </span>&#123;        System.out.println(<span class="hljs-string">"CurrentConditionsDisplay#update: "</span> + temp + <span class="hljs-string">" "</span> + humidity + <span class="hljs-string">" "</span> + pressure);    &#125;&#125;</code></pre><p>è°ƒç”¨ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeatherStation</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        WeatherData weatherData = <span class="hljs-keyword">new</span> WeatherData();        CurrentConditionsDisplay currentConditionsDisplay = <span class="hljs-keyword">new</span> CurrentConditionsDisplay(weatherData);        StatisticsDisplay statisticsDisplay = <span class="hljs-keyword">new</span> StatisticsDisplay(weatherData);        weatherData.setMeasurements(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);        weatherData.setMeasurements(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);    &#125;&#125;</code></pre><h1 id="çŠ¶æ€state"><a class="markdownIt-Anchor" href="#çŠ¶æ€state"></a> çŠ¶æ€ï¼ˆStateï¼‰</h1><blockquote><p>å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒæ‰€å±çš„ç±»ã€‚</p><p>æ‰€è°“çš„çŠ¶æ€è½¬ç§»ï¼Œæ˜¯æŒ‡ <code>Context</code> åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ç”±äºä¸€äº›æ¡ä»¶å‘ç”Ÿæ”¹å˜è€Œä½¿å¾— <code>State</code> å¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œæ³¨æ„å¿…é¡»è¦æ˜¯åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109160939.png" srcset="/img/loading.gif" alt="" /></p><h1 id="ç­–ç•¥strategy"><a class="markdownIt-Anchor" href="#ç­–ç•¥strategy"></a> ç­–ç•¥ï¼ˆStrategyï¼‰</h1><blockquote><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°è£…æ¯ä¸ªç®—æ³•ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥äº’æ¢ã€‚</p><p>ç­–ç•¥æ¨¡å¼å¯ä»¥è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç«¯ã€‚</p></blockquote><ul><li><code>Strategy</code> æ¥å£å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æ—ï¼Œå®ƒä»¬éƒ½å®ç°äº† <code>behavior()</code> æ–¹æ³•ã€‚</li><li><code>Context</code> æ˜¯ä½¿ç”¨åˆ°è¯¥ç®—æ³•æ—çš„ç±»ï¼Œå…¶ä¸­çš„ <code>doSomething()</code> æ–¹æ³•ä¼šè°ƒç”¨ <code>behavior()</code>ï¼Œ<code>setStrategy(Strategy)</code> æ–¹æ³•å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ <code>strategy</code> å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½åŠ¨æ€åœ°æ”¹å˜ <code>Context</code> æ‰€ä½¿ç”¨çš„ç®—æ³•ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201109161431.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸çŠ¶æ€æ¨¡å¼çš„æ¯”è¾ƒï¼š</p><ul><li>çŠ¶æ€æ¨¡å¼çš„ç±»å›¾å’Œç­–ç•¥æ¨¡å¼ç±»ä¼¼ï¼Œå¹¶ä¸”éƒ½æ˜¯èƒ½å¤ŸåŠ¨æ€æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚ä½†æ˜¯çŠ¶æ€æ¨¡å¼æ˜¯é€šè¿‡<strong>çŠ¶æ€è½¬ç§»</strong>æ¥æ”¹å˜ <code>Context</code> æ‰€ç»„åˆçš„ State å¯¹è±¡ï¼Œè€Œç­–ç•¥æ¨¡å¼æ˜¯é€šè¿‡ <strong><code>Context</code> æœ¬èº«çš„å†³ç­–</strong>æ¥æ”¹å˜ç»„åˆçš„ <code>Strategy</code> å¯¹è±¡ã€‚</li><li>çŠ¶æ€æ¨¡å¼ä¸»è¦æ˜¯ç”¨æ¥è§£å†³çŠ¶æ€è½¬ç§»çš„é—®é¢˜ï¼Œå½“çŠ¶æ€å‘ç”Ÿè½¬ç§»äº†ï¼Œé‚£ä¹ˆ <code>Context</code> å¯¹è±¡å°±ä¼šæ”¹å˜å®ƒçš„è¡Œä¸ºï¼›è€Œç­–ç•¥æ¨¡å¼ä¸»è¦æ˜¯ç”¨æ¥<strong>å°è£…ä¸€ç»„å¯ä»¥äº’ç›¸æ›¿ä»£çš„ç®—æ³•æ—</strong>ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åœ°å»æ›¿æ¢ <code>Context</code> ä½¿ç”¨çš„ç®—æ³•ã€‚</li><li>ç­–ç•¥æ¨¡å¼ä¸­ï¼Œæ˜¯ <code>Client</code> æä¾›äº†ä¸åŒçš„ç­–ç•¥ç»™ <code>Context</code>ï¼›çŠ¶æ€æ¨¡å¼ä¸­ï¼ŒçŠ¶æ€è½¬ç§»ç”± <code>Context</code> æˆ– <code>State</code> è‡ªå·±ç®¡ç†ã€‚</li></ul><p>Strategy:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Behavior</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å‘å‡ºå«å£°</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quack</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QuackBehavior</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Behavior</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quack</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"quack"</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SqueakBehavior</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Behavior</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quack</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"squeak"</span>);    &#125;&#125;</code></pre><p>Context:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Duck</span> </span>&#123;    <span class="hljs-keyword">private</span> Behavior behavior;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">performQuack</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (behavior != <span class="hljs-keyword">null</span>) &#123;            behavior.quack();        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½®å…·ä½“çš„ç­–ç•¥</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> behavior</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBehavior</span><span class="hljs-params">(Behavior behavior)</span> </span>&#123;        <span class="hljs-keyword">this</span>.behavior = behavior;    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Duck duck = <span class="hljs-keyword">new</span> Duck();        <span class="hljs-comment">// è®¾ç½®ç­–ç•¥ 1</span>        duck.setBehavior(<span class="hljs-keyword">new</span> QuackBehavior());        duck.performQuack();        <span class="hljs-comment">// è®¾ç½®ç­–ç•¥ 2</span>        duck.setBehavior(<span class="hljs-keyword">new</span> SqueakBehavior());        duck.performQuack();    &#125;&#125;</code></pre><h1 id="æ¨¡æ¿æ–¹æ³•template-method"><a class="markdownIt-Anchor" href="#æ¨¡æ¿æ–¹æ³•template-method"></a> æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰</h1><blockquote><p>å®šä¹‰ç®—æ³•æ¡†æ¶ï¼Œå¹¶å°†ä¸€äº›æ­¥éª¤çš„å®ç°å»¶è¿Ÿåˆ°å­ç±»ã€‚</p><p>é€šè¿‡æ¨¡æ¿æ–¹æ³•ï¼Œå­ç±»å¯ä»¥é‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›æ­¥éª¤ï¼Œè€Œä¸ç”¨æ”¹å˜ç®—æ³•çš„ç»“æ„ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110123611.png" srcset="/img/loading.gif" alt="" /></p><p>æ¨¡æ¿ç±»ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CaffeineBeverage</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">prepareRecipe</span><span class="hljs-params">()</span> </span>&#123;        boilWater();        brew();        pourInCup();        addCondiments();    &#125;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">brew</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addCondiments</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">boilWater</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"boilWater"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pourInCup</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"pourInCup"</span>);    &#125;&#125;</code></pre><p>å­ç±»ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Coffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CaffeineBeverage</span></span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">brew</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Coffee#brew"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addCondiments</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Coffee#addCondiments"</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tea</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CaffeineBeverage</span></span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">brew</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Tea#brew"</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addCondiments</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Tea#addCondiments"</span>);    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        CaffeineBeverage caffeineBeverage = <span class="hljs-keyword">new</span> Coffee();        caffeineBeverage.prepareRecipe();        System.out.println(<span class="hljs-string">"-------------------"</span>);        caffeineBeverage = <span class="hljs-keyword">new</span> Tea();        caffeineBeverage.prepareRecipe();    &#125;&#125;</code></pre><h1 id="è®¿é—®è€…visitor"><a class="markdownIt-Anchor" href="#è®¿é—®è€…visitor"></a> è®¿é—®è€…ï¼ˆVisitorï¼‰</h1><blockquote><p>ä¸ºä¸€ä¸ªå¯¹è±¡ç»“æ„ï¼ˆæ¯”å¦‚ç»„åˆç»“æ„ï¼‰å¢åŠ æ–°èƒ½åŠ›ã€‚</p></blockquote><ul><li><code>Visitor</code>ï¼šè®¿é—®è€…ï¼Œä¸ºæ¯ä¸€ä¸ª ConcreteElement å£°æ˜ä¸€ä¸ª visit æ“ä½œ</li><li><code>ConcreteVisitor</code>ï¼šå…·ä½“è®¿é—®è€…ï¼Œå­˜å‚¨éå†è¿‡ç¨‹ä¸­çš„ç´¯è®¡ç»“æœ</li><li><code>ObjectStructure</code>ï¼šå¯¹è±¡ç»“æ„ï¼Œå¯ä»¥æ˜¯ç»„åˆç»“æ„ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªé›†åˆã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110124620.png" srcset="/img/loading.gif" alt="" /></p><p>å…ƒç´ ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Element</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¿é—®è€…å¯è®¿é—®å…ƒç´ </span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> visitor</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor visitor)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Element</span> </span>&#123;    <span class="hljs-keyword">private</span> String name;    <span class="hljs-keyword">private</span> List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Customer</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">this</span>.name = name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addOrder</span><span class="hljs-params">(Order order)</span> </span>&#123;        orders.add(order);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor visitor)</span> </span>&#123;        visitor.visit(<span class="hljs-keyword">this</span>);        <span class="hljs-keyword">for</span> (Order order : orders) &#123;            order.accept(visitor);        &#125;    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Element</span> </span>&#123;    <span class="hljs-keyword">private</span> String name;    <span class="hljs-keyword">private</span> List&lt;Item&gt; items = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Order</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">this</span>.name = name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Order</span><span class="hljs-params">(String name, String itemName)</span> </span>&#123;        <span class="hljs-keyword">this</span>.name = name;        <span class="hljs-keyword">this</span>.addItem(<span class="hljs-keyword">new</span> Item(itemName));    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addItem</span><span class="hljs-params">(Item item)</span> </span>&#123;        items.add(item);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor visitor)</span> </span>&#123;        visitor.visit(<span class="hljs-keyword">this</span>);        <span class="hljs-keyword">for</span> (Item item : items) &#123;            item.accept(visitor);        &#125;    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Item</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Element</span> </span>&#123;    <span class="hljs-keyword">private</span> String name;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Item</span><span class="hljs-params">(String name)</span> </span>&#123;        <span class="hljs-keyword">this</span>.name = name;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> name;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor visitor)</span> </span>&#123;        visitor.visit(<span class="hljs-keyword">this</span>);    &#125;&#125;</code></pre><p>è®¿é—®è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Visitor</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¿é—® customer</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> customer</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Customer customer)</span></span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¿é—® order</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> order</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Order order)</span></span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¿é—® item</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> item</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Item item)</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GeneralReport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Visitor</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> customersNo;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> ordersNo;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> itemsNo;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Customer customer)</span> </span>&#123;        System.out.println(customer.getName());        customersNo++;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Order order)</span> </span>&#123;        System.out.println(order.getName());        ordersNo++;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">visit</span><span class="hljs-params">(Item item)</span> </span>&#123;        System.out.println(item.getName());        itemsNo++;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">displayResults</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"Number of customers: "</span> + customersNo);        System.out.println(<span class="hljs-string">"Number of orders: "</span> + ordersNo);        System.out.println(<span class="hljs-string">"Number of items: "</span> + itemsNo);    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerGroup</span> </span>&#123;    <span class="hljs-keyword">private</span> List&lt;Customer&gt; customers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(Visitor visitor)</span> </span>&#123;        <span class="hljs-keyword">for</span> (Customer customer : customers) &#123;            customer.accept(visitor);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addCustomer</span><span class="hljs-params">(Customer customer)</span> </span>&#123;        customers.add(customer);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-comment">// Element: Customer has Order has Item</span>        <span class="hljs-comment">// customer1</span>        Customer customer1 = <span class="hljs-keyword">new</span> Customer(<span class="hljs-string">"customer1"</span>);        customer1.addOrder(<span class="hljs-keyword">new</span> Order(<span class="hljs-string">"order1"</span>, <span class="hljs-string">"item11"</span>));        customer1.addOrder(<span class="hljs-keyword">new</span> Order(<span class="hljs-string">"order2"</span>, <span class="hljs-string">"item21"</span>));        customer1.addOrder(<span class="hljs-keyword">new</span> Order(<span class="hljs-string">"order3"</span>, <span class="hljs-string">"item31"</span>));        <span class="hljs-comment">// customer2</span>        Order order = <span class="hljs-keyword">new</span> Order(<span class="hljs-string">"order2"</span>);        order.addItem(<span class="hljs-keyword">new</span> Item(<span class="hljs-string">"item21"</span>));        order.addItem(<span class="hljs-keyword">new</span> Item(<span class="hljs-string">"item22"</span>));        order.addItem(<span class="hljs-keyword">new</span> Item(<span class="hljs-string">"item23"</span>));        Customer customer2 = <span class="hljs-keyword">new</span> Customer(<span class="hljs-string">"customer2"</span>);        customer2.addOrder(order);        <span class="hljs-comment">// CustomerGroup has Customer</span>        CustomerGroup customers = <span class="hljs-keyword">new</span> CustomerGroup();        customers.addCustomer(customer1);        customers.addCustomer(customer2);        GeneralReport visitor = <span class="hljs-keyword">new</span> GeneralReport();        customers.accept(visitor);        visitor.displayResults();    &#125;&#125;</code></pre><h1 id="ç©ºå¯¹è±¡null"><a class="markdownIt-Anchor" href="#ç©ºå¯¹è±¡null"></a> ç©ºå¯¹è±¡ï¼ˆNullï¼‰</h1><blockquote><p>ä½¿ç”¨ä»€ä¹ˆéƒ½ä¸åšçš„ç©ºå¯¹è±¡æ¥ä»£æ›¿ NULLã€‚</p><p>ä¸€ä¸ªæ–¹æ³•è¿”å› <code>NULL</code>ï¼Œæ„å‘³ç€æ–¹æ³•çš„è°ƒç”¨ç«¯éœ€è¦å»æ£€æŸ¥è¿”å›å€¼æ˜¯å¦æ˜¯ <code>NULL</code>ï¼Œè¿™ä¹ˆåšä¼šå¯¼è‡´éå¸¸å¤šçš„å†—ä½™çš„æ£€æŸ¥ä»£ç ã€‚å¹¶ä¸”å¦‚æœæŸä¸€ä¸ªè°ƒç”¨ç«¯å¿˜è®°äº†åšè¿™ä¸ªæ£€æŸ¥è¿”å›å€¼ï¼Œè€Œç›´æ¥ä½¿ç”¨è¿”å›çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201110133531.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AbstractOperation</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ“ä½œæ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">request</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NullOperation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AbstractOperation</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">request</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// do nothing</span>    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RealOperation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AbstractOperation</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">request</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(<span class="hljs-string">"do something"</span>);    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        AbstractOperation abstractOperation = func(-<span class="hljs-number">1</span>);        abstractOperation.request();    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AbstractOperation <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>&#123;        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> NullOperation();        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RealOperation();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 327. åŒºé—´å’Œçš„ä¸ªæ•°</title>
    <link href="/2020/11/07/LeetCode-327-count-of-range-sum/"/>
    <url>/2020/11/07/LeetCode-327-count-of-range-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/count-of-range-sum/" target="_blank" rel="noopener">327. åŒºé—´å’Œçš„ä¸ªæ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countRangeSum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> lower, <span class="hljs-keyword">int</span> upper)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">long</span>[] preSum = <span class="hljs-keyword">new</span> <span class="hljs-keyword">long</span>[len + <span class="hljs-number">1</span>];    preSum[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        preSum[i] = preSum[i - <span class="hljs-number">1</span>] + nums[i - <span class="hljs-number">1</span>];    &#125;    <span class="hljs-comment">//  0  1   2  3</span>    <span class="hljs-comment">// -2, 5, -1</span>    <span class="hljs-comment">//  0 -2   3  2</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt;= len; j++) &#123;            <span class="hljs-keyword">long</span> sum = preSum[j] - preSum[i];            <span class="hljs-keyword">if</span> (lower &lt;= sum &amp;&amp; sum &lt;= upper) &#123;                count++;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1356. æ ¹æ®æ•°å­—äºŒè¿›åˆ¶ä¸‹ 1 çš„æ•°ç›®æ’åº</title>
    <link href="/2020/11/06/LeetCode-1356-sort-integers-by-the-number-of-1-bits/"/>
    <url>/2020/11/06/LeetCode-1356-sort-integers-by-the-number-of-1-bits/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-integers-by-the-number-of-1-bits/" target="_blank" rel="noopener">1356. æ ¹æ®æ•°å­—äºŒè¿›åˆ¶ä¸‹ 1 çš„æ•°ç›®æ’åº</a></p><h1 id="æ’åº"><a class="markdownIt-Anchor" href="#æ’åº"></a> æ’åº</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortByBits(<span class="hljs-keyword">int</span>[] arr) &#123;    <span class="hljs-keyword">int</span> len = arr.length;    Integer[] nums = <span class="hljs-keyword">new</span> Integer[len];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        nums[i] = arr[i];    &#125;    Arrays.sort(nums, (o1, o2) -&gt; &#123;        <span class="hljs-keyword">int</span> count1 = Integer.bitCount(o1);        <span class="hljs-keyword">int</span> count2 = Integer.bitCount(o2);        <span class="hljs-keyword">return</span> count1 == count2 ? o1 - o2 : count1 - count2;    &#125;);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        arr[i] = nums[i];    &#125;    <span class="hljs-keyword">return</span> arr;&#125;</code></pre><h1 id="ä¼˜å…ˆé˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#ä¼˜å…ˆé˜Ÿåˆ—"></a> ä¼˜å…ˆé˜Ÿåˆ—</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortByBits(<span class="hljs-keyword">int</span>[] arr) &#123;    <span class="hljs-keyword">int</span> len = arr.length;    <span class="hljs-comment">// int[2]: 0 -&gt; 1 çš„ä¸ªæ•°ï¼Œ1 -&gt; arr[i]</span>    PriorityQueue&lt;<span class="hljs-keyword">int</span>[]&gt; minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o1[<span class="hljs-number">0</span>] == o2[<span class="hljs-number">0</span>] ? o1[<span class="hljs-number">1</span>] - o2[<span class="hljs-number">1</span>] : o1[<span class="hljs-number">0</span>] - o2[<span class="hljs-number">0</span>]);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        <span class="hljs-keyword">int</span>[] map = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;countOnes(num), num&#125;;        minHeap.add(map);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        arr[i] = minHeap.poll()[<span class="hljs-number">1</span>];    &#125;    <span class="hljs-keyword">return</span> arr;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countOnes</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (num != <span class="hljs-number">0</span>) &#123;        num = num &amp; (num - <span class="hljs-number">1</span>);        count++;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </title>
    <link href="/2020/11/06/LeetCode-230-kth-smallest-element-in-a-bst/"/>
    <url>/2020/11/06/LeetCode-230-kth-smallest-element-in-a-bst/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/kth-smallest-element-in-a-bst/" target="_blank" rel="noopener">230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </a></p><h1 id="ä¸­åºéå†"><a class="markdownIt-Anchor" href="#ä¸­åºéå†"></a> ä¸­åºéå†</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">kthSmallest</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    Deque&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span> || !stack.isEmpty()) &#123;        <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span>) &#123;            stack.push(root);            root = root.left;        &#125;        TreeNode top = stack.pop();        <span class="hljs-keyword">if</span> (++count == k) &#123;            <span class="hljs-keyword">return</span> top.val;        &#125;        root = top.right;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 226. ç¿»è½¬äºŒå‰æ ‘</title>
    <link href="/2020/11/06/LeetCode-226-invert-binary-tree/"/>
    <url>/2020/11/06/LeetCode-226-invert-binary-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/invert-binary-tree/" target="_blank" rel="noopener">226. ç¿»è½¬äºŒå‰æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">invertTree</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    TreeNode tmp = root.left;    root.left = root.right;    root.right = tmp;    invertTree(root.left);    invertTree(root.right);    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼-åˆ›å»ºå‹</title>
    <link href="/2020/11/06/design-patterns-creational/"/>
    <url>/2020/11/06/design-patterns-creational/</url>
    
    <content type="html"><![CDATA[<h1 id="å•ä¾‹singleton"><a class="markdownIt-Anchor" href="#å•ä¾‹singleton"></a> å•ä¾‹ï¼ˆSingletonï¼‰</h1><blockquote><p>ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›è¯¥å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚</p></blockquote><p>ä½¿ç”¨ä¸€ä¸ªç§æœ‰æ„é€ å‡½æ•°ã€ä¸€ä¸ªç§æœ‰é™æ€å˜é‡ä»¥åŠä¸€ä¸ªå…¬æœ‰é™æ€å‡½æ•°æ¥å®ç°ã€‚</p><p>ç§æœ‰æ„é€ å‡½æ•°ä¿è¯äº†ä¸èƒ½é€šè¿‡æ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œåªèƒ½é€šè¿‡å…¬æœ‰é™æ€å‡½æ•°è¿”å›å”¯ä¸€çš„ç§æœ‰é™æ€å˜é‡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106130230.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨"><a class="markdownIt-Anchor" href="#æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨"></a> æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨</h2><p>ä»¥ä¸‹å®ç°ä¸­ï¼Œç§æœ‰é™æ€å˜é‡ <code>uniqueInstance</code> è¢«å»¶è¿Ÿå®ä¾‹åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°è¯¥ç±»ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå®ä¾‹åŒ– <code>uniqueInstance</code>ï¼Œä»è€ŒèŠ‚çº¦èµ„æºã€‚</p><p>è¿™ä¸ªå®ç°åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹èƒ½å¤ŸåŒæ—¶è¿›å…¥ <code>if (uniqueInstance == null)</code> ï¼Œå¹¶ä¸”æ­¤æ—¶ <code>uniqueInstance</code> ä¸º <code>null</code>ï¼Œé‚£ä¹ˆä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ‰§è¡Œ <code>uniqueInstance = new Singleton();</code> è¯­å¥ï¼Œè¿™å°†å¯¼è‡´å®ä¾‹åŒ–å¤šæ¬¡ <code>uniqueInstance</code>ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton uniqueInstance;        <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (uniqueInstance == <span class="hljs-keyword">null</span>) &#123;            uniqueInstance = <span class="hljs-keyword">new</span> Singleton();        &#125;        <span class="hljs-keyword">return</span> uniqueInstance;    &#125;&#125;</code></pre><h2 id="æ‡’æ±‰å¼-çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#æ‡’æ±‰å¼-çº¿ç¨‹å®‰å…¨"></a> æ‡’æ±‰å¼-çº¿ç¨‹å®‰å…¨</h2><p>åªéœ€è¦å¯¹ <code>getUniqueInstance()</code> æ–¹æ³•åŠ é”ï¼Œé‚£ä¹ˆåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¿›å…¥è¯¥æ–¹æ³•ï¼Œä»è€Œé¿å…äº†å®ä¾‹åŒ–å¤šæ¬¡ <code>uniqueInstance</code>ã€‚</p><p>ä½†æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥æ–¹æ³•ä¹‹åï¼Œå…¶å®ƒè¯•å›¾è¿›å…¥è¯¥æ–¹æ³•çš„çº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…ï¼Œå³ä½¿ <code>uniqueInstance</code> å·²ç»è¢«å®ä¾‹åŒ–äº†ã€‚<strong>è¿™ä¼šè®©çº¿ç¨‹é˜»å¡æ—¶é—´è¿‡é•¿ï¼Œå› æ­¤è¯¥æ–¹æ³•æœ‰æ€§èƒ½é—®é¢˜ï¼Œä¸æ¨èä½¿ç”¨ã€‚</strong></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton uniqueInstance;        <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;    &#125;-   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;+   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (uniqueInstance == <span class="hljs-keyword">null</span>) &#123;            uniqueInstance = <span class="hljs-keyword">new</span> Singleton();        &#125;        <span class="hljs-keyword">return</span> uniqueInstance;    &#125;&#125;</code></pre><h2 id="é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨"></a> é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨</h2><p>çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯ç”±äº <code>uniqueInstance</code> è¢«å®ä¾‹åŒ–å¤šæ¬¡ï¼Œé‡‡å–ç›´æ¥å®ä¾‹åŒ– <code>uniqueInstance</code> çš„æ–¹å¼å°±ä¸ä¼šäº§ç”Ÿçº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ã€‚</p><p>ä½†æ˜¯ç›´æ¥å®ä¾‹åŒ–çš„æ–¹å¼ä¹Ÿ<strong>ä¸¢å¤±äº†å»¶è¿Ÿå®ä¾‹åŒ–å¸¦æ¥çš„èŠ‚çº¦èµ„æºçš„å¥½å¤„</strong>ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton uniqueInstance = <span class="hljs-keyword">new</span> Singleton();    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> uniqueInstance;    &#125;&#125;</code></pre><h2 id="åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨"></a> åŒé‡æ ¡éªŒé”-çº¿ç¨‹å®‰å…¨</h2><p><code>uniqueInstance</code> åªéœ€è¦è¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚åŠ é”æ“ä½œåªéœ€è¦å¯¹å®ä¾‹åŒ–é‚£éƒ¨åˆ†çš„ä»£ç è¿›è¡Œï¼Œåªæœ‰å½“ <code>uniqueInstance</code> æ²¡æœ‰è¢«å®ä¾‹åŒ–æ—¶ï¼Œæ‰éœ€è¦è¿›è¡ŒåŠ é”ã€‚</p><p>åŒé‡æ ¡éªŒé”å…ˆåˆ¤æ–­ <code>uniqueInstance</code> æ˜¯å¦å·²ç»è¢«å®ä¾‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰è¢«å®ä¾‹åŒ–ï¼Œé‚£ä¹ˆæ‰å¯¹å®ä¾‹åŒ–è¯­å¥è¿›è¡ŒåŠ é”ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * volatile ç¦æ­¢æŒ‡ä»¤é‡æ’</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> Singleton uniqueInstance;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (uniqueInstance == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">synchronized</span> (Singleton<span class="hljs-class">.<span class="hljs-keyword">class</span>) </span>&#123;                <span class="hljs-comment">// é¿å…ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºï¼ŒåŒæ—¶å®ä¾‹åŒ–</span>                <span class="hljs-keyword">if</span> (uniqueInstance == <span class="hljs-keyword">null</span>) &#123;                    uniqueInstance = <span class="hljs-keyword">new</span> Singleton();                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> uniqueInstance;    &#125;&#125;</code></pre><p>è€ƒè™‘ä¸‹é¢çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯åªä½¿ç”¨äº†ä¸€ä¸ª <code>if</code> è¯­å¥ã€‚åœ¨ <code>uniqueInstance == null</code> çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº† <code>if</code> è¯­å¥ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šè¿›å…¥ <code>if</code> è¯­å¥å—å†…ã€‚è™½ç„¶åœ¨ if è¯­å¥å—å†…æœ‰åŠ é”æ“ä½œï¼Œä½†æ˜¯ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šæ‰§è¡Œ <code>uniqueInstance = new Singleton();</code> è¿™æ¡è¯­å¥ï¼Œåªæ˜¯å…ˆåçš„é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œ<strong>ä¸¤æ¬¡å®ä¾‹åŒ–</strong>ã€‚å› æ­¤å¿…é¡»ä½¿ç”¨<strong>åŒé‡æ ¡éªŒé”</strong>ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä½¿ç”¨ä¸¤ä¸ª <code>if</code> è¯­å¥ï¼š</p><ul><li>ç¬¬ä¸€ä¸ª <code>if</code> è¯­å¥ç”¨æ¥é¿å… <code>uniqueInstance</code> å·²ç»è¢«å®ä¾‹åŒ–ä¹‹åçš„åŠ é”æ“ä½œï¼›</li><li>ç¬¬äºŒä¸ª <code>if</code> è¯­å¥è¿›è¡Œäº†åŠ é”ï¼Œæ‰€ä»¥åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œå°±ä¸ä¼šå‡ºç° <code>uniqueInstance == null</code> æ—¶ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œå®ä¾‹åŒ–æ“ä½œã€‚</li></ul><pre><code class="hljs java"><span class="hljs-keyword">if</span> (uniqueInstance == <span class="hljs-keyword">null</span>) &#123;    <span class="hljs-keyword">synchronized</span> (Singleton<span class="hljs-class">.<span class="hljs-keyword">class</span>) </span>&#123;        uniqueInstance = <span class="hljs-keyword">new</span> Singleton();    &#125;&#125;</code></pre><p><code>uniqueInstance</code> é‡‡ç”¨ <code>volatile</code> å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œ <code>uniqueInstance = new Singleton();</code> è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š</p><ol><li>ä¸º <code>uniqueInstance</code> åˆ†é…å†…å­˜ç©ºé—´</li><li>åˆå§‹åŒ– <code>uniqueInstance</code></li><li>å°† <code>uniqueInstance</code> æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li></ol><p>ä½†æ˜¯ç”±äº <code>JVM</code> å…·æœ‰<strong>æŒ‡ä»¤é‡æ’</strong>çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ <code>1&gt;3&gt;2</code>ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ <code>getUniqueInstance()</code> åå‘ç° <code>uniqueInstance</code> ä¸ä¸ºç©ºï¼Œå› æ­¤è¿”å› <code>uniqueInstance</code>ï¼Œä½†æ­¤æ—¶ <code>uniqueInstance</code> è¿˜æœªè¢«åˆå§‹åŒ–ã€‚</p><p>ä½¿ç”¨ <code>volatile</code> å¯ä»¥ç¦æ­¢ <code>JVM</code> çš„æŒ‡ä»¤é‡æ’ï¼Œä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚</p><h2 id="é™æ€å†…éƒ¨ç±»å®ç°-çº¿ç¨‹å®‰å…¨"><a class="markdownIt-Anchor" href="#é™æ€å†…éƒ¨ç±»å®ç°-çº¿ç¨‹å®‰å…¨"></a> é™æ€å†…éƒ¨ç±»å®ç° - çº¿ç¨‹å®‰å…¨</h2><p>å½“ <code>Singleton</code> ç±»è¢«åŠ è½½æ—¶ï¼Œé™æ€å†…éƒ¨ç±» <code>SingletonHolder</code> æ²¡æœ‰è¢«åŠ è½½è¿›å†…å­˜ã€‚åªæœ‰å½“è°ƒç”¨ <code>getUniqueInstance()</code> æ–¹æ³•ä»è€Œè§¦å‘ <code>SingletonHolder.INSTANCE</code> æ—¶ <code>SingletonHolder</code> æ‰ä¼šè¢«åŠ è½½ï¼Œæ­¤æ—¶åˆå§‹åŒ– <code>INSTANCE</code> å®ä¾‹ï¼Œå¹¶ä¸” <code>JVM</code> èƒ½ç¡®ä¿ <code>INSTANCE</code> åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ã€‚</p><p>è¿™ç§æ–¹å¼ä¸ä»…å…·æœ‰å»¶è¿Ÿåˆå§‹åŒ–çš„å¥½å¤„ï¼Œè€Œä¸”ç”± <code>JVM</code> æä¾›äº†å¯¹çº¿ç¨‹å®‰å…¨çš„æ”¯æŒã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Singleton</span><span class="hljs-params">()</span> </span>&#123;    &#125;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SingletonHolder</span> </span>&#123;        <span class="hljs-comment">// é™æ€ç±»åŠ è½½æ—¶å®ä¾‹åŒ–</span>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Singleton INSTANCE = <span class="hljs-keyword">new</span> Singleton();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> SingletonHolder.INSTANCE;    &#125;&#125;</code></pre><h2 id="æšä¸¾å®ç°"><a class="markdownIt-Anchor" href="#æšä¸¾å®ç°"></a> æšä¸¾å®ç°</h2><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Singleton &#123;    INSTANCE;    <span class="hljs-keyword">private</span> String objName;    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getObjName</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> objName;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setObjName</span><span class="hljs-params">(String objName)</span> </span>&#123;        <span class="hljs-keyword">this</span>.objName = objName;    &#125;&#125;</code></pre><p>è¯¥å®ç°å¯ä»¥<strong>é˜²æ­¢åå°„æ”»å‡»</strong>ã€‚åœ¨å…¶å®ƒå®ç°ä¸­ï¼Œé€šè¿‡ <code>setAccessible()</code> æ–¹æ³•å¯ä»¥å°†ç§æœ‰æ„é€ å‡½æ•°çš„è®¿é—®çº§åˆ«è®¾ç½®ä¸º <code>public</code>ï¼Œç„¶åè°ƒç”¨æ„é€ å‡½æ•°ä»è€Œå®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦‚æœè¦é˜²æ­¢è¿™ç§æ”»å‡»ï¼Œéœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­æ·»åŠ é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–çš„ä»£ç ã€‚è¯¥å®ç°æ˜¯ç”± <code>JVM</code> ä¿è¯åªä¼šå®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä¸Šè¿°çš„åå°„æ”»å‡»ã€‚</p><p>è¯¥å®ç°åœ¨å¤šæ¬¡åºåˆ—åŒ–å’Œåºåˆ—åŒ–ä¹‹åï¼Œä¸ä¼šå¾—åˆ°å¤šä¸ªå®ä¾‹ã€‚è€Œå…¶å®ƒå®ç°éœ€è¦ä½¿ç”¨ transient ä¿®é¥°æ‰€æœ‰å­—æ®µï¼Œå¹¶ä¸”å®ç°åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³•ã€‚</p><h1 id="å·¥å‚æ¨¡å¼"><a class="markdownIt-Anchor" href="#å·¥å‚æ¨¡å¼"></a> å·¥å‚æ¨¡å¼</h1><h2 id="ç®€å•å·¥å‚simple-factory"><a class="markdownIt-Anchor" href="#ç®€å•å·¥å‚simple-factory"></a> ç®€å•å·¥å‚ï¼ˆSimple Factoryï¼‰</h2><blockquote><p>åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ä¸å‘å®¢æˆ·æš´éœ²å†…éƒ¨ç»†èŠ‚ï¼Œå¹¶æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„é€šç”¨æ¥å£ã€‚</p></blockquote><p>ç®€å•å·¥å‚æŠŠå®ä¾‹åŒ–çš„æ“ä½œå•ç‹¬æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™ä¸ªç±»å°±æˆä¸ºç®€å•å·¥å‚ç±»ï¼Œè®©ç®€å•å·¥å‚ç±»æ¥å†³å®šåº”è¯¥ç”¨å“ªä¸ªå…·ä½“å­ç±»æ¥å®ä¾‹åŒ–ã€‚</p><p>è¿™æ ·åšèƒ½æŠŠå®¢æˆ·ç±»å’Œå…·ä½“å­ç±»çš„å®ç°è§£è€¦ï¼Œå®¢æˆ·ç±»ä¸å†éœ€è¦çŸ¥é“æœ‰å“ªäº›å­ç±»ä»¥åŠåº”å½“å®ä¾‹åŒ–å“ªä¸ªå­ç±»ã€‚å®¢æˆ·ç±»å¾€å¾€æœ‰å¤šä¸ªï¼Œå¦‚æœä¸ä½¿ç”¨ç®€å•å·¥å‚ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦çŸ¥é“æ‰€æœ‰å­ç±»çš„ç»†èŠ‚ã€‚è€Œä¸”ä¸€æ—¦å­ç±»å‘ç”Ÿæ”¹å˜ï¼Œä¾‹å¦‚å¢åŠ å­ç±»ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å®¢æˆ·ç±»éƒ½è¦è¿›è¡Œä¿®æ”¹ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106135749.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Product</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteProduct</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Product</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteProduct1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Product</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteProduct2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Product</span> </span>&#123;&#125;</code></pre><p>ä»¥ä¸‹çš„ Client ç±»åŒ…å«äº†å®ä¾‹åŒ–çš„ä»£ç ï¼Œè¿™æ˜¯ä¸€ç§é”™è¯¯çš„å®ç°ã€‚å¦‚æœåœ¨å®¢æˆ·ç±»ä¸­å­˜åœ¨è¿™ç§å®ä¾‹åŒ–ä»£ç ï¼Œå°±éœ€è¦è€ƒè™‘å°†ä»£ç æ”¾åˆ°ç®€å•å·¥å‚ä¸­ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-keyword">int</span> type = <span class="hljs-number">1</span>;        Product product;        <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;            product = <span class="hljs-keyword">new</span> ConcreteProduct1();        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">2</span>) &#123;            product = <span class="hljs-keyword">new</span> ConcreteProduct2();        &#125; <span class="hljs-keyword">else</span> &#123;            product = <span class="hljs-keyword">new</span> ConcreteProduct();        &#125;        <span class="hljs-comment">// do something with the product</span>    &#125;&#125;</code></pre><p>ä»¥ä¸‹çš„ <code>SimpleFactory</code> æ˜¯ç®€å•å·¥å‚å®ç°ï¼Œå®ƒè¢«æ‰€æœ‰éœ€è¦è¿›è¡Œå®ä¾‹åŒ–çš„å®¢æˆ·ç±»è°ƒç”¨ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleFactory</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">createProduct</span><span class="hljs-params">(<span class="hljs-keyword">int</span> type)</span> </span>&#123;        <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct1();        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">2</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct2();        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct();    &#125;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        SimpleFactory simpleFactory = <span class="hljs-keyword">new</span> SimpleFactory();        Product product = simpleFactory.createProduct(<span class="hljs-number">1</span>);        <span class="hljs-comment">// do something with the product</span>    &#125;&#125;</code></pre><h2 id="å·¥å‚æ–¹æ³•factory-method"><a class="markdownIt-Anchor" href="#å·¥å‚æ–¹æ³•factory-method"></a> å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰</h2><blockquote><p>å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†ç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–å“ªä¸ªç±»ã€‚å·¥å‚æ–¹æ³•æŠŠå®ä¾‹åŒ–æ“ä½œæ¨è¿Ÿåˆ°å­ç±»ã€‚</p></blockquote><p>åœ¨ç®€å•å·¥å‚ä¸­ï¼Œåˆ›å»ºå¯¹è±¡çš„æ˜¯å¦ä¸€ä¸ªç±»ï¼Œè€Œåœ¨å·¥å‚æ–¹æ³•ä¸­ï¼Œæ˜¯ç”±<strong>å­ç±»</strong>æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><p>ä¸‹å›¾ä¸­ï¼Œ<code>Factory</code> æœ‰ä¸€ä¸ª <code>doSomething()</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦ç”¨åˆ°ä¸€ä¸ªäº§å“å¯¹è±¡ï¼Œè¿™ä¸ªäº§å“å¯¹è±¡ç”± <code>factoryMethod()</code> æ–¹æ³•åˆ›å»ºã€‚è¯¥æ–¹æ³•æ˜¯æŠ½è±¡çš„ï¼Œéœ€è¦ç”±å­ç±»å»å®ç°ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106141233.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Factory</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç”±å…·ä½“çš„å­ç±»å†³å®šè¦å®ä¾‹åŒ–å“ªä¸ªç±»</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Product <span class="hljs-title">factoryMethod</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span> </span>&#123;        Product product = factoryMethod();        <span class="hljs-comment">// do something with the product</span>    &#125;&#125;</code></pre><p>å­ç±»ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">factoryMethod</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct();    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFactory1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">factoryMethod</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct1();    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFactory2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Product <span class="hljs-title">factoryMethod</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcreteProduct2();    &#125;&#125;</code></pre><h2 id="æŠ½è±¡å·¥å‚abstract-factory"><a class="markdownIt-Anchor" href="#æŠ½è±¡å·¥å‚abstract-factory"></a> æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰</h2><blockquote><p>æä¾›ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»º ç›¸å…³çš„<strong>å¯¹è±¡å®¶æ—</strong>ã€‚</p></blockquote><p>æŠ½è±¡å·¥å‚æ¨¡å¼åˆ›å»ºçš„æ˜¯å¯¹è±¡å®¶æ—ï¼Œä¹Ÿå°±æ˜¯å¾ˆå¤šå¯¹è±¡è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™äº›å¯¹è±¡æ˜¯ç›¸å…³çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»ä¸€èµ·åˆ›å»ºå‡ºæ¥ã€‚è€Œå·¥å‚æ–¹æ³•æ¨¡å¼åªæ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™å’ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¾ˆå¤§ä¸åŒã€‚</p><p><strong>æŠ½è±¡å·¥å‚æ¨¡å¼ç”¨åˆ°äº†å·¥å‚æ–¹æ³•æ¨¡å¼æ¥åˆ›å»ºå•ä¸€å¯¹è±¡</strong>ï¼Œ<code>AbstractFactory</code> ä¸­çš„ <code>createProductA()</code> å’Œ <code>createProductB()</code> æ–¹æ³•éƒ½æ˜¯è®©å­ç±»æ¥å®ç°ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å•ç‹¬æ¥çœ‹å°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ç¬¦åˆå·¥å‚æ–¹æ³•æ¨¡å¼çš„å®šä¹‰ã€‚</p><p>è‡³äºåˆ›å»ºå¯¹è±¡çš„å®¶æ—è¿™ä¸€æ¦‚å¿µæ˜¯åœ¨ <code>Client</code> ä½“ç°ï¼Œ<code>Client</code> è¦é€šè¿‡ <code>AbstractFactory</code> åŒæ—¶è°ƒç”¨ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºå‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œåœ¨è¿™é‡Œè¿™ä¸¤ä¸ªå¯¹è±¡å°±æœ‰å¾ˆå¤§çš„ç›¸å…³æ€§ï¼Œ<code>Client</code> éœ€è¦åŒæ—¶åˆ›å»ºå‡ºè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚</p><p>ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼ŒæŠ½è±¡å·¥å‚ä½¿ç”¨äº†ç»„åˆï¼Œå³ <code>Cilent</code> ç»„åˆäº† <code>AbstractFactory</code>ï¼Œè€Œå·¥å‚æ–¹æ³•æ¨¡å¼ä½¿ç”¨äº†ç»§æ‰¿ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106142709.png" srcset="/img/loading.gif" alt="" /></p><p>Product:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractProductA</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractProductB</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductA1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractProductA</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductA2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractProductA</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductB1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractProductB</span> </span>&#123;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProductB2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractProductB</span> </span>&#123;&#125;</code></pre><p>æŠ½è±¡å·¥å‚ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æŠ½è±¡å·¥å‚ï¼Œä½¿ç”¨å·¥å‚æ–¹æ³•å»ºç«‹å¯¹è±¡</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractFactory</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> AbstractProductA <span class="hljs-title">createProductA</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">abstract</span> AbstractProductB <span class="hljs-title">createProductB</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å­ç±»</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFactory1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractFactory</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function">AbstractProductA <span class="hljs-title">createProductA</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductA1();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function">AbstractProductB <span class="hljs-title">createProductB</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductB1();    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å­ç±»</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteFactory2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractFactory</span> </span>&#123;    <span class="hljs-meta">@Override</span>    <span class="hljs-function">AbstractProductA <span class="hljs-title">createProductA</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductA2();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function">AbstractProductB <span class="hljs-title">createProductB</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductB2();    &#125;&#125;</code></pre><p>Client:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        AbstractFactory abstractFactory = <span class="hljs-keyword">new</span> ConcreteFactory1();        AbstractProductA productA = abstractFactory.createProductA();        AbstractProductB productB = abstractFactory.createProductB();        <span class="hljs-comment">// do something with productA and productB</span>    &#125;&#125;</code></pre><h1 id="å»ºé€ è€…builder"><a class="markdownIt-Anchor" href="#å»ºé€ è€…builder"></a> å»ºé€ è€…ï¼ˆBuilderï¼‰</h1><blockquote><p>å°è£…ä¸€ä¸ªå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ï¼Œå¹¶å…è®¸æŒ‰æ­¥éª¤æ„é€ ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106144846.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractStringBuilder</span> </span>&#123;    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">char</span>[] value;    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> count;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AbstractStringBuilder</span><span class="hljs-params">(<span class="hljs-keyword">int</span> capacity)</span> </span>&#123;        count = <span class="hljs-number">0</span>;        value = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[capacity];    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> AbstractStringBuilder <span class="hljs-title">append</span><span class="hljs-params">(<span class="hljs-keyword">char</span> c)</span> </span>&#123;        ensureCapacityInternal(count + <span class="hljs-number">1</span>);        value[count++] = c;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ensureCapacityInternal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minimumCapacity)</span> </span>&#123;        <span class="hljs-comment">// overflow-conscious code</span>        <span class="hljs-keyword">if</span> (minimumCapacity - value.length &gt; <span class="hljs-number">0</span>)            expandCapacity(minimumCapacity);    &#125;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">expandCapacity</span><span class="hljs-params">(<span class="hljs-keyword">int</span> minimumCapacity)</span> </span>&#123;        <span class="hljs-keyword">int</span> newCapacity = value.length * <span class="hljs-number">2</span> + <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (newCapacity - minimumCapacity &lt; <span class="hljs-number">0</span>)            newCapacity = minimumCapacity;        <span class="hljs-keyword">if</span> (newCapacity &lt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">if</span> (minimumCapacity &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> OutOfMemoryError();            newCapacity = Integer.MAX_VALUE;        &#125;        value = Arrays.copyOf(value, newCapacity);    &#125;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringBuilder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractStringBuilder</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">StringBuilder</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">super</span>(<span class="hljs-number">16</span>);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// Create a copy, don't share the array</span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(value, <span class="hljs-number">0</span>, count);    &#125;&#125;</code></pre><h1 id="åŸå‹æ¨¡å¼prototype"><a class="markdownIt-Anchor" href="#åŸå‹æ¨¡å¼prototype"></a> åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰</h1><blockquote><p>ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šè¦åˆ›å»ºå¯¹è±¡çš„ç±»å‹ï¼Œé€šè¿‡<strong>å¤åˆ¶</strong>è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°å¯¹è±¡ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201106150128.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Prototype</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Prototype <span class="hljs-title">Myclone</span><span class="hljs-params">()</span></span>;&#125;<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcretePrototype</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Prototype</span> </span>&#123;    <span class="hljs-keyword">private</span> String field;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConcretePrototype</span><span class="hljs-params">(String field)</span> </span>&#123;        <span class="hljs-keyword">this</span>.field = field;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Prototype <span class="hljs-title">Myclone</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConcretePrototype(field);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">"ConcretePrototype&#123;"</span> +                <span class="hljs-string">"field='"</span> + field + <span class="hljs-string">'\''</span> +                <span class="hljs-string">'&#125;'</span>;    &#125;&#125;</code></pre><p>Clint:</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Prototype prototype = <span class="hljs-keyword">new</span> ConcretePrototype(<span class="hljs-string">"abc"</span>);        Prototype cloned = prototype.Myclone();        System.out.println(cloned.toString());    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 92. åè½¬é“¾è¡¨ II</title>
    <link href="/2020/11/05/LeetCode-92-reverse-linked-list-ii/"/>
    <url>/2020/11/05/LeetCode-92-reverse-linked-list-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-linked-list-ii/" target="_blank" rel="noopener">92. åè½¬é“¾è¡¨ II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseBetween</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    dummy.next = head;    ListNode link = dummy;    ListNode tail = dummy.next;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; m; i++) &#123;        link = link.next;        tail = tail.next;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = m; i &lt; n; i++) &#123;        <span class="hljs-comment">// å¤´æ’æ³•ï¼šæ’å…¥åˆ° link å</span>        ListNode rm = tail.next;        tail.next = tail.next.next;        rm.next = link.next;        <span class="hljs-comment">// link.next ä¸€ç›´åœ¨å˜</span>        link.next = rm;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 206. åè½¬é“¾è¡¨</title>
    <link href="/2020/11/05/LeetCode-206-reverse-linked-list/"/>
    <url>/2020/11/05/LeetCode-206-reverse-linked-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-linked-list/" target="_blank" rel="noopener">206. åè½¬é“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    ListNode pre = <span class="hljs-keyword">null</span>;    <span class="hljs-keyword">while</span> (head != <span class="hljs-keyword">null</span>) &#123;        ListNode next = head.next;        head.next = pre;        pre = head;        head = next;    &#125;    <span class="hljs-keyword">return</span> pre;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 199. äºŒå‰æ ‘çš„å³è§†å›¾</title>
    <link href="/2020/11/05/LeetCode-199-binary-tree-right-side-view/"/>
    <url>/2020/11/05/LeetCode-199-binary-tree-right-side-view/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-right-side-view/" target="_blank" rel="noopener">199. äºŒå‰æ ‘çš„å³è§†å›¾</a></p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">rightSideView</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    LinkedList&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    queue.add(root);    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            TreeNode curNode = queue.poll();            <span class="hljs-comment">// æ¯å±‚çš„æœ€åä¸€ä¸ªç»“ç‚¹</span>            <span class="hljs-keyword">if</span> (size == <span class="hljs-number">0</span>) &#123;                res.add(curNode.val);            &#125;            <span class="hljs-keyword">if</span> (curNode.left != <span class="hljs-keyword">null</span>) &#123;                queue.add(curNode.left);            &#125;            <span class="hljs-keyword">if</span> (curNode.right != <span class="hljs-keyword">null</span>) &#123;                queue.add(curNode.right);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">rightSideView</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    dfs(root, <span class="hljs-number">0</span>, res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> depth, List&lt;Integer&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// å½“æ·±åº¦ == ä¿å­˜çš„æœ€å³æ•°ç›®ï¼Œè¡¨ç¤ºè¯¥å±‚çš„æœ€å³ç»“ç‚¹è¿˜æ²¡è®¿é—®è¿‡</span>    <span class="hljs-keyword">if</span> (depth == res.size()) &#123;        res.add(root.val);    &#125;    depth++;    <span class="hljs-comment">// å…ˆå³åå·¦ï¼Œä¿è¯æ¯æ¬¡è®¿é—®çš„éƒ½æ˜¯æœ€å³ç»“ç‚¹</span>    dfs(root.right, depth, res);    dfs(root.left, depth, res);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 108. å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘</title>
    <link href="/2020/11/05/LeetCode-108-convert-sorted-array-to-binary-search-tree/"/>
    <url>/2020/11/05/LeetCode-108-convert-sorted-array-to-binary-search-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/convert-sorted-array-to-binary-search-tree/" target="_blank" rel="noopener">108. å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">sortedArrayToBST</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-keyword">return</span> buildTree(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title">buildTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> begin, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">if</span> (begin &gt; end) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-keyword">int</span> rootIdx = begin + (end - begin + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;    TreeNode root = <span class="hljs-keyword">new</span> TreeNode(nums[rootIdx]);    root.left = buildTree(nums, begin, rootIdx - <span class="hljs-number">1</span>);    root.right = buildTree(nums, rootIdx + <span class="hljs-number">1</span>, end);    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>åˆ†æ²»</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 109. æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘</title>
    <link href="/2020/11/05/LeetCode-109-convert-sorted-list-to-binary-search-tree/"/>
    <url>/2020/11/05/LeetCode-109-convert-sorted-list-to-binary-search-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/convert-sorted-list-to-binary-search-tree/" target="_blank" rel="noopener">109. æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘</a></p><h1 id="æ•°ç»„åˆ†å‰²"><a class="markdownIt-Anchor" href="#æ•°ç»„åˆ†å‰²"></a> æ•°ç»„åˆ†å‰²</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">sortedListToBST</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">while</span> (head != <span class="hljs-keyword">null</span>) &#123;        list.add(head.val);        head = head.next;    &#125;    <span class="hljs-keyword">return</span> buildTree(list, <span class="hljs-number">0</span>, list.size() - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title">buildTree</span><span class="hljs-params">(List&lt;Integer&gt; list, <span class="hljs-keyword">int</span> begin, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">if</span> (begin &gt; end) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// æ‰¾åˆ°ä¸­ç‚¹</span>    <span class="hljs-keyword">int</span> rootIdx = begin + (end - begin + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;    <span class="hljs-keyword">int</span> rootVal = list.get(rootIdx);    System.out.println(rootVal + <span class="hljs-string">" begin: "</span> + begin + <span class="hljs-string">" end: "</span> + end);    TreeNode root = <span class="hljs-keyword">new</span> TreeNode(rootVal);    <span class="hljs-comment">// åˆ’åˆ†å·¦å³å­æ ‘</span>    root.left = buildTree(list, begin, rootIdx - <span class="hljs-number">1</span>);    root.right = buildTree(list, rootIdx + <span class="hljs-number">1</span>, end);    <span class="hljs-keyword">return</span> root;&#125;</code></pre><h1 id="å¿«æ…¢æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#å¿«æ…¢æŒ‡é’ˆ"></a> å¿«æ…¢æŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">sortedListToBST</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    ListNode pre = <span class="hljs-keyword">null</span>;    ListNode slow = head;    ListNode fast = head;    <span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆç»“æŸæ—¶ï¼Œslow å³ä¸º root å¯¹åº”çš„å€¼</span>    <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span> &amp;&amp; fast.next != <span class="hljs-keyword">null</span>) &#123;        pre = slow;        slow = slow.next;        fast = fast.next.next;    &#125;    <span class="hljs-comment">// head -&gt; ... -&gt; pre    slow -&gt; slow.next</span>    TreeNode root = <span class="hljs-keyword">new</span> TreeNode(slow.val);    <span class="hljs-comment">// pre æœ‰å€¼æ‰å­˜åœ¨å·¦å­æ ‘</span>    <span class="hljs-keyword">if</span> (pre != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-comment">// åˆ‡æ–­ pre å’Œ slow ä¹‹å‰çš„è”ç³»</span>        pre.next = <span class="hljs-keyword">null</span>;        root.left = sortedListToBST(head);    &#125;    root.right = sortedListToBST(slow.next);    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>åˆ†æ²»</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</title>
    <link href="/2020/11/04/LeetCode-106-construct-binary-tree-from-inorder-and-postorder-traversal/"/>
    <url>/2020/11/04/LeetCode-106-construct-binary-tree-from-inorder-and-postorder-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/" target="_blank" rel="noopener">106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">buildTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] inorder, <span class="hljs-keyword">int</span>[] postorder)</span> </span>&#123;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inorder.length; i++) &#123;        map.put(inorder[i], i);    &#125;    <span class="hljs-keyword">return</span> build(inorder, <span class="hljs-number">0</span>, inorder.length - <span class="hljs-number">1</span>, postorder, <span class="hljs-number">0</span>, postorder.length - <span class="hljs-number">1</span>, map);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] inorder, <span class="hljs-keyword">int</span> iStart, <span class="hljs-keyword">int</span> iEnd, <span class="hljs-keyword">int</span>[] postorder, <span class="hljs-keyword">int</span> pStart, <span class="hljs-keyword">int</span> pEnd, Map&lt;Integer, Integer&gt; map)</span> </span>&#123;    <span class="hljs-keyword">if</span> (iStart &gt; iEnd) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// ä»¥ ååºçš„ç»ˆç‚¹ ä½œä¸º root</span>    <span class="hljs-keyword">int</span> rootVal = postorder[pEnd];    TreeNode root = <span class="hljs-keyword">new</span> TreeNode(rootVal);    <span class="hljs-comment">// åˆ’åˆ† root çš„å·¦å³å­æ ‘</span>    <span class="hljs-keyword">int</span> rootInOrder = map.get(rootVal);    <span class="hljs-keyword">int</span> leftNodesNum = rootInOrder - iStart;    <span class="hljs-comment">// [9,  3,  15,20,7]</span>    <span class="hljs-comment">// [9,  15,7,20,  3]</span>    root.left = build(inorder, iStart, rootInOrder - <span class="hljs-number">1</span>, postorder, pStart, pStart + leftNodesNum - <span class="hljs-number">1</span>, map);    root.right = build(inorder, rootInOrder + <span class="hljs-number">1</span>, iEnd, postorder, pStart + leftNodesNum, pEnd - <span class="hljs-number">1</span>, map);    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>é€’å½’</tag>
      
      <tag>åˆ†æ²»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 57. æ’å…¥åŒºé—´</title>
    <link href="/2020/11/04/LeetCode-57-insert-interval/"/>
    <url>/2020/11/04/LeetCode-57-insert-interval/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/insert-interval/" target="_blank" rel="noopener">57. æ’å…¥åŒºé—´</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] insert(<span class="hljs-keyword">int</span>[][] intervals, <span class="hljs-keyword">int</span>[] newInterval) &#123;    <span class="hljs-keyword">int</span> len = intervals.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[][]&#123;newInterval&#125;;    &#125;    LinkedList&lt;<span class="hljs-keyword">int</span>[]&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æ·»åŠ ä¸é‡å çš„åŒºé—´ï¼šnewInterval èµ·ç‚¹ &gt; start ç»ˆç‚¹</span>    <span class="hljs-comment">// ...... start</span>    <span class="hljs-comment">//        ....... newInterval</span>    <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; newInterval[<span class="hljs-number">0</span>] &gt; intervals[start][<span class="hljs-number">1</span>]) &#123;        list.addLast(intervals[start]);        start++;    &#125;    <span class="hljs-comment">// æ·»åŠ é‡å åŒºé—´ï¼šnewInterval ç»ˆç‚¹ &gt;= start èµ·ç‚¹</span>    <span class="hljs-comment">// ......  .......    ........</span>    <span class="hljs-comment">//    .................</span>    <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; intervals[start][<span class="hljs-number">0</span>] &lt;= newInterval[<span class="hljs-number">1</span>]) &#123;        <span class="hljs-comment">// èµ·ç‚¹å– min</span>        newInterval[<span class="hljs-number">0</span>] = Math.min(newInterval[<span class="hljs-number">0</span>], intervals[start][<span class="hljs-number">0</span>]);        <span class="hljs-comment">// ç»ˆç‚¹å– max</span>        newInterval[<span class="hljs-number">1</span>] = Math.max(newInterval[<span class="hljs-number">1</span>], intervals[start][<span class="hljs-number">1</span>]);        start++;    &#125;    <span class="hljs-comment">// æ·»åŠ åˆå¹¶åçš„æ–°åŒºé—´</span>    list.addLast(newInterval);    <span class="hljs-comment">// æ·»åŠ å‰©ä½™çš„ä¸é‡å åŒºé—´</span>    <span class="hljs-keyword">while</span> (start &lt; len) &#123;        list.addLast(intervals[start]);        start++;    &#125;    <span class="hljs-keyword">int</span> size = list.size();    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[size][<span class="hljs-number">2</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;        res[i] = list.get(i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</title>
    <link href="/2020/11/03/LeetCode-105-construct-binary-tree-from-preorder-and-inorder-traversal/"/>
    <url>/2020/11/03/LeetCode-105-construct-binary-tree-from-preorder-and-inorder-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/" target="_blank" rel="noopener">105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title">buildTree</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] preorder, <span class="hljs-keyword">int</span>[] inorder)</span> </span>&#123;    <span class="hljs-comment">// preorder = [3  ,9,  20,15,7]</span>    <span class="hljs-comment">// inorder = [9, 3,  15,20,7]</span>    <span class="hljs-comment">// ç¼“å­˜ æ¯ä¸ªç»“ç‚¹åœ¨ inorder å‡ºç°çš„ä½ç½®ï¼Œå¿«é€Ÿåˆ’åˆ†å·¦å³å­æ ‘</span>    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; inorder.length; i++) &#123;        map.put(inorder[i], i);    &#125;    <span class="hljs-keyword">return</span> build(preorder, <span class="hljs-number">0</span>, preorder.length - <span class="hljs-number">1</span>, inorder, <span class="hljs-number">0</span>, inorder.length - <span class="hljs-number">1</span>, map);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] preorder, <span class="hljs-keyword">int</span> pStart, <span class="hljs-keyword">int</span> pEnd, <span class="hljs-keyword">int</span>[] inorder, <span class="hljs-keyword">int</span> iStart, <span class="hljs-keyword">int</span> iEnd, Map&lt;Integer, Integer&gt; map)</span> </span>&#123;    <span class="hljs-comment">// èµ·ç‚¹ &gt; ç»ˆç‚¹ï¼Œä¸å­˜åœ¨ç»“ç‚¹</span>    <span class="hljs-keyword">if</span> (pStart &gt; pEnd) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// æ¯æ¬¡éƒ½ä»¥ pStart æ„é€ æ ¹èŠ‚ç‚¹</span>    <span class="hljs-keyword">int</span> rootVal = preorder[pStart];    TreeNode root = <span class="hljs-keyword">new</span> TreeNode(rootVal);    <span class="hljs-comment">// ä»¥ rootVal åˆ†ç•Œï¼Œåˆ’åˆ†å·¦å³å­æ ‘</span>    <span class="hljs-keyword">int</span> rootPosInOrder = map.get(rootVal);    <span class="hljs-keyword">int</span> leftNodesNum = rootPosInOrder - iStart;    <span class="hljs-comment">// å·¦å­æ ‘ï¼ˆ9ï¼‰ï¼š        [pStart + 1, pStart + leftNodesNum], [iStart, rootPosInOrder - 1]</span>    <span class="hljs-comment">// å³å­æ ‘ï¼ˆ20, 15, 7ï¼‰ï¼š[pStart + leftNodesNum + 1, pEnd],       [rootPosInOrder + 1, iEnd]</span>    root.left = build(preorder, pStart + <span class="hljs-number">1</span>, pStart + leftNodesNum, inorder, iStart, rootPosInOrder - <span class="hljs-number">1</span>, map);    root.right = build(preorder, pStart + leftNodesNum + <span class="hljs-number">1</span>, pEnd, inorder, rootPosInOrder + <span class="hljs-number">1</span>, iEnd, map);    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>é€’å½’</tag>
      
      <tag>åˆ†æ²»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</title>
    <link href="/2020/11/03/LeetCode-257-binary-tree-paths/"/>
    <url>/2020/11/03/LeetCode-257-binary-tree-paths/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-paths/" target="_blank" rel="noopener">257. äºŒå‰æ ‘çš„æ‰€æœ‰è·¯å¾„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">binaryTreePaths</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    dfs(root, String.valueOf(root.val), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root, String path, List&lt;String&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// æ·»åŠ å½“å‰ç»“ç‚¹</span>    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder(path);    sb.append(root.val);    <span class="hljs-comment">// å¶å­ç»“ç‚¹</span>    <span class="hljs-keyword">if</span> (root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        res.add(sb.toString());        <span class="hljs-keyword">return</span>;    &#125;    sb.append(<span class="hljs-string">"-&gt;"</span>);    dfs(root.left, sb.toString(), res);    dfs(root.right, sb.toString(), res);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 941. æœ‰æ•ˆçš„å±±è„‰æ•°ç»„</title>
    <link href="/2020/11/03/LeetCode-941-valid-mountain-array/"/>
    <url>/2020/11/03/LeetCode-941-valid-mountain-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-mountain-array/" target="_blank" rel="noopener">941. æœ‰æ•ˆçš„å±±è„‰æ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">validMountainArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = len - <span class="hljs-number">1</span>;    <span class="hljs-comment">// ä»å·¦å¾€å³ï¼Œi æœ€å¤šåªèƒ½åˆ° len - 2ï¼Œå› ä¸ºè¦å½¢æˆå±±è„‰</span>    <span class="hljs-keyword">while</span> (i + <span class="hljs-number">1</span> &lt; len &amp;&amp; A[i] &lt; A[i + <span class="hljs-number">1</span>]) &#123;        i++;    &#125;    <span class="hljs-comment">// ä»å³å¾€å·¦ï¼Œj æœ€å°åªèƒ½åˆ° 1</span>    <span class="hljs-keyword">while</span> (j - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; A[j] &lt; A[j- <span class="hljs-number">1</span>]) &#123;        j--;    &#125;    <span class="hljs-keyword">return</span> i &lt; len - <span class="hljs-number">1</span> &amp;&amp; j &gt; <span class="hljs-number">0</span> &amp;&amp; i == j;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 39. ç»„åˆæ€»å’Œ</title>
    <link href="/2020/11/02/LeetCode-39-combination-sum/"/>
    <url>/2020/11/02/LeetCode-39-combination-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/combination-sum/" target="_blank" rel="noopener">39. ç»„åˆæ€»å’Œ</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; combinationSum(<span class="hljs-keyword">int</span>[] candidates, <span class="hljs-keyword">int</span> target) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    backtrack(candidates, <span class="hljs-number">0</span>, candidates.length, target, <span class="hljs-keyword">new</span> LinkedList&lt;&gt;(), res);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] candidates, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> target, LinkedList&lt;Integer&gt; path, List&lt;List&lt;Integer&gt;&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (target == <span class="hljs-number">0</span>) &#123;        res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">if</span> (target &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; len; i++) &#123;        path.addLast(candidates[i]);        <span class="hljs-comment">// target æ¯æ¬¡éƒ½å‡å» candidate[i]ï¼Œç›´åˆ° == 0</span>        backtrack(candidates, i, len, target - candidates[i], path, res);        path.removeLast();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 296. åˆ’åˆ†æ•°ç»„ä¸ºè¿ç»­æ•°å­—çš„é›†åˆ</title>
    <link href="/2020/11/02/LeetCode-296-divide-array-in-sets-of-k-consecutive-numbers/"/>
    <url>/2020/11/02/LeetCode-296-divide-array-in-sets-of-k-consecutive-numbers/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/divide-array-in-sets-of-k-consecutive-numbers/" target="_blank" rel="noopener">296. åˆ’åˆ†æ•°ç»„ä¸ºè¿ç»­æ•°å­—çš„é›†åˆ</a></p><h1 id="ä¼˜å…ˆé˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#ä¼˜å…ˆé˜Ÿåˆ—"></a> ä¼˜å…ˆé˜Ÿåˆ—</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPossibleDivide</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len % k != <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    PriorityQueue&lt;Integer&gt; minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        minHeap.add(num);    &#125;    <span class="hljs-keyword">while</span> (!minHeap.isEmpty()) &#123;        <span class="hljs-keyword">int</span> top = minHeap.poll();        <span class="hljs-comment">// éœ€è¦ç§»é™¤çš„å…ƒç´ ï¼š i + 1, i + 2, ... i + k - 1</span>        <span class="hljs-comment">// å¦‚æœç§»é™¤å¤±è´¥åˆ™è¯´æ˜æ— æ³•åˆ’åˆ†</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; k; i++) &#123;            <span class="hljs-keyword">if</span> (!minHeap.remove(i + top)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre><h1 id="å“ˆå¸Œè®¡æ•°"><a class="markdownIt-Anchor" href="#å“ˆå¸Œè®¡æ•°"></a> å“ˆå¸Œè®¡æ•°</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPossibleDivide</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len % k != <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    Map&lt;Integer, Integer&gt; occur = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-keyword">int</span> count = occur.getOrDefault(num, <span class="hljs-number">0</span>);        occur.put(num, count + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">int</span> batch = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> batchCount = len / k;    Arrays.sort(nums);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> start : nums) &#123;        <span class="hljs-keyword">int</span> startCount = occur.getOrDefault(start, <span class="hljs-number">0</span>);        <span class="hljs-keyword">if</span> (startCount == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// æ›´æ–° start çš„å‡ºç°æ¬¡æ•°</span>        occur.put(start, startCount - <span class="hljs-number">1</span>);        <span class="hljs-comment">// å– [start : start + k - 1]</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; k; i++) &#123;            <span class="hljs-keyword">int</span> next = start + i;            <span class="hljs-keyword">int</span> expectCount = occur.getOrDefault(next, <span class="hljs-number">0</span>);            <span class="hljs-comment">// ä¸å‡ºç° || æ¬¡æ•°ä¸å¤Ÿ</span>            <span class="hljs-keyword">if</span> (expectCount == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-comment">// åˆ é™¤ä¸€ä¸ª next</span>            occur.put(next, expectCount - <span class="hljs-number">1</span>);        &#125;        batch++;        <span class="hljs-keyword">if</span> (batch == batchCount) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 973. æœ€æ¥è¿‘åŸç‚¹çš„ K ä¸ªç‚¹</title>
    <link href="/2020/11/02/LeetCode-973-k-closest-points-to-origin/"/>
    <url>/2020/11/02/LeetCode-973-k-closest-points-to-origin/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/k-closest-points-to-origin/" target="_blank" rel="noopener">973. æœ€æ¥è¿‘åŸç‚¹çš„ K ä¸ªç‚¹</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] kClosest(<span class="hljs-keyword">int</span>[][] points, <span class="hljs-keyword">int</span> K) &#123;    PriorityQueue&lt;<span class="hljs-keyword">int</span>[]&gt; minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o2[<span class="hljs-number">0</span>] * o2[<span class="hljs-number">0</span>] + o2[<span class="hljs-number">1</span>] * o2[<span class="hljs-number">1</span>] - o1[<span class="hljs-number">0</span>] * o1[<span class="hljs-number">0</span>] - o1[<span class="hljs-number">1</span>] * o1[<span class="hljs-number">1</span>]);    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[K][<span class="hljs-number">2</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] point : points) &#123;        minHeap.add(point);        <span class="hljs-keyword">if</span> (minHeap.size() &gt; K) &#123;            minHeap.poll();        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; K; i++) &#123;        res[i] = minHeap.poll();    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 140. å•è¯æ‹†åˆ† II</title>
    <link href="/2020/11/01/LeetCode-140-word-break-ii/"/>
    <url>/2020/11/01/LeetCode-140-word-break-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-break-ii/" target="_blank" rel="noopener">140. å•è¯æ‹†åˆ† II</a></p><h1 id="åŠ¨æ€è§„åˆ’-å›æº¯"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’-å›æº¯"></a> åŠ¨æ€è§„åˆ’ + å›æº¯</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">wordBreak</span><span class="hljs-params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = s.length();    Set&lt;String&gt; dict = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordDict);    <span class="hljs-comment">// dp[i] : s[0:i-1] å¯æ‹†åˆ†</span>    <span class="hljs-keyword">boolean</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++) &#123;            String suffix = s.substring(j, i);            <span class="hljs-comment">// 0...j...i</span>            <span class="hljs-comment">// dp[i] = dp[j] &amp;&amp; s[j:i] in dict</span>            <span class="hljs-keyword">if</span> (dp[j] &amp;&amp; dict.contains(suffix)) &#123;                dp[i] = <span class="hljs-keyword">true</span>;                <span class="hljs-keyword">break</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">if</span> (dp[len]) &#123;        ArrayDeque&lt;String&gt; path = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        backtrack(len, dp, path, s, dict, res);    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> len, <span class="hljs-keyword">boolean</span>[] dp, ArrayDeque&lt;String&gt; path, String s, Set&lt;String&gt; dict, List&lt;String&gt; res)</span> </span>&#123;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        res.add(String.join(<span class="hljs-string">" "</span>, path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        String suffix = s.substring(i, len);        <span class="hljs-comment">// 0....i...len</span>        <span class="hljs-comment">// s[i:len] in dict &amp;&amp; dp[i] å¯æ‹†åˆ†</span>        <span class="hljs-keyword">if</span> (dp[i] &amp;&amp; dict.contains(suffix)) &#123;            <span class="hljs-comment">// åç¼€å¾€åæ”¾</span>            path.addFirst(suffix);            backtrack(i, dp, path, s, dict, res);            path.removeFirst();        &#125;    &#125;&#125;</code></pre><h1 id="å›æº¯-è®°å¿†åŒ–"><a class="markdownIt-Anchor" href="#å›æº¯-è®°å¿†åŒ–"></a> å›æº¯ + è®°å¿†åŒ–</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">wordBreak</span><span class="hljs-params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = s.length();        Set&lt;String&gt; dict = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordDict);        Map&lt;Integer, List&lt;String&gt;&gt; cache = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        <span class="hljs-keyword">return</span> backtrack(<span class="hljs-number">0</span>, len, s, dict, cache);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> len, String s, Set&lt;String&gt; dict, Map&lt;Integer, List&lt;String&gt;&gt; cache)</span> </span>&#123;        <span class="hljs-comment">// ä» start å¼€å§‹å½¢æˆçš„è·¯å¾„</span>        List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">if</span> (start == len) &#123;            <span class="hljs-comment">// "" æ ‡è®°å¯ä»¥åˆ°è¾¾ç»ˆç‚¹</span>            res.add(<span class="hljs-string">""</span>);            <span class="hljs-keyword">return</span> res;        &#125;        <span class="hljs-keyword">if</span> (cache.containsKey(start)) &#123;            <span class="hljs-keyword">return</span> cache.get(start);        &#125;        <span class="hljs-comment">// start....i....len</span>        <span class="hljs-comment">// "catsanddog"</span>        <span class="hljs-comment">// ["cat","cats","and","sand","dog"]</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start + <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;            String prefix = s.substring(start, i);            <span class="hljs-keyword">if</span> (dict.contains(prefix)) &#123;                <span class="hljs-comment">// ä» i å¼€å§‹å½¢æˆçš„è·¯å¾„</span>                List&lt;String&gt; rest = backtrack(i, len, s, dict, cache);                System.out.println(prefix + <span class="hljs-string">" "</span> + rest);                <span class="hljs-keyword">for</span> (String path : rest) &#123;                    <span class="hljs-keyword">if</span> (<span class="hljs-string">""</span>.equals(path)) &#123;                        res.add(prefix);                    &#125; <span class="hljs-keyword">else</span> &#123;                        res.add(prefix + <span class="hljs-string">" "</span> + path);                    &#125;                &#125;            &#125;        &#125;        cache.put(start, res);        <span class="hljs-keyword">return</span> res;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 139. å•è¯æ‹†åˆ†</title>
    <link href="/2020/11/01/LeetCode-139-word-break/"/>
    <url>/2020/11/01/LeetCode-139-word-break/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-break/" target="_blank" rel="noopener">139. å•è¯æ‹†åˆ†</a></p><h1 id="è®°å¿†åŒ–æœç´¢"><a class="markdownIt-Anchor" href="#è®°å¿†åŒ–æœç´¢"></a> è®°å¿†åŒ–æœç´¢</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">wordBreak</span><span class="hljs-params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;    <span class="hljs-comment">// s = "leetcode", wordDict = ["leet", "code"]</span>    Set&lt;String&gt; wordSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordDict);    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-comment">// è®°å¿†åŒ–æœç´¢ï¼Œä¿å­˜ start å¯¹åº”çš„ç»“æœ</span>    Map&lt;Integer, Boolean&gt; cache = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">return</span> backtrack(<span class="hljs-number">0</span>, len, s, wordSet, cache);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> len, String s, Set&lt;String&gt; wordSet, Map&lt;Integer, Boolean&gt; cache)</span> </span>&#123;    <span class="hljs-comment">// å­—ç¬¦ä¸²å…¨éƒ¨æ‰¾åˆ°</span>    <span class="hljs-keyword">if</span> (start == len) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-keyword">if</span> (cache.containsKey(start)) &#123;        <span class="hljs-keyword">return</span> cache.get(start);    &#125;    <span class="hljs-comment">// ä» start å¼€å§‹å°è¯•è·å–å‰ç¼€</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start + <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        String prefix = s.substring(start, i);        <span class="hljs-comment">// s[start:i] è‹¥åœ¨ wordSet ä¸­å‡ºç°ï¼Œåˆ™æ‰¾ä¸‹ä¸€ä¸ªä½ç½®</span>        <span class="hljs-keyword">if</span> (wordSet.contains(prefix)) &#123;            <span class="hljs-keyword">if</span> (backtrack(i, len, s, wordSet, cache)) &#123;                cache.put(i, <span class="hljs-keyword">true</span>);                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                cache.put(i, <span class="hljs-keyword">false</span>);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">wordBreak</span><span class="hljs-params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;    <span class="hljs-comment">// s = "leetcode", wordDict = ["leet", "code"]</span>    Set&lt;String&gt; wordSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordDict);    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">boolean</span>[] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len + <span class="hljs-number">1</span>];    LinkedList&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    queue.add(<span class="hljs-number">0</span>);    visited[<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        <span class="hljs-keyword">int</span> start = queue.poll();        <span class="hljs-keyword">if</span> (start == len) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> end = start + <span class="hljs-number">1</span>; end &lt;= len; end++) &#123;            String prefix = s.substring(start, end);            <span class="hljs-comment">// s[start:end] æ˜¯æœ‰æ•ˆå‰ç¼€ï¼Œåˆ™ä¸‹æ¬¡å¯ä»¥ä» end å¼€å§‹æœç´¢</span>            <span class="hljs-keyword">if</span> (wordSet.contains(prefix) &amp;&amp; !visited[end]) &#123;                visited[end] = <span class="hljs-keyword">true</span>;                queue.add(end);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">wordBreak</span><span class="hljs-params">(String s, List&lt;String&gt; wordDict)</span> </span>&#123;    <span class="hljs-comment">// s = "leetcode", wordDict = ["leet", "code"]</span>    Set&lt;String&gt; wordSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordDict);    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-comment">// dp[i]: s[0:i-1] æ˜¯å¦èƒ½æ‹†åˆ†</span>    <span class="hljs-comment">// dp[i] = dp[i - 1] == true &amp;&amp; s[i:len] åœ¨ wordDict ä¸­</span>    <span class="hljs-keyword">boolean</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++) &#123;            String suffix = s.substring(j, i);            <span class="hljs-comment">// s[0:j - 1] å¯æ‹†åˆ† &amp;&amp; s[j:i] åœ¨ dict ä¸­</span>            <span class="hljs-keyword">if</span> (dp[j] &amp;&amp; wordSet.contains(suffix)) &#123;                dp[i] = <span class="hljs-keyword">true</span>;                <span class="hljs-keyword">break</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[len];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 381. O(1) æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  - å…è®¸é‡å¤</title>
    <link href="/2020/10/31/LeetCode-381-insert-delete-getrandom-o1-duplicates-allowed/"/>
    <url>/2020/10/31/LeetCode-381-insert-delete-getrandom-o1-duplicates-allowed/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/insert-delete-getrandom-o1-duplicates-allowed/" target="_blank" rel="noopener">381. O(1) æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  - å…è®¸é‡å¤</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RandomizedCollection</span> </span>&#123;    List&lt;Integer&gt; nums;    Map&lt;Integer, Set&lt;Integer&gt;&gt; numsIdx;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RandomizedCollection</span><span class="hljs-params">()</span> </span>&#123;        nums = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        numsIdx = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Inserts a value to the collection. Returns true if the collection did not already contain the specified element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;        nums.add(val);        Set&lt;Integer&gt; idxSet = numsIdx.getOrDefault(val, <span class="hljs-keyword">new</span> HashSet&lt;&gt;());        <span class="hljs-comment">// æ–°å¢å…ƒç´ åœ¨ list æœ«å°¾</span>        idxSet.add(nums.size() - <span class="hljs-number">1</span>);        numsIdx.put(val, idxSet);        <span class="hljs-comment">// size == 1 è¯´æ˜ç¬¬ä¸€æ¬¡å‡ºç° val</span>        <span class="hljs-keyword">return</span> idxSet.size() == <span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Removes a value from the collection. Returns true if the collection contained the specified element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;        <span class="hljs-keyword">if</span> (!numsIdx.containsKey(val)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        Iterator&lt;Integer&gt; iterator = numsIdx.get(val).iterator();        <span class="hljs-comment">// è·å– val çš„å…¶ä¸­ä¸€ä¸ªä½ç½®</span>        <span class="hljs-keyword">int</span> valIdx = iterator.next();        <span class="hljs-comment">// æœ€åä¸€ä¸ªå…ƒç´ ä½ç½®</span>        <span class="hljs-keyword">int</span> lastPos = nums.size() - <span class="hljs-number">1</span>;        <span class="hljs-comment">// è¦åˆ é™¤çš„å…ƒç´ æ­£å¥½åœ¨æœ«å°¾</span>        <span class="hljs-keyword">if</span> (valIdx == lastPos) &#123;            numsIdx.get(val).remove(valIdx);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">int</span> tail = nums.get(lastPos);            <span class="hljs-comment">// O(1): æŠŠ tail è®¾ç½®åˆ° val çš„ä½ç½®ï¼Œç„¶ååˆ é™¤ tail</span>            nums.set(valIdx, tail);            <span class="hljs-comment">// åˆ é™¤ val çš„åŸå§‹ç´¢å¼•</span>            numsIdx.get(val).remove(valIdx);            <span class="hljs-comment">// æ›´æ–° tail çš„ç´¢å¼•ä¿¡æ¯</span>            numsIdx.get(tail).remove(lastPos);            numsIdx.get(tail).add(valIdx);        &#125;        <span class="hljs-comment">// åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </span>        nums.remove(lastPos);        <span class="hljs-comment">// åŸæ¥çš„ list é‡Œ val åªå‡ºç°äº†ä¸€æ¬¡ï¼Œåˆ é™¤ååˆ™å‡ºç° 0 æ¬¡</span>        <span class="hljs-keyword">if</span> (numsIdx.get(val).size() == <span class="hljs-number">0</span>) &#123;            numsIdx.remove(val);        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get a random element from the collection.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getRandom</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">int</span> idx = (<span class="hljs-keyword">int</span>)(Math.random() * nums.size());        <span class="hljs-keyword">return</span> nums.get(idx);    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ </title>
    <link href="/2020/10/30/LeetCode-703-kth-largest-element-in-a-stream/"/>
    <url>/2020/10/30/LeetCode-703-kth-largest-element-in-a-stream/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/kth-largest-element-in-a-stream/" target="_blank" rel="noopener">703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ </a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KthLargest</span> </span>&#123;    PriorityQueue&lt;Integer&gt; minHeap;    <span class="hljs-keyword">int</span> k;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">KthLargest</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">this</span>.k = k;        minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o1 - o2);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;            minHeap.add(num);            <span class="hljs-keyword">if</span> (minHeap.size() &gt; k) &#123;                minHeap.poll();            &#125;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;        minHeap.add(val);        <span class="hljs-keyword">if</span> (minHeap.size() &gt; k) &#123;            minHeap.poll();        &#125;        <span class="hljs-keyword">return</span> minHeap.peek();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ </title>
    <link href="/2020/10/30/LeetCode-347-top-k-frequent-elements/"/>
    <url>/2020/10/30/LeetCode-347-top-k-frequent-elements/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/top-k-frequent-elements/" target="_blank" rel="noopener">347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ </a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] topKFrequent(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k) &#123;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    PriorityQueue&lt;<span class="hljs-keyword">int</span>[]&gt; minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o1[<span class="hljs-number">1</span>] - o2[<span class="hljs-number">1</span>]);    <span class="hljs-comment">// ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-keyword">int</span> occur = map.getOrDefault(num, <span class="hljs-number">0</span>);        map.put(num, occur + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-comment">// ç»´æŠ¤ size = k çš„æœ€å°å †</span>    <span class="hljs-keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;        minHeap.offer(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;entry.getKey(), entry.getValue()&#125;);        <span class="hljs-keyword">if</span> (minHeap.size() &gt; k) &#123;            minHeap.poll();        &#125;    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[k];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i++) &#123;        res[i] = minHeap.poll()[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 295. æ•°æ®æµçš„ä¸­ä½æ•°</title>
    <link href="/2020/10/30/LeetCode-295-find-median-from-data-stream/"/>
    <url>/2020/10/30/LeetCode-295-find-median-from-data-stream/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-median-from-data-stream/" target="_blank" rel="noopener">295. æ•°æ®æµçš„ä¸­ä½æ•°</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MedianFinder</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ€»çš„æ•°æ®ä¸ªæ•°</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span> count;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å·¦è¾¹ä¿å­˜å¤§é¡¶å †ï¼Œå¥‡æ•°æ—¶ä¸­ä½æ•°å³å †é¡¶</span><span class="hljs-comment">     */</span>    PriorityQueue&lt;Integer&gt; maxHeap;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å³è¾¹ä¿å­˜å°é¡¶å †ï¼Œå¶æ•°æ—¶ï¼Œå–å †é¡¶æ±‚å‡å€¼</span><span class="hljs-comment">     */</span>    PriorityQueue&lt;Integer&gt; minHeap;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MedianFinder</span><span class="hljs-params">()</span> </span>&#123;        count = <span class="hljs-number">0</span>;        maxHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o2 - o1);        minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span> </span>&#123;        count++;        <span class="hljs-comment">// 1 2 3    4 5</span>        <span class="hljs-comment">// 1 2 3    4 5 6</span>        <span class="hljs-comment">// å¤§é¡¶å †çš„å †é¡¶ &lt;= å°é¡¶å †å †é¡¶ï¼Œ</span>        <span class="hljs-comment">// æ‰€ä»¥è¦å–å¤§çš„å€¼åŠ å…¥å°é¡¶å †ï¼Œå°çš„å€¼åŠ å…¥å¤§é¡¶å †</span>        maxHeap.add(num);        minHeap.add(maxHeap.poll());        <span class="hljs-comment">// å½“æ€»æ•°ä¸ºå¥‡æ•°æ—¶ï¼Œå¤§é¡¶å †æ¯”å°é¡¶å †å¤šä¸€ä¸ªå…ƒç´ </span>        <span class="hljs-keyword">if</span> (count % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;            maxHeap.add(minHeap.poll());        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">findMedian</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (count % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> (<span class="hljs-keyword">double</span>) (maxHeap.peek() + minHeap.peek()) / <span class="hljs-number">2</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">return</span> (<span class="hljs-keyword">double</span>) maxHeap.peek();        &#125;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 463. å²›å±¿çš„å‘¨é•¿</title>
    <link href="/2020/10/30/LeetCode-463-island-perimeter/"/>
    <url>/2020/10/30/LeetCode-463-island-perimeter/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/island-perimeter/" target="_blank" rel="noopener">463. å²›å±¿çš„å‘¨é•¿</a></p><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java"><span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;&#125;;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">islandPerimeter</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] grid)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = grid.length;    <span class="hljs-keyword">int</span> cols = grid[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> backtrack(i, j, rows, cols, grid);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> cols, <span class="hljs-keyword">int</span>[][] grid)</span> </span>&#123;    <span class="hljs-comment">// è¶Šç•Œ || æ°´é¢</span>    <span class="hljs-keyword">if</span> (!inArea(i, j, rows, cols) || grid[i][j] == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">// å·²ç»éå†è¿‡</span>    <span class="hljs-keyword">if</span> (grid[i][j] != <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    grid[i][j] = <span class="hljs-number">2</span>;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å››ä¸ªæ–¹å‘éå†</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;        res += backtrack(i + dir[<span class="hljs-number">0</span>], j + dir[<span class="hljs-number">1</span>], rows, cols, grid);    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> cols)</span> </span>&#123;    <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;&#125;</code></pre><h1 id="éå†è®¡ç®—"><a class="markdownIt-Anchor" href="#éå†è®¡ç®—"></a> éå†è®¡ç®—</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">islandPerimeter</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] grid)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = grid.length;    <span class="hljs-keyword">int</span> cols = grid[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            res += <span class="hljs-number">4</span>;            <span class="hljs-comment">// å·¦è¾¹ä¸ºé™†åœ°</span>            <span class="hljs-keyword">if</span> (j &gt; <span class="hljs-number">0</span> &amp;&amp; grid[i][j - <span class="hljs-number">1</span>] == <span class="hljs-number">1</span>) &#123;                res -= <span class="hljs-number">2</span>;            &#125;            <span class="hljs-comment">// ä¸Šè¾¹ä¸ºé™†åœ°</span>            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; grid[i - <span class="hljs-number">1</span>][j] == <span class="hljs-number">1</span>) &#123;                res -= <span class="hljs-number">2</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 112. è·¯å¾„æ€»å’Œ</title>
    <link href="/2020/10/29/LeetCode-112-path-sum/"/>
    <url>/2020/10/29/LeetCode-112-path-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/path-sum/" target="_blank" rel="noopener">112. è·¯å¾„æ€»å’Œ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasPathSum</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-keyword">if</span> (root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> root.val == sum;    &#125;    <span class="hljs-keyword">return</span> hasPathSum(root.left, sum - root.val) || hasPathSum(root.right, sum - root.val);&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">boolean</span> hasPath = <span class="hljs-keyword">false</span>;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasPathSum</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    getSum(root, root.val, sum);    <span class="hljs-keyword">return</span> hasPath;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getSum</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">if</span> (sum == target) &#123;            hasPath = <span class="hljs-keyword">true</span>;            <span class="hljs-keyword">return</span>;        &#125;    &#125;    <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) &#123;        sum += root.left.val;        getSum(root.left, sum, target);        sum -= root.left.val;    &#125;    <span class="hljs-keyword">if</span> (root.right != <span class="hljs-keyword">null</span>) &#123;        sum += root.right.val;        getSum(root.right, sum, target);        sum -= root.right.val;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 129. æ±‚æ ¹åˆ°å¶å­èŠ‚ç‚¹æ•°å­—ä¹‹å’Œ</title>
    <link href="/2020/10/29/LeetCode-129-sum-root-to-leaf-numbers/"/>
    <url>/2020/10/29/LeetCode-129-sum-root-to-leaf-numbers/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sum-root-to-leaf-numbers/" target="_blank" rel="noopener">129. æ±‚æ ¹åˆ°å¶å­èŠ‚ç‚¹æ•°å­—ä¹‹å’Œ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">sumNumbers</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">return</span> preOrder(root, <span class="hljs-number">0</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> sum)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    sum = sum * <span class="hljs-number">10</span> + root.val;    <span class="hljs-keyword">if</span> (root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> sum;    &#125;    <span class="hljs-keyword">return</span> preOrder(root.left, sum) + preOrder(root.right, sum);&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">sumNumbers</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    List&lt;List&lt;TreeNode&gt;&gt; paths = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    List&lt;TreeNode&gt; path = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    path.add(root);    preOrder(root, path, paths);    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (List&lt;TreeNode&gt; p : paths) &#123;        <span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (TreeNode node : p) &#123;            num = num * <span class="hljs-number">10</span> + node.val;        &#125;        res += num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">preOrder</span><span class="hljs-params">(TreeNode root, List&lt;TreeNode&gt; path, List&lt;List&lt;TreeNode&gt;&gt; paths)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root.left == <span class="hljs-keyword">null</span> &amp;&amp; root.right == <span class="hljs-keyword">null</span>) &#123;        paths.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) &#123;        path.add(root.left);        preOrder(root.left, path, paths);        path.remove(root.left);    &#125;    <span class="hljs-keyword">if</span> (root.right != <span class="hljs-keyword">null</span>) &#123;        path.add(root.right);        preOrder(root.right, path, paths);        path.remove(root.right);    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 220. å­˜åœ¨é‡å¤å…ƒç´  III</title>
    <link href="/2020/10/29/LeetCode-220-contains-duplicate-iii/"/>
    <url>/2020/10/29/LeetCode-220-contains-duplicate-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/contains-duplicate-iii/" target="_blank" rel="noopener">220. å­˜åœ¨é‡å¤å…ƒç´  III</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">containsNearbyAlmostDuplicate</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> t)</span> </span>&#123;    TreeSet&lt;Long&gt; set = <span class="hljs-keyword">new</span> TreeSet&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;        <span class="hljs-comment">// |nums[i] - nums[j]| &lt;= t</span>        <span class="hljs-comment">// nums[i] - nums[j] &lt;= t or nums[i] - nums[j] &gt;= -t</span>        <span class="hljs-comment">// nums[i] &lt;= nums[j] + t and nums[i] &gt;= nums[j] - t</span>        Long bound = set.ceiling((<span class="hljs-keyword">long</span>) nums[i] - (<span class="hljs-keyword">long</span>) t);        <span class="hljs-keyword">if</span> (bound != <span class="hljs-keyword">null</span> &amp;&amp; bound &lt;= (<span class="hljs-keyword">long</span>) nums[i] + (<span class="hljs-keyword">long</span>) t) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        set.add((<span class="hljs-keyword">long</span>) nums[i]);        <span class="hljs-comment">// ä¿æŒçª—å£å¤§å° = k</span>        <span class="hljs-keyword">if</span> (set.size() &gt; k) &#123;            set.remove((<span class="hljs-keyword">long</span>) nums[i - k]);        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1552. ä¸¤çƒä¹‹é—´çš„ç£åŠ›</title>
    <link href="/2020/10/29/LeetCode-1552-magnetic-force-between-two-balls/"/>
    <url>/2020/10/29/LeetCode-1552-magnetic-force-between-two-balls/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/magnetic-force-between-two-balls/" target="_blank" rel="noopener">1552. ä¸¤çƒä¹‹é—´çš„ç£åŠ›</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxDistance</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] position, <span class="hljs-keyword">int</span> m)</span> </span>&#123;    <span class="hljs-comment">// distance in [1, max - min]</span>    <span class="hljs-keyword">int</span> len = position.length;    Arrays.sort(position);    <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>, right = (position[len - <span class="hljs-number">1</span>] - position[<span class="hljs-number">0</span>]) / (m - <span class="hljs-number">1</span>);    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">int</span> numOfBalls = calcBallsByDistance(position, mid);        System.out.println(mid + <span class="hljs-string">" "</span> + numOfBalls);        <span class="hljs-keyword">if</span> (numOfBalls &gt;= m) &#123;            left = mid;            <span class="hljs-comment">// çƒçš„ä¸ªæ•°å¤ªå°‘ï¼Œéœ€è¦å¢åŠ çƒï¼Œæ­¤æ—¶åº”è¯¥å‡å°è·ç¦»</span>        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid - <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * ä»¥æœ€å°è·ç¦» distance æ¥åˆ‡åˆ†æ•°ç»„</span><span class="hljs-comment"> * è·å–çƒçš„ä¸ªæ•°</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> position</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> minDistance</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">calcBallsByDistance</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] position, <span class="hljs-keyword">int</span> minDistance)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span> distance = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; position.length; i++) &#123;        distance += position[i] - position[i - <span class="hljs-number">1</span>];        <span class="hljs-keyword">if</span> (distance &gt;= minDistance) &#123;            count++;            distance = <span class="hljs-number">0</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TCP å¯é ä¼ è¾“</title>
    <link href="/2020/10/29/network-TCP-reliable-data-transfer/"/>
    <url>/2020/10/29/network-TCP-reliable-data-transfer/</url>
    
    <content type="html"><![CDATA[<h1 id="é‡ä¼ æœºåˆ¶"><a class="markdownIt-Anchor" href="#é‡ä¼ æœºåˆ¶"></a> é‡ä¼ æœºåˆ¶</h1><p>TCP å®ç°å¯é ä¼ è¾“çš„æ–¹å¼ä¹‹ä¸€ï¼Œæ˜¯é€šè¿‡<strong>åºåˆ—å·ä¸ç¡®è®¤åº”ç­”</strong>ã€‚<br />åœ¨ TCP ä¸­ï¼Œå½“å‘é€ç«¯çš„æ•°æ®åˆ°è¾¾æ¥æ”¶ä¸»æœºæ—¶ï¼Œæ¥æ”¶ç«¯ä¸»æœºä¼šè¿”å›ä¸€ä¸ªç¡®è®¤åº”ç­”æ¶ˆæ¯ï¼Œè¡¨ç¤ºå·²æ”¶åˆ°æ¶ˆæ¯ã€‚é’ˆå¯¹æ•°æ®åŒ…ä¸¢å¤±çš„æƒ…å†µï¼Œä¼šç”¨é‡ä¼ æœºåˆ¶è§£å†³ã€‚</p><p>å¸¸è§çš„é‡ä¼ æœºåˆ¶ï¼š</p><ul><li>è¶…æ—¶é‡ä¼ </li><li>å¿«é€Ÿé‡ä¼ </li><li>SACK</li><li>D-SACK</li></ul><h2 id="è¶…æ—¶é‡ä¼ "><a class="markdownIt-Anchor" href="#è¶…æ—¶é‡ä¼ "></a> è¶…æ—¶é‡ä¼ </h2><blockquote><p>è¶…æ—¶é‡ä¼ ï¼šåœ¨å‘é€æ•°æ®æ—¶ï¼Œè®¾å®šä¸€ä¸ªå®šæ—¶å™¨ï¼Œå½“è¶…è¿‡æŒ‡å®šçš„æ—¶é—´åï¼Œæ²¡æœ‰æ”¶åˆ°å¯¹æ–¹çš„ ACK ç¡®è®¤åº”ç­”æŠ¥æ–‡ï¼Œå°±ä¼šé‡å‘è¯¥æ•°æ®ã€‚</p></blockquote><p>TCP ä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µå‘ç”Ÿè¶…æ—¶é‡ä¼ ï¼š</p><ol><li>æ•°æ®åŒ…ä¸¢å¤±</li><li>ç¡®è®¤åº”ç­”ä¸¢å¤±</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029150717.jpeg" srcset="/img/loading.gif" alt="" /></p><h3 id="è¶…æ—¶é‡ä¼ æ—¶é—´-rto"><a class="markdownIt-Anchor" href="#è¶…æ—¶é‡ä¼ æ—¶é—´-rto"></a> è¶…æ—¶é‡ä¼ æ—¶é—´ RTO</h3><blockquote><p><code>RTT</code>ï¼ˆ<code>Round-Trip Time</code> å¾€è¿”æ—¶å»¶ï¼‰æ˜¯æ•°æ®ä»ç½‘ç»œä¸€ç«¯ä¼ é€åˆ°å¦ä¸€ç«¯æ‰€éœ€çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯åŒ…çš„<strong>å¾€è¿”æ—¶é—´</strong>ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029151521.png" srcset="/img/loading.gif" alt="" /></p><p>è¶…æ—¶é‡ä¼ æ—¶é—´æ˜¯ä»¥ RTO ï¼ˆRetransmission Timeout è¶…æ—¶é‡ä¼ æ—¶é—´ï¼‰è¡¨ç¤ºã€‚</p><p>å‡è®¾åœ¨é‡ä¼ çš„æƒ…å†µä¸‹ï¼Œè¶…æ—¶æ—¶é—´ RTO ã€Œè¾ƒé•¿æˆ–è¾ƒçŸ­ã€æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿ</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029151632.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾ä¸­æœ‰ä¸¤ç§è¶…æ—¶æ—¶é—´ä¸åŒçš„æƒ…å†µï¼š</p><ol><li>å½“è¶…æ—¶æ—¶é—´ <code>RTO</code> è¾ƒå¤§æ—¶ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li><li>å½“è¶…æ—¶æ—¶é—´ <code>RTO</code> è¾ƒå°æ—¶ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ï¼Œäºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘ã€‚</li></ol><p>ç²¾ç¡®çš„æµ‹é‡è¶…æ—¶æ—¶é—´ <code>RTO</code> çš„å€¼æ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™å¯è®©æˆ‘ä»¬çš„é‡ä¼ æœºåˆ¶æ›´é«˜æ•ˆã€‚</p><p>æ ¹æ®ä¸Šè¿°çš„ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œ<strong>è¶…æ—¶é‡ä¼ æ—¶é—´ <code>RTO</code> çš„å€¼åº”è¯¥ç•¥å¤§äºæŠ¥æ–‡å¾€è¿” <code>RTT</code> çš„å€¼ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029151735.png" srcset="/img/loading.gif" alt="" /></p><p>å®é™…ä¸Šã€ŒæŠ¥æ–‡å¾€è¿” <code>RTT</code> çš„å€¼ã€æ˜¯ç»å¸¸å˜åŒ–çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„<strong>ç½‘ç»œä¹Ÿæ˜¯æ—¶å¸¸å˜åŒ–</strong>çš„ã€‚ä¹Ÿå°±å› ä¸ºã€ŒæŠ¥æ–‡å¾€è¿” <code>RTT</code> çš„å€¼ã€ æ˜¯ç»å¸¸æ³¢åŠ¨å˜åŒ–çš„ï¼Œæ‰€ä»¥ã€Œè¶…æ—¶é‡ä¼ æ—¶é—´ <code>RTO</code> çš„å€¼ã€åº”è¯¥æ˜¯ä¸€ä¸ª<strong>åŠ¨æ€å˜åŒ–</strong>çš„å€¼ã€‚</p><p>å¦‚æœè¶…æ—¶é‡å‘çš„æ•°æ®ï¼Œå†æ¬¡è¶…æ—¶çš„æ—¶å€™ï¼Œåˆéœ€è¦é‡ä¼ çš„æ—¶å€™ï¼ŒTCP çš„ç­–ç•¥æ˜¯<strong>è¶…æ—¶é—´éš”åŠ å€</strong>ã€‚<br />ä¹Ÿå°±æ˜¯æ¯å½“é‡åˆ°ä¸€æ¬¡è¶…æ—¶é‡ä¼ çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†ä¸‹ä¸€æ¬¡è¶…æ—¶æ—¶é—´é—´éš”è®¾ä¸ºå…ˆå‰å€¼çš„ä¸¤å€ã€‚ä¸¤æ¬¡è¶…æ—¶ï¼Œå°±è¯´æ˜ç½‘ç»œç¯å¢ƒå·®ï¼Œä¸å®œé¢‘ç¹åå¤å‘é€ã€‚</p><p>è¶…æ—¶è§¦å‘é‡ä¼ å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œ<strong>è¶…æ—¶å‘¨æœŸå¯èƒ½ç›¸å¯¹è¾ƒé•¿</strong>ã€‚äºæ˜¯å°±å¯ä»¥ç”¨ã€Œ<strong>å¿«é€Ÿé‡ä¼ </strong>ã€æœºåˆ¶æ¥è§£å†³è¶…æ—¶é‡å‘çš„æ—¶é—´ç­‰å¾…ã€‚</p><h2 id="å¿«é€Ÿé‡ä¼ "><a class="markdownIt-Anchor" href="#å¿«é€Ÿé‡ä¼ "></a> å¿«é€Ÿé‡ä¼ </h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029152043.png" srcset="/img/loading.gif" alt="" /></p><blockquote><p>å¿«é€Ÿé‡ä¼ ï¼ˆ<code>Fast Retransmit</code>ï¼‰æœºåˆ¶ï¼Œå®ƒä¸ä»¥æ—¶é—´ä¸ºé©±åŠ¨ï¼Œè€Œæ˜¯ä»¥<strong>æ•°æ®é©±åŠ¨</strong>é‡ä¼ ã€‚</p></blockquote><p>æ‰€ä»¥ï¼Œå¿«é€Ÿé‡ä¼ çš„å·¥ä½œæ–¹å¼æ˜¯å½“æ”¶åˆ°<strong>ä¸‰ä¸ªç›¸åŒçš„ <code>ACK</code> æŠ¥æ–‡</strong>æ—¶ï¼Œä¼šåœ¨å®šæ—¶å™¨è¿‡æœŸä¹‹å‰ï¼Œé‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡æ®µã€‚</p><p>å¿«é€Ÿé‡ä¼ æœºåˆ¶åªè§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¶…æ—¶æ—¶é—´çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒä¾ç„¶é¢ä¸´ç€å¦å¤–ä¸€ä¸ªé—®é¢˜ã€‚å°±æ˜¯<strong>é‡ä¼ çš„æ—¶å€™ï¼Œæ˜¯é‡ä¼ ä¹‹å‰çš„ä¸€ä¸ªï¼Œè¿˜æ˜¯é‡ä¼ æ‰€æœ‰çš„é—®é¢˜ã€‚</strong></p><p>æ¯”å¦‚å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œæ˜¯é‡ä¼  Seq2 å‘¢ï¼Ÿè¿˜æ˜¯é‡ä¼  Seq2ã€Seq3ã€Seq4ã€Seq5 å‘¢ï¼Ÿå› ä¸ºå‘é€ç«¯å¹¶ä¸æ¸…æ¥šè¿™è¿ç»­çš„ä¸‰ä¸ª Ack 2 æ˜¯è°ä¼ å›æ¥çš„ã€‚</p><p>æ ¹æ® TCP ä¸åŒçš„å®ç°ï¼Œä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½æ˜¯æœ‰å¯èƒ½çš„ã€‚å¯è§ï¼Œè¿™æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚</p><p>ä¸ºäº†è§£å†³ä¸çŸ¥é“è¯¥é‡ä¼ å“ªäº› TCP æŠ¥æ–‡ï¼Œäºæ˜¯å°±æœ‰ <code>SACK æ–¹æ³•</code>ã€‚</p><h2 id="é€‰æ‹©ç¡®è®¤-ack"><a class="markdownIt-Anchor" href="#é€‰æ‹©ç¡®è®¤-ack"></a> é€‰æ‹©ç¡®è®¤ ACK</h2><blockquote><p><code>SACK</code>ï¼ˆ<code>Selective Acknowledgment</code> é€‰æ‹©æ€§ç¡®è®¤ï¼‰ï¼šåœ¨ TCP å¤´éƒ¨ã€Œé€‰é¡¹ã€å­—æ®µé‡ŒåŠ ä¸€ä¸ª <code>SACK</code> å­—æ®µï¼Œå®ƒå¯ä»¥å°† <code>SACK</code> å‘é€ç»™å‘é€æ–¹ï¼Œè¿™æ ·å‘é€æ–¹å°±å¯ä»¥çŸ¥é“å“ªäº›æ•°æ®æ”¶åˆ°äº†ï¼Œå“ªäº›æ•°æ®æ²¡æ”¶åˆ°ï¼ŒçŸ¥é“äº†è¿™äº›ä¿¡æ¯ï¼Œå°±å¯ä»¥åªé‡ä¼ ä¸¢å¤±çš„æ•°æ®ã€‚</p></blockquote><p>å¦‚ä¸‹å›¾ï¼Œå‘é€æ–¹æ”¶åˆ°äº†ä¸‰æ¬¡åŒæ ·çš„ <code>ACK</code> ç¡®è®¤æŠ¥æ–‡ï¼Œäºæ˜¯å°±ä¼šè§¦å‘<code>å¿«é€Ÿé‡å‘</code>æœºåˆ¶ï¼Œé€šè¿‡ <code>SACK</code> ä¿¡æ¯å‘ç°åªæœ‰ <code>200~299</code> è¿™æ®µæ•°æ®ä¸¢å¤±ï¼Œåˆ™é‡å‘æ—¶ï¼Œå°±åªé€‰æ‹©äº†è¿™ä¸ª <code>TCP</code> æ®µè¿›è¡Œé‡å¤ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029152731.png" srcset="/img/loading.gif" alt="" /></p><h2 id="duplicate-sack"><a class="markdownIt-Anchor" href="#duplicate-sack"></a> Duplicate SACK</h2><blockquote><p><code>Duplicate SACK</code> åˆç§° <code>D-SACK</code>ï¼Œå…¶ä¸»è¦ä½¿ç”¨äº† <code>SACK</code> æ¥å‘Šè¯‰ã€Œå‘é€æ–¹ã€æœ‰å“ªäº›æ•°æ®è¢«<strong>é‡å¤æ¥æ”¶</strong>äº†ã€‚</p></blockquote><ol><li>ACK ä¸¢åŒ…</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029153037.png" srcset="/img/loading.gif" alt="" /></p><ul><li>ã€Œæ¥æ”¶æ–¹ã€å‘ç»™ã€Œå‘é€æ–¹ã€çš„ä¸¤ä¸ª ACK ç¡®è®¤åº”ç­”éƒ½ä¸¢å¤±äº†ï¼Œæ‰€ä»¥å‘é€æ–¹è¶…æ—¶åï¼Œé‡ä¼ ç¬¬ä¸€ä¸ªæ•°æ®åŒ…ï¼ˆ3000 ~ 3499ï¼‰</li><li>äºæ˜¯ã€Œæ¥æ”¶æ–¹ã€å‘ç°æ•°æ®æ˜¯é‡å¤æ”¶åˆ°çš„ï¼Œäºæ˜¯å›äº†ä¸€ä¸ª SACK = 3000~3500ï¼Œå‘Šè¯‰ã€Œå‘é€æ–¹ã€ 3000~3500 çš„æ•°æ®æ—©å·²è¢«æ¥æ”¶äº†ï¼Œå› ä¸º ACK éƒ½åˆ°äº† 4000 äº†ï¼Œå·²ç»æ„å‘³ç€ 4000 ä¹‹å‰çš„æ‰€æœ‰æ•°æ®éƒ½å·²æ”¶åˆ°ï¼Œæ‰€ä»¥è¿™ä¸ª SACK å°±ä»£è¡¨ç€ <code>D-SACK</code>ã€‚</li><li>è¿™æ ·ã€Œå‘é€æ–¹ã€å°±çŸ¥é“äº†ï¼Œæ•°æ®æ²¡æœ‰ä¸¢ï¼Œæ˜¯ã€Œæ¥æ”¶æ–¹ã€çš„ ACK ç¡®è®¤æŠ¥æ–‡ä¸¢äº†ã€‚</li></ul><ol start="2"><li>ç½‘ç»œå»¶æ—¶</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029153559.png" srcset="/img/loading.gif" alt="" /></p><ul><li>æ•°æ®åŒ…ï¼ˆ1000~1499ï¼‰ è¢«ç½‘ç»œå»¶è¿Ÿäº†ï¼Œå¯¼è‡´ã€Œå‘é€æ–¹ã€æ²¡æœ‰æ”¶åˆ° Ack 1500 çš„ç¡®è®¤æŠ¥æ–‡ã€‚</li><li>è€Œåé¢æŠ¥æ–‡åˆ°è¾¾çš„ä¸‰ä¸ªç›¸åŒçš„ ACK ç¡®è®¤æŠ¥æ–‡ï¼Œå°±è§¦å‘äº†å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œä½†æ˜¯åœ¨é‡ä¼ åï¼Œè¢«å»¶è¿Ÿçš„æ•°æ®åŒ…ï¼ˆ1000~1499ï¼‰åˆåˆ°äº†ã€Œæ¥æ”¶æ–¹ã€ï¼›</li><li>æ‰€ä»¥ã€Œæ¥æ”¶æ–¹ã€å›äº†ä¸€ä¸ª SACK=1000~1500ï¼Œå› ä¸º ACK å·²ç»åˆ°äº† 3000ï¼Œæ‰€ä»¥è¿™ä¸ª SACK æ˜¯ D-SACKï¼Œè¡¨ç¤ºæ”¶åˆ°äº†é‡å¤çš„åŒ…ã€‚</li><li>è¿™æ ·å‘é€æ–¹å°±çŸ¥é“å¿«é€Ÿé‡ä¼ è§¦å‘çš„åŸå› ä¸æ˜¯å‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œä¹Ÿä¸æ˜¯å› ä¸ºå›åº”çš„ ACK åŒ…ä¸¢äº†ï¼Œè€Œæ˜¯å› ä¸º<strong>ç½‘ç»œå»¶è¿Ÿ</strong>äº†ã€‚</li></ul><p>å¯è§ï¼ŒD-SACK æœ‰è¿™ä¹ˆå‡ ä¸ªå¥½å¤„ï¼š</p><ol><li>å¯ä»¥è®©ã€Œå‘é€æ–¹ã€çŸ¥é“ï¼Œæ˜¯å‘å‡ºå»çš„åŒ…ä¸¢äº†ï¼Œè¿˜æ˜¯æ¥æ”¶æ–¹å›åº”çš„ ACK åŒ…ä¸¢äº†;</li><li>å¯ä»¥çŸ¥é“æ˜¯ä¸æ˜¯ã€Œå‘é€æ–¹ã€çš„æ•°æ®åŒ…è¢«ç½‘ç»œå»¶è¿Ÿäº†;</li><li>å¯ä»¥çŸ¥é“ç½‘ç»œä¸­æ˜¯ä¸æ˜¯æŠŠã€Œå‘é€æ–¹ã€çš„æ•°æ®åŒ…ç»™å¤åˆ¶äº†;</li></ol><h1 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029161354.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸ºæ¯ä¸ªåŒ…ç¡®è®¤åº”ç­”çš„ç¼ºç‚¹ï¼šå½“ä¸Šä¸€ä¸ªæ•°æ®åŒ…æ”¶åˆ°äº†åº”ç­”äº†ï¼Œ å†å‘é€ä¸‹ä¸€ä¸ªã€‚å½“<strong>æ•°æ®åŒ…çš„å¾€è¿”æ—¶é—´è¶Šé•¿ï¼Œé€šä¿¡çš„æ•ˆç‡å°±è¶Šä½ã€‚</strong></p><p>ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTCP å¼•å…¥äº†çª—å£è¿™ä¸ªæ¦‚å¿µã€‚å³ä½¿åœ¨å¾€è¿”æ—¶é—´è¾ƒé•¿çš„æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿä¸ä¼šé™ä½ç½‘ç»œé€šä¿¡çš„æ•ˆç‡ã€‚</p><p>é‚£ä¹ˆæœ‰äº†çª—å£ï¼Œå°±å¯ä»¥æŒ‡å®šçª—å£å¤§å°ï¼Œ<strong>çª—å£å¤§å°å°±æ˜¯æŒ‡æ— éœ€ç­‰å¾…ç¡®è®¤åº”ç­”ï¼Œè€Œå¯ä»¥ç»§ç»­å‘é€æ•°æ®çš„æœ€å¤§å€¼ã€‚</strong></p><p><strong>çª—å£çš„å®ç°å®é™…ä¸Šæ˜¯æ“ä½œç³»ç»Ÿå¼€è¾Ÿçš„ä¸€ä¸ªç¼“å­˜ç©ºé—´</strong>ï¼Œå‘é€æ–¹ä¸»æœºåœ¨ç­‰åˆ°ç¡®è®¤åº”ç­”è¿”å›ä¹‹å‰ï¼Œå¿…é¡»åœ¨ç¼“å†²åŒºä¸­ä¿ç•™å·²å‘é€çš„æ•°æ®ã€‚å¦‚æœæŒ‰æœŸæ”¶åˆ°ç¡®è®¤åº”ç­”ï¼Œæ­¤æ—¶æ•°æ®å°±å¯ä»¥ä»ç¼“å­˜åŒºæ¸…é™¤ã€‚</p><p>å‡è®¾çª—å£å¤§å°ä¸º 3 ä¸ª TCP æ®µï¼Œé‚£ä¹ˆå‘é€æ–¹å°±å¯ä»¥ã€Œè¿ç»­å‘é€ã€ 3 ä¸ª TCP æ®µï¼Œå¹¶ä¸”ä¸­é€”è‹¥æœ‰ ACK ä¸¢å¤±ï¼Œå¯ä»¥é€šè¿‡ã€Œä¸‹ä¸€ä¸ªç¡®è®¤åº”ç­”è¿›è¡Œç¡®è®¤ã€ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029155533.png" srcset="/img/loading.gif" alt="" /></p><p>å›¾ä¸­çš„ ACK 600 ç¡®è®¤åº”ç­”æŠ¥æ–‡ä¸¢å¤±ï¼Œä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡ä¸‹ä¸€ä¸ªç¡®è®¤åº”ç­”è¿›è¡Œç¡®è®¤ï¼Œåªè¦å‘é€æ–¹æ”¶åˆ°äº† ACK 700 ç¡®è®¤åº”ç­”ï¼Œå°±æ„å‘³ç€ 700 ä¹‹å‰çš„æ‰€æœ‰æ•°æ®ã€Œæ¥æ”¶æ–¹ã€éƒ½æ”¶åˆ°äº†ã€‚è¿™ä¸ªæ¨¡å¼å°±å«<strong>ç´¯è®¡ç¡®è®¤</strong>æˆ–è€…<strong>ç´¯è®¡åº”ç­”</strong>ã€‚</p><h2 id="çª—å£å¤§å°"><a class="markdownIt-Anchor" href="#çª—å£å¤§å°"></a> çª—å£å¤§å°</h2><p>TCP é¦–éƒ¨çš„ <code>Window Size</code> å­—æ®µå°±æ˜¯çª—å£å¤§å°ã€‚è¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚äºæ˜¯<strong>å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®</strong>ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥ã€‚</p><p>æ‰€ä»¥ï¼Œé€šå¸¸çª—å£çš„å¤§å°æ˜¯ç”±æ¥æ”¶æ–¹çš„çª—å£å¤§å°æ¥å†³å®šçš„ã€‚<br />å‘é€æ–¹å‘é€çš„æ•°æ®å¤§å°ä¸èƒ½è¶…è¿‡æ¥æ”¶æ–¹çš„çª—å£å¤§å°ï¼Œå¦åˆ™æ¥æ”¶æ–¹å°±æ— æ³•æ­£å¸¸æ¥æ”¶åˆ°æ•°æ®ã€‚</p><h2 id="å‘é€æ–¹çš„æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#å‘é€æ–¹çš„æ»‘åŠ¨çª—å£"></a> å‘é€æ–¹çš„æ»‘åŠ¨çª—å£</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029160218.png" srcset="/img/loading.gif" alt="" /></p><ul><li>#1 æ˜¯å·²å‘é€å¹¶æ”¶åˆ° ACKç¡®è®¤çš„æ•°æ®ï¼š1~31 å­—èŠ‚</li><li>#2 æ˜¯å·²å‘é€ä½†æœªæ”¶åˆ° ACKç¡®è®¤çš„æ•°æ®ï¼š32~45 å­—èŠ‚</li><li>#3 æ˜¯æœªå‘é€ä½†æ€»å¤§å°åœ¨æ¥æ”¶æ–¹å¤„ç†èŒƒå›´å†…ï¼ˆæ¥æ”¶æ–¹è¿˜æœ‰ç©ºé—´ï¼‰ï¼š46~51å­—èŠ‚</li><li>#4 æ˜¯æœªå‘é€ä½†æ€»å¤§å°è¶…è¿‡æ¥æ”¶æ–¹å¤„ç†èŒƒå›´ï¼ˆæ¥æ”¶æ–¹æ²¡æœ‰ç©ºé—´ï¼‰ï¼š52å­—èŠ‚ä»¥å</li></ul><p>åœ¨ä¸‹å›¾ï¼Œå½“æ”¶åˆ°ä¹‹å‰å‘é€çš„æ•°æ® 32~36 å­—èŠ‚çš„ ACK ç¡®è®¤åº”ç­”åï¼Œå¦‚æœå‘é€çª—å£çš„å¤§å°æ²¡æœ‰å˜åŒ–ï¼Œåˆ™æ»‘åŠ¨çª—å£å¾€å³è¾¹ç§»åŠ¨ 5 ä¸ªå­—èŠ‚ï¼Œå› ä¸ºæœ‰ 5 ä¸ªå­—èŠ‚çš„æ•°æ®è¢«åº”ç­”ç¡®è®¤ï¼Œæ¥ä¸‹æ¥ 52~56 å­—èŠ‚åˆå˜æˆäº†å¯ç”¨çª—å£ï¼Œé‚£ä¹ˆåç»­ä¹Ÿå°±å¯ä»¥å‘é€ 52~56 è¿™ 5 ä¸ªå­—èŠ‚çš„æ•°æ®äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029160400.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ¥æ”¶æ–¹çš„æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ¥æ”¶æ–¹çš„æ»‘åŠ¨çª—å£"></a> æ¥æ”¶æ–¹çš„æ»‘åŠ¨çª—å£</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029161022.jpeg" srcset="/img/loading.gif" alt="" /></p><ul><li>#1 + #2 æ˜¯å·²æˆåŠŸæ¥æ”¶å¹¶ç¡®è®¤çš„æ•°æ®ï¼ˆç­‰å¾…åº”ç”¨è¿›ç¨‹è¯»å–ï¼‰ï¼›</li><li>#3 æ˜¯æœªæ”¶åˆ°æ•°æ®ä½†å¯ä»¥æ¥æ”¶çš„æ•°æ®ï¼›</li><li>#4 æœªæ”¶åˆ°æ•°æ®å¹¶ä¸å¯ä»¥æ¥æ”¶çš„æ•°æ®ï¼›</li></ul><blockquote><p>æ¥æ”¶çª—å£å’Œå‘é€çª—å£çš„å¤§å°å¹¶ä¸æ˜¯å®Œå…¨ç›¸ç­‰ï¼Œæ¥æ”¶çª—å£çš„å¤§å°æ˜¯çº¦ç­‰äºå‘é€çª—å£çš„å¤§å°çš„ã€‚</p></blockquote><p>å› ä¸ºæ»‘åŠ¨çª—å£å¹¶ä¸æ˜¯ä¸€æˆä¸å˜çš„ã€‚æ¯”å¦‚ï¼Œå½“æ¥æ”¶æ–¹çš„åº”ç”¨è¿›ç¨‹è¯»å–æ•°æ®çš„é€Ÿåº¦éå¸¸å¿«çš„è¯ï¼Œè¿™æ ·çš„è¯æ¥æ”¶çª—å£å¯ä»¥å¾ˆå¿«çš„å°±ç©ºç¼ºå‡ºæ¥ã€‚é‚£ä¹ˆæ–°çš„æ¥æ”¶çª—å£å¤§å°ï¼Œæ˜¯é€šè¿‡ TCP æŠ¥æ–‡ä¸­çš„ <code>Window Size</code> å­—æ®µæ¥å‘Šè¯‰å‘é€æ–¹ã€‚é‚£ä¹ˆè¿™ä¸ªä¼ è¾“è¿‡ç¨‹æ˜¯å­˜åœ¨æ—¶å»¶çš„ï¼Œæ‰€ä»¥æ¥æ”¶çª—å£å’Œå‘é€çª—å£æ˜¯çº¦ç­‰äºçš„å…³ç³»ã€‚</p><h1 id="æµé‡æ§åˆ¶"><a class="markdownIt-Anchor" href="#æµé‡æ§åˆ¶"></a> æµé‡æ§åˆ¶</h1><p>å‘é€æ–¹ä¸èƒ½æ— é™åˆ¶çš„å‘æ•°æ®ç»™æ¥æ”¶æ–¹ï¼Œè¦è€ƒè™‘æ¥æ”¶æ–¹å¤„ç†èƒ½åŠ›ã€‚è‹¥å¯¹æ–¹å¤„ç†ä¸è¿‡æ¥ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´è§¦å‘é‡å‘æœºåˆ¶ï¼Œä»è€Œå¯¼è‡´ç½‘ç»œæµé‡çš„æ— ç«¯çš„æµªè´¹ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ç§ç°è±¡å‘ç”Ÿï¼ŒTCP æä¾›ä¸€ç§æœºåˆ¶å¯ä»¥<strong>è®©ã€Œå‘é€æ–¹ã€æ ¹æ®ã€Œæ¥æ”¶æ–¹ã€çš„å®é™…æ¥æ”¶èƒ½åŠ›æ§åˆ¶å‘é€çš„æ•°æ®é‡</strong>ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„<strong>æµé‡æ§åˆ¶</strong>ã€‚</p><p>å‡è®¾ä»¥ä¸‹åœºæ™¯ï¼š</p><ul><li>å®¢æˆ·ç«¯æ˜¯æ¥æ”¶æ–¹ï¼ŒæœåŠ¡ç«¯æ˜¯å‘é€æ–¹</li><li>å‡è®¾æ¥æ”¶çª—å£å’Œå‘é€çª—å£ç›¸åŒï¼Œéƒ½ä¸º <code>200</code></li><li>å‡è®¾ä¸¤ä¸ªè®¾å¤‡åœ¨æ•´ä¸ªä¼ è¾“è¿‡ç¨‹ä¸­éƒ½ä¿æŒç›¸åŒçš„çª—å£å¤§å°ï¼Œä¸å—å¤–ç•Œå½±å“</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029163937.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ“ä½œç³»ç»Ÿç¼“å†²åŒºä¸æ»‘åŠ¨çª—å£çš„å…³ç³»"><a class="markdownIt-Anchor" href="#æ“ä½œç³»ç»Ÿç¼“å†²åŒºä¸æ»‘åŠ¨çª—å£çš„å…³ç³»"></a> æ“ä½œç³»ç»Ÿç¼“å†²åŒºä¸æ»‘åŠ¨çª—å£çš„å…³ç³»</h2><p>å‰é¢çš„æµé‡æ§åˆ¶ä¾‹å­ï¼Œæˆ‘ä»¬å‡å®šäº†å‘é€çª—å£å’Œæ¥æ”¶çª—å£æ˜¯ä¸å˜çš„ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œ<strong>å‘é€çª—å£å’Œæ¥æ”¶çª—å£ä¸­æ‰€å­˜æ”¾çš„å­—èŠ‚æ•°ï¼Œéƒ½æ˜¯æ”¾åœ¨æ“ä½œç³»ç»Ÿå†…å­˜ç¼“å†²åŒºä¸­çš„</strong>ï¼Œè€Œæ“ä½œç³»ç»Ÿçš„ç¼“å†²åŒºï¼Œä¼šè¢«æ“ä½œç³»ç»Ÿè°ƒæ•´ã€‚<br />å½“åº”ç”¨è¿›ç¨‹æ²¡åŠæ³•åŠæ—¶è¯»å–ç¼“å†²åŒºçš„å†…å®¹æ—¶ï¼Œä¹Ÿä¼šå¯¹æˆ‘ä»¬çš„ç¼“å†²åŒºé€ æˆå½±å“ã€‚</p><p>å½“æœåŠ¡ç«¯ç³»ç»Ÿèµ„æºéå¸¸ç´§å¼ çš„æ—¶å€™ï¼Œæ“å¿ƒç³»ç»Ÿå¯èƒ½ä¼šç›´æ¥å‡å°‘äº†æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼Œè¿™æ—¶åº”ç”¨ç¨‹åºåˆæ— æ³•åŠæ—¶è¯»å–ç¼“å­˜æ•°æ®ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±æœ‰ä¸¥é‡çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œä¼šå‡ºç°æ•°æ®åŒ…ä¸¢å¤±çš„ç°è±¡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030153510.png" srcset="/img/loading.gif" alt="" /></p><ol><li>å®¢æˆ·ç«¯å‘é€ 140 å­—èŠ‚çš„æ•°æ®ï¼Œäºæ˜¯å¯ç”¨çª—å£å‡å°‘åˆ°äº† 220ã€‚</li><li>æœåŠ¡ç«¯å› ä¸ºç°åœ¨éå¸¸çš„ç¹å¿™ï¼Œæ“ä½œç³»ç»Ÿäºæ˜¯å°±æŠŠæ¥æ”¶ç¼“å­˜å‡å°‘äº† 120 å­—èŠ‚ï¼Œå½“æ”¶åˆ° 140 å­—èŠ‚æ•°æ®åï¼Œåˆå› ä¸ºåº”ç”¨ç¨‹åºæ²¡æœ‰è¯»å–ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥ 140 å­—èŠ‚ç•™åœ¨äº†ç¼“å†²åŒºä¸­ï¼Œäºæ˜¯æ¥æ”¶çª—å£å¤§å°ä» 360 æ”¶ç¼©æˆäº† 100ï¼Œæœ€åå‘é€ç¡®è®¤ä¿¡æ¯æ—¶ï¼Œé€šå‘Šçª—å£å¤§å°ç»™å¯¹æ–¹ã€‚</li><li>æ­¤æ—¶å®¢æˆ·ç«¯å› ä¸ºè¿˜æ²¡æœ‰æ”¶åˆ°æœåŠ¡ç«¯çš„é€šå‘Šçª—å£æŠ¥æ–‡ï¼Œæ‰€ä»¥ä¸çŸ¥é“æ­¤æ—¶æ¥æ”¶çª—å£æ”¶ç¼©æˆäº† 100ï¼Œå®¢æˆ·ç«¯åªä¼šçœ‹è‡ªå·±çš„å¯ç”¨çª—å£è¿˜æœ‰ 220ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å°±å‘é€äº† 180 å­—èŠ‚æ•°æ®ï¼Œäºæ˜¯å¯ç”¨çª—å£å‡å°‘åˆ° 40ã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ°äº† 180 å­—èŠ‚æ•°æ®æ—¶ï¼Œå‘ç°æ•°æ®å¤§å°è¶…è¿‡äº†æ¥æ”¶çª—å£çš„å¤§å°ï¼Œäºæ˜¯å°±æŠŠæ•°æ®åŒ…ä¸¢å¤±äº†ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°ç¬¬ 2 æ­¥æ—¶ï¼ŒæœåŠ¡ç«¯å‘é€çš„ç¡®è®¤æŠ¥æ–‡å’Œé€šå‘Šçª—å£æŠ¥æ–‡ï¼Œå°è¯•å‡å°‘å‘é€çª—å£åˆ° 100ï¼ŒæŠŠçª—å£çš„å³ç«¯å‘å·¦æ”¶ç¼©äº† 80ï¼Œæ­¤æ—¶å¯ç”¨çª—å£çš„å¤§å°å°±ä¼šå‡ºç°è¯¡å¼‚çš„è´Ÿå€¼ã€‚</li></ol><p>æ‰€ä»¥ï¼Œå¦‚æœå‘ç”Ÿäº†å…ˆå‡å°‘ç¼“å­˜ï¼Œå†æ”¶ç¼©çª—å£ï¼Œå°±ä¼šå‡ºç°ä¸¢åŒ…çš„ç°è±¡ã€‚</p><p>ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œ<strong>TCP è§„å®šæ˜¯ä¸å…è®¸åŒæ—¶å‡å°‘ç¼“å­˜åˆæ”¶ç¼©çª—å£çš„ï¼Œè€Œæ˜¯é‡‡ç”¨å…ˆæ”¶ç¼©çª—å£ï¼Œè¿‡æ®µæ—¶é—´å†å‡å°‘ç¼“å­˜</strong>ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…äº†ä¸¢åŒ…æƒ…å†µã€‚</p><h2 id="çª—å£å…³é—­"><a class="markdownIt-Anchor" href="#çª—å£å…³é—­"></a> çª—å£å…³é—­</h2><p>TCP é€šè¿‡è®©æ¥æ”¶æ–¹æŒ‡æ˜å¸Œæœ›ä»å‘é€æ–¹æ¥æ”¶çš„æ•°æ®å¤§å°ï¼ˆçª—å£å¤§å°ï¼‰æ¥è¿›è¡Œæµé‡æ§åˆ¶ã€‚</p><blockquote><p>çª—å£å…³é—­ï¼šå¦‚æœçª—å£å¤§å°ä¸º 0 æ—¶ï¼Œå°±ä¼šé˜»æ­¢å‘é€æ–¹ç»™æ¥æ”¶æ–¹ä¼ é€’æ•°æ®ï¼Œç›´åˆ°çª—å£å˜ä¸ºé 0 ä¸ºæ­¢ã€‚</p></blockquote><p>æ¥æ”¶æ–¹å‘å‘é€æ–¹é€šå‘Šçª—å£å¤§å°æ—¶ï¼Œæ˜¯é€šè¿‡ <code>ACK</code> æŠ¥æ–‡æ¥é€šå‘Šçš„ã€‚</p><p>é‚£ä¹ˆï¼Œå½“å‘ç”Ÿçª—å£å…³é—­æ—¶ï¼Œæ¥æ”¶æ–¹å¤„ç†å®Œæ•°æ®åï¼Œä¼šå‘å‘é€æ–¹é€šå‘Šä¸€ä¸ªçª—å£<code>é 0 çš„ ACK æŠ¥æ–‡</code>ï¼Œå¦‚æœè¿™ä¸ªé€šå‘Šçª—å£çš„ <code>ACK</code> æŠ¥æ–‡åœ¨ç½‘ç»œä¸­ä¸¢å¤±äº†ï¼Œé‚£éº»çƒ¦å°±å¤§äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030154802.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¼šå¯¼è‡´<strong>å‘é€æ–¹ä¸€ç›´ç­‰å¾…æ¥æ”¶æ–¹çš„é 0 çª—å£é€šçŸ¥ï¼Œæ¥æ”¶æ–¹ä¹Ÿä¸€ç›´ç­‰å¾…å‘é€æ–¹çš„æ•°æ®</strong>ï¼Œå¦‚ä¸é‡‡å–æªæ–½ï¼Œè¿™ç§ç›¸äº’ç­‰å¾…çš„è¿‡ç¨‹ï¼Œä¼šé€ æˆäº†æ­»é”çš„ç°è±¡ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTCP ä¸ºæ¯ä¸ªè¿æ¥è®¾æœ‰ä¸€ä¸ªæŒç»­å®šæ—¶å™¨ï¼Œ<strong>åªè¦ TCP è¿æ¥ä¸€æ–¹æ”¶åˆ°å¯¹æ–¹çš„é›¶çª—å£é€šçŸ¥ï¼Œå°±å¯åŠ¨æŒç»­è®¡æ—¶å™¨ã€‚</strong></p><p>å¦‚æœæŒç»­è®¡æ—¶å™¨è¶…æ—¶ï¼Œå°±ä¼šå‘é€<code>çª—å£æ¢æµ‹ (Window probe)</code> æŠ¥æ–‡ï¼Œè€Œå¯¹æ–¹åœ¨ç¡®è®¤è¿™ä¸ªæ¢æµ‹æŠ¥æ–‡æ—¶ï¼Œç»™å‡ºè‡ªå·±ç°åœ¨çš„æ¥æ”¶çª—å£å¤§å°ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030155139.jpeg" srcset="/img/loading.gif" alt="" /></p><ul><li>å¦‚æœæ¥æ”¶çª—å£ä»ç„¶ä¸º 0ï¼Œé‚£ä¹ˆæ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡çš„ä¸€æ–¹å°±ä¼šé‡æ–°å¯åŠ¨æŒç»­è®¡æ—¶å™¨ï¼›</li><li>å¦‚æœæ¥æ”¶çª—å£ä¸æ˜¯ 0ï¼Œé‚£ä¹ˆæ­»é”çš„å±€é¢å°±å¯ä»¥è¢«æ‰“ç ´äº†ã€‚</li></ul><p>çª—å£æ¢æµ‹çš„æ¬¡æ•°ä¸€èˆ¬ä¸º 3 æ¬¡ï¼Œæ¯æ¬¡å¤§çº¦ 30-60 ç§’ï¼ˆä¸åŒçš„å®ç°å¯èƒ½ä¼šä¸ä¸€æ ·ï¼‰ã€‚å¦‚æœ 3 æ¬¡è¿‡åæ¥æ”¶çª—å£è¿˜æ˜¯ 0 çš„è¯ï¼Œæœ‰çš„ <code>TCP</code> å®ç°å°±ä¼šå‘ <code>RST</code> æŠ¥æ–‡æ¥ä¸­æ–­è¿æ¥ã€‚</p><h2 id="ç³Šæ¶‚çª—å£ç»¼åˆç—‡"><a class="markdownIt-Anchor" href="#ç³Šæ¶‚çª—å£ç»¼åˆç—‡"></a> ç³Šæ¶‚çª—å£ç»¼åˆç—‡</h2><p>å¦‚æœæ¥æ”¶æ–¹å¤ªå¿™äº†ï¼Œæ¥ä¸åŠå–èµ°æ¥æ”¶çª—å£é‡Œçš„æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å‘é€æ–¹çš„å‘é€çª—å£è¶Šæ¥è¶Šå°ã€‚</p><p>åˆ°æœ€åï¼Œ<strong>å¦‚æœæ¥æ”¶æ–¹è…¾å‡ºå‡ ä¸ªå­—èŠ‚å¹¶å‘Šè¯‰å‘é€æ–¹ç°åœ¨æœ‰å‡ ä¸ªå­—èŠ‚çš„çª—å£ï¼Œè€Œå‘é€æ–¹ä¼šä¹‰æ— åé¡¾åœ°å‘é€è¿™å‡ ä¸ªå­—èŠ‚ï¼Œè¿™å°±æ˜¯ç³Šæ¶‚çª—å£ç»¼åˆç—‡ã€‚</strong></p><p>æ¥æ”¶æ–¹çš„çª—å£å¤§å°æ˜¯ 360 å­—èŠ‚ï¼Œä½†æ¥æ”¶æ–¹ç”±äºæŸäº›åŸå› é™·å…¥å›°å¢ƒï¼Œå‡è®¾æ¥æ”¶æ–¹çš„åº”ç”¨å±‚è¯»å–çš„èƒ½åŠ›å¦‚ä¸‹ï¼š</p><ul><li>æ¥æ”¶æ–¹æ¯æ¥æ”¶ 3 ä¸ªå­—èŠ‚ï¼Œåº”ç”¨ç¨‹åºå°±åªèƒ½ä»ç¼“å†²åŒºä¸­è¯»å– 1 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼›</li><li>åœ¨ä¸‹ä¸€ä¸ªå‘é€æ–¹çš„ TCP æ®µåˆ°è¾¾ä¹‹å‰ï¼Œåº”ç”¨ç¨‹åºè¿˜ä»ç¼“å†²åŒºä¸­è¯»å–äº† 40 ä¸ªé¢å¤–çš„å­—èŠ‚ï¼›</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030161555.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰€ä»¥ï¼Œç³Šæ¶‚çª—å£ç»¼åˆç—‡çš„ç°è±¡æ˜¯å¯ä»¥å‘ç”Ÿåœ¨å‘é€æ–¹å’Œæ¥æ”¶æ–¹ï¼š</p><ul><li>æ¥æ”¶æ–¹å¯ä»¥é€šå‘Šä¸€ä¸ªå°çš„çª—å£</li><li>è€Œå‘é€æ–¹å¯ä»¥å‘é€å°æ•°æ®</li></ul><p>äºæ˜¯ï¼Œè¦è§£å†³ç³Šæ¶‚çª—å£ç»¼åˆç—‡ï¼Œå°±è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜å°±å¯ä»¥äº†</p><ul><li><p>è®©æ¥æ”¶æ–¹ä¸é€šå‘Šå°çª—å£ç»™å‘é€æ–¹<br />å½“<code>ã€Œçª—å£å¤§å°ã€&lt; min(MSSï¼Œç¼“å­˜ç©ºé—´ / 2)</code>ï¼Œå°±ä¼šå‘å‘é€æ–¹é€šå‘Šçª—å£ä¸º 0ï¼Œä¹Ÿå°±é˜»æ­¢äº†å‘é€æ–¹å†å‘æ•°æ®è¿‡æ¥ã€‚<br />ç­‰åˆ°æ¥æ”¶æ–¹å¤„ç†äº†ä¸€äº›æ•°æ®åï¼Œçª—å£å¤§å° &gt;= MSSï¼Œæˆ–è€…æ¥æ”¶æ–¹ç¼“å­˜ç©ºé—´æœ‰ä¸€åŠå¯ä»¥ä½¿ç”¨ï¼Œå°±å¯ä»¥æŠŠçª—å£æ‰“å¼€è®©å‘é€æ–¹å‘é€æ•°æ®è¿‡æ¥ã€‚</p></li><li><p>è®©å‘é€æ–¹é¿å…å‘é€å°æ•°æ®<br />ä½¿ç”¨ Nagle ç®—æ³•ï¼Œè¯¥ç®—æ³•çš„æ€è·¯æ˜¯å»¶æ—¶å¤„ç†ï¼Œå®ƒæ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä¸€æ¡æ‰å¯ä»¥å‘é€æ•°æ®ï¼š</p><ul><li>è¦ç­‰åˆ°<code>çª—å£å¤§å° &gt;= MSS</code> æˆ–æ˜¯ <code>æ•°æ®å¤§å° &gt;= MSS</code></li><li>æ”¶åˆ°ä¹‹å‰å‘é€æ•°æ®çš„ <code>ACK</code> å›åŒ…</li></ul></li></ul><h1 id="æ‹¥å¡æ§åˆ¶"><a class="markdownIt-Anchor" href="#æ‹¥å¡æ§åˆ¶"></a> æ‹¥å¡æ§åˆ¶</h1><blockquote><p>æ‹¥å¡æ§åˆ¶çš„ç›®çš„å°±æ˜¯é¿å…ã€Œå‘é€æ–¹ã€çš„æ•°æ®å¡«æ»¡æ•´ä¸ªç½‘ç»œã€‚</p></blockquote><p>åªè¦ã€Œå‘é€æ–¹ã€æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…æ¥æ”¶åˆ° ACK åº”ç­”æŠ¥æ–‡ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿäº†<strong>è¶…æ—¶é‡ä¼ </strong>ï¼Œå°±ä¼šè®¤ä¸ºç½‘ç»œå‡ºç°äº†æ‹¥å¡ã€‚</p><p>åœ¨ç½‘ç»œå‡ºç°æ‹¥å µæ—¶ï¼Œå¦‚æœç»§ç»­å‘é€å¤§é‡æ•°æ®åŒ…ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®åŒ…æ—¶å»¶ã€ä¸¢å¤±ç­‰ï¼Œè¿™æ—¶ TCP å°±ä¼šé‡ä¼ æ•°æ®ï¼Œä½†æ˜¯ä¸€é‡ä¼ å°±ä¼šå¯¼è‡´ç½‘ç»œçš„è´Ÿæ‹…æ›´é‡ï¼Œäºæ˜¯ä¼šå¯¼è‡´æ›´å¤§çš„å»¶è¿Ÿä»¥åŠæ›´å¤šçš„ä¸¢åŒ…ï¼Œè¿™ä¸ªæƒ…å†µå°±ä¼šè¿›å…¥æ¶æ€§å¾ªç¯è¢«ä¸æ–­åœ°æ”¾å¤§ã€‚</p><h2 id="æ‹¥å¡çª—å£"><a class="markdownIt-Anchor" href="#æ‹¥å¡çª—å£"></a> æ‹¥å¡çª—å£</h2><p><code>æ‹¥å¡çª—å£ cwnd</code> æ˜¯å‘é€æ–¹ç»´æŠ¤çš„ä¸€ä¸ªçš„çŠ¶æ€å˜é‡ï¼Œå®ƒä¼š<strong>æ ¹æ®ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦åŠ¨æ€å˜åŒ–</strong>çš„ã€‚</p><p>å‘é€çª—å£ <code>swnd</code> å’Œæ¥æ”¶çª—å£ <code>rwnd</code> æ˜¯çº¦ç­‰äºçš„å…³ç³»ï¼Œé‚£ä¹ˆç”±äºåŠ å…¥äº†æ‹¥å¡çª—å£çš„æ¦‚å¿µåï¼Œæ­¤æ—¶å‘é€çª—å£çš„å€¼æ˜¯ <code>swnd = min(cwnd, rwnd)</code>ï¼Œä¹Ÿå°±æ˜¯æ‹¥å¡çª—å£å’Œæ¥æ”¶çª—å£ä¸­çš„æœ€å°å€¼ã€‚</p><p>æ‹¥å¡çª—å£ <code>cwnd</code> å˜åŒ–çš„è§„åˆ™ï¼š</p><ul><li>åªè¦ç½‘ç»œä¸­æ²¡æœ‰å‡ºç°æ‹¥å¡ï¼Œ<code>cwnd</code> å°±ä¼šå¢å¤§ï¼›</li><li>ä½†ç½‘ç»œä¸­å‡ºç°äº†æ‹¥å¡ï¼Œ<code>cwnd</code> å°±å‡å°‘ï¼›</li></ul><h2 id="æ‹¥å¡æ§åˆ¶ç®—æ³•"><a class="markdownIt-Anchor" href="#æ‹¥å¡æ§åˆ¶ç®—æ³•"></a> æ‹¥å¡æ§åˆ¶ç®—æ³•</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030180921.png" srcset="/img/loading.gif" alt="" /></p><h3 id="1-æ…¢å¯åŠ¨"><a class="markdownIt-Anchor" href="#1-æ…¢å¯åŠ¨"></a> 1. æ…¢å¯åŠ¨</h3><blockquote><p>æ…¢å¯åŠ¨çš„ç®—æ³•è§„åˆ™ï¼šå½“å‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ª <code>ACK</code>ï¼Œæ‹¥å¡çª—å£ <code>cwnd</code> çš„å¤§å°å°±ä¼šåŠ  <code>1</code>ã€‚</p></blockquote><p>TCP åœ¨åˆšå»ºç«‹è¿æ¥å®Œæˆåï¼Œé¦–å…ˆæ˜¯æœ‰ä¸ªæ…¢å¯åŠ¨çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ…¢å¯åŠ¨çš„æ„æ€å°±æ˜¯ä¸€ç‚¹ä¸€ç‚¹çš„æé«˜å‘é€æ•°æ®åŒ…çš„æ•°é‡ã€‚</p><p>è¿™é‡Œ<strong>å‡å®šæ‹¥å¡çª—å£ <code>cwnd</code> å’Œå‘é€çª—å£ <code>swnd</code> ç›¸ç­‰</strong>ï¼Œä¸‹é¢ä¸¾ä¸ªæ —å­ï¼š</p><ol><li>è¿æ¥å»ºç«‹å®Œæˆåï¼Œä¸€å¼€å§‹åˆå§‹åŒ– <code>cwnd = 1</code>ï¼Œè¡¨ç¤ºå¯ä»¥ä¼ ä¸€ä¸ª MSS å¤§å°çš„æ•°æ®ã€‚</li><li>å½“æ”¶åˆ°ä¸€ä¸ª <code>ACK</code> ç¡®è®¤åº”ç­”åï¼Œ<code>cwnd</code> å¢åŠ  1ï¼Œäºæ˜¯ä¸€æ¬¡èƒ½å¤Ÿå‘é€ 2 ä¸ª</li><li>å½“æ”¶åˆ° 2 ä¸ªçš„ <code>ACK</code> ç¡®è®¤åº”ç­”åï¼Œ <code>cwnd</code> å¢åŠ  2ï¼Œäºæ˜¯å°±å¯ä»¥æ¯”ä¹‹å‰å¤šå‘2 ä¸ªï¼Œæ‰€ä»¥è¿™ä¸€æ¬¡èƒ½å¤Ÿå‘é€ 4 ä¸ª</li><li>å½“è¿™ 4 ä¸ªçš„ <code>ACK</code> ç¡®è®¤åˆ°æ¥çš„æ—¶å€™ï¼Œæ¯ä¸ªç¡®è®¤ <code>cwnd</code> å¢åŠ  1ï¼Œ 4 ä¸ªç¡®è®¤ <code>cwnd</code> å¢åŠ  4ï¼Œäºæ˜¯å°±å¯ä»¥æ¯”ä¹‹å‰å¤šå‘ 4 ä¸ªï¼Œæ‰€ä»¥è¿™ä¸€æ¬¡èƒ½å¤Ÿå‘é€ 8 ä¸ªã€‚</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030163027.png" srcset="/img/loading.gif" alt="" /></p><p>å¯ä»¥çœ‹å‡ºæ…¢å¯åŠ¨ç®—æ³•ï¼Œå‘åŒ…çš„ä¸ªæ•°æ˜¯<strong>æŒ‡æ•°æ€§çš„å¢é•¿</strong>ã€‚</p><p>ä¸ºäº†é˜²æ­¢æ‹¥å¡çª—å£å¢é•¿è¿‡å¤§ï¼Œè¿˜éœ€è¦è®¾ç½®<code>æ…¢å¯åŠ¨é—¨é™ ssthresh</code> ï¼ˆ<code>slow start threshold</code>ï¼‰çŠ¶æ€å˜é‡ã€‚</p><ul><li>å½“ <code>cwnd &lt; ssthresh</code> æ—¶ï¼Œä½¿ç”¨<strong>æ…¢å¯åŠ¨</strong>ç®—æ³•ã€‚</li><li>å½“ <code>cwnd &gt;= ssthresh</code> æ—¶ï¼Œå°±ä¼šä½¿ç”¨<strong>æ‹¥å¡é¿å…</strong>ç®—æ³•ã€‚</li></ul><h3 id="2-æ‹¥å¡é¿å…"><a class="markdownIt-Anchor" href="#2-æ‹¥å¡é¿å…"></a> 2. æ‹¥å¡é¿å…</h3><blockquote><p>æ‹¥å¡é¿å…ç®—æ³•çš„è§„åˆ™ï¼šæ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´ <code>RTT</code> å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£åŠ  1ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030163531.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ‹¥å¡é¿å…ç®—æ³•å°±æ˜¯å°†åŸæœ¬æ…¢å¯åŠ¨ç®—æ³•çš„æŒ‡æ•°å¢é•¿å˜æˆäº†<strong>çº¿æ€§å¢é•¿</strong>ï¼Œè¿˜æ˜¯å¢é•¿é˜¶æ®µï¼Œä½†æ˜¯å¢é•¿é€Ÿåº¦ç¼“æ…¢äº†ä¸€äº›ã€‚</p><p>å°±è¿™ä¹ˆä¸€ç›´å¢é•¿ç€åï¼Œç½‘ç»œå°±ä¼šæ…¢æ…¢è¿›å…¥äº†æ‹¥å¡çš„çŠ¶å†µäº†ï¼Œäºæ˜¯å°±ä¼šå‡ºç°<strong>ä¸¢åŒ…</strong>ç°è±¡ï¼Œè¿™æ—¶å°±éœ€è¦å¯¹ä¸¢å¤±çš„æ•°æ®åŒ…è¿›è¡Œ<strong>é‡ä¼ </strong>ã€‚</p><p>å½“è§¦å‘äº†é‡ä¼ æœºåˆ¶ï¼Œä¹Ÿå°±è¿›å…¥äº†ã€Œæ‹¥å¡å‘ç”Ÿç®—æ³•ã€ã€‚</p><h3 id="3-è¶…æ—¶é‡ä¼ å’Œæ…¢å¯åŠ¨"><a class="markdownIt-Anchor" href="#3-è¶…æ—¶é‡ä¼ å’Œæ…¢å¯åŠ¨"></a> 3. è¶…æ—¶é‡ä¼ å’Œæ…¢å¯åŠ¨</h3><ol><li>ä¹˜æ³•å‡å°ï¼š<code>ssthresh</code> è®¾ä¸º <code>cwnd/2</code>ï¼›</li><li>æ…¢å¯åŠ¨ï¼š<code>cwnd</code> é‡ç½®ä¸º <code>1</code>ï¼Œå¼€å§‹æ…¢å¯åŠ¨ã€‚</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030163907.png" srcset="/img/loading.gif" alt="" /></p><p>æ¥ç€ï¼Œå°±é‡æ–°å¼€å§‹æ…¢å¯åŠ¨ï¼Œæ…¢å¯åŠ¨æ˜¯ä¼šçªç„¶å‡å°‘æ•°æ®æµçš„ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å¤ªæ¿€è¿›äº†ï¼Œååº”ä¹Ÿå¾ˆå¼ºçƒˆï¼Œä¼šé€ æˆç½‘ç»œå¡é¡¿ã€‚</p><h3 id="4-å¿«é‡ä¼ å’Œå¿«é€Ÿæ¢å¤"><a class="markdownIt-Anchor" href="#4-å¿«é‡ä¼ å’Œå¿«é€Ÿæ¢å¤"></a> 4. å¿«é‡ä¼ å’Œå¿«é€Ÿæ¢å¤</h3><p>å½“æ¥æ”¶æ–¹å‘ç°ä¸¢äº†ä¸€ä¸ªä¸­é—´åŒ…çš„æ—¶å€™ï¼Œå‘é€ä¸‰æ¬¡å‰ä¸€ä¸ªåŒ…çš„ ACKï¼Œäºæ˜¯å‘é€ç«¯å°±ä¼šå¿«é€Ÿåœ°é‡ä¼ ï¼Œä¸å¿…ç­‰å¾…è¶…æ—¶å†é‡ä¼ ã€‚</p><ol><li><code>cwnd = cwnd/2</code> ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®ä¸ºåŸæ¥çš„ä¸€åŠ;</li><li><code>ssthresh = cwnd</code>;</li><li>è¿›å…¥å¿«æ¢å¤ç®—æ³•</li></ol><p>å¿«æ¢å¤æµç¨‹ï¼š</p><ol><li>æ‹¥å¡çª—å£ <code>cwnd = ssthresh + 3</code> ï¼ˆ 3 çš„æ„æ€æ˜¯ç¡®è®¤æœ‰ 3 ä¸ªæ•°æ®åŒ…è¢«æ”¶åˆ°äº†ï¼‰ï¼›</li><li>é‡ä¼ ä¸¢å¤±çš„æ•°æ®åŒ…ï¼›</li><li>å¦‚æœå†æ”¶åˆ°é‡å¤çš„ <code>ACK</code>ï¼Œé‚£ä¹ˆ <code>cwnd</code> å¢åŠ  1ï¼›</li><li>å¦‚æœæ”¶åˆ°æ–°æ•°æ®çš„ <code>ACK</code> åï¼ŒæŠŠ <code>cwnd</code> è®¾ç½®ä¸ºç¬¬ä¸€æ­¥ä¸­çš„ <code>ssthresh</code> çš„å€¼ï¼ŒåŸå› æ˜¯è¯¥ <code>ACK</code> ç¡®è®¤äº†æ–°çš„æ•°æ®ï¼Œè¯´æ˜ä» <code>duplicated ACK</code> æ—¶çš„æ•°æ®éƒ½å·²æ”¶åˆ°ï¼Œè¯¥æ¢å¤è¿‡ç¨‹å·²ç»ç»“æŸï¼Œå¯ä»¥å›åˆ°æ¢å¤ä¹‹å‰çš„çŠ¶æ€äº†ï¼Œä¹Ÿå³å†æ¬¡è¿›å…¥æ‹¥å¡é¿å…çŠ¶æ€ï¼›</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201030180102.png" srcset="/img/loading.gif" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 219. å­˜åœ¨é‡å¤å…ƒç´  II</title>
    <link href="/2020/10/28/LeetCode-219-contains-duplicate-ii/"/>
    <url>/2020/10/28/LeetCode-219-contains-duplicate-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/contains-duplicate-ii/" target="_blank" rel="noopener">219. å­˜åœ¨é‡å¤å…ƒç´  II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">containsNearbyDuplicate</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (map.containsKey(nums[i])) &#123;            <span class="hljs-keyword">int</span> idx = map.get(nums[i]);            <span class="hljs-keyword">if</span> (Math.abs(idx - i) &lt;= k) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;        &#125;        map.put(nums[i], i);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 23. åˆå¹¶Kä¸ªå‡åºé“¾è¡¨</title>
    <link href="/2020/10/28/LeetCode-23-merge-k-sorted-lists/"/>
    <url>/2020/10/28/LeetCode-23-merge-k-sorted-lists/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/merge-k-sorted-lists/" target="_blank" rel="noopener">23. åˆå¹¶Kä¸ªå‡åºé“¾è¡¨</a></p><h1 id="å°é¡¶å †"><a class="markdownIt-Anchor" href="#å°é¡¶å †"></a> å°é¡¶å †</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">mergeKLists</span><span class="hljs-params">(ListNode[] lists)</span> </span>&#123;    PriorityQueue&lt;ListNode&gt; maxHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; o1.val - o2.val);    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    ListNode head = dummy;    <span class="hljs-comment">// æ”¾å…¥å°é¡¶å †</span>    <span class="hljs-keyword">for</span> (ListNode node : lists) &#123;        ListNode cur = node;        ListNode next;        <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-comment">// åˆ‡æ–­ cur å’Œ next ä¹‹é—´çš„è”ç³»ï¼Œå¦åˆ™å¯èƒ½å‡ºç°ç¯</span>            next = cur.next;            cur.next = <span class="hljs-keyword">null</span>;            maxHeap.add(cur);            cur = next;        &#125;    &#125;    <span class="hljs-comment">// ä¾æ¬¡å‡ºé˜Ÿé“¾æ¥</span>    <span class="hljs-keyword">while</span> (!maxHeap.isEmpty()) &#123;        head.next = maxHeap.poll();        head = head.next;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre><h1 id="k-ä¸ªæŒ‡é’ˆåç§»"><a class="markdownIt-Anchor" href="#k-ä¸ªæŒ‡é’ˆåç§»"></a> K ä¸ªæŒ‡é’ˆåç§»</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">mergeKLists</span><span class="hljs-params">(ListNode[] lists)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = lists.length;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    ListNode tail = dummy;    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;        <span class="hljs-comment">// æ¯æ¬¡æ‰¾åˆ° lists ä¸­æœ€å°çš„ç»“ç‚¹</span>        ListNode minNode = <span class="hljs-keyword">null</span>;        <span class="hljs-comment">// æœ€å°ç»“ç‚¹å¯¹åº”åœ¨ lists ä¸­çš„ä½ç½®</span>        <span class="hljs-keyword">int</span> minIdx = -<span class="hljs-number">1</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;            <span class="hljs-keyword">if</span> (lists[i] == <span class="hljs-keyword">null</span>) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// æ¯æ¬¡éƒ½æ¯”è¾ƒå¤´ç»“ç‚¹</span>            <span class="hljs-keyword">if</span> (minNode == <span class="hljs-keyword">null</span> || lists[i].val &lt; minNode.val) &#123;                minNode = lists[i];                minIdx = i;            &#125;        &#125;        <span class="hljs-keyword">if</span> (minIdx == -<span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">break</span>;        &#125;        tail.next = minNode;        tail = tail.next;        <span class="hljs-comment">// ç§»åŠ¨å¤´ç»“ç‚¹ï¼šæŠŠæœ¬æ¬¡æœ€å°çš„é‚£æ¡é“¾è¡¨åç§»</span>        lists[minIdx] = lists[minIdx].next;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre><h1 id="ä¸¤ä¸¤åˆå¹¶"><a class="markdownIt-Anchor" href="#ä¸¤ä¸¤åˆå¹¶"></a> ä¸¤ä¸¤åˆå¹¶</h1><p>å¤§çš„åˆå¹¶å°çš„ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">mergeKLists</span><span class="hljs-params">(ListNode[] lists)</span> </span>&#123;    ListNode head = <span class="hljs-keyword">null</span>;    <span class="hljs-keyword">for</span> (ListNode node : lists) &#123;        head = merge2Lists(head, node);    &#125;    <span class="hljs-keyword">return</span> head;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> ListNode <span class="hljs-title">merge2Lists</span><span class="hljs-params">(ListNode node1, ListNode node2)</span> </span>&#123;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>);    ListNode tail = dummy;    <span class="hljs-keyword">while</span> (node1 != <span class="hljs-keyword">null</span> &amp;&amp; node2 != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">if</span> (node1.val &lt; node2.val) &#123;            tail.next = node1;            node1 = node1.next;        &#125; <span class="hljs-keyword">else</span> &#123;            tail.next = node2;            node2 = node2.next;        &#125;        tail = tail.next;    &#125;    tail.next = node1 == <span class="hljs-keyword">null</span> ? node2 : node1;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre><p>ä¸¤ä¸¤åˆå¹¶ï¼Œå°çš„åˆæˆå¤§çš„ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">mergeKLists</span><span class="hljs-params">(ListNode[] lists)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = lists.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-keyword">while</span> (len &gt; <span class="hljs-number">1</span>) &#123;        <span class="hljs-comment">// åˆå¹¶å®Œæˆåçš„é“¾è¡¨æ•°</span>        <span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">2</span>) &#123;            <span class="hljs-keyword">if</span> (i == len - <span class="hljs-number">1</span>) &#123;                lists[idx] = lists[i];            &#125; <span class="hljs-keyword">else</span> &#123;                lists[idx] = merge2Lists(lists[i], lists[i + <span class="hljs-number">1</span>]);            &#125;            idx++;        &#125;        <span class="hljs-comment">// å¯¹åˆå¹¶å®Œæˆåçš„ idx æ¡é“¾è¡¨å†åˆå¹¶ï¼Œç›´åˆ°åˆæˆä¸€æ¡</span>        len = idx;    &#125;    <span class="hljs-keyword">return</span> lists[<span class="hljs-number">0</span>];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é“¾è¡¨</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1306. è·³è·ƒæ¸¸æˆ III</title>
    <link href="/2020/10/28/LeetCode-1306-jump-game-iii/"/>
    <url>/2020/10/28/LeetCode-1306-jump-game-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/jump-game-iii/" target="_blank" rel="noopener">1306. è·³è·ƒæ¸¸æˆ III</a></p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canReach</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> start)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = arr.length;    <span class="hljs-keyword">boolean</span>[] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len];    LinkedList&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    queue.add(start);    visited[start] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        <span class="hljs-keyword">int</span> curPos = queue.poll();        <span class="hljs-keyword">if</span> (arr[curPos] == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">// å‘å‰åæœç´¢</span>        <span class="hljs-keyword">int</span> forward = curPos + arr[curPos];        <span class="hljs-keyword">int</span> backward = curPos - arr[curPos];        <span class="hljs-keyword">if</span> (forward &lt; len &amp;&amp; !visited[forward]) &#123;            visited[forward] = <span class="hljs-keyword">true</span>;            queue.add(forward);        &#125;        <span class="hljs-keyword">if</span> (backward &gt;= <span class="hljs-number">0</span> &amp;&amp; !visited[backward]) &#123;            visited[backward] = <span class="hljs-keyword">true</span>;            queue.add(backward);        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canReach</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> start)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = arr.length;    <span class="hljs-keyword">boolean</span>[] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len];    <span class="hljs-keyword">return</span> dfs(arr, len, start, visited);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">boolean</span>[] visited)</span> </span>&#123;    <span class="hljs-comment">// è¶Šè¿‡è¾¹ç•Œ || è®¿é—®è¿‡</span>    <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || start &gt;= len || visited[start]) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-comment">// ç»ˆç‚¹</span>    <span class="hljs-keyword">if</span> (arr[start] == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">// æ ‡è®°è®¿é—®ä½</span>    visited[start] = <span class="hljs-keyword">true</span>;    <span class="hljs-comment">// å‘å‰</span>    <span class="hljs-keyword">int</span> forward = start + arr[start];    <span class="hljs-comment">// å‘å</span>    <span class="hljs-keyword">int</span> backward = start - arr[start];    <span class="hljs-keyword">return</span> dfs(arr, len, forward, visited) || dfs(arr, len, backward, visited);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1207. ç‹¬ä¸€æ— äºŒçš„å‡ºç°æ¬¡æ•°</title>
    <link href="/2020/10/28/LeetCode-1207-unique-number-of-occurrences/"/>
    <url>/2020/10/28/LeetCode-1207-unique-number-of-occurrences/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/unique-number-of-occurrences/" target="_blank" rel="noopener">1207. ç‹¬ä¸€æ— äºŒçš„å‡ºç°æ¬¡æ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">uniqueOccurrences</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        <span class="hljs-keyword">int</span> occur = map.getOrDefault(num, <span class="hljs-number">0</span>);        map.put(num, occur + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[arr.length + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> occur : map.values()) &#123;        <span class="hljs-keyword">if</span> (counts[occur] &gt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        counts[occur]++;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TCP ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</title>
    <link href="/2020/10/28/network-TCP-three-way-handshake-four-way-wavehand/"/>
    <url>/2020/10/28/network-TCP-three-way-handshake-four-way-wavehand/</url>
    
    <content type="html"><![CDATA[<h1 id="tcp-åŸºæœ¬è®¤è¯†"><a class="markdownIt-Anchor" href="#tcp-åŸºæœ¬è®¤è¯†"></a> TCP åŸºæœ¬è®¤è¯†</h1><h2 id="tcp-åŸºç¡€"><a class="markdownIt-Anchor" href="#tcp-åŸºç¡€"></a> TCP åŸºç¡€</h2><h3 id="tcp-å¤´æ ¼å¼"><a class="markdownIt-Anchor" href="#tcp-å¤´æ ¼å¼"></a> TCP å¤´æ ¼å¼</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028143112.png" srcset="/img/loading.gif" alt="" /></p><p><strong>åºåˆ—å·</strong>ï¼šåœ¨å»ºç«‹è¿æ¥æ—¶ç”±è®¡ç®—æœºç”Ÿæˆçš„éšæœºæ•°ä½œä¸ºå…¶åˆå§‹å€¼ï¼Œé€šè¿‡ <code>SYN</code> åŒ…ä¼ ç»™æ¥æ”¶ç«¯ä¸»æœºï¼Œæ¯å‘é€ä¸€æ¬¡æ•°æ®ï¼Œå°±ã€Œç´¯åŠ ã€ä¸€æ¬¡è¯¥ã€Œæ•°æ®å­—èŠ‚æ•°ã€çš„å¤§å°ã€‚<strong>ç”¨æ¥è§£å†³ç½‘ç»œåŒ…ä¹±åºé—®é¢˜</strong>ã€‚</p><p><strong>ç¡®è®¤åº”ç­”å·</strong>ï¼šæŒ‡ä¸‹ä¸€æ¬¡ã€ŒæœŸæœ›ã€æ”¶åˆ°çš„æ•°æ®çš„åºåˆ—å·ï¼Œå‘é€ç«¯æ”¶åˆ°è¿™ä¸ªç¡®è®¤åº”ç­”ä»¥åå¯ä»¥è®¤ä¸ºåœ¨è¿™ä¸ªåºå·ä»¥å‰çš„æ•°æ®éƒ½å·²ç»è¢«æ­£å¸¸æ¥æ”¶ã€‚<strong>ç”¨æ¥è§£å†³ä¸ä¸¢åŒ…çš„é—®é¢˜</strong>ã€‚</p><p><strong>æ§åˆ¶ä½</strong>ï¼š</p><ul><li><code>ACK</code>ï¼šè¯¥ä½ä¸º 1 æ—¶ï¼Œã€Œç¡®è®¤åº”ç­”ã€çš„å­—æ®µå˜ä¸ºæœ‰æ•ˆï¼ŒTCP è§„å®šé™¤äº†æœ€åˆå»ºç«‹è¿æ¥æ—¶çš„ SYN åŒ…ä¹‹å¤–è¯¥ä½å¿…é¡»è®¾ç½®ä¸º 1 ã€‚</li><li><code>RST</code>ï¼šè¯¥ä½ä¸º 1 æ—¶ï¼Œè¡¨ç¤º TCP è¿æ¥ä¸­å‡ºç°å¼‚å¸¸å¿…é¡»å¼ºåˆ¶æ–­å¼€è¿æ¥ã€‚</li><li><code>SYN</code>ï¼šè¯¥ä½ä¸º 1 æ—¶ï¼Œè¡¨ç¤ºå¸Œæœ›å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨å…¶ã€Œåºåˆ—å·ã€çš„å­—æ®µè¿›è¡Œåºåˆ—å·åˆå§‹å€¼çš„è®¾å®šã€‚</li><li><code>FIN</code>ï¼šè¯¥ä½ä¸º 1 æ—¶ï¼Œè¡¨ç¤ºä»Šåä¸ä¼šå†æœ‰æ•°æ®å‘é€ï¼Œå¸Œæœ›æ–­å¼€è¿æ¥ã€‚å½“é€šä¿¡ç»“æŸå¸Œæœ›æ–­å¼€è¿æ¥æ—¶ï¼Œé€šä¿¡åŒæ–¹çš„ä¸»æœºä¹‹é—´å°±å¯ä»¥ç›¸äº’äº¤æ¢ FIN ä½ä¸º 1 çš„ TCP æ®µã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆéœ€è¦-tcp-åè®®"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-tcp-åè®®"></a> ä¸ºä»€ä¹ˆéœ€è¦ TCP åè®®</h3><p>IP å±‚æ˜¯ã€Œä¸å¯é ã€çš„ï¼Œå®ƒä¸ä¿è¯ç½‘ç»œåŒ…çš„äº¤ä»˜ã€ä¸ä¿è¯ç½‘ç»œåŒ…çš„æŒ‰åºäº¤ä»˜ã€ä¹Ÿä¸ä¿è¯ç½‘ç»œåŒ…ä¸­çš„æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><p><strong>å¦‚æœéœ€è¦ä¿éšœç½‘ç»œæ•°æ®åŒ…çš„å¯é æ€§ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”±ä¸Šå±‚ï¼ˆä¼ è¾“å±‚ï¼‰çš„ <code>TCP</code> åè®®æ¥è´Ÿè´£ã€‚</strong><br />å› ä¸º <code>TCP</code> æ˜¯ä¸€ä¸ªå·¥ä½œåœ¨ä¼ è¾“å±‚çš„å¯é æ•°æ®ä¼ è¾“çš„æœåŠ¡ï¼Œå®ƒèƒ½ç¡®ä¿æ¥æ”¶ç«¯æ¥æ”¶çš„ç½‘ç»œåŒ…æ˜¯<strong>æ— æŸåã€æ— é—´éš”ã€éå†—ä½™å’ŒæŒ‰åº</strong>çš„ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-tcp"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-tcp"></a> ä»€ä¹ˆæ˜¯ TCP</h3><p><code>TCP</code> æ˜¯<code>é¢å‘è¿æ¥çš„</code>ã€<code>å¯é çš„</code>ã€<code>åŸºäºå­—èŠ‚æµçš„</code>ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚</p><ul><li><strong>é¢å‘è¿æ¥</strong>ï¼šä¸€å®šæ˜¯ã€Œ<strong>ä¸€å¯¹ä¸€</strong>ã€æ‰èƒ½è¿æ¥ï¼Œä¸èƒ½åƒ UDP åè®®å¯ä»¥ä¸€ä¸ªä¸»æœºåŒæ—¶å‘å¤šä¸ªä¸»æœºå‘é€æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯ä¸€å¯¹å¤šæ˜¯æ— æ³•åšåˆ°çš„ï¼›</li><li><strong>å¯é çš„</strong>ï¼šæ— è®ºçš„ç½‘ç»œé“¾è·¯ä¸­å‡ºç°äº†æ€æ ·çš„é“¾è·¯å˜åŒ–ï¼ŒTCP éƒ½å¯ä»¥ä¿è¯ä¸€ä¸ªæŠ¥æ–‡ä¸€å®šèƒ½å¤Ÿåˆ°è¾¾æ¥æ”¶ç«¯ï¼›</li><li><strong>å­—èŠ‚æµ</strong>ï¼šæ¶ˆæ¯æ˜¯ã€Œ<strong>æ²¡æœ‰è¾¹ç•Œ</strong>ã€çš„ï¼Œæ‰€ä»¥æ— è®ºæˆ‘ä»¬æ¶ˆæ¯æœ‰å¤šå¤§éƒ½å¯ä»¥è¿›è¡Œä¼ è¾“ã€‚å¹¶ä¸”æ¶ˆæ¯æ˜¯ã€Œ<strong>æœ‰åºçš„</strong>ã€ï¼Œå½“ã€Œå‰ä¸€ä¸ªã€æ¶ˆæ¯æ²¡æœ‰æ”¶åˆ°çš„æ—¶å€™ï¼Œå³ä½¿å®ƒå…ˆæ”¶åˆ°äº†åé¢çš„å­—èŠ‚ï¼Œé‚£ä¹ˆä¹Ÿä¸èƒ½æ‰”ç»™åº”ç”¨å±‚å»å¤„ç†ï¼ŒåŒæ—¶å¯¹ã€Œé‡å¤ã€çš„æŠ¥æ–‡ä¼šè‡ªåŠ¨ä¸¢å¼ƒã€‚</li></ul><h2 id="tcp-è¿æ¥"><a class="markdownIt-Anchor" href="#tcp-è¿æ¥"></a> TCP è¿æ¥</h2><h3 id="ä»€ä¹ˆæ˜¯-tcp-è¿æ¥"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-tcp-è¿æ¥"></a> ä»€ä¹ˆæ˜¯ TCP è¿æ¥</h3><blockquote><p>ç”¨äºä¿è¯å¯é æ€§å’Œæµé‡æ§åˆ¶ç»´æŠ¤çš„æŸäº›<strong>çŠ¶æ€ä¿¡æ¯</strong>ï¼Œè¿™äº›ä¿¡æ¯çš„ç»„åˆï¼ŒåŒ…æ‹¬ <code>Socket</code>ã€<code>åºåˆ—å·</code>å’Œ<code>çª—å£å¤§å°</code>ç§°ä¸ºè¿æ¥ã€‚</p></blockquote><ul><li><code>Socket</code>ï¼šç”± IP åœ°å€å’Œç«¯å£å·ç»„æˆ</li><li>åºåˆ—å·ï¼šç”¨æ¥è§£å†³ä¹±åºé—®é¢˜ç­‰</li><li>çª—å£å¤§å°ï¼šç”¨æ¥åšæµé‡æ§åˆ¶</li></ul><h3 id="å¦‚ä½•å”¯ä¸€ç¡®å®šä¸€ä¸ª-tcp-è¿æ¥"><a class="markdownIt-Anchor" href="#å¦‚ä½•å”¯ä¸€ç¡®å®šä¸€ä¸ª-tcp-è¿æ¥"></a> å¦‚ä½•å”¯ä¸€ç¡®å®šä¸€ä¸ª TCP è¿æ¥</h3><p>TCP å››å…ƒç»„å¯ä»¥å”¯ä¸€çš„ç¡®å®šä¸€ä¸ªè¿æ¥ï¼Œå››å…ƒç»„åŒ…æ‹¬å¦‚ä¸‹ï¼š</p><ol><li>æºåœ°å€</li><li>æºç«¯å£</li><li>ç›®çš„åœ°å€</li><li>ç›®çš„ç«¯å£</li></ol><ul><li>æºåœ°å€å’Œç›®çš„åœ°å€çš„å­—æ®µï¼ˆ32ä½ï¼‰æ˜¯åœ¨ <code>IP</code> å¤´éƒ¨ä¸­ï¼Œä½œç”¨æ˜¯é€šè¿‡ <code>IP</code> åè®®å‘é€æŠ¥æ–‡ç»™å¯¹æ–¹ä¸»æœºã€‚</li><li>æºç«¯å£å’Œç›®çš„ç«¯å£çš„å­—æ®µï¼ˆ16ä½ï¼‰æ˜¯åœ¨ <code>TCP</code> å¤´éƒ¨ä¸­ï¼Œä½œç”¨æ˜¯å‘Šè¯‰ <code>TCP</code> åè®®åº”è¯¥æŠŠæŠ¥æ–‡å‘ç»™å“ªä¸ªè¿›ç¨‹ã€‚</li></ul><h3 id="tcp-çš„æœ€å¤§è¿æ¥æ•°"><a class="markdownIt-Anchor" href="#tcp-çš„æœ€å¤§è¿æ¥æ•°"></a> TCP çš„æœ€å¤§è¿æ¥æ•°</h3><p>æœåŠ¡å™¨é€šå¸¸å›ºå®šåœ¨æŸä¸ªæœ¬åœ°ç«¯å£ä¸Šç›‘å¬ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯ IP å’Œ ç«¯å£æ˜¯å¯å˜çš„ï¼Œå…¶ç†è®ºå€¼è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><pre><code class="hljs routeros">TCP æœ€å¤§è¿æ¥æ•° = å®¢æˆ·ç«¯çš„<span class="hljs-built_in"> IP </span>æ•° * å®¢æˆ·ç«¯çš„ç«¯å£æ•°</code></pre><p>å¯¹ <code>IPv4</code>ï¼Œå®¢æˆ·ç«¯çš„ <code>IP æ•°</code>æœ€å¤šä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">2^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå®¢æˆ·ç«¯çš„ <code>ç«¯å£æ•°</code> æœ€å¤šä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">2^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å•æœºæœ€å¤§ TCP è¿æ¥æ•°ï¼Œçº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>48</mn></msup></mrow><annotation encoding="application/x-tex">2^{48}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>å½“ç„¶ï¼ŒæœåŠ¡ç«¯æœ€å¤§å¹¶å‘ TCP è¿æ¥æ•°è¿œä¸èƒ½è¾¾åˆ°ç†è®ºä¸Šé™ã€‚</p><ul><li>é¦–å…ˆä¸»è¦æ˜¯<strong>æ–‡ä»¶æè¿°ç¬¦é™åˆ¶</strong>ï¼ŒSocket éƒ½æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥é¦–å…ˆè¦é€šè¿‡ ulimit é…ç½®æ–‡ä»¶æè¿°ç¬¦çš„æ•°ç›®ï¼›</li><li>å¦ä¸€ä¸ªæ˜¯<strong>å†…å­˜é™åˆ¶</strong>ï¼Œæ¯ä¸ª TCP è¿æ¥éƒ½è¦å ç”¨ä¸€å®šå†…å­˜ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æ˜¯æœ‰é™çš„ã€‚</li></ul><h2 id="tcp-å’Œ-udp"><a class="markdownIt-Anchor" href="#tcp-å’Œ-udp"></a> TCP å’Œ UDP</h2><h3 id="udp-å’Œ-tcp-çš„åŒºåˆ«-åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#udp-å’Œ-tcp-çš„åŒºåˆ«-åº”ç”¨åœºæ™¯"></a> UDP å’Œ TCP çš„åŒºåˆ«ã€åº”ç”¨åœºæ™¯</h3><p>UDP ä¸æä¾›å¤æ‚çš„æ§åˆ¶æœºåˆ¶ï¼Œåˆ©ç”¨ IP æä¾›é¢å‘ã€Œæ— è¿æ¥ã€çš„é€šä¿¡æœåŠ¡ã€‚<br />UDP åè®®å¤´éƒ¨åªæœ‰ <code>8</code> ä¸ªå­—èŠ‚ï¼ŒUDP çš„å¤´éƒ¨æ ¼å¼å¦‚ä¸‹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028144852.png" srcset="/img/loading.gif" alt="" /></p><ul><li><strong>ç›®æ ‡å’Œæºç«¯å£</strong>ï¼šä¸»è¦æ˜¯å‘Šè¯‰ UDP åè®®åº”è¯¥æŠŠæŠ¥æ–‡å‘ç»™å“ªä¸ªè¿›ç¨‹ã€‚</li><li><strong>åŒ…é•¿åº¦</strong>ï¼šè¯¥å­—æ®µä¿å­˜äº† UDP é¦–éƒ¨çš„é•¿åº¦è·Ÿæ•°æ®çš„é•¿åº¦ä¹‹å’Œã€‚</li><li><strong>æ ¡éªŒå’Œ</strong>ï¼šæ ¡éªŒå’Œæ˜¯ä¸ºäº†æä¾›å¯é çš„ UDP é¦–éƒ¨å’Œæ•°æ®è€Œè®¾è®¡ã€‚</li></ul><p>TCP å’Œ UDP åŒºåˆ«ï¼š</p><ol><li>è¿æ¥</li></ol><p>TCP æ˜¯é¢å‘è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼Œä¼ è¾“æ•°æ®å‰å…ˆè¦å»ºç«‹è¿æ¥ã€‚<br />UDP æ˜¯ä¸éœ€è¦è¿æ¥ï¼Œå³åˆ»ä¼ è¾“æ•°æ®ã€‚<br />2. æœåŠ¡å¯¹è±¡</p><p>TCP æ˜¯ä¸€å¯¹ä¸€çš„ä¸¤ç‚¹æœåŠ¡ï¼Œå³<strong>ä¸€æ¡è¿æ¥åªæœ‰ä¸¤ä¸ªç«¯ç‚¹</strong>ã€‚<br />UDP æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡<br />3. å¯é æ€§</p><p>TCP æ˜¯å¯é äº¤ä»˜æ•°æ®çš„ï¼Œæ•°æ®å¯ä»¥æ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æŒ‰éœ€åˆ°è¾¾ã€‚<br />UDP æ˜¯å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œä¸ä¿è¯å¯é äº¤ä»˜æ•°æ®ã€‚<br />4. æ‹¥å¡æ§åˆ¶ã€æµé‡æ§åˆ¶</p><p>TCP æœ‰<strong>æ‹¥å¡æ§åˆ¶</strong>å’Œ<strong>æµé‡æ§åˆ¶</strong>æœºåˆ¶ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚<br />UDP åˆ™æ²¡æœ‰ï¼Œå³ä½¿ç½‘ç»œéå¸¸æ‹¥å µäº†ï¼Œä¹Ÿä¸ä¼šå½±å“ UDP çš„å‘é€é€Ÿç‡ã€‚<br />5. é¦–éƒ¨å¼€é”€</p><p>TCP é¦–éƒ¨é•¿åº¦è¾ƒé•¿ï¼Œä¼šæœ‰ä¸€å®šçš„å¼€é”€ï¼Œé¦–éƒ¨åœ¨æ²¡æœ‰ä½¿ç”¨ã€Œé€‰é¡¹ã€å­—æ®µæ—¶æ˜¯ 20 ä¸ªå­—èŠ‚ï¼Œå¦‚æœä½¿ç”¨äº†ã€Œé€‰é¡¹ã€å­—æ®µåˆ™ä¼šå˜é•¿çš„ã€‚<br />UDP é¦–éƒ¨åªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”æ˜¯å›ºå®šä¸å˜çš„ï¼Œå¼€é”€è¾ƒå°ã€‚<br />6. ä¼ è¾“æ–¹å¼</p><p>TCP æ˜¯<strong>æµå¼ä¼ è¾“ï¼Œæ²¡æœ‰è¾¹ç•Œï¼Œä½†ä¿è¯é¡ºåºå’Œå¯é </strong>ã€‚<br />UDP æ˜¯ä¸€ä¸ªåŒ…ä¸€ä¸ªåŒ…çš„å‘é€ï¼Œæ˜¯æœ‰è¾¹ç•Œçš„ï¼Œä½†å¯èƒ½ä¼šä¸¢åŒ…å’Œä¹±åºã€‚<br />7. åˆ†ç‰‡ä¸åŒ</p><p>TCP çš„æ•°æ®å¤§å°å¦‚æœå¤§äº <code>MSS</code> å¤§å°ï¼Œåˆ™ä¼šåœ¨ <code>ä¼ è¾“å±‚</code> è¿›è¡Œåˆ†ç‰‡ï¼Œç›®æ ‡ä¸»æœºæ”¶åˆ°åï¼Œä¹ŸåŒæ ·åœ¨ä¼ è¾“å±‚ç»„è£… TCP æ•°æ®åŒ…ï¼Œå¦‚æœä¸­é€”ä¸¢å¤±äº†ä¸€ä¸ªåˆ†ç‰‡ï¼Œåªéœ€è¦ä¼ è¾“ä¸¢å¤±çš„è¿™ä¸ªåˆ†ç‰‡ã€‚<br />UDP çš„æ•°æ®å¤§å°å¦‚æœå¤§äº <code>MTU</code> å¤§å°ï¼Œåˆ™ä¼šåœ¨ <code>IP å±‚</code> è¿›è¡Œåˆ†ç‰‡ï¼Œç›®æ ‡ä¸»æœºæ”¶åˆ°åï¼Œåœ¨ IP å±‚ç»„è£…å®Œæ•°æ®ï¼Œæ¥ç€å†ä¼ ç»™ä¼ è¾“å±‚ï¼Œä½†æ˜¯å¦‚æœä¸­é€”ä¸¢äº†ä¸€ä¸ªåˆ†ç‰‡ï¼Œåˆ™å°±éœ€è¦é‡ä¼ æ‰€æœ‰çš„æ•°æ®åŒ…ï¼Œè¿™æ ·ä¼ è¾“æ•ˆç‡éå¸¸å·®ï¼Œæ‰€ä»¥<strong>é€šå¸¸ <code>UDP</code> çš„æŠ¥æ–‡åº”è¯¥å°äº <code>MTU</code></strong>ã€‚</p><p>TCP å’Œ UDP åº”ç”¨åœºæ™¯ï¼š<br />ç”±äº TCP æ˜¯é¢å‘è¿æ¥ï¼Œèƒ½ä¿è¯æ•°æ®çš„å¯é æ€§äº¤ä»˜ï¼Œå› æ­¤ç»å¸¸ç”¨äºï¼š</p><ul><li><code>FTP</code> æ–‡ä»¶ä¼ è¾“</li><li><code>HTTP</code> / <code>HTTPS</code></li></ul><p>ç”±äº UDP é¢å‘æ— è¿æ¥ï¼Œå®ƒå¯ä»¥éšæ—¶å‘é€æ•°æ®ï¼Œå†åŠ ä¸ŠUDPæœ¬èº«çš„å¤„ç†æ—¢ç®€å•åˆé«˜æ•ˆï¼Œå› æ­¤ç»å¸¸ç”¨äºï¼š</p><ul><li>åŒ…æ€»é‡è¾ƒå°‘çš„é€šä¿¡ï¼Œå¦‚ <code>DNS</code> ã€<code>SNMP</code> ç­‰</li><li>è§†é¢‘ã€éŸ³é¢‘ç­‰å¤šåª’ä½“é€šä¿¡</li><li>å¹¿æ’­é€šä¿¡</li></ul><h3 id="ä¸ºä»€ä¹ˆ-udp-å¤´éƒ¨æ²¡æœ‰é¦–éƒ¨é•¿åº¦å­—æ®µ"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆ-udp-å¤´éƒ¨æ²¡æœ‰é¦–éƒ¨é•¿åº¦å­—æ®µ"></a> ä¸ºä»€ä¹ˆ UDP å¤´éƒ¨æ²¡æœ‰ã€Œé¦–éƒ¨é•¿åº¦ã€å­—æ®µ</h3><p>åŸå› æ˜¯ <code>TCP</code> æœ‰<strong>å¯å˜é•¿</strong>çš„ã€Œ<code>é€‰é¡¹</code>ã€å­—æ®µï¼Œè€Œ <code>UDP</code> <strong>å¤´éƒ¨é•¿åº¦åˆ™æ˜¯ä¸ä¼šå˜åŒ–</strong>çš„ï¼Œæ— éœ€å¤šä¸€ä¸ªå­—æ®µå»è®°å½• <code>UDP</code> çš„é¦–éƒ¨é•¿åº¦ã€‚</p><h3 id="ä¸ºä»€ä¹ˆ-udp-å¤´éƒ¨æœ‰åŒ…é•¿åº¦å­—æ®µ"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆ-udp-å¤´éƒ¨æœ‰åŒ…é•¿åº¦å­—æ®µ"></a> ä¸ºä»€ä¹ˆ UDP å¤´éƒ¨æœ‰ã€ŒåŒ…é•¿åº¦ã€å­—æ®µ</h3><blockquote><p>TCP æ•°æ®é•¿åº¦ = <code>IP</code> æ€»é•¿åº¦ - <code>IP</code> é¦–éƒ¨é•¿åº¦ - <code>TCP</code> é¦–éƒ¨é•¿åº¦</p></blockquote><p>å…¶ä¸­ IP æ€»é•¿åº¦ å’Œ IP é¦–éƒ¨é•¿åº¦ï¼Œåœ¨ IP é¦–éƒ¨æ ¼å¼æ˜¯å·²çŸ¥çš„ã€‚TCP é¦–éƒ¨é•¿åº¦ï¼Œåˆ™æ˜¯åœ¨ TCP é¦–éƒ¨æ ¼å¼å·²çŸ¥çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥æ±‚å¾— TCP æ•°æ®çš„é•¿åº¦ã€‚</p><p><strong>ä¸ºäº†ç½‘ç»œè®¾å¤‡ç¡¬ä»¶è®¾è®¡å’Œå¤„ç†æ–¹ä¾¿ï¼Œé¦–éƒ¨é•¿åº¦éœ€è¦æ˜¯ <code>4å­—èŠ‚</code> çš„æ•´æ•°å€ã€‚</strong><br />å¦‚æœå»æ‰ UDP ã€ŒåŒ…é•¿åº¦ã€å­—æ®µï¼Œé‚£ UDP é¦–éƒ¨é•¿åº¦å°±ä¸æ˜¯ 4 å­—èŠ‚çš„æ•´æ•°å€äº†ï¼Œæ‰€ä»¥è¿™å¯èƒ½æ˜¯ä¸ºäº†è¡¥å…¨ UDP é¦–éƒ¨é•¿åº¦æ˜¯ 4 å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ‰è¡¥å……äº†ã€ŒåŒ…é•¿åº¦ã€å­—æ®µã€‚</p><h1 id="tcp-è¿æ¥å»ºç«‹"><a class="markdownIt-Anchor" href="#tcp-è¿æ¥å»ºç«‹"></a> TCP è¿æ¥å»ºç«‹</h1><h2 id="tcp-ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿"><a class="markdownIt-Anchor" href="#tcp-ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿"></a> TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿</h2><p>TCP æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œæ‰€ä»¥ä½¿ç”¨ TCP å‰å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œè€Œå»ºç«‹è¿æ¥æ˜¯é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æ¥è¿›è¡Œçš„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028155915.png" srcset="/img/loading.gif" alt="" /></p><ul><li>ä¸€å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº <code>CLOSED</code> çŠ¶æ€ã€‚å…ˆæ˜¯æœåŠ¡ç«¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº <code>LISTEN</code> çŠ¶æ€ã€‚</li><li>å®¢æˆ·ç«¯ä¼šéšæœºåˆå§‹åŒ–åºå·ï¼ˆ<code>client_isn</code>ï¼‰ï¼Œå°†æ­¤åºå·ç½®äº TCP é¦–éƒ¨çš„ã€Œåºå·ã€å­—æ®µä¸­ï¼ŒåŒæ—¶æŠŠ <code>SYN</code> æ ‡å¿—ä½ç½®ä¸º 1 ï¼Œè¡¨ç¤º SYN æŠ¥æ–‡ã€‚æ¥ç€æŠŠç¬¬ä¸€ä¸ª SYN æŠ¥æ–‡å‘é€ç»™æœåŠ¡ç«¯ï¼Œè¡¨ç¤ºå‘æœåŠ¡ç«¯å‘èµ·è¿æ¥ï¼Œè¯¥æŠ¥æ–‡ä¸åŒ…å«åº”ç”¨å±‚æ•°æ®ï¼Œä¹‹åå®¢æˆ·ç«¯å¤„äº <code>SYN-SENT</code> çŠ¶æ€ã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡åï¼Œé¦–å…ˆæœåŠ¡ç«¯ä¹Ÿéšæœºåˆå§‹åŒ–è‡ªå·±çš„åºå·ï¼ˆ<code>server_isn</code>ï¼‰ï¼Œå°†æ­¤åºå·å¡«å…¥ TCP é¦–éƒ¨çš„ã€Œåºå·ã€å­—æ®µä¸­ï¼Œå…¶æ¬¡æŠŠ TCP é¦–éƒ¨çš„ã€Œç¡®è®¤åº”ç­”å·ã€å­—æ®µå¡«å…¥ <code>client_isn + 1</code>, æ¥ç€æŠŠ <code>SYN</code> å’Œ <code>ACK</code> æ ‡å¿—ä½ç½®ä¸º 1ã€‚æœ€åæŠŠè¯¥æŠ¥æ–‡å‘ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æŠ¥æ–‡ä¹Ÿä¸åŒ…å«åº”ç”¨å±‚æ•°æ®ï¼Œä¹‹åæœåŠ¡ç«¯å¤„äº <code>SYN-RCVD</code> çŠ¶æ€ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯æŠ¥æ–‡åï¼Œè¿˜è¦å‘æœåŠ¡ç«¯å›åº”æœ€åä¸€ä¸ªåº”ç­”æŠ¥æ–‡ï¼Œé¦–å…ˆè¯¥åº”ç­”æŠ¥æ–‡ TCP é¦–éƒ¨ <code>ACK</code> æ ‡å¿—ä½ç½®ä¸º 1 ï¼Œå…¶æ¬¡ã€Œç¡®è®¤åº”ç­”å·ã€å­—æ®µå¡«å…¥ <code>server_isn + 1</code> ï¼Œæœ€åæŠŠæŠ¥æ–‡å‘é€ç»™æœåŠ¡ç«¯ï¼Œ<strong>è¿™æ¬¡æŠ¥æ–‡å¯ä»¥æºå¸¦å®¢æˆ·åˆ°æœåŠ¡å™¨çš„æ•°æ®</strong>ï¼Œä¹‹åå®¢æˆ·ç«¯å¤„äº <code>ESTABLISHED</code> çŠ¶æ€ã€‚</li></ul><blockquote><p>å¯ä»¥å‘ç°ç¬¬ä¸‰æ¬¡æ¡æ‰‹æ˜¯å¯ä»¥æºå¸¦æ•°æ®çš„ï¼Œå‰ä¸¤æ¬¡æ¡æ‰‹æ˜¯ä¸å¯ä»¥æºå¸¦æ•°æ®çš„ã€‚</p></blockquote><p>ä¸€æ—¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼ŒåŒæ–¹éƒ½å¤„äº <code>ESTABLISHED</code> çŠ¶æ€ï¼Œæ­¤æ—¶è¿æ¥å°±å·²å»ºç«‹å®Œæˆï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°±å¯ä»¥ç›¸äº’å‘é€æ•°æ®äº†ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹"></a> ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹</h2><p>ä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½ä¿è¯åŒæ–¹å…·æœ‰æ¥æ”¶å’Œå‘é€çš„èƒ½åŠ›ï¼Œå¯ä»¥åˆå§‹åŒ– <code>Socket</code>ã€<code>åºåˆ—å·</code>å’Œ<code>çª—å£å¤§å°</code>å¹¶å»ºç«‹ TCP è¿æ¥ã€‚</p><p>åŸå› ï¼š</p><ol><li>ä¸‰æ¬¡æ¡æ‰‹æ‰å¯ä»¥é˜»æ­¢é‡å¤å†å²è¿æ¥çš„åˆå§‹åŒ–ï¼ˆä¸»è¦åŸå› ï¼‰</li><li>ä¸‰æ¬¡æ¡æ‰‹æ‰å¯ä»¥åŒæ­¥åŒæ–¹çš„åˆå§‹åºåˆ—å·</li><li>ä¸‰æ¬¡æ¡æ‰‹æ‰å¯ä»¥é¿å…èµ„æºæµªè´¹</li></ol><h3 id="é¿å…å†å²è¿æ¥"><a class="markdownIt-Anchor" href="#é¿å…å†å²è¿æ¥"></a> é¿å…å†å²è¿æ¥</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028161453.png" srcset="/img/loading.gif" alt="" /></p><p><strong>å®¢æˆ·ç«¯è¿ç»­å‘é€å¤šæ¬¡ SYN å»ºç«‹è¿æ¥çš„æŠ¥æ–‡</strong>ï¼Œåœ¨ç½‘ç»œæ‹¥å µæƒ…å†µä¸‹ï¼š</p><ul><li>ä¸€ä¸ªã€Œ<strong>æ—§ SYN æŠ¥æ–‡</strong>ã€æ¯”ã€Œ<strong>æœ€æ–°çš„ SYN</strong>ã€ æŠ¥æ–‡æ—©åˆ°è¾¾äº†æœåŠ¡ç«¯ï¼›</li><li>é‚£ä¹ˆæ­¤æ—¶æœåŠ¡ç«¯å°±ä¼šå›ä¸€ä¸ª <code>SYN + ACK</code> æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼›</li><li>å®¢æˆ·ç«¯æ”¶åˆ°åå¯ä»¥æ ¹æ®è‡ªèº«çš„ä¸Šä¸‹æ–‡ï¼Œåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ª<strong>å†å²è¿æ¥</strong>ï¼ˆåºåˆ—å·è¿‡æœŸæˆ–è¶…æ—¶ï¼‰ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±ä¼šå‘é€ RST æŠ¥æ–‡ç»™æœåŠ¡ç«¯ï¼Œè¡¨ç¤ºä¸­æ­¢è¿™ä¸€æ¬¡è¿æ¥ã€‚</li></ul><p>å¦‚æœæ˜¯ä¸¤æ¬¡æ¡æ‰‹è¿æ¥ï¼Œå°±ä¸èƒ½åˆ¤æ–­å½“å‰è¿æ¥æ˜¯å¦æ˜¯å†å²è¿æ¥ï¼Œä¸‰æ¬¡æ¡æ‰‹åˆ™å¯ä»¥åœ¨å®¢æˆ·ç«¯ï¼ˆå‘é€æ–¹ï¼‰å‡†å¤‡å‘é€ç¬¬ä¸‰æ¬¡æŠ¥æ–‡æ—¶ï¼Œå®¢æˆ·ç«¯å› æœ‰è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡æ¥åˆ¤æ–­å½“å‰è¿æ¥æ˜¯å¦æ˜¯å†å²è¿æ¥ï¼š</p><p>å¦‚æœæ˜¯å†å²è¿æ¥ï¼ˆåºåˆ—å·è¿‡æœŸæˆ–è¶…æ—¶ï¼‰ï¼Œåˆ™ç¬¬ä¸‰æ¬¡æ¡æ‰‹å‘é€çš„æŠ¥æ–‡æ˜¯ RST æŠ¥æ–‡ï¼Œä»¥æ­¤ä¸­æ­¢å†å²è¿æ¥ï¼›<br />å¦‚æœä¸æ˜¯å†å²è¿æ¥ï¼Œåˆ™ç¬¬ä¸‰æ¬¡å‘é€çš„æŠ¥æ–‡æ˜¯ ACK æŠ¥æ–‡ï¼Œé€šä¿¡åŒæ–¹å°±ä¼šæˆåŠŸå»ºç«‹è¿æ¥ï¼›<br />æ‰€ä»¥ï¼ŒTCP ä½¿ç”¨ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥çš„æœ€ä¸»è¦åŸå› æ˜¯<strong>é˜²æ­¢å†å²è¿æ¥åˆå§‹åŒ–äº†è¿æ¥</strong>ã€‚</p><h3 id="åŒæ­¥åŒæ–¹åˆå§‹åºåˆ—å·"><a class="markdownIt-Anchor" href="#åŒæ­¥åŒæ–¹åˆå§‹åºåˆ—å·"></a> åŒæ­¥åŒæ–¹åˆå§‹åºåˆ—å·</h3><p>TCP åè®®çš„é€šä¿¡åŒæ–¹ï¼Œ éƒ½å¿…é¡»ç»´æŠ¤ä¸€ä¸ªã€Œåºåˆ—å·ã€ï¼Œ åºåˆ—å·æ˜¯å¯é ä¼ è¾“çš„ä¸€ä¸ªå…³é”®å› ç´ ï¼Œå®ƒçš„ä½œç”¨ï¼š</p><ul><li>æ¥æ”¶æ–¹å¯ä»¥å»é™¤é‡å¤çš„æ•°æ®ï¼›</li><li>æ¥æ”¶æ–¹å¯ä»¥æ ¹æ®æ•°æ®åŒ…çš„åºåˆ—å·æŒ‰åºæ¥æ”¶ï¼›</li><li>å¯ä»¥æ ‡è¯†å‘é€å‡ºå»çš„æ•°æ®åŒ…ä¸­ï¼Œ å“ªäº›æ˜¯å·²ç»è¢«å¯¹æ–¹æ”¶åˆ°çš„ï¼›</li></ul><p>å¯è§ï¼Œåºåˆ—å·åœ¨ TCP è¿æ¥ä¸­å æ®ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œæ‰€ä»¥å½“å®¢æˆ·ç«¯å‘é€æºå¸¦ã€Œåˆå§‹åºåˆ—å·ã€çš„ <code>SYN</code> æŠ¥æ–‡çš„æ—¶å€™ï¼Œéœ€è¦æœåŠ¡ç«¯å›ä¸€ä¸ª <code>ACK</code> åº”ç­”æŠ¥æ–‡ï¼Œ<strong>è¡¨ç¤ºå®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡å·²è¢«æœåŠ¡ç«¯æˆåŠŸæ¥æ”¶</strong>ï¼Œé‚£å½“æœåŠ¡ç«¯å‘é€ã€Œåˆå§‹åºåˆ—å·ã€ç»™å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œä¾ç„¶ä¹Ÿè¦å¾—åˆ°å®¢æˆ·ç«¯çš„åº”ç­”å›åº”ï¼Œè¿™æ ·ä¸€æ¥ä¸€å›ï¼Œæ‰èƒ½<strong>ç¡®ä¿åŒæ–¹çš„åˆå§‹åºåˆ—å·èƒ½è¢«å¯é çš„åŒæ­¥</strong>ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028162521.png" srcset="/img/loading.gif" alt="" /></p><p>å››æ¬¡æ¡æ‰‹å…¶å®ä¹Ÿèƒ½å¤Ÿå¯é çš„åŒæ­¥åŒæ–¹çš„åˆå§‹åŒ–åºå·ï¼Œä½†<strong>ç”±äºç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥å¯ä»¥ä¼˜åŒ–æˆä¸€æ­¥ï¼Œæ‰€ä»¥å°±æˆäº†ã€Œä¸‰æ¬¡æ¡æ‰‹ã€ã€‚</strong></p><p><strong>ä¸¤æ¬¡æ¡æ‰‹åªä¿è¯äº†ä¸€æ–¹çš„åˆå§‹åºåˆ—å·èƒ½è¢«å¯¹æ–¹æˆåŠŸæ¥æ”¶ï¼Œæ²¡åŠæ³•ä¿è¯åŒæ–¹çš„åˆå§‹åºåˆ—å·éƒ½èƒ½è¢«ç¡®è®¤æ¥æ”¶ã€‚</strong></p><h3 id="é¿å…èµ„æºæµªè´¹"><a class="markdownIt-Anchor" href="#é¿å…èµ„æºæµªè´¹"></a> é¿å…èµ„æºæµªè´¹</h3><p>å¦‚æœåªæœ‰ã€Œä¸¤æ¬¡æ¡æ‰‹ã€ï¼Œå½“å®¢æˆ·ç«¯çš„ SYN è¯·æ±‚è¿æ¥åœ¨ç½‘ç»œä¸­é˜»å¡ï¼Œå®¢æˆ·ç«¯æ²¡æœ‰æ¥æ”¶åˆ° ACK æŠ¥æ–‡ï¼Œå°±ä¼šé‡æ–°å‘é€ SYN ï¼Œç”±äºæ²¡æœ‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨ä¸æ¸…æ¥šå®¢æˆ·ç«¯æ˜¯å¦æ”¶åˆ°äº†è‡ªå·±å‘é€çš„å»ºç«‹è¿æ¥çš„ ACK ç¡®è®¤ä¿¡å·ï¼Œæ‰€ä»¥æ¯æ”¶åˆ°ä¸€ä¸ª SYN å°±åªèƒ½å…ˆä¸»åŠ¨å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™ä¼šé€ æˆä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p><p>å¦‚æœå®¢æˆ·ç«¯çš„ <code>SYN</code> é˜»å¡äº†ï¼Œé‡å¤å‘é€å¤šæ¬¡ <code>SYN</code> æŠ¥æ–‡ï¼Œé‚£ä¹ˆ<strong>æœåŠ¡å™¨åœ¨æ”¶åˆ°è¯·æ±‚åå°±ä¼šå»ºç«‹å¤šä¸ªå†—ä½™çš„æ— æ•ˆé“¾æ¥ï¼Œé€ æˆä¸å¿…è¦çš„èµ„æºæµªè´¹ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028162315.jpeg" srcset="/img/loading.gif" alt="" /></p><p>å³ä¸¤æ¬¡æ¡æ‰‹ä¼šé€ æˆæ¶ˆæ¯æ»ç•™æƒ…å†µä¸‹ï¼Œ<strong>æœåŠ¡å™¨é‡å¤æ¥å—æ— ç”¨çš„è¿æ¥è¯·æ±‚ <code>SYN</code> æŠ¥æ–‡ï¼Œè€Œé€ æˆé‡å¤åˆ†é…èµ„æºã€‚</strong></p><h3 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h3><p>TCP å»ºç«‹è¿æ¥æ—¶ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹èƒ½é˜²æ­¢å†å²è¿æ¥çš„å»ºç«‹ï¼Œèƒ½å‡å°‘åŒæ–¹ä¸å¿…è¦çš„èµ„æºå¼€é”€ï¼Œèƒ½å¸®åŠ©åŒæ–¹åŒæ­¥åˆå§‹åŒ–åºåˆ—å·ã€‚åºåˆ—å·èƒ½å¤Ÿä¿è¯æ•°æ®åŒ…ä¸é‡å¤ã€ä¸ä¸¢å¼ƒå’ŒæŒ‰åºä¼ è¾“ã€‚</p><p>ä¸ä½¿ç”¨ã€Œä¸¤æ¬¡æ¡æ‰‹ã€å’Œã€Œå››æ¬¡æ¡æ‰‹ã€çš„åŸå› ï¼š</p><ul><li>ã€Œä¸¤æ¬¡æ¡æ‰‹ã€ï¼šæ— æ³•é˜²æ­¢å†å²è¿æ¥çš„å»ºç«‹ï¼Œä¼šé€ æˆåŒæ–¹èµ„æºçš„æµªè´¹ï¼Œä¹Ÿæ— æ³•å¯é çš„åŒæ­¥åŒæ–¹åºåˆ—å·ï¼›</li><li>ã€Œå››æ¬¡æ¡æ‰‹ã€ï¼šä¸‰æ¬¡æ¡æ‰‹å°±å·²ç»ç†è®ºä¸Šæœ€å°‘å¯é è¿æ¥å»ºç«‹ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨æ›´å¤šçš„é€šä¿¡æ¬¡æ•°ã€‚</li></ul><h2 id="ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åˆå§‹åºåˆ—å·-isn-æ˜¯ä¸ç›¸åŒçš„"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åˆå§‹åºåˆ—å·-isn-æ˜¯ä¸ç›¸åŒçš„"></a> ä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„åˆå§‹åºåˆ—å· ISN æ˜¯ä¸ç›¸åŒçš„</h2><p>å¦‚æœä¸€ä¸ªå·²ç»å¤±æ•ˆçš„è¿æ¥è¢«é‡ç”¨äº†ï¼Œä½†æ˜¯è¯¥æ—§è¿æ¥çš„å†å²æŠ¥æ–‡è¿˜æ®‹ç•™åœ¨ç½‘ç»œä¸­ï¼Œå¦‚æœåºåˆ—å·ç›¸åŒï¼Œé‚£ä¹ˆå°±æ— æ³•åˆ†è¾¨å‡ºè¯¥æŠ¥æ–‡æ˜¯ä¸æ˜¯å†å²æŠ¥æ–‡ï¼Œå¦‚æœå†å²æŠ¥æ–‡è¢«æ–°çš„è¿æ¥æ¥æ”¶äº†ï¼Œåˆ™ä¼šäº§ç”Ÿæ•°æ®é”™ä¹±ã€‚</p><p>æ‰€ä»¥ï¼Œæ¯æ¬¡å»ºç«‹è¿æ¥å‰é‡æ–°åˆå§‹åŒ–ä¸€ä¸ªåºåˆ—å·ä¸»è¦æ˜¯ä¸ºäº†<strong>é€šä¿¡åŒæ–¹èƒ½å¤Ÿæ ¹æ®åºå·å°†ä¸å±äºæœ¬è¿æ¥çš„æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚</strong></p><p>å¦ä¸€æ–¹é¢æ˜¯ä¸ºäº†<strong>å®‰å…¨æ€§</strong>ï¼Œé˜²æ­¢é»‘å®¢ä¼ªé€ çš„ç›¸åŒåºåˆ—å·çš„ TCP æŠ¥æ–‡è¢«å¯¹æ–¹æ¥æ”¶ã€‚</p><h2 id="æ—¢ç„¶-ip-å±‚ä¼šåˆ†ç‰‡ä¸ºä»€ä¹ˆ-tcp-å±‚è¿˜éœ€è¦-mss"><a class="markdownIt-Anchor" href="#æ—¢ç„¶-ip-å±‚ä¼šåˆ†ç‰‡ä¸ºä»€ä¹ˆ-tcp-å±‚è¿˜éœ€è¦-mss"></a> æ—¢ç„¶ IP å±‚ä¼šåˆ†ç‰‡ï¼Œä¸ºä»€ä¹ˆ TCP å±‚è¿˜éœ€è¦ MSS</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023155957.png" srcset="/img/loading.gif" alt="" /></p><blockquote><p><code>MTU</code>ï¼šä¸€ä¸ªç½‘ç»œåŒ…çš„æœ€å¤§é•¿åº¦ï¼Œä»¥å¤ªç½‘ä¸­ä¸€èˆ¬ä¸º <code>1500</code> å­—èŠ‚ã€‚<br /><code>MSS</code>ï¼šé™¤å» <code>IP</code> å’Œ <code>TCP</code> å¤´éƒ¨ä¹‹åï¼Œä¸€ä¸ªç½‘ç»œåŒ…æ‰€èƒ½å®¹çº³çš„ <code>TCP</code> æ•°æ®çš„æœ€å¤§é•¿åº¦ã€‚</p></blockquote><p>å¦‚æœåœ¨ TCP çš„æ•´ä¸ªæŠ¥æ–‡ï¼ˆå¤´éƒ¨ + æ•°æ®ï¼‰äº¤ç»™ IP å±‚è¿›è¡Œåˆ†ç‰‡ï¼Œä¼šæœ‰ä»€ä¹ˆå¼‚å¸¸å‘¢ï¼Ÿ</p><p>å½“ IP å±‚æœ‰ä¸€ä¸ªè¶…è¿‡ MTU å¤§å°çš„æ•°æ®ï¼ˆTCP å¤´éƒ¨ + TCP æ•°æ®ï¼‰è¦å‘é€ï¼Œé‚£ä¹ˆ <strong>IP å±‚å°±è¦è¿›è¡Œåˆ†ç‰‡</strong>ï¼ŒæŠŠæ•°æ®åˆ†ç‰‡æˆè‹¥å¹²ç‰‡ï¼Œä¿è¯æ¯ä¸€ä¸ªåˆ†ç‰‡éƒ½å°äº MTUã€‚æŠŠä¸€ä»½ IP æ•°æ®æŠ¥è¿›è¡Œåˆ†ç‰‡ä»¥åï¼Œç”±ç›®æ ‡ä¸»æœºçš„ <strong>IP å±‚æ¥è¿›è¡Œé‡æ–°ç»„è£…</strong>åï¼Œå†äº¤ç»™ä¸Šä¸€å±‚ TCP ä¼ è¾“å±‚ã€‚</p><p>è¿™çœ‹èµ·æ¥äº•ç„¶æœ‰åºï¼Œä½†è¿™å­˜åœ¨éšæ‚£çš„ï¼Œé‚£ä¹ˆ<strong>å¦‚æœä¸€ä¸ª IP åˆ†ç‰‡ä¸¢å¤±ï¼Œæ•´ä¸ª IP æŠ¥æ–‡çš„æ‰€æœ‰åˆ†ç‰‡éƒ½å¾—é‡ä¼ ã€‚</strong><br />å› ä¸º IP å±‚æœ¬èº«æ²¡æœ‰è¶…æ—¶é‡ä¼ æœºåˆ¶ï¼Œå®ƒç”±ä¼ è¾“å±‚çš„ TCP æ¥è´Ÿè´£è¶…æ—¶å’Œé‡ä¼ ã€‚<br />å› ä¸ºæ˜¯åœ¨æ¥æ”¶æ–¹çš„ IP å±‚è¿›è¡Œåˆ†ç‰‡é‡ç»„ï¼Œå½“æ¥æ”¶æ–¹å‘ç° TCP æŠ¥æ–‡ï¼ˆå¤´éƒ¨ + æ•°æ®ï¼‰çš„æŸä¸€ç‰‡ä¸¢å¤±åï¼Œåˆ™ä¸ä¼šå“åº” ACK ç»™å¯¹æ–¹ï¼Œé‚£ä¹ˆå‘é€æ–¹çš„ TCP åœ¨è¶…æ—¶åï¼Œå°±ä¼šé‡å‘ã€Œæ•´ä¸ª TCP æŠ¥æ–‡ï¼ˆå¤´éƒ¨ + æ•°æ®ï¼‰ã€ã€‚<br />å› æ­¤ï¼Œå¯ä»¥å¾—çŸ¥ç”± IP å±‚è¿›è¡Œåˆ†ç‰‡ä¼ è¾“ï¼Œæ˜¯éå¸¸æ²¡æœ‰æ•ˆç‡çš„ã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>ä¸ºäº†è¾¾åˆ°æœ€ä½³çš„ä¼ è¾“æ•ˆèƒ½ TCP åè®®åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™é€šå¸¸è¦åå•†åŒæ–¹çš„ MSS å€¼</strong>ï¼Œå½“ TCP å±‚å‘ç°æ•°æ®è¶…è¿‡ MSS æ—¶ï¼Œåˆ™å°±å…ˆä¼šè¿›è¡Œåˆ†ç‰‡ï¼Œå½“ç„¶ç”±å®ƒå½¢æˆçš„ IP åŒ…çš„é•¿åº¦ä¹Ÿå°±ä¸ä¼šå¤§äº MTU ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ç”¨ IP åˆ†ç‰‡äº†ã€‚<br />ç»è¿‡ TCP å±‚åˆ†ç‰‡åï¼Œå¦‚æœä¸€ä¸ª TCP åˆ†ç‰‡ä¸¢å¤±åï¼Œè¿›è¡Œé‡å‘æ—¶ä¹Ÿæ˜¯ä»¥ MSS ä¸ºå•ä½ï¼Œè€Œä¸ç”¨é‡ä¼ æ‰€æœ‰çš„åˆ†ç‰‡ï¼Œå¤§å¤§å¢åŠ äº†é‡ä¼ çš„æ•ˆç‡ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-syn-æ”»å‡»å¦‚ä½•é¿å…-syn-æ”»å‡»"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-syn-æ”»å‡»å¦‚ä½•é¿å…-syn-æ”»å‡»"></a> ä»€ä¹ˆæ˜¯ SYN æ”»å‡»ï¼Ÿå¦‚ä½•é¿å… SYN æ”»å‡»ï¼Ÿ</h2><h3 id="syn-æ”»å‡»"><a class="markdownIt-Anchor" href="#syn-æ”»å‡»"></a> SYN æ”»å‡»</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“ TCP è¿æ¥å»ºç«‹æ˜¯éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œå‡è®¾æ”»å‡»è€…çŸ­æ—¶é—´ä¼ªé€ ä¸åŒ IP åœ°å€çš„ <code>SYN</code> æŠ¥æ–‡ï¼ŒæœåŠ¡ç«¯æ¯æ¥æ”¶åˆ°ä¸€ä¸ª <code>SYN</code> æŠ¥æ–‡ï¼Œå°±è¿›å…¥ <code>SYN_RCVD</code> çŠ¶æ€ï¼Œä½†æœåŠ¡ç«¯å‘é€å‡ºå»çš„ <code>ACK + SYN</code> æŠ¥æ–‡ï¼Œæ— æ³•å¾—åˆ°æœªçŸ¥ IP ä¸»æœºçš„ <code>ACK</code> åº”ç­”ï¼Œä¹…è€Œä¹…ä¹‹å°±ä¼š<strong>å æ»¡æœåŠ¡ç«¯çš„ SYN æ¥æ”¶é˜Ÿåˆ—ï¼ˆæœªè¿æ¥é˜Ÿåˆ—ï¼‰</strong>ï¼Œä½¿å¾—æœåŠ¡å™¨ä¸èƒ½ä¸ºæ­£å¸¸ç”¨æˆ·æœåŠ¡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028164702.png" srcset="/img/loading.gif" alt="" /></p><h3 id="é¿å…-syn-æ”»å‡»æ–¹å¼ä¸€"><a class="markdownIt-Anchor" href="#é¿å…-syn-æ”»å‡»æ–¹å¼ä¸€"></a> é¿å… SYN æ”»å‡»æ–¹å¼ä¸€</h3><p>å…¶ä¸­ä¸€ç§è§£å†³æ–¹å¼æ˜¯é€šè¿‡ä¿®æ”¹ Linux å†…æ ¸å‚æ•°ï¼Œæ§åˆ¶é˜Ÿåˆ—å¤§å°å’Œå½“é˜Ÿåˆ—æ»¡æ—¶åº”åšä»€ä¹ˆå¤„ç†ã€‚</p><p>å½“ç½‘å¡æ¥æ”¶æ•°æ®åŒ…çš„é€Ÿåº¦å¤§äºå†…æ ¸å¤„ç†çš„é€Ÿåº¦æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªé˜Ÿåˆ—ä¿å­˜è¿™äº›æ•°æ®åŒ…ã€‚å¯ä»¥æ§åˆ¶è¯¥é˜Ÿåˆ—çš„æœ€å¤§å€¼ï¼Œæˆ–é™åˆ¶ <code>SYN_RCVD</code> çŠ¶æ€è¿æ¥çš„æœ€å¤§ä¸ªæ•°ï¼Œå½“è¶…å‡ºå¤„ç†èƒ½åŠ›æ—¶ï¼Œå¯¹æ–°çš„ <code>SYN</code> ç›´æ¥å›æŠ¥ <code>RST</code>ï¼Œä¸¢å¼ƒè¿æ¥ã€‚</p><h3 id="é¿å…-syn-æ”»å‡»æ–¹å¼äºŒ"><a class="markdownIt-Anchor" href="#é¿å…-syn-æ”»å‡»æ–¹å¼äºŒ"></a> é¿å… SYN æ”»å‡»æ–¹å¼äºŒ</h3><p>Linux å†…æ ¸çš„ <code>SYN</code> ï¼ˆæœªå®Œæˆè¿æ¥å»ºç«‹ï¼‰é˜Ÿåˆ—ä¸ <code>Accpet</code> ï¼ˆå·²å®Œæˆè¿æ¥å»ºç«‹ï¼‰é˜Ÿåˆ—çš„æ­£å¸¸æµç¨‹ï¼š</p><ol><li>å½“æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ <code>SYN</code> æŠ¥æ–‡æ—¶ï¼Œä¼šå°†å…¶åŠ å…¥åˆ°å†…æ ¸çš„ã€Œ<code>SYN é˜Ÿåˆ—</code>ã€ï¼›</li><li>æ¥ç€å‘é€ <code>SYN + ACK</code> ç»™å®¢æˆ·ç«¯ï¼Œç­‰å¾…å®¢æˆ·ç«¯å›åº” <code>ACK</code> æŠ¥æ–‡ï¼›</li><li>æœåŠ¡ç«¯æ¥æ”¶åˆ° <code>ACK</code> æŠ¥æ–‡åï¼Œä»ã€Œ<code>SYN é˜Ÿåˆ—</code>ã€ç§»é™¤æ”¾å…¥åˆ°ã€Œ<code>Accept é˜Ÿåˆ—</code>ã€ï¼›</li><li>åº”ç”¨é€šè¿‡è°ƒç”¨ <code>accpet()</code> socket æ¥å£ï¼Œä»ã€Œ<code>Accept é˜Ÿåˆ—</code>ã€å–å‡ºè¿æ¥ã€‚</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028164936.png" srcset="/img/loading.gif" alt="" /></p><p>åº”ç”¨ç¨‹åºè¿‡æ…¢ï¼š</p><p>å¦‚æœåº”ç”¨ç¨‹åºè¿‡æ…¢æ—¶ï¼Œå°±ä¼šå¯¼è‡´ã€ŒAccept é˜Ÿåˆ—ã€è¢«å æ»¡ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028165619.jpeg" srcset="/img/loading.gif" alt="" /></p><p>å—åˆ° SYN æ”»å‡»ï¼š</p><p>å¦‚æœä¸æ–­å—åˆ° SYN æ”»å‡»ï¼Œå°±ä¼šå¯¼è‡´ã€Œ SYN é˜Ÿåˆ—ã€è¢«å æ»¡ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028165601.jpeg" srcset="/img/loading.gif" alt="" /></p><ul><li>å½“ ã€Œ SYN é˜Ÿåˆ—ã€æ»¡ä¹‹åï¼Œåç»­æœåŠ¡å™¨æ”¶åˆ° SYN åŒ…ï¼Œ<strong>ä¸è¿›å…¥ã€ŒSYN é˜Ÿåˆ—ã€</strong>ï¼›</li><li>è®¡ç®—å‡ºä¸€ä¸ª <code>cookie</code> å€¼ï¼Œå†ä»¥ SYN + ACK ä¸­çš„ã€Œ<code>åºåˆ—å·</code>ã€è¿”å›å®¢æˆ·ç«¯ï¼Œ</li><li>æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„åº”ç­”æŠ¥æ–‡æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæ£€æŸ¥è¿™ä¸ª <code>ACK</code> åŒ…çš„åˆæ³•æ€§ã€‚å¦‚æœåˆæ³•ï¼Œç›´æ¥æ”¾å…¥åˆ°ã€Œ<code>Accept é˜Ÿåˆ—</code>ã€ã€‚</li><li>æœ€ååº”ç”¨é€šè¿‡è°ƒç”¨ <code>accpet()</code> socket æ¥å£ï¼Œä»ã€Œ<code>Accept é˜Ÿåˆ—</code>ã€å–å‡ºçš„è¿æ¥ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201028165544.jpeg" srcset="/img/loading.gif" alt="" /></p><h1 id="tcp-è¿æ¥æ–­å¼€"><a class="markdownIt-Anchor" href="#tcp-è¿æ¥æ–­å¼€"></a> TCP è¿æ¥æ–­å¼€</h1><h2 id="tcp-å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿"><a class="markdownIt-Anchor" href="#tcp-å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿"></a> TCP å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹å’ŒçŠ¶æ€å˜è¿</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029124017.jpg" srcset="/img/loading.gif" alt="" /><br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029130218.png" srcset="/img/loading.gif" alt="" /></p><ul><li>å®¢æˆ·ç«¯æ‰“ç®—å…³é—­è¿æ¥ï¼Œæ­¤æ—¶ä¼šå‘é€ä¸€ä¸ª TCP é¦–éƒ¨ <code>FIN</code> æ ‡å¿—ä½è¢«ç½®ä¸º <code>1</code> çš„æŠ¥æ–‡ï¼Œä¹‹åå®¢æˆ·ç«¯è¿›å…¥ <code>FIN_WAIT_1</code> çŠ¶æ€ã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ°è¯¥æŠ¥æ–‡åï¼Œå°±å‘å®¢æˆ·ç«¯å‘é€ <code>ACK</code> åº”ç­”æŠ¥æ–‡ï¼Œæ¥ç€æœåŠ¡ç«¯è¿›å…¥ <code>CLOSED_WAIT</code> çŠ¶æ€ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ <code>ACK</code> åº”ç­”æŠ¥æ–‡åï¼Œä¹‹åè¿›å…¥ <code>FIN_WAIT_2</code> çŠ¶æ€ã€‚</li><li>ç­‰å¾…æœåŠ¡ç«¯å¤„ç†å®Œæ•°æ®åï¼Œä¹Ÿå‘å®¢æˆ·ç«¯å‘é€ <code>FIN</code> æŠ¥æ–‡ï¼Œä¹‹åæœåŠ¡ç«¯è¿›å…¥ <code>LAST_ACK</code> çŠ¶æ€ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ <code>FIN</code> æŠ¥æ–‡åï¼Œå›ä¸€ä¸ª <code>ACK</code> åº”ç­”æŠ¥æ–‡ï¼Œä¹‹åè¿›å…¥ <code>TIME_WAIT</code> çŠ¶æ€</li><li>æœåŠ¡å™¨æ”¶åˆ°äº† <code>ACK</code> åº”ç­”æŠ¥æ–‡åï¼Œå°±è¿›å…¥äº† <code>CLOSED</code> çŠ¶æ€ï¼Œè‡³æ­¤æœåŠ¡ç«¯å·²ç»å®Œæˆè¿æ¥çš„å…³é—­ã€‚</li><li>å®¢æˆ·ç«¯åœ¨ç»è¿‡ <code>2MSL</code> åï¼Œè‡ªåŠ¨è¿›å…¥ <code>CLOSED</code> çŠ¶æ€ï¼Œè‡³æ­¤å®¢æˆ·ç«¯ä¹Ÿå®Œæˆè¿æ¥çš„å…³é—­ã€‚</li></ul><blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªæ–¹å‘éƒ½éœ€è¦ä¸€ä¸ª <code>FIN</code> å’Œä¸€ä¸ª <code>ACK</code>ï¼Œå› æ­¤é€šå¸¸è¢«ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹ã€‚<br />éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>ä¸»åŠ¨å…³é—­è¿æ¥çš„ï¼Œæ‰æœ‰ <code>TIME_WAIT</code> çŠ¶æ€ã€‚</strong></p></blockquote><h2 id="ä¸ºä»€ä¹ˆæŒ¥æ‰‹éœ€è¦å››æ¬¡"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆæŒ¥æ‰‹éœ€è¦å››æ¬¡"></a> ä¸ºä»€ä¹ˆæŒ¥æ‰‹éœ€è¦å››æ¬¡</h2><ul><li>å…³é—­è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ <code>FIN</code> æ—¶ï¼Œä»…ä»…è¡¨ç¤º<strong>å®¢æˆ·ç«¯ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ã€‚</strong></li><li>æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ <code>FIN</code> æŠ¥æ–‡æ—¶ï¼Œå…ˆå›ä¸€ä¸ª <code>ACK</code> åº”ç­”æŠ¥æ–‡ï¼Œè€Œ<strong>æœåŠ¡ç«¯å¯èƒ½è¿˜æœ‰æ•°æ®éœ€è¦å¤„ç†å’Œå‘é€</strong>ï¼Œç­‰æœåŠ¡ç«¯ä¸å†å‘é€æ•°æ®æ—¶ï¼Œæ‰å‘é€ <code>FIN</code> æŠ¥æ–‡ç»™å®¢æˆ·ç«¯æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ã€‚</li></ul><p>ä»ä¸Šé¢è¿‡ç¨‹å¯çŸ¥ï¼Œ<strong>æœåŠ¡ç«¯é€šå¸¸éœ€è¦ç­‰å¾…å®Œæˆæ•°æ®çš„å‘é€å’Œå¤„ç†ï¼Œæ‰€ä»¥æœåŠ¡ç«¯çš„ <code>ACK</code> å’Œ <code>FIN</code> ä¸€èˆ¬éƒ½ä¼š<code>åˆ†å¼€å‘é€</code></strong>ï¼Œä»è€Œæ¯”ä¸‰æ¬¡æ¡æ‰‹å¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚</p><h2 id="ä¸ºä»€ä¹ˆ-time_wait-ç­‰å¾…çš„æ—¶é—´æ˜¯-2-msl"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆ-time_wait-ç­‰å¾…çš„æ—¶é—´æ˜¯-2-msl"></a> ä¸ºä»€ä¹ˆ TIME_WAIT ç­‰å¾…çš„æ—¶é—´æ˜¯ 2 MSL</h2><blockquote><p><code>MSL</code> æ˜¯ <code>Maximum Segment Lifetime</code>ï¼ŒæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼Œå®ƒæ˜¯<strong>ä»»ä½•æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šå­˜åœ¨çš„æœ€é•¿æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æŠ¥æ–‡å°†è¢«ä¸¢å¼ƒã€‚<strong>å› ä¸º <code>TCP</code> æŠ¥æ–‡åŸºäºæ˜¯ <code>IP</code> åè®®çš„ï¼Œè€Œ <code>IP</code> å¤´ä¸­æœ‰ä¸€ä¸ª <code>TTL</code> å­—æ®µï¼Œæ˜¯ <code>IP</code> æ•°æ®æŠ¥å¯ä»¥ç»è¿‡çš„</strong>æœ€å¤§è·¯ç”±æ•°</strong>ï¼Œæ¯ç»è¿‡ä¸€ä¸ªå¤„ç†ä»–çš„è·¯ç”±å™¨æ­¤å€¼å°±å‡ 1ï¼Œå½“æ­¤å€¼ä¸º 0 åˆ™æ•°æ®æŠ¥å°†è¢«ä¸¢å¼ƒï¼ŒåŒæ—¶å‘é€ <code>ICMP</code> æŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚</p><p><code>MSL</code> ä¸ <code>TTL</code> çš„åŒºåˆ«ï¼š <code>MSL</code> çš„å•ä½æ˜¯æ—¶é—´ï¼Œè€Œ <code>TTL</code> æ˜¯ç»è¿‡è·¯ç”±è·³æ•°ã€‚æ‰€ä»¥ <code>MSL</code> åº”è¯¥è¦å¤§äºç­‰äº <code>TTL</code> æ¶ˆè€—ä¸º <code>0</code> çš„æ—¶é—´ï¼Œä»¥ç¡®ä¿æŠ¥æ–‡å·²è¢«è‡ªç„¶æ¶ˆäº¡ã€‚</p></blockquote><p>2 MSL æ˜¯ä¸ºäº†<strong>ç¡®ä¿å‘é€æ–¹æœ€åå‘é€çš„ <code>ACK</code> å·²ç»è¢«å¯¹ç«¯æ¥æ”¶</strong>ã€‚<br />å¦‚æœè¢«åŠ¨å…³é—­æ–¹æ²¡æœ‰æ”¶åˆ°æ–­å¼€è¿æ¥çš„æœ€åçš„ <code>ACK</code> æŠ¥æ–‡ï¼Œå°±ä¼šè§¦å‘è¶…æ—¶é‡å‘ <code>FIN</code> æŠ¥æ–‡ï¼Œå¦ä¸€æ–¹æ¥æ”¶åˆ° <code>FIN</code> åï¼Œä¼šé‡å‘ <code>ACK</code> ç»™è¢«åŠ¨å…³é—­æ–¹ï¼Œ ä¸€æ¥ä¸€å»æ­£å¥½ <code>2</code> ä¸ª <code>MSL</code>ã€‚</p><blockquote><p>å½“å®¢æˆ·ç«¯ <code>TIME-WAIT</code> æ—¶é—´è¶…è¿‡äº† <code>2MSL</code>ï¼Œåˆ™å®¢æˆ·ç«¯å°±ç›´æ¥è¿›å…¥å…³é—­çŠ¶æ€ã€‚è‹¥æ­¤æ—¶ç¬¬å››æ¬¡æŒ¥æ‰‹çš„ <code>ACK</code> å’Œé‡å‘çš„ <code>FIN</code> éƒ½ä¸¢å¤±ï¼Œæ­¤æ—¶ä¼šçœ‹æœåŠ¡ç«¯è¶…æ—¶é‡å‘ <code>FIN</code> æŠ¥æ–‡çš„æ¬¡æ•°å¦‚æœè¶…è¿‡ <code>tcp_orphan_retries</code> å¤§å°åï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šå…³é—­ <code>TCP</code> è¿æ¥ã€‚</p></blockquote><p>2 MSL çš„æ—¶é—´æ˜¯<strong>ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ° <code>FIN</code> åå‘é€ <code>ACK</code> å¼€å§‹è®¡æ—¶çš„</strong>ã€‚å¦‚æœåœ¨ <code>TIME-WAIT</code> æ—¶é—´å†…ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„ <code>ACK</code> æ²¡æœ‰ä¼ è¾“åˆ°æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯åˆæ¥æ”¶åˆ°äº†æœåŠ¡ç«¯é‡å‘çš„ <code>FIN</code> æŠ¥æ–‡ï¼Œé‚£ä¹ˆ 2 MSL æ—¶é—´å°†<strong>é‡æ–°è®¡æ—¶</strong>ã€‚</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦-time_wait-çŠ¶æ€"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-time_wait-çŠ¶æ€"></a> ä¸ºä»€ä¹ˆéœ€è¦ TIME_WAIT çŠ¶æ€</h2><p>ä¸»åŠ¨å‘èµ·å…³é—­è¿æ¥çš„ä¸€æ–¹ï¼Œæ‰ä¼šæœ‰ <code>TIME-WAIT</code> çŠ¶æ€ã€‚</p><p>éœ€è¦ <code>TIME-WAIT</code> çŠ¶æ€ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªåŸå› ï¼š</p><ul><li>é˜²æ­¢å…·æœ‰ç›¸åŒã€Œå››å…ƒç»„ã€çš„ã€Œæ—§ã€æ•°æ®åŒ…è¢«æ”¶åˆ°ï¼Œä½¿æ—§çš„æ•°æ®åŒ…æ¶ˆäº¡åœ¨ç½‘ç»œä¸­ï¼›</li><li>ä¿è¯ã€Œè¢«åŠ¨å…³é—­è¿æ¥ã€çš„ä¸€æ–¹èƒ½è¢«æ­£ç¡®çš„å…³é—­ï¼Œå³<strong>ä¿è¯æœ€åçš„ <code>ACK</code> èƒ½è®©è¢«åŠ¨å…³é—­æ–¹æ¥æ”¶ï¼Œä»è€Œå¸®åŠ©å…¶æ­£å¸¸å…³é—­ï¼›</strong></li></ul><h3 id="åŸå› ä¸€é˜²æ­¢æ—§è¿æ¥çš„æ•°æ®åŒ…"><a class="markdownIt-Anchor" href="#åŸå› ä¸€é˜²æ­¢æ—§è¿æ¥çš„æ•°æ®åŒ…"></a> åŸå› ä¸€ï¼šé˜²æ­¢æ—§è¿æ¥çš„æ•°æ®åŒ…</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029124033.png" srcset="/img/loading.gif" alt="" /></p><ul><li>å¦‚ä¸Šå›¾é»„è‰²æ¡†æ¡†æœåŠ¡ç«¯åœ¨å…³é—­è¿æ¥ä¹‹å‰å‘é€çš„ <code>SEQ = 301</code> æŠ¥æ–‡ï¼Œè¢«ç½‘ç»œå»¶è¿Ÿäº†ã€‚</li><li>è¿™æ—¶æœ‰ç›¸åŒç«¯å£çš„ TCP è¿æ¥è¢«å¤ç”¨åï¼Œè¢«å»¶è¿Ÿçš„ <code>SEQ = 301</code> æŠµè¾¾äº†å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯æ˜¯æœ‰å¯èƒ½æ­£å¸¸æ¥æ”¶è¿™ä¸ªè¿‡æœŸçš„æŠ¥æ–‡ï¼Œè¿™å°±ä¼šäº§ç”Ÿ<strong>æ•°æ®é”™ä¹±</strong>ç­‰ä¸¥é‡çš„é—®é¢˜ã€‚</li></ul><p>æ‰€ä»¥ï¼ŒTCP å°±è®¾è®¡å‡ºäº†è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ï¼Œç»è¿‡ 2MSL è¿™ä¸ªæ—¶é—´ï¼Œè¶³ä»¥<strong>è®©ä¸¤ä¸ªæ–¹å‘ä¸Šçš„æ•°æ®åŒ…éƒ½è¢«ä¸¢å¼ƒï¼Œä½¿å¾—åŸæ¥è¿æ¥çš„æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­éƒ½è‡ªç„¶æ¶ˆå¤±ï¼Œå†å‡ºç°çš„æ•°æ®åŒ…ä¸€å®šéƒ½æ˜¯æ–°å»ºç«‹è¿æ¥æ‰€äº§ç”Ÿçš„ã€‚</strong></p><h3 id="åŸå› äºŒä¿è¯è¿æ¥æ­£ç¡®å…³é—­"><a class="markdownIt-Anchor" href="#åŸå› äºŒä¿è¯è¿æ¥æ­£ç¡®å…³é—­"></a> åŸå› äºŒï¼šä¿è¯è¿æ¥æ­£ç¡®å…³é—­</h3><blockquote><p><code>TIME-WAIT</code> ä½œç”¨æ˜¯ç­‰å¾…è¶³å¤Ÿçš„æ—¶é—´ä»¥ç¡®ä¿æœ€åçš„ <code>ACK</code> èƒ½è®©è¢«åŠ¨å…³é—­æ–¹æ¥æ”¶ï¼Œä»è€Œå¸®åŠ©å…¶æ­£å¸¸å…³é—­ã€‚<br />å‡è®¾ <code>TIME-WAIT</code> æ²¡æœ‰ç­‰å¾…æ—¶é—´æˆ–æ—¶é—´è¿‡çŸ­ï¼Œæ–­å¼€è¿æ¥ä¼šé€ æˆä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201029124052.png" srcset="/img/loading.gif" alt="" /></p><ul><li>å¦‚ä¸Šå›¾çº¢è‰²æ¡†æ¡†å®¢æˆ·ç«¯å››æ¬¡æŒ¥æ‰‹çš„æœ€åä¸€ä¸ª <code>ACK</code> æŠ¥æ–‡å¦‚æœåœ¨ç½‘ç»œä¸­è¢«ä¸¢å¤±äº†ï¼Œæ­¤æ—¶å¦‚æœå®¢æˆ·ç«¯ <code>TIME-WAIT</code> è¿‡çŸ­æˆ–æ²¡æœ‰ï¼Œåˆ™å°±ç›´æ¥è¿›å…¥äº† <code>CLOSED</code> çŠ¶æ€äº†ï¼Œé‚£ä¹ˆ<strong>æœåŠ¡ç«¯åˆ™ä¼šä¸€ç›´å¤„åœ¨ <code>LAST-ACK</code> çŠ¶æ€ã€‚</strong></li><li>å½“å®¢æˆ·ç«¯å‘èµ·å»ºç«‹è¿æ¥çš„ <code>SYN</code> è¯·æ±‚æŠ¥æ–‡åï¼ŒæœåŠ¡ç«¯ä¼šå‘é€ <code>RST</code> æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œè¿æ¥å»ºç«‹çš„è¿‡ç¨‹å°±ä¼šè¢«ç»ˆæ­¢ã€‚</li></ul><p>å¦‚æœ <code>TIME-WAIT</code> ç­‰å¾…è¶³å¤Ÿé•¿çš„æƒ…å†µå°±ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼š</p><ul><li>æœåŠ¡ç«¯æ­£å¸¸æ”¶åˆ°å››æ¬¡æŒ¥æ‰‹çš„æœ€åä¸€ä¸ª <code>ACK</code> æŠ¥æ–‡ï¼Œåˆ™æœåŠ¡ç«¯æ­£å¸¸å…³é—­è¿æ¥ã€‚</li><li>æœåŠ¡ç«¯æ²¡æœ‰æ”¶åˆ°å››æ¬¡æŒ¥æ‰‹çš„æœ€åä¸€ä¸ª <code>ACK</code> æŠ¥æ–‡æ—¶ï¼Œåˆ™ä¼šé‡å‘ <code>FIN</code> å…³é—­è¿æ¥æŠ¥æ–‡å¹¶ç­‰å¾…æ–°çš„ <code>ACK</code> æŠ¥æ–‡ã€‚</li></ul><p>æ‰€ä»¥å®¢æˆ·ç«¯åœ¨ <code>TIME-WAIT</code> çŠ¶æ€ç­‰å¾… <code>2MSL</code> æ—¶é—´åï¼Œå°±å¯ä»¥<strong>ä¿è¯åŒæ–¹çš„è¿æ¥éƒ½å¯ä»¥æ­£å¸¸çš„å…³é—­</strong>ã€‚</p><h2 id="time_wait-è¿‡å¤šæœ‰ä»€ä¹ˆå±å®³"><a class="markdownIt-Anchor" href="#time_wait-è¿‡å¤šæœ‰ä»€ä¹ˆå±å®³"></a> TIME_WAIT è¿‡å¤šæœ‰ä»€ä¹ˆå±å®³</h2><p>å¦‚æœæœåŠ¡å™¨æœ‰å¤„äº <code>TIME-WAIT</code> çŠ¶æ€çš„ <code>TCP</code>ï¼Œåˆ™è¯´æ˜æ˜¯ç”±<strong>æœåŠ¡å™¨æ–¹ä¸»åŠ¨å‘èµ·çš„æ–­å¼€è¯·æ±‚</strong>ã€‚</p><p>è¿‡å¤šçš„ <code>TIME-WAIT</code> çŠ¶æ€ä¸»è¦çš„å±å®³æœ‰ä¸¤ç§ï¼š</p><ol><li><strong>å†…å­˜</strong>èµ„æºå ç”¨ï¼›</li><li><strong>ç«¯å£</strong>èµ„æºçš„å ç”¨ï¼Œä¸€ä¸ª TCP è¿æ¥è‡³å°‘æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£ï¼›</li></ol><p>å¦‚æœå‘èµ·è¿æ¥ä¸€æ–¹çš„ <code>TIME_WAIT</code> çŠ¶æ€è¿‡å¤šï¼Œå æ»¡äº†æ‰€æœ‰ç«¯å£èµ„æºï¼Œåˆ™ä¼šå¯¼è‡´æ— æ³•åˆ›å»ºæ–°è¿æ¥ã€‚</p><ul><li><p>å®¢æˆ·ç«¯å—ç«¯å£èµ„æºé™åˆ¶ï¼š<br />å®¢æˆ·ç«¯ <code>TIME_WAIT</code> è¿‡å¤šï¼Œå°±ä¼šå¯¼è‡´ç«¯å£èµ„æºè¢«å ç”¨ï¼Œå› ä¸ºç«¯å£å°±65536ä¸ªï¼Œè¢«å æ»¡å°±ä¼šå¯¼è‡´<strong>æ— æ³•åˆ›å»ºæ–°çš„è¿æ¥ã€‚</strong></p></li><li><p>æœåŠ¡ç«¯å—ç³»ç»Ÿèµ„æºé™åˆ¶ï¼š<br />ç”±äºä¸€ä¸ªå››å…ƒç»„è¡¨ç¤º TCP è¿æ¥ï¼Œç†è®ºä¸ŠæœåŠ¡ç«¯å¯ä»¥å»ºç«‹å¾ˆå¤šè¿æ¥ï¼ŒæœåŠ¡ç«¯ç¡®å®åªç›‘å¬ä¸€ä¸ªç«¯å£ ä½†æ˜¯ä¼šæŠŠè¿æ¥æ‰”ç»™å¤„ç†çº¿ç¨‹ï¼Œæ‰€ä»¥ç†è®ºä¸Šç›‘å¬çš„ç«¯å£å¯ä»¥ç»§ç»­ç›‘å¬ã€‚ä½†æ˜¯çº¿ç¨‹æ± å¤„ç†ä¸äº†é‚£ä¹ˆå¤šä¸€ç›´ä¸æ–­çš„è¿æ¥äº†ã€‚æ‰€ä»¥å½“æœåŠ¡ç«¯å‡ºç°å¤§é‡ <code>TIME_WAIT</code> æ—¶ï¼Œç³»ç»Ÿèµ„æºè¢«å æ»¡æ—¶ï¼Œä¼š<strong>å¯¼è‡´å¤„ç†ä¸è¿‡æ¥æ–°çš„è¿æ¥ã€‚</strong></p></li></ul><h2 id="tcp-ä¿æ´»æœºåˆ¶"><a class="markdownIt-Anchor" href="#tcp-ä¿æ´»æœºåˆ¶"></a> TCP ä¿æ´»æœºåˆ¶</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªæ—¶é—´æ®µï¼Œåœ¨è¿™ä¸ªæ—¶é—´æ®µå†…ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•è¿æ¥ç›¸å…³çš„æ´»åŠ¨ï¼ŒTCP ä¿æ´»æœºåˆ¶ä¼šå¼€å§‹ä½œç”¨ï¼Œæ¯éš”ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡ï¼Œè¯¥æ¢æµ‹æŠ¥æ–‡åŒ…å«çš„æ•°æ®éå¸¸å°‘ï¼Œå¦‚æœè¿ç»­å‡ ä¸ªæ¢æµ‹æŠ¥æ–‡éƒ½æ²¡æœ‰å¾—åˆ°å“åº”ï¼Œåˆ™è®¤ä¸ºå½“å‰çš„ <code>TCP</code> è¿æ¥å·²ç»æ­»äº¡ï¼Œç³»ç»Ÿå†…æ ¸å°†é”™è¯¯ä¿¡æ¯é€šçŸ¥ç»™ä¸Šå±‚åº”ç”¨ç¨‹åºã€‚</p></blockquote><pre><code class="hljs stylus">ä¿æ´»æ—¶é—´ï¼šnet<span class="hljs-selector-class">.ipv4</span><span class="hljs-selector-class">.tcp_keepalive_time</span> = <span class="hljs-number">7200</span>ä¿æ´»æ¢æµ‹çš„é—´éš”ï¼šnet<span class="hljs-selector-class">.ipv4</span><span class="hljs-selector-class">.tcp_keepalive_intvl</span> = <span class="hljs-number">75</span>ä¿æ´»æ¢æµ‹çš„æ¬¡æ•°ï¼šnet<span class="hljs-selector-class">.ipv4</span><span class="hljs-selector-class">.tcp_keepalive_probes</span> = <span class="hljs-number">9</span></code></pre><ul><li><code>tcp_keepalive_time=7200</code>ï¼šè¡¨ç¤ºä¿æ´»æ—¶é—´æ˜¯ <code>7200</code> ç§’ï¼ˆ2å°æ—¶ï¼‰ï¼Œä¹Ÿå°± 2 å°æ—¶å†…å¦‚æœæ²¡æœ‰ä»»ä½•è¿æ¥ç›¸å…³çš„æ´»åŠ¨ï¼Œåˆ™ä¼šå¯åŠ¨ä¿æ´»æœºåˆ¶</li><li><code>tcp_keepalive_intvl=75</code>ï¼šè¡¨ç¤ºæ¯æ¬¡æ£€æµ‹é—´éš” <code>75</code> ç§’ï¼›</li><li><code>tcp_keepalive_probes=9</code>ï¼šè¡¨ç¤ºæ£€æµ‹ <code>9</code> æ¬¡æ— å“åº”ï¼Œè®¤ä¸ºå¯¹æ–¹æ˜¯ä¸å¯è¾¾çš„ï¼Œä»è€Œä¸­æ–­æœ¬æ¬¡çš„è¿æ¥ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ€å°‘éœ€è¦ç»è¿‡ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mi>t</mi><mi>v</mi><mi>l</mi><mo>âˆ—</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>e</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">time + (intvl * probes)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span> å³ 2 å°æ—¶ 11 åˆ† 15 ç§’æ‰å¯ä»¥å‘ç°ä¸€ä¸ªã€Œæ­»äº¡ã€è¿æ¥ã€‚</p><p>å¦‚æœå¼€å¯äº† TCP ä¿æ´»ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ol><li>å¯¹ç«¯ç¨‹åºæ˜¯<strong>æ­£å¸¸å·¥ä½œ</strong>çš„ã€‚å½“ TCP ä¿æ´»çš„æ¢æµ‹æŠ¥æ–‡å‘é€ç»™å¯¹ç«¯, å¯¹ç«¯ä¼šæ­£å¸¸å“åº”ï¼Œè¿™æ · TCP <strong>ä¿æ´»æ—¶é—´ä¼šè¢«é‡ç½®</strong>ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ª TCP ä¿æ´»æ—¶é—´çš„åˆ°æ¥ã€‚</li><li></li><li>å¯¹ç«¯ç¨‹åº<strong>å´©æºƒå¹¶é‡å¯</strong>ã€‚å½“ TCP ä¿æ´»çš„æ¢æµ‹æŠ¥æ–‡å‘é€ç»™å¯¹ç«¯åï¼Œå¯¹ç«¯æ˜¯å¯ä»¥å“åº”çš„ï¼Œä½†ç”±äºæ²¡æœ‰è¯¥è¿æ¥çš„æœ‰æ•ˆä¿¡æ¯ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª RST æŠ¥æ–‡ï¼Œè¿™æ ·å¾ˆå¿«å°±ä¼šå‘ç° TCP <strong>è¿æ¥å·²ç»è¢«é‡ç½®</strong>ã€‚</li><li></li><li>å¯¹ç«¯ç¨‹åº<strong>å´©æºƒ</strong>ï¼Œæˆ–å¯¹ç«¯ç”±äºå…¶ä»–åŸå› å¯¼è‡´æŠ¥æ–‡ä¸å¯è¾¾ã€‚å½“ TCP ä¿æ´»çš„æ¢æµ‹æŠ¥æ–‡å‘é€ç»™å¯¹ç«¯åï¼ŒçŸ³æ²‰å¤§æµ·ï¼Œæ²¡æœ‰å“åº”ï¼Œè¿ç»­å‡ æ¬¡ï¼Œè¾¾åˆ°ä¿æ´»æ¢æµ‹æ¬¡æ•°åï¼ŒTCP ä¼šæŠ¥å‘Šè¯¥ <strong>TCP è¿æ¥å·²ç»æ­»äº¡</strong>ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 145. äºŒå‰æ ‘çš„ååºéå†</title>
    <link href="/2020/10/27/LeetCode-145-binary-tree-postorder-traversal/"/>
    <url>/2020/10/27/LeetCode-145-binary-tree-postorder-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/" target="_blank" rel="noopener">145. äºŒå‰æ ‘çš„ååºéå†</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">postorderTraversal</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    LinkedList&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    stack.add(root);    <span class="hljs-comment">// å‰åºï¼šæ ¹å·¦å³ â€”â€”&gt; ååºï¼šå·¦å³æ ¹</span>    <span class="hljs-comment">// å‰åºï¼šæ ¹å³å·¦  reverse: å·¦å³æ ¹</span>    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        root = stack.pop();        res.add(root.val);        <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) &#123;            stack.push(root.left);        &#125;        <span class="hljs-keyword">if</span> (root.right != <span class="hljs-keyword">null</span>) &#123;            stack.push(root.right);        &#125;    &#125;    Collections.reverse(res);    <span class="hljs-keyword">return</span> res;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">postorderTraversal</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    LinkedList&lt;Integer&gt; res = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    LinkedList&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span> || !stack.isEmpty()) &#123;        <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-comment">// å¤´æ’æ³•</span>            res.addFirst(root.val);            stack.push(root);            <span class="hljs-comment">// å…ˆéå†å³å­æ ‘</span>            root = root.right;        &#125; <span class="hljs-keyword">else</span> &#123;            root = stack.pop();            root = root.left;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 94. äºŒå‰æ ‘çš„ä¸­åºéå†</title>
    <link href="/2020/10/27/LeetCode-94-binary-tree-inorder-traversal/"/>
    <url>/2020/10/27/LeetCode-94-binary-tree-inorder-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-inorder-traversal/" target="_blank" rel="noopener">94. äºŒå‰æ ‘çš„ä¸­åºéå†</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">inorderTraversal</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    LinkedList&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span> || !stack.isEmpty()) &#123;        <span class="hljs-keyword">while</span> (root != <span class="hljs-keyword">null</span>) &#123;            stack.push(root);            root = root.left;        &#125;        root = stack.pop();        res.add(root.val);        root = root.right;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 144. äºŒå‰æ ‘çš„å‰åºéå†</title>
    <link href="/2020/10/27/LeetCode-144-binary-tree-preorder-traversal/"/>
    <url>/2020/10/27/LeetCode-144-binary-tree-preorder-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-preorder-traversal/" target="_blank" rel="noopener">144. äºŒå‰æ ‘çš„å‰åºéå†</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">preorderTraversal</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    LinkedList&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    stack.add(root);    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        root = stack.pop();        res.add(root.val);        <span class="hljs-keyword">if</span> (root.right != <span class="hljs-keyword">null</span>) &#123;            stack.push(root.right);        &#125;        <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) &#123;            stack.push(root.left);        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ping å’Œ traceroute å·¥ä½œåŸç†</title>
    <link href="/2020/10/26/network-ping-traceroute/"/>
    <url>/2020/10/26/network-ping-traceroute/</url>
    
    <content type="html"><![CDATA[<h1 id="icmp-åè®®"><a class="markdownIt-Anchor" href="#icmp-åè®®"></a> ICMP åè®®</h1><h2 id="åŠŸèƒ½"><a class="markdownIt-Anchor" href="#åŠŸèƒ½"></a> åŠŸèƒ½</h2><p><code>ping</code> æ˜¯åŸºäº <code>ICMP</code> åè®®å·¥ä½œçš„ã€‚<br /><code>ICMP</code> å…¨ç§°æ˜¯ Internet Control Message Protocolï¼Œä¹Ÿå°±æ˜¯äº’è”ç½‘æ§åˆ¶æŠ¥æ–‡åè®®ã€‚ICMP æŠ¥æ–‡å°è£…åœ¨ <code>IP</code> åŒ…é‡Œé¢ï¼Œå®ƒå·¥ä½œåœ¨<strong>ç½‘ç»œå±‚</strong>ã€‚</p><p><code>ICMP</code> ä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ï¼š<strong>ç¡®è®¤ IP åŒ…æ˜¯å¦æˆåŠŸé€è¾¾ç›®æ ‡åœ°å€ã€æŠ¥å‘Šå‘é€è¿‡ç¨‹ä¸­ IP åŒ…è¢«åºŸå¼ƒçš„åŸå› å’Œæ”¹å–„ç½‘ç»œè®¾ç½®ç­‰ã€‚</strong></p><p>åœ¨ <code>IP</code> é€šä¿¡ä¸­å¦‚æœæŸä¸ª <code>IP</code> åŒ…å› ä¸ºæŸç§åŸå› æœªèƒ½è¾¾åˆ°ç›®æ ‡åœ°å€ï¼Œé‚£ä¹ˆè¿™ä¸ªå…·ä½“çš„åŸå› å°†ç”± <code>ICMP</code> è´Ÿè´£é€šçŸ¥ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201026190457.png" srcset="/img/loading.gif" alt="" /></p><p><code>ICMP</code> åŒ…å¤´çš„ç±»å‹å­—æ®µï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><ol><li>ä¸€ç±»æ˜¯ç”¨äºè¯Šæ–­çš„æŸ¥è¯¢æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯ã€Œ<strong>æŸ¥è¯¢æŠ¥æ–‡ç±»å‹</strong>ã€</li><li>å¦ä¸€ç±»æ˜¯é€šçŸ¥å‡ºé”™åŸå› çš„é”™è¯¯æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯ã€Œ<strong>å·®é”™æŠ¥æ–‡ç±»å‹</strong>ã€</li></ol><h2 id="æŸ¥è¯¢æŠ¥æ–‡ç±»å‹"><a class="markdownIt-Anchor" href="#æŸ¥è¯¢æŠ¥æ–‡ç±»å‹"></a> æŸ¥è¯¢æŠ¥æ–‡ç±»å‹</h2><p>å›é€æ¶ˆæ¯ç”¨äºè¿›è¡Œé€šä¿¡çš„<strong>ä¸»æœº</strong>æˆ–<strong>è·¯ç”±å™¨</strong>ä¹‹é—´ï¼Œ<strong>åˆ¤æ–­æ‰€å‘é€çš„æ•°æ®åŒ…æ˜¯å¦å·²ç»æˆåŠŸåˆ°è¾¾å¯¹ç«¯</strong>çš„ä¸€ç§æ¶ˆæ¯ï¼Œping å‘½ä»¤å°±æ˜¯åˆ©ç”¨è¿™ä¸ªæ¶ˆæ¯å®ç°çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201026190633.png" srcset="/img/loading.gif" alt="" /></p><p>å¯ä»¥å‘å¯¹ç«¯ä¸»æœºå‘é€<code>å›é€è¯·æ±‚</code>çš„æ¶ˆæ¯ï¼ˆICMP Echo Request Messageï¼Œç±»å‹ 8ï¼‰ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶å¯¹ç«¯ä¸»æœºå‘å›æ¥çš„<code>å›é€åº”ç­”</code>æ¶ˆæ¯ï¼ˆICMP Echo Reply Messageï¼Œç±»å‹ 0ï¼‰ã€‚</p><h2 id="å·®é”™æŠ¥æ–‡ç±»å‹"><a class="markdownIt-Anchor" href="#å·®é”™æŠ¥æ–‡ç±»å‹"></a> å·®é”™æŠ¥æ–‡ç±»å‹</h2><p><code>IP</code> è·¯ç”±å™¨æ— æ³•å°† <code>IP</code> æ•°æ®åŒ…å‘é€ç»™ç›®æ ‡åœ°å€æ—¶ï¼Œä¼šç»™å‘é€ç«¯ä¸»æœºè¿”å›ä¸€ä¸ª<strong>ç›®æ ‡ä¸å¯è¾¾</strong>çš„ <code>ICMP</code> æ¶ˆæ¯ï¼Œå¹¶åœ¨è¿™ä¸ªæ¶ˆæ¯ä¸­æ˜¾ç¤ºä¸å¯è¾¾çš„å…·ä½“åŸå› ï¼ŒåŸå› è®°å½•åœ¨ <code>ICMP</code> åŒ…å¤´çš„ä»£ç å­—æ®µã€‚</p><p>å‡ ä¸ªå¸¸ç”¨çš„ ICMP å·®é”™æŠ¥æ–‡çš„ä¾‹å­ï¼š</p><ol><li>ç›®æ ‡ä¸å¯è¾¾æ¶ˆæ¯ â€”â€” ç±»å‹ ä¸º <code>3</code></li><li>åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯ â€”â€” ç±»å‹ <code>4</code></li><li>é‡å®šå‘æ¶ˆæ¯ â€”â€” ç±»å‹ <code>5</code></li><li>è¶…æ—¶æ¶ˆæ¯ â€”â€” ç±»å‹ <code>11</code></li></ol><h3 id="1-ç›®æ ‡ä¸å¯è¾¾æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#1-ç›®æ ‡ä¸å¯è¾¾æ¶ˆæ¯"></a> 1. ç›®æ ‡ä¸å¯è¾¾æ¶ˆæ¯</h3><table><thead><tr><th>ä»£ç å·</th><th style="text-align:center">å†…å®¹</th></tr></thead><tbody><tr><td><code>0</code></td><td style="text-align:center">ç½‘ç»œä¸å¯è¾¾</td></tr><tr><td><code>1</code></td><td style="text-align:center">ä¸»æœºä¸å¯è¾¾</td></tr><tr><td><code>2</code></td><td style="text-align:center">åè®®ä¸å¯è¾¾</td></tr><tr><td><code>3</code></td><td style="text-align:center">ç«¯å£ä¸å¯è¾¾</td></tr><tr><td><code>4</code></td><td style="text-align:center">éœ€è¦è¿›è¡Œåˆ†ç‰‡ä½†è®¾ç½®äº†ä¸åˆ†ç‰‡ä½</td></tr></tbody></table><h3 id="2-åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#2-åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯"></a> 2. åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯</h3><p>åœ¨ä½¿ç”¨ä½é€Ÿå¹¿åŸŸçº¿è·¯çš„æƒ…å†µä¸‹ï¼Œè¿æ¥ WAN çš„è·¯ç”±å™¨å¯èƒ½ä¼šé‡åˆ°ç½‘ç»œæ‹¥å µçš„é—®é¢˜ã€‚<br /><strong><code>ICMP</code> åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç¼“å’Œè¿™ç§æ‹¥å µæƒ…å†µã€‚</strong></p><p>å½“è·¯ç”±å™¨å‘ä½é€Ÿçº¿è·¯å‘é€æ•°æ®æ—¶ï¼Œå…¶å‘é€é˜Ÿåˆ—çš„ç¼“å­˜å˜ä¸ºé›¶è€Œæ— æ³•å‘é€å‡ºå»æ—¶ï¼Œå¯ä»¥å‘ <code>IP</code> åŒ…çš„æºåœ°å€å‘é€ä¸€ä¸ª <code>ICMP</code> åŸç‚¹æŠ‘åˆ¶æ¶ˆæ¯ã€‚<br />æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯çš„ä¸»æœºå€Ÿæ­¤äº†è§£åœ¨æ•´ä¸ªçº¿è·¯çš„æŸä¸€å¤„å‘ç”Ÿäº†æ‹¥å µçš„æƒ…å†µï¼Œä»è€Œå¢å¤§ <code>IP</code> åŒ…çš„ä¼ è¾“é—´éš”ï¼Œå‡å°‘ç½‘ç»œæ‹¥å µçš„æƒ…å†µã€‚</p><p>ç„¶è€Œï¼Œç”±äºè¿™ç§ <code>ICMP</code> å¯èƒ½ä¼šå¼•èµ·ä¸å…¬å¹³çš„ç½‘ç»œé€šä¿¡ï¼Œä¸€èˆ¬ä¸è¢«ä½¿ç”¨ã€‚</p><h3 id="3-é‡å®šå‘æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#3-é‡å®šå‘æ¶ˆæ¯"></a> 3. é‡å®šå‘æ¶ˆæ¯</h3><p>å¦‚æœè·¯ç”±å™¨å‘ç°å‘é€ç«¯ä¸»æœºä½¿ç”¨äº†ã€Œ<strong>ä¸æ˜¯æœ€ä¼˜</strong>ã€çš„è·¯å¾„å‘é€æ•°æ®ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›ä¸€ä¸ª ICMP é‡å®šå‘æ¶ˆæ¯ç»™è¿™ä¸ªä¸»æœºã€‚</p><p><strong>åœ¨è¿™ä¸ªæ¶ˆæ¯ä¸­åŒ…å«äº†æœ€åˆé€‚çš„è·¯ç”±ä¿¡æ¯å’Œæºæ•°æ®ã€‚</strong> è¿™ä¸»è¦å‘ç”Ÿåœ¨è·¯ç”±å™¨æŒæœ‰<strong>æ›´å¥½çš„è·¯ç”±ä¿¡æ¯</strong>çš„æƒ…å†µä¸‹ã€‚è·¯ç”±å™¨ä¼šé€šè¿‡è¿™æ ·çš„ <code>ICMP</code> æ¶ˆæ¯å‘ŠçŸ¥å‘é€ç«¯ï¼Œè®©å®ƒä¸‹æ¬¡å‘ç»™å¦å¤–ä¸€ä¸ªè·¯ç”±å™¨ã€‚</p><h3 id="4-è¶…æ—¶æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#4-è¶…æ—¶æ¶ˆæ¯"></a> 4. è¶…æ—¶æ¶ˆæ¯</h3><p>IP åŒ…ä¸­æœ‰ä¸€ä¸ªå­—æ®µå«åš <code>TTL ï¼ˆTime To Liveï¼Œç”Ÿå­˜å‘¨æœŸï¼‰</code>ï¼Œå®ƒçš„å€¼éšç€æ¯ç»è¿‡ä¸€æ¬¡è·¯ç”±å™¨å°±ä¼šå‡ <code>1</code>ï¼Œç›´åˆ°å‡åˆ° <code>0</code> æ—¶è¯¥ <code>IP</code> åŒ…ä¼šè¢«ä¸¢å¼ƒã€‚</p><p>æ­¤æ—¶ï¼Œè·¯ç”±å™¨å°†ä¼šå‘é€ä¸€ä¸ª <code>ICMP è¶…æ—¶æ¶ˆæ¯</code>ç»™å‘é€ç«¯ä¸»æœºï¼Œå¹¶é€šçŸ¥è¯¥åŒ…å·²è¢«ä¸¢å¼ƒã€‚</p><p>è®¾ç½® <code>IP</code> åŒ…ç”Ÿå­˜å‘¨æœŸçš„ä¸»è¦ç›®çš„ï¼Œæ˜¯ä¸ºäº†<strong>åœ¨è·¯ç”±æ§åˆ¶é‡åˆ°é—®é¢˜å‘ç”Ÿå¾ªç¯çŠ¶å†µæ—¶ï¼Œé¿å… <code>IP</code> åŒ…æ— ä¼‘æ­¢åœ°åœ¨ç½‘ç»œä¸Šè¢«è½¬å‘ã€‚</strong></p><h1 id="ping-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"><a class="markdownIt-Anchor" href="#ping-æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"></a> ping: æŸ¥è¯¢æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨</h1><p><code>ping</code> å‘½ä»¤æ‰§è¡Œçš„æ—¶å€™ï¼Œæºä¸»æœºé¦–å…ˆä¼šæ„å»ºä¸€ä¸ª <code>ICMP å›é€è¯·æ±‚æ¶ˆæ¯æ•°æ®åŒ…</code>ã€‚</p><p><code>ICMP</code> æ•°æ®åŒ…å†…åŒ…å«å¤šä¸ªå­—æ®µï¼Œæœ€é‡è¦çš„æ˜¯ä¸¤ä¸ªï¼š</p><ul><li>ç±»å‹ï¼šå¯¹äºå›é€è¯·æ±‚æ¶ˆæ¯è€Œè¨€è¯¥å­—æ®µä¸º <code>8</code>ï¼›</li><li>åºå·ï¼šä¸»è¦ç”¨äº<strong>åŒºåˆ†è¿ç»­ <code>ping</code> çš„æ—¶å€™å‘å‡ºçš„å¤šä¸ªæ•°æ®åŒ…</strong>ã€‚æ¯å‘å‡ºä¸€ä¸ªè¯·æ±‚æ•°æ®åŒ…ï¼Œåºå·ä¼šè‡ªåŠ¨åŠ  <code>1</code>ã€‚</li><li>å‘é€æ—¶é—´ï¼šä¸ºäº†èƒ½å¤Ÿè®¡ç®—å¾€è¿”æ—¶é—´ <code>RTT</code>ï¼Œå®ƒä¼šåœ¨æŠ¥æ–‡çš„æ•°æ®éƒ¨åˆ†æ’å…¥å‘é€æ—¶é—´ã€‚</li></ul><p>å‘é€æµç¨‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201026192125.png" srcset="/img/loading.gif" alt="" /></p><ol><li>æºä¸»æœºé¦–å…ˆä¼šæ„å»ºä¸€ä¸ª <code>ICMP å›é€è¯·æ±‚æ¶ˆæ¯æ•°æ®åŒ…</code>ã€‚ç”± <code>ICMP</code> åè®®å°†è¿™ä¸ªæ•°æ®åŒ…è¿åŒ <strong>ç›®æ ‡åœ°å€</strong> ä¸€èµ·äº¤ç»™ <code>IP</code> å±‚ã€‚</li><li><code>IP</code> å±‚å°†ä»¥ <strong>ä¸Šå±‚ä¼ æ¥çš„ IP åœ°å€</strong> ä½œä¸º<strong>ç›®çš„åœ°å€</strong>ï¼Œæœ¬æœº <code>IP</code> åœ°å€ä½œä¸º<strong>æºåœ°å€</strong>ï¼Œåè®®å­—æ®µè®¾ç½®ä¸º <code>1</code> è¡¨ç¤ºæ˜¯ <code>ICMP</code> åè®®ï¼Œå†åŠ ä¸Šä¸€äº›å…¶ä»–æ§åˆ¶ä¿¡æ¯ï¼Œæ„å»ºä¸€ä¸ª <code>IP æ•°æ®åŒ…</code>ã€‚</li><li>åŠ å…¥ <code>MAC</code> é¦–éƒ¨ï¼šå¦‚æœåœ¨æœ¬åœ° <code>ARP</code> æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾å‡º ç›®æ ‡åœ°å€ æ‰€å¯¹åº”çš„ <code>MAC</code> åœ°å€ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™éœ€è¦å‘é€ <code>ARP</code> åè®®æŸ¥è¯¢ <code>MAC</code> åœ°å€ï¼Œè·å¾— <code>MAC</code> åœ°å€åï¼Œç”±æ•°æ®é“¾è·¯å±‚æ„å»ºä¸€ä¸ªæ•°æ®å¸§ï¼Œç›®çš„åœ°å€æ˜¯ <code>IP</code> å±‚ä¼ è¿‡æ¥çš„ <code>MAC</code> åœ°å€ï¼Œæºåœ°å€åˆ™æ˜¯æœ¬æœºçš„ <code>MAC</code> åœ°å€ï¼›è¿˜è¦é™„åŠ ä¸Šä¸€äº›æ§åˆ¶ä¿¡æ¯ï¼Œä¾æ®ä»¥å¤ªç½‘çš„ä»‹è´¨è®¿é—®è§„åˆ™ï¼Œå°†å®ƒä»¬ä¼ é€å‡ºå»ã€‚</li><li>ä¸»æœº <code>B</code> æ”¶åˆ°è¿™ä¸ªæ•°æ®å¸§åï¼Œå…ˆæ£€æŸ¥å®ƒçš„ç›®çš„ <code>MAC</code> åœ°å€ï¼Œå¹¶å’Œæœ¬æœºçš„ <code>MAC</code> åœ°å€å¯¹æ¯”ï¼Œå¦‚ç¬¦åˆï¼Œåˆ™æ¥æ”¶ï¼Œå¦åˆ™å°±ä¸¢å¼ƒã€‚</li><li>ä¸»æœº <code>B</code> ä¼šæ„å»ºä¸€ä¸ª <code>ICMP å›é€å“åº”æ¶ˆæ¯æ•°æ®åŒ…</code>ï¼Œå›é€å“åº”æ•°æ®åŒ…çš„ç±»å‹å­—æ®µä¸º <code>0</code>ï¼Œåºå·ä¸ºæ¥æ”¶åˆ°çš„è¯·æ±‚æ•°æ®åŒ…ä¸­çš„åºå·ï¼Œç„¶åå†å‘é€å‡ºå»ç»™ä¸»æœº <code>A</code>ã€‚</li><li>åœ¨è§„å®šçš„æ—¶å€™é—´å†…ï¼Œæºä¸»æœºå¦‚æœæ²¡æœ‰æ¥åˆ° <code>ICMP</code> çš„åº”ç­”åŒ…ï¼Œåˆ™è¯´æ˜ç›®æ ‡<strong>ä¸»æœºä¸å¯è¾¾</strong>ï¼›å¦‚æœæ¥æ”¶åˆ°äº† <code>ICMP</code> å›é€å“åº”æ¶ˆæ¯ï¼Œåˆ™è¯´æ˜ç›®æ ‡ä¸»æœºå¯è¾¾ã€‚<br />æ­¤æ—¶ï¼Œæºä¸»æœºä¼šæ£€æŸ¥ï¼Œç”¨å½“å‰æ—¶åˆ»å‡å»è¯¥æ•°æ®åŒ…æœ€åˆä»æºä¸»æœºä¸Šå‘å‡ºçš„æ—¶åˆ»ï¼Œå°±æ˜¯ <code>ICMP</code> æ•°æ®åŒ…çš„æ—¶é—´å»¶è¿Ÿã€‚</li></ol><h1 id="traceroute-å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"><a class="markdownIt-Anchor" href="#traceroute-å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨"></a> traceroute: å·®é”™æŠ¥æ–‡ç±»å‹çš„ä½¿ç”¨</h1><p>ä½œç”¨ï¼š</p><ol><li>æ•…æ„è®¾ç½®ç‰¹æ®Šçš„ <code>TTL</code>ï¼Œæ¥<strong>è¿½è¸ªå»å¾€ç›®çš„åœ°æ—¶æ²¿é€”ç»è¿‡çš„è·¯ç”±å™¨</strong>ã€‚</li></ol><blockquote><p><strong>åˆ©ç”¨ IP åŒ…çš„ç”Ÿå­˜æœŸé™ ä» 1 å¼€å§‹æŒ‰ç…§é¡ºåºé€’å¢çš„åŒæ—¶å‘é€ UDP åŒ…ï¼Œå¼ºåˆ¶æ¥æ”¶ ICMP è¶…æ—¶æ¶ˆæ¯</strong>çš„ä¸€ç§æ–¹æ³•ã€‚</p></blockquote><p>æ¯”å¦‚ï¼Œå°† <code>TTL</code> è®¾ç½®ä¸º <code>1</code>ï¼Œåˆ™é‡åˆ°ç¬¬ä¸€ä¸ªè·¯ç”±å™¨ï¼Œå°±ç‰ºç‰²äº†ï¼Œæ¥ç€è¿”å› <code>ICMP</code> å·®é”™æŠ¥æ–‡ç½‘ç»œåŒ…ï¼Œç±»å‹æ˜¯<strong>æ—¶é—´è¶…æ—¶</strong>ã€‚<br />æ¥ä¸‹æ¥å°† <code>TTL</code> è®¾ç½®ä¸º <code>2</code>ï¼Œä¹ŸåŒæ—¶è¿”å›äº† <code>ICMP</code> å·®é”™æŠ¥æ–‡æ•°æ®åŒ…ï¼Œå¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°åˆ°è¾¾ç›®çš„ä¸»æœºã€‚<br />è¿™æ ·çš„è¿‡ç¨‹ï¼Œ<code>traceroute</code> å°±å¯ä»¥æ‹¿åˆ°äº†æ‰€æœ‰çš„è·¯ç”±å™¨ <code>IP</code>ã€‚</p><ol start="2"><li>æ•…æ„è®¾ç½®<strong>ä¸åˆ†ç‰‡</strong>ï¼Œä»è€Œç¡®å®šè·¯å¾„çš„ <code>MTU</code>ã€‚</li></ol><blockquote><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬å¹¶ä¸çŸ¥é“è·¯ç”±å™¨çš„ <code>MTU</code> å¤§å°ï¼Œä»¥å¤ªç½‘çš„æ•°æ®é“¾è·¯ä¸Šçš„ <code>MTU</code> é€šå¸¸æ˜¯ <code>1500</code> å­—èŠ‚ï¼Œä½†æ˜¯éä»¥å¤ªç½‘çš„ <code>MTU</code> å€¼å°±ä¸ä¸€æ ·äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦çŸ¥é“ <code>MTU</code> çš„å¤§å°ï¼Œä»è€Œæ§åˆ¶å‘é€çš„åŒ…å¤§å°ã€‚</p></blockquote><p>é¦–å…ˆåœ¨å‘é€ç«¯ä¸»æœºå‘é€ <code>IP</code> æ•°æ®æŠ¥æ—¶ï¼Œå°† <code>IP</code> åŒ…é¦–éƒ¨çš„<strong>åˆ†ç‰‡ç¦æ­¢æ ‡å¿—ä½è®¾ç½®ä¸º 1</strong>ã€‚æ ¹æ®è¿™ä¸ªæ ‡å¿—ä½ï¼Œé€”ä¸­çš„è·¯ç”±å™¨ä¸ä¼šå¯¹å¤§æ•°æ®åŒ…è¿›è¡Œåˆ†ç‰‡ï¼Œè€Œæ˜¯å°†åŒ…ä¸¢å¼ƒã€‚</p><p>éšåï¼Œé€šè¿‡ä¸€ä¸ª <code>ICMP</code> çš„ä¸å¯è¾¾æ¶ˆæ¯å°†æ•°æ®é“¾è·¯ä¸Š <code>MTU</code> çš„å€¼ä¸€èµ·ç»™å‘é€ä¸»æœºï¼Œä¸å¯è¾¾æ¶ˆæ¯çš„ç±»å‹ä¸ºã€Œ<strong>éœ€è¦è¿›è¡Œåˆ†ç‰‡ä½†è®¾ç½®äº†ä¸åˆ†ç‰‡ä½</strong>ã€ã€‚</p><p>å‘é€ä¸»æœºç«¯æ¯æ¬¡æ”¶åˆ° <code>ICMP</code> å·®é”™æŠ¥æ–‡æ—¶å°±å‡å°‘åŒ…çš„å¤§å°ï¼Œä»¥æ­¤æ¥å®šä½ä¸€ä¸ªåˆé€‚çš„ <code>MTU</code> å€¼ï¼Œä»¥ä¾¿èƒ½åˆ°è¾¾ç›®æ ‡ä¸»æœºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—</title>
    <link href="/2020/10/26/LeetCode-641-design-circular-deque/"/>
    <url>/2020/10/26/LeetCode-641-design-circular-deque/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/design-circular-deque/" target="_blank" rel="noopener">641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularDeque</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> capacity;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‡å‘é˜Ÿå¤´å­˜å‚¨å…ƒç´ çš„ä½ç½®</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> front;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‡å‘é˜Ÿå°¾å­˜å‚¨å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> rear;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] queue;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here. Set the size of the deque to be k.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyCircularDeque</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-keyword">this</span>.capacity = k + <span class="hljs-number">1</span>;        <span class="hljs-keyword">this</span>.queue = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[capacity];        <span class="hljs-comment">/**</span><span class="hljs-comment">         * insert: front-- , set value</span><span class="hljs-comment">         * delete: front++</span><span class="hljs-comment">         */</span>        <span class="hljs-keyword">this</span>.front = <span class="hljs-number">0</span>;        <span class="hljs-comment">/**</span><span class="hljs-comment">         * insert: set value, rear++</span><span class="hljs-comment">         * delete: rear--</span><span class="hljs-comment">         */</span>        <span class="hljs-keyword">this</span>.rear = <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Adds an item at the front of Deque. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">insertFront</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;        <span class="hljs-keyword">if</span> (isFull()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        front = (front - <span class="hljs-number">1</span> + capacity) % capacity;        queue[front] = value;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Adds an item at the rear of Deque. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">insertLast</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;        <span class="hljs-keyword">if</span> (isFull()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        queue[rear] = value;        rear = (rear + <span class="hljs-number">1</span>) % capacity;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Deletes an item from the front of Deque. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteFront</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        front = (front + <span class="hljs-number">1</span>) % capacity;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Deletes an item from the rear of Deque. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deleteLast</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        rear = (rear - <span class="hljs-number">1</span> + capacity) % capacity;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the front item from the deque.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getFront</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">return</span> queue[front];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the last item from the deque.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getRear</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">return</span> queue[(rear - <span class="hljs-number">1</span> + capacity) % capacity];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Checks whether the circular deque is empty or not.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> front == rear;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Checks whether the circular deque is full or not.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isFull</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> (rear + <span class="hljs-number">1</span>) % capacity == front;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—</title>
    <link href="/2020/10/26/LeetCode-622-design-circular-queue/"/>
    <url>/2020/10/26/LeetCode-622-design-circular-queue/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/design-circular-queue/" target="_blank" rel="noopener">622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCircularQueue</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> capacity;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‡å‘é˜Ÿå¤´å­˜å‚¨å…ƒç´ çš„ä½ç½®</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> front;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æŒ‡å‘é˜Ÿå°¾å­˜å‚¨å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> rear;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] queue;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here. Set the size of the queue to be k.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyCircularQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span> </span>&#123;        <span class="hljs-keyword">this</span>.capacity = k + <span class="hljs-number">1</span>;        <span class="hljs-keyword">this</span>.queue = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[capacity];        <span class="hljs-keyword">this</span>.front = <span class="hljs-number">0</span>;        <span class="hljs-keyword">this</span>.rear = <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Insert an element into the circular queue. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enQueue</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;        <span class="hljs-keyword">if</span> (isFull()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        queue[rear] = value;        rear = (rear + <span class="hljs-number">1</span>) % capacity;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Delete an element from the circular queue. Return true if the operation is successful.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">deQueue</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        front = (front + <span class="hljs-number">1</span>) % capacity;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the front item from the queue.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Front</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">return</span> queue[front];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the last item from the queue.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Rear</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (isEmpty()) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">return</span> queue[(rear - <span class="hljs-number">1</span> + capacity) % capacity];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Checks whether the circular queue is empty or not.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> front == rear;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Checks whether the circular queue is full or not.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isFull</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> (rear + <span class="hljs-number">1</span>) % capacity == front;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 621. ä»»åŠ¡è°ƒåº¦å™¨</title>
    <link href="/2020/10/26/LeetCode-621-task-scheduler/"/>
    <url>/2020/10/26/LeetCode-621-task-scheduler/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/task-scheduler/" target="_blank" rel="noopener">621. ä»»åŠ¡è°ƒåº¦å™¨</a></p><h1 id="æ’åº"><a class="markdownIt-Anchor" href="#æ’åº"></a> æ’åº</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">leastInterval</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] tasks, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-comment">// ç»Ÿè®¡æ¯ä¸ªä»»åŠ¡çš„æ•°é‡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> task : tasks) &#123;        counts[task - <span class="hljs-string">'A'</span>]++;    &#125;    <span class="hljs-comment">// æ‰¾åˆ°ä»»åŠ¡æ•°æœ€å¤šçš„ä»»åŠ¡</span>    Arrays.sort(counts);    <span class="hljs-keyword">int</span> maxCount = counts[<span class="hljs-number">25</span>];    <span class="hljs-comment">// éœ€è¦å‡ ä¸ªä»»åŠ¡é˜Ÿåˆ—å–å†³äºæ•°é‡æœ€å¤šçš„é‚£ä¸ªä»»åŠ¡</span>    <span class="hljs-keyword">int</span> time = (maxCount - <span class="hljs-number">1</span>) * (n + <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">25</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-comment">// æœ‰å…¶ä»–ä»»åŠ¡å’Œ max ä¸€æ ·ï¼Œåˆ™å¤šèŠ±ä¸€ä¸ªæ—¶é—´</span>        <span class="hljs-keyword">if</span> (counts[i] == maxCount) &#123;            time++;        &#125;    &#125;    <span class="hljs-comment">// è‹¥æœ‰ç©ºé—²æ—¶é—´ï¼Œres = time</span>    <span class="hljs-comment">// è‹¥æ²¡æœ‰ç©ºé—²æ—¶é—´ï¼Œè¡¨ç¤º n ä¸ªåºåˆ—éƒ½å·²ç”¨å®Œï¼Œéœ€è¦æ‰©å…… nï¼Œres = len</span>    <span class="hljs-keyword">return</span> Math.max(time, tasks.length);&#125;</code></pre><h1 id="ä¼˜å…ˆé˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#ä¼˜å…ˆé˜Ÿåˆ—"></a> ä¼˜å…ˆé˜Ÿåˆ—</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">leastInterval</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] tasks, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-comment">// ç»Ÿè®¡æ¯ä¸ªä»»åŠ¡çš„æ•°é‡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> task : tasks) &#123;        counts[task - <span class="hljs-string">'A'</span>]++;    &#125;    <span class="hljs-comment">// å¤§é¡¶å †ï¼Œä¼˜å…ˆå®‰æ’æ•°é‡å¤šçš„ä»»åŠ¡</span>    Queue&lt;Integer&gt; maxHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;(<span class="hljs-number">26</span>, (o1, o2) -&gt; o2 - o1);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : counts) &#123;        <span class="hljs-keyword">if</span> (num &gt; <span class="hljs-number">0</span>) &#123;            maxHeap.add(num);        &#125;    &#125;    <span class="hljs-keyword">int</span> time = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (!maxHeap.isEmpty()) &#123;        <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;        List&lt;Integer&gt; nextRound = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-comment">// æ¯è½®åˆ†é… n + 1 ä¸ªä»»åŠ¡</span>        <span class="hljs-keyword">while</span> (i &lt;= n) &#123;            time++;            <span class="hljs-keyword">if</span> (!maxHeap.isEmpty()) &#123;                <span class="hljs-comment">// æ¯æ¬¡å–æœ€å¤§ä»»åŠ¡æ•°ï¼ˆå †é¡¶ï¼‰</span>                <span class="hljs-keyword">int</span> taskCount = maxHeap.poll();                <span class="hljs-keyword">if</span> (taskCount &gt; <span class="hljs-number">1</span>) &#123;                    <span class="hljs-comment">// ä»»åŠ¡æ•° - 1 æ”¾å…¥ä¸‹ä¸€è½®</span>                    nextRound.add(taskCount - <span class="hljs-number">1</span>);                &#125;            &#125;            <span class="hljs-keyword">if</span> (maxHeap.isEmpty() &amp;&amp; nextRound.isEmpty()) &#123;                <span class="hljs-keyword">break</span>;            &#125;            i++;        &#125;        maxHeap.addAll(nextRound);    &#125;    <span class="hljs-keyword">return</span> time;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ’åº</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1365. æœ‰å¤šå°‘å°äºå½“å‰æ•°å­—çš„æ•°å­—</title>
    <link href="/2020/10/26/LeetCode-1365-how-many-numbers-are-smaller-than-the-current-number/"/>
    <url>/2020/10/26/LeetCode-1365-how-many-numbers-are-smaller-than-the-current-number/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/how-many-numbers-are-smaller-than-the-current-number/" target="_blank" rel="noopener">1365. æœ‰å¤šå°‘å°äºå½“å‰æ•°å­—çš„æ•°å­—</a></p><h1 id="æ’åº-å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#æ’åº-å“ˆå¸Œ"></a> æ’åº + å“ˆå¸Œ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] smallerNumbersThanCurrent(<span class="hljs-keyword">int</span>[] nums) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span>[] origin = Arrays.copyOf(nums, len);    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">101</span>];    Arrays.sort(nums);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">int</span> j = i - <span class="hljs-number">1</span>;        <span class="hljs-comment">// å»é‡</span>        <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span> &amp;&amp; nums[j] == nums[i]) &#123;            j--;        &#125;        counts[nums[i]] = j + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        res[i] = counts[origin[i]];    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="è®¡æ•°æ’åº"><a class="markdownIt-Anchor" href="#è®¡æ•°æ’åº"></a> è®¡æ•°æ’åº</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] smallerNumbersThanCurrent(<span class="hljs-keyword">int</span>[] nums) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">101</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        counts[num]++;    &#125;    <span class="hljs-comment">// ç»Ÿè®¡å‡ºç°é¢‘æ¬¡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; counts.length; i++) &#123;        counts[i] = counts[i - <span class="hljs-number">1</span>] + counts[i];    &#125;    <span class="hljs-comment">// è®¡ç®—åœ¨ nums[i] ä¹‹å‰å‡ºç°äº†å‡ ä¸ªæ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>) &#123;            res[i] = counts[nums[i] - <span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 674. æœ€é•¿è¿ç»­é€’å¢åºåˆ—</title>
    <link href="/2020/10/25/LeetCode-674-longest-continuous-increasing-subsequence/"/>
    <url>/2020/10/25/LeetCode-674-longest-continuous-increasing-subsequence/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-continuous-increasing-subsequence/" target="_blank" rel="noopener">74. æœ€é•¿è¿ç»­é€’å¢åºåˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findLengthOfLCIS</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> curLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// é€’å¢åˆ™æ›´æ–°é•¿åº¦</span>        <span class="hljs-keyword">if</span> (i - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; nums[i - <span class="hljs-number">1</span>] &lt; nums[i]) &#123;            curLen++;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// éè¿ç»­é€’å¢ï¼Œåˆ™é‡æ–°å¼€å§‹è®¡ç®—é•¿åº¦</span>            curLen = <span class="hljs-number">1</span>;        &#125;        max = Math.max(max, curLen);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findLengthOfLCIS</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] rights = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    Arrays.fill(rights, <span class="hljs-number">1</span>);    <span class="hljs-comment">// ä»å³è¾¹å¼€å§‹æ‰¾æœ€å¤§é€’å¢æ•°</span>    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> &lt; len &amp;&amp; nums[i] &lt; nums[i + <span class="hljs-number">1</span>]) &#123;            rights[i] = rights[i + <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;        &#125;        max = Math.max(max, rights[i]);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 845. æ•°ç»„ä¸­çš„æœ€é•¿å±±è„‰</title>
    <link href="/2020/10/25/LeetCode-845-longest-mountain-in-array/"/>
    <url>/2020/10/25/LeetCode-845-longest-mountain-in-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-mountain-in-array/" target="_blank" rel="noopener">845. æ•°ç»„ä¸­çš„æœ€é•¿å±±è„‰</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">longestMountain</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">3</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[] leftMin = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span>[] rightMin = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// æ‰¾åˆ°å·¦è¾¹æ¯” A[i] å°çš„è¿ç»­ä¸ªæ•° </span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (i - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; A[i - <span class="hljs-number">1</span>] &lt; A[i]) &#123;            leftMin[i] = leftMin[i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            leftMin[i] = <span class="hljs-number">0</span>;        &#125;    &#125;    <span class="hljs-comment">// æ‰¾åˆ°å³è¾¹æ¯” A[i] å°çš„è¿ç»­ä¸ªæ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> &lt; len &amp;&amp; A[i] &gt; A[i + <span class="hljs-number">1</span>]) &#123;            rightMin[i] = rightMin[i + <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            rightMin[i] = <span class="hljs-number">0</span>;        &#125;    &#125;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (leftMin[i] != <span class="hljs-number">0</span> &amp;&amp; rightMin[i] != <span class="hljs-number">0</span>) &#123;            max = Math.max(max, leftMin[i] + rightMin[i] + <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1024. è§†é¢‘æ‹¼æ¥</title>
    <link href="/2020/10/24/LeetCode-1024-video-stitching/"/>
    <url>/2020/10/24/LeetCode-1024-video-stitching/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/video-stitching/" target="_blank" rel="noopener">1024. è§†é¢‘æ‹¼æ¥</a></p><p><a href="https://leetcode-cn.com/problems/jump-game-ii/" target="_blank" rel="noopener">45. è·³è·ƒæ¸¸æˆ II</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">videoStitching</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] clips, <span class="hljs-keyword">int</span> T)</span> </span>&#123;    <span class="hljs-comment">/* dp[i]: è¦†ç›–åŒºé—´ [0, i] æ‰€éœ€è¦çš„æœ€å°‘å­åŒºé—´æ•°é‡</span><span class="hljs-comment">    e.g.   0..|.....i|</span><span class="hljs-comment">              |a_j...|...b_j</span><span class="hljs-comment">      if i in [a_j, b_j]:</span><span class="hljs-comment">        [a_j, b_j] å¯ä»¥è¦†ç›– [0, i] çš„ååŠéƒ¨åˆ†</span><span class="hljs-comment">        ååŠéƒ¨åˆ†ï¼šdp[i] = 1 (åŠ ä¸ŠåŒºé—´ [a_j, b_j])ï¼Œå‰åŠéƒ¨åˆ†ï¼šdp[a_j]</span><span class="hljs-comment">        æ•´ä¸ªåŒºé—´ï¼šdp[i] = min(dp[a_j] + 1, dp[i])</span><span class="hljs-comment">    */</span>    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[T + <span class="hljs-number">1</span>];    Arrays.fill(dp, Integer.MAX_VALUE - <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= T; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] clip : clips) &#123;            <span class="hljs-keyword">if</span> (clip[<span class="hljs-number">0</span>] &lt;= i &amp;&amp; i &lt;= clip[<span class="hljs-number">1</span>]) &#123;                dp[i] = Math.min(dp[i], dp[clip[<span class="hljs-number">0</span>]] + <span class="hljs-number">1</span>);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[T] == Integer.MAX_VALUE - <span class="hljs-number">1</span> ? -<span class="hljs-number">1</span> : dp[T];&#125;</code></pre><h1 id="è´ªå¿ƒ"><a class="markdownIt-Anchor" href="#è´ªå¿ƒ"></a> è´ªå¿ƒ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">videoStitching</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] clips, <span class="hljs-keyword">int</span> T)</span> </span>&#123;    <span class="hljs-comment">// dp[i]: ä»¥ i ä¸ºèµ·ç‚¹èƒ½åˆ°è¾¾çš„æœ€è¿œä½ç½®</span>    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">101</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] clip : clips) &#123;        <span class="hljs-comment">// å– clip[0] æœ€è¿œçš„ä½ç½®ï¼Œå³å–èƒ½è¦†ç›–æœ€è¿œçš„åŒºé—´</span>        dp[clip[<span class="hljs-number">0</span>]] = Math.max(dp[clip[<span class="hljs-number">0</span>]], clip[<span class="hljs-number">1</span>]);    &#125;    <span class="hljs-comment">// æ‰€éœ€è¦çš„ç‰‡æ®µæ•°</span>    <span class="hljs-keyword">int</span> clipCount = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å½“å‰çš„æœ€è¿œä½ç½®</span>    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-comment">// ä¸Šä¸€æ¬¡èµ·è·³çš„ç»ˆç‚¹</span>    <span class="hljs-keyword">int</span> pre = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; T; i++) &#123;        <span class="hljs-comment">// æ›´æ–°å½“å‰èƒ½åˆ°è¾¾çš„æœ€è¿œä½ç½®</span>        max = Math.max(max, dp[i]);        <span class="hljs-comment">// å½“å‰æœ€è¿œåªèƒ½åˆ° i ä½ç½®ï¼Œåˆ°ä¸äº†ä¸‹ä¸€ä¸ªä½ç½®</span>        <span class="hljs-keyword">if</span> (max == i) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-comment">// åˆ°è¾¾ä¸Šä¸€æ¬¡çš„ç»ˆç‚¹ï¼Œå–ä¸€ä¸ªæ–°ç‰‡æ®µ</span>        <span class="hljs-keyword">if</span> (i == pre) &#123;            clipCount++;            pre = max;        &#125;    &#125;    <span class="hljs-keyword">return</span> clipCount;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1267. ç»Ÿè®¡å‚ä¸é€šä¿¡çš„æœåŠ¡å™¨</title>
    <link href="/2020/10/23/LeetCode-1267-count-servers-that-communicate/"/>
    <url>/2020/10/23/LeetCode-1267-count-servers-that-communicate/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/count-servers-that-communicate/" target="_blank" rel="noopener">1267. ç»Ÿè®¡å‚ä¸é€šä¿¡çš„æœåŠ¡å™¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countServers</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] grid)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = grid.length;    <span class="hljs-keyword">int</span> cols = grid[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">int</span>[] rowCount = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows];    <span class="hljs-keyword">int</span>[] colCount = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[cols];    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            rowCount[i] += grid[i][j];            colCount[j] += grid[i][j];        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">if</span> (rowCount[i] &gt; <span class="hljs-number">1</span> || colCount[j] &gt; <span class="hljs-number">1</span>) &#123;                    res++;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ</title>
    <link href="/2020/10/23/LeetCode-1588-sum-of-all-odd-length-subarrays/"/>
    <url>/2020/10/23/LeetCode-1588-sum-of-all-odd-length-subarrays/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sum-of-all-odd-length-subarrays/" target="_blank" rel="noopener">1588. æ‰€æœ‰å¥‡æ•°é•¿åº¦å­æ•°ç»„çš„å’Œ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">sumOddLengthSubarrays</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = arr.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span>[] preSums = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len + <span class="hljs-number">1</span>];    preSums[<span class="hljs-number">0</span>] = arr[<span class="hljs-number">0</span>];    <span class="hljs-comment">// 1 4 2 5 3</span>    <span class="hljs-comment">// 0 1 5 7 12 15</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        preSums[i] = preSums[i - <span class="hljs-number">1</span>] + arr[i - <span class="hljs-number">1</span>];    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= len; j += <span class="hljs-number">2</span>) &#123;            <span class="hljs-comment">// preSums right index = i + &#123;0, 2, 4, ...&#125; + 1</span>            <span class="hljs-comment">// preSums left index = i</span>            <span class="hljs-keyword">int</span> right = i + j;            <span class="hljs-keyword">if</span> (right &lt;= len) &#123;                <span class="hljs-comment">// System.out.println(arr[i] + " sum = " + (preSums[right] - preSums[i]));</span>                res += preSums[right] - preSums[i];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 234. å›æ–‡é“¾è¡¨</title>
    <link href="/2020/10/23/LeetCode-234-palindrome-linked-list/"/>
    <url>/2020/10/23/LeetCode-234-palindrome-linked-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/palindrome-linked-list/" target="_blank" rel="noopener">234. å›æ–‡é“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPalindrome</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span> || head.next == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">// 1 0 1</span>    <span class="hljs-comment">// ç¿»è½¬åçš„é“¾è¡¨å¤´éƒ¨</span>    ListNode reversedHead = <span class="hljs-keyword">null</span>;    <span class="hljs-comment">// ä¿å­˜ éœ€è¦ç¿»è½¬çš„ slow</span>    ListNode preSlow = head;    ListNode slow = head, fast = head;    <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span> &amp;&amp; fast.next != <span class="hljs-keyword">null</span>) &#123;        preSlow = slow;        <span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆç§»åŠ¨</span>        slow = slow.next;        fast = fast.next.next;        <span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆç§»åŠ¨å®Œå†ç¿»è½¬å½“å‰çš„ slow</span>        preSlow.next = reversedHead;        reversedHead = preSlow;    &#125;    <span class="hljs-comment">// å¥‡æ•°ä¸ªç»“ç‚¹ï¼Œslow éœ€è¦è·³è¿‡ä¸­ç‚¹è¿›è¡Œå›æ–‡åˆ¤æ–­</span>    <span class="hljs-keyword">if</span> (fast != <span class="hljs-keyword">null</span>) &#123;        slow = slow.next;    &#125;    <span class="hljs-keyword">while</span> (slow != <span class="hljs-keyword">null</span> &amp;&amp; reversedHead != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">if</span> (slow.val != reversedHead.val) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        slow = slow.next;        reversedHead = reversedHead.next;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»é”®å…¥ç½‘å€åˆ°ç½‘é¡µæ˜¾ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆ</title>
    <link href="/2020/10/23/network-behind-type-url-and-press-enter/"/>
    <url>/2020/10/23/network-behind-type-url-and-press-enter/</url>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023152504.png" srcset="/img/loading.gif" alt="" /></p><h1 id="http"><a class="markdownIt-Anchor" href="#http"></a> HTTP</h1><ol><li>è§£æ URLï¼šæ ¹æ® URL è§£æéœ€è¦è¯·æ±‚çš„æ–‡ä»¶ã€‚</li><li>äº§ç”Ÿ HTTP è¯·æ±‚ä¿¡æ¯ã€‚</li></ol><h1 id="dns-è§£æ"><a class="markdownIt-Anchor" href="#dns-è§£æ"></a> DNS è§£æ</h1><p>æŸ¥è¯¢åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚</p><blockquote><p><code>å®¢æˆ·ç«¯</code> é‡‡ç”¨<strong>é€’å½’æŸ¥è¯¢</strong>å‘ <code>æœ¬åœ° DNSæœåŠ¡å™¨</code> æŸ¥è¯¢ã€‚<br /><code>æœ¬åœ° DNSæœåŠ¡å™¨</code> é‡‡ç”¨<strong>é€’å½’æŸ¥è¯¢</strong>å‘ <code>æ ¹åŸŸåæœåŠ¡å™¨</code> æŸ¥è¯¢ã€‚</p><p>æ ¹åŸŸåæœåŠ¡å™¨å¹¶ä¸ç›´æ¥æŠŠå¾…æŸ¥è¯¢çš„åŸŸåç›´æ¥è½¬æ¢æˆ IP åœ°å€ï¼ˆæ ¹åŸŸåæœåŠ¡å™¨ä¹Ÿæ²¡æœ‰å­˜æ”¾è¿™ç§ä¿¡æ¯ï¼‰ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”å½“æ‰¾å“ªä¸€ä¸ªé¡¶çº§åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚</p></blockquote><ol><li>å®¢æˆ·ç«¯å‘ <code>æœ¬åœ° DNSæœåŠ¡å™¨</code> è¯·æ±‚ <code>http://www.server.com</code> çš„ <code>IP</code> åœ°å€ã€‚</li><li><code>æœ¬åœ° DNSæœåŠ¡å™¨</code> æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œ<ul><li>å¦‚æœç¼“å­˜é‡Œèƒ½æ‰¾åˆ° <code>http://www.server.com</code>ï¼Œåˆ™å®ƒç›´æ¥è¿”å› <code>IP</code> åœ°å€ã€‚</li><li>å¦‚æœæ²¡æœ‰ï¼Œ<code>æœ¬åœ° DNS</code> ä¼šè¯·æ±‚ <code>æ ¹åŸŸåæœåŠ¡å™¨</code>ã€‚</li></ul></li><li><code>æ ¹åŸŸåæœåŠ¡å™¨</code> å‘ç° <code>http://www.server.com</code> çš„é¡¶çº§åŸŸåæ˜¯ <code>.com</code>ï¼Œäºæ˜¯å‘Šè¯‰ <code>æœ¬åœ° DNSæœåŠ¡å™¨</code> å‘ <code>.com</code> é¡¶çº§åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ã€‚</li><li><code>æœ¬åœ° DNS</code> ä¼šè¯·æ±‚ <code>.com é¡¶çº§åŸŸåæœåŠ¡å™¨</code>ï¼Œ<code>.com é¡¶çº§åŸŸåæœåŠ¡å™¨</code> å‘Šè¯‰ <code>æœ¬åœ° DNSæœåŠ¡å™¨</code> å‘ <code>server.com æƒé™åŸŸåæœåŠ¡å™¨</code> æŸ¥è¯¢ã€‚</li><li><code>æœ¬åœ° DNS</code> ä¼šè¯·æ±‚ <code>server.com æƒé™åŸŸåæœåŠ¡å™¨</code>ï¼Œ<code>server.com æƒé™åŸŸåæœåŠ¡å™¨</code> å°†å¯¹åº”çš„ <code>IP åœ°å€</code> è¿”å›ç»™ <code>æœ¬åœ° DNS</code>ã€‚</li><li><code>æœ¬åœ° DNS</code> å°† <code>IP åœ°å€</code> è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023153342.png" srcset="/img/loading.gif" alt="" /></p><h1 id="åè®®æ ˆ"><a class="markdownIt-Anchor" href="#åè®®æ ˆ"></a> åè®®æ ˆ</h1><p>é€šè¿‡ DNS è·å–åˆ° IP åï¼Œå°±å¯ä»¥æŠŠ HTTP çš„ä¼ è¾“å·¥ä½œäº¤ç»™æ“ä½œç³»ç»Ÿä¸­çš„åè®®æ ˆã€‚</p><p>åè®®æ ˆçš„å†…éƒ¨åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ‰¿æ‹…ä¸åŒçš„å·¥ä½œã€‚ä¸Šä¸‹å…³ç³»æ˜¯æœ‰ä¸€å®šçš„è§„åˆ™çš„ï¼Œä¸Šé¢çš„éƒ¨åˆ†ä¼šå‘ä¸‹é¢çš„éƒ¨åˆ†å§”æ‰˜å·¥ä½œï¼Œä¸‹é¢çš„éƒ¨åˆ†æ”¶åˆ°å§”æ‰˜çš„å·¥ä½œå¹¶æ‰§è¡Œã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023155010.png" srcset="/img/loading.gif" alt="" /></p><p>åº”ç”¨ç¨‹åºï¼ˆæµè§ˆå™¨ï¼‰é€šè¿‡è°ƒç”¨ Socket åº“ï¼Œæ¥å§”æ‰˜åè®®æ ˆå·¥ä½œã€‚åè®®æ ˆçš„ä¸ŠåŠéƒ¨åˆ†æœ‰ä¸¤å—ï¼Œåˆ†åˆ«æ˜¯è´Ÿè´£æ”¶å‘æ•°æ®çš„ TCP å’Œ UDP åè®®ï¼Œå®ƒä»¬ä¸¤ä¼šæ¥å—åº”ç”¨å±‚çš„å§”æ‰˜æ‰§è¡Œæ”¶å‘æ•°æ®çš„æ“ä½œã€‚</p><p>åè®®æ ˆçš„ä¸‹é¢ä¸€åŠæ˜¯ç”¨ IP åè®®æ§åˆ¶ç½‘ç»œåŒ…æ”¶å‘æ“ä½œï¼Œåœ¨äº’è”ç½‘ä¸Šä¼ æ•°æ®æ—¶ï¼Œæ•°æ®åˆ½è¢«åˆ‡åˆ†æˆä¸€å—å—çš„ç½‘ç»œåŒ…ï¼Œè€Œå°†ç½‘ç»œåŒ…å‘é€ç»™å¯¹æ–¹çš„æ“ä½œå°±æ˜¯ç”± IP è´Ÿè´£çš„ã€‚</p><p>æ­¤å¤– IP ä¸­è¿˜åŒ…æ‹¬ ICMP åè®®å’Œ ARP åè®®ã€‚</p><ul><li>ICMP ç”¨äºå‘ŠçŸ¥ç½‘ç»œåŒ…ä¼ é€è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯ä»¥åŠå„ç§æ§åˆ¶ä¿¡æ¯ã€‚</li><li>ARP ç”¨äºæ ¹æ® IP åœ°å€æŸ¥è¯¢ç›¸åº”çš„ä»¥å¤ªç½‘ MAC åœ°å€ã€‚</li></ul><p>IP ä¸‹é¢çš„ç½‘å¡é©±åŠ¨ç¨‹åºè´Ÿè´£æ§åˆ¶ç½‘å¡ç¡¬ä»¶ï¼Œè€Œæœ€ä¸‹é¢çš„ç½‘å¡åˆ™è´Ÿè´£å®Œæˆå®é™…çš„æ”¶å‘æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¯¹ç½‘çº¿ä¸­çš„ä¿¡å·æ‰§è¡Œå‘é€å’Œæ¥æ”¶æ“ä½œã€‚</p><h1 id="tcp"><a class="markdownIt-Anchor" href="#tcp"></a> TCP</h1><h2 id="ä¸‰æ¬¡æ¡æ‰‹"><a class="markdownIt-Anchor" href="#ä¸‰æ¬¡æ¡æ‰‹"></a> ä¸‰æ¬¡æ¡æ‰‹</h2><p>TCP é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023155215.png" srcset="/img/loading.gif" alt="" /></p><ul><li>ä¸€å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº <code>CLOSED</code> çŠ¶æ€ã€‚å…ˆæ˜¯æœåŠ¡ç«¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº <code>LISTEN</code> çŠ¶æ€ã€‚</li><li>ç„¶åå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥ <code>SYN</code>ï¼Œä¹‹åå¤„äº <code>SYN-SENT</code> çŠ¶æ€ã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ°å‘èµ·çš„è¿æ¥ï¼Œè¿”å› <code>SYN</code>ï¼Œå¹¶ä¸” <code>ACK</code> å®¢æˆ·ç«¯çš„ <code>SYN</code>ï¼Œä¹‹åå¤„äº <code>SYN-RCVD</code> çŠ¶æ€ã€‚</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯å‘é€çš„ <code>SYN</code> å’Œ <code>ACK</code> ä¹‹åï¼Œå‘é€ <code>ACK</code> çš„ <code>ACK</code>ï¼Œä¹‹åå¤„äº <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¸€å‘ä¸€æ”¶æˆåŠŸäº†ã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ° <code>ACK</code> çš„ <code>ACK</code> ä¹‹åï¼Œå¤„äº <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¹Ÿä¸€å‘ä¸€æ”¶äº†ã€‚</li></ul><blockquote><p>ä¸‰æ¬¡æ¡æ‰‹ç›®çš„æ˜¯<strong>ä¿è¯åŒæ–¹éƒ½æœ‰å‘é€å’Œæ¥æ”¶çš„èƒ½åŠ›</strong>ã€‚</p></blockquote><h2 id="tcp-åˆ†å‰²-http-æ•°æ®"><a class="markdownIt-Anchor" href="#tcp-åˆ†å‰²-http-æ•°æ®"></a> TCP åˆ†å‰² HTTP æ•°æ®</h2><blockquote><p><code>MTU</code>ï¼šä¸€ä¸ªç½‘ç»œåŒ…çš„æœ€å¤§é•¿åº¦ï¼Œä»¥å¤ªç½‘ä¸­ä¸€èˆ¬ä¸º <code>1500</code> å­—èŠ‚ã€‚<br /><code>MSS</code>ï¼šé™¤å» <code>IP</code> å’Œ <code>TCP</code> å¤´éƒ¨ä¹‹åï¼Œä¸€ä¸ªç½‘ç»œåŒ…æ‰€èƒ½å®¹çº³çš„ <code>TCP</code> æ•°æ®çš„æœ€å¤§é•¿åº¦ã€‚</p></blockquote><p>å¦‚æœ <code>HTTP</code> è¯·æ±‚æ¶ˆæ¯æ¯”è¾ƒé•¿ï¼Œè¶…è¿‡äº† <code>MSS</code> çš„é•¿åº¦ï¼Œè¿™æ—¶ <code>TCP</code> å°±éœ€è¦æŠŠ <code>HTTP</code> çš„æ•°æ®æ‹†è§£ä¸€å—å—çš„æ•°æ®å‘é€ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å‘é€æ‰€æœ‰æ•°æ®ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023155957.png" srcset="/img/loading.gif" alt="" /></p><p>æ•°æ®ä¼šè¢«ä»¥ <code>MSS</code> çš„é•¿åº¦ä¸ºå•ä½è¿›è¡Œæ‹†åˆ†ï¼Œæ‹†åˆ†å‡ºæ¥çš„æ¯ä¸€å—æ•°æ®éƒ½ä¼šè¢«æ”¾è¿›å•ç‹¬çš„ç½‘ç»œåŒ…ä¸­ã€‚ä¹Ÿå°±æ˜¯åœ¨æ¯ä¸ªè¢«æ‹†åˆ†çš„æ•°æ®åŠ ä¸Š <code>TCP</code> å¤´ä¿¡æ¯ï¼Œç„¶åäº¤ç»™ <code>IP</code> æ¨¡å—æ¥å‘é€æ•°æ®ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023160020.png" srcset="/img/loading.gif" alt="" /></p><h2 id="tcp-æŠ¥æ–‡ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#tcp-æŠ¥æ–‡ç”Ÿæˆ"></a> TCP æŠ¥æ–‡ç”Ÿæˆ</h2><p>TCP åè®®é‡Œé¢ä¼šæœ‰ä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªæ˜¯æµè§ˆå™¨ç›‘å¬çš„ç«¯å£ï¼ˆé€šå¸¸æ˜¯éšæœºç”Ÿæˆçš„ï¼‰ï¼Œä¸€ä¸ªæ˜¯ Web æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£ï¼ˆ80/443ï¼‰ã€‚</p><p>åœ¨åŒæ–¹å»ºç«‹äº†è¿æ¥åï¼ŒTCP æŠ¥æ–‡ä¸­çš„æ•°æ®éƒ¨åˆ†å°±æ˜¯å­˜æ”¾ HTTP å¤´éƒ¨ + æ•°æ®ï¼Œç»„è£…å¥½ TCP æŠ¥æ–‡ä¹‹åï¼Œå°±éœ€äº¤ç»™ä¸‹é¢çš„ç½‘ç»œå±‚å¤„ç†ã€‚</p><p>è‡³æ­¤ï¼Œç½‘ç»œåŒ…çš„æŠ¥æ–‡å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023160222.png" srcset="/img/loading.gif" alt="" /></p><h1 id="ip"><a class="markdownIt-Anchor" href="#ip"></a> IP</h1><p>TCP æ¨¡å—åœ¨æ‰§è¡Œè¿æ¥ã€æ”¶å‘ã€æ–­å¼€ç­‰å„é˜¶æ®µæ“ä½œæ—¶ï¼Œéƒ½éœ€è¦å§”æ‰˜ IP æ¨¡å—å°†æ•°æ®å°è£…æˆç½‘ç»œåŒ…å‘é€ç»™é€šä¿¡å¯¹è±¡ã€‚</p><h2 id="ç½‘å¡é€‰æ‹©"><a class="markdownIt-Anchor" href="#ç½‘å¡é€‰æ‹©"></a> ç½‘å¡é€‰æ‹©</h2><ul><li>æºåœ°å€IPï¼Œå®¢æˆ·ç«¯è¾“å‡ºçš„ IP åœ°å€ï¼›</li><li>ç›®æ ‡åœ°å€ï¼Œé€šè¿‡ DNS åŸŸåè§£æå¾—åˆ°çš„ Web æœåŠ¡å™¨ IPã€‚</li></ul><p>å½“å­˜åœ¨å¤šä¸ªç½‘å¡æ—¶ï¼Œåœ¨å¡«å†™æºåœ°å€ IP æ—¶ï¼Œå°±éœ€è¦åˆ¤æ–­åˆ°åº•åº”è¯¥å¡«å†™å“ªä¸ªåœ°å€ã€‚è¿™ä¸ªåˆ¤æ–­ç›¸å½“äº<strong>åœ¨å¤šå—ç½‘å¡ä¸­åˆ¤æ–­åº”è¯¥ä½¿ç”¨å“ªä¸ªä¸€å—ç½‘å¡æ¥å‘é€åŒ…</strong>ã€‚</p><p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦æ ¹æ®è·¯ç”±è¡¨è§„åˆ™ï¼Œæ¥åˆ¤æ–­å“ªä¸€ä¸ªç½‘å¡ä½œä¸ºæºåœ°å€ IPã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023161006.png" srcset="/img/loading.gif" alt="" /></p><p>å‡è®¾ Web æœåŠ¡å™¨çš„ç›®æ ‡åœ°å€æ˜¯ <code>192.168.10.200</code>ã€‚</p><ol><li>é¦–å…ˆå…ˆå’Œç¬¬ä¸€æ¡ç›®çš„å­ç½‘æ©ç è¿›è¡Œ <strong>ä¸è¿ç®—</strong>ï¼Œå¾—åˆ°ç»“æœä¸º <code>192.168.10.0</code>ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªæ¡ç›®çš„ Destination æ˜¯ <code>192.168.3.0</code>ï¼Œä¸¤è€…ä¸ä¸€è‡´æ‰€ä»¥åŒ¹é…å¤±è´¥ã€‚</li><li>å†ä¸ç¬¬äºŒæ¡ç›®çš„å­ç½‘æ©ç è¿›è¡Œ <strong>ä¸è¿ç®—</strong>ï¼Œå¾—åˆ°çš„ç»“æœä¸º <code>192.168.10.0</code>ï¼Œä¸ç¬¬äºŒæ¡ç›®çš„ Destination <code>192.168.10.0</code> åŒ¹é…æˆåŠŸï¼Œæ‰€ä»¥å°†ä½¿ç”¨ <code>eth1</code> ç½‘å¡çš„ IP åœ°å€ä½œä¸º IP åŒ…å¤´çš„æºåœ°å€ã€‚</li></ol><h2 id="ip-æŠ¥æ–‡ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#ip-æŠ¥æ–‡ç”Ÿæˆ"></a> IP æŠ¥æ–‡ç”Ÿæˆ</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023160810.png" srcset="/img/loading.gif" alt="" /></p><h1 id="mac"><a class="markdownIt-Anchor" href="#mac"></a> MAC</h1><p>ç”Ÿæˆäº† IP å¤´éƒ¨ä¹‹åï¼Œæ¥ä¸‹æ¥ç½‘ç»œåŒ…è¿˜éœ€è¦åœ¨ IP å¤´éƒ¨çš„å‰é¢åŠ ä¸Š MAC å¤´éƒ¨ã€‚</p><p>åœ¨ <code>MAC</code> åŒ…å¤´é‡Œéœ€è¦<code>å‘é€æ–¹ MAC åœ°å€</code>å’Œ<code>æ¥æ”¶æ–¹ç›®æ ‡ MAC åœ°å€</code>ï¼Œç”¨äº<strong>ä¸¤ç‚¹ä¹‹é—´</strong>çš„ä¼ è¾“ã€‚</p><p>ä¸€èˆ¬åœ¨ TCP/IP é€šä¿¡é‡Œï¼ŒMAC åŒ…å¤´çš„åè®®ç±»å‹åªä½¿ç”¨ï¼š</p><ul><li><code>0800</code> ï¼š <code>IP</code> åè®®</li><li><code>0806</code> ï¼š <code>ARP</code> åè®®</li></ul><p>åœ°å€è·å–ï¼š</p><ul><li>å‘é€æ–¹çš„ MAC åœ°å€ï¼šè¯»å–ç½‘å¡çš„ <code>MAC</code> åœ°å€ã€‚</li><li>æ¥æ”¶æ–¹çš„ MAC åœ°å€ï¼šä½¿ç”¨ <code>ARP åè®®</code> ä»¥<strong>å¹¿æ’­</strong>çš„å½¢å¼è·å–ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023161711.png" srcset="/img/loading.gif" alt="" /></p><h1 id="ç½‘å¡"><a class="markdownIt-Anchor" href="#ç½‘å¡"></a> ç½‘å¡</h1><p>IP ç”Ÿæˆçš„ç½‘ç»œåŒ…åªæ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ä¸€ä¸²<strong>äºŒè¿›åˆ¶æ•°å­—ä¿¡æ¯</strong>ï¼Œæ²¡æœ‰åŠæ³•ç›´æ¥å‘é€ç»™å¯¹æ–¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦<strong>å°†æ•°å­—ä¿¡æ¯è½¬æ¢ä¸ºç”µä¿¡å·</strong>ï¼Œæ‰èƒ½åœ¨ç½‘çº¿ä¸Šä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ‰æ˜¯çœŸæ­£çš„æ•°æ®å‘é€è¿‡ç¨‹ã€‚</p><p>è´Ÿè´£æ‰§è¡Œè¿™ä¸€æ“ä½œçš„æ˜¯ç½‘å¡ï¼Œè¦æ§åˆ¶ç½‘å¡è¿˜éœ€è¦é <strong>ç½‘å¡é©±åŠ¨ç¨‹åº</strong>ã€‚</p><p>ç½‘å¡é©±åŠ¨ä» <code>IP</code> æ¨¡å—è·å–åˆ°åŒ…ä¹‹åï¼Œä¼šå°†å…¶å¤åˆ¶åˆ°ç½‘å¡å†…çš„ç¼“å­˜åŒºä¸­ï¼Œæ¥ç€ä¼šå…¶<strong>å¼€å¤´åŠ ä¸ŠæŠ¥å¤´å’Œèµ·å§‹å¸§åˆ†ç•Œç¬¦ï¼Œåœ¨æœ«å°¾åŠ ä¸Šç”¨äºæ£€æµ‹é”™è¯¯çš„å¸§æ ¡éªŒåºåˆ—ã€‚</strong></p><ul><li>èµ·å§‹å¸§åˆ†ç•Œç¬¦æ˜¯ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºåŒ…èµ·å§‹ä½ç½®çš„æ ‡è®°</li><li>æœ«å°¾çš„ FCSï¼ˆå¸§æ ¡éªŒåºåˆ—ï¼‰ç”¨æ¥æ£€æŸ¥åŒ…ä¼ è¾“è¿‡ç¨‹æ˜¯å¦æœ‰æŸå</li></ul><p>æœ€åç½‘å¡ä¼šå°†åŒ…è½¬ä¸ºç”µä¿¡å·ï¼Œé€šè¿‡ç½‘çº¿å‘é€å‡ºå»ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023161932.png" srcset="/img/loading.gif" alt="" /></p><h1 id="äº¤æ¢æœº"><a class="markdownIt-Anchor" href="#äº¤æ¢æœº"></a> äº¤æ¢æœº</h1><p>äº¤æ¢æœºçš„è®¾è®¡æ˜¯å°†ç½‘ç»œåŒ…åŸæ ·è½¬å‘åˆ°ç›®çš„åœ°ã€‚äº¤æ¢æœºå·¥ä½œåœ¨ MAC å±‚ï¼Œä¹Ÿç§°ä¸º<strong>äºŒå±‚ç½‘ç»œè®¾å¤‡</strong>ã€‚<br />é¦–å…ˆï¼Œç”µä¿¡å·åˆ°è¾¾ç½‘çº¿æ¥å£ï¼Œäº¤æ¢æœºé‡Œçš„æ¨¡å—è¿›è¡Œæ¥æ”¶ï¼Œæ¥ä¸‹æ¥äº¤æ¢æœºé‡Œçš„æ¨¡å—<strong>å°†ç”µä¿¡å·è½¬æ¢ä¸ºæ•°å­—ä¿¡å·</strong>ã€‚<br />ç„¶åé€šè¿‡åŒ…æœ«å°¾çš„ <code>FCS</code> æ ¡éªŒé”™è¯¯ï¼Œå¦‚æœæ²¡é—®é¢˜åˆ™æ”¾åˆ°ç¼“å†²åŒºã€‚</p><p>å°†åŒ…å­˜å…¥ç¼“å†²åŒºåï¼Œæ¥ä¸‹æ¥éœ€è¦æŸ¥è¯¢ä¸€ä¸‹è¿™ä¸ªåŒ…çš„<code>æ¥æ”¶æ–¹ MAC åœ°å€</code>æ˜¯å¦å·²ç»åœ¨ <code>MAC åœ°å€è¡¨</code>ä¸­æœ‰è®°å½•äº†ã€‚</p><p>äº¤æ¢æœºçš„ MAC åœ°å€è¡¨ä¸»è¦åŒ…å«ä¸¤ä¸ªä¿¡æ¯ï¼š</p><ul><li>ä¸€ä¸ªæ˜¯è®¾å¤‡æ¥æ”¶æ–¹çš„ <code>MAC åœ°å€</code>ï¼Œ</li><li>å¦ä¸€ä¸ªæ˜¯è¯¥è®¾å¤‡è¿æ¥åœ¨äº¤æ¢æœºçš„å“ªä¸ª<code>ç«¯å£</code>ä¸Šã€‚</li></ul><p><strong>äº¤æ¢æœºæ ¹æ® MAC åœ°å€è¡¨æŸ¥æ‰¾ MAC åœ°å€ï¼Œç„¶åå°†ä¿¡å·å‘é€åˆ°ç›¸åº”çš„ç«¯å£ã€‚</strong></p><blockquote><p>åœ°å€è¡¨ä¸­æ‰¾ä¸åˆ°æŒ‡å®šçš„ MAC åœ°å€ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºå…·æœ‰è¯¥åœ°å€çš„è®¾å¤‡è¿˜æ²¡æœ‰å‘äº¤æ¢æœºå‘é€è¿‡åŒ…ï¼Œæˆ–è€…è¿™ä¸ªè®¾å¤‡ä¸€æ®µæ—¶é—´æ²¡æœ‰å·¥ä½œå¯¼è‡´åœ°å€è¢«ä»åœ°å€è¡¨ä¸­åˆ é™¤äº†ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºæ— æ³•åˆ¤æ–­åº”è¯¥æŠŠåŒ…è½¬å‘åˆ°å“ªä¸ªç«¯å£ï¼Œåªèƒ½<strong>å°†åŒ…è½¬å‘åˆ°é™¤äº†æºç«¯å£ä¹‹å¤–çš„æ‰€æœ‰ç«¯å£ä¸Š</strong>ï¼Œæ— è®ºè¯¥è®¾å¤‡è¿æ¥åœ¨å“ªä¸ªç«¯å£ä¸Šéƒ½èƒ½æ”¶åˆ°è¿™ä¸ªåŒ…ã€‚</p></blockquote><h1 id="è·¯ç”±å™¨"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨"></a> è·¯ç”±å™¨</h1><h2 id="è·¯ç”±å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«"></a> è·¯ç”±å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«</h2><ul><li>è·¯ç”±å™¨æ˜¯åŸºäº <code>IP</code> è®¾è®¡çš„ï¼Œä¿—ç§°ä¸‰å±‚ç½‘ç»œè®¾å¤‡ï¼Œè·¯ç”±å™¨çš„å„ä¸ªç«¯å£éƒ½<strong>å…·æœ‰ MAC åœ°å€å’Œ IP åœ°å€</strong>ï¼›</li><li>è€Œäº¤æ¢æœºæ˜¯åŸºäº<code>ä»¥å¤ªç½‘</code>è®¾è®¡çš„ï¼Œä¿—ç§°äºŒå±‚ç½‘ç»œè®¾å¤‡ï¼Œ<strong>äº¤æ¢æœºçš„ç«¯å£ä¸å…·æœ‰ MAC åœ°å€</strong>ã€‚</li></ul><h2 id="è·¯ç”±å™¨çš„åŒ…æ¥æ”¶æ“ä½œ"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨çš„åŒ…æ¥æ”¶æ“ä½œ"></a> è·¯ç”±å™¨çš„åŒ…æ¥æ”¶æ“ä½œ</h2><p>é¦–å…ˆï¼Œç”µä¿¡å·åˆ°è¾¾ç½‘çº¿æ¥å£éƒ¨åˆ†ï¼Œè·¯ç”±å™¨ä¸­çš„æ¨¡å—ä¼šå°†ç”µä¿¡å·è½¬æˆæ•°å­—ä¿¡å·ï¼Œç„¶åé€šè¿‡åŒ…æœ«å°¾çš„ <code>FCS</code> è¿›è¡Œé”™è¯¯æ ¡éªŒã€‚</p><p>å¦‚æœæ²¡é—®é¢˜åˆ™æ£€æŸ¥ <code>MAC</code> å¤´éƒ¨ä¸­çš„æ¥æ”¶æ–¹ <code>MAC</code> åœ°å€ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‘ç»™è‡ªå·±çš„åŒ…ï¼Œå¦‚æœæ˜¯å°±æ”¾åˆ°æ¥æ”¶ç¼“å†²åŒºä¸­ï¼Œå¦åˆ™å°±ä¸¢å¼ƒè¿™ä¸ªåŒ…ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè·¯ç”±å™¨çš„ç«¯å£éƒ½å…·æœ‰ <code>MAC</code> åœ°å€ï¼Œ<strong>åªæ¥æ”¶ä¸è‡ªèº«åœ°å€åŒ¹é…çš„åŒ…ï¼Œé‡åˆ°ä¸åŒ¹é…çš„åŒ…åˆ™ç›´æ¥ä¸¢å¼ƒã€‚</strong></p><h2 id="è·¯ç”±å™¨çš„åŒ…å‘é€æ“ä½œ"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨çš„åŒ…å‘é€æ“ä½œ"></a> è·¯ç”±å™¨çš„åŒ…å‘é€æ“ä½œ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦<strong>æ ¹æ®è·¯ç”±è¡¨çš„ç½‘å…³åˆ—åˆ¤æ–­å¯¹æ–¹çš„åœ°å€</strong>ã€‚</p><ul><li>å¦‚æœç½‘å…³æ˜¯ä¸€ä¸ª <code>IP</code> åœ°å€ï¼Œåˆ™è¿™ä¸ª <code>IP</code> åœ°å€å°±æ˜¯æˆ‘ä»¬è¦è½¬å‘åˆ°çš„ç›®æ ‡åœ°å€ï¼Œè¿˜æœªæŠµè¾¾ç»ˆç‚¹ï¼Œè¿˜éœ€ç»§ç»­éœ€è¦è·¯ç”±å™¨è½¬å‘ã€‚</li><li>å¦‚æœç½‘å…³ä¸ºç©ºï¼Œåˆ™ <code>IP</code> å¤´éƒ¨ä¸­çš„æ¥æ”¶æ–¹ <code>IP</code> åœ°å€å°±æ˜¯è¦è½¬å‘åˆ°çš„ç›®æ ‡åœ°å€ï¼Œä¹Ÿæ˜¯å°±ç»ˆäºæ‰¾åˆ° <code>IP</code> åŒ…å¤´é‡Œçš„ç›®æ ‡åœ°å€äº†ï¼Œè¯´æ˜å·²æŠµè¾¾ç»ˆç‚¹ã€‚</li></ul><p>çŸ¥é“å¯¹æ–¹çš„ <code>IP</code> åœ°å€ä¹‹åï¼Œæ¥ä¸‹æ¥éœ€è¦é€šè¿‡ <code>ARP</code> åè®®æ ¹æ® <code>IP</code> åœ°å€æŸ¥è¯¢ <code>MAC</code> åœ°å€ï¼Œå¹¶å°†æŸ¥è¯¢çš„ç»“æœä½œä¸ºæ¥æ”¶æ–¹ <code>MAC</code> åœ°å€ã€‚</p><p>è·¯ç”±å™¨ä¹Ÿæœ‰ <code>ARP</code> ç¼“å­˜ï¼Œå› æ­¤é¦–å…ˆä¼šåœ¨ <code>ARP</code> ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™å‘é€ <code>ARP</code> æŸ¥è¯¢è¯·æ±‚ã€‚</p><p>ç½‘ç»œåŒ…å®Œæˆåï¼Œæ¥ä¸‹æ¥ä¼šå°†å…¶è½¬æ¢æˆç”µä¿¡å·å¹¶é€šè¿‡ç«¯å£å‘é€å‡ºå»ã€‚<br />å‘é€å‡ºå»çš„ç½‘ç»œåŒ…ä¼šé€šè¿‡äº¤æ¢æœºåˆ°è¾¾ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚ç”±äºæ¥æ”¶æ–¹ MAC åœ°å€å°±æ˜¯ä¸‹ä¸€ä¸ªè·¯ç”±å™¨çš„åœ°å€ï¼Œæ‰€ä»¥äº¤æ¢æœºä¼šæ ¹æ®è¿™ä¸€åœ°å€å°†åŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä¸‹ä¸€ä¸ªè·¯ç”±å™¨ä¼šå°†åŒ…è½¬å‘ç»™å†ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ï¼Œç»è¿‡å±‚å±‚è½¬å‘ä¹‹åï¼Œç½‘ç»œåŒ…å°±åˆ°è¾¾äº†æœ€ç»ˆçš„ç›®çš„åœ°ã€‚</p><p>åœ¨ç½‘ç»œåŒ…ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>æº IP å’Œç›®æ ‡ IP å§‹ç»ˆæ˜¯ä¸ä¼šå˜çš„ï¼Œä¸€ç›´å˜åŒ–çš„æ˜¯ MAC åœ°å€</strong>ï¼Œå› ä¸ºéœ€è¦ MAC åœ°å€åœ¨ä»¥å¤ªç½‘å†…è¿›è¡Œ<strong>ä¸¤ä¸ªè®¾å¤‡</strong>ä¹‹é—´çš„åŒ…ä¼ è¾“ã€‚</p><h1 id="è§£æåŒ…"><a class="markdownIt-Anchor" href="#è§£æåŒ…"></a> è§£æåŒ…</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201023164232.png" srcset="/img/loading.gif" alt="" /></p><p>æ•°æ®åŒ…æŠµè¾¾æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨ä¼šå…ˆè§£ææ•°æ®åŒ…çš„ <code>MAC å¤´éƒ¨</code>ï¼ŒæŸ¥çœ‹æ˜¯å¦å’ŒæœåŠ¡å™¨è‡ªå·±çš„ <code>MAC åœ°å€</code>ç¬¦åˆï¼Œç¬¦åˆå°±å°†åŒ…æ”¶èµ·æ¥ã€‚</p><p>æ¥ç€ç»§ç»­è§£ææ•°æ®åŒ…çš„ <code>IP å¤´</code>ï¼Œå‘ç° <code>IP</code> åœ°å€ç¬¦åˆï¼Œæ ¹æ® <code>IP</code> å¤´ä¸­<code>åè®®é¡¹</code>ï¼ŒçŸ¥é“è‡ªå·±ä¸Šå±‚æ˜¯ <code>TCP åè®®</code>ã€‚</p><p>äºæ˜¯ï¼Œè§£æ <code>TCP</code> çš„å¤´ï¼Œé‡Œé¢æœ‰<code>åºåˆ—å·</code>ï¼Œéœ€è¦çœ‹ä¸€çœ‹è¿™ä¸ªåºåˆ—åŒ…æ˜¯ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œå¦‚æœæ˜¯å°±æ”¾å…¥ç¼“å­˜ä¸­ç„¶åè¿”å›ä¸€ä¸ª <code>ACK</code>ï¼Œå¦‚æœä¸æ˜¯å°±ä¸¢å¼ƒã€‚<code>TCP</code> å¤´éƒ¨é‡Œé¢è¿˜æœ‰ç«¯å£å·ï¼Œ <code>HTTP</code> çš„æœåŠ¡å™¨æ­£åœ¨ç›‘å¬è¿™ä¸ªç«¯å£å·ã€‚</p><p>æœåŠ¡å™¨çš„ <code>HTTP</code> è¿›ç¨‹æŠŠå®¢æˆ·ç«¯çš„è¯·æ±‚æ•°æ®å°è£…åœ¨ <code>HTTP å“åº”æŠ¥æ–‡</code>é‡Œã€‚</p><p><code>HTTP å“åº”æŠ¥æ–‡</code>ä¹Ÿéœ€è¦åŠ ä¸Š <code>TCP</code>ã€<code>IP</code>ã€<code>MAC</code> å¤´éƒ¨ï¼Œä¸è¿‡è¿™æ¬¡æ˜¯æºåœ°å€æ˜¯<code>æœåŠ¡å™¨ IP åœ°å€</code>ï¼Œç›®çš„åœ°å€æ˜¯<code>å®¢æˆ·ç«¯ IP åœ°å€</code>ã€‚ä¹‹åé€šè¿‡ç›¸åŒçš„è¿‡ç¨‹å‘é€ç»™å®¢æˆ·ç«¯ã€‚æœ€åé€šè¿‡<strong>å››æ¬¡æŒ¥æ‰‹</strong>æ–­å¼€è¿æ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 763. åˆ’åˆ†å­—æ¯åŒºé—´</title>
    <link href="/2020/10/22/LeetCode-763-partition-labels/"/>
    <url>/2020/10/22/LeetCode-763-partition-labels/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/partition-labels/" target="_blank" rel="noopener">763. åˆ’åˆ†å­—æ¯åŒºé—´</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">partitionLabels</span><span class="hljs-params">(String S)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = S.length();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-keyword">char</span>[] str = S.toCharArray();    <span class="hljs-keyword">int</span>[] occur = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        occur[str[i] - <span class="hljs-string">'a'</span>] = i;    &#125;    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æ¯æ¬¡éå† [start, curWindowEnd]</span>    <span class="hljs-comment">// curWindowEnd è¡¨ç¤º start å¯¹åº”å­—æ¯çš„æœ€åå‡ºç°ä½ç½®</span>    <span class="hljs-comment">// å–åŒºé—´å†…æ¯ä¸ªå­—æ¯æœ€åå‡ºç°ä½ç½®çš„æœ€å¤§å€¼</span>    <span class="hljs-keyword">while</span> (start &lt; len) &#123;        <span class="hljs-keyword">int</span> curWindowEnd = occur[str[start] - <span class="hljs-string">'a'</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt; curWindowEnd; i++) &#123;            <span class="hljs-comment">// [start, curWindowEnd] åŒºé—´å†…å–å­—æ¯æœ€åå‡ºç°çš„ä½ç½®</span>            curWindowEnd = Math.max(curWindowEnd, occur[str[i] - <span class="hljs-string">'a'</span>]);        &#125;        res.add(curWindowEnd - start + <span class="hljs-number">1</span>);        <span class="hljs-comment">// ä¸‹ä¸€è½®ä½ç½®</span>        start = curWindowEnd + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 925. é•¿æŒ‰é”®å…¥</title>
    <link href="/2020/10/21/LeetCode-925-long-pressed-name/"/>
    <url>/2020/10/21/LeetCode-925-long-pressed-name/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/long-pressed-name/" target="_blank" rel="noopener">925. é•¿æŒ‰é”®å…¥</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isLongPressedName</span><span class="hljs-params">(String name, String typed)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] names = name.toCharArray();    <span class="hljs-keyword">char</span>[] types = typed.toCharArray();    <span class="hljs-keyword">int</span> len1 = names.length;    <span class="hljs-keyword">int</span> len2 = types.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; len1 &amp;&amp; j &lt; len2) &#123;        <span class="hljs-keyword">if</span> (names[i] == types[j]) &#123;            i++;            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå­—ç¬¦å°±ä¸ç›¸ç­‰</span>            <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-comment">// types[j] ä¸æ˜¯é•¿æŒ‰äº§ç”Ÿçš„</span>            <span class="hljs-keyword">boolean</span> jumped = <span class="hljs-keyword">false</span>;            <span class="hljs-keyword">while</span> (j &lt; len2 &amp;&amp; names[i - <span class="hljs-number">1</span>] == types[j]) &#123;                j++;                jumped = <span class="hljs-keyword">true</span>;            &#125;            <span class="hljs-keyword">if</span> (!jumped) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;    &#125;    <span class="hljs-comment">// types åé¢è¿˜æœ‰é‡å¤</span>    <span class="hljs-keyword">while</span> (j &lt; len2) &#123;        <span class="hljs-keyword">if</span> (types[j] != names[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        j++;    &#125;    <span class="hljs-keyword">return</span> i == len1 &amp;&amp; j == len2;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦</title>
    <link href="/2020/10/20/LeetCode-901-online-stock-span/"/>
    <url>/2020/10/20/LeetCode-901-online-stock-span/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/online-stock-span/" target="_blank" rel="noopener">901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StockSpanner</span> </span>&#123;    ArrayDeque&lt;Integer&gt; stack;    ArrayDeque&lt;Integer&gt; weights;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">StockSpanner</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// åŒæ­¥ä¿å­˜ price ä¹‹å‰æœ‰å¤šå°‘ä¸ªæ¯” price å°</span>        weights = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">next</span><span class="hljs-params">(<span class="hljs-keyword">int</span> price)</span> </span>&#123;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; price &gt;= stack.peek()) &#123;            <span class="hljs-comment">// æ¯” price ä½çš„å‡ºæ ˆ</span>            stack.pop();            <span class="hljs-comment">// åŠ ä¸Šå¯¹åº”çš„æ•°ç›®</span>            count += weights.pop();        &#125;        stack.push(price);        weights.push(count);        <span class="hljs-keyword">return</span> count;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II</title>
    <link href="/2020/10/20/LeetCode-503-next-greater-element-ii/"/>
    <url>/2020/10/20/LeetCode-503-next-greater-element-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/next-greater-element-ii/" target="_blank" rel="noopener">503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] nextGreaterElements(<span class="hljs-keyword">int</span>[] nums) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    Arrays.fill(res, -<span class="hljs-number">1</span>);    ArrayDeque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-comment">// ä¸¤å€é•¿åº¦éå†</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len * <span class="hljs-number">2</span>; i++) &#123;        <span class="hljs-keyword">int</span> j = i % len;        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; nums[j] &gt; nums[stack.peek()]) &#123;            res[stack.pop()] = nums[j];        &#125;        stack.push(j);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 143. é‡æ’é“¾è¡¨</title>
    <link href="/2020/10/20/LeetCode-143-reorder-list/"/>
    <url>/2020/10/20/LeetCode-143-reorder-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reorder-list/" target="_blank" rel="noopener">143. é‡æ’é“¾è¡¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reorderList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// 1 2 3 4 5  1 2 3  5 4  1 5 2 4 3</span>    ListNode slow = head;    ListNode fast = head;    <span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹</span>    <span class="hljs-keyword">while</span> (fast.next != <span class="hljs-keyword">null</span> &amp;&amp; fast.next.next != <span class="hljs-keyword">null</span>) &#123;        slow = slow.next;        fast = fast.next.next;    &#125;    ListNode newHead = slow.next;    slow.next = <span class="hljs-keyword">null</span>;    <span class="hljs-comment">// é€†è½¬é“¾è¡¨</span>    newHead = reverseList(newHead);    <span class="hljs-comment">// äº¤æ›¿æ’å…¥</span>    ListNode p = head;    ListNode q = newHead;    <span class="hljs-keyword">while</span> (p != <span class="hljs-keyword">null</span> &amp;&amp; q != <span class="hljs-keyword">null</span>) &#123;        ListNode t = p.next;        p.next = q;        ListNode t2 = q.next;        q.next = t;        p = t;        q = t2;    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> ListNode <span class="hljs-title">reverseList</span><span class="hljs-params">(ListNode head)</span> </span>&#123;    <span class="hljs-keyword">if</span> (head == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// 1 2 3 4 5 6 7</span>    ListNode cur = head.next;    ListNode newHead = head;    newHead.next = <span class="hljs-keyword">null</span>;    <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;        ListNode nextCur = cur.next;        cur.next = newHead;        newHead = cur;        cur = nextCur;    &#125;    <span class="hljs-keyword">return</span> newHead;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I</title>
    <link href="/2020/10/19/LeetCode-496-next-greater-element-i/"/>
    <url>/2020/10/19/LeetCode-496-next-greater-element-i/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/next-greater-element-i/" target="_blank" rel="noopener">496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] nextGreaterElement(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    ArrayDeque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums2) &#123;        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; num &gt; stack.peek()) &#123;            <span class="hljs-keyword">int</span> top = stack.pop();            map.put(top, num);        &#125;        stack.push(num);    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[nums1.length];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums1.length; i++) &#123;        res[i] = map.getOrDefault(nums1[i], -<span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 739. æ¯æ—¥æ¸©åº¦</title>
    <link href="/2020/10/19/LeetCode-739-daily-temperatures/"/>
    <url>/2020/10/19/LeetCode-739-daily-temperatures/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/daily-temperatures/" target="_blank" rel="noopener">739. æ¯æ—¥æ¸©åº¦</a></p><h1 id="å•è°ƒæ ˆ"><a class="markdownIt-Anchor" href="#å•è°ƒæ ˆ"></a> å•è°ƒæ ˆ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] dailyTemperatures(<span class="hljs-keyword">int</span>[] T) &#123;    ArrayDeque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> len = T.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// å•è°ƒé€’å‡æ ˆ</span>        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; T[i] &gt; T[stack.peek()]) &#123;            <span class="hljs-keyword">int</span> top = stack.pop();            res[top] = i - top;        &#125;        stack.push(i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²</title>
    <link href="/2020/10/19/LeetCode-844-backspace-string-compare/"/>
    <url>/2020/10/19/LeetCode-844-backspace-string-compare/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/backspace-string-compare/" target="_blank" rel="noopener">844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²</a></p><h1 id="æ ˆ"><a class="markdownIt-Anchor" href="#æ ˆ"></a> æ ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">backspaceCompare</span><span class="hljs-params">(String S, String T)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] s = S.toCharArray();    <span class="hljs-keyword">char</span>[] t = T.toCharArray();    <span class="hljs-keyword">return</span> getString(s).equals(getString(t));&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getString</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] s)</span> </span>&#123;    ArrayDeque&lt;Character&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : s) &#123;        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">'#'</span>) &#123;            <span class="hljs-keyword">if</span> (!stack.isEmpty()) &#123;                stack.pop();            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            stack.push(c);        &#125;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        sb.append(stack.pop());    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">backspaceCompare</span><span class="hljs-params">(String S, String T)</span> </span>&#123;        <span class="hljs-keyword">char</span>[] s = S.toCharArray();        <span class="hljs-keyword">char</span>[] t = T.toCharArray();        <span class="hljs-keyword">int</span> i = s.length - <span class="hljs-number">1</span>, j = t.length - <span class="hljs-number">1</span>;        <span class="hljs-keyword">int</span> skipS = <span class="hljs-number">0</span>, skipT = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span> || j &gt;= <span class="hljs-number">0</span>) &#123;            <span class="hljs-comment">// æ¶ˆé™¤ s ä¸­çš„ `#`</span>            <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">'#'</span>) &#123;                    skipS++;                    i--;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// s[i] ä¸ºå­—æ¯</span>                    <span class="hljs-keyword">if</span> (skipS &gt; <span class="hljs-number">0</span>) &#123;                        skipS--;                        i--;                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-comment">// ä¸éœ€è¦è·³è¿‡ï¼Œæ¯”è¾ƒæ­¤æ—¶çš„ s[i]</span>                        <span class="hljs-keyword">break</span>;                    &#125;                &#125;            &#125;            <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">if</span> (t[j] == <span class="hljs-string">'#'</span>) &#123;                    skipT++;                    j--;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-keyword">if</span> (skipT &gt; <span class="hljs-number">0</span>) &#123;                        skipT--;                        j--;                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-keyword">break</span>;                    &#125;                &#125;            &#125;            <span class="hljs-comment">// æ¯”è¾ƒ s[i] t[j]</span>            <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªéå†ç»“æŸ</span>            <span class="hljs-keyword">if</span> ((i &lt; <span class="hljs-number">0</span> &amp;&amp; j &gt;= <span class="hljs-number">0</span>) || (i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &lt; <span class="hljs-number">0</span>)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-comment">// s, t éƒ½éå†ç»“æŸ</span>            <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">0</span> || j &lt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            <span class="hljs-keyword">if</span> (s[i] != t[j]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            i--;            j--;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1111. æœ‰æ•ˆæ‹¬å·çš„åµŒå¥—æ·±åº¦</title>
    <link href="/2020/10/18/LeetCode-1111-maximum-nesting-depth-of-two-valid-parentheses-strings/"/>
    <url>/2020/10/18/LeetCode-1111-maximum-nesting-depth-of-two-valid-parentheses-strings/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-nesting-depth-of-two-valid-parentheses-strings/" target="_blank" rel="noopener">1111. æœ‰æ•ˆæ‹¬å·çš„åµŒå¥—æ·±åº¦</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] maxDepthAfterSplit(String seq) &#123;    <span class="hljs-keyword">char</span>[] chars = seq.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span> depth = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// è¿ç»­çš„ `((` å°½é‡ä¸è¦åˆ†é…åœ¨åŒä¸€ç»„</span>        <span class="hljs-keyword">if</span> (chars[i] == <span class="hljs-string">'('</span>) &#123;            <span class="hljs-comment">// é‡åˆ° `(` åµŒå¥—æ·±åº¦æ‰å¢åŠ </span>            depth++;            <span class="hljs-comment">// æŒ‰å½“å‰åµŒå¥—æ·±åº¦æ ¹æ®å¥‡å¶æ•°åˆ†ç»„</span>            res[i] = depth % <span class="hljs-number">2</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// `)` ä¸æ ˆé¡¶çš„ `(` åˆ†é…åœ¨åŒä¸€ç»„</span>            res[i] = depth % <span class="hljs-number">2</span>;            <span class="hljs-comment">// å‡å°åµŒå¥—æ·±åº¦</span>            depth--;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹</title>
    <link href="/2020/10/18/LeetCode-19-remove-nth-node-from-end-of-list/"/>
    <url>/2020/10/18/LeetCode-19-remove-nth-node-from-end-of-list/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/" target="_blank" rel="noopener">19. åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(ListNode head, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    ListNode dummy = <span class="hljs-keyword">new</span> ListNode(-<span class="hljs-number">1</span>, head);    ListNode p = dummy, q = dummy;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (q.next != <span class="hljs-keyword">null</span>) &#123;        q = q.next;        <span class="hljs-keyword">if</span> (i == n) &#123;            p = p.next;        &#125; <span class="hljs-keyword">else</span> &#123;            i++;        &#125;    &#125;    <span class="hljs-keyword">if</span> (p.next != <span class="hljs-keyword">null</span>) &#123;        p.next = p.next.next;    &#125;    <span class="hljs-keyword">return</span> dummy.next;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 946. éªŒè¯æ ˆåºåˆ—</title>
    <link href="/2020/10/17/LeetCode-946-validate-stack-sequences/"/>
    <url>/2020/10/17/LeetCode-946-validate-stack-sequences/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/validate-stack-sequences/" target="_blank" rel="noopener">946. éªŒè¯æ ˆåºåˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">validateStackSequences</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] pushed, <span class="hljs-keyword">int</span>[] popped)</span> </span>&#123;    ArrayDeque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : pushed) &#123;        stack.push(num);        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; stack.peek() == popped[i]) &#123;            stack.pop();            i++;        &#125;    &#125;    <span class="hljs-keyword">return</span> stack.isEmpty();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 341. æ‰å¹³åŒ–åµŒå¥—åˆ—è¡¨è¿­ä»£å™¨</title>
    <link href="/2020/10/16/LeetCode-341-flatten-nested-list-iterator/"/>
    <url>/2020/10/16/LeetCode-341-flatten-nested-list-iterator/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/flatten-nested-list-iterator/" target="_blank" rel="noopener">341. æ‰å¹³åŒ–åµŒå¥—åˆ—è¡¨è¿­ä»£å™¨</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NestedIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;    <span class="hljs-keyword">private</span> ArrayDeque&lt;Integer&gt; deque;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">NestedIterator</span><span class="hljs-params">(List&lt;NestedInteger&gt; nestedList)</span> </span>&#123;        deque = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        flatten(nestedList, deque);    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> deque.pollFirst();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> !deque.isEmpty();    &#125;        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">flatten</span><span class="hljs-params">(List&lt;NestedInteger&gt; nestedList, Deque&lt;Integer&gt; deque)</span> </span>&#123;        <span class="hljs-keyword">for</span> (NestedInteger ni : nestedList) &#123;            <span class="hljs-keyword">if</span> (ni.isInteger()) &#123;                deque.addLast(ni.getInteger());            &#125; <span class="hljs-keyword">else</span> &#123;                flatten(ni.getList(), deque);            &#125;        &#125;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 316. å»é™¤é‡å¤å­—æ¯</title>
    <link href="/2020/10/16/LeetCode-316-remove-duplicate-letters/"/>
    <url>/2020/10/16/LeetCode-316-remove-duplicate-letters/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-duplicate-letters/" target="_blank" rel="noopener">316. å»é™¤é‡å¤å­—æ¯</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">removeDuplicateLetters</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] str = s.toCharArray();    <span class="hljs-comment">// è®¡ç®—æ‰€æœ‰å­—ç¬¦çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : str) &#123;        counts[c - <span class="hljs-string">'a'</span>]++;    &#125;    ArrayDeque&lt;Character&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : str) &#123;        <span class="hljs-keyword">if</span> (!stack.contains(c)) &#123;            <span class="hljs-comment">// c &lt; æ ˆé¡¶ &amp;&amp; æ ˆé¡¶çš„å‰©ä½™å‡ºç°æ¬¡æ•° &gt;= 1</span>            <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; c &lt; stack.peek() &amp;&amp; counts[stack.peek() - <span class="hljs-string">'a'</span>] &gt; <span class="hljs-number">0</span>) &#123;                stack.pop();            &#125;            stack.push(c);        &#125;        <span class="hljs-comment">// æ›´æ–°å‰©ä½™å‡ºç°æ¬¡æ•°</span>        counts[c - <span class="hljs-string">'a'</span>]--;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        sb.append(stack.pollLast());    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 402. ç§»æ‰Kä½æ•°å­—</title>
    <link href="/2020/10/16/LeetCode-402-remove-k-digits/"/>
    <url>/2020/10/16/LeetCode-402-remove-k-digits/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-k-digits/" target="_blank" rel="noopener">402. ç§»æ‰Kä½æ•°å­—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">removeKdigits</span><span class="hljs-params">(String num, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-comment">// "1432219" "10200" "10"</span>    <span class="hljs-keyword">char</span>[] nums = num.toCharArray();    ArrayDeque&lt;Character&gt; deque = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> dropped = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : nums) &#123;        <span class="hljs-comment">// å¯ä»¥ä¸¢å¼ƒ &amp;&amp; æ ˆé¡¶ &gt; current</span>        <span class="hljs-comment">// ä¸¢å¼ƒæ ˆé¡¶ï¼Œä½¿å¾—æ•´ä¸ªåºåˆ—å˜å° =&gt; é€’å¢æ ˆ</span>        <span class="hljs-keyword">while</span> (dropped &lt; k &amp;&amp; !deque.isEmpty() &amp;&amp; deque.peekLast() &gt; c) &#123;            dropped++;            deque.removeLast();        &#125;        deque.addLast(c);    &#125;    <span class="hljs-comment">// å»é™¤å‰å¯¼ 0</span>    <span class="hljs-keyword">while</span> (!deque.isEmpty() &amp;&amp; deque.peekFirst() == <span class="hljs-string">'0'</span>) &#123;        deque.removeFirst();    &#125;    <span class="hljs-comment">// å·²ä¸¢å¼ƒçš„æ•°å­—ä¸è¶³ k ä¸ª</span>    <span class="hljs-comment">// åˆ™ä¸¢å¼ƒé˜Ÿåˆ—åé¢çš„æ•°å­—</span>    <span class="hljs-keyword">while</span> (dropped &lt; k) &#123;        dropped++;        <span class="hljs-keyword">if</span> (deque.isEmpty()) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            deque.removeLast();        &#125;    &#125;    <span class="hljs-keyword">if</span> (deque.isEmpty()) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>;    &#125;    StringBuilder stringBuilder = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">while</span> (!deque.isEmpty()) &#123;        stringBuilder.append(deque.removeFirst());    &#125;    <span class="hljs-keyword">return</span> stringBuilder.toString();&#125;</code></pre><p>æ•°ç»„æ¨¡æ‹Ÿï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">removeKdigits</span><span class="hljs-params">(String num, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = num.length();    <span class="hljs-keyword">char</span>[] str = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[len];    <span class="hljs-keyword">char</span>[] nums = num.toCharArray();    <span class="hljs-comment">// right æŒ‡å‘ str çš„æœ‰æ•ˆä½ç½®</span>    <span class="hljs-keyword">int</span> right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : nums) &#123;        <span class="hljs-comment">// æ¨¡æ‹Ÿå•è°ƒé€’å¢æ ˆ</span>        <span class="hljs-keyword">while</span> (k &gt; <span class="hljs-number">0</span> &amp;&amp; right &gt; <span class="hljs-number">0</span> &amp;&amp; str[right - <span class="hljs-number">1</span>] &gt; c) &#123;            k--;            right--;        &#125;        str[right++] = c;    &#125;    <span class="hljs-comment">// åˆ é™¤ä½æ•°ä¸è¶³ k ä½</span>    <span class="hljs-keyword">while</span> (k-- &gt; <span class="hljs-number">0</span> &amp;&amp; right &gt; <span class="hljs-number">0</span>) &#123;        right--;    &#125;    <span class="hljs-comment">// åˆ é™¤å‰å¯¼ 0</span>    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; str[left] == <span class="hljs-string">'0'</span>) &#123;        left++;    &#125;    <span class="hljs-keyword">if</span> (right == left) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(str, left, right - left);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 284. é¡¶ç«¯è¿­ä»£å™¨</title>
    <link href="/2020/10/16/LeetCode-284-peeking-iterator/"/>
    <url>/2020/10/16/LeetCode-284-peeking-iterator/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/peeking-iterator/" target="_blank" rel="noopener">284. é¡¶ç«¯è¿­ä»£å™¨</a></p><h1 id="é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#é˜Ÿåˆ—"></a> é˜Ÿåˆ—</h1><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PeekingIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;    <span class="hljs-keyword">private</span> LinkedList&lt;Integer&gt; queue;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PeekingIterator</span><span class="hljs-params">(Iterator&lt;Integer&gt; iterator)</span> </span>&#123;        <span class="hljs-comment">// initialize any member here.</span>        queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        <span class="hljs-comment">// æŠŠ iterator ä¸­çš„æ‰€æœ‰å…ƒç´ æ”¾åˆ°é˜Ÿåˆ—ä¸­</span>        <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;            queue.add(iterator.next());        &#125;    &#125;    <span class="hljs-comment">// Returns the next element in the iteration without advancing the iterator.</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">peek</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> queue.peek();    &#125;    <span class="hljs-comment">// hasNext() and next() should behave the same as in the Iterator interface.</span>    <span class="hljs-comment">// Override them if needed.</span>    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> queue.poll();    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> !queue.isEmpty();    &#125;&#125;</code></pre><h1 id="ç¼“å­˜-top"><a class="markdownIt-Anchor" href="#ç¼“å­˜-top"></a> ç¼“å­˜ top</h1><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PeekingIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">Integer</span>&gt; </span>&#123;    Iterator&lt;Integer&gt; iter;    Integer top;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PeekingIterator</span><span class="hljs-params">(Iterator&lt;Integer&gt; iterator)</span> </span>&#123;        <span class="hljs-comment">// initialize any member here.</span>        iter = iterator;        <span class="hljs-comment">// top != null è¡¨ç¤ºå·²ç»è°ƒç”¨è¿‡ peek()ï¼Œtop å°±æ˜¯ iterator çš„é¡¶éƒ¨å…ƒç´ </span>        <span class="hljs-comment">// top == null è¡¨ç¤ºè¿˜æ²¡è°ƒç”¨è¿‡ peek()ï¼Œæ­¤æ—¶åº”è¯¥ä½¿ top = iterator çš„é¡¶éƒ¨å…ƒç´ </span>        top = <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">// Returns the next element in the iteration without advancing the iterator.</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">peek</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (top != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> top;        &#125;        <span class="hljs-comment">// top == nullï¼Œè¡¨ç¤ºè°ƒç”¨è¿‡äº† next()ï¼Œä½¿åŸæ¥çš„ top ä¸¢å¤±äº†</span>        top = iter.next();        <span class="hljs-keyword">return</span> top;    &#125;    <span class="hljs-comment">// hasNext() and next() should behave the same as in the Iterator interface.</span>    <span class="hljs-comment">// Override them if needed.</span>    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">if</span> (top == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> iter.next();        &#125;        <span class="hljs-comment">// åŸæ¥çš„ top å·²ç»åœ¨ peek() çš„æ—¶å€™åˆ é™¤äº†</span>        <span class="hljs-comment">// è¿™æ—¶ä¸èƒ½å†è°ƒç”¨ next()</span>        <span class="hljs-keyword">int</span> res = top;        <span class="hljs-comment">// æ–°çš„ top æ­¤æ—¶è¿˜æ²¡æ›´æ–°ï¼Œè¦ç”± peek() èµ‹å€¼</span>        top = <span class="hljs-keyword">null</span>;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> top != <span class="hljs-keyword">null</span> &amp;&amp; iter.hasNext();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 977. æœ‰åºæ•°ç»„çš„å¹³æ–¹</title>
    <link href="/2020/10/16/LeetCode-977-squares-of-a-sorted-array/"/>
    <url>/2020/10/16/LeetCode-977-squares-of-a-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/squares-of-a-sorted-array/" target="_blank" rel="noopener">977. æœ‰åºæ•°ç»„çš„å¹³æ–¹</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortedSquares(<span class="hljs-keyword">int</span>[] A) &#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span> i = right;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">int</span> l = A[left] * A[left];        <span class="hljs-keyword">int</span> r = A[right] * A[right];        <span class="hljs-keyword">if</span> (l &gt; r) &#123;            res[i] = l;            left++;        &#125; <span class="hljs-keyword">else</span> &#123;            res[i] = r;            right--;        &#125;        i--;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 116. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ</title>
    <link href="/2020/10/15/LeetCode-116-populating-next-right-pointers-in-each-node/"/>
    <url>/2020/10/15/LeetCode-116-populating-next-right-pointers-in-each-node/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node/" target="_blank" rel="noopener">116. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">connect</span><span class="hljs-params">(Node root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;    &#125;    Node levelStart = root;    <span class="hljs-keyword">while</span> (levelStart.left != <span class="hljs-keyword">null</span>) &#123;        Node cur = levelStart;        <span class="hljs-keyword">while</span> (cur != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-comment">// å­èŠ‚ç‚¹è¿æ¥ï¼Œåªè¦ left å­˜åœ¨ï¼Œright ä¸€å®šå­˜åœ¨</span>            cur.left.next = cur.right;            <span class="hljs-comment">// å‘å³è¿æ¥</span>            <span class="hljs-keyword">if</span> (cur.next != <span class="hljs-keyword">null</span>) &#123;                cur.right.next = cur.next.left;            &#125;            <span class="hljs-comment">// æ¨ªå‘è¿æ¥</span>            cur = cur.next;        &#125;        <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€å±‚</span>        levelStart = levelStart.left;    &#125;    <span class="hljs-keyword">return</span> root;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 232. ç”¨æ ˆå®ç°é˜Ÿåˆ—</title>
    <link href="/2020/10/15/LeetCode-232-implement-queue-using-stacks/"/>
    <url>/2020/10/15/LeetCode-232-implement-queue-using-stacks/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/implement-queue-using-stacks/" target="_blank" rel="noopener">232. ç”¨æ ˆå®ç°é˜Ÿåˆ—</a></p><p>ä¸€ä¸ªæ ˆç”¨æ¥å…¥æ ˆï¼Œä¸€ä¸ªæ ˆç”¨æ¥å‡ºæ ˆï¼Œ<code>pop()</code> æˆ– <code>peek()</code> æ—¶è¿”å›å‡ºæ ˆçš„æ ˆé¡¶ï¼Œè‹¥å‡ºæ ˆä¸ºç©ºï¼Œå°†å…¥æ ˆçš„æ‰€æœ‰å…ƒç´ å‹å…¥å‡ºæ ˆã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyQueue</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç”¨äºå…¥æ ˆ</span><span class="hljs-comment">     */</span>    ArrayDeque&lt;Integer&gt; addStack;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç”¨äºå‡ºæ ˆï¼ˆå‡ºé˜Ÿï¼‰</span><span class="hljs-comment">     */</span>    ArrayDeque&lt;Integer&gt; popStack;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyQueue</span><span class="hljs-params">()</span> </span>&#123;        addStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        popStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Push element x to the back of queue.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;        addStack.push(x);    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Removes the element from in front of queue and returns that element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// è‹¥ popStack ä¸ºç©ºï¼Œåˆ™å°† addStack çš„æ‰€æœ‰å…ƒç´ å‹å…¥ popStack</span>        <span class="hljs-keyword">if</span> (popStack.isEmpty()) &#123;            <span class="hljs-keyword">int</span> size = addStack.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">int</span> top = addStack.pop();                popStack.push(top);            &#125;        &#125;        <span class="hljs-comment">// æ ˆé¡¶å³ä¸ºé˜Ÿå¤´</span>        <span class="hljs-keyword">return</span> popStack.pop();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the front element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">peek</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// è‹¥ popStack ä¸ºç©ºï¼Œåˆ™å°† addStack çš„æ‰€æœ‰å…ƒç´ å‹å…¥ popStack</span>        <span class="hljs-keyword">if</span> (popStack.isEmpty()) &#123;            <span class="hljs-keyword">int</span> size = addStack.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">int</span> top = addStack.pop();                popStack.push(top);            &#125;        &#125;        <span class="hljs-comment">// æ ˆé¡¶å³ä¸ºé˜Ÿå¤´</span>        <span class="hljs-keyword">return</span> popStack.peek();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Returns whether the queue is empty.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> addStack.isEmpty() &amp;&amp; popStack.isEmpty();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ</title>
    <link href="/2020/10/15/LeetCode-225-implement-stack-using-queues/"/>
    <url>/2020/10/15/LeetCode-225-implement-stack-using-queues/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/implement-stack-using-queues/" target="_blank" rel="noopener">225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ</a></p><p><code>pop()</code> å’Œ <code>top()</code> æ—¶å°†é˜Ÿå¤´é‡æ–°åŠ å…¥é˜Ÿå°¾</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyStack</span> </span>&#123;    ArrayDeque&lt;Integer&gt; queue;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyStack</span><span class="hljs-params">()</span> </span>&#123;        queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Push element x onto stack.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;        queue.addLast(x);    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Removes the element on top of the stack and returns that element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// size - 1 ä¸ªå…ƒç´ å…¥é˜Ÿï¼Œé˜Ÿå°¾å‡ºæ ˆ</span>        <span class="hljs-keyword">int</span> size = queue.size() - <span class="hljs-number">1</span>;        <span class="hljs-keyword">int</span> front = -<span class="hljs-number">1</span>;        <span class="hljs-comment">// é˜Ÿå¤´å‡ºé˜ŸåŠ å…¥é˜Ÿå°¾ï¼ŒåŸæ¥çš„é˜Ÿå°¾å³ä¸ºæ ˆé¡¶</span>        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            front = queue.pollFirst();            queue.addLast(front);        &#125;        <span class="hljs-comment">// æ ˆé¡¶å‡ºæ ˆ</span>        <span class="hljs-keyword">return</span> queue.pollFirst();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Get the top element.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">top</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// æ‰€æœ‰å…ƒç´ é‡æ–°å…¥é˜Ÿ</span>        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">int</span> front = -<span class="hljs-number">1</span>;        <span class="hljs-comment">// é˜Ÿå¤´å‡ºé˜ŸåŠ å…¥é˜Ÿå°¾ï¼ŒåŸæ¥çš„é˜Ÿå°¾å³ä¸ºæ ˆé¡¶</span>        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            front = queue.pollFirst();            queue.addLast(front);        &#125;        <span class="hljs-keyword">return</span> front;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Returns whether the stack is empty.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> queue.isEmpty();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 155. æœ€å°æ ˆ</title>
    <link href="/2020/10/15/LeetCode-155-min-stack/"/>
    <url>/2020/10/15/LeetCode-155-min-stack/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/min-stack/" target="_blank" rel="noopener">155. æœ€å°æ ˆ</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MinStack</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å­˜å‚¨å®é™…çš„æ ˆå…ƒç´ </span><span class="hljs-comment">     */</span>    ArrayDeque&lt;Integer&gt; dataStack;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å­˜å‚¨æœ€å°å€¼</span><span class="hljs-comment">     */</span>    ArrayDeque&lt;Integer&gt; minStack;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MinStack</span><span class="hljs-params">()</span> </span>&#123;        dataStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        minStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;        dataStack.push(x);        <span class="hljs-comment">// å…¥æ ˆå…ƒç´  &lt;= minï¼Œåˆ™åŠ å…¥æœ€å°æ ˆ</span>        <span class="hljs-keyword">if</span> (!minStack.isEmpty()) &#123;            <span class="hljs-keyword">if</span> (x &lt;= getMin()) &#123;                minStack.push(x);            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            minStack.push(x);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">int</span> top = dataStack.pop();        <span class="hljs-comment">// å‡ºæ ˆå…ƒç´ å³ä¸ºæœ€å°å€¼ï¼Œæ›´æ–°æœ€å°å€¼</span>        <span class="hljs-keyword">if</span> (top == getMin()) &#123;            minStack.pop();        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">top</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> dataStack.peek();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getMin</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> minStack.peek();    &#125;&#125;</code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 71. ç®€åŒ–è·¯å¾„</title>
    <link href="/2020/10/15/LeetCode-71-simplify-path/"/>
    <url>/2020/10/15/LeetCode-71-simplify-path/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/simplify-path/" target="_blank" rel="noopener">71. ç®€åŒ–è·¯å¾„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">simplifyPath</span><span class="hljs-params">(String path)</span> </span>&#123;    ArrayDeque&lt;String&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">int</span> len = path.length();    <span class="hljs-comment">// å¤šåˆ†é…ä¸€ä¸ªç©ºé—´ï¼Œå¤„ç†ä¸æ˜¯ä»¥ '/' ç»“å°¾çš„æƒ…å†µ</span>    <span class="hljs-keyword">char</span>[] str = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[len + <span class="hljs-number">1</span>];    System.arraycopy(path.toCharArray(), <span class="hljs-number">0</span>, str, <span class="hljs-number">0</span>, len);    <span class="hljs-comment">// å°¾éƒ¨å¤šåˆ†é… '/'</span>    str[len] = <span class="hljs-string">'/'</span>;    stack.push(<span class="hljs-string">""</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        <span class="hljs-keyword">if</span> (str[i] == <span class="hljs-string">'/'</span>) &#123;            String folder = sb.toString();            sb.setLength(<span class="hljs-number">0</span>);            <span class="hljs-comment">// 0 æˆ– 1 ä¸ª '.' è¿˜åœ¨å½“å‰ç›®å½•</span>            <span class="hljs-keyword">if</span> (<span class="hljs-string">""</span>.equals(folder) || <span class="hljs-string">"."</span>.equals(folder)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// 2 ä¸ªç‚¹è¿”å›ä¸Šä¸€çº§ç›®å½•</span>            <span class="hljs-keyword">if</span> (<span class="hljs-string">".."</span>.equals(folder)) &#123;                <span class="hljs-comment">// å½“å‰ç›®å½•ä¸æ˜¯æ ¹ç›®å½•æ‰å¯è¿”å›ä¸Šä¸€çº§</span>                <span class="hljs-keyword">if</span> (!<span class="hljs-string">""</span>.equals(stack.peek())) &#123;                    stack.pop();                &#125;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€çº§ç›®å½•</span>                stack.push(folder);            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            sb.append(str[i]);        &#125;    &#125;    List&lt;String&gt; folders = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        folders.add(stack.pop());    &#125;    <span class="hljs-comment">// ç›®å½•é•¿åº¦ == 1ï¼Œæ­¤æ—¶åªæœ‰æ ¹ç›®å½• = ''</span>    <span class="hljs-keyword">if</span> (folders.size() &gt; <span class="hljs-number">1</span>) &#123;        folders.remove(folders.size() - <span class="hljs-number">1</span>);    &#125;    Collections.reverse(folders);    sb.setLength(<span class="hljs-number">0</span>);    <span class="hljs-keyword">for</span> (String folder : folders) &#123;        sb.append(<span class="hljs-string">"/"</span>);        sb.append(folder);    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TCP/IP åŸºç¡€</title>
    <link href="/2020/10/15/network-TCP-IP-basic/"/>
    <url>/2020/10/15/network-TCP-IP-basic/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘ç»œåŸºç¡€çŸ¥è¯†"><a class="markdownIt-Anchor" href="#ç½‘ç»œåŸºç¡€çŸ¥è¯†"></a> ç½‘ç»œåŸºç¡€çŸ¥è¯†</h1><h2 id="osi-å‚è€ƒæ¨¡å‹"><a class="markdownIt-Anchor" href="#osi-å‚è€ƒæ¨¡å‹"></a> OSI å‚è€ƒæ¨¡å‹</h2><ol><li>åº”ç”¨å±‚ï¼šé’ˆå¯¹ç‰¹å®šåº”ç”¨çš„åè®®ï¼Œå¦‚ç”µå­é‚®ä»¶ï¼Œè¿œç¨‹ç™»å½•ï¼Œæ–‡ä»¶ä¼ è¾“ã€‚</li><li>è¡¨ç¤ºå±‚ï¼šæ¥æ”¶ä¸åŒè¡¨ç°å½¢å¼çš„ä¿¡æ¯ï¼Œå¦‚æ–‡å­—ï¼Œå›¾åƒï¼Œå£°éŸ³ã€‚</li><li>ä¼šè¯å±‚ï¼šé€šä¿¡ç®¡ç†ï¼Œç®¡ç†ä¼ è¾“å±‚ä»¥ä¸‹çš„åˆ†å±‚ã€‚</li><li>ä¼ è¾“å±‚ï¼šè´Ÿè´£<strong>ç«¯åˆ°ç«¯çš„å¯é æ€§ä¼ è¾“</strong>ã€‚</li><li>ç½‘ç»œå±‚ï¼š<strong>åœ°å€ç®¡ç†ä¸è·¯ç”±é€‰æ‹©</strong>ã€‚</li><li>æ•°æ®é“¾è·¯å±‚ï¼šäº’è¿è®¾å¤‡ä¹‹é—´ä¼ é€æ•°æ®å¸§ã€‚</li><li>ç‰©ç†å±‚ï¼šæ¯”ç‰¹æµä¸ç”µä¿¡å·ä¹‹é—´çš„è½¬æ¢ã€‚</li></ol><h2 id="ä¼ è¾“æ–¹å¼"><a class="markdownIt-Anchor" href="#ä¼ è¾“æ–¹å¼"></a> ä¼ è¾“æ–¹å¼</h2><h3 id="1-é¢å‘è¿æ¥å‹ä¸é¢å‘æ— è¿æ¥å‹"><a class="markdownIt-Anchor" href="#1-é¢å‘è¿æ¥å‹ä¸é¢å‘æ— è¿æ¥å‹"></a> 1. é¢å‘è¿æ¥å‹ä¸é¢å‘æ— è¿æ¥å‹</h3><ul><li>åœ¨é¢å‘æœ‰è¿æ¥çš„æ–¹å¼ä¸‹ï¼Œå¿…é¡»åœ¨é€šä¿¡ä¼ è¾“å‰åï¼Œä¸“é—¨è¿›è¡Œå»ºç«‹å’Œæ–­å¼€è¿æ¥çš„å¤„ç†ã€‚</li><li>åœ¨é¢å‘æ— è¿æ¥çš„æ–¹å¼ä¸‹ï¼Œå‘é€ç«¯å¯äºä»»ä½•æ—¶å€™è‡ªç”±å‘é€æ•°æ®ã€‚ä¸éœ€è¦ç¡®è®¤å¯¹ç«¯æ˜¯å¦å­˜åœ¨ï¼Œå³ä½¿æ¥æ”¶ç«¯ä¸å­˜åœ¨æˆ–æ— æ³•æ¥å—æ•°æ®ï¼Œå‘é€ç«¯ä¹Ÿèƒ½å°†æ•°æ®å‘é€å‡ºå»ã€‚</li></ul><h3 id="2-ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"><a class="markdownIt-Anchor" href="#2-ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢"></a> 2. ç”µè·¯äº¤æ¢ä¸åˆ†ç»„äº¤æ¢</h3><ul><li>ç”µè·¯äº¤æ¢ä¸­ï¼Œä¸¤å°è®¡ç®—æœºç‹¬å çº¿è·¯è¿›è¡Œä¼ è¾“ï¼Œå…¶ä»–è®¡ç®—æœºåªèƒ½ç­‰çº¿è·¯ç©ºé—²åæ‰èƒ½ä½¿ç”¨è¿™æ¡ç”µè·¯è¿›è¡Œé€šä¿¡ã€‚</li><li>åˆ†ç»„äº¤æ¢ä¸­ï¼ŒæŠŠæ•°æ®åˆ†æˆå¤šä¸ªæ•°æ®åŒ…ï¼ŒæŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—ä¹‹åè¿›è¡Œå‘é€ã€‚æ¯ä¸ªåˆ†ç»„çš„é¦–éƒ¨å†™å…¥å‘é€ç«¯å’Œæ¥æ”¶ç«¯çš„åœ°å€ï¼Œæ‰€ä»¥å³ä½¿åŒä¸€æ¡çº¿è·¯åŒæ—¶ä¸ºå¤šä¸ªç”¨æˆ·æä¾›æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ˜ç¡®æ¯ä¸ªåˆ†ç»„æ•°æ®çš„ç›®çš„åœ°ã€‚</li></ul><h3 id="3-æ ¹æ®æ¥æ”¶ç«¯æ•°é‡åˆ†ç±»"><a class="markdownIt-Anchor" href="#3-æ ¹æ®æ¥æ”¶ç«¯æ•°é‡åˆ†ç±»"></a> 3. æ ¹æ®æ¥æ”¶ç«¯æ•°é‡åˆ†ç±»</h3><ol><li>å•æ’­ï¼šä¸€å¯¹ä¸€é€šä¿¡ã€‚</li><li>å¹¿æ’­ï¼šå°†æ¶ˆæ¯ä»ä¸€å°ä¸»æœºå‘é€ç»™ä¸ä¹‹ç›¸è¿çš„<strong>æ‰€æœ‰å…¶ä»–ä¸»æœº</strong>ã€‚</li><li>å¤šæ’­ï¼šå°†æ¶ˆæ¯ä»ä¸€å°ä¸»æœºå‘é€ç»™<strong>æŸä¸€ç»„ä¸»æœº</strong>ã€‚</li><li>ä»»æ’­ï¼šåœ¨ç‰¹å®šçš„å¤šå°ä¸»æœºä¸­é€‰å‡ºä¸€å°ä½œä¸ºæ¥æ”¶ç«¯è¿›è¡Œé€šä¿¡ã€‚</li></ol><h2 id="å„å±‚ç½‘ç»œè®¾å¤‡"><a class="markdownIt-Anchor" href="#å„å±‚ç½‘ç»œè®¾å¤‡"></a> å„å±‚ç½‘ç»œè®¾å¤‡</h2><ul><li>ä¸­ç»§å™¨ï¼ˆ<code>Repeater</code>ï¼‰ï¼šä»ç‰©ç†å±‚ä¸Šå»¶é•¿ç½‘ç»œã€‚</li><li>ç½‘æ¡¥ï¼ˆ<code>Bridge</code>ï¼‰/ 2 å±‚äº¤æ¢æœºï¼šä»æ•°æ®é“¾è·¯å±‚ä¸Šå»¶é•¿ç½‘ç»œã€‚</li><li>è·¯ç”±å™¨ï¼ˆ<code>Router</code>ï¼‰/ 3 å±‚äº¤æ¢æœºï¼šä»ç½‘ç»œå±‚è½¬å‘åˆ†ç»„æ•°æ®çš„è®¾å¤‡ã€‚</li><li>4 ~ 7 å±‚äº¤æ¢æœºï¼šå¤„ç†ä¼ è¾“å±‚ä»¥ä¸Šå„å±‚ç½‘ç»œä¼ è¾“çš„è®¾å¤‡ã€‚</li><li>ç½‘å…³ï¼ˆ<code>Gageway</code>ï¼‰ï¼šè½¬æ¢åè®®çš„è®¾å¤‡ã€‚</li></ul><h2 id="è·¯ç”±å™¨å’Œäº¤æ¢æœºçš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨å’Œäº¤æ¢æœºçš„åŒºåˆ«"></a> è·¯ç”±å™¨å’Œäº¤æ¢æœºçš„åŒºåˆ«</h2><ul><li>äº¤æ¢æœºä¸»è¦å·¥ä½œåœ¨<strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼›<br />è·¯ç”±å™¨å·¥ä½œåœ¨<strong>ç½‘ç»œå±‚</strong>ã€‚</li><li>äº¤æ¢æœºè½¬å‘æ‰€ä¾æ®çš„å¯¹è±¡æ—¶ï¼š<code>MAC</code> åœ°å€ã€‚ï¼ˆç‰©ç†åœ°å€ï¼‰ï¼›<br />è·¯ç”±è½¬å‘æ‰€ä¾æ®çš„å¯¹è±¡æ˜¯ï¼š<code>IP</code> åœ°å€ã€‚ï¼ˆç½‘ç»œåœ°å€ï¼‰ã€‚</li><li>äº¤æ¢æœºä¸»è¦ç”¨äºç»„å»ºå±€åŸŸç½‘ï¼›<br />è·¯ç”±å™¨å°†å±€åŸŸç½‘è¿æ¥èµ·æ¥ï¼Œæˆ–è€…æ¥å…¥äº’è”ç½‘ã€‚</li><li>è·¯ç”±å™¨å®ç°äº†<strong>ä¸åŒç½‘ç»œ</strong>ä¹‹é—´çš„æ•°æ®<strong>è½¬å‘</strong>ï¼›<br />äº¤æ¢æœºå®ç°äº†<strong>ç‰¹å®šç½‘ç»œ</strong>å†…çš„æ•°æ®<strong>äº¤æ¢</strong>ã€‚</li><li>è·¯ç”±å™¨æ˜¯åŸºäº <code>IP</code> è®¾è®¡çš„ï¼Œä¿—ç§°ä¸‰å±‚ç½‘ç»œè®¾å¤‡ï¼Œè·¯ç”±å™¨çš„å„ä¸ªç«¯å£éƒ½<strong>å…·æœ‰ MAC åœ°å€å’Œ IP åœ°å€</strong>ï¼›</li><li>è€Œäº¤æ¢æœºæ˜¯åŸºäº<code>ä»¥å¤ªç½‘</code>è®¾è®¡çš„ï¼Œä¿—ç§°äºŒå±‚ç½‘ç»œè®¾å¤‡ï¼Œ<strong>äº¤æ¢æœºçš„ç«¯å£ä¸å…·æœ‰ MAC åœ°å€</strong>ã€‚</li></ul><h1 id="tcpip-åŸºç¡€çŸ¥è¯†"><a class="markdownIt-Anchor" href="#tcpip-åŸºç¡€çŸ¥è¯†"></a> TCP/IP åŸºç¡€çŸ¥è¯†</h1><h2 id="tcpip-å…·ä½“å«ä¹‰"><a class="markdownIt-Anchor" href="#tcpip-å…·ä½“å«ä¹‰"></a> TCP/IP å…·ä½“å«ä¹‰</h2><p>TCP/IP æ˜¯åè®®ç¾¤çš„ç»Ÿç§°ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºç½‘é™…åè®®æ—ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201015144631.png" srcset="/img/loading.gif" alt="" /></p><h2 id="tcpip-ä¸-osi-å‚è€ƒæ¨¡å‹"><a class="markdownIt-Anchor" href="#tcpip-ä¸-osi-å‚è€ƒæ¨¡å‹"></a> TCP/IP ä¸ OSI å‚è€ƒæ¨¡å‹</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201015144926.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ•°æ®åŒ…å¤„ç†"><a class="markdownIt-Anchor" href="#æ•°æ®åŒ…å¤„ç†"></a> æ•°æ®åŒ…å¤„ç†</h2><p>æ¯ä¸€ä¸ªåˆ†å±‚ä¸­ï¼Œéƒ½ä¼šå¯¹æ‰€å‘é€çš„æ•°æ®é™„åŠ ä¸€ä¸ªé¦–éƒ¨ï¼Œåœ¨è¿™ä¸ªé¦–éƒ¨ä¸­åŒ…å«äº†è¯¥å±‚å¿…è¦çš„ä¿¡æ¯ã€‚æ¯ä¸ªåŒ…é¦–éƒ¨ä¸­è‡³å°‘ä¼šåŒ…å«ä¸¤ä¸ªä¿¡æ¯ï¼šä¸€ä¸ªæ˜¯å‘é€ç«¯å’Œæ¥æ”¶ç«¯åœ°å€ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸Šä¸€å±‚çš„åè®®ç±»å‹ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201015145629.png" srcset="/img/loading.gif" alt="" /></p><h1 id="æ•°æ®é“¾è·¯"><a class="markdownIt-Anchor" href="#æ•°æ®é“¾è·¯"></a> æ•°æ®é“¾è·¯</h1><h2 id="mac-åœ°å€ä¸-ip-åœ°å€"><a class="markdownIt-Anchor" href="#mac-åœ°å€ä¸-ip-åœ°å€"></a> MAC åœ°å€ä¸ IP åœ°å€</h2><ul><li><code>MAC</code> åœ°å€ï¼ˆæ•°æ®é“¾è·¯å±‚ï¼‰ç”¨äºè¯†åˆ«æ•°æ®é“¾è·¯ä¸­äº’è¿çš„èŠ‚ç‚¹ã€‚</li><li><code>IP</code> åœ°å€ï¼ˆç½‘ç»œå±‚ï¼‰ç”¨äºåœ¨è¿æ¥åˆ°ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºä¸­è¯†åˆ«å‡ºè¿›è¡Œé€šä¿¡çš„ç›®æ ‡åœ°å€ã€‚</li></ul><p>MAC åœ°å€æ ¼å¼ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201015151427.png" srcset="/img/loading.gif" alt="" /></p><p><strong>MAC åœ°å€ä¸ä¸€å®šæ˜¯å”¯ä¸€çš„ã€‚</strong><br />å³ä½¿ MAC åœ°å€ ç›¸åŒï¼Œåªè¦ä¸æ˜¯åŒå±ä¸€ä¸ªæ•°æ®é“¾è·¯å°±æ²¡é—®é¢˜ã€‚å¦‚è™šæ‹Ÿæœºåˆ†é…çš„è™šæ‹Ÿç½‘å¡ï¼Œå¾ˆéš¾ä¿è¯ MAC åœ°å€çš„å”¯ä¸€æ€§ã€‚</p><h2 id="å…±äº«ä»‹è´¨å‹ç½‘ç»œ"><a class="markdownIt-Anchor" href="#å…±äº«ä»‹è´¨å‹ç½‘ç»œ"></a> å…±äº«ä»‹è´¨å‹ç½‘ç»œ</h2><p>å…±äº«ä»‹è´¨å‹ç½‘ç»œæŒ‡ç”±å¤šä¸ªè®¾å¤‡å…±äº«ä¸€ä¸ªé€šä¿¡ä»‹è´¨çš„ä¸€ç§ç½‘ç»œã€‚</p><ul><li>è®¾å¤‡ä¹‹é—´ä½¿ç”¨<strong>åŒä¸€ä¸ªä¿¡é“è¿›è¡Œå‘é€å’Œæ¥æ”¶ã€‚</strong></li><li>åŸºæœ¬ä¸Šé‡‡ç”¨<strong>åŠåŒå·¥é€šä¿¡</strong>æ–¹å¼ã€‚</li><li>éœ€è¦å¯¹ä»‹è´¨è¿›è¡Œ<strong>è®¿é—®æ§åˆ¶</strong>ã€‚</li></ul><blockquote><p>åŠåŒå·¥ï¼šå…±äº«ä»‹è´¨ï¼Œåªå‘é€æˆ–åªæ¥å—çš„é€šä¿¡æ–¹å¼ã€‚<br />å…¨åŒå·¥ï¼šä¸“ç”¨ä»‹è´¨ï¼Œå¯ä»¥åŒæ—¶å‘é€æ•°æ®å’Œæ¥æ”¶æ•°æ®ã€‚</p></blockquote><p>ä»‹è´¨è®¿é—®æ§åˆ¶æ–¹å¼ï¼š</p><ol><li>äº‰ç”¨æ–¹å¼ï¼ˆ<code>Contention</code>ï¼‰ï¼šæŒ‡çš„æ˜¯äº‰å¤ºè·å–æ•°æ®ä¼ è¾“çš„æ–¹å¼ã€‚è¿™ç§æ–¹æ³•é€šå¸¸ä»¤ç½‘ç»œä¸­çš„å„ä¸ªç«™é‡‡ç”¨<strong>å…ˆåˆ°å…ˆå¾—</strong>çš„æ–¹å¼å ç”¨ä¿¡é“å‘é€æ•°æ®ã€‚</li><li>ä»¤ç‰Œä¼ é€’æ–¹å¼ï¼šåªæœ‰è·å¾—ä»¤ç‰Œçš„ç«™æ‰èƒ½å‘é€æ•°æ®ã€‚ç‰¹ç‚¹æ˜¯<strong>ä¸ä¼šæœ‰å†²çªï¼Œæ¯ä¸ªç«™éƒ½æœ‰é€šè¿‡å¹³ç­‰å¾ªç¯è·å¾—ä»¤ç‰Œçš„æ–¹å¼ã€‚</strong></li></ol><h2 id="éå…±äº«ä»‹è´¨å‹ç½‘ç»œ"><a class="markdownIt-Anchor" href="#éå…±äº«ä»‹è´¨å‹ç½‘ç»œ"></a> éå…±äº«ä»‹è´¨å‹ç½‘ç»œ</h2><p>éå…±äº«ä»‹è´¨å‹ç½‘ç»œæ˜¯æŒ‡ä¸å…±äº«ä»‹è´¨ï¼Œæ˜¯å¯¹ä»‹è´¨é‡‡å–<strong>ä¸“ç”¨</strong>çš„ä¸€ç§ä¼ è¾“æ§åˆ¶æ–¹å¼ã€‚æ¯ä¸ªç«™ç›´è¿äº¤æ¢æœºï¼Œ<strong>ç”±äº¤æ¢æœºè´Ÿè´£è½¬å‘æ•°æ®å¸§</strong>ï¼Œé‡‡ç”¨<strong>å…¨åŒå·¥é€šä¿¡</strong>æ–¹å¼ã€‚</p><h1 id="ip-åè®®"><a class="markdownIt-Anchor" href="#ip-åè®®"></a> IP åè®®</h1><h2 id="åŸºç¡€çŸ¥è¯†"><a class="markdownIt-Anchor" href="#åŸºç¡€çŸ¥è¯†"></a> åŸºç¡€çŸ¥è¯†</h2><h3 id="ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»"><a class="markdownIt-Anchor" href="#ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»"></a> ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å…³ç³»</h3><ul><li><p>æ•°æ®é“¾è·¯å±‚æä¾›ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´çš„é€šä¿¡åŠŸèƒ½ï¼Œåœ¨<strong>äº’è¿åŒä¸€ç§æ•°æ®é“¾è·¯çš„èŠ‚ç‚¹ä¹‹é—´</strong>è¿›è¡ŒåŒ…ä¼ é€’ã€‚</p></li><li><p>ç½‘ç»œå±‚è´Ÿè´£åœ¨<strong>æ²¡æœ‰ç›´è¿çš„ä¸¤ä¸ªç½‘ç»œä¹‹é—´</strong>è¿›è¡Œé€šä¿¡ä¼ è¾“ã€‚ç½‘ç»œå±‚å¯ä»¥<strong>è·¨è¶Šä¸åŒçš„æ•°æ®é“¾è·¯</strong>ï¼Œåœ¨ä¸åŒçš„æ•°æ®é“¾è·¯ä¸Šä¹Ÿèƒ½å®ç°ä¸¤ç«¯èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒ…ä¼ è¾“ã€‚</p></li></ul><h3 id="è·¯ç”±æ§åˆ¶"><a class="markdownIt-Anchor" href="#è·¯ç”±æ§åˆ¶"></a> è·¯ç”±æ§åˆ¶</h3><p>è·¯ç”±æ§åˆ¶ï¼ˆ<code>Routing</code>ï¼‰æ˜¯æŒ‡å°†åˆ†ç»„æ•°æ®å‘é€åˆ°æœ€ç»ˆç›®æ ‡åœ°å€çš„åŠŸèƒ½ã€‚</p><p>IP è·¯ç”±ä¹Ÿå«å¤šè·³è·¯ç”±ï¼Œè·³ï¼ˆ<code>Hop</code>ï¼‰ æ˜¯æŒ‡ç½‘ç»œä¸­çš„ä¸€ä¸ªåŒºé—´ï¼Œåœ¨æ¯ä¸€ä¸ªåŒºé—´å†…å†³å®šç€ IP åŒ…åœ¨ä¸‹ä¸€è·³è¢«è½¬å‘çš„è·¯å¾„ã€‚<br /><strong>å¤šè·³è·¯ç”±</strong> æ˜¯æŒ‡è·¯ç”±å™¨æˆ–ä¸»æœºåœ¨è½¬å‘ IP æ•°æ®åŒ…æ—¶<strong>åªæŒ‡å®šä¸‹ä¸€ä¸ªè·¯ç”±å™¨æˆ–ä¸»æœº</strong>ï¼Œè€Œä¸æ˜¯å°†åˆ°æœ€ç»ˆç›®æ ‡åœ°å€ä¸ºæ­¢çš„æ‰€æœ‰é€šè·¯å…¨éƒ¨æŒ‡å®šå‡ºæ¥ã€‚å› ä¸ºæ¯ä¸€ä¸ªåŒºé—´ï¼ˆè·³ï¼‰åœ¨è½¬å‘ IP æ•°æ®åŒ…æ—¶ä¼šåˆ†åˆ«æŒ‡å®šä¸‹ä¸€è·³çš„æ“ä½œã€‚</p><p>ä¸ºäº†å°†æ•°æ®åŒ…å‘ç»™ç›®æ ‡ä¸»æœºï¼Œæ‰€æœ‰ä¸»æœºéƒ½ç»´æŠ¤ç€ä¸€å¼ è·¯ç”±æ§åˆ¶è¡¨ï¼ˆ<code>Routing Table</code>ï¼‰ã€‚è¯¥è¡¨è®°å½• IP æ•°æ®åœ¨ä¸‹ä¸€æ­¥åº”è¯¥å‘ç»™å“ªä¸ªè·¯ç”±å™¨ã€‚IP åŒ…å°†æ ¹æ®è·¯ç”±è¡¨åœ¨å„ä¸ªæ•°æ®é“¾è·¯ä¸Šä¼ è¾“ã€‚</p><h3 id="mtu"><a class="markdownIt-Anchor" href="#mtu"></a> MTU</h3><p>æ•°æ®é“¾è·¯çš„åœ°å€å¯ä»¥è¢«æŠ½è±¡ä¸º IP åœ°å€ï¼Œå¯¹ IP çš„ä¸Šä¸€å±‚æ¥è¯´ï¼Œä¸è®ºåº•å±‚æ•°æ®é“¾è·¯ä½¿ç”¨ä»¥å¤ªç½‘è¿˜æ˜¯æ— çº¿ LAN äº¦æˆ–æ˜¯ PPPï¼Œéƒ½å°†è¢«ä¸€è§†åŒä»ã€‚</p><p>ä¸åŒçš„æ•°æ®é“¾è·¯çš„æœ€å¤§åŒºåˆ«ï¼šå®ƒä»¬å„è‡ªçš„æœ€å¤§ä¼ è¾“å•ä½ï¼ˆ<code>MTU</code>ï¼‰ä¸åŒã€‚è€Œæˆ‘ä»¬éœ€è¦ä¼ è¾“æ¯” MTU æ›´å¤šå­—èŠ‚çš„æ•°æ®ï¼Œå°±éœ€è¦å¯¹ IP æ•°æ®åŒ…è¿›è¡Œ <strong>åˆ†ç‰‡å¤„ç†ï¼ˆ<code>IP Fragmentation</code>ï¼‰</strong>ï¼Œå°†è¾ƒå¤§çš„ IP åŒ…åˆ†æˆå¤šä¸ªè¾ƒå°çš„ IP åŒ…ã€‚åˆ†ç‰‡çš„åŒ…åˆ°äº†å¯¹ç«¯ç›®æ ‡åœ°å€åä¼šå†è¢«ç»„åˆèµ·æ¥ä¼ ç»™ä¸Šä¸€å±‚ã€‚</p><h3 id="ip-å±äºé¢å‘æ— è¿æ¥å‹"><a class="markdownIt-Anchor" href="#ip-å±äºé¢å‘æ— è¿æ¥å‹"></a> IP å±äºé¢å‘æ— è¿æ¥å‹</h3><p>IP åœ¨å‘åŒ…ä¹‹å‰ï¼Œä¸éœ€è¦å»ºç«‹ä¸å¯¹ç«¯ç›®æ ‡åœ°å€ä¹‹é—´çš„è¿æ¥ã€‚ä¸Šå±‚å¦‚æœé‡åˆ°éœ€è¦å‘ç»™ IP çš„æ•°æ®ï¼Œè¯¥æ•°æ®ä¼šç«‹å³è¢«å‹ç¼©æˆ IP åŒ…å‘é€å‡ºå»ã€‚</p><p>åŸå› ï¼š</p><ol><li>ç®€åŒ–ï¼šé¢å‘è¿æ¥å¤„ç†ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ç®¡ç†æ¯ä¸ªè¿æ¥ã€‚</li><li>æé€Ÿï¼šæ¯æ¬¡é€šä¿¡ä¹‹å‰éƒ½è¦å…ˆå»ºç«‹è¿æ¥ï¼Œä¼šé™ä½å¤„ç†é€Ÿåº¦ã€‚</li></ol><blockquote><p>ç”±äº IP åªè´Ÿè´£å°†æ•°æ®å‘ç»™ç›®æ ‡ä¸»æœºï¼Œä¸ºäº†ä¿è¯é€šä¿¡çš„å¯é æ€§ï¼Œä¸Šå±‚çš„ TCP é‡‡ç”¨é¢å‘è¿æ¥å‹ï¼Œè´Ÿè´£ä¿è¯å¯¹ç«¯ä¸»æœºç¡®å®æ”¶åˆ°æ•°æ®ã€‚</p></blockquote><h2 id="ip-åœ°å€"><a class="markdownIt-Anchor" href="#ip-åœ°å€"></a> IP åœ°å€</h2><h3 id="ç»„æˆ"><a class="markdownIt-Anchor" href="#ç»„æˆ"></a> ç»„æˆ</h3><p>IP åœ°å€ï¼ˆIPv4ï¼‰ç”± <code>32</code> ä½æ­£æ•´æ•°è¡¨ç¤ºï¼Œæ¯ <code>8</code> ä½ä¸€ç»„ï¼Œåˆ†æˆ 4 ç»„ï¼Œæ¯ç»„ä»¥ <code>.</code> éš”å¼€ï¼Œå†å°†æ¯ç»„æ•°è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚</p><p>IP åœ°å€ç”± <code>ç½‘ç»œåœ°å€ï¼ˆç½‘ç»œå·ï¼‰</code> å’Œ <code>ä¸»æœºåœ°å€ï¼ˆä¸»æœºå·ï¼‰</code> ç»„æˆï¼Œç½‘ç»œå·åœ¨æ•°æ®é“¾è·¯çš„æ¯ä¸ªæ®µé…ç½®ä¸åŒçš„å€¼ã€‚ç½‘ç»œå·å¿…é¡»ä¿è¯ç›¸äº’è¿æ¥çš„æ¯ä¸ªæ®µçš„åœ°å€ä¸é‡å¤ã€‚è€Œ<strong>ç›¸åŒæ®µå†…ç›¸è¿çš„ä¸»æœºå¿…é¡»æœ‰ç›¸åŒçš„ç½‘ç»œåœ°å€ã€‚ä¸»æœºå·åˆ™ä¸å…è®¸åœ¨åŒä¸€ä¸ªç½‘æ®µå†…é‡å¤å‡ºç°ã€‚</strong></p><h3 id="åˆ†ç±»"><a class="markdownIt-Anchor" href="#åˆ†ç±»"></a> åˆ†ç±»</h3><p>æ ¹æ® IP åœ°å€ä¸­ä»ç¬¬ <code>1</code> ä½åˆ°ç¬¬ <code>4</code> ä½åˆ’åˆ†ä¸º <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, <code>E</code> ç±»ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201016134533" srcset="/img/loading.gif" alt="" /></p><blockquote><p>å½“ä¸»æœºå·å…¨ä¸º 1 æ—¶ï¼Œå°±è¡¨ç¤ºè¯¥ç½‘ç»œçš„å¹¿æ’­åœ°å€ã€‚<br />å¹¿æ’­åœ°å€ç”¨äºåœ¨åŒä¸€ä¸ªé“¾è·¯ä¸­ç›¸äº’è¿æ¥çš„ä¸»æœºä¹‹é—´å‘é€æ•°æ®åŒ…ã€‚</p></blockquote><ul><li>A ç±»åœ°å€ï¼šç¬¬ 1 å­—èŠ‚ä¸ºç½‘ç»œåœ°å€ï¼Œå…¶å®ƒ 3 ä¸ªå­—èŠ‚ä¸ºä¸»æœºåœ°å€ã€‚å®ƒçš„ç¬¬ 1 ä¸ªå­—èŠ‚çš„<code>ç¬¬ä¸€ä½</code>å›ºå®šä¸º <code>0</code>ã€‚<ul><li>ç½‘ç»œå·èŒƒå›´ï¼š<code>0.0.0.0 ~ 127.0.0.0</code></li><li>ç§æœ‰åœ°å€ï¼š<code>10.0.0.0 ~ 10.255.255.255</code></li><li>ä¿ç•™åœ°å€ï¼š<code>127.x.x.x</code>ï¼Œç”¨äºå¾ªç¯æµ‹è¯•</li></ul></li><li>B ç±»åœ°å€ï¼šç¬¬ 1 å­—èŠ‚å’Œç¬¬ 2 å­—èŠ‚ä¸ºç½‘ç»œåœ°å€ï¼Œå 2 ä¸ªå­—èŠ‚ä¸ºä¸»æœºåœ°å€ã€‚å®ƒçš„ç¬¬ 1 ä¸ªå­—èŠ‚çš„<code>å‰ä¸¤ä½</code>å›ºå®šä¸º <code>10</code>ã€‚<ul><li>ç½‘ç»œå·èŒƒå›´ï¼š<code>128.0.0.0 ~ 191.255.0.0</code></li><li>ç§æœ‰åœ°å€ï¼š<code>172.16.0.0 ~ 172.31.255.255</code></li><li>ä¿ç•™åœ°å€ï¼š<code>169.254.x.x</code>ï¼Œå¦‚æœæ˜¯è‡ªåŠ¨è·å– IP åœ°å€ï¼Œè€Œä½ åœ¨ç½‘ç»œä¸Šåˆæ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„ DHCP æœåŠ¡å™¨ã€‚å°±ä¼šå¾—åˆ°å…¶ä¸­ä¸€ä¸ª IPã€‚</li><li>å¹¿æ’­åœ°å€ï¼š<code>191.255.255.255</code>ï¼Œä¸èƒ½åˆ†é…ã€‚</li></ul></li><li>C ç±»åœ°å€ï¼šç¬¬ 1 å­—èŠ‚ã€ç¬¬ 2 å­—èŠ‚å’Œç¬¬ 3 ä¸ªå­—èŠ‚ä¸ºç½‘ç»œåœ°å€ï¼Œç¬¬ 4 ä¸ªå­—èŠ‚ä¸ºä¸»æœºåœ°å€ã€‚å¦å¤–ç¬¬ 1 ä¸ªå­—èŠ‚çš„<code>å‰ä¸‰ä½</code>å›ºå®šä¸º <code>110</code>ã€‚<ul><li>ç½‘ç»œå·èŒƒå›´ï¼š<code>192.0.0.0 ~ 223.255.255.0</code></li><li>ç§æœ‰åœ°å€ï¼š<code>192.168.0.0 ~ 192.168.255.255</code></li></ul></li><li>D ç±»åœ°å€ï¼šæ²¡æœ‰ä¸»æœºåœ°å€ï¼Œå¸¸ç”¨äºå¤šæ’­ï¼Œå®ƒçš„ç¬¬ 1 ä¸ªå­—èŠ‚çš„<code>å‰å››ä½</code>å›ºå®šä¸º <code>1110</code>ã€‚<ul><li>åœ°å€èŒƒå›´ï¼š<code>224.0.0.0 ~ 239.255.255.255</code></li></ul></li><li>E ç±»åœ°å€ï¼šä¸åˆ†ç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ï¼Œå®ƒçš„ç¬¬ 1 ä¸ªå­—èŠ‚çš„<code>å‰å››ä½</code>å›ºå®šä¸º <code>1111</code>ã€‚<ul><li>åœ°å€èŒƒå›´ï¼š<code>240.0.0.0 ~ 255.255.255.254</code></li></ul></li></ul><h3 id="å­ç½‘æ©ç "><a class="markdownIt-Anchor" href="#å­ç½‘æ©ç "></a> å­ç½‘æ©ç </h3><blockquote><p>å­ç½‘æ©ç çš„é‡è¦ä½œç”¨ï¼šå°±æ˜¯å°†æŸä¸ªIPåœ°å€åˆ’åˆ†æˆç½‘ç»œåœ°å€å’Œä¸»æœºåœ°å€ä¸¤éƒ¨åˆ†ã€‚</p></blockquote><p>å­ç½‘æ©ç å®é™…ä¸Šå°±æ˜¯å°†åŸæ¥ A/B/C ç­‰åˆ†ç±»ä¸­çš„<strong>ä¸»æœºåœ°å€éƒ¨åˆ†ç”¨ä½œå­ç½‘åœ°å€</strong>ï¼Œå¯ä»¥å°†åŸç½‘ç»œåˆ†ä¸ºå¤šä¸ªç‰©ç†ç½‘ç»œçš„ä¸€ç§æœºåˆ¶ã€‚</p><p>è¡¨ç¤ºæ–¹å¼ï¼šIP åœ°å€ç½‘ç»œå·å…¨éƒ¨ä¸º <code>1</code>ï¼Œä¸»æœºå·å…¨éƒ¨ä¸º <code>0</code>ã€‚<br />ç”±æ­¤ï¼Œä¸€ä¸ª IP åœ°å€ä¸å†å—é™è‡ªå·±çš„ç±»åˆ«ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨å­ç½‘æ©ç è‡ªç”±åœ°å®šä½è‡ªå·±çš„ç½‘ç»œå·éƒ¨åˆ†ã€‚</p><p>å¦‚ï¼š<code>172.20.100.52/26</code> è¡¨ç¤ºå‰ <code>26</code> ä½æ˜¯ç½‘ç»œå·ã€‚<br />IP åœ°å€ï¼š172. 20.  100. 52<br />å­ç½‘æ©ç ï¼š255. 255. 255. 192</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019122155" srcset="/img/loading.gif" alt="" /></p><h2 id="æ— åˆ†ç±»åœ°å€-cidr"><a class="markdownIt-Anchor" href="#æ— åˆ†ç±»åœ°å€-cidr"></a> æ— åˆ†ç±»åœ°å€ CIDR</h2><h3 id="ip-åˆ†ç±»çš„ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#ip-åˆ†ç±»çš„ç¼ºç‚¹"></a> IP åˆ†ç±»çš„ç¼ºç‚¹</h3><ol><li><strong>åŒä¸€ç½‘ç»œä¸‹æ²¡æœ‰åœ°å€å±‚æ¬¡</strong>ã€‚æ¯”å¦‚ä¸€ä¸ªå…¬å¸é‡Œç”¨äº† B ç±»åœ°å€ï¼Œä½†æ˜¯å¯èƒ½éœ€è¦æ ¹æ®ç”Ÿäº§ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€å¼€å‘ç¯å¢ƒæ¥åˆ’åˆ†åœ°å€å±‚æ¬¡ï¼Œè€Œè¿™ç§ IP åˆ†ç±»æ˜¯æ²¡æœ‰åœ°å€å±‚æ¬¡åˆ’åˆ†çš„åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™å°±ç¼ºå°‘åœ°å€çš„çµæ´»æ€§ã€‚</li><li><strong>ä¸èƒ½å¾ˆå¥½çš„ä¸ç°å®ç½‘ç»œåŒ¹é…</strong>ã€‚C ç±»åœ°å€æœ€å¤§ä¸»æœºæ•°é‡å¤ªå°‘ï¼Œè€Œ B ç±»åœ°å€æœ€å¤§ä¸»æœºæ•°é‡å¤ªå¤šã€‚</li></ol><h3 id="åˆ’åˆ†ç½‘ç»œå·å’Œä¸»æœºå·"><a class="markdownIt-Anchor" href="#åˆ’åˆ†ç½‘ç»œå·å’Œä¸»æœºå·"></a> åˆ’åˆ†ç½‘ç»œå·å’Œä¸»æœºå·</h3><p><code>CIDR</code> ä¸å†æœ‰åˆ†ç±»åœ°å€çš„æ¦‚å¿µï¼Œ32 æ¯”ç‰¹çš„ IP åœ°å€è¢«åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå‰é¢æ˜¯ç½‘ç»œå·ï¼Œåé¢æ˜¯ä¸»æœºå·ã€‚<br />è¡¨ç¤ºå½¢å¼ <code>a.b.c.d/x</code>ï¼Œå…¶ä¸­ <code>/x</code> è¡¨ç¤ºå‰ <code>x</code> ä½å±äº<code>ç½‘ç»œå·</code>ï¼Œ <code>x</code> çš„èŒƒå›´æ˜¯ <code>0 ~ 32</code>ï¼Œè¿™å°±ä½¿å¾— <code>IP</code> åœ°å€æ›´åŠ å…·æœ‰çµæ´»æ€§ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102141842.png" srcset="/img/loading.gif" alt="" /></p><p>è¿˜æœ‰å¦ä¸€ç§åˆ’åˆ†ç½‘ç»œå·ä¸ä¸»æœºå·å½¢å¼ï¼Œé‚£å°±æ˜¯å­ç½‘æ©ç ï¼Œæ©ç çš„æ„æ€å°±æ˜¯æ©ç›–æ‰ä¸»æœºå·ï¼Œå‰©ä½™çš„å°±æ˜¯ç½‘ç»œå·ã€‚<br /><strong>å°†å­ç½‘æ©ç å’Œ IP åœ°å€æŒ‰ä½è®¡ç®— ANDï¼Œå°±å¯å¾—åˆ°ç½‘ç»œå·ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102141924.png" srcset="/img/loading.gif" alt="" /></p><h3 id="å­ç½‘åˆ’åˆ†"><a class="markdownIt-Anchor" href="#å­ç½‘åˆ’åˆ†"></a> å­ç½‘åˆ’åˆ†</h3><p>å¯ä»¥é€šè¿‡å­ç½‘æ©ç åˆ’åˆ†å‡ºç½‘ç»œå·å’Œä¸»æœºå·ï¼Œå®é™…ä¸Šå­ç½‘æ©ç è¿˜æœ‰ä¸€ä¸ªä½œç”¨ï¼Œé‚£å°±æ˜¯<strong>åˆ’åˆ†å­ç½‘</strong>ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102143204.png" srcset="/img/loading.gif" alt="" /></p><ul><li>æœªåšå­ç½‘åˆ’åˆ†çš„ IP åœ°å€ï¼šç½‘ç»œåœ°å€ï¼‹ä¸»æœºåœ°å€</li><li>åšå­ç½‘åˆ’åˆ†åçš„ IP åœ°å€ï¼šç½‘ç»œåœ°å€ï¼‹ï¼ˆå­ç½‘ç½‘ç»œåœ°å€ï¼‹å­ç½‘ä¸»æœºåœ°å€ï¼‰</li></ul><p>å‡è®¾å¯¹ C ç±»åœ°å€è¿›è¡Œå­ç½‘åˆ’åˆ†ï¼Œç½‘ç»œåœ°å€ <code>192.168.1.0</code>ï¼Œä½¿ç”¨å­ç½‘æ©ç  <code>255.255.255.192</code> å¯¹å…¶è¿›è¡Œå­ç½‘åˆ’åˆ†ã€‚</p><p>C ç±»åœ°å€ä¸­å‰ <code>24</code> ä½æ˜¯ç½‘ç»œå·ï¼Œæœ€å <code>8</code> ä½æ˜¯ä¸»æœºå·ï¼Œæ ¹æ®å­ç½‘æ©ç å¯çŸ¥<strong>ä» 8 ä½ä¸»æœºå·ä¸­å€Ÿç”¨ 2 ä½ä½œä¸ºå­ç½‘å·ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102143435.png" srcset="/img/loading.gif" alt="" /></p><p>ç”±äºå­ç½‘ç½‘ç»œåœ°å€è¢«åˆ’åˆ†æˆ <code>2</code> ä½ï¼Œé‚£ä¹ˆå­ç½‘åœ°å€å°±æœ‰ <code>4</code> ä¸ªï¼Œåˆ†åˆ«æ˜¯ <code>00</code>ã€<code>01</code>ã€<code>10</code>ã€<code>11</code>ï¼Œå…·ä½“åˆ’åˆ†å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102143554.png" srcset="/img/loading.gif" alt="" /></p><p>åˆ’åˆ†åçš„ 4 ä¸ªå­ç½‘å¦‚ä¸‹è¡¨æ ¼ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102143721.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ipv6"><a class="markdownIt-Anchor" href="#ipv6"></a> IPv6</h2><p><code>IPv4</code> çš„åœ°å€æ˜¯ <code>32</code> ä½çš„ï¼Œå¤§çº¦å¯ä»¥æä¾› 42 äº¿ä¸ªåœ°å€ã€‚<code>IPv6</code> çš„åœ°å€æ˜¯ <code>128</code> ä½çš„ï¼Œè¿˜æœ‰æ›´å¥½çš„å®‰å…¨æ€§å’Œæ‰©å±•æ€§ã€‚</p><h3 id="ipv6-çš„äº®ç‚¹"><a class="markdownIt-Anchor" href="#ipv6-çš„äº®ç‚¹"></a> IPv6 çš„äº®ç‚¹</h3><ul><li>IPv6 å¯<strong>è‡ªåŠ¨é…ç½®</strong>ï¼Œå³ä½¿æ²¡æœ‰ DHCP æœåŠ¡å™¨ä¹Ÿå¯ä»¥å®ç°è‡ªåŠ¨åˆ†é…IPåœ°å€ï¼ŒçœŸæ˜¯ä¾¿æ·åˆ°å³æ’å³ç”¨å•Šã€‚</li><li>IPv6 åŒ…å¤´åŒ…é¦–éƒ¨é•¿åº¦é‡‡ç”¨å›ºå®šçš„å€¼ <code>40</code> å­—èŠ‚ï¼Œå»æ‰äº†åŒ…å¤´æ ¡éªŒå’Œï¼Œ<strong>ç®€åŒ–äº†é¦–éƒ¨ç»“æ„</strong>ï¼Œå‡è½»äº†è·¯ç”±å™¨è´Ÿè·ï¼Œå¤§å¤§æé«˜äº†ä¼ è¾“çš„æ€§èƒ½ã€‚</li><li>IPv6 æœ‰åº”å¯¹ä¼ªé€  <code>IP</code> åœ°å€çš„ç½‘ç»œå®‰å…¨åŠŸèƒ½ä»¥åŠé˜²æ­¢çº¿è·¯çªƒå¬çš„åŠŸèƒ½ï¼Œå¤§å¤§æå‡äº†<strong>å®‰å…¨æ€§</strong>ã€‚</li></ul><h3 id="ipv6-åœ°å€çš„æ ‡è¯†æ–¹æ³•"><a class="markdownIt-Anchor" href="#ipv6-åœ°å€çš„æ ‡è¯†æ–¹æ³•"></a> IPv6 åœ°å€çš„æ ‡è¯†æ–¹æ³•</h3><p><code>IPv4</code> åœ°å€é•¿åº¦å…± <code>32</code> ä½ï¼Œæ˜¯ä»¥æ¯ <code>8</code> ä½ä½œä¸ºä¸€ç»„ï¼Œå¹¶ç”¨<strong>ç‚¹åˆ†åè¿›åˆ¶</strong>çš„è¡¨ç¤ºæ–¹å¼ã€‚</p><p><code>IPv6</code> åœ°å€é•¿åº¦æ˜¯ <code>128</code> ä½ï¼Œæ˜¯ä»¥æ¯ <code>16</code> ä½ä½œä¸ºä¸€ç»„ï¼Œæ¯ç»„ç”¨å†’å· ã€Œ<code>:</code>ã€ éš”å¼€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102150041.png" srcset="/img/loading.gif" alt="" /></p><p>å¦‚æœå‡ºç°è¿ç»­çš„ 0 æ—¶è¿˜å¯ä»¥å°†è¿™äº› 0 çœç•¥ï¼Œå¹¶ç”¨ä¸¤ä¸ªå†’å· ã€Œ<code>::</code>ã€éš”å¼€ã€‚ä½†æ˜¯ï¼Œ<strong>ä¸€ä¸ª IP åœ°å€ä¸­åªå…è®¸å‡ºç°ä¸€æ¬¡ä¸¤ä¸ªè¿ç»­çš„å†’å·ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102150108.png" srcset="/img/loading.gif" alt="" /></p><h3 id="ipv6-åœ°å€çš„ç»“æ„"><a class="markdownIt-Anchor" href="#ipv6-åœ°å€çš„ç»“æ„"></a> IPv6 åœ°å€çš„ç»“æ„</h3><p>IPv6 çš„åœ°å€ä¸»è¦æœ‰ä»¥ä¸‹ç±»å‹åœ°å€ï¼š</p><ul><li>å•æ’­åœ°å€ï¼Œç”¨äºä¸€å¯¹ä¸€çš„é€šä¿¡ï¼›</li><li>ç»„æ’­åœ°å€ï¼Œç”¨äºä¸€å¯¹å¤šçš„é€šä¿¡ï¼›</li><li>ä»»æ’­åœ°å€ï¼Œç”¨äºé€šä¿¡æœ€è¿‘çš„èŠ‚ç‚¹ï¼Œæœ€è¿‘çš„èŠ‚ç‚¹æ˜¯ç”±è·¯ç”±åè®®å†³å®šï¼›</li><li><strong>æ²¡æœ‰å¹¿æ’­åœ°å€</strong>ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102150205.png" srcset="/img/loading.gif" alt="" /></p><p>å¯¹äºä¸€å¯¹ä¸€é€šä¿¡çš„ IPv6 åœ°å€ï¼Œä¸»è¦åˆ’åˆ†äº†ä¸‰ç±»å•æ’­åœ°å€ï¼Œæ¯ç±»åœ°å€çš„æœ‰æ•ˆèŒƒå›´éƒ½ä¸åŒã€‚</p><ol><li>åœ¨åŒä¸€é“¾è·¯å•æ’­é€šä¿¡ï¼Œä¸ç»è¿‡è·¯ç”±å™¨ï¼Œå¯ä»¥ä½¿ç”¨<strong>é“¾è·¯æœ¬åœ°å•æ’­åœ°å€</strong>ï¼ŒIPv4 æ²¡æœ‰æ­¤ç±»å‹ï¼›</li><li>åœ¨å†…ç½‘é‡Œå•æ’­é€šä¿¡ï¼Œå¯ä»¥ä½¿ç”¨<strong>å”¯ä¸€æœ¬åœ°åœ°å€</strong>ï¼Œç›¸å½“äº IPv4 çš„ç§æœ‰ IPï¼›</li><li>åœ¨äº’è”ç½‘é€šä¿¡ï¼Œå¯ä»¥ä½¿ç”¨<strong>å…¨å±€å•æ’­åœ°å€</strong>ï¼Œç›¸å½“äº IPv4 çš„å…¬æœ‰ IPï¼›</li></ol><h3 id="ipv4-é¦–éƒ¨ä¸-ipv6-é¦–éƒ¨"><a class="markdownIt-Anchor" href="#ipv4-é¦–éƒ¨ä¸-ipv6-é¦–éƒ¨"></a> IPv4 é¦–éƒ¨ä¸ IPv6 é¦–éƒ¨</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201102150356.png" srcset="/img/loading.gif" alt="" /></p><p>IPv6 ç›¸æ¯” IPv4 çš„é¦–éƒ¨æ”¹è¿›ï¼š</p><ul><li><strong>å–æ¶ˆäº†é¦–éƒ¨æ ¡éªŒå’Œå­—æ®µ</strong>ã€‚ å› ä¸ºåœ¨æ•°æ®é“¾è·¯å±‚å’Œä¼ è¾“å±‚éƒ½ä¼šæ ¡éªŒï¼Œå› æ­¤ IPv6 ç›´æ¥å–æ¶ˆäº† IP çš„æ ¡éªŒã€‚</li><li><strong>å–æ¶ˆäº†åˆ†ç‰‡/é‡æ–°ç»„è£…ç›¸å…³å­—æ®µ</strong>ã€‚ åˆ†ç‰‡ä¸é‡ç»„æ˜¯è€—æ—¶çš„è¿‡ç¨‹ï¼ŒIPv6 ä¸å…è®¸åœ¨ä¸­é—´è·¯ç”±å™¨è¿›è¡Œåˆ†ç‰‡ä¸é‡ç»„ï¼Œè¿™ç§æ“ä½œåªèƒ½åœ¨æºä¸ç›®æ ‡ä¸»æœºï¼Œè¿™å°†å¤§å¤§æé«˜äº†è·¯ç”±å™¨è½¬å‘çš„é€Ÿåº¦ã€‚</li><li><strong>å–æ¶ˆé€‰é¡¹å­—æ®µ</strong>ã€‚ é€‰é¡¹å­—æ®µä¸å†æ˜¯æ ‡å‡† IP é¦–éƒ¨çš„ä¸€éƒ¨åˆ†äº†ï¼Œä½†å®ƒå¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œè€Œæ˜¯å¯èƒ½å‡ºç°åœ¨ IPv6 é¦–éƒ¨ä¸­çš„ã€Œä¸‹ä¸€ä¸ªé¦–éƒ¨ã€æŒ‡å‡ºçš„ä½ç½®ä¸Šã€‚åˆ é™¤è¯¥é€‰é¡¹å­—æ®µä½¿çš„ IPv6 çš„é¦–éƒ¨æˆä¸ºå›ºå®šé•¿åº¦çš„ 40 å­—èŠ‚ã€‚</li></ul><h2 id="è·¯ç”±æ§åˆ¶-2"><a class="markdownIt-Anchor" href="#è·¯ç”±æ§åˆ¶-2"></a> è·¯ç”±æ§åˆ¶</h2><p>IP åœ°å€çš„ç½‘ç»œéƒ¨åˆ†ç”¨äºè¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚è·¯ç”±è¡¨ä¸­è®°å½•ç€<strong>ç½‘ç»œåœ°å€</strong>ä¸ä¸‹ä¸€æ­¥åº”è¯¥å‘é€è‡³<strong>è·¯ç”±å™¨çš„åœ°å€</strong>ã€‚å¦‚æœè·¯ç”±è¡¨ä¸­å­˜åœ¨å¤šæ¡ç›¸åŒç½‘ç»œåœ°å€çš„è®°å½•ï¼Œå°±é€‰æ‹©ä¸€ä¸ªç›¸åŒä½æ•°æœ€å¤šï¼ˆ<code>æœ€é•¿åŒ¹é…</code>ï¼‰çš„ç½‘ç»œåœ°å€ã€‚</p><ul><li>é»˜è®¤è·¯ç”±ï¼š<code>0.0.0.0/0</code> è·¯ç”±è¡¨ä¸­ä»»ä½•ä¸€ä¸ªåœ°å€éƒ½èƒ½ä¸ä¹‹åŒ¹é…ã€‚</li><li>ä¸»æœºè·¯ç”±ï¼š<code>IP åœ°å€/32</code> æ•´ä¸ª IP åœ°å€çš„æ‰€æœ‰ä½éƒ½å°†å‚ä¸è·¯ç”±ã€‚</li><li>ç¯å›åœ°å€ï¼š<code>127.0.0.1ã€localhost</code> åŒä¸€å°è®¡ç®—æœºä¸Šçš„ç¨‹åºä¹‹é—´è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚</li></ul><h2 id="ç›¸å…³åè®®"><a class="markdownIt-Anchor" href="#ç›¸å…³åè®®"></a> ç›¸å…³åè®®</h2><h3 id="dns"><a class="markdownIt-Anchor" href="#dns"></a> DNS</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019132145.png" srcset="/img/loading.gif" alt="" /></p><h3 id="arp-rarp"><a class="markdownIt-Anchor" href="#arp-rarp"></a> ARPã€RARP</h3><p>ARP å°† IP åœ°å€å®šä½åˆ°å¯¹åº”çš„ MAC åœ°å€ã€‚åªé€‚ç”¨äº IPv4ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019133552.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸»æœº A ä¸ºäº†è·å–ä¸»æœº B çš„ MAC åœ°å€ï¼Œè¦é€šè¿‡<strong>å¹¿æ’­</strong>å‘é€ä¸€ä¸ª ARP è¯·æ±‚åŒ…ï¼Œè¿™ä¸ªåŒ…ä¸­åŒ…å«äº† ä¸»æœº B çš„ IP åœ°å€ã€‚ç”±äºå¹¿æ’­çš„åŒ…å¯ä»¥è¢«åŒä¸€ä¸ªé“¾è·¯ä¸Šæ‰€æœ‰çš„ä¸»æœºæˆ–è·¯ç”±å™¨æ¥æ”¶ï¼Œ<strong>å¦‚æœè¯·æ±‚åŒ…ä¸­çš„ IP åœ°å€ä¸è‡ªå·±çš„ IP åœ°å€ä¸€è‡´ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±å°†è‡ªå·±çš„ MAC åœ°å€æ”¾å…¥ ARP å“åº”åŒ…è¿”å›ç»™ ä¸»æœº Aã€‚</strong></p><p>RARP æ˜¯ä» MAC åœ°å€å®šä½ IP åœ°å€çš„ä¸€ç§åè®®ã€‚ä¾‹å¦‚å°†æ‰“å°æœºç­‰åµŒå…¥å¼è®¾å¤‡æ¥å…¥åˆ°ç½‘ç»œæ—¶å°±ä¼šç”¨åˆ°ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019134340.png" srcset="/img/loading.gif" alt="" /></p><h3 id="icmp"><a class="markdownIt-Anchor" href="#icmp"></a> ICMP</h3><p>ICMP çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šç¡®è®¤ IP åŒ…æ˜¯å¦æˆåŠŸé€è¾¾ç›®æ ‡åœ°å€ï¼Œé€šçŸ¥åœ¨å‘é€è¿‡ç¨‹ä¸­ IP åŒ…è¢«åºŸå¼ƒåŸå› ï¼Œæ”¹å–„ç½‘ç»œè®¾ç½®ï¼Œè¿›è¡Œç½‘ç»œè¯Šæ–­ã€‚</p><p>ICMP çš„æ¶ˆæ¯å¤§è‡´å¯ä»¥åˆ†æˆä¸¤ç±»ï¼šä¸€ç±»æ˜¯é€šçŸ¥å‡ºé”™åŸå› çš„é”™è¯¯æ¶ˆæ¯ï¼Œå¦ä¸€ç±»æ˜¯ç”¨äºè¯Šæ–­çš„æŸ¥è¯¢ä¿¡æ¯ã€‚</p><h3 id="dhcp"><a class="markdownIt-Anchor" href="#dhcp"></a> DHCP</h3><p>DHCP å¯å®ç°è‡ªåŠ¨è®¾ç½® IP åœ°å€ï¼Œç»Ÿä¸€ç®¡ç† IP åœ°å€åˆ†é…ï¼Œè®©å³æ’å³ç”¨å˜å¾—å¯èƒ½ã€‚åœ¨ IPv4ï¼ŒIPv6 ä¸­å‡å¯ä½¿ç”¨ã€‚</p><h3 id="nat"><a class="markdownIt-Anchor" href="#nat"></a> NAT</h3><p>NAT ç”¨äºåœ¨æœ¬åœ°ç½‘ç»œä¸­ä½¿ç”¨ç§æœ‰åœ°å€ï¼Œåœ¨è¿æ¥äº’è”ç½‘æ—¶ä½¿ç”¨å…¨å±€ IP åœ°å€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019152539.png" srcset="/img/loading.gif" alt="" /></p><p>NAPT å°†ç«¯å£å·ä¸€èµ·è½¬æ¢ã€‚</p><blockquote><p>åœ¨ä½¿ç”¨ TCP æˆ– UDP çš„é€šä¿¡å½“ä¸­ï¼Œåªæœ‰ç›®æ ‡åœ°å€ã€æºåœ°å€ã€ç›®æ ‡ç«¯å£ã€æºç«¯å£ä»¥åŠåè®®ç§ç±»éƒ½ä¸€è‡´æ—¶æ‰è¢«è®¤ä¸ºæ˜¯åŒä¸€ä¸ªè¿æ¥ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019153122.png" srcset="/img/loading.gif" alt="" /></p><h3 id="ip-éš§é“"><a class="markdownIt-Anchor" href="#ip-éš§é“"></a> IP éš§é“</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201019153834.png" srcset="/img/loading.gif" alt="" /></p><p>IP éš§é“å¯ä»¥å°†é‚£äº›ä»ç½‘ç»œ A å‘è¿‡æ¥çš„ IPv6 çš„åŒ…ç»Ÿåˆä¸ºä¸€ä¸ªæ•°æ®ï¼Œå†ä¸ºä¹‹è¿½åŠ ä¸€ä¸ª IPv4 çš„é¦–éƒ¨ä»¥åè½¬å‘ç»™ç½‘ç»œ Cã€‚</p><h1 id="tcp-ä¸-udp"><a class="markdownIt-Anchor" href="#tcp-ä¸-udp"></a> TCP ä¸ UDP</h1><h2 id="ä¼ è¾“å±‚ä½œç”¨"><a class="markdownIt-Anchor" href="#ä¼ è¾“å±‚ä½œç”¨"></a> ä¼ è¾“å±‚ä½œç”¨</h2><p>TCP æ˜¯<strong>é¢å‘è¿æ¥çš„ã€å¯é </strong>çš„æµåè®®ï¼Œä¸ºå®ç°å¯é ä¼ è¾“ï¼Œå®è¡Œé¡ºåºæ§åˆ¶æˆ–é‡å‘æ§åˆ¶æœºåˆ¶ï¼Œè¿˜å…·å¤‡æµé‡æ§åˆ¶ã€æ‹¥å¡ç©ºç€ã€æé«˜ç½‘ç»œåˆ©ç”¨ç‡ç­‰åŠŸèƒ½ã€‚</p><p>UDP æ˜¯<strong>é¢å‘æ— è¿æ¥ã€ä¸å…·æœ‰å¯é æ€§</strong>çš„æ•°æ®æŠ¥åè®®ï¼Œä¸»è¦ç”¨äºé‚£äº›å¯¹é«˜é€Ÿä¼ è¾“å’Œå®æ—¶æ€§æœ‰è¾ƒé«˜è¦æ±‚çš„é€šä¿¡æˆ–å¹¿æ’­é€šä¿¡ã€‚å®ƒä¸ä¼šè¿›è¡Œé‡å‘å¤„ç†ã€‚</p><h2 id="ç«¯å£å·"><a class="markdownIt-Anchor" href="#ç«¯å£å·"></a> ç«¯å£å·</h2><p>ç«¯å£å·ç”¨æ¥è¯†åˆ«åŒä¸€å°è®¡ç®—æœºä¸­è¿›è¡Œé€šä¿¡çš„ä¸åŒåº”ç”¨ç¨‹åºï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºç¨‹åºåœ°å€ã€‚ä¼ è¾“å±‚åè®®æ­£æ˜¯åˆ©ç”¨è¿™äº›ç«¯å£å·è¯†åˆ«æœ¬æœºä¸­æ­£åœ¨é€šä¿¡çš„åº”ç”¨ç¨‹åºï¼Œå¹¶å‡†ç¡®åœ°å°†æ•°æ®ä¼ è¾“ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020140053.png" srcset="/img/loading.gif" alt="" /></p><p>å¸¸è§ç«¯å£å·ï¼š</p><table><thead><tr><th style="text-align:center">ç«¯å£å·</th><th style="text-align:center">æœåŠ¡å</th></tr></thead><tbody><tr><td style="text-align:center">20</td><td style="text-align:center">ftp-data</td></tr><tr><td style="text-align:center">21</td><td style="text-align:center">ftp</td></tr><tr><td style="text-align:center">22</td><td style="text-align:center">ssh</td></tr><tr><td style="text-align:center">23</td><td style="text-align:center">telnet</td></tr><tr><td style="text-align:center">25</td><td style="text-align:center">smtp</td></tr><tr><td style="text-align:center">80</td><td style="text-align:center">http</td></tr><tr><td style="text-align:center">443</td><td style="text-align:center">https</td></tr></tbody></table><h2 id="udp"><a class="markdownIt-Anchor" href="#udp"></a> UDP</h2><h3 id="ä½œç”¨"><a class="markdownIt-Anchor" href="#ä½œç”¨"></a> ä½œç”¨</h3><p>ç”±äº UDP é¢å‘æ— è¿æ¥ï¼Œå®ƒå¯ä»¥éšæ—¶å‘é€æ•°æ®ï¼ŒåŠ ä¸Š UDP æœ¬èº«çš„å¤„ç†æ—¢ç®€å•åˆé«˜æ•ˆï¼Œå¸¸ç”¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>åŒ…æ€»é‡è¾ƒå°‘çš„é€šä¿¡ï¼ˆDNSã€SNMP ç­‰ï¼‰</li><li>è§†é¢‘ã€éŸ³é¢‘ç­‰å¤šåª’ä½“é€šä¿¡</li><li>é™å®šäº LAN ç­‰ç‰¹å®šç½‘ç»œä¸­çš„åº”ç”¨é€šä¿¡</li><li>å¹¿æ’­é€šä¿¡ï¼ˆå¹¿æ’­ã€å¤šæ’­ï¼‰</li></ul><h3 id="é¦–éƒ¨"><a class="markdownIt-Anchor" href="#é¦–éƒ¨"></a> é¦–éƒ¨</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020140728.png" srcset="/img/loading.gif" alt="" /></p><p>UDP é¦–éƒ¨ç”±æºç«¯å£å·ï¼Œç›®æ ‡ç«¯å£å·ï¼ŒåŒ…é•¿åº¦å’Œæ ¡éªŒå’Œç»„æˆã€‚</p><ul><li>æºç«¯å£å·ï¼ˆ<code>Source Port</code>ï¼‰ï¼šå‘é€ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ <code>16</code> ä½ï¼Œè¯¥å­—æ®µæ˜¯å¯é€‰é¡¹ï¼Œæ²¡æœ‰æºç«¯å£å·æ—¶è®¾ç½®ä¸º <code>0</code>ï¼Œå¯ç”¨äºä¸éœ€è¦è¿”å›çš„é€šä¿¡ä¸­ã€‚</li><li>ç›®æ ‡ç«¯å£å·ï¼ˆ<code>Destination Port</code>ï¼‰ï¼šæ¥æ”¶ç«¯ç«¯å£å·ï¼Œå­—æ®µé•¿ <code>16</code> ä½ã€‚</li><li>åŒ…é•¿åº¦ï¼ˆ<code>Length</code>ï¼‰ï¼šUDP é¦–éƒ¨çš„é•¿åº¦å’Œæ•°æ®çš„é•¿åº¦ä¹‹å’Œã€‚å•ä½ï¼šå­—èŠ‚ã€‚</li><li>æ ¡éªŒå’Œï¼ˆ<code>Checksum</code>ï¼‰ï¼šæ ¡éªŒå’Œæ˜¯ä¸ºäº†æä¾›å¯é çš„ UDP é¦–éƒ¨å’Œæ•°æ®è€Œè®¾è®¡ã€‚</li></ul><h2 id="tcp"><a class="markdownIt-Anchor" href="#tcp"></a> TCP</h2><p>TCP é€šè¿‡æ ¡éªŒå’Œã€åºåˆ—å·ã€ç¡®è®¤åº”ç­”ã€é‡å‘æ§åˆ¶ã€è¿æ¥ç®¡ç†ä»¥åŠçª—å£æ§åˆ¶ç­‰æœºåˆ¶å®ç°å¯é æ€§ä¼ è¾“ã€‚</p><h3 id="ç¡®è®¤åº”ç­”"><a class="markdownIt-Anchor" href="#ç¡®è®¤åº”ç­”"></a> ç¡®è®¤åº”ç­”</h3><p>TCP é€šè¿‡ç¡®è®¤åº”ç­”ï¼ˆ<code>ACK</code>ï¼‰å®ç°å¯é çš„æ•°æ®ä¼ è¾“ã€‚<br />å½“å‘é€ç«¯å°†æ•°æ®å‘å‡ºä¹‹åä¼šç­‰å¾…å¯¹ç«¯çš„ç¡®è®¤åº”ç­”ã€‚å¦‚æœæœ‰ç¡®è®¤åº”ç­”ï¼Œè¯´æ˜æ•°æ®å·²ç»æˆåŠŸåˆ°è¾¾å¯¹ç«¯ï¼Œåä¹‹ï¼Œæ•°æ®ä¸¢å¤±çš„å¯èƒ½æ€§å¾ˆå¤§ã€‚</p><p>ç¡®è®¤ä¸¢å¤±ï¼šå½“ä¸»æœº A åœ¨è®¾å®šçš„è¶…æ—¶é‡ä¼ æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œä½†æ— æ³•çŸ¥é“æ˜¯è‡ªå·±å‘é€çš„åˆ†ç»„å‡ºé”™ã€ä¸¢å¤±ï¼Œæˆ–æ˜¯ä¸»æœº B å‘é€çš„ç¡®è®¤ä¸¢å¤±äº†ã€‚è¿™æ—¶ A ä¼šé‡ä¼ æ•°æ®ï¼Œå‡è®¾ B æ”¶åˆ°äº†é‡å¤æ•°æ®ï¼Œåˆ™å®ƒä¼šä¸¢å¼ƒè¿™ä¸ªé‡å¤æ•°æ®ï¼Œå‘ A å‘é€ç¡®è®¤ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020142913.png" srcset="/img/loading.gif" alt="" /></p><p>ç¡®è®¤è¿Ÿåˆ°ï¼šä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°å·®é”™ï¼Œä½† B å¯¹åˆ†ç»„çš„ç¡®è®¤è¿Ÿåˆ°äº†ï¼Œæ­¤æ—¶ A ä¼šé‡ä¼ åˆ†ç»„ï¼ŒB æ”¶ä¸‹é‡å¤åˆ†ç»„åå°±ä¸¢å¼ƒï¼Œå¹¶å‘ A å‘é€ç¡®è®¤ã€‚A å¯¹äºè¿Ÿåˆ°çš„ç¡®è®¤æ”¶ä¸‹åå°±ä¸¢å¼ƒã€‚</p><h3 id="è¶…æ—¶é‡ä¼ "><a class="markdownIt-Anchor" href="#è¶…æ—¶é‡ä¼ "></a> è¶…æ—¶é‡ä¼ </h3><p>è¶…æ—¶é‡ä¼ æ—¶é—´æ˜¯æŒ‡åœ¨é‡å‘æ•°æ®ä¹‹å‰ï¼Œç­‰å¾…ç¡®è®¤åº”ç­”åˆ°æ¥çš„é‚£ä¸ªç‰¹å®šæ—¶é—´é—´éš”ã€‚</p><p>è¶…æ—¶æ—¶é—´éšç€æ•°æ®åŒ…é€”å¾„çš„ç½‘ç»œç¯å¢ƒçš„ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ï¼Œåœ¨åŒä¸€ä¸ªæ—¶æ®µä¸­ï¼Œæ ¹æ®ä¸åŒæ—¶æ®µç½‘ç»œæ‹¥å µç¨‹åº¦ï¼Œæ—¶é—´é•¿çŸ­ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>åœ¨ UNIX ä»¥åŠ Windows ä¸­ï¼Œè¶…æ—¶éƒ½ä»¥ <code>0.5s</code> ä¸ºå•ä½è¿›è¡Œæ§åˆ¶ã€‚æ•°æ®è¢«é‡å‘ä¹‹åè‹¥è¿˜æ˜¯æ”¶ä¸åˆ°ç¡®è®¤åº”ç­”ï¼Œåˆ™è¿›è¡Œå†æ¬¡å‘é€ã€‚æ­¤æ—¶ï¼Œç­‰å¾…ç¡®è®¤åº”ç­”çš„æ—¶é—´å°†ä¼šä»¥ <code>2</code> å€ã€<code>4</code> å€çš„æŒ‡æ•°å‡½æ•°å»¶é•¿ã€‚</p><p>æ•°æ®ä¸ä¼šè¢«æ— é™ã€åå¤åœ°é‡å‘ã€‚è¾¾åˆ°ä¸€å®šé‡å‘æ¬¡æ•°åï¼Œå¦‚æœä»æ²¡æœ‰ä»»ä½•ç¡®è®¤åº”ç­”è¿”å›ï¼Œå°±ä¼šåˆ¤æ–­å¯¹æ–¹ä¸»æœºå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå¼ºåˆ¶å…³é—­è¿æ¥ï¼Œå¹¶ä¸”é€šçŸ¥åº”ç”¨é€šä¿¡å¼‚å¸¸å¼ºè¡Œç»ˆæ­¢ã€‚</p><h3 id="mss"><a class="markdownIt-Anchor" href="#mss"></a> MSS</h3><p>TCP ä»¥æ®µä¸ºå•ä½å‘é€æ•°æ®ï¼Œä»¥æœ€å¤§æ¶ˆæ¯é•¿åº¦ï¼ˆ<code>MSSï¼šMaximum Segment Size</code>ï¼‰çš„å¤§å°å°†æ•°æ®è¿›è¡Œåˆ†å‰²å‘é€ã€‚</p><p><strong><code>MSS</code> æ˜¯åœ¨ä¸‰æ¬¡æ¡æ‰‹æ—¶ï¼Œåœ¨ä¸¤ç«¯ä¸»æœºä¹‹é—´è¢«è®¡ç®—å¾—å‡ºã€‚</strong> ä¸¤ç«¯ä¸»æœºåœ¨å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚æ—¶ï¼Œä¼šåœ¨ TCP é¦–éƒ¨ä¸­å†™å…¥ MSS é€‰é¡¹ï¼Œå‘Šè¯‰å¯¹æ–¹è‡ªå·±èƒ½å¤Ÿé€‚åº”çš„ MSS å¤§å°ï¼Œç„¶åä¼šä½¿ç”¨ä¸¤è€…ä¹‹é—´çš„è¾ƒå°å€¼ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020144627.png" srcset="/img/loading.gif" alt="" /></p><h3 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h3><p>TCP ä»¥ 1 ä¸ªæ®µä¸ºå•ä½ï¼Œæ¯å‘ä¸€ä¸ªæ®µè¿›è¡Œä¸€æ¬¡ç¡®è®¤åº”ç­”çš„å¤„ç†ï¼Œä½†æ˜¯å¦‚æœåŒ…çš„å¾€è¿”æ—¶é—´è¶Šé•¿ï¼Œç½‘ç»œçš„ååé‡ä¼šè¶Šå·®ï¼Œé€šä¿¡æ€§èƒ½å°±è¶Šä½ã€‚</p><p>æ‰€ä»¥ TCP å¼•å…¥äº†æ»‘åŠ¨çª—å£ï¼Œ<strong>ç¡®è®¤åº”ç­”æ˜¯ä»¥çª—å£å¤§å°è¿›è¡Œç¡®è®¤çš„</strong>ã€‚å‘é€ç«¯ä¸»æœºåœ¨å‘é€äº†ä¸€ä¸ªæ®µä¹‹åä¸å¿…è¦ä¸€ç›´ç­‰å¾…ç¡®è®¤åº”ç­”ï¼Œè€Œæ˜¯ç»§ç»­å‘é€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020145712.png" srcset="/img/loading.gif" alt="" /></p><p>çª—å£å†…çš„æ•°æ®å³ä½¿æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ä¹Ÿå¯ä»¥å‘é€å‡ºå»ï¼Œåœ¨æ”¶åˆ°ç¡®è®¤åº”ç­”ä¹‹å‰ï¼Œå¿…é¡»åœ¨ç¼“å†²åŒºä¸­ä¿ç•™è¿™éƒ¨åˆ†æ•°æ®ã€‚</p><p>åœ¨æ»‘åŠ¨çª—å£ä»¥å¤–çš„éƒ¨åˆ†åŒ…æ‹¬å·²ç»ç¡®è®¤æ”¶åˆ°åº”ç­”çš„æ•°æ®å’Œå°šæœªå‘é€çš„æ•°æ®ï¼Œæ”¶åˆ°ç¡®è®¤çš„æ•°æ®æ­¤æ—¶å¯ä»¥ä»ç¼“å†²åŒºæ¸…é™¤ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020145753.png" srcset="/img/loading.gif" alt="" /></p><h4 id="ç¡®è®¤ä¸¢å¤±"><a class="markdownIt-Anchor" href="#ç¡®è®¤ä¸¢å¤±"></a> ç¡®è®¤ä¸¢å¤±</h4><p>åœ¨æ²¡æœ‰ä½¿ç”¨æ»‘åŠ¨çª—å£æ—¶ï¼Œæ²¡æœ‰æ”¶åˆ°ç¡®è®¤åº”ç­”çš„æ•°æ®éƒ½ä¼šè¢«é‡å‘ã€‚<br />è€Œä½¿ç”¨äº†æ»‘åŠ¨çª—å£æ—¶ï¼Œçª—å£åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¾ƒå¤§æ—¶ï¼ŒæŸäº›ç¡®è®¤åº”ç­”å³ä¾¿ä¸¢å¤±ä¹Ÿæ— éœ€é‡å‘ï¼Œå¯ä»¥é€šè¿‡<strong>ä¸‹ä¸€ä¸ª</strong>ç¡®è®¤åº”ç­”è¿›è¡Œç¡®è®¤ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020150635.png" srcset="/img/loading.gif" alt="" /></p><h4 id="æŠ¥æ–‡ä¸¢å¤±"><a class="markdownIt-Anchor" href="#æŠ¥æ–‡ä¸¢å¤±"></a> æŠ¥æ–‡ä¸¢å¤±</h4><p><code>é«˜é€Ÿé‡å‘æ§åˆ¶</code>ï¼šåœ¨æŠ¥æ–‡ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªåºå·çš„ç¡®è®¤åº”ç­”ä¼šè¢«é‡å¤ä¸æ–­åœ°è¿”å›ã€‚è€Œå‘é€ç«¯ä¸»æœºå¦‚æœè¿ç»­ <code>3</code> æ¬¡æ”¶åˆ°åŒä¸€ä¸ªç¡®è®¤åº”ç­”ï¼Œå°±ä¼šå°†å…¶æ‰€å¯¹åº”çš„æ•°æ®é‡å‘ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020150452.png" srcset="/img/loading.gif" alt="" /></p><h3 id="æµé‡æ§åˆ¶"><a class="markdownIt-Anchor" href="#æµé‡æ§åˆ¶"></a> æµé‡æ§åˆ¶</h3><p>æµé‡æ§åˆ¶ï¼šTCP æä¾›ä¸€ç§æœºåˆ¶å¯ä»¥è®©å‘é€ç«¯æ ¹æ®æ¥æ”¶ç«¯çš„å®é™…æ¥æ”¶èƒ½åŠ›æ§åˆ¶å‘é€çš„æ•°æ®é‡ã€‚<br />æ»‘åŠ¨çª—å£å¤§å°ï¼šæ¥æ”¶ç«¯ä¸»æœºå‘å‘é€ç«¯ä¸»æœºé€šçŸ¥è‡ªå·±å¯ä»¥æ¥æ”¶æ•°æ®çš„å¤§å°ï¼ˆé¦–éƒ¨å­—æ®µä¸­çš„<code>çª—å£å¤§å°</code>ï¼‰ï¼Œäºæ˜¯å‘é€ç«¯ä¼šå‘é€ä¸è¶…è¿‡è¿™ä¸ªé™åº¦çš„æ•°æ®ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020151743.png" srcset="/img/loading.gif" alt="" /></p><h3 id="æ‹¥å¡æ§åˆ¶"><a class="markdownIt-Anchor" href="#æ‹¥å¡æ§åˆ¶"></a> æ‹¥å¡æ§åˆ¶</h3><h4 id="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"><a class="markdownIt-Anchor" href="#æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></a> æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…</h4><p>åœ¨ç½‘ç»œå‡ºç°æ‹¥å µæ—¶ï¼Œå¦‚æœçªç„¶å‘é€ä¸€ä¸ªè¾ƒå¤§é‡çš„æ•°æ®ï¼Œææœ‰å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç½‘ç»œçš„ç˜«ç—ªã€‚<br />ä¸ºäº†é˜²æ­¢è¯¥é—®é¢˜çš„å‡ºç°ï¼Œåœ¨é€šä¿¡ä¸€å¼€å§‹æ—¶ä¼šé€šè¿‡<code>æ…¢å¼€å§‹</code>ç®—æ³•å¯¹å‘é€æ•°æ®é‡è¿›è¡Œæ§åˆ¶ã€‚</p><p>åœ¨æ…¢å¼€å§‹æ—¶ï¼Œå°†<code>æ‹¥å¡çª—å£</code>å¤§å°è®¾ç½®ä¸º <code>1 MSS</code>ï¼Œä¹‹åæ¯æ”¶åˆ°ä¸€æ¬¡ç¡®è®¤åº”ç­”ï¼Œæ‹¥å¡çª—å£çš„å€¼å°±åŠ  <code>1</code>ã€‚å³ç”±å°åˆ°å¤§é€æ¸å¢å¤§å‘é€çª—å£ï¼Œä¹Ÿå°±æ˜¯ç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£ã€‚</p><blockquote><p>æ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–ï¼Œ<strong>å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ã€‚</strong> è€ƒè™‘åˆ°æ¥æ”¶æ–¹çš„æ¥æ”¶èƒ½åŠ›ï¼Œé‚£ä¹ˆå‘é€çª—å£è¿˜å¯èƒ½å°äºæ‹¥å¡çª—å£ã€‚</p></blockquote><p><strong>æ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“è½®æ¬¡ï¼Œæ‹¥å¡çª—å£å°±åŠ å€</strong>ï¼Œä»¥ 1ï¼Œ2ï¼Œ4æŒ‡æ•°å¢é•¿ã€‚ä¸ºäº†é˜²æ­¢æ‹¥å¡çª—å£å¢é•¿è¿‡å¤§ï¼Œè¿˜éœ€è¦è®¾ç½®<code>æ…¢å¼€å§‹é˜ˆå€¼</code>ï¼š</p><ul><li>å½“ <code>cwnd &lt; ssthresh</code> æ—¶ï¼Œä½¿ç”¨<strong>æ…¢å¼€å§‹</strong>ç®—æ³•ï¼›</li><li>å½“ <code>cwnd &gt; ssthresh</code> æ—¶ï¼Œä½¿ç”¨<strong>æ‹¥å¡é¿å…</strong>ç®—æ³•ï¼›</li><li>å½“ <code>cwnd = ssthresh</code> æ—¶ï¼Œå¯ä½¿ç”¨<strong>æ‹¥å¡é¿å…</strong>ç®—æ³•ï¼Œä¹Ÿå¯ä½¿ç”¨<strong>æ…¢å¼€å§‹</strong>ç®—æ³•ã€‚</li></ul><p><code>æ‹¥å¡é¿å…</code>çš„æ€è·¯æ˜¯è®©æ‹¥å¡çª—å£ç¼“æ…¢åœ°å¢å¤§ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´ RTT å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£<code>åŠ  1</code>ï¼Œè€Œä¸æ˜¯åŠ å€ã€‚è¿™æ ·ï¼Œ<strong>æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿</strong>ï¼Œæ¯”æ…¢å¼€å§‹ç®—æ³•çš„å¢é•¿é€Ÿç‡æ…¢å¾—å¤šã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020154633.png" srcset="/img/loading.gif" alt="" /></p><p>å®é™…ä¸Šï¼Œä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯ <code>AIMDï¼ˆåŠ æ³•å¢å¤§ä¹˜æ³•å‡å°ï¼‰</code>ç®—æ³•ã€‚</p><ul><li>åŠ æ³•å¢å¤§ï¼šæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢å¢å¤§ã€‚</li><li>ä¹˜æ³•å‡å°ï¼šä¸è®ºæ˜¯åœ¨æ…¢å¼€å§‹è¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‡ºç°è¶…æ—¶ï¼Œå°±<strong>æŠŠçª—å£é˜ˆå€¼ ssthresh è®¾ç½®ä¸ºå½“å‰çš„æ‹¥å¡çª—å£çš„ä¸€åŠï¼Œä¸æ­¤åŒæ—¶ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚</strong></li></ul><h4 id="å¿«é‡ä¼ å’Œå¿«æ¢å¤"><a class="markdownIt-Anchor" href="#å¿«é‡ä¼ å’Œå¿«æ¢å¤"></a> å¿«é‡ä¼ å’Œå¿«æ¢å¤</h4><p>å¿«é‡ä¼ ï¼šå‘é€æ–¹åªè¦<strong>è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤</strong>å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡ï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…ä¸ºä¸¢å¤±æŠ¥æ–‡è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸï¼ˆ<strong>å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µ</strong>ï¼‰ã€‚</p><p>å¿«æ¢å¤ï¼š</p><ul><li>å½“æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œæ‰§è¡Œ<strong>ä¹˜æ³•å‡å°</strong>ç®—æ³•ï¼ŒæŠŠæ…¢å¼€å§‹é—¨é™ ssthresh å‡åŠã€‚</li><li>ç°åœ¨<strong>ä¸æ‰§è¡Œæ…¢å¼€å§‹</strong>ç®—æ³•ï¼ˆä¸æŠŠæ‹¥å¡çª—å£è®¾ç½®ä¸º 1ï¼‰ï¼Œè€Œæ˜¯<strong>æŠŠæ‹¥å¡çª—å£è®¾ç½®ä¸º ssthresh å‡åŠåçš„æ•°å€¼ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ã€‚</strong></li></ul><h3 id="tcp-é¦–éƒ¨"><a class="markdownIt-Anchor" href="#tcp-é¦–éƒ¨"></a> TCP é¦–éƒ¨</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201020155556.png" srcset="/img/loading.gif" alt="" /></p><ul><li>æºç«¯å£å·ï¼ˆ<code>Source Port</code>ï¼‰ï¼šå­—æ®µé•¿ <code>16</code> ä½ã€‚</li><li>ç›®æ ‡ç«¯å£å·ï¼ˆ<code>Destination Port</code>ï¼‰ï¼šå­—æ®µé•¿ <code>16</code> ä½ã€‚</li><li>åºåˆ—å·ï¼ˆ<code>Sequence Number</code>ï¼‰ï¼šå­—æ®µé•¿ <code>32</code> ä½ï¼ŒæŒ‡çš„æ˜¯å‘é€æ•°æ®çš„ä½ç½®ï¼Œæ¯å‘é€ä¸€æ¬¡æ•°æ®ï¼Œå°±ç´¯åŠ ä¸€æ¬¡è¯¥æ•°æ®å­—èŠ‚æ•°çš„å¤§å°ã€‚</li><li>ç¡®è®¤åº”ç­”å·ï¼ˆ<code>Acknowledgement Number</code>ï¼‰ï¼šå­—æ®µé•¿ <code>32</code> ä½ï¼ŒæŒ‡çš„æ˜¯ä¸‹ä¸€ä¸ªåº”è¯¥æ”¶åˆ°çš„æ•°æ®çš„åºåˆ—å·ã€‚å®é™…ä¸Šï¼Œå®ƒæ˜¯æŒ‡å·²æ”¶åˆ° <code>ç¡®è®¤åº”ç­”å· - 1</code> ä¸ºæ­¢çš„æ•°æ®ã€‚å‘é€ç«¯æ”¶åˆ°è¿™ä¸ªç¡®è®¤åº”ç­”å·åå¯ä»¥è®¤ä¸ºåœ¨è¿™ä¸ªåºå·ä»¥å‰çš„æ•°æ®éƒ½å·²ç»è¢«æ­£å¸¸æ¥æ”¶ã€‚</li><li>æ•°æ®åç§»ï¼ˆ<code>Data Offset</code>ï¼‰ï¼šå­—æ®µé•¿ <code>4</code> ä½ã€‚è¡¨ç¤ºæ‰€ä¼ è¾“çš„æ•°æ®éƒ¨åˆ†åº”è¯¥ä» TCP åŒ…çš„å“ªä¸ªä½å¼€å§‹è®¡ç®—ã€‚å¯ä»¥çœ‹ä½œæ˜¯ <strong>TCP é¦–éƒ¨çš„é•¿åº¦</strong>ã€‚</li><li>ä¿ç•™ï¼ˆ<code>Reserved</code>ï¼‰ï¼šå­—æ®µé•¿ <code>4</code> ä½ã€‚ä¸€èˆ¬è®¾ç½®ä¸º <code>0</code>ï¼Œä¸»è¦æ˜¯ä¸ºäº†ä»¥åæ‰©å±•æ—¶ä½¿ç”¨ã€‚</li><li>æ§åˆ¶ä½ï¼ˆ<code>Control Flag</code>ï¼‰ï¼šå­—æ®µé•¿ <code>8</code> ä½ã€‚ä»å·¦è‡³å³åˆ†åˆ«ä¸º <code>CWR</code>ã€<code>ECE</code>ã€<code>URG</code>ã€<code>ACK</code>ã€<code>PSH</code>ã€<code>RST</code>ã€<code>SYN</code>ã€<code>FIN</code>ã€‚</li><li>çª—å£å¤§å°ï¼ˆ<code>Window Size</code>ï¼‰ï¼šå­—æ®µé•¿ <code>16</code> ä½ã€‚ç”¨äºé€šçŸ¥ä»ç¡®è®¤åº”ç­”å·æ‰€æŒ‡ä½ç½®å¼€å§‹èƒ½æ¥æ”¶çš„æ•°æ®å¤§å°ã€‚TCP ä¸å…è®¸å‘é€è¶…è¿‡æ­¤å¤„æ‰€ç¤ºå¤§å°çš„æ•°æ®ã€‚å¦‚æœçª—å£ä¸º <code>0</code>ï¼Œè¡¨ç¤ºå¯ä»¥å‘é€çª—å£æ¢æµ‹ï¼Œä»¥äº†è§£æœ€æ–°çš„çª—å£å¤§å°ã€‚</li><li>æ ¡éªŒå’Œï¼ˆ<code>Checksum</code>ï¼‰ï¼šå­—æ®µé•¿ <code>16</code> ä½ã€‚TCP çš„æ ¡éªŒå’Œå’Œ UDP ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äº TCP çš„æ ¡éªŒå’Œæ— æ³•å…³é—­ã€‚</li><li>ç´§æ€¥æŒ‡é’ˆï¼ˆ<code>Urgent Pointer</code>ï¼‰ï¼šå­—æ®µé•¿ <code>16</code> ä½ã€‚ä¸€èˆ¬åœ¨æš‚æ—¶ä¸­æ–­é€šä¿¡æ—¶ä½¿ç”¨ã€‚ä»æ•°æ®éƒ¨åˆ†çš„é¦–ä½åˆ°ç´§æ€¥æŒ‡é’ˆæ‰€æŒ‡ç¤ºçš„ä½ç½®ä¸ºæ­¢ä¸ºç´§æ€¥æ•°æ®ã€‚</li><li>é€‰é¡¹ï¼ˆ<code>Options</code>ï¼‰ï¼šç”¨äºæé«˜ TCP çš„ä¼ è¾“æ€§èƒ½ã€‚</li></ul><h1 id="è·¯ç”±åè®®"><a class="markdownIt-Anchor" href="#è·¯ç”±åè®®"></a> è·¯ç”±åè®®</h1><h2 id="é™æ€è·¯ç”±ä¸åŠ¨æ€è·¯ç”±"><a class="markdownIt-Anchor" href="#é™æ€è·¯ç”±ä¸åŠ¨æ€è·¯ç”±"></a> é™æ€è·¯ç”±ä¸åŠ¨æ€è·¯ç”±</h2><ul><li>é™æ€è·¯ç”±æ˜¯æŒ‡äº‹å…ˆè®¾ç½®å¥½è·¯ç”±å™¨å’Œä¸»æœºä¸­å¹¶å°†è·¯ç”±ä¿¡æ¯å›ºå®šçš„ä¸€ç§æ–¹æ³•ã€‚<ul><li>é™æ€è·¯ç”±é€šå¸¸ç”±ä½¿ç”¨è€…æ‰‹å·¥æ“ä½œå®Œæˆã€‚</li><li>ä¸€æ—¦æŸä¸ªè·¯ç”±å™¨å‘ç”Ÿæ•…éšœï¼ŒåŸºæœ¬ä¸Šæ— æ³•è‡ªåŠ¨ç»•è¿‡å‘ç”Ÿæ•…éšœçš„èŠ‚ç‚¹ã€‚</li></ul></li><li>åŠ¨æ€è·¯ç”±æ˜¯æŒ‡è®©è·¯ç”±åè®®åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨åœ°è®¾ç½®è·¯ç”±æ§åˆ¶ä¿¡æ¯çš„ä¸€ç§æ–¹æ³•ã€‚<ul><li>åŠ¨æ€è·¯ç”±è®¾å®šè¿‡ç¨‹çš„å¤æ‚ç¨‹åº¦ä¸å…·ä½“è¦è®¾ç½®è·¯ç”±åè®®çš„ç±»å‹æœ‰ç›´æ¥å…³ç³»ã€‚</li><li>åŠ¨æ€è·¯ç”±ä¼šç»™ç›¸é‚»è·¯ç”±å™¨å‘é€è‡ªå·±å·²çŸ¥çš„ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œç›´è‡³ç½‘ç»œä¼ é€’å®Œæˆï¼Œè·¯ç”±æ§åˆ¶è¡¨ä¹Ÿåˆ¶ä½œå®Œæˆã€‚</li><li>ä¸€æ—¦å‘ç”Ÿæ•…éšœï¼Œåªè¦æœ‰ä¸€ä¸ªå¯ç»•çš„è·¯å¾„ï¼Œæ•°æ®åŒ…å°±ä¼šè‡ªåŠ¨é€‰æ‹©è¿™ä¸ªè·¯å¾„ã€‚</li></ul></li></ul><h2 id="è·¯ç”±ç®—æ³•"><a class="markdownIt-Anchor" href="#è·¯ç”±ç®—æ³•"></a> è·¯ç”±ç®—æ³•</h2><h3 id="è·ç¦»çŸ¢é‡ç®—æ³•"><a class="markdownIt-Anchor" href="#è·ç¦»çŸ¢é‡ç®—æ³•"></a> è·ç¦»çŸ¢é‡ç®—æ³•</h3><p>è·ç¦»çŸ¢é‡ç®—æ³•ï¼ˆ<code>Distance-Vector</code>ï¼‰ç®—æ³•æ˜¯æ ¹æ®<strong>è·ç¦»</strong>å’Œ<strong>æ–¹å‘</strong>å†³å®šç›®æ ‡ç½‘ç»œæˆ–ç›®æ ‡ä¸»æœºä½ç½®çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>è·¯ç”±å™¨ä¹‹é—´å¯ä»¥äº’æ¢ç›®æ ‡ç½‘ç»œçš„æ–¹å‘åŠå…¶è·ç¦»çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä»¥è¿™äº›ä¿¡æ¯ä¸ºåŸºç¡€åˆ¶ä½œè·¯ç”±æ§åˆ¶è¡¨ã€‚å› æ­¤ï¼Œ<strong>æ¯ä¸€ä¸ªè·¯ç”±å™¨çš„ä½ç½®ä¸åŒï¼Œå®ƒä»¬çš„è·¯ç”±è¡¨ä¹Ÿæ˜¯ä¸åŒçš„ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201021142516.png" srcset="/img/loading.gif" alt="" /></p><h3 id="é“¾è·¯çŠ¶æ€ç®—æ³•"><a class="markdownIt-Anchor" href="#é“¾è·¯çŠ¶æ€ç®—æ³•"></a> é“¾è·¯çŠ¶æ€ç®—æ³•</h3><p>é“¾è·¯çŠ¶æ€ç®—æ³•æ˜¯è·¯ç”±å™¨åœ¨äº†è§£<strong>ç½‘ç»œæ•´ä½“çŠ¶æ€</strong>çš„åŸºç¡€ä¸Šç”Ÿæˆè·¯ç”±æ§åˆ¶è¡¨çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œ<strong>æ¯ä¸ªè·¯ç”±å™¨å¿…é¡»ä¿æŒåŒæ ·çš„ä¿¡æ¯</strong>æ‰èƒ½è¿›è¡Œæ­£ç¡®çš„è·¯ç”±é€‰æ‹©ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿è·¯ç”±ä¿¡æ¯è¾¾åˆ°ä¸€ä¸ªç¨³å®šçš„çŠ¶æ€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201021142452.png" srcset="/img/loading.gif" alt="" /></p><h3 id="ä¸»è¦è·¯ç”±åè®®"><a class="markdownIt-Anchor" href="#ä¸»è¦è·¯ç”±åè®®"></a> ä¸»è¦è·¯ç”±åè®®</h3><table><thead><tr><th style="text-align:center">è·¯ç”±åè®®</th><th style="text-align:center">ä¸‹ä¸€å±‚åè®®</th><th style="text-align:center">æ–¹å¼</th><th style="text-align:center">é€‚ç”¨èŒƒå›´</th><th style="text-align:center">å¾ªç¯æ£€æµ‹</th></tr></thead><tbody><tr><td style="text-align:center">RIP</td><td style="text-align:center">UDP</td><td style="text-align:center">è·ç¦»çŸ¢é‡</td><td style="text-align:center">è‡ªæ²»ç³»ç»Ÿå†…</td><td style="text-align:center">ä¸å¯ä»¥</td></tr><tr><td style="text-align:center">OSPF</td><td style="text-align:center">UDP</td><td style="text-align:center">é“¾è·¯çŠ¶æ€</td><td style="text-align:center">è‡ªæ²»ç³»ç»Ÿå†…</td><td style="text-align:center">å¯ä»¥</td></tr><tr><td style="text-align:center">EGP</td><td style="text-align:center">IP</td><td style="text-align:center">è·ç¦»çŸ¢é‡</td><td style="text-align:center">å¯¹å¤–è¿æ¥</td><td style="text-align:center">ä¸å¯ä»¥</td></tr><tr><td style="text-align:center">BGP</td><td style="text-align:center">IP</td><td style="text-align:center">è·¯å¾„çŸ¢é‡</td><td style="text-align:center">å¯¹å¤–è¿æ¥</td><td style="text-align:center">å¯ä»¥</td></tr></tbody></table><h2 id="rip"><a class="markdownIt-Anchor" href="#rip"></a> RIP</h2><p>ç‰¹ç‚¹ï¼š</p><ul><li>ä»…å’Œ<strong>ç›¸é‚»è·¯ç”±å™¨</strong>äº¤æ¢ä¿¡æ¯ã€‚</li><li>äº¤æ¢çš„ä¿¡æ¯æ˜¯å½“å‰æœ¬è·¯ç”±å™¨æ‰€çŸ¥é“çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå³è‡ªå·±çš„<strong>è·¯ç”±è¡¨</strong>ã€‚</li><li>æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”ï¼ˆ<code>30s</code>ï¼‰äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚</li></ul><p>è·¯ç”±è¡¨ä¸­çš„ä¸»è¦ä¿¡æ¯å°±æ˜¯ï¼šåˆ°æŸä¸ªç½‘ç»œçš„è·ç¦»ï¼ˆæœ€çŸ­è·ç¦»ï¼‰ï¼Œä»¥åŠç»è¿‡çš„ä¸‹ä¸€è·³åœ°å€ã€‚è·¯ç”±è¡¨æ›´æ–°çš„åŸåˆ™å°±æ˜¯<strong>æ‰¾å‡ºåˆ°æ¯ä¸ªç›®çš„ç½‘ç»œçš„æœ€çŸ­è·ç¦»</strong>ã€‚</p><p>RIP å­˜åœ¨çš„é—®é¢˜ï¼šç”±äºé‡‡ç”¨è·ç¦»çŸ¢é‡ç®—æ³•ï¼Œå½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼Œè¦ç»è¿‡è¾ƒé•¿æ—¶é—´æ‰èƒ½å°†æ­¤ä¿¡æ¯ä¼ é€åˆ°æ‰€æœ‰è·¯ç”±å™¨ã€‚</p><h2 id="ospf"><a class="markdownIt-Anchor" href="#ospf"></a> OSPF</h2><p>OPPF ä¸ºé“¾è·¯çŠ¶æ€å‹åè®®ï¼Œæ‰€ä»¥èƒ½æ£€æµ‹ç½‘ç»œä¸­çš„<strong>ç¯è·¯</strong>ã€‚</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>å‘æœ¬è‡ªæ²»ç³»ç»Ÿä¸­<strong>æ‰€æœ‰è·¯ç”±å™¨</strong>å‘é€ä¿¡æ¯ï¼Œä½¿ç”¨æ´ªæ³›æ³•ï¼ˆ<code>flooding</code>ï¼‰ã€‚</li><li>å‘é€çš„ä¿¡æ¯æ˜¯ä¸æœ¬è·¯ç”±å™¨ç›¸é‚»çš„æ‰€æœ‰è·¯ç”±å™¨çš„<strong>é“¾è·¯çŠ¶æ€</strong>ã€‚é“¾è·¯çŠ¶æ€å°±æ˜¯è¯´æ˜æœ¬è·¯ç”±å™¨å’Œå“ªäº›è·¯ç”±å™¨ç›¸é‚»ï¼Œä»¥åŠè¯¥é“¾è·¯çš„<code>ä»£ä»·</code>ï¼Œ<strong>OSPF æ€»æ˜¯é€‰æ‹©ä¸€ä¸ªæ€»ä»£ä»·æœ€å°çš„ä¸€æ¡è·¯å¾„</strong>ï¼Œè€Œ RIP é€‰æ‹©è·¯ç”±å™¨ä¸ªæ•°æœ€å°‘çš„è·¯å¾„ã€‚</li><li>åªæœ‰å½“<strong>é“¾è·¯çŠ¶æ€å˜</strong>åŒ–æ—¶ï¼Œè·¯ç”±å™¨æ‰å‘é€ä¿¡æ¯ã€‚</li></ul><p>å½“ç½‘ç»œçš„ä¸ªæ•°è¶Šå¤šï¼Œæ¯æ¬¡äº¤æ¢çš„è·¯ç”±ä¿¡æ¯å°±è¶Šå¤§ï¼Œå½“é“¾è·¯çŠ¶æ€å˜åŒ–è¾ƒå°æ—¶ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šæµªè´¹äº†ç½‘ç»œå¸¦å®½ã€‚ä¸ºäº†ä½¿ <strong>OSPF èƒ½å¤Ÿç”¨äºè§„æ¨¡å¾ˆå¤§çš„ç½‘ç»œ</strong>ï¼ŒOSPF å°†ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ›´å°çš„<strong>åŒºåŸŸ</strong>ï¼Œæ‰€æœ‰çš„å…¶ä»–åŒºåŸŸéƒ½å’Œ<code>ä¸»å¹²åŒºåŸŸï¼ˆBackbone Areaï¼‰</code>ç›¸è¿æ¥ï¼Œæ¯ä¸€ä¸ªåŒºåŸŸå†…éƒ¨äº¤æ¢è·¯ç”±ä¿¡æ¯çš„é€šä¿¡é‡å¤§å¤§å‡å°ã€‚</p><h2 id="bgp"><a class="markdownIt-Anchor" href="#bgp"></a> BGP</h2><p><code>BGP(Border Gateway Protocol)</code> æ˜¯è¿æ¥ä¸åŒè‡ªæ²»ç³»ç»Ÿçš„ä¸€ç§åè®®ï¼Œå®ƒå±äºå¤–éƒ¨ç½‘å…³åè®®ï¼ˆ<code>EGP</code>ï¼‰ã€‚</p><p>åœ¨ <code>RIP</code> å’Œ <code>OSPF</code> ä¸­åˆ©ç”¨ <code>IP</code> åœ°å€çš„ç½‘ç»œåœ°å€éƒ¨åˆ†è¿›è¡Œè·¯ç”±æ§åˆ¶ï¼Œç„¶è€Œ <code>BGP</code> éœ€è¦æ”¾çœ¼æ•´ä¸ªäº’è”ç½‘è¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚<code>BGP</code> çš„æœ€ç»ˆè·¯ç”±æ§åˆ¶è¡¨ç”±<strong>ç½‘ç»œåœ°å€</strong>å’Œ<strong>ä¸‹ä¸€ç«™çš„è·¯ç”±å™¨ç»„</strong>æ¥è¡¨ç¤ºï¼Œå®ƒä¼šæ ¹æ®æ‰€è¦ç»è¿‡çš„ <code>AS</code> ä¸ªæ•°è¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201021153257.png" srcset="/img/loading.gif" alt="" /></p><p>æ¯ä¸ª <code>AS</code> éƒ½æœ‰ä¸€ä¸ª <code>16 bit</code> çš„ <code>AS ç¼–å·</code>ï¼Œ<code>BGP</code> å°±æ˜¯æ ¹æ® <code>AS ç¼–å·</code>è¿›è¡Œè·¯ç”±æ§åˆ¶ã€‚<br />ä»£è¡¨æ•´ä¸ª AS ä¸å…¶å®ƒ AS äº¤æ¢è·¯ç”±æ§åˆ¶ä¿¡æ¯çš„è·¯ç”±å™¨å«åš BGP å‘è¨€äººï¼Œä¸€ä¸ª BGP å‘è¨€äººä¸å…¶å®ƒ AS çš„ BGP å‘è¨€äººè¦äº¤æ¢è·¯ç”±ä¿¡æ¯ï¼Œå°±è¦å…ˆå»ºç«‹ TCP è¿æ¥ã€‚</p><p>BGP ä¸­æ•°æ®åŒ…é€è¾¾ç›®æ ‡ç½‘ç»œæ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¸­é€”ç»è¿‡æ‰€æœ‰ AS çš„ç¼–å·åˆ—è¡¨ï¼ˆAS è·¯å¾„ä¿¡æ¯è®¿é—®åˆ—è¡¨<code>AS Path List</code>ï¼‰ã€‚åœ¨åšè·¯ç”±é€‰æ‹©æ—¶ï¼ŒBGP é€‰æ‹© AS æ•°æœ€å°‘çš„è·¯å¾„ã€‚</p><blockquote><p>è·¯å¾„å‘é‡ï¼ˆ<code>Path Vector</code>ï¼‰åè®®ï¼šå¯ä»¥æ£€æµ‹ç¯è·¯ï¼Œåœ¨ AS è·¯å¾„ä¿¡æ¯è®¿é—®åˆ—è¡¨ä¸­åŒ…å«è½¬å‘æ–¹å‘ã€è·ç¦»å’Œé€”å¾„æ‰€æœ‰ AS çš„ç¼–å·ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201021154457.png" srcset="/img/loading.gif" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 410. åˆ†å‰²æ•°ç»„çš„æœ€å¤§å€¼</title>
    <link href="/2020/10/14/LeetCode-410-split-array-largest-sum/"/>
    <url>/2020/10/14/LeetCode-410-split-array-largest-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/split-array-largest-sum/" target="_blank" rel="noopener">410. åˆ†å‰²æ•°ç»„çš„æœ€å¤§å€¼</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">splitArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> m)</span> </span>&#123;    <span class="hljs-comment">/* å­æ•°ç»„çš„æœ€å¤§å€¼ maxOfSub in [max(nums), sum(nums)]</span><span class="hljs-comment">         å½“åˆ†æˆ nums.length ä¸ªå­æ•°ç»„æ—¶ï¼ŒmaxOfSub æœ€å° = max(nums)</span><span class="hljs-comment">         å½“åˆ†æˆ 1 ä¸ªå­æ•°ç»„æ—¶ï¼ŒmaxOfSub æœ€å¤§ = sum(nums)</span><span class="hljs-comment">       åˆ†å‰²æ–¹æ¡ˆè¶Šå¤šï¼Œåˆ™ maxOfSub è¶Šå°ï¼Œåä¹‹è¶Šå¤§</span><span class="hljs-comment">       è‹¥ maxOfSub å¯¹åº”çš„åˆ†å‰²æ–¹æ¡ˆ &gt; mï¼Œè¯´æ˜ æ­¤æ—¶æ–¹æ¡ˆæ•°åº”å‡å°‘ï¼ŒmaxOfSub å¤ªå°ï¼Œåˆ™åº”å¢å¤§ maxOfSub</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span> left = nums[<span class="hljs-number">0</span>], right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        left = Math.max(left, num);        right += num;    &#125;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-comment">// å°è¯•ä»¥ mid ä¸ºå­æ•°ç»„çš„æœ€å¤§å’Œåˆ’åˆ†æ•°ç»„</span>        <span class="hljs-keyword">int</span> numOfSplit = splitBySubArraySum(mid, nums);        <span class="hljs-keyword">if</span> (numOfSplit &gt; m) &#123;            <span class="hljs-comment">// å­æ•°ç»„ä¸ªæ•°å¤ªå¤šï¼Œåˆ™å‡å°‘ä¸ªæ•°ï¼Œå¢å¤§å­æ ‘æ•°ç»„å’Œ</span>            left = mid + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * æ ¹æ®å­æ•°ç»„çš„å’Œè·å–åˆ’åˆ†çš„å­æ•°ç»„ä¸ªæ•°</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> maxSum å­æ•°ç»„çš„æœ€å¤§å’Œ</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> nums</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">splitBySubArraySum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> maxSum, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-comment">// è‡³å°‘å¯ä»¥åˆ’åˆ†æˆä¸€ä¸ªæ•°ç»„</span>    <span class="hljs-keyword">int</span> count = <span class="hljs-number">1</span>;    <span class="hljs-comment">// å½“å‰å­æ•°ç»„çš„å’Œ</span>    <span class="hljs-keyword">int</span> curSum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-comment">// è‹¥å½“å‰æ•° + å­æ•°ç»„çš„å’Œ &gt; æœ€å¤§å’Œï¼Œåˆ™åˆ’åˆ†ä¸€ä¸ªæ–°çš„å­æ•°ç»„</span>        <span class="hljs-keyword">if</span> (curSum + num &gt; maxSum) &#123;            count++;            <span class="hljs-comment">// é‡æ–°å¼€å§‹åˆ’åˆ†å­æ•°ç»„</span>            curSum = <span class="hljs-number">0</span>;        &#125;        curSum += num;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 875. çˆ±åƒé¦™è•‰çš„ç‚ç‚</title>
    <link href="/2020/10/14/LeetCode-875-koko-eating-bananas/"/>
    <url>/2020/10/14/LeetCode-875-koko-eating-bananas/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/koko-eating-bananas/" target="_blank" rel="noopener">875. çˆ±åƒé¦™è•‰çš„ç‚ç‚</a><br />å¯çœŸèƒ½åƒï¼Œä¸ä»…åƒå¾—å¤šï¼Œè¿˜åƒå¾—ä¹…ï¼Œè¿˜åƒè¶…æ—¶äº†ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minEatingSpeed</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] piles, <span class="hljs-keyword">int</span> H)</span> </span>&#123;    <span class="hljs-keyword">int</span> maxSpeed = piles[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : piles) &#123;        maxSpeed = Math.max(maxSpeed, num);    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>, right = maxSpeed;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-comment">// è®¡ç®— speed = mid æ—¶çš„è€—æ—¶</span>        <span class="hljs-keyword">int</span> eatTime = eatInSpeed(mid, piles);        <span class="hljs-comment">// System.out.println("left=" + left + " mid = " + mid + " right=" + right + " time=" + eatTime);</span>        <span class="hljs-keyword">if</span> (eatTime &gt; H) &#123;            <span class="hljs-comment">// åƒå¤ªä¹…äº†ï¼ŒåŠ å¿«é€Ÿåº¦ [mid + 1, right]</span>            left = mid + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">eatInSpeed</span><span class="hljs-params">(<span class="hljs-keyword">int</span> speed, <span class="hljs-keyword">int</span>[] piles)</span> </span>&#123;    <span class="hljs-comment">// è€—æ—¶</span>    <span class="hljs-keyword">int</span> time = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> pile : piles) &#123;        <span class="hljs-comment">// å‘ä¸Šå–æ•´</span>        time += (pile + speed - <span class="hljs-number">1</span>) / speed;    &#125;    <span class="hljs-keyword">return</span> time;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1292. å…ƒç´ å’Œå°äºç­‰äºé˜ˆå€¼çš„æ­£æ–¹å½¢çš„æœ€å¤§è¾¹é•¿</title>
    <link href="/2020/10/13/LeetCode-1292-maximum-side-length-of-a-square-with-sum-less-than-or-equal-to-threshold/"/>
    <url>/2020/10/13/LeetCode-1292-maximum-side-length-of-a-square-with-sum-less-than-or-equal-to-threshold/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-side-length-of-a-square-with-sum-less-than-or-equal-to-threshold/" target="_blank" rel="noopener">1292. å…ƒç´ å’Œå°äºç­‰äºé˜ˆå€¼çš„æ­£æ–¹å½¢çš„æœ€å¤§è¾¹é•¿</a></p><h1 id="å‰ç¼€å’Œ"><a class="markdownIt-Anchor" href="#å‰ç¼€å’Œ"></a> å‰ç¼€å’Œ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSideLength</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] mat, <span class="hljs-keyword">int</span> threshold)</span> </span>&#123;    <span class="hljs-keyword">int</span> m = mat.length, n = mat[<span class="hljs-number">0</span>].length;    <span class="hljs-comment">// è®¡ç®—å‰ç¼€å’Œ</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[m + <span class="hljs-number">1</span>][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;            dp[i][j] = mat[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>] - dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-comment">// æœ€å¤§çš„æ­£æ–¹å½¢è¾¹é•¿</span>    <span class="hljs-keyword">int</span> maxSideLen = Math.min(m, n);    <span class="hljs-comment">// éå†æ¯ä¸ªå¯èƒ½çš„è¾¹é•¿æ‰€ç»„æˆçš„æ­£æ–¹å½¢</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= maxSideLen; k++) &#123;        <span class="hljs-comment">// ä»¥ dp[i][j]ä¸ºå³ä¸‹è§’ è®¡ç®—æ­£æ–¹å½¢</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;                <span class="hljs-comment">// æ— æ³•ç»„æˆæ­£æ–¹å½¢</span>                <span class="hljs-keyword">if</span> (k &gt; i || k &gt; j) &#123;                    <span class="hljs-keyword">continue</span>;                &#125;                <span class="hljs-keyword">int</span> rect = dp[i][j] - dp[i - k][j] - dp[i][j - k] + dp[i - k][j - k];                <span class="hljs-comment">// æ›´æ–°æœ€å¤§è¾¹é•¿</span>                <span class="hljs-keyword">if</span> (rect &lt;= threshold) &#123;                    res = Math.max(k, res);                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="å‰ç¼€å’Œ-äºŒåˆ†"><a class="markdownIt-Anchor" href="#å‰ç¼€å’Œ-äºŒåˆ†"></a> å‰ç¼€å’Œ + äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSideLength</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] mat, <span class="hljs-keyword">int</span> threshold)</span> </span>&#123;    <span class="hljs-keyword">int</span> m = mat.length, n = mat[<span class="hljs-number">0</span>].length;    <span class="hljs-comment">// è®¡ç®—å‰ç¼€å’Œ</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[m + <span class="hljs-number">1</span>][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;            dp[i][j] = mat[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>] - dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-comment">// æœ€å¤§çš„æ­£æ–¹å½¢è¾¹é•¿</span>    <span class="hljs-keyword">int</span> right = Math.min(m, n);    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">boolean</span> canIncrease = verifyRect(dp, threshold, mid, m, n);        <span class="hljs-keyword">if</span> (canIncrease) &#123;            <span class="hljs-comment">// mid å¯¹åº”çš„æ­£æ–¹å½¢æ»¡è¶³è¦æ±‚ï¼Œå¯ä»¥å¢å¤§</span>            left = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid - <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ¤æ–­ä»¥ len ä¸ºè¾¹é•¿çš„æ­£æ–¹å½¢æ˜¯å¦èƒ½æ»¡è¶³ threshold</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> dp</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> threshold</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> len</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> m</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> n</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">verifyRect</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] dp, <span class="hljs-keyword">int</span> threshold, <span class="hljs-keyword">int</span> len, <span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-comment">// ä»¥ dp[i][j] ä¸ºå³ä¸‹è§’ è®¡ç®—æ­£æ–¹å½¢</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) &#123;            <span class="hljs-comment">// æ— æ³•ç»„æˆæ­£æ–¹å½¢</span>            <span class="hljs-keyword">if</span> (len &gt; i || len &gt; j) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">int</span> sum = dp[i][j] - dp[i - len][j] - dp[i][j - len] + dp[i - len][j - len];            <span class="hljs-keyword">if</span> (sum &lt;= threshold) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1283. ä½¿ç»“æœä¸è¶…è¿‡é˜ˆå€¼çš„æœ€å°é™¤æ•°</title>
    <link href="/2020/10/13/LeetCode-1283-find-the-smallest-divisor-given-a-threshold/"/>
    <url>/2020/10/13/LeetCode-1283-find-the-smallest-divisor-given-a-threshold/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-the-smallest-divisor-given-a-threshold/" target="_blank" rel="noopener">1283. ä½¿ç»“æœä¸è¶…è¿‡é˜ˆå€¼çš„æœ€å°é™¤æ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">smallestDivisor</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> threshold)</span> </span>&#123;    <span class="hljs-keyword">int</span> right = Integer.MIN_VALUE;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        right = Math.max(right, num);    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">int</span> sum = calcSum(nums, mid);        <span class="hljs-keyword">if</span> (sum &gt; threshold) &#123;            left = mid + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">calcSum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> divider)</span> </span>&#123;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-comment">// å‘ä¸Šå–æ•´æŠ€å·§ï¼Œå¿«å¾—å¾ˆï¼</span>        sum += (num + divider - <span class="hljs-number">1</span>) / divider;    &#125;    <span class="hljs-keyword">return</span> sum;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 287. å¯»æ‰¾é‡å¤æ•°</title>
    <link href="/2020/10/13/LeetCode-287-find-the-duplicate-number/"/>
    <url>/2020/10/13/LeetCode-287-find-the-duplicate-number/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-the-duplicate-number/" target="_blank" rel="noopener">287. å¯»æ‰¾é‡å¤æ•°</a></p><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findDuplicate</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// [2, 4, 5, 2, 3, 1, 6, 7]</span>    <span class="hljs-comment">// mid = 4, è‹¥ [left, mid] ä¸å­˜åœ¨é‡å¤å…ƒç´ </span>    <span class="hljs-comment">// åˆ™ [left, mid] ä¸­ &lt;= mid çš„å…ƒç´ ä¸ªæ•°æœ€å¤šä¸º mid ä¸ª</span>    <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>, right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = (left + right) &gt;&gt;&gt; <span class="hljs-number">1</span>;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-comment">// è®¡ç®— æ•°ç»„é‡Œå°äºç­‰äº mid çš„ä¸ªæ•°</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;            <span class="hljs-keyword">if</span> (num &lt;= mid) &#123;                count += <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-comment">// è‹¥ count &gt; midï¼Œåˆ™ [left, mid] å­˜åœ¨é‡å¤å…ƒç´ </span>        <span class="hljs-keyword">if</span> (count &gt; mid) &#123;            right = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;</code></pre><h1 id="å¿«æ…¢æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#å¿«æ…¢æŒ‡é’ˆ"></a> å¿«æ…¢æŒ‡é’ˆ</h1><p>åŸåœ°å“ˆå¸Œå’Œç¯å½¢é“¾è¡¨æ‰¾å…¥å£çš„æ€è·¯ç»“åˆã€‚<br /><a href="https://leetcode-cn.com/problems/first-missing-positive/" target="_blank" rel="noopener">41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</a><br /><a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/" target="_blank" rel="noopener">142. ç¯å½¢é“¾è¡¨ II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findDuplicate</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> slow = <span class="hljs-number">0</span>, fast = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;        fast = nums[nums[fast]];        slow = nums[slow];        <span class="hljs-comment">// fast = 2 * slow = slow + n * circle</span>        <span class="hljs-comment">// slow = n * circle</span>        <span class="hljs-keyword">if</span> (fast == slow) &#123;            <span class="hljs-keyword">break</span>;        &#125;    &#125;    <span class="hljs-comment">// ä»èµ·ç‚¹åŒæ—¶èµ° a æ­¥ï¼Œåœ¨ç¯çš„å…¥å£ç›¸é‡</span>    <span class="hljs-comment">// n * circle + a &lt;=&gt; 0 + a</span>    fast = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (fast != slow) &#123;        fast = nums[fast];        slow = nums[slow];    &#125;    <span class="hljs-keyword">return</span> slow;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTP åè®®</title>
    <link href="/2020/10/12/network-http/"/>
    <url>/2020/10/12/network-http/</url>
    
    <content type="html"><![CDATA[<h1 id="http-çŠ¶æ€ç "><a class="markdownIt-Anchor" href="#http-çŠ¶æ€ç "></a> HTTP çŠ¶æ€ç </h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013133853.jpg" srcset="/img/loading.gif" alt="" /></p><h2 id="1xx"><a class="markdownIt-Anchor" href="#1xx"></a> 1xx</h2><p>1xx ç±»çŠ¶æ€ç å±äº<strong>æç¤ºä¿¡æ¯</strong>ï¼Œæ˜¯åè®®å¤„ç†ä¸­çš„ä¸€ç§<strong>ä¸­é—´çŠ¶æ€</strong>ï¼Œå®é™…ç”¨åˆ°çš„æ¯”è¾ƒå°‘ã€‚</p><h2 id="2xx"><a class="markdownIt-Anchor" href="#2xx"></a> 2xx</h2><p>2xx ç±»çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨<strong>æˆåŠŸå¤„ç†</strong>äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><ul><li><p>ã€Œ<code>200 OK</code>ã€æ˜¯æœ€å¸¸è§çš„æˆåŠŸçŠ¶æ€ç ï¼Œè¡¨ç¤ºä¸€åˆ‡æ­£å¸¸ã€‚å¦‚æœæ˜¯é <code>HEAD</code> è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”å¤´éƒ½ä¼šæœ‰ <code>body</code> æ•°æ®ã€‚</p></li><li><p>ã€Œ<code>204 No Content</code>ã€ä¹Ÿæ˜¯å¸¸è§çš„æˆåŠŸçŠ¶æ€ç ï¼Œä¸ <code>200</code> åŸºæœ¬ç›¸åŒï¼Œä½†å“åº”å¤´æ²¡æœ‰ <code>body</code> æ•°æ®ã€‚</p></li><li><p>ã€Œ<code>206 Partial Content</code>ã€æ˜¯åº”ç”¨äº<strong>åˆ†å—ä¸‹è½½æˆ–æ–­ç‚¹ç»­ä¼ </strong>ï¼Œè¡¨ç¤ºå“åº”è¿”å›çš„ <code>body</code> æ•°æ®å¹¶ä¸æ˜¯èµ„æºçš„å…¨éƒ¨ï¼Œè€Œæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æœåŠ¡å™¨å¤„ç†æˆåŠŸçš„çŠ¶æ€ã€‚</p></li></ul><h2 id="3xx"><a class="markdownIt-Anchor" href="#3xx"></a> 3xx</h2><p>3xx ç±»çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå‘é€äº†å˜åŠ¨ï¼Œéœ€è¦å®¢æˆ·ç«¯ç”¨æ–°çš„ <code>URL</code> é‡æ–°å‘é€è¯·æ±‚è·å–èµ„æºï¼Œä¹Ÿå°±æ˜¯é‡å®šå‘ã€‚</p><ul><li>ã€Œ<code>301 Moved Permanently</code>ã€è¡¨ç¤º<strong>æ°¸ä¹…é‡å®šå‘</strong>ï¼Œè¯´æ˜è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨äº†ï¼Œéœ€æ”¹ç”¨æ–°çš„ <code>URL</code> å†æ¬¡è®¿é—®ã€‚</li><li>ã€Œ<code>302 Found</code>ã€è¡¨ç¤º<strong>ä¸´æ—¶é‡å®šå‘</strong>ï¼Œè¯´æ˜è¯·æ±‚çš„èµ„æºè¿˜åœ¨ï¼Œä½†æš‚æ—¶éœ€è¦ç”¨å¦ä¸€ä¸ª <code>URL</code> æ¥è®¿é—®ã€‚<br /><code>301</code> å’Œ <code>302</code> éƒ½ä¼šåœ¨å“åº”å¤´é‡Œä½¿ç”¨å­—æ®µ <code>Location</code>ï¼ŒæŒ‡æ˜åç»­è¦è·³è½¬çš„ <code>URL</code>ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨é‡å®šå‘æ–°çš„ URLã€‚</li><li>ã€Œ<code>304 Not Modified</code>ã€ä¸å…·æœ‰è·³è½¬çš„å«ä¹‰ï¼Œè¡¨ç¤º<strong>èµ„æºæœªä¿®æ”¹</strong>ï¼Œé‡å®šå‘å·²å­˜åœ¨çš„ç¼“å†²æ–‡ä»¶ï¼Œä¹Ÿç§°<strong>ç¼“å­˜é‡å®šå‘</strong>ï¼Œç”¨äº<strong>ç¼“å­˜æ§åˆ¶</strong>ã€‚</li></ul><h2 id="4xx"><a class="markdownIt-Anchor" href="#4xx"></a> 4xx</h2><p>4xx ç±»çŠ¶æ€ç è¡¨ç¤º<strong>å®¢æˆ·ç«¯å‘é€çš„æŠ¥æ–‡æœ‰è¯¯</strong>ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œä¹Ÿå°±æ˜¯é”™è¯¯ç çš„å«ä¹‰ã€‚</p><ul><li><p>ã€Œ<code>400 Bad Request</code>ã€è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„æŠ¥æ–‡æœ‰é”™è¯¯ï¼Œä½†åªæ˜¯ä¸ª<strong>ç¬¼ç»Ÿ</strong>çš„é”™è¯¯ã€‚</p></li><li><p>ã€Œ<code>401 Unauthorized</code>ã€è¡¨ç¤ºå®¢æˆ·ç«¯æœªæˆæƒï¼Œéœ€ç™»å½•åè®¿é—®ã€‚</p></li><li><p>ã€Œ<code>403 Forbidden</code>ã€è¡¨ç¤ºæœåŠ¡å™¨<strong>ç¦æ­¢è®¿é—®</strong>èµ„æºï¼Œå¹¶ä¸æ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚å‡ºé”™ã€‚</p></li><li><p>ã€Œ<code>404 Not Found</code>ã€è¡¨ç¤ºè¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨æˆ–æœªæ‰¾åˆ°ï¼Œæ‰€ä»¥æ— æ³•æä¾›ç»™å®¢æˆ·ç«¯ã€‚</p></li></ul><h2 id="5xx"><a class="markdownIt-Anchor" href="#5xx"></a> 5xx</h2><p>5xx ç±»çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æŠ¥æ–‡æ­£ç¡®ï¼Œä½†æ˜¯<strong>æœåŠ¡å™¨å¤„ç†æ—¶å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯</strong>ï¼Œå±äºæœåŠ¡å™¨ç«¯çš„é”™è¯¯ç ã€‚</p><ul><li><p>ã€Œ<code>500 Internal Server Error</code>ã€ä¸ 400 ç±»å‹ï¼Œæ˜¯ä¸ªç¬¼ç»Ÿé€šç”¨çš„é”™è¯¯ç ï¼ŒæœåŠ¡å™¨å‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚</p></li><li><p>ã€Œ<code>501 Not Implemented</code>ã€è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„<strong>åŠŸèƒ½è¿˜ä¸æ”¯æŒ</strong>ã€‚</p></li><li><p>ã€Œ<code>502 Bad Gateway</code>ã€é€šå¸¸æ˜¯æœåŠ¡å™¨ä½œä¸º<strong>ç½‘å…³æˆ–ä»£ç†</strong>æ—¶è¿”å›çš„é”™è¯¯ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è‡ªèº«å·¥ä½œæ­£å¸¸ï¼Œè®¿é—®åç«¯æœåŠ¡å™¨å‘ç”Ÿäº†é”™è¯¯ã€‚</p></li><li><p>ã€Œ<code>503 Service Unavailable</code>ã€è¡¨ç¤ºæœåŠ¡å™¨å½“å‰å¾ˆå¿™ï¼Œæš‚æ—¶<strong>æ— æ³•å“åº”</strong>æœåŠ¡å™¨ã€‚</p></li></ul><h1 id="http-é¦–éƒ¨"><a class="markdownIt-Anchor" href="#http-é¦–éƒ¨"></a> HTTP é¦–éƒ¨</h1><h2 id="æŠ¥æ–‡é¦–éƒ¨"><a class="markdownIt-Anchor" href="#æŠ¥æ–‡é¦–éƒ¨"></a> æŠ¥æ–‡é¦–éƒ¨</h2><h3 id="1-è¯·æ±‚æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#1-è¯·æ±‚æŠ¥æ–‡"></a> 1. è¯·æ±‚æŠ¥æ–‡</h3><p>åœ¨è¯·æ±‚ä¸­ï¼Œ<code>HTTP</code> æŠ¥æ–‡ç”± <code>æ–¹æ³•</code>ã€<code>URI</code>ã€<code>HTTP ç‰ˆæœ¬</code>ã€<code>HTTP é¦–éƒ¨å­—æ®µ</code> ç­‰éƒ¨åˆ†æ„æˆã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013140735.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs groovy">GET <span class="hljs-regexp">/ HTTP/</span><span class="hljs-number">1.1</span><span class="hljs-string">Host:</span> hackr.jpUser-<span class="hljs-string">Agent:</span> Mozilla<span class="hljs-regexp">/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/</span><span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">13.0</span><span class="hljs-string">Accept:</span> text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,*/</span>*; q=<span class="hljs-number">0.8</span>Accept-<span class="hljs-string">Language:</span> ja,en-us;q=<span class="hljs-number">0.7</span>,en;q=<span class="hljs-number">0.3</span>Accept-<span class="hljs-string">Encoding:</span> gzip, deflate <span class="hljs-string">DNT:</span> <span class="hljs-number">1</span><span class="hljs-string">Connection:</span> keep-aliveIf-Modified-<span class="hljs-string">Since:</span> Fri, <span class="hljs-number">31</span> Aug <span class="hljs-number">2007</span> <span class="hljs-number">02</span>:<span class="hljs-number">02</span>:<span class="hljs-number">20</span> GMTIf-None-<span class="hljs-string">Match:</span> <span class="hljs-string">"45bae1-16a-46d776ac"</span>Cache-<span class="hljs-string">Control:</span> max-age=<span class="hljs-number">0</span></code></pre><h3 id="2-å“åº”æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#2-å“åº”æŠ¥æ–‡"></a> 2. å“åº”æŠ¥æ–‡</h3><p>åœ¨å“åº”ä¸­ï¼Œ<code>HTTP</code> æŠ¥æ–‡ç”± <code>çŠ¶æ€ç </code>ã€<code>HTTP ç‰ˆæœ¬</code>ã€<code>HTTP é¦–éƒ¨å­—æ®µ</code> 3 éƒ¨åˆ†æ„æˆã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013141307.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs yaml"><span class="hljs-string">HTTP/1.1</span> <span class="hljs-number">304</span> <span class="hljs-string">Not</span> <span class="hljs-string">Modified</span><span class="hljs-attr">Date:</span> <span class="hljs-string">Thu,</span> <span class="hljs-number">07</span> <span class="hljs-string">Jun</span> <span class="hljs-number">2012</span> <span class="hljs-number">07</span><span class="hljs-string">:21:36</span> <span class="hljs-string">GMT</span><span class="hljs-attr">Server:</span> <span class="hljs-string">Apache</span><span class="hljs-attr">Connection:</span> <span class="hljs-string">close</span><span class="hljs-attr">Etag:</span> <span class="hljs-string">"45bae1-16a-46d776ac"</span></code></pre><h2 id="é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#é¦–éƒ¨å­—æ®µ"></a> é¦–éƒ¨å­—æ®µ</h2><p>HTTP é¦–éƒ¨å­—æ®µä»¥é”®å€¼å¯¹çš„å½¢å¼æ„æˆï¼Œå½“ HTTP æŠ¥æ–‡é¦–éƒ¨ä¸­å‡ºç°äº†ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šå…·æœ‰ç›¸åŒé¦–éƒ¨å­—æ®µåæ—¶ï¼Œ<strong>æ ¹æ®æµè§ˆå™¨å†…éƒ¨å¤„ç†é€»è¾‘çš„ä¸åŒï¼Œç»“æœå¯èƒ½å¹¶ä¸ä¸€è‡´</strong>ã€‚æœ‰äº›æµè§ˆå™¨ä¼šä¼˜å…ˆå¤„ç†ç¬¬ä¸€æ¬¡å‡ºç°çš„ é¦–éƒ¨å­—æ®µï¼Œè€Œæœ‰äº›åˆ™ä¼šä¼˜å…ˆå¤„ç†æœ€åå‡ºç°çš„é¦–éƒ¨å­—æ®µã€‚</p><h3 id="é¦–éƒ¨å­—æ®µç±»å‹"><a class="markdownIt-Anchor" href="#é¦–éƒ¨å­—æ®µç±»å‹"></a> é¦–éƒ¨å­—æ®µç±»å‹</h3><ol><li>é€šç”¨é¦–éƒ¨å­—æ®µï¼ˆ<code>General Header Fields</code>ï¼‰ï¼šè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ä¸¤æ–¹éƒ½ä¼šä½¿ç”¨çš„é¦–éƒ¨ã€‚</li><li>è¯·æ±‚é¦–éƒ¨å­—æ®µï¼ˆ<code>Request Header Fields</code>ï¼‰ï¼šä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†è¯·æ±‚çš„é™„åŠ å†…å®¹ã€å®¢æˆ·ç«¯ä¿¡æ¯ã€å“åº”å†…å®¹ç›¸å…³ä¼˜å…ˆçº§ç­‰ä¿¡æ¯ã€‚</li><li>å“åº”é¦–éƒ¨å­—æ®µï¼ˆ<code>Response Header Fields</code>ï¼‰ï¼šä»æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¿”å›å“åº”æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†å“åº”çš„é™„åŠ  å†…å®¹ï¼Œä¹Ÿä¼šè¦æ±‚å®¢æˆ·ç«¯é™„åŠ é¢å¤–çš„å†…å®¹ä¿¡æ¯ã€‚</li><li>å®ä½“é¦–éƒ¨å­—æ®µï¼ˆ<code>Entity Header Fields</code>ï¼‰ï¼šé’ˆå¯¹è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„å®ä½“éƒ¨åˆ†ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†èµ„æºå†…å®¹æ›´ æ–°æ—¶é—´ç­‰ä¸å®ä½“æœ‰å…³çš„ä¿¡æ¯ã€‚</li></ol><h3 id="http11-é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#http11-é¦–éƒ¨å­—æ®µ"></a> HTTP/1.1 é¦–éƒ¨å­—æ®µ</h3><h4 id="1-é€šç”¨é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#1-é€šç”¨é¦–éƒ¨å­—æ®µ"></a> 1. é€šç”¨é¦–éƒ¨å­—æ®µ</h4><table><thead><tr><th style="text-align:left">é¦–éƒ¨å­—æ®µå</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Cache-Control</td><td style="text-align:left">æ§åˆ¶ç¼“å­˜çš„è¡Œä¸º</td></tr><tr><td style="text-align:left">Connection</td><td style="text-align:left">é€è·³é¦–éƒ¨ã€è¿æ¥çš„ç®¡ç†</td></tr><tr><td style="text-align:left">Date</td><td style="text-align:left">åˆ›å»ºæŠ¥æ–‡çš„æ—¥æœŸæ—¶é—´</td></tr><tr><td style="text-align:left">Pragma</td><td style="text-align:left">æŠ¥æ–‡æŒ‡ä»¤</td></tr><tr><td style="text-align:left">Trailer</td><td style="text-align:left">æŠ¥æ–‡æœ«ç«¯çš„é¦–éƒ¨ä¸€è§ˆ</td></tr><tr><td style="text-align:left">Transfer-Encoding</td><td style="text-align:left">æŒ‡å®šæŠ¥æ–‡ä¸»ä½“çš„ä¼ è¾“ç¼–ç æ–¹å¼</td></tr><tr><td style="text-align:left">Upgrade</td><td style="text-align:left">å‡çº§ä¸ºå…¶ä»–åè®®</td></tr><tr><td style="text-align:left">Via</td><td style="text-align:left">ä»£ç†æœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯</td></tr><tr><td style="text-align:left">Warning</td><td style="text-align:left">é”™è¯¯é€šçŸ¥</td></tr></tbody></table><h4 id="2-è¯·æ±‚é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#2-è¯·æ±‚é¦–éƒ¨å­—æ®µ"></a> 2. è¯·æ±‚é¦–éƒ¨å­—æ®µ</h4><table><thead><tr><th style="text-align:left">é¦–éƒ¨å­—æ®µå</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Accept</td><td style="text-align:left">ç”¨æˆ·ä»£ç†å¯å¤„ç†çš„åª’ä½“ç±»å‹</td></tr><tr><td style="text-align:left">Accept-Charset</td><td style="text-align:left">ä¼˜å…ˆçš„å­—ç¬¦é›†</td></tr><tr><td style="text-align:left">Accept-Encoding</td><td style="text-align:left">ä¼˜å…ˆçš„å†…å®¹ç¼–ç </td></tr><tr><td style="text-align:left">Accept-Language</td><td style="text-align:left">ä¼˜å…ˆçš„è¯­è¨€ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰</td></tr><tr><td style="text-align:left">Authorization</td><td style="text-align:left">Webè®¤è¯ä¿¡æ¯</td></tr><tr><td style="text-align:left">Expect</td><td style="text-align:left">æœŸå¾…æœåŠ¡å™¨çš„ç‰¹å®šè¡Œä¸º</td></tr><tr><td style="text-align:left">From</td><td style="text-align:left">ç”¨æˆ·çš„ç”µå­é‚®ç®±åœ°å€</td></tr><tr><td style="text-align:left">Host</td><td style="text-align:left">è¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨</td></tr><tr><td style="text-align:left">If-Match</td><td style="text-align:left">æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆETagï¼‰</td></tr><tr><td style="text-align:left">If-Modified-Since</td><td style="text-align:left">æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´</td></tr><tr><td style="text-align:left">If-None-Match</td><td style="text-align:left">æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆä¸ If-Match ç›¸åï¼‰</td></tr><tr><td style="text-align:left">If-Range</td><td style="text-align:left">èµ„æºæœªæ›´æ–°æ—¶å‘é€å®ä½“ Byte çš„èŒƒå›´è¯·æ±‚</td></tr><tr><td style="text-align:left">If-Unmodified-Since</td><td style="text-align:left">æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´ï¼ˆä¸If-Modified-Sinceç›¸åï¼‰</td></tr><tr><td style="text-align:left">Max-Forwards</td><td style="text-align:left">æœ€å¤§ä¼ è¾“é€è·³æ•°</td></tr><tr><td style="text-align:left">Proxy-Authorization</td><td style="text-align:left">ä»£ç†æœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr><tr><td style="text-align:left">Range</td><td style="text-align:left">å®ä½“çš„å­—èŠ‚èŒƒå›´è¯·æ±‚</td></tr><tr><td style="text-align:left">Referer</td><td style="text-align:left">å¯¹è¯·æ±‚ä¸­ URI çš„åŸå§‹è·å–æ–¹</td></tr><tr><td style="text-align:left">TE</td><td style="text-align:left">ä¼ è¾“ç¼–ç çš„ä¼˜å…ˆçº§</td></tr><tr><td style="text-align:left">User-Agent</td><td style="text-align:left">HTTP å®¢æˆ·ç«¯ç¨‹åºçš„ä¿¡æ¯</td></tr></tbody></table><h4 id="3-å“åº”é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#3-å“åº”é¦–éƒ¨å­—æ®µ"></a> 3. å“åº”é¦–éƒ¨å­—æ®µ</h4><table><thead><tr><th style="text-align:left">é¦–éƒ¨å­—æ®µå</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Accept-Ranges</td><td style="text-align:left">æ˜¯å¦æ¥å—å­—èŠ‚èŒƒå›´è¯·æ±‚</td></tr><tr><td style="text-align:left">Age</td><td style="text-align:left">æ¨ç®—èµ„æºåˆ›å»ºç»è¿‡æ—¶é—´</td></tr><tr><td style="text-align:left">ETag</td><td style="text-align:left">èµ„æºçš„åŒ¹é…ä¿¡æ¯</td></tr><tr><td style="text-align:left">Location</td><td style="text-align:left">ä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®šURI</td></tr><tr><td style="text-align:left">Proxy-Authenticate</td><td style="text-align:left">ä»£ç†æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr><tr><td style="text-align:left">Retry-After</td><td style="text-align:left">å¯¹å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶æœºè¦æ±‚</td></tr><tr><td style="text-align:left">Server</td><td style="text-align:left">HTTPæœåŠ¡å™¨çš„å®‰è£…ä¿¡æ¯</td></tr><tr><td style="text-align:left">Vary</td><td style="text-align:left">ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†ä¿¡æ¯</td></tr><tr><td style="text-align:left">WWW-Authenticate</td><td style="text-align:left">æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr></tbody></table><h4 id="4-å®ä½“é¦–éƒ¨å­—æ®µ"><a class="markdownIt-Anchor" href="#4-å®ä½“é¦–éƒ¨å­—æ®µ"></a> 4. å®ä½“é¦–éƒ¨å­—æ®µ</h4><table><thead><tr><th style="text-align:left">é¦–éƒ¨å­—æ®µå</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">Allow</td><td style="text-align:left">èµ„æºå¯æ”¯æŒçš„HTTPæ–¹æ³•</td></tr><tr><td style="text-align:left">Content-Encoding</td><td style="text-align:left">å®ä½“ä¸»ä½“é€‚ç”¨çš„ç¼–ç æ–¹å¼</td></tr><tr><td style="text-align:left">Content-Language</td><td style="text-align:left">å®ä½“ä¸»ä½“çš„è‡ªç„¶è¯­è¨€</td></tr><tr><td style="text-align:left">Content-Length</td><td style="text-align:left">å®ä½“ä¸»ä½“çš„å¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</td></tr><tr><td style="text-align:left">Content-Location</td><td style="text-align:left">æ›¿ä»£å¯¹åº”èµ„æºçš„URI</td></tr><tr><td style="text-align:left">Content-MD5</td><td style="text-align:left">å®ä½“ä¸»ä½“çš„æŠ¥æ–‡æ‘˜è¦</td></tr><tr><td style="text-align:left">Content-Range</td><td style="text-align:left">å®ä½“ä¸»ä½“çš„ä½ç½®èŒƒå›´</td></tr><tr><td style="text-align:left">Content-Type</td><td style="text-align:left">å®ä½“ä¸»ä½“çš„åª’ä½“ç±»å‹</td></tr><tr><td style="text-align:left">Expires</td><td style="text-align:left">å®ä½“ä¸»ä½“è¿‡æœŸçš„æ—¥æœŸæ—¶é—´</td></tr><tr><td style="text-align:left">Last-Modified</td><td style="text-align:left">èµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸæ—¶é—´</td></tr></tbody></table><h1 id="getpost"><a class="markdownIt-Anchor" href="#getpost"></a> GET/POST</h1><table><thead><tr><th style="text-align:center">ç±»åˆ«</th><th style="text-align:center">GET</th><th style="text-align:center">POST</th></tr></thead><tbody><tr><td style="text-align:center">åŠŸèƒ½</td><td style="text-align:center"><strong>è·å–/æŸ¥è¯¢</strong> èµ„æºä¿¡æ¯</td><td style="text-align:center"><strong>æ›´æ–°</strong> èµ„æºä¿¡æ¯</td></tr><tr><td style="text-align:center">å‚æ•°</td><td style="text-align:center">URL / <strong>Body</strong></td><td style="text-align:center">Body</td></tr><tr><td style="text-align:center">é•¿åº¦</td><td style="text-align:center">å–å†³äº URL é•¿åº¦ï¼Œå—æµè§ˆå™¨å’ŒæœåŠ¡å™¨é™åˆ¶</td><td style="text-align:center">å¤§æ•°æ®</td></tr><tr><td style="text-align:center">æ•°æ®ç±»å‹</td><td style="text-align:center">ASCII å­—ç¬¦</td><td style="text-align:center">æ— é™åˆ¶ï¼Œå…è®¸äºŒè¿›åˆ¶æ•°æ®ã€‚</td></tr><tr><td style="text-align:center">ç¼“å­˜</td><td style="text-align:center">èƒ½è¢«ç¼“å­˜ï¼Œä½œä¸ºä¹¦ç­¾</td><td style="text-align:center">ä¸èƒ½ç¼“å­˜</td></tr><tr><td style="text-align:center">å®‰å…¨æ€§</td><td style="text-align:center">ä¸å®‰å…¨ï¼Œå‚æ•°ä¼šæ˜æ–‡æš´éœ²</td><td style="text-align:center">å®‰å…¨</td></tr><tr><td style="text-align:center">å¹‚ç­‰æ€§</td><td style="text-align:center">æ˜¯</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">TCP</td><td style="text-align:center">æŠŠè¯·æ±‚æŠ¥æ–‡ä¸€æ¬¡æ€§å‘å‡º</td><td style="text-align:center">åˆ†ä¸ºä¸¤ä¸ª TCP æ•°æ®åŒ…ï¼Œé¦–å…ˆå‘ header éƒ¨åˆ†ï¼Œå¦‚æœæœåŠ¡å™¨å“åº” 100(continue)ï¼Œ ç„¶åå‘ body éƒ¨åˆ†</td></tr></tbody></table><h1 id="http-https"><a class="markdownIt-Anchor" href="#http-https"></a> HTTP / HTTPS</h1><h2 id="http-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#http-ä¼˜ç¼ºç‚¹"></a> HTTP ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#ä¼˜ç‚¹"></a> ä¼˜ç‚¹</h3><p>HTTP æœ€å‡¸å‡ºçš„ä¼˜ç‚¹æ˜¯ã€Œ<strong>ç®€å•ã€çµæ´»å’Œæ˜“äºæ‰©å±•ã€åº”ç”¨å¹¿æ³›å’Œè·¨å¹³å°</strong>ã€ã€‚</p><ol><li><p>ç®€å•<br />HTTP åŸºæœ¬çš„æŠ¥æ–‡æ ¼å¼å°±æ˜¯ <code>header + body</code>ï¼Œå¤´éƒ¨ä¿¡æ¯ä¹Ÿæ˜¯ <code>key-value</code> ç®€å•æ–‡æœ¬çš„å½¢å¼ï¼Œæ˜“äºç†è§£ï¼Œé™ä½äº†å­¦ä¹ å’Œä½¿ç”¨çš„é—¨æ§›ã€‚</p></li><li><p>çµæ´»å’Œæ˜“äºæ‰©å±•<br />HTTPåè®®é‡Œçš„å„ç±»è¯·æ±‚æ–¹æ³•ã€<code>URI/URL</code>ã€çŠ¶æ€ç ã€å¤´å­—æ®µç­‰æ¯ä¸ªç»„æˆéƒ½å…è®¸å¼€å‘äººå‘˜<strong>è‡ªå®šä¹‰å’Œæ‰©å……</strong>ã€‚<br />åŒæ—¶ HTTP ç”±äºæ˜¯å·¥ä½œåœ¨åº”ç”¨å±‚ï¼Œåˆ™å®ƒä¸‹å±‚å¯ä»¥éšæ„å˜åŒ–ã€‚<br /><code>HTTPS</code> ä¹Ÿå°±æ˜¯åœ¨ <code>HTTP</code> ä¸ <code>TCP</code> å±‚ä¹‹é—´å¢åŠ äº† <code>SSL/TLS</code> å®‰å…¨ä¼ è¾“å±‚ï¼Œ<code>HTTP/3</code> ç”šè‡³æŠŠ <code>TCP</code> å±‚æ¢æˆäº†åŸºäº <code>UDP</code> çš„ <code>QUIC</code>ã€‚</p></li><li><p>åº”ç”¨å¹¿æ³›å’Œè·¨å¹³å°</p></li></ol><h3 id="ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#ç¼ºç‚¹"></a> ç¼ºç‚¹</h3><ol><li><p>æ— çŠ¶æ€<br /><code>HTTP</code> æ˜¯ä¸€ä¸ªæ— çŠ¶æ€åè®®ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå½±å“å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’ã€‚<br />å¯é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥ <code>Cookie</code> ä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚æˆ–è€…é€šè¿‡æœåŠ¡å™¨è®¾ç½® <code>Session</code> å°†ä¼šè¯ä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚</p></li><li><p>æ˜æ–‡ä¼ è¾“<br />é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ã€‚å¯ä»¥ç”¨ <code>HTTPS</code> çš„æ–¹å¼è§£å†³ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¼•å…¥ <code>SSL/TLS</code> å±‚ã€‚</p></li></ol><h2 id="http-å’Œ-https-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#http-å’Œ-https-çš„åŒºåˆ«"></a> HTTP å’Œ HTTPS çš„åŒºåˆ«</h2><ul><li><p>HTTP ä½¿ç”¨ <code>80</code> ç«¯å£ï¼ŒHTTPS ä½¿ç”¨ <code>443</code> ç«¯å£ã€‚</p></li><li><p>HTTPS åè®®éœ€è¦å‘ <code>CAï¼ˆè¯ä¹¦æƒå¨æœºæ„ï¼‰</code>ç”³è¯·<strong>æ•°å­—è¯ä¹¦</strong>ï¼Œæ¥ä¿è¯æœåŠ¡å™¨çš„èº«ä»½æ˜¯å¯ä¿¡çš„ã€‚</p></li><li><p>HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œæ˜¯<strong>æ˜æ–‡ä¼ è¾“</strong>ï¼›HTTPS æ˜¯ç»è¿‡ <strong><code>SSL</code> åŠ å¯†</strong>çš„åè®®ï¼Œä¼ è¾“æ›´åŠ å®‰å…¨ã€‚</p></li><li><p>HTTPS æ¯” HTTP æ…¢ã€‚</p><ul><li><strong>é€šä¿¡æ…¢</strong>ï¼šHTTPS å’Œ HTTP ç›¸æ¯”ï¼Œé™¤å» TCP è¿æ¥ã€å‘é€ HTTP è¯·æ±‚-å“åº”ä»¥å¤–ï¼Œè¿˜å¿…é¡»è¿›è¡Œ SSL é€šä¿¡ã€‚</li><li><strong>åŠ å¯†å¤„ç†</strong>ï¼šåŠ å¯†å’Œè§£å¯†è¿ç®—å¤„ç†è€—æ—¶ã€‚</li></ul></li></ul><h1 id="http1x-http2-http3"><a class="markdownIt-Anchor" href="#http1x-http2-http3"></a> HTTP/1.x, HTTP/2, HTTP/3</h1><h2 id="http1x-ç¼ºé™·"><a class="markdownIt-Anchor" href="#http1x-ç¼ºé™·"></a> HTTP/1.x ç¼ºé™·</h2><h3 id="1-è¿æ¥æ— æ³•å¤ç”¨"><a class="markdownIt-Anchor" href="#1-è¿æ¥æ— æ³•å¤ç”¨"></a> 1. è¿æ¥æ— æ³•å¤ç”¨</h3><p>è¿æ¥æ— æ³•å¤ç”¨ä¼šå¯¼è‡´<strong>æ¯æ¬¡è¯·æ±‚éƒ½ç»å†ä¸‰æ¬¡æ¡æ‰‹å’Œæ…¢å¯åŠ¨</strong>ã€‚ä¸‰æ¬¡æ¡æ‰‹åœ¨é«˜å»¶è¿Ÿçš„åœºæ™¯ä¸‹å½±å“è¾ƒæ˜æ˜¾ï¼Œæ…¢å¯åŠ¨åˆ™å¯¹å¤§é‡å°æ–‡ä»¶è¯·æ±‚å½±å“è¾ƒå¤§ï¼ˆæ²¡æœ‰è¾¾åˆ°æœ€å¤§çª—å£è¯·æ±‚å°±è¢«ç»ˆæ­¢ï¼‰ã€‚</p><ul><li><p><code>HTTP/1.0</code> ä½¿ç”¨çŸ­è¿æ¥ï¼Œä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯æ¬¡éƒ½éœ€è¦é‡æ–°å»ºç«‹è¿æ¥ï¼Œå¢åŠ å»¶è¿Ÿã€‚</p></li><li><p><code>HTTP/1.1</code> ä½¿ç”¨é•¿è¿æ¥ï¼ˆ<code>Connection: keep-alive</code>ï¼‰å¯ä»¥å¤ç”¨ä¸€éƒ¨åˆ†è¿æ¥ï¼Œä½†å¯¹äºå•ä¸ªæ–‡ä»¶è¢«ä¸æ–­è¯·æ±‚çš„æœåŠ¡ï¼Œ<code>keep-alive</code> å¯èƒ½ä¼šæå¤§çš„å½±å“æ€§èƒ½ï¼Œå› ä¸ºå®ƒåœ¨æ–‡ä»¶è¢«è¯·æ±‚ä¹‹åè¿˜ä¿æŒäº†ä¸å¿…è¦çš„è¿æ¥å¾ˆé•¿æ—¶é—´ã€‚</p></li></ul><h3 id="2-é˜Ÿå¤´é˜»å¡-head-of-line-blocking"><a class="markdownIt-Anchor" href="#2-é˜Ÿå¤´é˜»å¡-head-of-line-blocking"></a> 2. é˜Ÿå¤´é˜»å¡ (<code>Head-Of-Line Blocking</code>)</h3><p>å¯¼è‡´å¸¦å®½æ— æ³•è¢«å……åˆ†åˆ©ç”¨ï¼Œä»¥åŠåç»­è¯·æ±‚è¢«é˜»å¡ã€‚<code>HOLB</code> æ˜¯æŒ‡ä¸€ç³»åˆ—åŒ…ï¼ˆ<code>package</code>ï¼‰å› ä¸ºç¬¬ä¸€ä¸ªåŒ…è¢«é˜»å¡ï¼›å½“é¡µé¢ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šèµ„æºçš„æ—¶å€™ï¼Œä¼šå¯¼è‡´åœ¨è¾¾åˆ°æœ€å¤§è¯·æ±‚æ•°é‡æ—¶ï¼Œå‰©ä½™çš„èµ„æºéœ€è¦ç­‰å¾…å…¶ä»–èµ„æºè¯·æ±‚å®Œæˆåæ‰èƒ½å‘èµ·è¯·æ±‚ã€‚</p><ul><li><p><code>HTTP 1.0</code>ï¼šä¸‹ä¸ªè¯·æ±‚å¿…é¡»åœ¨å‰ä¸€ä¸ªè¯·æ±‚è¿”å›åæ‰èƒ½å‘å‡ºï¼Œ<code>request-response</code> æŒ‰åºå‘ç”Ÿã€‚æ˜¾ç„¶ï¼Œå¦‚æœæŸä¸ªè¯·æ±‚é•¿æ—¶é—´æ²¡æœ‰è¿”å›ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„è¯·æ±‚å°±å…¨éƒ¨é˜»å¡äº†ã€‚</p></li><li><p><code>HTTP 1.1</code>ï¼šå°è¯•ä½¿ç”¨ <code>ç®¡é“ç½‘ç»œä¼ è¾“ï¼ˆpipelingï¼‰</code> æ¥è§£å†³ï¼Œå³<strong>æµè§ˆå™¨å¯ä»¥ä¸€æ¬¡æ€§å‘å‡ºå¤šä¸ªè¯·æ±‚</strong>ï¼ˆåŒä¸ªåŸŸåï¼ŒåŒä¸€æ¡ <code>TCP</code> é“¾æ¥ï¼‰ã€‚ä½† <code>pipeling</code> è¦æ±‚è¿”å›æ˜¯æŒ‰åºçš„ï¼Œé‚£ä¹ˆå‰ä¸€ä¸ªè¯·æ±‚å¦‚æœå¾ˆè€—æ—¶ï¼Œé‚£ä¹ˆåé¢çš„è¯·æ±‚å³ä½¿æœåŠ¡å™¨å·²ç»å¤„ç†å®Œï¼Œä»ä¼šç­‰å¾…å‰é¢çš„è¯·æ±‚å¤„ç†å®Œæ‰å¼€å§‹æŒ‰åºè¿”å›ã€‚æ‰€ä»¥ï¼Œ<code>pipeling</code> åªéƒ¨åˆ†è§£å†³äº† <code>HOLB</code>ã€‚</p></li></ul><h3 id="3-åè®®å¼€é”€å¤§"><a class="markdownIt-Anchor" href="#3-åè®®å¼€é”€å¤§"></a> 3. åè®®å¼€é”€å¤§</h3><p><code>HTTP 1.x</code> åœ¨ä½¿ç”¨æ—¶ï¼Œ<code>header</code> é‡Œæºå¸¦çš„å†…å®¹è¿‡å¤§ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ä¼ è¾“çš„æˆæœ¬ï¼Œå¹¶ä¸”æ¯æ¬¡è¯·æ±‚ <code>header</code> åŸºæœ¬ä¸æ€ä¹ˆå˜åŒ–ï¼Œå°¤å…¶åœ¨ç§»åŠ¨ç«¯å¢åŠ ç”¨æˆ·æµé‡ã€‚</p><h3 id="4-å®‰å…¨å› ç´ "><a class="markdownIt-Anchor" href="#4-å®‰å…¨å› ç´ "></a> 4. å®‰å…¨å› ç´ </h3><p><code>HTTP 1.x</code> åœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œæ‰€æœ‰ä¼ è¾“çš„å†…å®¹éƒ½æ˜¯<strong>æ˜æ–‡</strong>ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ— æ³•ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><h2 id="http2-æ–°ç‰¹æ€§"><a class="markdownIt-Anchor" href="#http2-æ–°ç‰¹æ€§"></a> HTTP/2 æ–°ç‰¹æ€§</h2><h3 id="1-äºŒè¿›åˆ¶ä¼ è¾“"><a class="markdownIt-Anchor" href="#1-äºŒè¿›åˆ¶ä¼ è¾“"></a> 1. äºŒè¿›åˆ¶ä¼ è¾“</h3><p><code>HTTP/2</code> é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ä¼ è¾“æ•°æ®ï¼Œè€Œé <code>HTTP 1.x</code> çš„æ–‡æœ¬æ ¼å¼ï¼ŒäºŒè¿›åˆ¶åè®®è§£æèµ·æ¥æ›´é«˜æ•ˆã€‚ <code>HTTP 1.x</code> çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ï¼Œéƒ½æ˜¯ç”±èµ·å§‹è¡Œï¼Œé¦–éƒ¨å’Œå®ä½“æ­£æ–‡ï¼ˆå¯é€‰ï¼‰ç»„æˆï¼Œå„éƒ¨åˆ†ä¹‹é—´ä»¥æ–‡æœ¬æ¢è¡Œç¬¦åˆ†éš”ã€‚<strong><code>HTTP/2</code> å°†è¯·æ±‚å’Œå“åº”æ•°æ®åˆ†å‰²ä¸ºæ›´å°çš„å¸§ï¼Œå¹¶ä¸”å®ƒä»¬é‡‡ç”¨äºŒè¿›åˆ¶ç¼–ç ã€‚</strong></p><h3 id="2-å¤šè·¯å¤ç”¨"><a class="markdownIt-Anchor" href="#2-å¤šè·¯å¤ç”¨"></a> 2. å¤šè·¯å¤ç”¨</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013162824.png" srcset="/img/loading.gif" alt="" /></p><ul><li>åŒä¸ªåŸŸååªéœ€è¦å ç”¨ä¸€ä¸ª <code>TCP</code> è¿æ¥ï¼Œä½¿ç”¨ä¸€ä¸ªè¿æ¥å¹¶è¡Œå‘é€å¤šä¸ªè¯·æ±‚å’Œå“åº”,æ¶ˆé™¤äº†å› å¤šä¸ª <code>TCP</code> è¿æ¥è€Œå¸¦æ¥çš„å»¶æ—¶å’Œå†…å­˜æ¶ˆè€—ã€‚</li><li>å¹¶è¡Œäº¤é”™åœ°å‘é€å¤šä¸ªè¯·æ±‚ï¼Œè¯·æ±‚ä¹‹é—´äº’ä¸å½±å“ã€‚</li><li>å¹¶è¡Œäº¤é”™åœ°å‘é€å¤šä¸ªå“åº”ï¼Œå“åº”ä¹‹é—´äº’ä¸å¹²æ‰°ã€‚</li></ul><h3 id="3-å¤´éƒ¨å‹ç¼©"><a class="markdownIt-Anchor" href="#3-å¤´éƒ¨å‹ç¼©"></a> 3. å¤´éƒ¨å‹ç¼©</h3><p>åœ¨ <code>HTTP/1</code> ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–‡æœ¬çš„å½¢å¼ä¼ è¾“ <code>header</code>ï¼Œåœ¨ <code>header</code> æºå¸¦ <code>cookie</code> çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æ¯æ¬¡éƒ½éœ€è¦<strong>é‡å¤ä¼ è¾“</strong>å‡ ç™¾åˆ°å‡ åƒçš„å­—èŠ‚ã€‚</p><p>ä¸ºäº†å‡å°‘è¿™å—çš„èµ„æºæ¶ˆè€—å¹¶æå‡æ€§èƒ½ï¼Œ <code>HTTP/2</code> å¯¹è¿™äº›é¦–éƒ¨é‡‡å–äº†å‹ç¼©ç­–ç•¥ï¼š</p><ul><li><code>HTTP/2</code> åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨ <strong>é¦–éƒ¨è¡¨</strong> æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®ï¼å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚å’Œå“åº”å‘é€ï¼›</li><li>é¦–éƒ¨è¡¨åœ¨ <code>HTTP/2</code> çš„è¿æ¥å­˜ç»­æœŸå†…å§‹ç»ˆå­˜åœ¨ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒæ¸è¿›åœ°æ›´æ–°;</li><li>æ¯ä¸ªæ–°çš„é¦–éƒ¨é”®ï¼å€¼å¯¹è¦ä¹ˆè¢«è¿½åŠ åˆ°å½“å‰è¡¨çš„æœ«å°¾ï¼Œè¦ä¹ˆæ›¿æ¢è¡¨ä¸­ä¹‹å‰çš„å€¼</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013163221.png" srcset="/img/loading.gif" alt="" /></p><h3 id="4-æœåŠ¡ç«¯æ¨é€"><a class="markdownIt-Anchor" href="#4-æœåŠ¡ç«¯æ¨é€"></a> 4. æœåŠ¡ç«¯æ¨é€</h3><p>æŸäº›èµ„æºå®¢æˆ·ç«¯æ˜¯ä¸€å®šä¼šè¯·æ±‚çš„ï¼Œè¿™æ—¶å°±å¯ä»¥é‡‡å–æœåŠ¡ç«¯æ¨é€çš„æŠ€æœ¯ï¼Œæå‰ç»™å®¢æˆ·ç«¯æ¨é€å¿…è¦çš„èµ„æºï¼Œè¿™æ ·å°±å¯ä»¥ç›¸å¯¹å‡å°‘ä¸€ç‚¹å»¶è¿Ÿæ—¶é—´ã€‚</p><p>ä¾‹å¦‚æœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨æŠŠ JS å’Œ CSS æ–‡ä»¶æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸éœ€è¦å®¢æˆ·ç«¯è§£æ HTML æ—¶å†å‘é€è¿™äº›è¯·æ±‚ã€‚</p><p><strong>æœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨æ¨é€</strong>ï¼Œå®¢æˆ·ç«¯ä¹Ÿæœ‰æƒåˆ©é€‰æ‹©æ˜¯å¦æ¥æ”¶ã€‚å¦‚æœæœåŠ¡ç«¯æ¨é€çš„èµ„æºå·²ç»è¢«æµè§ˆå™¨ç¼“å­˜è¿‡ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡å‘é€ RST_STREAM å¸§æ¥æ‹’æ”¶ã€‚<strong>ä¸»åŠ¨æ¨é€ä¹Ÿéµå®ˆåŒæºç­–ç•¥</strong>ï¼Œæ¢å¥è¯è¯´ï¼ŒæœåŠ¡å™¨ä¸èƒ½éšä¾¿å°†ç¬¬ä¸‰æ–¹èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯ï¼Œè€Œå¿…é¡»æ˜¯ç»è¿‡åŒæ–¹ç¡®è®¤æ‰è¡Œã€‚</p><h2 id="http3-æ–°ç‰¹æ€§"><a class="markdownIt-Anchor" href="#http3-æ–°ç‰¹æ€§"></a> HTTP/3 æ–°ç‰¹æ€§</h2><p><code>HTTP/2</code> ä½¿ç”¨äº†å¤šè·¯å¤ç”¨ï¼Œä¸€èˆ¬æ¥è¯´åŒä¸€åŸŸåä¸‹åªéœ€è¦ä½¿ç”¨ä¸€ä¸ª <code>TCP</code> è¿æ¥ã€‚ä½†å½“è¿™ä¸ªè¿æ¥ä¸­å‡ºç°äº†ä¸¢åŒ…çš„æƒ…å†µï¼Œé‚£å°±ä¼šå¯¼è‡´ <code>HTTP/2</code> çš„è¡¨ç°æƒ…å†µåå€’ä¸å¦‚ <code>HTTP/1</code> äº†ã€‚</p><p><strong>å› ä¸ºåœ¨å‡ºç°ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œæ•´ä¸ª TCP éƒ½è¦å¼€å§‹ç­‰å¾…é‡ä¼ ï¼Œä¹Ÿå°±å¯¼è‡´äº†åé¢çš„æ‰€æœ‰æ•°æ®éƒ½è¢«é˜»å¡äº†ã€‚</strong> ä½†æ˜¯å¯¹äº <code>HTTP/1.1</code> æ¥è¯´ï¼Œå¯ä»¥å¼€å¯å¤šä¸ª <code>TCP</code> è¿æ¥ï¼Œå‡ºç°è¿™ç§æƒ…å†µååˆ°åªä¼šå½±å“å…¶ä¸­ä¸€ä¸ªè¿æ¥ï¼Œå‰©ä½™çš„ <code>TCP</code> è¿æ¥è¿˜å¯ä»¥æ­£å¸¸ä¼ è¾“æ•°æ®ã€‚<br />åŸºäºè¿™ä¸ªåŸå› ï¼ŒGoogle å¼€å‘äº†ä¸€ä¸ªåŸºäº <code>UDP</code> åè®®çš„ <code>QUIC</code> åè®®ï¼Œå¹¶ä¸”ä½¿ç”¨åœ¨äº† <code>HTTP/3</code> ä¸Šã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013164017.png" srcset="/img/loading.gif" alt="" /></p><h3 id="1-0-rtt"><a class="markdownIt-Anchor" href="#1-0-rtt"></a> 1. 0 RTT</h3><p><code>HTTP/1.x</code>ï¼Œ<code>HTTPS</code>ï¼Œ<code>HTTP2.0</code>ï¼Œéƒ½ä½¿ç”¨äº† <code>TCP</code> è¿›è¡Œä¼ è¾“ã€‚<code>HTTPS</code> å’Œ <code>HTTP2</code> è¿˜éœ€è¦ä½¿ç”¨ <code>TLS</code> åè®®æ¥è¿›è¡Œå®‰å…¨ä¼ è¾“ã€‚è¿™å°±å‡ºç°äº†ä¸¤ä¸ªæ¡æ‰‹å»¶è¿Ÿï¼Œè€ŒåŸºäº <code>UDP</code> åè®®çš„ <code>QUIC</code>ï¼Œ<strong>å› ä¸º UDP æœ¬èº«æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µï¼Œè¿æ¥å»ºç«‹æ—¶åªéœ€è¦ä¸€æ¬¡äº¤äº’ï¼ŒåŠä¸ªæ¡æ‰‹çš„æ—¶é—´ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013164452.png" srcset="/img/loading.gif" alt="" /></p><h3 id="2-å¤šè·¯å¤ç”¨-2"><a class="markdownIt-Anchor" href="#2-å¤šè·¯å¤ç”¨-2"></a> 2. å¤šè·¯å¤ç”¨</h3><p>åŒ <code>HTTP2.0</code> ä¸€æ ·ï¼ŒåŒä¸€æ¡ <code>QUIC</code> è¿æ¥ä¸Šå¯ä»¥åˆ›å»ºå¤šä¸ª <code>stream</code>ï¼Œæ¥å‘é€å¤šä¸ª <code>HTTP</code> è¯·æ±‚ï¼Œä½†æ˜¯ï¼Œ<code>QUIC</code> æ˜¯åŸºäº <code>UDP</code> çš„ï¼Œ<strong>ä¸€ä¸ªè¿æ¥ä¸Šçš„å¤šä¸ª <code>stream</code> ä¹‹é—´æ²¡æœ‰ä¾èµ–</strong>ï¼Œæ‰€ä»¥å½“å‘ç”Ÿä¸¢åŒ…æ—¶ï¼Œåªä¼šå½±å“å½“å‰çš„ <code>stream</code>ï¼Œä¹Ÿå°±é¿å…äº†çº¿å¤´é˜»å¡é—®é¢˜ã€‚</p><p>æ¯”å¦‚ä¸‹å›¾ä¸­ <code>stream2</code> ä¸¢äº†ä¸€ä¸ª <code>UDP</code> åŒ…ï¼Œä¸ä¼šå½±å“åé¢è·Ÿç€ <code>Stream3</code> å’Œ <code>Stream4</code>ï¼Œä¸å­˜åœ¨ <code>TCP</code> é˜Ÿå¤´é˜»å¡ã€‚è™½ç„¶ <code>stream2</code> çš„é‚£ä¸ªåŒ…éœ€è¦é‡æ–°ä¼ ï¼Œä½†æ˜¯ <code>stream3</code>ã€<code>stream4</code> çš„åŒ…æ— éœ€ç­‰å¾…ï¼Œå°±å¯ä»¥å‘ç»™ç”¨æˆ·ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201013164652.png" srcset="/img/loading.gif" alt="" /></p><p>å¦å¤– <code>QUIC</code> åœ¨<strong>ç§»åŠ¨ç«¯</strong>çš„è¡¨ç°ä¹Ÿä¼šæ¯” <code>TCP</code> å¥½ã€‚å› ä¸º <code>TCP</code> æ˜¯åŸºäº <code>IP</code> å’Œ<strong>ç«¯å£</strong>å»è¯†åˆ«è¿æ¥çš„ï¼Œè¿™ç§æ–¹å¼åœ¨å¤šå˜çš„ç§»åŠ¨ç«¯ç½‘ç»œç¯å¢ƒä¸‹æ˜¯å¾ˆè„†å¼±çš„ã€‚ä½†æ˜¯ <code>QUIC</code> æ˜¯é€šè¿‡ <code>ID</code> çš„æ–¹å¼å»è¯†åˆ«ä¸€ä¸ªè¿æ¥ï¼Œä¸ç®¡ä½ ç½‘ç»œç¯å¢ƒå¦‚ä½•å˜åŒ–ï¼Œåªè¦ <code>ID</code> ä¸å˜ï¼Œå°±èƒ½è¿…é€Ÿé‡è¿ä¸Šã€‚</p><h3 id="3-æŠ¥æ–‡åŠ å¯†"><a class="markdownIt-Anchor" href="#3-æŠ¥æ–‡åŠ å¯†"></a> 3. æŠ¥æ–‡åŠ å¯†</h3><p><code>TCP</code> åè®®å¤´éƒ¨æ²¡æœ‰ç»è¿‡ä»»ä½•åŠ å¯†å’Œè®¤è¯ï¼Œæ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“è¢«ä¸­é—´ç½‘ç»œè®¾å¤‡ç¯¡æ”¹ï¼Œæ³¨å…¥å’Œçªƒå¬ã€‚</p><p>è€Œ <code>QUIC</code> æ‰€æœ‰<strong>æŠ¥æ–‡å¤´éƒ¨</strong>éƒ½æ˜¯ç»è¿‡è®¤è¯çš„ï¼ŒæŠ¥æ–‡ <code>Body</code> éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„ã€‚è¿™æ ·åªè¦å¯¹ <code>QUIC</code> æŠ¥æ–‡ä»»ä½•ä¿®æ”¹ï¼Œæ¥æ”¶ç«¯éƒ½èƒ½å¤ŸåŠæ—¶å‘ç°ï¼Œæœ‰æ•ˆåœ°é™ä½äº†å®‰å…¨é£é™©ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 530. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®</title>
    <link href="/2020/10/12/LeetCode-530-minimum-absolute-difference-in-bst/"/>
    <url>/2020/10/12/LeetCode-530-minimum-absolute-difference-in-bst/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst/" target="_blank" rel="noopener">530. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®</a></p><h1 id="è¿­ä»£"><a class="markdownIt-Anchor" href="#è¿­ä»£"></a> è¿­ä»£</h1><p>ä¸­åºéå†</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getMinimumDifference</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    ArrayDeque&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    TreeNode curNode = root;    <span class="hljs-keyword">int</span> pre = Integer.MAX_VALUE, res = Integer.MAX_VALUE;    <span class="hljs-keyword">while</span> (!stack.isEmpty() || curNode != <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">while</span> (curNode != <span class="hljs-keyword">null</span>) &#123;            stack.push(curNode);            curNode = curNode.left;        &#125;        TreeNode top = stack.pop();        <span class="hljs-comment">// è®¡ç®—å½“å‰ç»“ç‚¹å’Œä¸Šä¸€ä¸ªç»“ç‚¹çš„å·®å€¼</span>        res = Math.min(Math.abs(top.val - pre), res);        <span class="hljs-comment">// å½“å‰å€¼ä½œä¸º pre</span>        pre = top.val;        <span class="hljs-comment">// éå†å³å­æ ‘</span>        curNode = top.right;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="é€’å½’"><a class="markdownIt-Anchor" href="#é€’å½’"></a> é€’å½’</h1><pre><code class="hljs java"><span class="hljs-keyword">int</span> res = Integer.MAX_VALUE;TreeNode prevNode;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getMinimumDifference</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    inOrder(root);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">inOrder</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// éå†å·¦å­æ ‘</span>    inOrder(root.left);    <span class="hljs-comment">// è®¡ç®—æœ€å°å·®å€¼</span>    <span class="hljs-keyword">if</span> (prevNode != <span class="hljs-keyword">null</span>) &#123;        res = Math.min(res, root.val - prevNode.val);    &#125;    <span class="hljs-comment">// æ›´æ–°å‰ä¸€ä¸ªç»“ç‚¹</span>    prevNode = root;    <span class="hljs-comment">// éå†å³å­æ ‘</span>    inOrder(root.right);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ‘</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°</title>
    <link href="/2020/10/12/LeetCode-4-median-of-two-sorted-arrays/"/>
    <url>/2020/10/12/LeetCode-4-median-of-two-sorted-arrays/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays/" target="_blank" rel="noopener">4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">findMedianSortedArrays</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2)</span> </span>&#123;    <span class="hljs-keyword">int</span> m = nums1.length, n = nums2.length;    <span class="hljs-keyword">int</span> len = m + n;    <span class="hljs-comment">// nums1, nums2 å¯¹åº”æŒ‡é’ˆ</span>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;    <span class="hljs-comment">// ä¸Šä¸€æ¬¡éå†åˆ°çš„æ•°ï¼Œå½“å‰éå†åˆ°çš„æ•°</span>    <span class="hljs-keyword">int</span> prev = -<span class="hljs-number">1</span>, cur = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= len / <span class="hljs-number">2</span>; k++) &#123;        prev = cur;        <span class="hljs-comment">// åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­å–å°çš„æ•°å¾€åç§»</span>        <span class="hljs-keyword">if</span> (i == m) &#123;            <span class="hljs-comment">// nums1 éå†å®Œæˆ</span>            cur = nums2[j++];        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j == n) &#123;            <span class="hljs-comment">// nums2 éå†å®Œæˆ</span>            cur = nums1[i++];        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums1[i] &lt; nums2[j]) &#123;            cur = nums1[i++];        &#125; <span class="hljs-keyword">else</span> &#123;            cur = nums2[j++];        &#125;    &#125;    <span class="hljs-keyword">if</span> (len % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> (prev + cur) / <span class="hljs-number">2.0</span>;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">return</span> cur;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1300. è½¬å˜æ•°ç»„åæœ€æ¥è¿‘ç›®æ ‡å€¼çš„æ•°ç»„å’Œ</title>
    <link href="/2020/10/12/LeetCode-1300-sum-of-mutated-array-closest-to-target/"/>
    <url>/2020/10/12/LeetCode-1300-sum-of-mutated-array-closest-to-target/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sum-of-mutated-array-closest-to-target/" target="_blank" rel="noopener">1300. è½¬å˜æ•°ç»„åæœ€æ¥è¿‘ç›®æ ‡å€¼çš„æ•°ç»„å’Œ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findBestValue</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = arr.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> max = arr[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        max = Math.max(max, num);    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = max;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">int</span> sum = getSum(arr, mid);        <span class="hljs-keyword">if</span> (sum == target) &#123;            <span class="hljs-keyword">return</span> mid;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// çœ‹ mid å’Œ mid - 1 å“ªä¸ªçš„å’Œæ›´æ¥è¿‘ target</span>            <span class="hljs-keyword">int</span> prev = Math.abs(getSum(arr, mid - <span class="hljs-number">1</span>) - target);            <span class="hljs-keyword">int</span> midVal = Math.abs(sum - target);            <span class="hljs-keyword">if</span> (prev &lt;= midVal) &#123;                right = mid - <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                left = mid;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getSum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> val)</span> </span>&#123;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        sum += Math.min(num, val);    &#125;    <span class="hljs-keyword">return</span> sum;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1237. æ‰¾å‡ºç»™å®šæ–¹ç¨‹çš„æ­£æ•´æ•°è§£</title>
    <link href="/2020/10/10/LeetCode-1237-find-positive-integer-solution-for-a-given-equation/"/>
    <url>/2020/10/10/LeetCode-1237-find-positive-integer-solution-for-a-given-equation/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-positive-integer-solution-for-a-given-equation/" target="_blank" rel="noopener">1237. æ‰¾å‡ºç»™å®šæ–¹ç¨‹çš„æ­£æ•´æ•°è§£</a></p><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; findSolution(CustomFunction customfunction, <span class="hljs-keyword">int</span> z) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-comment">// x: 1 -&gt; z</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= z; i++) &#123;        <span class="hljs-comment">// x: 1 -&gt; z äºŒåˆ†</span>        <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>, right = z;        <span class="hljs-keyword">while</span> (left &lt;= right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">if</span> (customfunction.f(i, mid) == z) &#123;                List&lt;Integer&gt; pair = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();                pair.add(i);                pair.add(mid);                res.add(pair);                <span class="hljs-keyword">break</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (customfunction.f(i, mid) &gt; z) &#123;                right = mid - <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                left = mid + <span class="hljs-number">1</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; findSolution(CustomFunction customfunction, <span class="hljs-keyword">int</span> z) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> low = <span class="hljs-number">1</span>, high = z;    <span class="hljs-keyword">while</span> (low &lt;= z &amp;&amp; high &gt;= <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">int</span> r = customfunction.f(low, high);        <span class="hljs-keyword">if</span> (r &gt; z) &#123;            high--;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (r &lt; z) &#123;            low++;        &#125; <span class="hljs-keyword">else</span> &#123;            List&lt;Integer&gt; pair = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();            pair.add(low);            pair.add(high);            res.add(pair);            low++;            high--;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1095. å±±è„‰æ•°ç»„ä¸­æŸ¥æ‰¾ç›®æ ‡å€¼</title>
    <link href="/2020/10/10/LeetCode-1095-find-in-mountain-array/"/>
    <url>/2020/10/10/LeetCode-1095-find-in-mountain-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-in-mountain-array/" target="_blank" rel="noopener">1095. å±±è„‰æ•°ç»„ä¸­æŸ¥æ‰¾ç›®æ ‡å€¼</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findInMountainArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span> target, MountainArray mountainArr)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = mountainArr.length();        <span class="hljs-comment">// è·å–å±±é¡¶</span>        <span class="hljs-keyword">int</span> top = getTop(len, mountainArr);        <span class="hljs-comment">// åœ¨å·¦è¾¹æŸ¥æ‰¾</span>        <span class="hljs-keyword">int</span> ascPos = findInAsc(<span class="hljs-number">0</span>, top, target, mountainArr);        <span class="hljs-keyword">if</span> (ascPos != -<span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> ascPos;        &#125;        <span class="hljs-comment">// åœ¨å³è¾¹æŸ¥æ‰¾</span>        <span class="hljs-keyword">return</span> findInDesc(top, len - <span class="hljs-number">1</span>, target, mountainArr);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findInAsc</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target, MountainArray mountainArr)</span> </span>&#123;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">int</span> midVal = mountainArr.get(mid);            <span class="hljs-keyword">if</span> (midVal == target) &#123;                <span class="hljs-keyword">return</span> mid;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (midVal &gt; target) &#123;                right = mid;            &#125; <span class="hljs-keyword">else</span> &#123;                left = mid + <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> mountainArr.get(left) == target ? left : -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findInDesc</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target, MountainArray mountainArr)</span> </span>&#123;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">int</span> midVal = mountainArr.get(mid);            <span class="hljs-keyword">if</span> (midVal == target) &#123;                <span class="hljs-keyword">return</span> mid;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (midVal &gt; target) &#123;                left = mid + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                right = mid;            &#125;        &#125;        <span class="hljs-keyword">return</span> mountainArr.get(left) == target ? left : -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getTop</span><span class="hljs-params">(<span class="hljs-keyword">int</span> len, MountainArray mountainArr)</span> </span>&#123;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = len - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-comment">// 3, 4, 5, 2, 1</span>            <span class="hljs-keyword">if</span> (mountainArr.get(mid) &lt; mountainArr.get(mid + <span class="hljs-number">1</span>)) &#123;                left = mid + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                right = mid;            &#125;        &#125;        <span class="hljs-keyword">return</span> left;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 436. å¯»æ‰¾å³åŒºé—´</title>
    <link href="/2020/10/10/LeetCode-436-find-right-interval/"/>
    <url>/2020/10/10/LeetCode-436-find-right-interval/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-right-interval/" target="_blank" rel="noopener">436. å¯»æ‰¾å³åŒºé—´</a></p><ul><li>åŒºé—´çš„ç»ˆç‚¹æ€»æ˜¯å¤§äºå®ƒçš„èµ·å§‹ç‚¹ =&gt; åªéœ€è¦æ¯”è¾ƒèµ·ç‚¹ã€‚</li><li>åŒºé—´éƒ½ä¸å…·æœ‰ç›¸åŒçš„èµ·å§‹ç‚¹ =&gt; å¯ä»¥ä¿å­˜æ’åºå‰çš„<strong>èµ·ç‚¹</strong>å’Œ<strong>ç´¢å¼•</strong>çš„å…³ç³»ã€‚</li></ul><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] findRightInterval(<span class="hljs-keyword">int</span>[][] intervals) &#123;    <span class="hljs-keyword">int</span> len = intervals.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span>[] starts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// å­˜å‚¨èµ·ç‚¹</span>        starts[i] = intervals[i][<span class="hljs-number">0</span>];        <span class="hljs-comment">// å­˜å‚¨æ¯ä¸ªèµ·ç‚¹çš„åŸå§‹ä½ç½®</span>        map.put(intervals[i][<span class="hljs-number">0</span>], i);    &#125;    Arrays.sort(starts);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// åœ¨èµ·ç‚¹æ•°ç»„ä¸­æŸ¥æ‰¾èµ·ç‚¹ï¼Œè¯¥èµ·ç‚¹ &gt;= åŒºé—´ i çš„ç»ˆç‚¹</span>        <span class="hljs-keyword">int</span> index = binarySearch(starts, intervals[i][<span class="hljs-number">1</span>]);        res[i] = index == -<span class="hljs-number">1</span> ? -<span class="hljs-number">1</span> : map.get(starts[index]);    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * æŸ¥æ‰¾ç¬¬ä¸€ä¸ª &gt;= end çš„åŒºé—´èµ·ç‚¹</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> starts</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> end</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] starts, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = starts.length;    <span class="hljs-keyword">if</span> (starts[len - <span class="hljs-number">1</span>] &lt; end) &#123;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (starts[mid] &lt; end) &#123;            left = mid + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            right = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> left;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 275. H æŒ‡æ•° II</title>
    <link href="/2020/10/09/LeetCode-275-h-index-ii/"/>
    <url>/2020/10/09/LeetCode-275-h-index-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/h-index-ii/" target="_blank" rel="noopener">275. H æŒ‡æ•° II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] citations)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = citations.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span> || citations[len - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-comment">// å¼•ç”¨æ¬¡æ•°ï¼šcitations[h]</span>        <span class="hljs-comment">// è®ºæ–‡æ•°ï¼šlen - h</span>        <span class="hljs-comment">// h index : (å¼•ç”¨æ¬¡æ•° &gt;= h çš„è®ºæ–‡æ•°) &gt;= h ç¯‡</span>        <span class="hljs-keyword">if</span> (citations[mid] &gt;= len - mid) &#123;            right = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> len - left;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 57 - II. å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ—</title>
    <link href="/2020/10/09/LeetCode-offer-57-II-he-wei-sde-lian-xu-zheng-shu-xu-lie-lcof/"/>
    <url>/2020/10/09/LeetCode-offer-57-II-he-wei-sde-lian-xu-zheng-shu-xu-lie-lcof/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/he-wei-sde-lian-xu-zheng-shu-xu-lie-lcof/" target="_blank" rel="noopener">å‰‘æŒ‡ Offer 57 - II. å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ—</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] findContinuousSequence(<span class="hljs-keyword">int</span> target) &#123;    List&lt;<span class="hljs-keyword">int</span>[]&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">1</span>, right = <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = target / <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (right &lt;= len) &#123;        sum += right;        right++;        <span class="hljs-keyword">while</span> (sum &gt; target) &#123;            sum -= left;            left++;        &#125;        <span class="hljs-keyword">if</span> (sum == target) &#123;            <span class="hljs-keyword">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[right - left];            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = left, j = <span class="hljs-number">0</span>; i &lt; right; i++) &#123;                arr[j++] = i;            &#125;            list.add(arr);        &#125;    &#125;    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[list.size()][];    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] arr : list) &#123;        res[i++] = arr;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>å‰‘æŒ‡ Offer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ æ­»é”</title>
    <link href="/2020/10/09/os-deadlock/"/>
    <url>/2020/10/09/os-deadlock/</url>
    
    <content type="html"><![CDATA[<h1 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h1><p>å¤§éƒ¨åˆ†çš„æ­»é”éƒ½å’Œèµ„æºæœ‰å…³ï¼Œåœ¨è¿›ç¨‹å¯¹è®¾å¤‡ã€æ–‡ä»¶å…·æœ‰<strong>ç‹¬å æ€§</strong>ï¼ˆæ’ä»–æ€§ï¼‰æ—¶ä¼šäº§ç”Ÿæ­»é”ã€‚æˆ‘ä»¬æŠŠè¿™ç±»éœ€è¦æ’ä»–æ€§ä½¿ç”¨çš„å¯¹è±¡ç§°ä¸º <code>èµ„æº(resource)</code>ã€‚</p><p>èµ„æºä¸»è¦æœ‰å¯æŠ¢å èµ„æºå’Œä¸å¯æŠ¢å èµ„æºã€‚</p><ul><li><code>å¯æŠ¢å èµ„æº(preemptable resource)</code> å¯ä»¥ä»æ‹¥æœ‰å®ƒçš„è¿›ç¨‹ä¸­æŠ¢å è€Œä¸ä¼šé€ æˆå…¶ä»–å½±å“ï¼Œå†…å­˜å°±æ˜¯ä¸€ç§å¯æŠ¢å æ€§èµ„æºï¼Œä»»ä½•è¿›ç¨‹éƒ½èƒ½å¤ŸæŠ¢å…ˆè·å¾—å†…å­˜çš„ä½¿ç”¨æƒã€‚</li><li><code>ä¸å¯æŠ¢å èµ„æº(nonpreemtable resource)</code> æŒ‡çš„æ˜¯é™¤éå¼•èµ·é”™è¯¯æˆ–è€…å¼‚å¸¸ï¼Œå¦åˆ™è¿›ç¨‹æ— æ³•æŠ¢å æŒ‡å®šèµ„æºï¼Œè¿™ç§ä¸å¯æŠ¢å çš„èµ„æºæ¯”å¦‚æœ‰å…‰ç›˜ï¼Œåœ¨è¿›ç¨‹æ‰§è¡Œè°ƒåº¦çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–è¿›ç¨‹æ˜¯ä¸èƒ½å¾—åˆ°è¯¥èµ„æºçš„ã€‚</li></ul><p>æ­»é”ä¸<strong>ä¸å¯æŠ¢å </strong>èµ„æºæœ‰å…³ï¼Œè™½ç„¶æŠ¢å å¼èµ„æºä¹Ÿä¼šé€ æˆæ­»é”ï¼Œä¸è¿‡è¿™ç§æƒ…å†µçš„è§£å†³åŠæ³•é€šå¸¸æ˜¯åœ¨è¿›ç¨‹ä¹‹é—´é‡æ–°åˆ†é…èµ„æºæ¥åŒ–è§£ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„é‡ç‚¹è‡ªç„¶å°±ä¼šæ”¾åœ¨äº†ä¸å¯æŠ¢å èµ„æºä¸Šã€‚</p><p>å¦‚æœåœ¨è¯·æ±‚æ—¶èµ„æºä¸å­˜åœ¨ï¼Œè¯·æ±‚è¿›ç¨‹å°±ä¼šå¼ºåˆ¶ç­‰å¾…ã€‚åœ¨æŸäº›æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“è¯·æ±‚èµ„æºå¤±è´¥æ—¶è¿›ç¨‹ä¼šè‡ªåŠ¨é˜»å¡ï¼Œå½“è‡ªèµ„æºå¯ä»¥è·å–æ—¶è¿›ç¨‹ä¼šè‡ªåŠ¨å”¤é†’ã€‚åœ¨å¦å¤–ä¸€äº›æ“ä½œç³»ç»Ÿä¸­ï¼Œè¯·æ±‚èµ„æºå¤±è´¥å¹¶æ˜¾ç¤ºé”™è¯¯ä»£ç ï¼Œç„¶åç­‰å¾…è¿›ç¨‹ç­‰å¾…ä¸€ä¼šå„¿å†ç»§ç»­é‡è¯•ã€‚</p><p>è¯·æ±‚èµ„æºå¤±è´¥çš„è¿›ç¨‹ä¼šé™·å…¥ä¸€ç§<strong>è¯·æ±‚èµ„æºã€ä¼‘çœ ã€å†è¯·æ±‚èµ„æº</strong>çš„å¾ªç¯ä¸­ã€‚æ­¤ç±»è¿›ç¨‹è™½ç„¶æ²¡æœ‰é˜»å¡ï¼Œä½†æ˜¯å¤„äºä»ç›®çš„å’Œç»“æœè€ƒè™‘ï¼Œè¿™ç±»è¿›ç¨‹å’Œé˜»å¡å·®ä¸å¤šï¼Œå› ä¸ºè¿™ç±»è¿›ç¨‹å¹¶æ²¡æœ‰åšä»»ä½•æœ‰ç”¨çš„å·¥ä½œã€‚</p><h1 id="æ­»é”"><a class="markdownIt-Anchor" href="#æ­»é”"></a> æ­»é”</h1><p>åœ¨ä¸€ç»„è¿›ç¨‹å‘ç”Ÿæ­»é”çš„æƒ…å†µä¸‹ï¼Œè¿™ç»„è¿›ç¨‹ä¸­çš„æ¯ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½åœ¨ç­‰å¾…å¦ä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰çš„èµ„æºã€‚</p><p>æ­»é”è¿›ç¨‹ç»“åˆä¸­çš„<strong>æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…å¦ä¸€ä¸ªæ­»é”è¿›ç¨‹å·²ç»å æœ‰çš„èµ„æº</strong>ã€‚ä½†æ˜¯ç”±äºæ‰€æœ‰è¿›ç¨‹éƒ½ä¸èƒ½è¿è¡Œï¼Œå®ƒä»¬ä¹‹ä¸­ä»»ä½•ä¸€ä¸ªèµ„æºéƒ½æ— æ³•é‡Šæ”¾èµ„æºï¼Œæ‰€ä»¥æ²¡æœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¢«å”¤é†’ã€‚è¿™ç§æ­»é”ä¹Ÿè¢«ç§°ä¸º <code>èµ„æºæ­»é”(resource deadlock)</code>ã€‚</p><h2 id="èµ„æºæ­»é”çš„æ¡ä»¶"><a class="markdownIt-Anchor" href="#èµ„æºæ­»é”çš„æ¡ä»¶"></a> èµ„æºæ­»é”çš„æ¡ä»¶</h2><ol><li><strong>äº’æ–¥æ¡ä»¶</strong>ï¼šä¸€æ®µæ—¶é—´å†…ï¼Œä¸€ä¸ªèµ„æºåªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ã€‚</li><li><strong>è¯·æ±‚å’Œä¿æŒæ¡ä»¶</strong>ï¼šå·²ç»è·å–èµ„æºçš„è¿›ç¨‹æå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œä½†è¯¥èµ„æºå·²è¢«å…¶ä»–è¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¯¥è¿›ç¨‹è¢«é˜»å¡ï¼Œä½†å¯¹å·²è·å–çš„èµ„æºä¿æŒä¸æ”¾ã€‚</li><li><strong>ä¸å¯æŠ¢å æ¡ä»¶</strong>ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«æŠ¢å ï¼Œåªèƒ½åœ¨ä½¿ç”¨å®Œæˆæ—¶ç”±è‡ªå·±é‡Šæ”¾ã€‚</li><li><strong>å¾ªç¯ç­‰å¾…</strong>ï¼šæ­»é”å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿä¸­ä¸€å®šæœ‰ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ç»„æˆä¸€ä¸ªå¾ªç¯ï¼Œå¾ªç¯ä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹é‡Šæ”¾çš„èµ„æºã€‚</li></ol><p>å‘ç”Ÿæ­»é”æ—¶ï¼Œä¸Šé¢çš„æƒ…å†µå¿…é¡»<strong>åŒæ—¶</strong>ä¼šå‘ç”Ÿã€‚å¦‚æœå…¶ä¸­ä»»æ„ä¸€ä¸ªæ¡ä»¶ä¸ä¼šæˆç«‹ï¼Œæ­»é”å°±ä¸ä¼šå‘ç”Ÿã€‚å¯ä»¥é€šè¿‡<strong>ç ´åå…¶ä¸­ä»»æ„ä¸€ä¸ªæ¡ä»¶æ¥ç ´åæ­»é”</strong>ã€‚</p><h2 id="æ­»é”æ¨¡å‹"><a class="markdownIt-Anchor" href="#æ­»é”æ¨¡å‹"></a> æ­»é”æ¨¡å‹</h2><blockquote><p>åœ†å½¢è¡¨ç¤ºè¿›ç¨‹ (C, D)ï¼›æ–¹å½¢è¡¨ç¤ºèµ„æº (T, U)ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010125812.png" srcset="/img/loading.gif" alt="" /></p><p>è¿›ç¨‹ C ç­‰å¾…èµ„æº T çš„é‡Šæ”¾ï¼Œèµ„æº T å´å·²ç»è¢«è¿›ç¨‹ D å ç”¨ï¼Œè¿›ç¨‹ D ç­‰å¾…è¯·æ±‚å ç”¨èµ„æº U ï¼Œèµ„æº U å´å·²ç»è¢«çº¿ç¨‹ C å ç”¨ï¼Œä»è€Œå½¢æˆç¯ã€‚</p><p>å‡è®¾æœ‰ä¸‰ä¸ªè¿›ç¨‹ (Aã€Bã€C) å’Œä¸‰ä¸ªèµ„æº(Rã€Sã€T) ã€‚ä¸‰ä¸ªè¿›ç¨‹å¯¹èµ„æºçš„è¯·æ±‚å’Œé‡Šæ”¾åºåˆ—å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010130805.png" srcset="/img/loading.gif" alt="" /></p><p>æ“ä½œç³»ç»Ÿå¯ä»¥ä»»æ„é€‰æ‹©ä¸€ä¸ªéé˜»å¡çš„ç¨‹åºè¿è¡Œï¼Œæ‰€ä»¥å®ƒå¯ä»¥å†³å®šè¿è¡Œ A ç›´åˆ° A å®Œæˆå·¥ä½œï¼›å®ƒå¯ä»¥è¿è¡Œ B ç›´åˆ° B å®Œæˆå·¥ä½œï¼›æœ€åè¿è¡Œ Cã€‚</p><p>è¿™æ ·çš„é¡ºåºä¸ä¼šå¯¼è‡´æ­»é”ï¼ˆå› ä¸ºä¸å­˜åœ¨å¯¹èµ„æºçš„ç«äº‰ï¼‰ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¹Ÿå®Œå…¨æ²¡æœ‰å¹¶è¡Œæ€§ã€‚è¿›ç¨‹é™¤äº†åœ¨è¯·æ±‚å’Œé‡Šæ”¾èµ„æºå¤–ï¼Œè¿˜è¦åšè®¡ç®—å’Œè¾“å…¥/è¾“å‡ºçš„å·¥ä½œã€‚å½“è¿›ç¨‹æŒ‰ç…§é¡ºåºè¿è¡Œæ—¶ï¼Œåœ¨ç­‰å¾…ä¸€ä¸ª I/O æ—¶ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹ä¸èƒ½ä½¿ç”¨ CPUã€‚æ‰€ä»¥ï¼Œä¸¥æ ¼æŒ‰ç…§ä¸²è¡Œçš„é¡ºåºæ‰§è¡Œå¹¶ä¸æ˜¯æœ€ä¼˜è¶Šçš„ã€‚å¦ä¸€æ–¹é¢ï¼Œ<strong>å¦‚æœæ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¸æ‰§è¡Œ I/O æ“ä½œï¼Œé‚£ä¹ˆçŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ä¼šä¼˜äºè½®è½¬è°ƒåº¦ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ä¸²è¡Œå¯èƒ½æ˜¯æœ€ä¼˜è¶Šçš„ã€‚</strong></p><p>å‡è®¾è¿›ç¨‹ä¼šæ‰§è¡Œè®¡ç®—å’Œ I/O æ“ä½œï¼Œæ‰€ä»¥è½®è¯¢è°ƒåº¦æ˜¯ä¸€ç§åˆç†çš„è°ƒåº¦ç®—æ³•ã€‚èµ„æºè¯·æ±‚å¯èƒ½ä¼šæŒ‰ç…§ä¸‹é¢è¿™ä¸ªé¡ºåºè¿›è¡Œï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010131700.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™å…­ä¸ªæ­¥éª¤çš„èµ„æºåˆ†é…å›¾ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010131909.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨ä¸Šé¢çš„ç¬¬å››ä¸ªæ­¥éª¤ï¼Œè¿›ç¨‹ A æ­£åœ¨ç­‰å¾…èµ„æº Sï¼›ç¬¬äº”ä¸ªæ­¥éª¤ä¸­ï¼Œè¿›ç¨‹ B åœ¨ç­‰å¾…èµ„æº Tï¼›ç¬¬å…­ä¸ªæ­¥éª¤ä¸­ï¼Œè¿›ç¨‹ C åœ¨ç­‰å¾…èµ„æº Rï¼Œå› æ­¤äº§ç”Ÿäº†<strong>ç¯è·¯</strong>å¹¶å¯¼è‡´äº†æ­»é”ã€‚</p><p>ç„¶è€Œï¼Œæ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰è§„å®šä¸€å®šæŒ‰ç…§æŸç§ç‰¹å®šçš„é¡ºåºæ¥æ‰§è¡Œè¿™äº›è¿›ç¨‹ã€‚<strong>é‡åˆ°ä¸€ä¸ªå¯èƒ½ä¼šå¼•èµ·æ­»é”çš„çº¿ç¨‹åï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥å¹²è„†ä¸æ‰¹å‡†è¯·æ±‚ï¼Œå¹¶æŠŠè¿›ç¨‹æŒ‚èµ·ä¸€ç›´åˆ°å®‰å…¨çŠ¶æ€ä¸ºæ­¢ã€‚</strong> æ¯”å¦‚ä¸Šå›¾ä¸­ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿè®¤ä¸ºæœ‰æ­»é”çš„å¯èƒ½ï¼Œå®ƒå¯ä»¥é€‰æ‹©ä¸æŠŠèµ„æº S åˆ†é…ç»™ B ï¼Œè¿™æ · B è¢«æŒ‚èµ·ã€‚è¿™æ ·çš„è¯æ“ä½œç³»ç»Ÿä¼šåªè¿è¡Œ A å’Œ Cï¼Œé‚£ä¹ˆèµ„æºçš„è¯·æ±‚å’Œé‡Šæ”¾å°±ä¼šæ˜¯ä¸‹é¢çš„æ­¥éª¤ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010132457.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸‹å›¾æ˜¯é’ˆå¯¹ä¸Šé¢è¿™å…­ä¸ªæ­¥éª¤çš„èµ„æºåˆ†é…å›¾ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010132541.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨ç¬¬å…­æ­¥æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥å‘ç°å¹¶æ²¡æœ‰äº§ç”Ÿæ­»é”ï¼Œæ­¤æ—¶å°±å¯ä»¥æŠŠèµ„æº S åˆ†é…ç»™ Bï¼Œå› ä¸º A è¿›ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•ï¼ŒC è¿›ç¨‹å·²ç»æ‹¿åˆ°äº†å®ƒæƒ³è¦çš„èµ„æºã€‚è¿›ç¨‹ B å¯ä»¥ç›´æ¥è·å¾—èµ„æº Sï¼Œä¹Ÿå¯ä»¥ç­‰å¾…è¿›ç¨‹ C é‡Šæ”¾èµ„æº T ã€‚</p><h2 id="å¤„ç†æ­»é”çš„ç­–ç•¥"><a class="markdownIt-Anchor" href="#å¤„ç†æ­»é”çš„ç­–ç•¥"></a> å¤„ç†æ­»é”çš„ç­–ç•¥</h2><ol><li><strong>é¸µé¸Ÿç®—æ³•</strong>ï¼šå¿½ç•¥æ­»é”å¸¦æ¥çš„å½±å“ï¼›</li><li><strong>é¢„é˜²æ­»é”</strong>ï¼šé€šè¿‡ç ´åæ­»é”äº§ç”Ÿçš„å››ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼Œé˜²æ­¢æ­»é”äº§ç”Ÿï¼›</li><li><strong>é¿å…æ­»é”</strong>ï¼šé€šè¿‡ä»”ç»†åˆ†é…èµ„æºæ¥é¿å…æ­»é”ï¼›</li><li><strong>æ£€æµ‹ã€è§£é™¤æ­»é”</strong>ï¼šæ£€æµ‹æ­»é”å¹¶æ¢å¤ï¼Œæ­»é”å‘ç”Ÿæ—¶å¯¹å…¶è¿›è¡Œæ£€æµ‹ï¼Œä¸€æ—¦å‘ç”Ÿæ­»é”åï¼Œé‡‡å–è¡ŒåŠ¨è§£å†³é—®é¢˜ï¼›</li></ol><p>ç”±ä¸Šè‡³ä¸‹å¯¹æ­»é”çš„é˜²èŒƒç¨‹åº¦é€æ¸å‡å¼±ï¼Œä½†å¯¹åº”çš„æ˜¯èµ„æºçš„åˆ©ç”¨ç‡æé«˜ï¼Œä»¥åŠè¿›ç¨‹å› èµ„æºè€Œé˜»å¡çš„é¢‘åº¦ä¸‹é™ï¼ˆå¹¶å‘ç¨‹åº¦æé«˜ï¼‰ã€‚</p><h1 id="é¸µé¸Ÿç®—æ³•"><a class="markdownIt-Anchor" href="#é¸µé¸Ÿç®—æ³•"></a> é¸µé¸Ÿç®—æ³•</h1><p>æœ€ç®€å•çš„è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨ <code>é¸µé¸Ÿç®—æ³•(ostrich algorithm)</code>ï¼ŒæŠŠå¤´åŸ‹åœ¨æ²™å­é‡Œï¼Œå‡è£…é—®é¢˜æ ¹æœ¬æ²¡æœ‰å‘ç”Ÿã€‚<br />æ¯ä¸ªäººçœ‹å¾…è¿™ä¸ªé—®é¢˜çš„ååº”éƒ½ä¸åŒã€‚æ•°å­¦å®¶è®¤ä¸ºæ­»é”æ˜¯ä¸å¯æ¥å—çš„ï¼Œå¿…é¡»é€šè¿‡æœ‰æ•ˆçš„ç­–ç•¥æ¥é˜²æ­¢æ­»é”çš„äº§ç”Ÿã€‚å·¥ç¨‹å¸ˆæƒ³è¦çŸ¥é“é—®é¢˜å‘ç”Ÿçš„é¢‘æ¬¡ï¼Œç³»ç»Ÿå› ä¸ºå…¶ä»–åŸå› å´©æºƒçš„æ¬¡æ•°å’Œæ­»é”å¸¦æ¥çš„ä¸¥é‡åæœã€‚å¦‚æœæ­»é”å‘ç”Ÿçš„é¢‘æ¬¡å¾ˆä½ï¼Œè€Œç»å¸¸ä¼šç”±äºç¡¬ä»¶æ•…éšœã€ç¼–è¯‘å™¨é”™è¯¯ç­‰å…¶ä»–æ“ä½œç³»ç»Ÿé—®é¢˜å¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œé‚£ä¹ˆå¤§å¤šæ•°å·¥ç¨‹å¸ˆä¸ä¼šä¿®å¤æ­»é”ã€‚</p><h1 id="é¢„é˜²æ­»é”"><a class="markdownIt-Anchor" href="#é¢„é˜²æ­»é”"></a> é¢„é˜²æ­»é”</h1><p>é¢„é˜²æ­»é”æ˜¯é€šè¿‡ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªï¼Œä»¥é¿å…å‘ç”Ÿæ­»é”ã€‚</p><blockquote><p>ç”±äº<strong>äº’æ–¥æ¡ä»¶æ˜¯éå…±äº«è®¾å¤‡æ‰€å¿…é¡»çš„</strong>ï¼Œä¸ä»…ä¸èƒ½æ”¹å˜ï¼Œè¿˜åº”åŠ ä»¥ä¿è¯ï¼Œå› æ­¤ä¸»è¦æ˜¯ç ´åäº§ç”Ÿæ­»é”çš„åä¸‰ä¸ªæ¡ä»¶ã€‚</p></blockquote><h2 id="1-ç ´åäº’æ–¥æ¡ä»¶"><a class="markdownIt-Anchor" href="#1-ç ´åäº’æ–¥æ¡ä»¶"></a> 1. ç ´åäº’æ–¥æ¡ä»¶</h2><p>å¦‚æœèµ„æºä¸è¢«ä¸€ä¸ªè¿›ç¨‹ç‹¬å ï¼Œé‚£ä¹ˆæ­»é”è‚¯å®šä¸ä¼šäº§ç”Ÿã€‚å¦‚æœä¸¤ä¸ªæ‰“å°æœºåŒæ—¶ä½¿ç”¨ä¸€ä¸ªèµ„æºä¼šé€ æˆæ··ä¹±ï¼Œæ‰“å°æœºçš„è§£å†³æ–¹å¼æ˜¯ä½¿ç”¨ <code>å‡è„±æœºæ‰“å°æœº(spooling printer)</code> ï¼Œè¿™é¡¹æŠ€æœ¯å¯ä»¥å…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶äº§ç”Ÿè¾“å‡ºï¼Œåœ¨è¿™ç§æ¨¡å‹ä¸­ï¼Œå®é™…è¯·æ±‚æ‰“å°æœºçš„å”¯ä¸€è¿›ç¨‹æ˜¯æ‰“å°æœºå®ˆæŠ¤è¿›ç¨‹ï¼Œä¹Ÿç§°ä¸ºåå°è¿›ç¨‹ã€‚åå°è¿›ç¨‹ä¸ä¼šè¯·æ±‚å…¶ä»–èµ„æºã€‚æˆ‘ä»¬å¯ä»¥æ¶ˆé™¤æ‰“å°æœºçš„æ­»é”ã€‚</p><p>åå°è¿›ç¨‹é€šå¸¸è¢«ç¼–å†™ä¸ºèƒ½å¤Ÿè¾“å‡ºå®Œæ•´çš„æ–‡ä»¶åæ‰èƒ½æ‰“å°ï¼Œå‡å¦‚ä¸¤ä¸ªè¿›ç¨‹éƒ½å ç”¨äº†å‡è„±æœºç©ºé—´çš„ä¸€åŠï¼Œè€Œè¿™ä¸¤ä¸ªè¿›ç¨‹éƒ½æ²¡æœ‰å®Œæˆå…¨éƒ¨çš„è¾“å‡ºï¼Œå°±ä¼šå¯¼è‡´æ­»é”ã€‚</p><p>å› æ­¤ï¼Œé¿å…åˆ†é…é‚£äº›ä¸æ˜¯ç»å¯¹å¿…é¡»çš„èµ„æºï¼Œ<strong>å°½é‡åšåˆ°å°½å¯èƒ½å°‘çš„è¿›ç¨‹å¯ä»¥è¯·æ±‚èµ„æº</strong>ã€‚</p><h2 id="2-ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶"><a class="markdownIt-Anchor" href="#2-ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶"></a> 2. ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶</h2><p>ç³»ç»Ÿå¿…é¡»åšåˆ°ï¼šå½“ä¸€ä¸ªè¿›ç¨‹åœ¨è¯·æ±‚èµ„æºæ—¶ï¼Œå®ƒä¸èƒ½æŒæœ‰ä¸å¯æŠ¢å èµ„æºã€‚<br />å¯ä»¥é€šè¿‡ä¸¤ä¸ªæ–¹å¼å®ç°ï¼š</p><ul><li><p>è®©æ‰€æœ‰çš„è¿›ç¨‹<strong>å¼€å§‹æ‰§è¡Œå‰è¯·æ±‚å…¨éƒ¨çš„èµ„æº</strong>ã€‚è¿›ç¨‹åœ¨æ•´ä¸ªè¿è¡ŒæœŸé—´ï¼Œä¸ä¼šæå‡ºæ–°çš„èµ„æºè¦æ±‚ï¼ˆç ´å <code>è¯·æ±‚</code>ï¼‰ã€‚åªè¦æœ‰ä¸€ç§èµ„æºä¸èƒ½æ»¡è¶³è¿›ç¨‹è¦æ±‚ï¼Œè®©è¯¥è¿›ç¨‹ç­‰å¾…ï¼Œç­‰å¾…æœŸé—´è¿›ç¨‹æœªå æœ‰ä»»ä½•èµ„æºï¼ˆç ´å <code>ä¿æŒ</code>ï¼‰ã€‚<br />å¾ˆå¤šè¿›ç¨‹<strong>æ— æ³•åœ¨æ‰§è¡Œå®Œæˆå‰å°±çŸ¥é“åˆ°åº•éœ€è¦å¤šå°‘èµ„æº</strong>ï¼Œå¦‚æœçŸ¥é“çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨<strong>é“¶è¡Œå®¶ç®—æ³•</strong>ï¼›è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯è¿™æ ·<strong>æ— æ³•åˆç†æœ‰æ•ˆåˆ©ç”¨èµ„æº</strong>ã€‚</p></li><li><p>è¿›ç¨‹åœ¨è¯·æ±‚å…¶ä»–èµ„æºæ—¶ï¼Œ<strong>å…ˆé‡Šæ”¾æ‰€å ç”¨çš„èµ„æºï¼Œç„¶åå†å°è¯•ä¸€æ¬¡è·å–å…¨éƒ¨çš„èµ„æº</strong>ã€‚</p></li></ul><h2 id="3-ç ´åä¸å¯æŠ¢å æ¡ä»¶"><a class="markdownIt-Anchor" href="#3-ç ´åä¸å¯æŠ¢å æ¡ä»¶"></a> 3. ç ´åä¸å¯æŠ¢å æ¡ä»¶</h2><p>å½“ä¸€ä¸ªå·²ç»ä¿æŒäº†æŸäº›ä¸å¯æŠ¢å èµ„æºçš„è¿›ç¨‹ï¼Œæå‡ºæ–°çš„èµ„æºè¯·æ±‚è€Œä¸èƒ½è¢«æ»¡è¶³æ—¶ï¼Œå®ƒå¿…é¡»é‡Šæ”¾å·²ç»ä¿æŒçš„æ‰€æœ‰èµ„æºï¼Œå¾…ä»¥åéœ€è¦æ—¶å†é‡æ–°ç”³è¯·ã€‚</p><p>è¿™ç§ç­–ç•¥å¯èƒ½ä½¿è¿›ç¨‹å‰ä¸€æ®µå·¥ä½œçš„å¤±æ•ˆï¼Œæˆ–è€…ä½¿è¿›ç¨‹å‰åä¸¤æ¬¡è¿è¡Œçš„ä¿¡æ¯ä¸è¿ç»­ã€‚å› ä¸ºåå¤åœ°ç”³è¯·å’Œé‡Šæ”¾èµ„æºï¼Œå¯¼è‡´è¿›ç¨‹çš„æ‰§è¡Œè¢«æ— é™åœ°æ¨è¿Ÿï¼Œä¸ä»…å»¶é•¿äº†è¿›ç¨‹çš„å‘¨è½¬æ—¶é—´ï¼Œè€Œä¸”ä¹Ÿå¢åŠ äº†ç³»ç»Ÿå¼€é”€ï¼Œé™ä½äº†ç³»ç»Ÿååé‡ã€‚</p><h2 id="4-ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶"><a class="markdownIt-Anchor" href="#4-ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶"></a> 4. ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶</h2><p>å¾ªç¯ç­‰å¾…æ¡ä»¶å¯ä»¥é€šè¿‡å¤šç§æ–¹æ³•æ¥ç ´åã€‚ä¸€ç§æ–¹å¼æ˜¯åˆ¶å®šä¸€ä¸ªæ ‡å‡†ï¼Œ<strong>ä¸€ä¸ªè¿›ç¨‹åœ¨ä»»ä½•æ—¶å€™åªèƒ½ä½¿ç”¨ä¸€ç§èµ„æº</strong>ã€‚å¦‚æœéœ€è¦å¦å¤–ä¸€ç§èµ„æºï¼Œå¿…é¡»é‡Šæ”¾å½“å‰èµ„æºã€‚å¯¹äºéœ€è¦å°†å¤§æ–‡ä»¶ä»ç£å¸¦å¤åˆ¶åˆ°æ‰“å°æœºçš„è¿‡ç¨‹ï¼Œæ­¤é™åˆ¶æ˜¯ä¸å¯æ¥å—çš„ã€‚</p><p>å¦ä¸€ç§æ–¹å¼æ˜¯å°†æ‰€æœ‰çš„èµ„æºç»Ÿä¸€ç¼–å·ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010141050.png" srcset="/img/loading.gif" alt="" /></p><p>è¿›ç¨‹å¯ä»¥åœ¨ä»»ä½•æ—¶é—´æå‡ºè¯·æ±‚ï¼Œä½†æ˜¯<strong>æ‰€æœ‰çš„è¯·æ±‚éƒ½å¿…é¡»æŒ‰ç…§èµ„æºçš„é¡ºåºæå‡º</strong>ã€‚å¦‚æœæŒ‰ç…§æ­¤åˆ†é…è§„åˆ™çš„è¯ï¼Œé‚£ä¹ˆèµ„æºåˆ†é…ä¹‹é—´ä¸ä¼šå‡ºç°ç¯ã€‚</p><h1 id="é¿å…æ­»é”é“¶è¡Œå®¶ç®—æ³•"><a class="markdownIt-Anchor" href="#é¿å…æ­»é”é“¶è¡Œå®¶ç®—æ³•"></a> é¿å…æ­»é”ï¼ˆé“¶è¡Œå®¶ç®—æ³•ï¼‰</h1><p>é“¶è¡Œå®¶ç®—æ³•æœ¬èº«æ˜¯ä¸€ç§æ­»é”çš„è°ƒåº¦ç®—æ³•ã€‚å®ƒçš„æ¨¡å‹æ˜¯åŸºäºä¸€ä¸ªåŸé•‡ä¸­çš„é“¶è¡Œå®¶ï¼Œé“¶è¡Œå®¶å‘åŸé•‡ä¸­çš„å®¢æˆ·æ‰¿è¯ºäº†ä¸€å®šæ•°é‡çš„è´·æ¬¾é¢åº¦ã€‚ç®—æ³•è¦åšçš„å°±æ˜¯åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¼šè¿›å…¥ä¸€ç§ä¸å®‰å…¨çš„çŠ¶æ€ã€‚å¦‚æœæ˜¯ï¼Œå°±æ‹’ç»è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚åç³»ç»Ÿæ˜¯å®‰å…¨çš„ï¼Œå°±æ¥å—è¯¥è¯·æ±‚ã€‚</p><p>å‡å®šç³»ç»Ÿä¸­æœ‰äº”ä¸ªè¿›ç¨‹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>P</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{P_0, P_1, P_2, P_3, P_4\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> å’Œä¸‰ç±»èµ„æº <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{A, B, C\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">}</span></span></span></span>ï¼Œå„ç§èµ„æºçš„æ•°é‡åˆ†åˆ«ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><mn>10</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{10, 5, 7\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">7</span><span class="mclose">}</span></span></span></span>ï¼Œåœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ—¶åˆ»çš„èµ„æºåˆ†é…æƒ…å†µå¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">è¿›ç¨‹</th><th style="text-align:center"><code>Max</code></th><th style="text-align:center"><code>Allocation</code></th><th style="text-align:center"><code>Need</code></th><th style="text-align:center"><code>Available</code></th></tr></thead><tbody><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">7, 5, 3</td><td style="text-align:center">0, 1, 0</td><td style="text-align:center">7, 4, 3</td><td style="text-align:center">3, 3, 2</td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">3, 2, 2</td><td style="text-align:center">2, 0, 0</td><td style="text-align:center">1, 2, 2</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">9, 0, 2</td><td style="text-align:center">3, 0, 2</td><td style="text-align:center">6, 0, 0</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">2, 2, 2</td><td style="text-align:center">2, 1, 1</td><td style="text-align:center">0, 1, 1</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">4, 3, 3</td><td style="text-align:center">0, 0, 2</td><td style="text-align:center">4, 3, 1</td><td style="text-align:center"></td></tr></tbody></table><p>åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ—¶åˆ»å­˜åœ¨ä¸€ä¸ªå®‰å…¨åºåˆ— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>P</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>P</mi><mn>0</mn></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{P_1, P_3, P_4, P_2, P_0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>ã€‚</p><table><thead><tr><th style="text-align:center">è¿›ç¨‹</th><th style="text-align:center"><code>Available</code></th><th style="text-align:center"><code>Allocation</code></th><th style="text-align:center"><code>Need</code></th><th style="text-align:center"><code>Available + Allocation</code></th><th style="text-align:center"><code>Finish</code></th></tr></thead><tbody><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">3, 3, 2</td><td style="text-align:center">2, 0, 0</td><td style="text-align:center">1, 2, 2</td><td style="text-align:center">5, 3, 2</td><td style="text-align:center"><code>TRUE</code></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">P_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">5, 3, 2</td><td style="text-align:center">2, 1, 1</td><td style="text-align:center">0, 1, 1</td><td style="text-align:center">7, 4, 3</td><td style="text-align:center"><code>TRUE</code></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">P_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">7, 4, 3</td><td style="text-align:center">0, 0, 2</td><td style="text-align:center">4, 3, 1</td><td style="text-align:center">7, 4, 5</td><td style="text-align:center"><code>TRUE</code></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">7, 4, 5</td><td style="text-align:center">3, 0, 2</td><td style="text-align:center">6, 0, 0</td><td style="text-align:center">10, 4, 7</td><td style="text-align:center"><code>TRUE</code></td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">10, 4, 7</td><td style="text-align:center">0, 1, 0</td><td style="text-align:center">7, 4, 3</td><td style="text-align:center">10, 5, 7</td><td style="text-align:center"><code>TRUE</code></td></tr></tbody></table><h1 id="æ­»é”çš„æ£€æµ‹å’Œæ¢å¤"><a class="markdownIt-Anchor" href="#æ­»é”çš„æ£€æµ‹å’Œæ¢å¤"></a> æ­»é”çš„æ£€æµ‹å’Œæ¢å¤</h1><h2 id="æ­»é”æ£€æµ‹"><a class="markdownIt-Anchor" href="#æ­»é”æ£€æµ‹"></a> æ­»é”æ£€æµ‹</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201010125812.png" srcset="/img/loading.gif" alt="" /></p><p>ä½¿ç”¨èµ„æºåˆ†é…å›¾æ¥æ£€æµ‹æ­»é”ï¼Œåœ†å½¢è¡¨ç¤ºä¸€ä¸ªè¿›ç¨‹ï¼Œæ–¹å½¢è¡¨ç¤ºä¸€ç±»èµ„æºï¼Œå½“æ•´ä¸ªå›¾å­˜åœ¨ç¯æ—¶è¯´æ˜ç³»ç»Ÿå­˜åœ¨æ­»é”ã€‚</p><h2 id="æ­»é”æ¢å¤"><a class="markdownIt-Anchor" href="#æ­»é”æ¢å¤"></a> æ­»é”æ¢å¤</h2><h3 id="1-é€šè¿‡æŠ¢å èµ„æº"><a class="markdownIt-Anchor" href="#1-é€šè¿‡æŠ¢å èµ„æº"></a> 1. é€šè¿‡æŠ¢å èµ„æº</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šä¸´æ—¶å°†æŸä¸ªèµ„æºä»å®ƒçš„æŒæœ‰è€…è½¬ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€‚æ¯”å¦‚åœ¨ä¸é€šçŸ¥åŸè¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œå°†æŸä¸ªèµ„æºä»è¿›ç¨‹ä¸­å¼ºåˆ¶å–èµ°ç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨ï¼Œä½¿ç”¨å®Œååˆé€å›ã€‚è¿™ç§æ¢å¤æ–¹å¼ä¸€èˆ¬æ¯”è¾ƒå›°éš¾è€Œä¸”æœ‰äº›ç®€å•ç²—æš´ï¼Œå¹¶ä¸å¯å–ã€‚</p><h3 id="2-é€šè¿‡å›æ»š"><a class="markdownIt-Anchor" href="#2-é€šè¿‡å›æ»š"></a> 2. é€šè¿‡å›æ»š</h3><p>å‘¨æœŸæ€§åœ°å¯¹è¿›ç¨‹è¿›è¡Œ <code>æ£€æŸ¥ç‚¹æ£€æŸ¥(checkpointed)</code>ã€‚ è¿›ç¨‹çš„æ£€æŸ¥ç‚¹æ£€æŸ¥æ„å‘³ç€è¿›ç¨‹çš„çŠ¶æ€å¯ä»¥è¢«å†™å…¥åˆ°æ–‡ä»¶ä»¥ä¾¿åé¢è¿›è¡Œæ¢å¤ã€‚æ£€æŸ¥ç‚¹ä¸ä»…åŒ…å« <code>å­˜å‚¨æ˜ åƒ(memory image)</code>ï¼Œè¿˜åŒ…å« <code>èµ„æºçŠ¶æ€(resource state)</code>ã€‚ä¸€ç§æ›´æœ‰æ•ˆçš„è§£å†³æ–¹å¼æ˜¯ä¸è¦è¦†ç›–åŸæœ‰çš„æ£€æµ‹ç‚¹ï¼Œè€Œæ˜¯æ¯å‡ºç°ä¸€ä¸ªæ£€æµ‹ç‚¹éƒ½è¦æŠŠå®ƒå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å½“è¿›ç¨‹æ‰§è¡Œæ—¶ï¼Œå°±ä¼šæœ‰ä¸€ç³»åˆ—çš„æ£€æŸ¥ç‚¹æ–‡ä»¶è¢«ç´¯ç§¯èµ·æ¥ã€‚</p><p>ä¸ºäº†è¿›è¡Œæ¢å¤ï¼Œè¦ä»ä¸Šä¸€ä¸ªè¾ƒæ—©çš„æ£€æŸ¥ç‚¹ä¸Šå¼€å§‹ï¼Œè¿™æ ·æ‰€éœ€è¦èµ„æºçš„è¿›ç¨‹ä¼šå›æ»šåˆ°ä¸Šä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œåœ¨è¿™ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œæ­»é”è¿›ç¨‹è¿˜æ²¡æœ‰è·å–æ‰€éœ€è¦çš„èµ„æºï¼Œå¯ä»¥åœ¨æ­¤æ—¶å¯¹å…¶è¿›è¡Œèµ„æºåˆ†é…ã€‚</p><h3 id="3-ç»ˆæ­¢è¿›ç¨‹"><a class="markdownIt-Anchor" href="#3-ç»ˆæ­¢è¿›ç¨‹"></a> 3. ç»ˆæ­¢è¿›ç¨‹</h3><p>ç»ˆæ­¢æˆ–æ’¤é”€ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ­»é”è¿›ç¨‹ï¼Œç›´è‡³æ‰“ç ´å¾ªç¯ç¯è·¯ï¼Œä½¿ç³»ç»Ÿä»æ­»é”çŠ¶æ€è§£è„±å‡ºæ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é”</tag>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®</title>
    <link href="/2020/10/07/LeetCode-34-find-first-and-last-position-of-element-in-sorted-array/"/>
    <url>/2020/10/07/LeetCode-34-find-first-and-last-position-of-element-in-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-first-and-last-position-of-element-in-sorted-array/" target="_blank" rel="noopener">34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] searchRange(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target) &#123;        <span class="hljs-keyword">int</span> len = nums.length;        <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;;        &#125;        <span class="hljs-keyword">int</span> first = findFirstPos(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>, target);        <span class="hljs-keyword">if</span> (first == -<span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;;        &#125;        <span class="hljs-keyword">int</span> last = findLastPos(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>, target);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;first, last&#125;;    &#125;    <span class="hljs-comment">// 1 2 3</span>    <span class="hljs-comment">// 0 1 2</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findFirstPos</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-comment">// æœç´¢å¼€å§‹ä½ç½®ï¼šæ›´æ–°å·¦è¾¹ç•Œ</span>            <span class="hljs-keyword">if</span> (nums[mid] &lt; target) &#123;                <span class="hljs-comment">// [mid + 1, right]</span>                left = mid + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// nums[mid] &gt;= target</span>                <span class="hljs-comment">// [left, mid]</span>                right = mid;            &#125;        &#125;        <span class="hljs-keyword">return</span> nums[left] == target ? left : -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">// 5 7 7 8 8 10</span>    <span class="hljs-comment">// 0 1 2 3 4  5</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findLastPos</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;            <span class="hljs-comment">// æœç´¢ç»“æŸä½ç½®ï¼šæ›´æ–°å³è¾¹ç•Œ</span>            <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;                <span class="hljs-comment">// [left, mid - 1]</span>                right = mid - <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// nums[mid] &lt;= target</span>                <span class="hljs-comment">// [mid, right]</span>                left = mid;            &#125;        &#125;        <span class="hljs-keyword">return</span> left;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 167. ä¸¤æ•°ä¹‹å’Œ II - è¾“å…¥æœ‰åºæ•°ç»„</title>
    <link href="/2020/10/06/LeetCode-167-two-sum-ii-input-array-is-sorted/"/>
    <url>/2020/10/06/LeetCode-167-two-sum-ii-input-array-is-sorted/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/two-sum-ii-input-array-is-sorted/" target="_blank" rel="noopener">167. ä¸¤æ•°ä¹‹å’Œ II - è¾“å…¥æœ‰åºæ•°ç»„</a></p><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] twoSum(<span class="hljs-keyword">int</span>[] numbers, <span class="hljs-keyword">int</span> target) &#123;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = numbers.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> sum = numbers[left] + numbers[right];        <span class="hljs-keyword">if</span> (target &gt; sum) &#123;            left++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (target &lt; sum) &#123;            right--;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;left + <span class="hljs-number">1</span>, right + <span class="hljs-number">1</span>&#125;;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];&#125;</code></pre><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] twoSum(<span class="hljs-keyword">int</span>[] numbers, <span class="hljs-keyword">int</span> target) &#123;    <span class="hljs-keyword">int</span> len = numbers.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">int</span> right = binarySearch(numbers, i + <span class="hljs-number">1</span>, len - <span class="hljs-number">1</span>, target - numbers[i]);        <span class="hljs-keyword">if</span> (right != -<span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;i + <span class="hljs-number">1</span>, right + <span class="hljs-number">1</span>&#125;;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (nums[mid] == target) &#123;            <span class="hljs-keyword">return</span> mid;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;            right = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> nums[left] == target ? left : -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 18. å››æ•°ä¹‹å’Œ</title>
    <link href="/2020/10/05/LeetCode-18-4sum/"/>
    <url>/2020/10/05/LeetCode-18-4sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/4sum/" target="_blank" rel="noopener">18. å››æ•°ä¹‹å’Œ</a><br />å›ºå®šä¸€ä¸ªæ•°è¿›è¡Œä¸‰æ•°ä¹‹å’Œçš„æŸ¥æ‰¾ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; fourSum(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target) &#123;    Arrays.sort(nums);    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len - <span class="hljs-number">3</span>; i++) &#123;        <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// æŸ¥æ‰¾ ä¸‰æ•°ä¹‹å’Œ</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; len - <span class="hljs-number">2</span>; j++) &#123;            <span class="hljs-keyword">if</span> (j &gt; i + <span class="hljs-number">1</span> &amp;&amp; nums[j] == nums[j - <span class="hljs-number">1</span>]) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">int</span> left = j + <span class="hljs-number">1</span>;            <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;            <span class="hljs-keyword">while</span> (left &lt; right) &#123;                <span class="hljs-keyword">int</span> sum = nums[i] + nums[j] + nums[left] + nums[right];                <span class="hljs-keyword">if</span> (sum == target) &#123;                    res.add(Arrays.asList(nums[i], nums[j], nums[left], nums[right]));                    <span class="hljs-comment">// è·³è¿‡é‡å¤æ•°å­—</span>                    <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[left] == nums[left + <span class="hljs-number">1</span>]) &#123;                        left++;                    &#125;                    <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[right] == nums[right - <span class="hljs-number">1</span>]) &#123;                        right--;                    &#125;                    left++;                    right--;                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sum &gt; target) &#123;                    right--;                &#125; <span class="hljs-keyword">else</span> &#123;                    left++;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 42. æ¥é›¨æ°´</title>
    <link href="/2020/10/05/LeetCode-42-trapping-rain-water/"/>
    <url>/2020/10/05/LeetCode-42-trapping-rain-water/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/trapping-rain-water/" target="_blank" rel="noopener">42. æ¥é›¨æ°´</a></p><h1 id="å•è°ƒæ ˆ"><a class="markdownIt-Anchor" href="#å•è°ƒæ ˆ"></a> å•è°ƒæ ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">trap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] height)</span> </span>&#123;    ArrayDeque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; height.length; i++) &#123;        <span class="hljs-comment">// å½“å‰é«˜åº¦ &gt; æ ˆé¡¶æ—¶ï¼Œè®¡ç®—æ ˆé¡¶å…ƒç´ ä¸Šçš„ç§¯æ°´</span>        <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; height[i] &gt; height[stack.peek()]) &#123;            <span class="hljs-comment">// æ ˆé¡¶å…ƒç´ çš„é«˜åº¦</span>            <span class="hljs-keyword">int</span> top = height[stack.pop()];            <span class="hljs-keyword">if</span> (stack.isEmpty()) &#123;                <span class="hljs-keyword">break</span>;            &#125;            <span class="hljs-comment">// å¯å½¢æˆç§¯æ°´çš„å®½åº¦</span>            <span class="hljs-keyword">int</span> width = i - stack.peek() - <span class="hljs-number">1</span>;            <span class="hljs-comment">// æ ˆé¡¶å…ƒç´ çš„ä¸¤ä¾§å‡ &gt; æ ˆé¡¶é«˜åº¦ï¼Œå–æœ€å°å€¼</span>            <span class="hljs-keyword">int</span> minHeight = Math.min(height[i], height[stack.peek()]);            res += width * (minHeight - top);        &#125;        stack.push(i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><p>åˆ†åˆ«æ‰¾åˆ°å½“å‰åˆ—çš„å·¦å³æœ€é«˜ç‚¹ï¼Œè®¡ç®—ç§¯æ°´ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">trap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] height)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = height.length;    <span class="hljs-comment">// æœ€å·¦è¾¹å’Œæœ€å³è¾¹æ— æ³•ä¿å­˜æ°´ï¼Œå¯è·³è¿‡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-comment">// æ‰¾å‡ºå·¦è¾¹æœ€é«˜çš„åˆ—</span>        <span class="hljs-keyword">int</span> leftMax = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) &#123;            leftMax = Math.max(leftMax, height[j]);        &#125;        <span class="hljs-comment">// æ‰¾å‡ºå³è¾¹æœ€é«˜çš„åˆ—</span>        <span class="hljs-keyword">int</span> rightMax = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; len; j++) &#123;            rightMax = Math.max(rightMax, height[j]);        &#125;        <span class="hljs-comment">// å½“å‰åˆ—å‡å°äº å·¦è¾¹å’Œå³è¾¹æ—¶ï¼Œå½“å‰åˆ—æ‰èƒ½ä¿å­˜æ°´</span>        <span class="hljs-keyword">int</span> minHeight = Math.min(leftMax, rightMax);        <span class="hljs-keyword">if</span> (minHeight &gt; height[i]) &#123;            res += minHeight - height[i];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">trap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] height)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = height.length;    <span class="hljs-keyword">int</span>[] leftMax = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span>[] rightMax = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// è®¡ç®—å·¦è¾¹æœ€é«˜</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        leftMax[i] = Math.max(leftMax[i - <span class="hljs-number">1</span>], height[i - <span class="hljs-number">1</span>]);    &#125;    <span class="hljs-comment">// è®¡ç®—å³è¾¹æœ€é«˜</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">2</span>; i &gt; <span class="hljs-number">0</span>; i--) &#123;        rightMax[i] = Math.max(rightMax[i + <span class="hljs-number">1</span>], height[i + <span class="hljs-number">1</span>]);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-keyword">int</span> minHeight = Math.min(leftMax[i], rightMax[i]);        <span class="hljs-keyword">if</span> (minHeight &gt; height[i]) &#123;            res += minHeight - height[i];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 16. æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ</title>
    <link href="/2020/10/04/LeetCode-16-3sum-closest/"/>
    <url>/2020/10/04/LeetCode-16-3sum-closest/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/3sum-closest/" target="_blank" rel="noopener">16. æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">threeSumClosest</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    Arrays.sort(nums);    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> res = nums[<span class="hljs-number">0</span>] + nums[<span class="hljs-number">1</span>] + nums[<span class="hljs-number">2</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-keyword">int</span> left = i + <span class="hljs-number">1</span>;        <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> sum = nums[i] + nums[left] + nums[right];            <span class="hljs-keyword">if</span> (sum == target) &#123;                <span class="hljs-keyword">return</span> res;            &#125;            <span class="hljs-keyword">if</span> (Math.abs(target - sum) &lt; Math.abs(target - res)) &#123;                res = sum;            &#125;            <span class="hljs-keyword">if</span> (sum &gt; target) &#123;                right--;            &#125; <span class="hljs-keyword">else</span> &#123;                left++;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 15. ä¸‰æ•°ä¹‹å’Œ</title>
    <link href="/2020/10/03/LeetCode-15-3sum/"/>
    <url>/2020/10/03/LeetCode-15-3sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/3sum/" target="_blank" rel="noopener">15. ä¸‰æ•°ä¹‹å’Œ</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; threeSum(<span class="hljs-keyword">int</span>[] nums) &#123;    List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = nums.length;    Arrays.sort(nums);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// é‡å¤æ•°å­—</span>        <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// å½“å‰ä¸ºæ­£æ•°ï¼Œåˆ™ä¹‹åéƒ½ä¸ºæ­£æ•°ï¼Œå’Œä¸å¯èƒ½ä¸º 0</span>        <span class="hljs-keyword">if</span> (nums[i] &gt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        <span class="hljs-keyword">int</span> left = i + <span class="hljs-number">1</span>;        <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> sum = nums[left] + nums[right] + nums[i];            <span class="hljs-keyword">if</span> (sum == <span class="hljs-number">0</span>) &#123;                res.add(Arrays.asList(nums[i], nums[left], nums[right]));                <span class="hljs-comment">// å»é‡</span>                <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[left] == nums[left + <span class="hljs-number">1</span>]) &#123;                    left++;                &#125;                <span class="hljs-comment">// å»é‡</span>                <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[right] == nums[right - <span class="hljs-number">1</span>]) &#123;                    right--;                &#125;                <span class="hljs-comment">// æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¯è¡Œè§£</span>                left++;                right--;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sum &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-comment">// å³å€¼åå¤§</span>                right--;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// å·¦å€¼åå°</span>                left++;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨</title>
    <link href="/2020/10/02/LeetCode-11-container-with-most-water/"/>
    <url>/2020/10/02/LeetCode-11-container-with-most-water/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/container-with-most-water/" target="_blank" rel="noopener">11. ç››æœ€å¤šæ°´çš„å®¹å™¨</a><br />é¢ç§¯å–å†³äºæœ€ä½çš„æŸ±å­é«˜åº¦ï¼Œè€Œæ¯æ¬¡å‘å†…ç§»åŠ¨å®½åº¦ä¸€å®šå‡å°ï¼Œå› æ­¤è¦è¾¾åˆ°å°½å¯èƒ½å¤§çš„é¢ç§¯ï¼Œæ–°æŸ±å­çš„æœ€ä½é«˜åº¦ä¸èƒ½å°äºå½“å‰æŸ±å­çš„æœ€ä½é«˜åº¦ã€‚</p><ul><li>è‹¥ç§»åŠ¨é«˜çš„æŸ±å­ï¼Œé«˜åº¦ä¸€å®šä¸ä¼šè¶…è¿‡å½“å‰çš„æœ€ä½ç‚¹ï¼Œé¢ç§¯åè€Œå¯èƒ½å‡å°ã€‚</li><li>è‹¥ç§»åŠ¨ä½çš„æŸ±å­ï¼Œæ–°çš„æœ€ä½é«˜åº¦å¯èƒ½ä¼šè¶…è¿‡å½“å‰æœ€ä½ç‚¹ï¼Œé¢ç§¯æ‰æœ‰å¯èƒ½å¢å¤§ã€‚</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] height)</span> </span>&#123;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = height.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> area = Math.min(height[left], height[right]) * (right - left);        max = Math.max(max, area);        <span class="hljs-keyword">if</span> (height[left] &lt; height[right]) &#123;            left++;        &#125; <span class="hljs-keyword">else</span> &#123;            right--;        &#125;    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 48. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</title>
    <link href="/2020/09/30/LeetCode-offer-48-zui-chang-bu-han-zhong-fu-zi-fu-de-zi-zi-fu-chuan-lcof/"/>
    <url>/2020/09/30/LeetCode-offer-48-zui-chang-bu-han-zhong-fu-zi-fu-de-zi-zi-fu-chuan-lcof/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/zui-chang-bu-han-zhong-fu-zi-fu-de-zi-zi-fu-chuan-lcof/" target="_blank" rel="noopener">å‰‘æŒ‡ Offer 48. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</a></p><h1 id="set"><a class="markdownIt-Anchor" href="#set"></a> Set</h1><p>è®°å½•å­—ç¬¦æ˜¯å¦å‡ºç°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = chars.length;    Set&lt;Character&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">char</span> c = chars[right];        right++;        <span class="hljs-keyword">while</span> (set.contains(c)) &#123;            set.remove(chars[left]);            left++;        &#125;        set.add(c);        maxLen = Math.max(maxLen, right - left);    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre><h1 id="hashmap"><a class="markdownIt-Anchor" href="#hashmap"></a> HashMap</h1><p>è®°å½•å­—ç¬¦çš„æœ€åä¸€æ¬¡å‡ºç°ä½ç½®ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = chars.length;    Map&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">char</span> c = chars[right];        <span class="hljs-keyword">if</span> (map.containsKey(c)) &#123;            left = Math.max(map.get(c) + <span class="hljs-number">1</span>, left);        &#125;        map.put(c, right);        maxLen = Math.max(maxLen, right - left + <span class="hljs-number">1</span>);        right++;    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre><h1 id="æ•°ç»„å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#æ•°ç»„å“ˆå¸Œ"></a> æ•°ç»„å“ˆå¸Œ</h1><p>è®°å½•å­—ç¬¦å‡ºç°æ¬¡æ•°</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span>[] freq = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">128</span>];    <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">char</span> c = chars[right];        right++;        <span class="hljs-comment">// æ”¶ç¼©å·¦è¾¹ç•Œï¼Œç›´åˆ° right å¯¹åº”å­—ç¬¦æœªå‡ºç°</span>        <span class="hljs-keyword">while</span> (freq[c] &gt; <span class="hljs-number">0</span>) &#123;            freq[chars[left]]--;            left++;        &#125;        freq[c]++;        maxLen = Math.max(maxLen, right - left);    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 995. K è¿ç»­ä½çš„æœ€å°ç¿»è½¬æ¬¡æ•°</title>
    <link href="/2020/09/30/LeetCode-995-minimum-number-of-k-consecutive-bit-flips/"/>
    <url>/2020/09/30/LeetCode-995-minimum-number-of-k-consecutive-bit-flips/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-number-of-k-consecutive-bit-flips/" target="_blank" rel="noopener">995. K è¿ç»­ä½çš„æœ€å°ç¿»è½¬æ¬¡æ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minKBitFlips</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A, <span class="hljs-keyword">int</span> K)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (A[i] == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// A[i] == 0ï¼Œä½†åé¢æ²¡æœ‰ K ä½ï¼Œæ— æ³•ç¿»è½¬</span>        <span class="hljs-keyword">if</span> (i + K &gt; len) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-comment">// é‡åˆ° 0 å°±åè½¬</span>        count++;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt; i + K; j++) &#123;            A[j] ^= <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minKBitFlips</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A, <span class="hljs-keyword">int</span> K)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    ArrayDeque&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// i ä¸åœ¨å‰å‡ æ¬¡çš„ç¿»è½¬å­æ•°ç»„ä¸­</span>        <span class="hljs-keyword">while</span> (!queue.isEmpty() &amp;&amp; queue.peekFirst() + K &lt;= i) &#123;            queue.poll();        &#125;        <span class="hljs-comment">// åœ¨ [i - k + 1, i - 1] ç¿»è½¬ä¸­</span>        <span class="hljs-comment">// 1 ç¿»è½¬å¥‡æ•°æ¬¡åå˜ä¸º 0</span>        <span class="hljs-comment">// 0 ç¿»è½¬å¶æ•°æ¬¡åå˜ä¸º 1ï¼Œè¿™ä¸¤ç§æƒ…å†µéœ€è¦å†æ¬¡ç¿»è½¬</span>        <span class="hljs-keyword">if</span> (queue.size() % <span class="hljs-number">2</span> == A[i]) &#123;            <span class="hljs-comment">// å‰©ä¸‹ä¸è¶³ K ä½ï¼Œæ— æ³•ç¿»è½¬</span>            <span class="hljs-keyword">if</span> (i + K &gt; len) &#123;                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;            &#125;            count++;            queue.add(i);        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ è¾“å…¥è¾“å‡º</title>
    <link href="/2020/09/30/os-io/"/>
    <url>/2020/09/30/os-io/</url>
    
    <content type="html"><![CDATA[<h1 id="io-ç¡¬ä»¶åŸç†"><a class="markdownIt-Anchor" href="#io-ç¡¬ä»¶åŸç†"></a> I/O ç¡¬ä»¶åŸç†</h1><h2 id="io-è®¾å¤‡"><a class="markdownIt-Anchor" href="#io-è®¾å¤‡"></a> I/O è®¾å¤‡</h2><p><code>I/O è®¾å¤‡(I/O devices)</code> å¯ä»¥åˆ†æˆä¸¤ç§ï¼š<code>å—è®¾å¤‡(block devices)</code> å’Œ <code>å­—ç¬¦è®¾å¤‡(character devices)</code>ã€‚</p><h3 id="å—è®¾å¤‡"><a class="markdownIt-Anchor" href="#å—è®¾å¤‡"></a> å—è®¾å¤‡</h3><p>å—è®¾å¤‡æ˜¯ä¸€ä¸ªèƒ½å­˜å‚¨<strong>å›ºå®šå¤§å°</strong>å—ä¿¡æ¯çš„è®¾å¤‡ï¼Œå®ƒæ”¯æŒä»¥å›ºå®šå¤§å°çš„å—ï¼Œæ‰‡åŒºæˆ–ç¾¤é›†è¯»å–å’Œï¼ˆå¯é€‰ï¼‰å†™å…¥æ•°æ®ã€‚æ¯ä¸ªå—éƒ½æœ‰è‡ªå·±çš„ç‰©ç†åœ°å€ã€‚é€šå¸¸å—çš„å¤§å°åœ¨ <code>512 - 65536</code> ä¹‹é—´ã€‚æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯éƒ½ä¼šä»¥è¿ç»­çš„å—ä¸ºå•ä½ã€‚å—è®¾å¤‡çš„åŸºæœ¬ç‰¹å¾æ˜¯<strong>æ¯ä¸ªå—éƒ½è¾ƒä¸ºå¯¹ç«‹ï¼Œèƒ½å¤Ÿç‹¬ç«‹çš„è¿›è¡Œè¯»å†™</strong>ã€‚å¸¸è§çš„å—è®¾å¤‡æœ‰ ç¡¬ç›˜ã€è“å…‰å…‰ç›˜ã€USB ç›˜ã€‚</p><p>ç¼ºç‚¹ï¼šåŸºäºç»™å®šå›ºæ€å­˜å‚¨å™¨çš„å—è®¾å¤‡æ¯”åŸºäºç›¸åŒç±»å‹çš„å­˜å‚¨å™¨çš„å­—èŠ‚å¯»å€è¦æ…¢ä¸€äº›ï¼Œå› ä¸º<strong>å¿…é¡»åœ¨å—çš„å¼€å¤´å¼€å§‹è¯»å–æˆ–å†™å…¥</strong>ã€‚æ‰€ä»¥ï¼Œè¦è¯»å–è¯¥å—çš„ä»»ä½•éƒ¨åˆ†ï¼Œå¿…é¡»å¯»æ‰¾åˆ°è¯¥å—çš„å¼€å§‹ï¼Œè¯»å–æ•´ä¸ªå—ï¼Œå¦‚æœä¸ä½¿ç”¨è¯¥å—ï¼Œåˆ™å°†å…¶ä¸¢å¼ƒã€‚è¦å†™å…¥å—çš„ä¸€éƒ¨åˆ†ï¼Œå¿…é¡»å¯»æ‰¾åˆ°å—çš„å¼€å§‹ï¼Œå°†æ•´ä¸ªå—è¯»å…¥å†…å­˜ï¼Œä¿®æ”¹æ•°æ®ï¼Œå†æ¬¡å¯»æ‰¾åˆ°å—çš„å¼€å¤´å¤„ï¼Œç„¶åå°†æ•´ä¸ªå—å†™å›è®¾å¤‡ã€‚</p><h3 id="å­—ç¬¦è®¾å¤‡"><a class="markdownIt-Anchor" href="#å­—ç¬¦è®¾å¤‡"></a> å­—ç¬¦è®¾å¤‡</h3><p>å­—ç¬¦è®¾å¤‡<strong>ä»¥å­—ç¬¦ä¸ºå•ä½å‘é€æˆ–æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµ</strong>ï¼Œè€Œä¸è€ƒè™‘ä»»ä½•å—ç»“æ„ã€‚å­—ç¬¦è®¾å¤‡æ˜¯<strong>ä¸å¯å¯»å€</strong>çš„ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å¯»é“æ“ä½œã€‚å¸¸è§çš„å­—ç¬¦è®¾å¤‡æœ‰ æ‰“å°æœºã€ç½‘ç»œè®¾å¤‡ã€é¼ æ ‡ã€ä»¥åŠå¤§å¤šæ•°ä¸ç£ç›˜ä¸åŒçš„è®¾å¤‡ã€‚</p><h2 id="è®¾å¤‡æ§åˆ¶å™¨"><a class="markdownIt-Anchor" href="#è®¾å¤‡æ§åˆ¶å™¨"></a> è®¾å¤‡æ§åˆ¶å™¨</h2><p>è®¾å¤‡æ§åˆ¶å™¨çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼Œ<strong>æ§åˆ¶ä¸€ä¸ªæˆ–å¤šä¸ª <code>I/O</code> è®¾å¤‡ï¼Œä»¥å®ç° <code>I/O</code> è®¾å¤‡å’Œè®¡ç®—æœºä¹‹é—´çš„æ•°æ®äº¤æ¢</strong>ã€‚å®ƒæ˜¯ <code>CPU</code> ä¸ <code>I/O</code> è®¾å¤‡ä¹‹é—´çš„æ¥å£ï¼Œæ¥æ”¶ä» <code>CPU</code> å‘æ¥çš„å‘½ä»¤ï¼Œå»æ§åˆ¶ <code>I/O</code> è®¾å¤‡å·¥ä½œã€‚<br />è®¾å¤‡æ§åˆ¶å™¨ä»è¿æ¥çš„è®¾å¤‡å¤„æ¥æ”¶æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨æ§åˆ¶å™¨å†…éƒ¨çš„ä¸€äº› <code>ç‰¹æ®Šç›®çš„å¯„å­˜å™¨(special purpose registers)</code> ä¹Ÿå°±æ˜¯<code>æœ¬åœ°ç¼“å†²åŒº</code>ä¸­ã€‚</p><p>æ¯ä¸ªè®¾å¤‡æ§åˆ¶å™¨éƒ½ä¼šæœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸ä¹‹å¯¹åº”ï¼Œè®¾å¤‡æ§åˆ¶å™¨é€šè¿‡åº”ç”¨ç¨‹åºçš„æ¥å£é€šè¿‡ä¸­æ–­ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œé€šä¿¡ã€‚è®¾å¤‡æ§åˆ¶å™¨æ˜¯ç¡¬ä»¶ï¼Œè€Œè®¾å¤‡é©±åŠ¨ç¨‹åºæ˜¯è½¯ä»¶ã€‚</p><h2 id="å†…å­˜æ˜ å°„-io"><a class="markdownIt-Anchor" href="#å†…å­˜æ˜ å°„-io"></a> å†…å­˜æ˜ å°„ I/O</h2><p><code>CPU</code> å¦‚ä½•ä¸è®¾å¤‡å¯„å­˜å™¨å’Œè®¾å¤‡æ•°æ®ç¼“å†²åŒºè¿›è¡Œé€šä¿¡å‘¢ï¼Ÿå­˜åœ¨ä¸¤ä¸ªå¯é€‰çš„æ–¹å¼ã€‚</p><h3 id="1-åˆ©ç”¨ç‰¹å®šçš„-io-æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#1-åˆ©ç”¨ç‰¹å®šçš„-io-æŒ‡ä»¤"></a> 1. åˆ©ç”¨ç‰¹å®šçš„ I/O æŒ‡ä»¤</h3><p>ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ï¼Œæ¯ä¸ªæ§åˆ¶å¯„å­˜å™¨éƒ½è¢«åˆ†é…ä¸€ä¸ª <code>I/O ç«¯å£(I/O port)</code> å·ï¼Œè¿™æ˜¯ä¸€ä¸ª 8 ä½æˆ– 16 ä½çš„æ•´æ•°ã€‚æ‰€æœ‰ <code>I/O</code> ç«¯å£çš„é›†åˆå½¢æˆäº†å—ä¿æŠ¤çš„ <code>I/O</code> ç«¯å£ç©ºé—´ï¼Œä»¥ä¾¿æ™®é€šç”¨æˆ·ç¨‹åºæ— æ³•è®¿é—®å®ƒï¼ˆåªæœ‰æ“ä½œç³»ç»Ÿå¯ä»¥è®¿é—®ï¼‰ã€‚ä½¿ç”¨ç‰¹æ®Šçš„ I/O æŒ‡ä»¤åƒæ˜¯</p><pre><code class="hljs assembly">IN REG, PORT</code></pre><p>CPU å¯ä»¥è¯»å–æ§åˆ¶å¯„å­˜å™¨ PORT çš„å†…å®¹å¹¶å°†ç»“æœæ”¾åœ¨ <code>CPU</code> å¯„å­˜å™¨ <code>REG</code> ä¸­ã€‚ç±»ä¼¼çš„ï¼Œä½¿ç”¨</p><pre><code class="hljs assembly">OUT PORT, REG</code></pre><p><code>CPU</code> å¯ä»¥å°† <code>REG</code> çš„å†…å®¹å†™åˆ°æ§åˆ¶å¯„å­˜å™¨ä¸­ã€‚å¤§å¤šæ•°æ—©æœŸè®¡ç®—æœºï¼ŒåŒ…æ‹¬å‡ ä¹æ‰€æœ‰å¤§å‹ä¸»æœºï¼Œå¦‚ IBM 360 åŠå…¶æ‰€æœ‰åç»­æœºå‹ï¼Œéƒ½æ˜¯ä»¥è¿™ç§æ–¹å¼å·¥ä½œçš„ã€‚</p><p>åœ¨è¿™ä¸€æ–¹æ¡ˆä¸­ï¼Œå†…å­˜åœ°å€ç©ºé—´å’Œ I/O åœ°å€ç©ºé—´æ˜¯ä¸ç›¸åŒçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200930162507.png" srcset="/img/loading.gif" alt="" /></p><p>æŒ‡ä»¤</p><pre><code class="hljs assembly">IN R0,4</code></pre><p>å’Œ</p><pre><code class="hljs assembly">MOV R0,4</code></pre><p>è¿™ä¸€è®¾è®¡ä¸­å®Œå…¨ä¸åŒã€‚å‰è€…è¯»å– <code>I/Oç«¯å£</code> 4 çš„å†…å®¹å¹¶å°†å…¶æ”¾å…¥ R0ï¼Œè€Œåè€…è¯»å–<code>å­˜å‚¨å™¨</code>å­— 4 çš„å†…å®¹å¹¶å°†å…¶æ”¾å…¥ R0ã€‚è¿™äº›ç¤ºä¾‹ä¸­çš„ <code>4</code> ä»£è¡¨<strong>ä¸åŒä¸”ä¸ç›¸å…³çš„åœ°å€ç©ºé—´</strong>ã€‚</p><h3 id="2-å†…å­˜æ˜ åƒ-io"><a class="markdownIt-Anchor" href="#2-å†…å­˜æ˜ åƒ-io"></a> 2. å†…å­˜æ˜ åƒ I/O</h3><p>åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œä¸å†åŒºåˆ†å†…å­˜å•å…ƒåœ°å€å’Œè®¾å¤‡æ§åˆ¶å™¨ä¸­çš„å¯„å­˜å™¨åœ°å€ï¼Œå®ƒå°†<strong>æ‰€æœ‰æ§åˆ¶å¯„å­˜å™¨æ˜ å°„åˆ°å†…å­˜ç©ºé—´ä¸­</strong>ã€‚</p><p><code>å†…å­˜æ˜ å°„çš„ I/O</code> æ˜¯åœ¨ CPU ä¸å…¶è¿æ¥çš„å¤–å›´è®¾å¤‡ä¹‹é—´äº¤æ¢æ•°æ®å’ŒæŒ‡ä»¤çš„ä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æ˜¯å¤„ç†å™¨å’Œ IO è®¾å¤‡<strong>å…±äº«åŒä¸€å†…å­˜ä½ç½®çš„å†…å­˜</strong>ï¼Œå³å¤„ç†å™¨å’Œ <code>I/O</code> è®¾å¤‡ä½¿ç”¨å†…å­˜åœ°å€è¿›è¡Œæ˜ å°„ã€‚</p><p>å½“åœ°å€å¤„äº <code>0 ~ n - 1</code> èŒƒå›´æ—¶ï¼Œè¢«è®¤ä¸ºæ˜¯å†…å­˜åœ°å€ï¼Œå¦åˆ™è¢«è®¤ä¸ºæ˜¯æŸä¸ªæ§åˆ¶å™¨çš„å¯„å­˜å™¨åœ°å€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200930163143.png" srcset="/img/loading.gif" alt="" /></p><p>ä¼˜ç‚¹ï¼š</p><ol><li><p>å¦‚æœéœ€è¦ç‰¹æ®Šçš„ I/O æŒ‡ä»¤è¯»å†™è®¾å¤‡æ§åˆ¶å¯„å­˜å™¨ï¼Œé‚£ä¹ˆè®¿é—®è¿™äº›å¯„å­˜å™¨éœ€è¦ä½¿ç”¨æ±‡ç¼–ä»£ç ï¼Œå› ä¸ºåœ¨ C æˆ– C++ ä¸­ä¸å­˜åœ¨æ‰§è¡Œ IN å’Œ OUT æŒ‡ä»¤çš„æ–¹æ³•ã€‚è°ƒç”¨è¿™æ ·çš„è¿‡ç¨‹å¢åŠ äº† I/O çš„å¼€é”€ã€‚åœ¨å†…å­˜æ˜ å°„ä¸­ï¼Œ<strong>æ§åˆ¶å¯„å­˜å™¨åªæ˜¯å†…å­˜ä¸­çš„å˜é‡ï¼Œåœ¨ C è¯­è¨€ä¸­å¯ä»¥å’Œå…¶ä»–å˜é‡ä¸€æ ·è¿›è¡Œå¯»å€</strong>ã€‚</p></li><li><p>å¯¹äºå†…å­˜æ˜ å°„ I/O ï¼Œ<strong>ä¸éœ€è¦ç‰¹æ®Šçš„ä¿æŠ¤æœºåˆ¶</strong>å°±èƒ½å¤Ÿé˜»æ­¢ç”¨æˆ·è¿›ç¨‹æ‰§è¡Œ I/O æ“ä½œã€‚æ“ä½œç³»ç»Ÿéœ€è¦ä¿è¯çš„æ˜¯ç¦æ­¢æŠŠæ§åˆ¶å¯„å­˜å™¨çš„åœ°å€ç©ºé—´æ”¾åœ¨ç”¨æˆ·çš„è™šæ‹Ÿåœ°å€ä¸­å°±å¯ä»¥äº†ã€‚</p></li><li><p>å¯¹äºå†…å­˜æ˜ å°„ I/Oï¼Œå¯ä»¥å¼•ç”¨å†…å­˜çš„æ¯ä¸€æ¡æŒ‡ä»¤ä¹Ÿå¯ä»¥å¼•ç”¨æ§åˆ¶å¯„å­˜å™¨ï¼Œä¾¿äºå¼•ç”¨ã€‚</p></li></ol><h2 id="ç›´æ¥å†…å­˜è®¿é—®dma"><a class="markdownIt-Anchor" href="#ç›´æ¥å†…å­˜è®¿é—®dma"></a> ç›´æ¥å†…å­˜è®¿é—®ï¼ˆDMAï¼‰</h2><p>æ— è®ºä¸€ä¸ª <code>CPU</code> æ˜¯å¦å…·æœ‰å†…å­˜æ˜ å°„ <code>I/O</code>ï¼Œå®ƒéƒ½éœ€è¦å¯»å€è®¾å¤‡æ§åˆ¶å™¨ä»¥ä¾¿ä¸å®ƒä»¬äº¤æ¢æ•°æ®ã€‚<code>CPU</code> å¯ä»¥ä» <code>I/O</code> æ§åˆ¶å™¨é€šè¿‡<strong>ä¸­æ–­</strong>æ¯æ¬¡è¯·æ±‚ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä½†æ˜¯è¿™ä¹ˆåšä¼šæµªè´¹ <code>CPU</code> æ—¶é—´ï¼Œæ‰€ä»¥ç»å¸¸ä¼šç”¨åˆ°ä¸€ç§ç§°ä¸º <code>ç›´æ¥å†…å­˜è®¿é—®(Direct Memory Access)</code> çš„æ–¹æ¡ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200930163602.png" srcset="/img/loading.gif" alt="" /></p><p><strong><code>DMA</code> æ§åˆ¶å™¨èƒ½å¤Ÿç‹¬ç«‹äº CPU ä»è€Œè®¿é—®ç³»ç»Ÿæ€»çº¿</strong>ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚å®ƒåŒ…å«å‡ ä¸ªå¯ç”± CPU è¯»å†™çš„å¯„å­˜å™¨ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ª<code>å†…å­˜åœ°å€å¯„å­˜å™¨</code>ï¼Œ<code>å­—èŠ‚è®¡æ•°å¯„å­˜å™¨</code>å’Œä¸€ä¸ªæˆ–å¤šä¸ª<code>æ§åˆ¶å¯„å­˜å™¨</code>ã€‚æ§åˆ¶å¯„å­˜å™¨æŒ‡å®šè¦ä½¿ç”¨çš„ <code>I/O</code> ç«¯å£ã€ä¼ é€æ–¹å‘ï¼ˆä» <code>I/O</code> è®¾å¤‡è¯»æˆ–å†™åˆ° <code>I/O</code> è®¾å¤‡ï¼‰ã€ä¼ é€å•ä½ï¼ˆæ¯æ¬¡ä¸€ä¸ªå­—èŠ‚æˆ–è€…æ¯æ¬¡ä¸€ä¸ªå­—ï¼‰ä»¥åŠåœ¨ä¸€æ¬¡çªå‘ä¼ é€ä¸­è¦ä¼ é€çš„å­—èŠ‚æ•°ã€‚</p><h3 id="dma-å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#dma-å·¥ä½œåŸç†"></a> DMA å·¥ä½œåŸç†</h3><ol><li>é¦–å…ˆ <code>CPU</code> é€šè¿‡è®¾ç½® <code>DMA</code> æ§åˆ¶å™¨çš„å¯„å­˜å™¨å¯¹å®ƒè¿›è¡Œç¼–ç¨‹ï¼Œæ‰€ä»¥ <code>DMA</code> æ§åˆ¶å™¨çŸ¥é“å°†ä»€ä¹ˆæ•°æ®ä¼ é€åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚<code>DMA</code> æ§åˆ¶å™¨è¿˜è¦å‘ç£ç›˜æ§åˆ¶å™¨å‘å‡ºä¸€ä¸ªå‘½ä»¤ï¼Œé€šçŸ¥å®ƒä»ç£ç›˜è¯»æ•°æ®åˆ°å…¶å†…éƒ¨çš„ç¼“å†²åŒºå¹¶æ£€éªŒæ ¡éªŒå’Œã€‚å½“æœ‰æ•ˆæ•°æ®ä½äºç£ç›˜æ§åˆ¶å™¨çš„ç¼“å†²åŒºä¸­æ—¶ï¼Œ<code>DMA</code> å°±å¯ä»¥å¼€å§‹äº†ã€‚</li><li><code>DMA</code> æ§åˆ¶å™¨é€šè¿‡åœ¨æ€»çº¿ä¸Šå‘å‡ºä¸€ä¸ªè¯»è¯·æ±‚åˆ°ç£ç›˜æ§åˆ¶å™¨è€Œå‘èµ· <code>DMA</code> ä¼ é€ã€‚è¿™ä¸ªè¯»è¯·æ±‚å°±åƒå…¶ä»–è¯»è¯·æ±‚ä¸€æ ·ï¼Œ<strong>ç£ç›˜æ§åˆ¶å™¨å¹¶ä¸çŸ¥é“æˆ–è€…å¹¶ä¸å…³å¿ƒå®ƒæ˜¯æ¥è‡ª <code>CPU</code> è¿˜æ˜¯æ¥è‡ª <code>DMA</code> æ§åˆ¶å™¨ã€‚</strong> é€šå¸¸æƒ…å†µä¸‹ï¼Œè¦å†™çš„å†…å­˜åœ°å€åœ¨æ€»çº¿çš„åœ°å€çº¿ä¸Šï¼Œæ‰€ä»¥å½“ç£ç›˜æ§åˆ¶å™¨å»åŒ¹é…ä¸‹ä¸€ä¸ªå­—æ—¶ï¼Œå®ƒçŸ¥é“å°†è¯¥å­—å†™åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚</li><li>é€šè¿‡æ€»çº¿è¿›è¡Œæ•°æ®äº¤æ¢ã€‚</li><li>å½“å†™æ“ä½œå®Œæˆæ—¶ï¼Œç£ç›˜æ§åˆ¶å™¨åœ¨æ€»çº¿ä¸Šå‘å‡ºä¸€ä¸ªåº”ç­”ä¿¡å·åˆ° <code>DMA</code> æ§åˆ¶å™¨ã€‚</li></ol><h2 id="ä¸­æ–­"><a class="markdownIt-Anchor" href="#ä¸­æ–­"></a> ä¸­æ–­</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200930174048.png" srcset="/img/loading.gif" alt="" /></p><p>å½“ä¸€ä¸ª I/O è®¾å¤‡å®Œæˆå®ƒçš„å·¥ä½œåï¼Œå®ƒå°±ä¼šäº§ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œå®ƒé€šè¿‡åœ¨æ€»çº¿ä¸Šå£°æ˜å·²åˆ†é…çš„ä¿¡å·æ¥å®ç°æ­¤ç›®çš„ã€‚ä¸»æ¿ä¸Šçš„ä¸­æ–­æ§åˆ¶å™¨èŠ¯ç‰‡ä¼šæ£€æµ‹åˆ°è¿™ä¸ªä¿¡å·ï¼Œç„¶åæ‰§è¡Œä¸­æ–­æ“ä½œã€‚</p><ul><li>å¦‚æœåœ¨ä¸­æ–­å‰æ²¡æœ‰å…¶ä»–ä¸­æ–­æ“ä½œé˜»å¡çš„è¯ï¼Œä¸­æ–­æ§åˆ¶å™¨å°†ç«‹åˆ»å¯¹ä¸­æ–­è¿›è¡Œå¤„ç†ã€‚</li><li>å¦‚æœåœ¨ä¸­æ–­å‰è¿˜æœ‰å…¶ä»–ä¸­æ–­æ“ä½œæ­£åœ¨æ‰§è¡Œï¼Œæˆ–è€…æœ‰å…¶ä»–è®¾å¤‡å‘å‡º<strong>ä¼˜å…ˆçº§æ›´é«˜</strong>çš„ä¸­æ–­ä¿¡å·çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¾å¤‡å°†æš‚æ—¶ä¸ä¼šå¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥è®¾å¤‡ä¼šç»§ç»­åœ¨æ€»çº¿ä¸Šç½®èµ·ä¸­æ–­ä¿¡å·ï¼Œç›´åˆ°å¾—åˆ° <code>CPU</code> æœåŠ¡ã€‚</li></ul><p>ç¡¬ä»¶é€šå¸¸åœ¨æœåŠ¡ç¨‹åºå¼€å§‹å‰ä¿å­˜å½“å‰ä¿¡æ¯ã€‚å¯¹äºä¸åŒçš„ <code>CPU</code> æ¥è¯´ï¼Œå“ªäº›ä¿¡æ¯éœ€è¦ä¿å­˜ä»¥åŠä¿å­˜åœ¨å“ªé‡Œå·®åˆ«å¾ˆå¤§ã€‚ä¸ç®¡å…¶ä»–çš„ä¿¡æ¯æ˜¯å¦ä¿å­˜ï¼Œ<strong>ç¨‹åºè®¡æ•°å™¨å¿…é¡»è¦è¢«ä¿å­˜ï¼Œè¿™å¯¹æ‰€æœ‰çš„ CPU æ¥è¯´éƒ½æ˜¯ç›¸åŒçš„ï¼Œä»¥æ­¤æ¥æ¢å¤ä¸­æ–­çš„è¿›ç¨‹ã€‚</strong> æ‰€æœ‰å¯è§å¯„å­˜å™¨å’Œå¤§é‡å†…éƒ¨å¯„å­˜å™¨ä¹Ÿåº”è¯¥è¢«ä¿å­˜ã€‚</p><p>ä¸Šé¢è¯´åˆ°ç¡¬ä»¶åº”è¯¥ä¿å­˜å½“å‰ä¿¡æ¯ï¼Œé‚£ä¹ˆä¿å­˜åœ¨å“ªé‡Œæ˜¯ä¸ªé—®é¢˜ï¼Œä¸€ç§é€‰æ‹©æ˜¯å°†å…¶æ”¾å…¥åˆ°<strong>å†…éƒ¨å¯„å­˜å™¨</strong>ä¸­ï¼Œåœ¨éœ€è¦æ—¶æ“ä½œç³»ç»Ÿå¯ä»¥è¯»å‡ºè¿™äº›å†…éƒ¨å¯„å­˜å™¨ã€‚è¿™ç§æ–¹æ³•ä¼šé€ æˆçš„é—®é¢˜æ˜¯ï¼šä¸€æ®µæ—¶é—´å†…è®¾å¤‡æ— æ³•å“åº”ï¼Œç›´åˆ°æ‰€æœ‰çš„å†…éƒ¨å¯„å­˜å™¨ä¸­å­˜å‚¨çš„ä¿¡æ¯è¢«è¯»å‡ºåï¼Œæ‰èƒ½æ¢å¤è¿è¡Œï¼Œä»¥å…ç¬¬äºŒä¸ªå†…éƒ¨å¯„å­˜å™¨é‡å†™å†…éƒ¨å¯„å­˜å™¨çš„çŠ¶æ€ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯åœ¨<strong>å †æ ˆ</strong>ä¸­ä¿å­˜ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ† <code>CPU</code> æ‰€ä½¿ç”¨çš„æ–¹å¼ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå­˜åœ¨é—®é¢˜ï¼Œå› ä¸ºä½¿ç”¨çš„å †æ ˆä¸ç¡®å®šï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯å½“å‰å †æ ˆï¼Œåˆ™å®ƒå¾ˆå¯èƒ½æ˜¯ç”¨æˆ·è¿›ç¨‹çš„å †æ ˆã€‚å †æ ˆæŒ‡é’ˆç”šè‡³ä¸åˆæ³•ï¼Œè¿™æ ·å½“ç¡¬ä»¶è¯•å›¾åœ¨å®ƒæ‰€æŒ‡çš„åœ°å€å¤„å†™å…¥æ—¶ï¼Œå°†ä¼šå¯¼è‡´è‡´å‘½é”™è¯¯ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯å†…æ ¸å †æ ˆï¼Œå †æ ˆæŒ‡é’ˆæ˜¯åˆæ³•çš„å¹¶ä¸”æŒ‡å‘ä¸€ä¸ªå›ºå®šçš„é¡µé¢ï¼Œè¿™æ ·çš„æœºä¼šå¯èƒ½ä¼šæ›´å¤§ã€‚ç„¶è€Œï¼Œåˆ‡æ¢åˆ°å†…æ ¸æ€éœ€è¦åˆ‡æ¢ <code>MMU</code> ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å¯èƒ½ä½¿é«˜é€Ÿç¼“å­˜æˆ–è€… <code>TLB</code> å¤±æ•ˆã€‚é™æ€æˆ–åŠ¨æ€é‡æ–°è£…è½½è¿™äº›ä¸œè¥¿å°†å¢åŠ ä¸­æ–­å¤„ç†çš„æ—¶é—´ï¼Œæµªè´¹ <code>CPU</code> æ—¶é—´ã€‚</p><h1 id="io-è½¯ä»¶åŸç†"><a class="markdownIt-Anchor" href="#io-è½¯ä»¶åŸç†"></a> IO è½¯ä»¶åŸç†</h1><h2 id="io-è½¯ä»¶ç›®æ ‡"><a class="markdownIt-Anchor" href="#io-è½¯ä»¶ç›®æ ‡"></a> I/O è½¯ä»¶ç›®æ ‡</h2><h3 id="1-è®¾å¤‡ç‹¬ç«‹æ€§"><a class="markdownIt-Anchor" href="#1-è®¾å¤‡ç‹¬ç«‹æ€§"></a> 1. è®¾å¤‡ç‹¬ç«‹æ€§</h3><p><code>è®¾å¤‡ç‹¬ç«‹æ€§(device independence)</code> æ„å‘³ç€æˆ‘ä»¬<strong>èƒ½å¤Ÿç¼–å†™è®¿é—®ä»»ä½•è®¾å¤‡çš„åº”ç”¨ç¨‹åº</strong>ï¼Œè€Œä¸ç”¨äº‹å…ˆæŒ‡å®šç‰¹å®šçš„è®¾å¤‡ã€‚æ¯”å¦‚ä½ ç¼–å†™äº†ä¸€ä¸ªèƒ½å¤Ÿä»è®¾å¤‡è¯»å…¥æ–‡ä»¶çš„åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆè¿™ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥ä»ç¡¬ç›˜ã€DVD æˆ–è€… USB è¿›è¡Œè¯»å…¥ï¼Œä¸å¿…å†ä¸ºæ¯ä¸ªè®¾å¤‡å®šåˆ¶åº”ç”¨ç¨‹åºã€‚è¿™å…¶å®å°±ä½“ç°äº†è®¾å¤‡ç‹¬ç«‹æ€§çš„æ¦‚å¿µã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201007134014.png" srcset="/img/loading.gif" alt="" /></p><p>å†æ¯”å¦‚è¯´ä½ å¯ä»¥è¾“å…¥ä¸€æ¡ä¸‹é¢çš„æŒ‡ä»¤</p><pre><code class="hljs gradle"><span class="hljs-keyword">sort</span> è¾“å…¥ è¾“å‡º</code></pre><p>é‚£ä¹ˆä¸Šé¢è¿™ä¸ª <code>è¾“å…¥</code> å°±å¯ä»¥æ¥æ”¶æ¥è‡ªä»»æ„ç±»å‹çš„ç£ç›˜æˆ–è€…é”®ç›˜ï¼Œå¹¶ä¸” <code>è¾“å‡º</code> å¯ä»¥å†™å…¥åˆ°ä»»æ„ç±»å‹çš„ç£ç›˜æˆ–è€…å±å¹•ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201007134238.png" srcset="/img/loading.gif" alt="" /></p><p>è®¡ç®—æœºæ“ä½œç³»ç»Ÿæ˜¯è¿™äº›ç¡¬ä»¶çš„åª’ä»‹ï¼Œå› ä¸ºä¸åŒç¡¬ä»¶å®ƒä»¬çš„æŒ‡ä»¤åºåˆ—ä¸åŒï¼Œæ‰€ä»¥éœ€è¦æ“ä½œç³»ç»Ÿæ¥åšæŒ‡ä»¤é—´çš„è½¬æ¢ã€‚</p><p>ä¸è®¾å¤‡ç‹¬ç«‹æ€§å¯†åˆ‡ç›¸å…³çš„ä¸€ä¸ªæŒ‡æ ‡å°±æ˜¯ <code>ç»Ÿä¸€å‘½å(uniform naming)</code>ã€‚è®¾å¤‡çš„ä»£å·åº”è¯¥æ˜¯ä¸€ä¸ªæ•´æ•°æˆ–è€…æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¸åº”è¯¥ä¾èµ–äºå…·ä½“çš„è®¾å¤‡ã€‚åœ¨ <code>UNIX</code> ä¸­ï¼Œæ‰€æœ‰çš„ç£ç›˜éƒ½èƒ½å¤Ÿè¢«é›†æˆåˆ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ‰€ä»¥ç”¨æˆ·ä¸ç”¨è®°ä½æ¯ä¸ªè®¾å¤‡çš„å…·ä½“åç§°ï¼Œç›´æ¥è®°ä½å¯¹åº”çš„è·¯å¾„å³å¯ï¼Œå¦‚æœè·¯å¾„è®°ä¸ä½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>ls</code> ç­‰æŒ‡ä»¤æ‰¾åˆ°å…·ä½“çš„é›†æˆä½ç½®ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œæ¯”å¦‚ä¸€ä¸ª USB ç£ç›˜è¢«æŒ‚è½½åˆ°äº† <code>/usr/likai/backup</code> ä¸‹ï¼Œé‚£ä¹ˆä½ æŠŠæ–‡ä»¶å¤åˆ¶åˆ° <code>/usr/likai/backup/device</code> ä¸‹ï¼Œå°±ç›¸å½“äºæ˜¯æŠŠæ–‡ä»¶å¤åˆ¶åˆ°äº†ç£ç›˜ä¸­ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ç°äº†å‘ä»»ä½•ç£ç›˜å†™å…¥æ–‡ä»¶éƒ½ç›¸å½“äºæ˜¯å‘æŒ‡å®šçš„è·¯å¾„è¾“å‡ºæ–‡ä»¶ã€‚</p><h3 id="2-é”™è¯¯å¤„ç†"><a class="markdownIt-Anchor" href="#2-é”™è¯¯å¤„ç†"></a> 2. é”™è¯¯å¤„ç†</h3><p><code>I/O</code> è½¯ä»¶å®ç°çš„ç¬¬äºŒä¸ªé‡è¦çš„ç›®æ ‡å°±æ˜¯ <code>é”™è¯¯å¤„ç†(error handling)</code>ã€‚é€šå¸¸æƒ…å†µä¸‹æ¥è¯´ï¼Œé”™è¯¯åº”è¯¥äº¤ç»™ç¡¬ä»¶å±‚é¢å»å¤„ç†ã€‚å¦‚æœè®¾å¤‡æ§åˆ¶å™¨å‘ç°äº†è¯»é”™è¯¯çš„è¯ï¼Œå®ƒä¼šå°½å¯èƒ½çš„å»ä¿®å¤è¿™ä¸ªé”™è¯¯ã€‚å¦‚æœè®¾å¤‡æ§åˆ¶å™¨å¤„ç†ä¸äº†è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆè®¾å¤‡é©±åŠ¨ç¨‹åºåº”è¯¥è¿›è¡Œå¤„ç†ï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºä¼šå†æ¬¡å°è¯•è¯»å–æ“ä½œï¼Œå¾ˆå¤šé”™è¯¯éƒ½æ˜¯å¶ç„¶æ€§çš„ï¼Œå¦‚æœè®¾å¤‡é©±åŠ¨ç¨‹åºæ— æ³•å¤„ç†è¿™ä¸ªé”™è¯¯ï¼Œæ‰ä¼šæŠŠé”™è¯¯å‘ä¸ŠæŠ›åˆ°ç¡¬ä»¶å±‚é¢ï¼ˆä¸Šå±‚ï¼‰è¿›è¡Œå¤„ç†ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œ<strong>ä¸Šå±‚å¹¶ä¸éœ€è¦çŸ¥é“ä¸‹å±‚æ˜¯å¦‚ä½•è§£å†³é”™è¯¯çš„</strong>ã€‚è¿™å°±å¾ˆåƒé¡¹ç›®ç»ç†ä¸ç”¨æŠŠæ¯ä¸ªå†³å®šéƒ½å‘Šè¯‰è€æ¿ï¼›ç¨‹åºå‘˜ä¸ç”¨æŠŠæ¯è¡Œä»£ç å¦‚ä½•å†™å‘Šè¯‰é¡¹ç›®ç»ç†ã€‚è¿™ç§å¤„ç†æ–¹å¼ä¸å¤Ÿé€æ˜ã€‚</p><h3 id="3-åŒæ­¥å’Œå¼‚æ­¥ä¼ è¾“"><a class="markdownIt-Anchor" href="#3-åŒæ­¥å’Œå¼‚æ­¥ä¼ è¾“"></a> 3. åŒæ­¥å’Œå¼‚æ­¥ä¼ è¾“</h3><p><code>I/O</code> è½¯ä»¶å®ç°çš„ç¬¬ä¸‰ä¸ªç›®æ ‡å°±æ˜¯ <code>åŒæ­¥(synchronous)</code> å’Œ <code>å¼‚æ­¥(asynchronousï¼Œå³ä¸­æ–­é©±åŠ¨)</code> ä¼ è¾“ã€‚</p><ul><li>åŒæ­¥ä¼ è¾“ä¸­æ•°æ®é€šå¸¸ä»¥<strong>å—æˆ–å¸§</strong>çš„å½¢å¼å‘é€ã€‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹åœ¨æ•°æ®ä¼ è¾“ä¹‹å‰åº”è¯¥å…·æœ‰<strong>åŒæ­¥æ—¶é’Ÿ</strong>ã€‚</li><li>å¼‚æ­¥ä¼ è¾“ä¸­ï¼Œæ•°æ®é€šå¸¸ä»¥<strong>å­—èŠ‚</strong>æˆ–è€…<strong>å­—ç¬¦</strong>çš„å½¢å¼å‘é€ï¼Œå¼‚æ­¥ä¼ è¾“åˆ™ä¸éœ€è¦åŒæ­¥æ—¶é’Ÿï¼Œä½†æ˜¯ä¼šåœ¨ä¼ è¾“ä¹‹å‰å‘æ•°æ®æ·»åŠ <strong>å¥‡å¶æ ¡éªŒä½</strong>ã€‚</li></ul><p>å¤§éƒ¨åˆ† <code>ç‰©ç† IO(physical I/O)</code> æ˜¯å¼‚æ­¥çš„ã€‚ç‰©ç† I/O ä¸­çš„ <code>CPU</code> æ˜¯å¾ˆèªæ˜çš„ï¼ŒCPU ä¼ è¾“å®Œæˆåä¼šè½¬è€Œåšå…¶ä»–äº‹æƒ…ï¼Œå®ƒå’Œä¸­æ–­å¿ƒçµç›¸é€šï¼Œç­‰åˆ°ä¸­æ–­å‘ç”Ÿåï¼Œ<code>CPU</code> æ‰ä¼šå›åˆ°ä¼ è¾“è¿™ä»¶äº‹æƒ…ä¸Šæ¥ã€‚</p><blockquote><p><code>I/O</code> åˆ†ä¸ºä¸¤ç§ï¼š<code>ç‰©ç† I/O</code> å’Œ <code>é€»è¾‘ I/O(Logical I/O)</code>ã€‚</p><p><code>ç‰©ç† I/O</code> é€šå¸¸æ˜¯ä»ç£ç›˜ç­‰<strong>å­˜å‚¨è®¾å¤‡</strong>å®é™…è·å–æ•°æ®ã€‚<code>é€»è¾‘ I/O</code> æ˜¯å¯¹<strong>å­˜å‚¨å™¨</strong>ï¼ˆå—ï¼Œç¼“å†²åŒºï¼‰è·å–æ•°æ®ã€‚</p></blockquote><h3 id="4-ç¼“å†²"><a class="markdownIt-Anchor" href="#4-ç¼“å†²"></a> 4. ç¼“å†²</h3><p><code>I/O</code> è½¯ä»¶çš„æœ€åä¸€ä¸ªé—®é¢˜æ˜¯ <code>ç¼“å†²(buffering)</code>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä»ä¸€ä¸ªè®¾å¤‡å‘å‡ºçš„æ•°æ®ä¸ä¼šç›´æ¥åˆ°è¾¾æœ€åçš„è®¾å¤‡ã€‚å…¶é—´ä¼šç»è¿‡ä¸€ç³»åˆ—çš„æ ¡éªŒã€æ£€æŸ¥ã€ç¼“å†²ç­‰æ“ä½œæ‰èƒ½åˆ°è¾¾ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œä»ç½‘ç»œä¸Šå‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¼šç»è¿‡ä¸€ç³»åˆ—æ£€æŸ¥ä¹‹åé¦–å…ˆåˆ°è¾¾ç¼“å†²åŒºï¼Œä»è€Œæ¶ˆé™¤ç¼“å†²åŒºå¡«æ»¡é€Ÿç‡å’Œç¼“å†²åŒºè¿‡è½½ã€‚</p><h3 id="5-å…±äº«å’Œç‹¬å "><a class="markdownIt-Anchor" href="#5-å…±äº«å’Œç‹¬å "></a> 5. å…±äº«å’Œç‹¬å </h3><p>æœ‰äº› I/O è®¾å¤‡èƒ½å¤Ÿè¢«è®¸å¤šç”¨æˆ·å…±åŒä½¿ç”¨ã€‚ä¸€äº›è®¾å¤‡æ¯”å¦‚ç£ç›˜ï¼Œè®©å¤šä¸ªç”¨æˆ·ä½¿ç”¨ä¸€èˆ¬ä¸ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æŸäº›è®¾å¤‡å¿…é¡»å…·æœ‰ç‹¬å æ€§ï¼Œå³åªå…è®¸å•ä¸ªç”¨æˆ·ä½¿ç”¨å®Œæˆåæ‰èƒ½è®©å…¶ä»–ç”¨æˆ·ä½¿ç”¨ã€‚</p><h2 id="æ§åˆ¶-io-è®¾å¤‡çš„æ–¹æ³•"><a class="markdownIt-Anchor" href="#æ§åˆ¶-io-è®¾å¤‡çš„æ–¹æ³•"></a> æ§åˆ¶ I/O è®¾å¤‡çš„æ–¹æ³•</h2><h3 id="1-ä½¿ç”¨ç¨‹åºæ§åˆ¶-io"><a class="markdownIt-Anchor" href="#1-ä½¿ç”¨ç¨‹åºæ§åˆ¶-io"></a> 1. ä½¿ç”¨ç¨‹åºæ§åˆ¶ I/O</h3><p>ä½¿ç”¨ç¨‹åºæ§åˆ¶ <code>I/O</code> åˆè¢«ç§°ä¸º <code>å¯ç¼–ç¨‹I/O</code>ï¼Œå®ƒæ˜¯æŒ‡ç”± <code>CPU</code> åœ¨é©±åŠ¨ç¨‹åºè½¯ä»¶æ§åˆ¶ä¸‹å¯åŠ¨çš„æ•°æ®ä¼ è¾“ï¼Œæ¥è®¿é—®è®¾å¤‡ä¸Šçš„å¯„å­˜å™¨æˆ–è€…å…¶ä»–å­˜å‚¨å™¨ã€‚<code>CPU</code> ä¼šå‘å‡ºå‘½ä»¤ï¼Œç„¶åç­‰å¾… <code>I/O</code> æ“ä½œçš„å®Œæˆã€‚ç”±äº <code>CPU</code> çš„é€Ÿåº¦æ¯” <code>I/O</code> æ¨¡å—çš„é€Ÿåº¦å¿«å¾ˆå¤šï¼Œå› æ­¤å¯ç¼–ç¨‹ <code>I/O</code> çš„é—®é¢˜åœ¨äºï¼Œ<code>CPU</code> å¿…é¡»ç­‰å¾…å¾ˆé•¿æ—¶é—´æ‰èƒ½ç­‰åˆ°å¤„ç†ç»“æœã€‚<code>CPU</code> åœ¨ç­‰å¾…æ—¶ä¼šé‡‡ç”¨ <code>è½®è¯¢(polling)</code> æˆ–è€… <code>å¿™ç­‰(busy waiting)</code> çš„æ–¹å¼ï¼Œç»“æœï¼Œæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½è¢«ä¸¥é‡æ‹‰ä½ã€‚å¯ç¼–ç¨‹ <code>I/O</code> ååˆ†ç®€å•ï¼Œå¦‚æœéœ€è¦ç­‰å¾…çš„æ—¶é—´éå¸¸çŸ­çš„è¯ï¼Œå¯ç¼–ç¨‹ <code>I/O</code> å€’æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ã€‚ä¸€ä¸ªå¯ç¼–ç¨‹çš„ <code>I/O</code> ä¼šç»å†å¦‚ä¸‹æ“ä½œï¼š</p><ul><li><code>CPU</code> è¯·æ±‚ I/O æ“ä½œ</li><li><code>I/O</code> æ¨¡å—æ‰§è¡Œå“åº”</li><li><code>I/O</code> æ¨¡å—è®¾ç½®çŠ¶æ€ä½</li><li><code>CPU</code> ä¼šå®šæœŸæ£€æŸ¥çŠ¶æ€ä½</li><li><code>I/O</code> <strong>ä¸ä¼šç›´æ¥é€šçŸ¥</strong> <code>CPU</code> æ“ä½œå®Œæˆï¼Œ<code>I/O</code> ä¹Ÿä¸ä¼šä¸­æ–­ <code>CPU</code></li><li><code>CPU</code> å¯èƒ½ä¼šç­‰å¾…æˆ–åœ¨éšåçš„è¿‡ç¨‹ä¸­è¿”å›</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201007135543.png" srcset="/img/loading.gif" alt="" /></p><h3 id="2-ä½¿ç”¨ä¸­æ–­é©±åŠ¨-io"><a class="markdownIt-Anchor" href="#2-ä½¿ç”¨ä¸­æ–­é©±åŠ¨-io"></a> 2. ä½¿ç”¨ä¸­æ–­é©±åŠ¨ I/O</h3><p>åœ¨ <code>CPU</code> ç­‰å¾… <code>I/O</code> è®¾å¤‡çš„åŒæ—¶ï¼Œèƒ½å¤Ÿåšå…¶ä»–äº‹æƒ…ï¼Œç­‰åˆ° <code>I/O</code> è®¾å¤‡å®Œæˆåï¼Œå®ƒå°±ä¼šäº§ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œè¿™ä¸ªä¸­æ–­ä¼šåœæ­¢å½“å‰è¿›ç¨‹å¹¶ä¿å­˜å½“å‰çš„çŠ¶æ€ã€‚ä¸€ä¸ªå¯èƒ½çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201007135557.png" srcset="/img/loading.gif" alt="" /></p><p>å°½ç®¡ä¸­æ–­å‡è½»äº† <code>CPU</code> å’Œ <code>I/O</code> è®¾å¤‡çš„ç­‰å¾…æ—¶é—´çš„è´Ÿæ‹…ï¼Œä½†æ˜¯ç”±äºè¿˜éœ€è¦åœ¨ <code>CPU</code> å’Œ <code>I/O</code> æ¨¡å—ä¹‹å‰è¿›è¡Œå¤§é‡çš„é€å­—ä¼ è¾“ï¼Œå› æ­¤åœ¨å¤§é‡æ•°æ®ä¼ è¾“ä¸­æ•ˆç‡ä»ç„¶å¾ˆä½ã€‚ä¸‹é¢æ˜¯ä¸­æ–­çš„åŸºæœ¬æ“ä½œ</p><ul><li><code>CPU</code> è¿›è¡Œè¯»å–æ“ä½œ</li><li><code>I/O</code> è®¾å¤‡ä»å¤–å›´è®¾å¤‡è·å–æ•°æ®ï¼ŒåŒæ—¶ <code>CPU</code> æ‰§è¡Œå…¶ä»–æ“ä½œ</li><li><code>I/O</code> è®¾å¤‡<strong>ä¸­æ–­é€šçŸ¥</strong> <code>CPU</code></li><li><code>CPU</code> è¯·æ±‚æ•°æ®</li><li><code>I/O</code> æ¨¡å—ä¼ è¾“æ•°æ®</li></ul><h3 id="3-ä½¿ç”¨-dma-é©±åŠ¨-io"><a class="markdownIt-Anchor" href="#3-ä½¿ç”¨-dma-é©±åŠ¨-io"></a> 3. ä½¿ç”¨ DMA é©±åŠ¨ I/O</h3><p><code>DMA</code> çš„ä¸­æ–‡åç§°æ˜¯ç›´æ¥å†…å­˜è®¿é—®ï¼Œå®ƒæ„å‘³ç€ <strong><code>CPU</code> æˆäºˆ <code>I/O</code> æ¨¡å—æƒé™åœ¨ä¸æ¶‰åŠ <code>CPU</code> çš„æƒ…å†µä¸‹è¯»å–æˆ–å†™å…¥å†…å­˜ã€‚</strong> ä¹Ÿå°±æ˜¯ <code>DMA</code> å¯ä»¥ä¸éœ€è¦ <code>CPU</code> çš„å‚ä¸ã€‚è¿™ä¸ªè¿‡ç¨‹ç”±ç§°ä¸º <code>DMA æ§åˆ¶å™¨ï¼ˆDMACï¼‰</code> çš„èŠ¯ç‰‡ç®¡ç†ã€‚ç”±äº <code>DMA</code> è®¾å¤‡å¯ä»¥ç›´æ¥åœ¨å†…å­˜ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>CPU</code> ä½œä¸ºä¸­ä»‹ï¼Œå› æ­¤å¯ä»¥ç¼“è§£æ€»çº¿ä¸Šçš„æ‹¥å¡ã€‚<code>DMA</code> é€šè¿‡å…è®¸ <code>CPU</code> æ‰§è¡Œä»»åŠ¡ï¼ŒåŒæ—¶ <code>DMA</code> ç³»ç»Ÿé€šè¿‡ç³»ç»Ÿå’Œå†…å­˜æ€»çº¿ä¼ è¾“æ•°æ®æ¥æé«˜ç³»ç»Ÿå¹¶å‘æ€§ã€‚</p><h1 id="io-å±‚æ¬¡ç»“æ„"><a class="markdownIt-Anchor" href="#io-å±‚æ¬¡ç»“æ„"></a> I/O å±‚æ¬¡ç»“æ„</h1><p>I/O è½¯ä»¶é€šå¸¸ç»„ç»‡æˆå››ä¸ªå±‚æ¬¡ï¼Œå®ƒä»¬çš„å¤§è‡´ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009130854.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ä¸­æ–­å¤„ç†ç¨‹åº"><a class="markdownIt-Anchor" href="#ä¸­æ–­å¤„ç†ç¨‹åº"></a> ä¸­æ–­å¤„ç†ç¨‹åº</h2><p>ä¸­æ–­å¤„ç†ç¨‹åºåˆè¢«ç§°ä¸º <code>ä¸­æ–­æœåŠ¡ç¨‹åº</code> æˆ–è€…æ˜¯ <code>ISR(Interrupt Service Routines)</code>ï¼Œå®ƒæ˜¯æœ€é è¿‘ç¡¬ä»¶çš„ä¸€å±‚ã€‚ä¸­æ–­å¤„ç†ç¨‹åºç”±ç¡¬ä»¶ä¸­æ–­ã€è½¯ä»¶ä¸­æ–­æˆ–è€…æ˜¯è½¯ä»¶å¼‚å¸¸å¯åŠ¨äº§ç”Ÿçš„ä¸­æ–­ï¼Œç”¨äºå®ç°è®¾å¤‡é©±åŠ¨ç¨‹åºæˆ–å—ä¿æŠ¤çš„æ“ä½œæ¨¡å¼ï¼ˆä¾‹å¦‚ç³»ç»Ÿè°ƒç”¨ï¼‰ä¹‹é—´çš„è½¬æ¢ã€‚</p><p>ä¸­æ–­å¤„ç†ç¨‹åºè´Ÿè´£å¤„ç†ä¸­æ–­å‘ç”Ÿæ—¶çš„æ‰€æœ‰æ“ä½œï¼Œæ“ä½œå®Œæˆåé˜»å¡ï¼Œç„¶åå¯åŠ¨ä¸­æ–­é©±åŠ¨ç¨‹åºæ¥è§£å†³é˜»å¡ã€‚é€šå¸¸ä¼šæœ‰ä¸‰ç§é€šçŸ¥æ–¹å¼ï¼Œä¾èµ–äºä¸åŒçš„å…·ä½“å®ç°ï¼š</p><ol><li>ä¿¡å·é‡å®ç°ä¸­ï¼šåœ¨ä¿¡å·é‡ä¸Šä½¿ç”¨ <code>up</code> è¿›è¡Œé€šçŸ¥ï¼›</li><li>ç®¡ç¨‹å®ç°ï¼šå¯¹ç®¡ç¨‹ä¸­çš„æ¡ä»¶å˜é‡æ‰§è¡Œ <code>signal</code> æ“ä½œï¼›</li><li>è¿˜æœ‰ä¸€äº›æƒ…å†µæ˜¯å‘é€ä¸€äº›æ¶ˆæ¯ã€‚</li></ol><p>ä¸‹é¢æ˜¯ä¸€äº›é€šç”¨çš„ä¸­æ–­å¤„ç†ç¨‹åºçš„æ­¥éª¤ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿå®ç°ç»†èŠ‚ä¸ä¸€æ ·</p><ol><li>ä¿å­˜æ‰€æœ‰æ²¡æœ‰è¢«ä¸­æ–­ç¡¬ä»¶ä¿å­˜çš„å¯„å­˜å™¨</li><li>ä¸ºä¸­æ–­æœåŠ¡ç¨‹åºè®¾ç½®<strong>ä¸Šä¸‹æ–‡ç¯å¢ƒ</strong>ï¼Œå¯èƒ½åŒ…æ‹¬è®¾ç½® TLBã€MMU å’Œé¡µè¡¨</li><li>ä¸ºä¸­æ–­æœåŠ¡ç¨‹åºè®¾ç½®æ ˆ</li><li>å¯¹ä¸­æ–­æ§åˆ¶å™¨ä½œå‡ºå“åº”ï¼Œå¦‚æœä¸å­˜åœ¨é›†ä¸­çš„ä¸­æ–­æ§åˆ¶å™¨ï¼Œåˆ™ç»§ç»­å“åº”ä¸­æ–­</li><li>æŠŠå¯„å­˜å™¨ä»ä¿å­˜å®ƒçš„åœ°æ–¹æ‹·è´åˆ°è¿›ç¨‹è¡¨ä¸­</li><li>è¿è¡Œä¸­æ–­æœåŠ¡ç¨‹åºï¼Œå®ƒä¼šä»å‘å‡ºä¸­æ–­çš„è®¾å¤‡æ§åˆ¶å™¨çš„å¯„å­˜å™¨ä¸­æå–ä¿¡æ¯</li><li>æ“ä½œç³»ç»Ÿä¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„è¿›ç¨‹æ¥è¿è¡Œã€‚å¦‚æœä¸­æ–­é€ æˆäº†ä¸€äº›ä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹å˜ä¸ºå°±ç»ªæ€ï¼Œåˆ™é€‰æ‹©è¿è¡Œè¿™äº›ä¼˜å…ˆçº§é«˜çš„è¿›ç¨‹</li><li>ä¸ºè¿›ç¨‹è®¾ç½® MMU ä¸Šä¸‹æ–‡ï¼Œå¯èƒ½ä¹Ÿä¼šéœ€è¦ TLBï¼Œæ ¹æ®å®é™…æƒ…å†µå†³å®š</li><li>åŠ è½½è¿›ç¨‹çš„å¯„å­˜å™¨ï¼ŒåŒ…æ‹¬ PSW å¯„å­˜å™¨</li><li>å¼€å§‹è¿è¡Œæ–°çš„è¿›ç¨‹</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009132314.png" srcset="/img/loading.gif" alt="" /></p><h2 id="è®¾å¤‡é©±åŠ¨ç¨‹åº"><a class="markdownIt-Anchor" href="#è®¾å¤‡é©±åŠ¨ç¨‹åº"></a> è®¾å¤‡é©±åŠ¨ç¨‹åº</h2><p>æ¯ä¸ªè®¾å¤‡æ§åˆ¶å™¨å†…éƒ¨éƒ½ä¼šæœ‰å¯„å­˜å™¨ç”¨æ¥å’Œè®¾å¤‡è¿›è¡Œæ²Ÿé€šï¼Œå‘é€æŒ‡ä»¤ï¼Œè¯»å–è®¾å¤‡çš„çŠ¶æ€ç­‰ã€‚å› æ­¤ï¼Œæ¯ä¸ªè¿æ¥åˆ°è®¡ç®—æœºçš„ I/O è®¾å¤‡éƒ½éœ€è¦æœ‰æŸäº›ç‰¹å®šè®¾å¤‡çš„ä»£ç å¯¹å…¶è¿›è¡Œæ§åˆ¶ï¼Œä¾‹å¦‚é¼ æ ‡æ§åˆ¶å™¨éœ€è¦ä»é¼ æ ‡æ¥å—æŒ‡ä»¤ï¼Œå‘Šè¯‰ä¸‹ä¸€æ­¥åº”è¯¥ç§»åŠ¨åˆ°å“ªé‡Œï¼Œé”®ç›˜æ§åˆ¶å™¨éœ€è¦çŸ¥é“å“ªä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹ç­‰ã€‚è¿™äº›<strong>æä¾› I/O è®¾å¤‡åˆ°è®¾å¤‡æ§åˆ¶å™¨è½¬æ¢çš„è¿‡ç¨‹çš„ä»£ç ç§°ä¸º <code>è®¾å¤‡é©±åŠ¨ç¨‹åº(Device driver)</code>ã€‚</strong></p><p>ä¸ºäº†èƒ½å¤Ÿè®¿é—®è®¾å¤‡çš„ç¡¬ä»¶ï¼Œ<strong>è®¾å¤‡é©±åŠ¨ç¨‹åºé€šå¸¸æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€éƒ¨åˆ†ã€‚</strong><br />ä½†æ˜¯ä¹Ÿå¯ä»¥æ„é€ ç”¨æˆ·ç©ºé—´çš„è®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å®Œæˆè¯»å†™æ“ä½œã€‚è¿™æ ·å°±é¿å…äº†ä¸€ä¸ªé—®é¢˜ï¼Œæœ‰é—®é¢˜çš„é©±åŠ¨ç¨‹åºä¼šå¹²æ‰°å†…æ ¸ï¼Œä»è€Œé€ æˆå´©æºƒã€‚æ‰€ä»¥ï¼Œ<strong>åœ¨ç”¨æˆ·ç©ºé—´å®ç°è®¾å¤‡é©±åŠ¨ç¨‹åºå¯ä»¥ä¿è¯ç³»ç»Ÿç¨³å®šæ€§ã€‚</strong></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009134753.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨ <code>UNIX</code> ç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ç¨‹åºï¼ŒåŒ…å«éœ€è¦ç¼–è¯‘åˆ°å…¶å†…éƒ¨çš„æ‰€æœ‰é©±åŠ¨ç¨‹åºï¼Œå¦‚æœä½ è¦å¯¹ <code>UNIX</code> æ·»åŠ ä¸€ä¸ªæ–°è®¾å¤‡ï¼Œéœ€è¦<strong>é‡æ–°ç¼–è¯‘å†…æ ¸</strong>ï¼Œå°†æ–°çš„é©±åŠ¨ç¨‹åºè£…åˆ°äºŒè¿›åˆ¶ç¨‹åºä¸­ã€‚</p><p>ç„¶è€Œéšç€å¤§å¤šæ•°ä¸ªäººè®¡ç®—æœºçš„å‡ºç°ï¼Œç”±äº <code>I/O</code> è®¾å¤‡çš„å¹¿æ³›åº”ç”¨ï¼Œä¸Šé¢è¿™ç§é™æ€ç¼–è¯‘çš„æ–¹å¼ä¸å†æœ‰æ•ˆï¼Œå› æ­¤ï¼Œä» <code>MS-DOS</code> å¼€å§‹ï¼Œæ“ä½œç³»ç»Ÿè½¬å‘é©±åŠ¨ç¨‹åºåœ¨æ‰§è¡ŒæœŸé—´<strong>åŠ¨æ€è£…è½½</strong>åˆ°ç³»ç»Ÿä¸­ã€‚</p><p>è®¾å¤‡é©±åŠ¨ç¨‹åºæ¥å—åˆ°è¯»å†™è¯·æ±‚åï¼Œä¼šæ£€æŸ¥å½“å‰è®¾å¤‡æ˜¯å¦åœ¨ä½¿ç”¨ï¼Œå¦‚æœè®¾å¤‡åœ¨ä½¿ç”¨ï¼Œè¯·æ±‚è¢«æ’å…¥é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…åç»­çš„å¤„ç†ã€‚å¦‚æœæ­¤æ—¶è®¾å¤‡æ˜¯ç©ºé—²çš„ï¼Œé©±åŠ¨ç¨‹åºä¼šæ£€æŸ¥ç¡¬ä»¶ä»¥äº†è§£è¯·æ±‚æ˜¯å¦èƒ½å¤Ÿè¢«å¤„ç†ã€‚åœ¨ä¼ è¾“å¼€å§‹å‰ï¼Œä¼šå¯åŠ¨è®¾å¤‡ã€‚ç­‰å¾…è®¾å¤‡å°±ç»ªå®Œæˆï¼Œå†è¿›è¡Œå®é™…çš„æ§åˆ¶ã€‚<strong>æ§åˆ¶è®¾å¤‡å°±æ˜¯å¯¹è®¾å¤‡å‘å‡ºæŒ‡ä»¤ã€‚</strong></p><p>å‘å‡ºå‘½ä»¤åï¼Œè®¾å¤‡æ§åˆ¶å™¨ä¾¿å¼€å§‹å°†å®ƒä»¬å†™å…¥æ§åˆ¶å™¨çš„<code>è®¾å¤‡å¯„å­˜å™¨</code>ã€‚åœ¨å°†æ¯ä¸ªå‘½ä»¤å†™å…¥æ§åˆ¶å™¨åï¼Œä¼šæ£€æŸ¥æ§åˆ¶å™¨æ˜¯å¦æ¥å—äº†è¿™æ¡å‘½ä»¤å¹¶å‡†å¤‡æ¥å—ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚ä¸€èˆ¬æ§åˆ¶è®¾å¤‡ä¼šå‘å‡ºä¸€ç³»åˆ—çš„æŒ‡ä»¤ï¼Œè¿™ç§°ä¸º <code>æŒ‡ä»¤åºåˆ—</code>ï¼Œè®¾å¤‡æ§åˆ¶å™¨ä¼šä¾æ¬¡æ£€æŸ¥æ¯ä¸ªå‘½ä»¤æ˜¯å¦è¢«æ¥å—ï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤æ˜¯å¦èƒ½å¤Ÿè¢«æ¥æ”¶ï¼Œç›´åˆ°æ‰€æœ‰çš„åºåˆ—å‘å‡ºä¸ºæ­¢ã€‚</p><p>å‘å‡ºæŒ‡ä»¤åï¼Œä¸€èˆ¬ä¼šæœ‰ä¸¤ç§å¯èƒ½å‡ºç°çš„æƒ…å†µã€‚</p><ul><li>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºä¼šè¿›è¡Œç­‰å¾…ç›´åˆ°æ§åˆ¶å™¨å®Œæˆå®ƒçš„äº‹æƒ…ã€‚è®¾å¤‡æ§åˆ¶å™¨ä¼šé˜»å¡ï¼Œç›´åˆ°ä¸­æ–­æ¥è§£é™¤é˜»å¡çŠ¶æ€ã€‚</li><li>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æ“ä½œæ˜¯å¯ä»¥æ— å»¶è¿Ÿçš„å®Œæˆï¼Œæ‰€ä»¥é©±åŠ¨ç¨‹åºä¸éœ€è¦é˜»å¡ã€‚</li></ul><p>è®¾å¤‡é©±åŠ¨ç¨‹åºå¿…é¡»æ˜¯<strong>å¯é‡å…¥</strong>çš„ï¼Œå› ä¸ºè®¾å¤‡é©±åŠ¨ç¨‹åºä¼šé˜»å¡å’Œå”¤é†’ç„¶åå†æ¬¡é˜»å¡ã€‚<strong>é©±åŠ¨ç¨‹åºä¸å…è®¸è¿›è¡Œç³»ç»Ÿè°ƒç”¨</strong>ï¼Œä½†æ˜¯å®ƒä»¬é€šå¸¸éœ€è¦ä¸å†…æ ¸çš„å…¶ä½™éƒ¨åˆ†è¿›è¡Œäº¤äº’ã€‚</p><h2 id="ä¸è®¾å¤‡æ— å…³çš„-io-è½¯ä»¶"><a class="markdownIt-Anchor" href="#ä¸è®¾å¤‡æ— å…³çš„-io-è½¯ä»¶"></a> ä¸è®¾å¤‡æ— å…³çš„ I/O è½¯ä»¶</h2><p><code>è®¾å¤‡æ— å…³æ€§</code> ä¹Ÿå°±æ˜¯ä¸éœ€è¦ç‰¹å®šçš„è®¾å¤‡ã€‚è®¾å¤‡é©±åŠ¨ç¨‹åºä¸è®¾å¤‡æ— å…³çš„è½¯ä»¶ä¹‹é—´çš„ç•Œé™å–å†³äºå…·ä½“çš„ç³»ç»Ÿã€‚</p><p>ä¸è®¾å¤‡æ— å…³çš„ I/O è½¯ä»¶çš„åŸºæœ¬åŠŸèƒ½æ˜¯<strong>æ‰§è¡Œå¯¹æ‰€æœ‰è®¾å¤‡å…¬å…±çš„ <code>I/O</code> åŠŸèƒ½ï¼Œå¹¶ä¸”å‘ç”¨æˆ·å±‚è½¯ä»¶æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚</strong></p><h3 id="ç¼“å†²"><a class="markdownIt-Anchor" href="#ç¼“å†²"></a> ç¼“å†²</h3><p>æ— è®ºæ˜¯å¯¹äºå—è®¾å¤‡è¿˜æ˜¯å­—ç¬¦è®¾å¤‡æ¥è¯´ï¼Œç¼“å†²éƒ½æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è€ƒé‡æ ‡å‡†ã€‚ä¸‹é¢æ˜¯ä» <code>ADSL(è°ƒåˆ¶è§£è°ƒå™¨)</code> è¯»å–æ•°æ®çš„è¿‡ç¨‹ã€‚</p><p>ç”¨æˆ·ç¨‹åºè°ƒç”¨ <code>read</code> ç³»ç»Ÿè°ƒç”¨<strong>é˜»å¡ç”¨æˆ·è¿›ç¨‹</strong>ï¼Œç­‰å¾…å­—ç¬¦çš„åˆ°æ¥ï¼Œè¿™æ˜¯å¯¹åˆ°æ¥çš„å­—ç¬¦è¿›è¡Œå¤„ç†çš„ä¸€ç§æ–¹å¼ã€‚æ¯ä¸€ä¸ªåˆ°æ¥çš„å­—ç¬¦éƒ½ä¼šé€ æˆä¸­æ–­ã€‚ä¸­æ–­æœåŠ¡ç¨‹åºä¼šç»™ç”¨æˆ·è¿›ç¨‹æä¾›å­—ç¬¦ï¼Œå¹¶è§£é™¤é˜»å¡ã€‚å°†å­—ç¬¦æä¾›ç»™ç”¨æˆ·ç¨‹åºåï¼Œè¿›ç¨‹ä¼šå»è¯»å–å…¶ä»–å­—ç¬¦å¹¶ç»§ç»­é˜»å¡ï¼Œè¿™ç§æ¨¡å‹å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009142221.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¸€ç§æ–¹æ¡ˆæ˜¯æ²¡æœ‰ç¼“å†²åŒºçš„å­˜åœ¨ï¼Œå› ä¸ºç”¨æˆ·è¿›ç¨‹å¦‚æœè¯»ä¸åˆ°æ•°æ®ä¼šé˜»å¡ï¼Œç›´åˆ°è¯»åˆ°æ•°æ®ä¸ºæ­¢ï¼Œè¿™ç§æƒ…å†µæ•ˆç‡æ¯”è¾ƒä½ï¼Œè€Œä¸”é˜»å¡å¼çš„æ–¹å¼ï¼Œä¼šç›´æ¥é˜»æ­¢ç”¨æˆ·è¿›ç¨‹åšå…¶ä»–äº‹æƒ…ï¼Œè¿™å¯¹ç”¨æˆ·æ¥è¯´æ˜¯ä¸èƒ½æ¥å—çš„ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯æ¯æ¬¡ç”¨æˆ·è¿›ç¨‹éƒ½ä¼šé‡å¯ï¼Œå¯¹äºæ¯ä¸ªå­—ç¬¦çš„åˆ°æ¥éƒ½ä¼šé‡å¯ç”¨æˆ·è¿›ç¨‹ï¼Œè¿™ç§æ•ˆç‡ä¼šä¸¥é‡é™ä½ï¼Œæ‰€ä»¥æ— ç¼“å†²åŒºçš„è½¯ä»¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¾è®¡ã€‚</p><p>ä½œä¸ºä¸€ä¸ªæ”¹è‰¯ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•åœ¨<strong>ç”¨æˆ·ç©ºé—´ä¸­ä½¿ç”¨ä¸€ä¸ªèƒ½è¯»å– n ä¸ªå­—èŠ‚ç¼“å†²åŒº</strong>æ¥è¯»å– n ä¸ªå­—ç¬¦ã€‚è¿™æ ·çš„è¯ï¼Œä¸­æ–­æœåŠ¡ç¨‹åºä¼šæŠŠå­—ç¬¦æ”¾åˆ°ç¼“å†²åŒºä¸­ç›´åˆ°ç¼“å†²åŒºå˜æ»¡ä¸ºæ­¢ï¼Œç„¶åå†å»å”¤é†’ç”¨æˆ·è¿›ç¨‹ã€‚è¿™ç§æ–¹æ¡ˆè¦æ¯”ä¸Šé¢çš„æ–¹æ¡ˆæ”¹è‰¯å¾ˆå¤šã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009142840.png" srcset="/img/loading.gif" alt="" /></p><p>ä½†æ˜¯è¿™ç§æ–¹æ¡ˆä¹Ÿå­˜åœ¨é—®é¢˜ï¼Œå½“å­—ç¬¦åˆ°æ¥æ—¶ï¼Œå¦‚æœç¼“å†²åŒºè¢«åˆ†é¡µï¼Œä¼šè¢«è°ƒå‡ºå†…å­˜ã€‚è§£å†³æ–¹æ¡ˆæ˜¯æŠŠç¼“å†²åŒºé”å®šåœ¨å†…å­˜ä¸­ï¼Œä½†æ˜¯è¿™ç§æ–¹æ¡ˆä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œå¦‚æœå°‘é‡çš„ç¼“å†²åŒºè¢«é”å®šè¿˜å¥½ï¼Œå¦‚æœå¤§é‡çš„ç¼“å†²åŒºè¢«é”å®šåœ¨å†…å­˜ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥æ¢è¿›æ¢å‡ºçš„é¡µé¢å°±ä¼šæ”¶ç¼©ï¼Œé€ æˆç³»ç»Ÿæ€§èƒ½çš„ä¸‹é™ã€‚</p><p>ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åœ¨<strong>å†…æ ¸ä¸­å†…éƒ¨åˆ›å»ºä¸€å—ç¼“å†²åŒº</strong>ï¼Œè®©ä¸­æ–­æœåŠ¡ç¨‹åºå°†å­—ç¬¦æ”¾åœ¨å†…æ ¸å†…éƒ¨çš„ç¼“å†²åŒºä¸­ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009143125.png" srcset="/img/loading.gif" alt="" /></p><p>å½“å†…æ ¸ä¸­çš„ç¼“å†²åŒºè¦æ»¡çš„æ—¶å€™ï¼Œä¼šå°†ç”¨æˆ·ç©ºé—´ä¸­çš„é¡µé¢è°ƒå…¥å†…å­˜ï¼Œç„¶åå°†å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºå¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´çš„ç¼“å†²åŒºä¸­ï¼Œè¿™ç§æ–¹æ¡ˆä¹Ÿé¢ä¸´ä¸€ä¸ªé—®é¢˜å°±æ˜¯å‡å¦‚ç”¨æˆ·ç©ºé—´çš„é¡µé¢è¢«æ¢å…¥å†…å­˜ï¼Œæ­¤æ—¶å†…æ ¸ç©ºé—´çš„ç¼“å†²åŒºå·²æ»¡ï¼Œè¿™æ—¶å€™ä»æœ‰æ–°çš„å­—ç¬¦åˆ°æ¥ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ€ä¹ˆåŠï¼Ÿå› ä¸ºç¼“å†²åŒºæ»¡äº†ï¼Œæ²¡æœ‰ç©ºé—´æ¥å­˜å‚¨æ–°çš„å­—ç¬¦äº†ã€‚</p><p>ä¸€ç§éå¸¸ç®€å•çš„æ–¹å¼å°±æ˜¯<strong>å†è®¾ç½®ä¸€ä¸ªç¼“å†²åŒº</strong>å°±è¡Œäº†ï¼Œåœ¨ç¬¬ä¸€ä¸ªç¼“å†²åŒºå¡«æ»¡åï¼Œåœ¨ç¼“å†²åŒºæ¸…ç©ºå‰ï¼Œä½¿ç”¨ç¬¬äºŒä¸ªç¼“å†²åŒºï¼Œè¿™ç§è§£å†³æ–¹å¼å¦‚ä¸‹ï¼š</p><p>å½“ç¬¬äºŒä¸ªç¼“å†²åŒºä¹Ÿæ»¡äº†çš„æ—¶å€™ï¼Œå®ƒä¹Ÿä¼šæŠŠæ•°æ®å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ä¸­ï¼Œç„¶åç¬¬ä¸€ä¸ªç¼“å†²åŒºç”¨äºæ¥å—æ–°çš„å­—ç¬¦ã€‚è¿™ç§å…·æœ‰ä¸¤ä¸ªç¼“å†²åŒºçš„è®¾è®¡è¢«ç§°ä¸º <code>åŒç¼“å†²(double buffering)</code>ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009143518.png" srcset="/img/loading.gif" alt="" /></p><p>è¿˜æœ‰ä¸€ç§ç¼“å†²å½¢å¼æ˜¯ <code>å¾ªç¯ç¼“å†²(circular buffer)</code>ã€‚å®ƒç”±ä¸€ä¸ªå†…å­˜åŒºåŸŸå’Œä¸¤ä¸ªæŒ‡é’ˆç»„æˆã€‚ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²å­—ï¼Œæ–°çš„æ•°æ®å¯ä»¥æ”¾åœ¨æ­¤å¤„ã€‚å¦å¤–ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ç¼“å†²åŒºä¸­å°šæœªåˆ é™¤æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œç¡¬ä»¶ä¼šåœ¨æ·»åŠ æ–°çš„æ•°æ®æ—¶ï¼Œç§»åŠ¨ç¬¬ä¸€ä¸ªæŒ‡é’ˆï¼›è€Œæ“ä½œç³»ç»Ÿä¼šåœ¨åˆ é™¤å’Œå¤„ç†æ— ç”¨æ•°æ®æ—¶ä¼šç§»åŠ¨ç¬¬äºŒä¸ªæŒ‡é’ˆã€‚ä¸¤ä¸ªæŒ‡é’ˆåˆ°è¾¾é¡¶éƒ¨æ—¶å°±å›åˆ°åº•éƒ¨é‡æ–°å¼€å§‹ã€‚</p><p>ç¼“å†²æŠ€æœ¯åº”ç”¨å¹¿æ³›ï¼Œä½†å®ƒä¹Ÿæœ‰ç¼ºç‚¹ã€‚å¦‚æœæ•°æ®è¢«ç¼“å†²æ¬¡æ•°å¤ªå¤šï¼Œä¼šå½±å“æ€§èƒ½ã€‚è€ƒè™‘ä¾‹å¦‚å¦‚ä¸‹è¿™ç§æƒ…å†µï¼Œ</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20201009143601.png" srcset="/img/loading.gif" alt="" /></p><p>æ•°æ®ç»è¿‡ç”¨æˆ·è¿›ç¨‹ -&gt; å†…æ ¸ç©ºé—´ -&gt; ç½‘ç»œæ§åˆ¶å™¨ï¼Œè¿™é‡Œçš„ç½‘ç»œæ§åˆ¶å™¨åº”è¯¥å°±ç›¸å½“äºæ˜¯ ç¼“å†²åŒºï¼Œç„¶åå‘é€åˆ°ç½‘ç»œä¸Šï¼Œå†åˆ°æ¥æ”¶æ–¹çš„ç½‘ç»œæ§åˆ¶å™¨ -&gt; æ¥æ”¶æ–¹çš„å†…æ ¸ç¼“å†² -&gt; æ¥æ”¶æ–¹çš„ç”¨æˆ·ç¼“å†²ï¼Œä¸€æ¡æ•°æ®åŒ…è¢«ç¼“å­˜äº†å¤ªå¤šæ¬¡ï¼Œå¾ˆå®¹æ˜“é™ä½æ€§èƒ½ã€‚</p><h3 id="é”™è¯¯å¤„ç†"><a class="markdownIt-Anchor" href="#é”™è¯¯å¤„ç†"></a> é”™è¯¯å¤„ç†</h3><p>I/O é”™è¯¯çš„ä¸€ç±»æ˜¯ç¨‹åºå‘˜<strong>ç¼–ç¨‹é”™è¯¯</strong>ï¼Œæ¯”å¦‚è¿˜æ²¡æœ‰æ‰“å¼€æ–‡ä»¶å‰å°±è¯»æµï¼Œæˆ–è€…ä¸å…³é—­æµå¯¼è‡´å†…å­˜æº¢å‡ºç­‰ç­‰ã€‚è¿™ç±»é—®é¢˜ç”±ç¨‹åºå‘˜å¤„ç†ï¼›</p><p>å¦å¤–ä¸€ç±»æ˜¯<strong>å®é™…çš„ <code>I/O</code> é”™è¯¯</strong>ï¼Œä¾‹å¦‚å‘ä¸€ä¸ªç£ç›˜åå—å†™å…¥æ•°æ®ï¼Œæ— è®ºæ€ä¹ˆå†™éƒ½å†™å…¥ä¸äº†ã€‚è¿™ç±»é—®é¢˜ç”±é©±åŠ¨ç¨‹åºå¤„ç†ï¼Œé©±åŠ¨ç¨‹åºå¤„ç†ä¸äº†äº¤ç»™ç¡¬ä»¶å¤„ç†ã€‚</p><h3 id="åˆ†é…å’Œé‡Šæ”¾"><a class="markdownIt-Anchor" href="#åˆ†é…å’Œé‡Šæ”¾"></a> åˆ†é…å’Œé‡Šæ”¾</h3><p>ä¸€äº›è®¾å¤‡ä¾‹å¦‚æ‰“å°æœºï¼Œå®ƒåªèƒ½ç”±ä¸€ä¸ªè¿›ç¨‹æ¥ä½¿ç”¨ï¼Œè¿™å°±éœ€è¦æ“ä½œç³»ç»Ÿæ ¹æ®å®é™…æƒ…å†µåˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿå¯¹è®¾å¤‡çš„è¯·æ±‚è¿›è¡Œæ£€æŸ¥ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿæ¥å—å…¶ä»–è¯·æ±‚ï¼Œä¸€ç§æ¯”è¾ƒç®€å•ç›´æ¥çš„æ–¹å¼æ˜¯åœ¨ç‰¹æ®Šæ–‡ä»¶ä¸Šæ‰§è¡Œ <code>open</code> æ“ä½œã€‚å¦‚æœè®¾å¤‡ä¸å¯ç”¨ï¼Œé‚£ä¹ˆç›´æ¥ <code>open</code> ä¼šå¯¼è‡´å¤±è´¥ã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ä¸ç›´æ¥å¯¼è‡´å¤±è´¥ï¼Œè€Œæ˜¯è®©å…¶é˜»å¡ï¼Œç­‰åˆ°å¦å¤–ä¸€ä¸ªè¿›ç¨‹é‡Šæ”¾èµ„æºåï¼Œåœ¨è¿›è¡Œ <code>open</code> æ‰“å¼€æ“ä½œã€‚è¿™ç§æ–¹å¼å°±æŠŠé€‰æ‹©æƒäº¤ç»™äº†ç”¨æˆ·ï¼Œç”±ç”¨æˆ·åˆ¤æ–­æ˜¯å¦åº”è¯¥ç­‰å¾…ã€‚</p><h2 id="ç”¨æˆ·ç©ºé—´çš„-io-è½¯ä»¶"><a class="markdownIt-Anchor" href="#ç”¨æˆ·ç©ºé—´çš„-io-è½¯ä»¶"></a> ç”¨æˆ·ç©ºé—´çš„ I/O è½¯ä»¶</h2><p>è™½ç„¶å¤§éƒ¨åˆ† I/O è½¯ä»¶éƒ½åœ¨å†…æ ¸ç»“æ„ä¸­ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›åœ¨ç”¨æˆ·ç©ºé—´å®ç°çš„ I/O è½¯ä»¶ã€‚ä¸€äº› I/O è½¯ä»¶å’Œåº“è¿‡ç¨‹åœ¨ç”¨æˆ·ç©ºé—´å­˜åœ¨ï¼Œç„¶åä»¥æä¾›ç³»ç»Ÿè°ƒç”¨çš„æ–¹å¼å®ç°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1208. å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰</title>
    <link href="/2020/09/29/LeetCode-1208-get-equal-substrings-within-budget/"/>
    <url>/2020/09/29/LeetCode-1208-get-equal-substrings-within-budget/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/get-equal-substrings-within-budget/" target="_blank" rel="noopener">1208. å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">equalSubstring</span><span class="hljs-params">(String s, String t, <span class="hljs-keyword">int</span> maxCost)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] sChar = s.toCharArray();    <span class="hljs-keyword">char</span>[] tChar = t.toCharArray();    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> windowCost = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-comment">// è®¡ç®—çª—å£å†…å­—ç¬¦ä»£ä»·</span>        windowCost += Math.abs(sChar[right] - tChar[right]);        right++;        <span class="hljs-comment">// æ”¶ç¼©å·¦è¾¹ç•Œ</span>        <span class="hljs-keyword">if</span> (windowCost &gt; maxCost) &#123;            windowCost -= Math.abs(sChar[left] - tChar[left]);            left++;        &#125;        <span class="hljs-comment">// è®¡ç®—æœ€å¤§é•¿åº¦</span>        maxLen = Math.max(maxLen, right - left);    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1052. çˆ±ç”Ÿæ°”çš„ä¹¦åº—è€æ¿</title>
    <link href="/2020/09/29/LeetCode-1052-grumpy-bookstore-owner/"/>
    <url>/2020/09/29/LeetCode-1052-grumpy-bookstore-owner/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/grumpy-bookstore-owner/" target="_blank" rel="noopener">1052. çˆ±ç”Ÿæ°”çš„ä¹¦åº—è€æ¿</a></p><p>è®¡ç®—å¯è¡¥å¿çš„æœ€å¤§å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSatisfied</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] customers, <span class="hljs-keyword">int</span>[] grumpy, <span class="hljs-keyword">int</span> X)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = customers.length;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> windowComplement = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> maxComp = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">if</span> (grumpy[right] == <span class="hljs-number">1</span>) &#123;            <span class="hljs-comment">// å¯è¡¥å……çš„å€¼</span>            windowComplement += customers[right];        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// åŸå§‹å€¼</span>            sum += customers[right];        &#125;        right++;        <span class="hljs-comment">// çª—å£å¤§å° = X</span>        <span class="hljs-keyword">if</span> (right - left &gt;= X) &#123;            maxComp = Math.max(maxComp, windowComplement);            <span class="hljs-keyword">if</span> (grumpy[left] == <span class="hljs-number">1</span>) &#123;                windowComplement -= customers[left];            &#125;            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> sum + maxComp;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSatisfied</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] customers, <span class="hljs-keyword">int</span>[] grumpy, <span class="hljs-keyword">int</span> X)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = customers.length;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> windowComplement = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> maxComp = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (grumpy[i] == <span class="hljs-number">0</span>) &#123;            sum += customers[i];            customers[i] = <span class="hljs-number">0</span>;        &#125;    &#125;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        windowComplement += customers[right];        right++;        <span class="hljs-comment">// çª—å£å¤§å° = X</span>        <span class="hljs-keyword">if</span> (right - left &gt;= X) &#123;            maxComp = Math.max(maxComp, windowComplement);            windowComplement -= customers[left];            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> sum + maxComp;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1423. å¯è·å¾—çš„æœ€å¤§ç‚¹æ•°</title>
    <link href="/2020/09/29/LeetCode-1423-maximum-points-you-can-obtain-from-cards/"/>
    <url>/2020/09/29/LeetCode-1423-maximum-points-you-can-obtain-from-cards/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-points-you-can-obtain-from-cards/" target="_blank" rel="noopener">1423. å¯è·å¾—çš„æœ€å¤§ç‚¹æ•°</a></p><p>å·¦è¾¹å– <code>i</code> ä¸ªï¼Œåˆ™å³è¾¹å– <code>k - i</code> ä¸ªï¼Œä¾æ¬¡æ¯”è¾ƒæœ€å¤§å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxScore</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] cardPoints, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = cardPoints.length;    <span class="hljs-keyword">int</span> leftSum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> rightSum = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å³è¾¹ k ä¸ªä¹‹å’Œ</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= len - k; i--) &#123;        rightSum += cardPoints[i];    &#125;    <span class="hljs-comment">// å·¦è¾¹å– 0 ä¸ª</span>    <span class="hljs-keyword">int</span> max = rightSum;    <span class="hljs-comment">// ä»å·¦è¾¹å¼€å§‹å– 1 ~ k ä¸ª</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i++) &#123;        leftSum += cardPoints[i];        <span class="hljs-comment">// å‡å»å³è¾¹å¤šçš„éƒ¨åˆ†: 1 -&gt; k - 1, 2 -&gt; k - 2......</span>        rightSum -= cardPoints[len - k + i];        max = Math.max(max, leftSum + rightSum);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼</title>
    <link href="/2020/09/29/LeetCode-offer-59-II-dui-lie-de-zui-da-zhi-lcof/"/>
    <url>/2020/09/29/LeetCode-offer-59-II-dui-lie-de-zui-da-zhi-lcof/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/dui-lie-de-zui-da-zhi-lcof/" target="_blank" rel="noopener">å‰‘æŒ‡ Offer 59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaxQueue</span> </span>&#123;    <span class="hljs-keyword">private</span> LinkedList&lt;Integer&gt; queue;    <span class="hljs-keyword">private</span> ArrayDeque&lt;Integer&gt; deque;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MaxQueue</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">// ä¿å­˜å…¥é˜Ÿå…ƒç´ </span>        queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        <span class="hljs-comment">// æœ€å¤§å€¼é˜Ÿåˆ—</span>        deque = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">max_value</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> deque.isEmpty() ? -<span class="hljs-number">1</span> : deque.peekFirst();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push_back</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>&#123;        queue.addLast(value);        <span class="hljs-comment">// æ›´æ–°æœ€å¤§å€¼</span>        <span class="hljs-keyword">while</span> (!deque.isEmpty() &amp;&amp; deque.peekLast() &lt; value) &#123;            deque.pollLast();        &#125;        deque.addLast(value);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pop_front</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">int</span> front = queue.isEmpty() ? -<span class="hljs-number">1</span> : queue.pollFirst();        <span class="hljs-comment">// å‡ºé˜Ÿå…ƒç´ ä¸ºæœ€å¤§å€¼ï¼Œåˆ™ä»æœ€å¤§å€¼é˜Ÿåˆ—ä¸­å‡ºé˜Ÿ</span>        <span class="hljs-keyword">if</span> (!deque.isEmpty() &amp;&amp; deque.peekFirst().equals(front)) &#123;            deque.pollFirst();        &#125;        <span class="hljs-keyword">return</span> front;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
      <tag>å‰‘æŒ‡ Offer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1004. æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III</title>
    <link href="/2020/09/28/LeetCode-1004-max-consecutive-ones-iii/"/>
    <url>/2020/09/28/LeetCode-1004-max-consecutive-ones-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/max-consecutive-ones-iii/" target="_blank" rel="noopener">1004. æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">longestOnes</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A, <span class="hljs-keyword">int</span> K)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> windowCount = <span class="hljs-number">0</span>, max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">if</span> (A[right] == <span class="hljs-number">1</span>) &#123;            windowCount++;        &#125;        right++;        <span class="hljs-comment">// å¯æ›¿æ¢çš„ 0 ä¸ªæ•° &gt; K, æ”¶ç¼©å·¦è¾¹ç•Œ</span>        <span class="hljs-keyword">while</span> (right - left - windowCount &gt; K) &#123;            <span class="hljs-keyword">if</span> (A[left] == <span class="hljs-number">1</span>) &#123;                windowCount--;            &#125;            left++;        &#125;        max = Math.max(max, right - left);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 485. æœ€å¤§è¿ç»­1çš„ä¸ªæ•°</title>
    <link href="/2020/09/28/LeetCode-485-max-consecutive-ones/"/>
    <url>/2020/09/28/LeetCode-485-max-consecutive-ones/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/max-consecutive-ones/" target="_blank" rel="noopener">485. æœ€å¤§è¿ç»­1çš„ä¸ªæ•°</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMaxConsecutiveOnes</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-keyword">if</span> (num == <span class="hljs-number">1</span>) &#123;            count++;        &#125; <span class="hljs-keyword">else</span> &#123;            max = Math.max(max, count);            count = <span class="hljs-number">0</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> Math.max(max, count);&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMaxConsecutiveOnes</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">if</span> (nums[right] == <span class="hljs-number">0</span>) &#123;            max = Math.max(right - left, max);            left = right + <span class="hljs-number">1</span>;        &#125;        right++;    &#125;    <span class="hljs-keyword">return</span> Math.max(right - left, max);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1456. å®šé•¿å­ä¸²ä¸­å…ƒéŸ³çš„æœ€å¤§æ•°ç›®</title>
    <link href="/2020/09/28/LeetCode-1456-maximum-number-of-vowels-in-a-substring-of-given-length/"/>
    <url>/2020/09/28/LeetCode-1456-maximum-number-of-vowels-in-a-substring-of-given-length/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-number-of-vowels-in-a-substring-of-given-length/" target="_blank" rel="noopener">1456. å®šé•¿å­ä¸²ä¸­å…ƒéŸ³çš„æœ€å¤§æ•°ç›®</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxVowels</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span> validLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">char</span>[] vowels = &#123;<span class="hljs-string">'a'</span>, <span class="hljs-string">'e'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'o'</span>, <span class="hljs-string">'u'</span>&#125;;    <span class="hljs-keyword">int</span>[] needs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : vowels) &#123;        needs[c - <span class="hljs-string">'a'</span>]++;    &#125;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">int</span> cur = chars[right] - <span class="hljs-string">'a'</span>;        <span class="hljs-comment">// å½“å‰å­—ç¬¦ä¸ºå…ƒéŸ³</span>        <span class="hljs-keyword">if</span> (needs[cur] &gt; <span class="hljs-number">0</span>) &#123;            validLen++;        &#125;        right++;        <span class="hljs-comment">// é•¿åº¦æ»¡è¶³è¦æ±‚ï¼Œå¯»æ‰¾æœ€ä¼˜è§£ï¼Œæ”¶ç¼©å·¦è¾¹ç•Œ</span>        <span class="hljs-keyword">if</span> (right - left == k) &#123;            max = Math.max(max, validLen);            <span class="hljs-keyword">int</span> leftPos = chars[left] - <span class="hljs-string">'a'</span>;            <span class="hljs-comment">// å½“å‰å­—ç¬¦ä¸ºå…ƒéŸ³</span>            <span class="hljs-keyword">if</span> (needs[leftPos] &gt; <span class="hljs-number">0</span>) &#123;                validLen--;            &#125;            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</title>
    <link href="/2020/09/28/LeetCode-offer-59-I-hua-dong-chuang-kou-de-zui-da-zhi-lcof/"/>
    <url>/2020/09/28/LeetCode-offer-59-I-hua-dong-chuang-kou-de-zui-da-zhi-lcof/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/hua-dong-chuang-kou-de-zui-da-zhi-lcof/" target="_blank" rel="noopener">å‰‘æŒ‡ Offer 59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] maxSlidingWindow(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;&#125;;    &#125;    ArrayDeque&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len - k + <span class="hljs-number">1</span>];    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">while</span> (!queue.isEmpty() &amp;&amp; nums[queue.peekLast()] &lt; nums[i]) &#123;            queue.removeLast();        &#125;        queue.addLast(i);        <span class="hljs-keyword">if</span> (queue.peekFirst() &lt;= i - k) &#123;            queue.removeFirst();        &#125;        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) &#123;            res[j++] = nums[queue.peekFirst()];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
      <tag>å‰‘æŒ‡ Offer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ æ–‡ä»¶ç³»ç»Ÿ</title>
    <link href="/2020/09/28/os-file-system/"/>
    <url>/2020/09/28/os-file-system/</url>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶"><a class="markdownIt-Anchor" href="#æ–‡ä»¶"></a> æ–‡ä»¶</h1><h2 id="æ–‡ä»¶å‘½å"><a class="markdownIt-Anchor" href="#æ–‡ä»¶å‘½å"></a> æ–‡ä»¶å‘½å</h2><p>æ–‡ä»¶æ˜¯ä¸€ç§æŠ½è±¡æœºåˆ¶ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹å¼ç”¨æ¥å­˜å‚¨ä¿¡æ¯ä»¥åŠåœ¨åé¢è¿›è¡Œè¯»å–ã€‚å¯èƒ½ä»»ä½•ä¸€ç§æœºåˆ¶æœ€é‡è¦çš„ç‰¹æ€§å°±æ˜¯ç®¡ç†å¯¹è±¡çš„å‘½åæ–¹å¼ã€‚åœ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åï¼Œå®ƒä¼šç»™æ–‡ä»¶ä¸€ä¸ªå‘½åã€‚å½“è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œæ–‡ä»¶ä¼šç»§ç»­å­˜åœ¨ï¼Œå¹¶ä¸”å…¶ä»–è¿›ç¨‹å¯ä»¥ä½¿ç”¨åç§°è®¿é—®è¯¥æ–‡ä»¶ã€‚</p><p>æ–‡ä»¶å‘½åè§„åˆ™å¯¹äºä¸åŒçš„æ“ä½œç³»ç»Ÿæ¥è¯´æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æ‰€æœ‰ç°ä»£æ“ä½œç³»ç»Ÿéƒ½å…è®¸ä½¿ç”¨ 1 - 8 ä¸ªå­—æ¯çš„å­—ç¬¦ä¸²ä½œä¸ºåˆæ³•æ–‡ä»¶åã€‚</p><p>æŸäº›æ–‡ä»¶åŒºåˆ†å¤§å°å†™å­—æ¯ï¼Œè€Œå¤§å¤šæ•°åˆ™ä¸åŒºåˆ†ã€‚<code>UNIX</code> å±äºç¬¬ä¸€ç±»ï¼›å†å²æ‚ ä¹…çš„ <code>MS-DOS</code> å±äºç¬¬äºŒç±»ï¼›å› æ­¤ï¼Œ<code>UNIX</code> ç³»ç»Ÿä¼šæœ‰ä¸‰ç§ä¸åŒçš„å‘½åæ–‡ä»¶ï¼š<code>maria</code>ã€<code>Maria</code>ã€<code>MARIA</code> ã€‚åœ¨ <code>MS-DOS</code>ï¼Œæ‰€æœ‰è¿™äº›å‘½åéƒ½å±äºç›¸åŒçš„æ–‡ä»¶ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928152723.png" srcset="/img/loading.gif" alt="" /></p><ul><li><p>åœ¨ <code>UNIX</code> ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æ‰©å±•ååªæ˜¯ä¸€ç§çº¦å®šï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸å¼ºåˆ¶é‡‡ç”¨ã€‚</p></li><li><p>ä¸ <code>UNIX</code> ç›¸åï¼Œ<code>Windows</code> å°±ä¼šå…³æ³¨æ‰©å±•åå¹¶å¯¹æ‰©å±•åèµ‹äºˆäº†æ–°çš„å«ä¹‰ã€‚ç”¨æˆ·(æˆ–è¿›ç¨‹) å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­æ³¨å†Œæ‰©å±•åï¼Œå¹¶ä¸”è§„å®šå“ªä¸ªç¨‹åºèƒ½å¤Ÿæ‹¥æœ‰æ‰©å±•åã€‚å½“ç”¨æˆ·åŒå‡»æŸä¸ªæ–‡ä»¶åæ—¶ï¼Œæ‹¥æœ‰è¯¥æ–‡ä»¶åçš„ç¨‹åºå°±å¯åŠ¨å¹¶è¿è¡Œæ–‡ä»¶ã€‚</p></li></ul><h2 id="æ–‡ä»¶ç»“æ„"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç»“æ„"></a> æ–‡ä»¶ç»“æ„</h2><p>æ–‡ä»¶çš„æ„é€ æœ‰å¤šç§æ–¹å¼ã€‚ä¸‹å›¾åˆ—å‡ºäº†å¸¸ç”¨çš„ä¸‰ç§æ„é€ æ–¹å¼ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928153020.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾ä¸­çš„ a æ˜¯ä¸€ç§<strong>æ— ç»“æ„çš„å­—èŠ‚åºåˆ—</strong>ï¼Œæ“ä½œç³»ç»Ÿä¸å…³å¿ƒåºåˆ—çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œæ“ä½œç³»ç»Ÿèƒ½çœ‹åˆ°çš„å°±æ˜¯å­—èŠ‚(bytes)ã€‚å…¶æ–‡ä»¶å†…å®¹çš„ä»»ä½•å«ä¹‰åªåœ¨ç”¨æˆ·ç¨‹åºä¸­è¿›è¡Œè§£é‡Šã€‚UNIX å’Œ Windows éƒ½é‡‡ç”¨è¿™ç§åŠæ³•ã€‚</p><p>æŠŠæ–‡ä»¶çœ‹æˆå­—èŠ‚åºåˆ—æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ã€‚ç”¨æˆ·ç¨‹åºå¯ä»¥å‘æ–‡ä»¶ä¸­å†™ä»»ä½•å†…å®¹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä»»ä½•æ–¹ä¾¿çš„å½¢å¼å‘½åã€‚æ“ä½œç³»ç»Ÿä¸ä¼šä¸ºä¸ºç”¨æˆ·å†™å…¥å†…å®¹æä¾›å¸®åŠ©ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå¹²æ‰°é˜»å¡ä½ ã€‚å¯¹äºæƒ³åšç‰¹æ®Šæ“ä½œçš„ç”¨æˆ·æ¥è¯´ï¼Œåè€…æ˜¯ååˆ†é‡è¦çš„ã€‚æ‰€æœ‰çš„ UNIX ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬ Linux å’Œ OS Xï¼‰å’Œ Windows éƒ½ä½¿ç”¨è¿™ç§æ–‡ä»¶æ¨¡å‹ã€‚</p><p>å›¾ b è¡¨ç¤ºåœ¨æ–‡ä»¶ç»“æ„ä¸Šçš„ç¬¬ä¸€æ­¥æ”¹è¿›ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæ–‡ä»¶æ˜¯å…·æœ‰å›ºå®šé•¿åº¦è®°å½•çš„åºåˆ—ï¼Œæ¯ä¸ªè®°å½•éƒ½æœ‰å…¶å†…éƒ¨ç»“æ„ã€‚ æŠŠæ–‡ä»¶ä½œä¸ºè®°å½•åºåˆ—çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šè¯»æ“ä½œè¿”å›ä¸€ä¸ªè®°å½•ï¼Œè€Œå†™æ“ä½œé‡å†™æˆ–è€…è¿½åŠ ä¸€ä¸ªè®°å½•ã€‚</p><p>ç¬¬ä¸‰ç§æ–‡ä»¶ç»“æ„å¦‚ä¸Šå›¾ c æ‰€ç¤ºã€‚åœ¨è¿™ç§ç»„ç»‡ç»“æ„ä¸­ï¼Œæ–‡ä»¶ç”±ä¸€é¢—è®°å½•æ ‘æ„æˆï¼Œè®°å½•æ ‘çš„é•¿åº¦ä¸ä¸€å®šç›¸åŒï¼Œæ¯ä¸ªè®°å½•æ ‘éƒ½åœ¨è®°å½•ä¸­çš„å›ºå®šä½ç½®åŒ…å«ä¸€ä¸ªkey å­—æ®µã€‚è¿™æ£µæ ‘æŒ‰ key è¿›è¡Œæ’åºï¼Œä»è€Œå¯ä»¥å¯¹ç‰¹å®šçš„ key è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾ã€‚</p><p>åœ¨è®°å½•æ ‘çš„ç»“æ„ä¸­ï¼Œå¯ä»¥å–å‡ºä¸‹ä¸€ä¸ªè®°å½•ï¼Œä½†æ˜¯æœ€å…³é”®çš„è¿˜æ˜¯æ ¹æ® key æœç´¢æŒ‡å®šçš„è®°å½•ã€‚å¦‚ä¸Šå›¾ c æ‰€ç¤ºï¼Œç”¨æˆ·å¯ä»¥è¯»å‡ºæŒ‡å®šçš„ pony è®°å½•ï¼Œè€Œä¸å¿…å…³å¿ƒè®°å½•åœ¨æ–‡ä»¶ä¸­çš„ç¡®åˆ‡ä½ç½®ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨æ–‡ä»¶ä¸­æ·»åŠ æ–°çš„è®°å½•ã€‚ä½†æ˜¯ç”¨æˆ·ä¸èƒ½å†³å®šæ·»åŠ åˆ°ä½•å¤„ä½ç½®ï¼Œæ·»åŠ åˆ°ä½•å¤„ä½ç½®æ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šçš„ã€‚</p><h2 id="æ–‡ä»¶ç±»å‹"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç±»å‹"></a> æ–‡ä»¶ç±»å‹</h2><p>å¾ˆå¤šæ“ä½œç³»ç»Ÿæ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ<code>UNIX</code>ï¼ˆåŒæ ·åŒ…æ‹¬ <code>OS X</code>ï¼‰å’Œ <code>Windows</code> éƒ½å…·æœ‰å¸¸è§„çš„æ–‡ä»¶å’Œç›®å½•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ<code>UNIX</code> è¿˜å…·æœ‰ <code>å­—ç¬¦ç‰¹æ®Šæ–‡ä»¶(character special file)</code> å’Œ <code>å—ç‰¹æ®Šæ–‡ä»¶(block special file)</code>ã€‚</p><ul><li><code>å¸¸è§„æ–‡ä»¶(Regular files)</code> æ˜¯åŒ…å«æœ‰ç”¨æˆ·ä¿¡æ¯çš„æ–‡ä»¶ã€‚ç”¨æˆ·ä¸€èˆ¬ä½¿ç”¨çš„æ–‡ä»¶å¤§éƒ½æ˜¯å¸¸è§„æ–‡ä»¶ï¼Œå¸¸è§„æ–‡ä»¶ä¸€èˆ¬åŒ…æ‹¬ å¯æ‰§è¡Œæ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶ã€å›¾åƒæ–‡ä»¶ï¼Œä»å¸¸è§„æ–‡ä»¶è¯»å–æ•°æ®æˆ–å°†æ•°æ®å†™å…¥æ—¶ï¼Œå†…æ ¸ä¼šæ ¹æ®æ–‡ä»¶ç³»ç»Ÿçš„è§„åˆ™æ‰§è¡Œæ“ä½œï¼Œæ˜¯å†™å…¥å¯èƒ½è¢«å»¶è¿Ÿï¼Œè®°å½•æ—¥å¿—æˆ–è€…æ¥å—å…¶ä»–æ“ä½œã€‚</li><li>å­—ç¬¦ç‰¹æ®Šæ–‡ä»¶å’Œè¾“å…¥/è¾“å‡ºæœ‰å…³ï¼Œç”¨äºä¸²è¡Œ <code>I/O</code> ç±»è®¾å¤‡ï¼Œå¦‚ç»ˆç«¯ã€æ‰“å°æœºã€ç½‘ç»œç­‰ã€‚</li><li>å—ç‰¹æ®Šæ–‡ä»¶ç”¨äºç£ç›˜ç±»è®¾å¤‡ã€‚</li></ul><p>å¸¸è§„æ–‡ä»¶ä¸€èˆ¬åˆ†ä¸º <code>ASCII</code> ç æ–‡ä»¶æˆ–è€…<code>äºŒè¿›åˆ¶æ–‡ä»¶</code>ã€‚<code>ASCII</code> ç æ–‡ä»¶ç”±æ–‡æœ¬ç»„æˆã€‚åœ¨ä¸€äº›ç³»ç»Ÿä¸­ï¼Œæ¯è¡Œéƒ½ä¼šç”¨å›è½¦ç¬¦ç»“æŸï¼ˆASCIIç æ˜¯13ï¼Œæ§åˆ¶å­—ç¬¦ CRï¼Œè½¬ä¹‰å­—ç¬¦\rã€‚ï¼‰ï¼Œå¦å¤–ä¸€äº›åˆ™ä¼šä½¿ç”¨æ¢è¡Œç¬¦ï¼ˆASCIIç æ˜¯10ï¼Œæ§åˆ¶å­—ç¬¦LFï¼Œè½¬ä¹‰å­—ç¬¦\nï¼‰ã€‚ä¸€äº›ç³»ç»Ÿï¼ˆæ¯”å¦‚ Windowsï¼‰ä¸¤è€…éƒ½ä¼šä½¿ç”¨ã€‚</p><p><code>ASCII</code> æ–‡ä»¶çš„ä¼˜ç‚¹åœ¨äº<strong>æ˜¾ç¤º</strong> å’Œ <strong>æ‰“å°</strong>ï¼Œè¿˜å¯ä»¥ç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡Œç¼–è¾‘ã€‚è¿›ä¸€æ­¥æ¥è¯´ï¼Œå¦‚æœè®¸å¤šåº”ç”¨ç¨‹åºä½¿ç”¨ <code>ASCII</code> ç ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å°±èƒ½å¤ŸæŠŠå¤šä¸ªç¨‹åºè¿æ¥èµ·æ¥ï¼Œä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå¯èƒ½æ˜¯å¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ï¼Œå°±åƒç®¡é“ä¸€æ ·ã€‚</p><p>å…¶ä»–ä¸ <code>ASCII</code> ä¸åŒçš„æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ‰“å°å‡ºæ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯æ— æ³•ç†è§£çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æ ¼å¼ï¼Œå®ƒå–è‡ªæ—©æœŸçš„ UNIX ã€‚å°½ç®¡ä»æŠ€æœ¯ä¸Šæ¥çœ‹è¿™ä¸ªæ–‡ä»¶åªæ˜¯å­—èŠ‚åºåˆ—ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿåªæœ‰åœ¨æ–‡ä»¶æ ¼å¼æ­£ç¡®çš„æƒ…å†µä¸‹æ‰ä¼šæ‰§è¡Œã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928155756.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¸ªæ–‡ä»¶æœ‰äº”ä¸ªæ®µï¼šæ–‡ä»¶å¤´ã€æ­£æ–‡ã€æ•°æ®ã€é‡å®šä½å’Œç¬¦å·è¡¨ã€‚æ–‡ä»¶å¤´ä»¥ <code>é­”æ•°(magic number)</code> ä¸ºå¼€å§‹ï¼Œè¡¨æ˜è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ç„¶åæ˜¯æ–‡ä»¶å„ä¸ªéƒ¨åˆ†çš„å¤§å°ï¼Œå¼€å§‹æ‰§è¡Œçš„æ ‡å¿—ä»¥åŠä¸€äº›æ ‡å¿—ä½ã€‚ç¨‹åºæœ¬èº«çš„æ­£æ–‡å’Œæ•°æ®åœ¨æ–‡ä»¶å¤´åé¢ï¼Œä»–ä»¬è¢«åŠ è½½åˆ°å†…å­˜ä¸­æˆ–è€…é‡å®šä½ä¼šæ ¹æ®é‡å®šä½ä½è¿›è¡Œåˆ¤æ–­ã€‚ç¬¦å·è¡¨åˆ™ç”¨äºè°ƒè¯•ã€‚</p><p>äºŒè¿›åˆ¶æ–‡ä»¶çš„å¦å¤–ä¸€ç§å½¢å¼æ˜¯å­˜æ¡£æ–‡ä»¶ï¼Œå®ƒç”±å·²ç¼–è¯‘ä½†æ²¡æœ‰é“¾æ¥çš„åº“è¿‡ç¨‹ï¼ˆæ¨¡å—ï¼‰ç»„åˆè€Œæˆã€‚æ¯ä¸ªæ–‡ä»¶éƒ½ä»¥æ¨¡å—å¤´å¼€å§‹ï¼Œå…¶ä¸­è®°å½•äº†åç§°ã€åˆ›å»ºæ—¥æœŸã€æ‰€æœ‰è€…ã€ä¿æŠ¤ç å’Œæ–‡ä»¶å¤§å°ã€‚å’Œå¯æ‰§è¡Œæ–‡ä»¶ä¸€æ ·ï¼Œæ¨¡å—å¤´ä¹Ÿéƒ½æ˜¯äºŒè¿›åˆ¶æ•°ï¼Œå°†å®ƒä»¬å¤åˆ¶åˆ°æ‰“å°æœºå°†ä¼šäº§ç”Ÿä¹±ç ã€‚</p><p>å½“ç¨‹åºä»æ–‡ä»¶ä¸­è¯»å†™æ•°æ®æ—¶ï¼Œè¯·æ±‚ä¼šè½¬åˆ° <code>å†…æ ¸å¤„ç†ç¨‹åº(kernel driver)</code>ã€‚å¦‚æœæ–‡ä»¶æ˜¯å¸¸è§„æ–‡ä»¶ï¼Œåˆ™æ•°æ®ç”±æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åºå¤„ç†ï¼Œå¹¶ä¸”é€šå¸¸å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨ä¸Šçš„æŸå—åŒºåŸŸä¸­ï¼Œä»æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®å°±æ˜¯ä¹‹å‰åœ¨è¯¥ä½ç½®å†™å…¥çš„æ•°æ®ã€‚</p><p>å½“æ•°æ®è¯»å–æˆ–å†™å…¥åˆ°è®¾å¤‡æ–‡ä»¶æ—¶ï¼Œè¯·æ±‚ä¼šè¢«è®¾å¤‡é©±åŠ¨ç¨‹åºå¤„ç†ã€‚æ¯ä¸ªè®¾å¤‡æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ç¼–å·ï¼Œè¯¥ç¼–å·æ ‡ç¤ºè¦ä½¿ç”¨çš„è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚è®¾å¤‡å¤„ç†æ•°æ®çš„å·¥ä½œæ˜¯å®ƒè‡ªå·±çš„äº‹ã€‚</p><ul><li><code>å—è®¾å¤‡</code> ä¹Ÿå«åšå—ç‰¹æ®Šæ–‡ä»¶ï¼Œå®ƒçš„è¡Œä¸ºé€šå¸¸ä¸æ™®é€šæ–‡ä»¶ç›¸ä¼¼ï¼šå®ƒä»¬æ˜¯å­—èŠ‚æ•°ç»„ï¼Œå¹¶ä¸”åœ¨ç»™å®šä½ç½®è¯»å–çš„å€¼æ˜¯æœ€åå†™å…¥è¯¥ä½ç½®çš„å€¼ã€‚æ¥è‡ªå—è®¾å¤‡çš„æ•°æ®å¯ä»¥ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä»ç¼“å­˜ä¸­è¯»å–ï¼›å†™å…¥å¯ä»¥è¢«ç¼“å†²ã€‚å—è®¾å¤‡é€šå¸¸æ˜¯å¯æœç´¢çš„ï¼Œå—è®¾å¤‡çš„æ¦‚å¿µæ˜¯ï¼Œç›¸åº”çš„ç¡¬ä»¶å¯ä»¥ä¸€æ¬¡è¯»å–æˆ–è€…å†™å…¥æ•´ä¸ªå—ï¼Œä¾‹å¦‚ç£ç›˜ä¸Šçš„ä¸€ä¸ªæ‰‡åŒº</li><li><code>å­—ç¬¦è®¾å¤‡</code> ä¹Ÿç§°ä¸ºå­—ç¬¦ç‰¹æ®Šæ–‡ä»¶ï¼Œå®ƒçš„è¡Œä¸ºç±»ä¼¼äºç®¡é“ã€ä¸²è¡Œç«¯å£ã€‚å°†å­—èŠ‚å†™å…¥å­—ç¬¦è®¾å¤‡å¯èƒ½ä¼šå¯¼è‡´å®ƒåœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼Œåœ¨ä¸²è¡Œç«¯å£ä¸Šè¾“å‡ºï¼Œè½¬æ¢ä¸ºå£°éŸ³ã€‚</li><li><code>ç›®å½•(Directories)</code> æ˜¯ç®¡ç†æ–‡ä»¶ç³»ç»Ÿç»“æ„çš„ç³»ç»Ÿæ–‡ä»¶ã€‚å®ƒæ˜¯ç”¨äºåœ¨è®¡ç®—æœºä¸Šå­˜å‚¨æ–‡ä»¶çš„ä½ç½®ã€‚ç›®å½•ä½äºåˆ†å±‚æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¾‹å¦‚ Linuxï¼ŒMS-DOS å’Œ UNIXã€‚</li></ul><h2 id="æ–‡ä»¶è®¿é—®"><a class="markdownIt-Anchor" href="#æ–‡ä»¶è®¿é—®"></a> æ–‡ä»¶è®¿é—®</h2><p>æ—©æœŸçš„æ“ä½œç³»ç»Ÿåªæœ‰ä¸€ç§è®¿é—®æ–¹å¼ï¼š<code>åºåˆ—è®¿é—®(sequential access)</code>ã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹å¯ä»¥æŒ‰ç…§é¡ºåºè¯»å–æ‰€æœ‰çš„å­—èŠ‚æˆ–æ–‡ä»¶ä¸­çš„è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½è·³è¿‡å¹¶ä¹±åºæ‰§è¡Œå®ƒä»¬ã€‚é¡ºåºè®¿é—®æ–‡ä»¶æ˜¯å¯ä»¥è¿”å›åˆ°èµ·ç‚¹çš„ï¼Œéœ€è¦æ—¶å¯ä»¥å¤šæ¬¡è¯»å–è¯¥æ–‡ä»¶ã€‚å½“å­˜å‚¨ä»‹è´¨æ˜¯ç£å¸¦è€Œä¸æ˜¯ç£ç›˜æ—¶ï¼Œé¡ºåºè®¿é—®æ–‡ä»¶å¾ˆæ–¹ä¾¿ã€‚</p><p>åœ¨ä½¿ç”¨ç£ç›˜æ¥å­˜å‚¨æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä¸æŒ‰ç…§é¡ºåºè¯»å–æ–‡ä»¶ä¸­çš„å­—èŠ‚æˆ–è€…è®°å½•ï¼Œæˆ–è€…æŒ‰ç…§å…³é”®å­—è€Œä¸æ˜¯ä½ç½®æ¥è®¿é—®è®°å½•ã€‚è¿™ç§èƒ½å¤Ÿä»¥ä»»æ„æ¬¡åºè¿›è¡Œè¯»å–çš„ç§°ä¸º<code>éšæœºè®¿é—®æ–‡ä»¶(random access file)</code>ã€‚è®¸å¤šåº”ç”¨ç¨‹åºéƒ½éœ€è¦è¿™ç§æ–¹å¼ã€‚</p><p>éšæœºè®¿é—®æ–‡ä»¶å¯¹è®¸å¤šåº”ç”¨ç¨‹åºæ¥è¯´éƒ½å¿…ä¸å¯å°‘ï¼Œä¾‹å¦‚ï¼Œæ•°æ®åº“ç³»ç»Ÿã€‚å¦‚æœä¹˜å®¢æ‰“ç”µè¯é¢„å®šæŸèˆªç­æœºç¥¨ï¼Œè®¢ç¥¨ç¨‹åºå¿…é¡»èƒ½å¤Ÿç›´æ¥è®¿é—®èˆªç­è®°å½•ï¼Œè€Œä¸å¿…å…ˆè¯»å–å…¶ä»–èˆªç­çš„æˆåƒä¸Šä¸‡æ¡è®°å½•ã€‚</p><h1 id="ç›®å½•"><a class="markdownIt-Anchor" href="#ç›®å½•"></a> ç›®å½•</h1><p>æ–‡ä»¶ç³»ç»Ÿé€šå¸¸æä¾› <code>ç›®å½•(directories)</code> æˆ–è€… <code>æ–‡ä»¶å¤¹(folders)</code> ç”¨äºè®°å½•æ–‡ä»¶çš„ä½ç½®ï¼Œåœ¨å¾ˆå¤šç³»ç»Ÿä¸­ç›®å½•æœ¬èº«ä¹Ÿæ˜¯æ–‡ä»¶ã€‚</p><h2 id="ä¸€çº§ç›®å½•ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#ä¸€çº§ç›®å½•ç³»ç»Ÿ"></a> ä¸€çº§ç›®å½•ç³»ç»Ÿ</h2><p>ç›®å½•ç³»ç»Ÿæœ€ç®€å•çš„å½¢å¼æ˜¯æœ‰ä¸€ä¸ªèƒ½å¤ŸåŒ…å«æ‰€æœ‰æ–‡ä»¶çš„ç›®å½•ã€‚è¿™ç§ç›®å½•è¢«ç§°ä¸º <code>æ ¹ç›®å½•(root directory)</code>ï¼Œç”±äºæ ¹ç›®å½•çš„å”¯ä¸€æ€§ï¼Œæ‰€ä»¥å…¶åç§°å¹¶ä¸é‡è¦ã€‚åœ¨æœ€æ—©æœŸçš„ä¸ªäººè®¡ç®—æœºä¸­ï¼Œè¿™ç§ç³»ç»Ÿå¾ˆå¸¸è§ï¼Œéƒ¨åˆ†åŸå› æ˜¯å› ä¸ºåªæœ‰ä¸€ä¸ªç”¨æˆ·ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå•å±‚ç›®å½•ç³»ç»Ÿçš„ä¾‹å­</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928161552.png" srcset="/img/loading.gif" alt="" /></p><p>è¯¥ç›®å½•ä¸­æœ‰å››ä¸ªæ–‡ä»¶ã€‚è¿™ç§è®¾è®¡çš„ä¼˜ç‚¹åœ¨äºç®€å•ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¿«é€Ÿå®šä½æ–‡ä»¶ï¼Œæ¯•ç«Ÿåªæœ‰ä¸€ä¸ªåœ°æ–¹å¯ä»¥æ£€ç´¢ã€‚è¿™ç§ç›®å½•ç»„ç»‡å½¢å¼ç°åœ¨ä¸€èˆ¬ç”¨äºç®€å•çš„åµŒå…¥å¼è®¾å¤‡ï¼ˆå¦‚æ•°ç ç›¸æœºå’ŒæŸäº›ä¾¿æºå¼éŸ³ä¹æ’­æ”¾å™¨ï¼‰ä¸Šä½¿ç”¨ã€‚</p><h2 id="å±‚æ¬¡ç›®å½•ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#å±‚æ¬¡ç›®å½•ç³»ç»Ÿ"></a> å±‚æ¬¡ç›®å½•ç³»ç»Ÿ</h2><p>å¯¹äºç®€å•çš„åº”ç”¨è€Œè¨€ï¼Œä¸€èˆ¬éƒ½ç”¨å•å±‚ç›®å½•æ–¹å¼ï¼Œä½†æ˜¯è¿™ç§ç»„ç»‡å½¢å¼å¹¶ä¸é€‚åˆäºç°ä»£è®¡ç®—æœºï¼Œå› ä¸ºç°ä»£è®¡ç®—æœºå«æœ‰æˆåƒä¸Šä¸‡ä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚å¦‚æœéƒ½æ”¾åœ¨æ ¹ç›®å½•ä¸‹ï¼ŒæŸ¥æ‰¾èµ·æ¥ä¼šéå¸¸å›°éš¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå‡ºç°äº† <code>å±‚æ¬¡ç›®å½•ç³»ç»Ÿ(Hierarchical Directory Systems)</code>ï¼Œä¹Ÿç§°ä¸º<code>ç›®å½•æ ‘</code>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ç”¨å¾ˆå¤šç›®å½•æŠŠæ–‡ä»¶è¿›è¡Œåˆ†ç»„ã€‚è¿›è€Œï¼Œå¦‚æœå¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œæ¯”å¦‚å…¬å¸çš„ç½‘ç»œç³»ç»Ÿï¼Œæ¯ä¸ªç”¨æˆ·å¯ä»¥ä¸ºè‡ªå·±çš„ç›®å½•æ ‘æ‹¥æœ‰è‡ªå·±çš„ç§äººæ ¹ç›®å½•ã€‚è¿™ç§æ–¹å¼çš„ç»„ç»‡ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928161630.png" srcset="/img/loading.gif" alt="" /></p><p>æ ¹ç›®å½•å«æœ‰ç›®å½• Aã€B å’Œ C ï¼Œåˆ†åˆ«å±äºä¸åŒçš„ç”¨æˆ·ï¼Œå…¶ä¸­ä¸¤ä¸ªç”¨æˆ·å„è‡ªåˆ›å»ºäº†å­ç›®å½•ã€‚ç”¨æˆ·å¯ä»¥åˆ›å»ºä»»æ„æ•°é‡çš„å­ç›®å½•ï¼Œç°ä»£æ–‡ä»¶ç³»ç»Ÿéƒ½æ˜¯æŒ‰ç…§è¿™ç§æ–¹å¼ç»„ç»‡çš„ã€‚</p><h2 id="è·¯å¾„å"><a class="markdownIt-Anchor" href="#è·¯å¾„å"></a> è·¯å¾„å</h2><p>å½“ç›®å½•æ ‘ç»„ç»‡æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œéœ€è¦æœ‰æŸç§æ–¹æ³•æŒ‡æ˜æ–‡ä»¶åã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ–¹å¼æ˜¯æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šç”¨ä¸€ä¸ª <code>ç»å¯¹è·¯å¾„å(absolute path name)</code>ï¼Œå®ƒç”±æ ¹ç›®å½•åˆ°æ–‡ä»¶çš„è·¯å¾„ç»„æˆã€‚åœ¨ <code>UNIX</code> ä¸­ï¼Œè·¯å¾„çš„ç»„ä»¶ç”± <code>/</code> åˆ†éš”ã€‚åœ¨ <code>Windows</code> ä¸­ï¼Œåˆ†éš”ç¬¦ä¸º <code>\</code>ã€‚ åœ¨ <code>MULTICS</code> ä¸­ï¼Œå®ƒæ˜¯ <code>&gt;</code>ã€‚ å› æ­¤ï¼Œåœ¨è¿™ä¸‰ä¸ªç³»ç»Ÿä¸­ï¼Œç›¸åŒçš„è·¯å¾„åå°†è¢«ç¼–å†™å¦‚ä¸‹</p><pre><code class="hljs properties"><span class="hljs-attr">Windows</span> <span class="hljs-string">\usr\ast\mailbox </span><span class="hljs-attr">UNIX</span> <span class="hljs-string">/usr/ast/mailbox </span><span class="hljs-attr">MULTICS</span> <span class="hljs-string">&gt;usr&gt;ast&gt;mailbox</span></code></pre><p>ä¸è®ºä½¿ç”¨å“ªç§æ–¹å¼ï¼Œå¦‚æœè·¯å¾„åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯åˆ†éš”ç¬¦ï¼Œé‚£å°±æ˜¯ç»å¯¹è·¯å¾„ã€‚</p><p>å¦å¤–ä¸€ç§æŒ‡å®šæ–‡ä»¶åçš„æ–¹æ³•æ˜¯ <code>ç›¸å¯¹è·¯å¾„å(relative path name)</code>ã€‚å®ƒå¸¸å¸¸å’Œ <code>å·¥ä½œç›®å½•(working directory)</code> ï¼ˆä¹Ÿç§°ä½œ <code>å½“å‰ç›®å½•(current directory)</code>ï¼‰ä¸€èµ·ä½¿ç”¨ã€‚ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®å½•ä½œä¸ºå½“å‰å·¥ä½œç›®å½•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰ç›®å½•æ˜¯ /usr/astï¼Œé‚£ä¹ˆç»å¯¹è·¯å¾„ /usr/ast/mailboxå¯ä»¥ç›´æ¥ä½¿ç”¨ mailbox æ¥å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå·¥ä½œç›®å½•æ˜¯ /usr/astï¼Œåˆ™ UNIX å‘½ä»¤</p><pre><code class="hljs awk">cp <span class="hljs-regexp">/usr/</span>ast<span class="hljs-regexp">/mailbox  /u</span>sr<span class="hljs-regexp">/ast/m</span>ailbox.bak</code></pre><p>å’Œå‘½ä»¤</p><pre><code class="hljs avrasm"><span class="hljs-keyword">cp</span> mailbox mailbox.bak</code></pre><p>å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚ç›¸å¯¹è·¯å¾„é€šå¸¸æƒ…å†µä¸‹æ›´åŠ æ–¹ä¾¿å’Œç®€æ´ã€‚è€Œå®ƒå®ç°çš„åŠŸèƒ½å’Œç»å¯¹è·¯å¾„å®‰å…¨ç›¸åŒã€‚<br />ä¸€äº›ç¨‹åºéœ€è¦è®¿é—®æŸä¸ªç‰¹å®šçš„æ–‡ä»¶è€Œä¸å¿…å…³å¿ƒå½“å‰çš„å·¥ä½œç›®å½•æ˜¯ä»€ä¹ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨ç»å¯¹è·¯å¾„åã€‚</p><p>æ”¯æŒå±‚æ¬¡ç›®å½•ç»“æ„çš„å¤§å¤šæ•°æ“ä½œç³»ç»Ÿåœ¨æ¯ä¸ªç›®å½•ä¸­æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ç›®å½•é¡¹ <code>.</code> å’Œ <code>..</code>ï¼Œåˆ†åˆ«è¯»ä½œ <code>dot</code> å’Œ <code>dotdot</code>ã€‚<code>dot</code> æŒ‡çš„æ˜¯å½“å‰ç›®å½•ï¼Œ<code>dotdot</code> æŒ‡çš„æ˜¯å…¶çˆ¶ç›®å½•ï¼ˆåœ¨æ ¹ç›®å½•ä¸­ä¾‹å¤–ï¼Œåœ¨æ ¹ç›®å½•ä¸­æŒ‡å‘è‡ªå·±ï¼‰ã€‚å¯ä»¥å‚è€ƒä¸‹é¢çš„è¿›ç¨‹æ ‘æ¥æŸ¥çœ‹å¦‚ä½•ä½¿ç”¨ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928162121.png" srcset="/img/loading.gif" alt="" /><br />ä¸€ä¸ªè¿›ç¨‹çš„å·¥ä½œç›®å½•æ˜¯ <code>/usr/ast</code>ã€‚</p><pre><code class="hljs crystal">cp ../<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">dictionary</span> .</span>cp /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">dictionary</span> .</span>cp /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">dictionary</span> <span class="hljs-title">dictionary</span></span>cp /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">dictionary</span> /<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">dictionary</span></span></code></pre><h1 id="æ–‡ä»¶ç³»ç»Ÿçš„å®ç°"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç³»ç»Ÿçš„å®ç°"></a> æ–‡ä»¶ç³»ç»Ÿçš„å®ç°</h1><h2 id="æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€"></a> æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€</h2><p>æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨åœ¨ç£ç›˜ä¸­ã€‚å¤§éƒ¨åˆ†çš„ç£ç›˜èƒ½å¤Ÿåˆ’åˆ†å‡ºä¸€åˆ°å¤šä¸ªåˆ†åŒºï¼Œå«åš <code>ç£ç›˜åˆ†åŒº(disk partitioning)</code> æˆ–è€…æ˜¯ <code>ç£ç›˜åˆ†ç‰‡(disk slicing)</code>ã€‚<strong>æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œæ¯å—åˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿå¯ä»¥ä¸åŒã€‚ç£ç›˜çš„ <code>0</code> å·åˆ†åŒºç§°ä¸º <code>ä¸»å¼•å¯¼è®°å½•(Master Boot Record, MBR)</code>ï¼Œç”¨æ¥ <code>å¼•å¯¼(boot)</code> è®¡ç®—æœºã€‚åœ¨ <code>MBR</code> çš„ç»“å°¾æ˜¯ <code>åˆ†åŒºè¡¨(partition table)</code>ã€‚æ¯ä¸ªåˆ†åŒºè¡¨ç»™å‡ºæ¯ä¸ªåˆ†åŒºç”±å¼€å§‹åˆ°ç»“æŸçš„åœ°å€ã€‚ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨ä¸€ä¸ªç§°ä¸ºåˆ†åŒºç¼–è¾‘å™¨çš„ç¨‹åºæ¥åˆ›å»ºï¼Œè°ƒæ•´å¤§å°ï¼Œåˆ é™¤å’Œæ“ä½œåˆ†åŒºã€‚è¿™ç§æ–¹å¼çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯<strong>å¾ˆéš¾é€‚å½“è°ƒæ•´åˆ†åŒºçš„å¤§å°</strong>ï¼Œå¯¼è‡´ä¸€ä¸ªåˆ†åŒºå…·æœ‰å¾ˆå¤šå¯ç”¨ç©ºé—´ï¼Œè€Œå¦ä¸€ä¸ªåˆ†åŒºå‡ ä¹å®Œå…¨è¢«åˆ†é…ã€‚</p><p><code>MBR</code> å¯ä»¥ç”¨åœ¨ <code>DOS</code> ã€<code>Microsoft Windows</code> å’Œ <code>Linux</code> æ“ä½œç³»ç»Ÿä¸­ã€‚ä» 2010 å¹´ä»£ä¸­æœŸå¼€å§‹ï¼Œå¤§å¤šæ•°æ–°è®¡ç®—æœºéƒ½æ”¹ç”¨ <code>GUID åˆ†åŒºè¡¨ï¼ˆGPTï¼‰</code>åˆ†åŒºæ–¹æ¡ˆã€‚</p><p>å½“è®¡ç®—æœºå¼€å§‹å¼• <code>boot</code> æ—¶ï¼Œ<code>BIOS</code> è¯»å…¥å¹¶æ‰§è¡Œ <code>MBR</code>ã€‚</p><h3 id="å¼•å¯¼å—"><a class="markdownIt-Anchor" href="#å¼•å¯¼å—"></a> å¼•å¯¼å—</h3><p><code>MBR</code> åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯<strong>ç¡®å®šæ´»åŠ¨åˆ†åŒº</strong>ï¼Œè¯»å…¥å®ƒçš„ç¬¬ä¸€ä¸ªå—ï¼Œç§°ä¸º <code>å¼•å¯¼å—(boot block)</code> å¹¶æ‰§è¡Œã€‚å¼•å¯¼å—ä¸­çš„ç¨‹åºå°†åŠ è½½åˆ†åŒºä¸­çš„æ“ä½œç³»ç»Ÿã€‚ä¸ºäº†ä¸€è‡´æ€§ï¼Œæ¯ä¸ªåˆ†åŒºéƒ½ä¼šä»å¼•å¯¼å—å¼€å§‹ï¼Œå³ä½¿å¼•å¯¼å—ä¸åŒ…å«æ“ä½œç³»ç»Ÿã€‚å¼•å¯¼å—å æ®æ–‡ä»¶ç³»ç»Ÿçš„å‰ <code>4096</code> ä¸ªå­—èŠ‚ï¼Œä»ç£ç›˜ä¸Šçš„å­—èŠ‚åç§»é‡ <code>0</code> å¼€å§‹ã€‚å¼•å¯¼å—å¯ç”¨äºå¯åŠ¨æ“ä½œç³»ç»Ÿã€‚</p><blockquote><p>åœ¨è®¡ç®—æœºä¸­ï¼Œå¼•å¯¼å°±æ˜¯å¯åŠ¨è®¡ç®—æœºçš„è¿‡ç¨‹ï¼Œå®ƒå¯ä»¥é€šè¿‡ç¡¬ä»¶ï¼ˆä¾‹å¦‚æŒ‰ä¸‹ç”µæºæŒ‰é’®ï¼‰æˆ–è€…è½¯ä»¶å‘½ä»¤çš„æ–¹å¼æ¥å¯åŠ¨ã€‚å¼€æœºåï¼Œç”µè„‘çš„ <code>CPU</code> è¿˜ä¸èƒ½æ‰§è¡ŒæŒ‡ä»¤ï¼Œå› ä¸ºæ­¤æ—¶æ²¡æœ‰è½¯ä»¶åœ¨ä¸»å­˜ä¸­ï¼Œæ‰€ä»¥ä¸€äº›è½¯ä»¶å¿…é¡»å…ˆè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åæ‰èƒ½è®© <code>CPU</code> å¼€å§‹æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è®¡ç®—æœºå¼€æœºåï¼Œé¦–å…ˆä¼šè¿›è¡Œè½¯ä»¶çš„è£…è½½è¿‡ç¨‹ã€‚</p><p>é‡å¯ç”µè„‘çš„è¿‡ç¨‹ç§°ä¸º <code>é‡æ–°å¼•å¯¼(rebooting)</code>ï¼Œä»ä¼‘çœ æˆ–ç¡çœ çŠ¶æ€è¿”å›è®¡ç®—æœºçš„è¿‡ç¨‹ä¸æ¶‰åŠå¯åŠ¨ã€‚</p></blockquote><p>é™¤äº†ä»å¼•å¯¼å—å¼€å§‹ä¹‹å¤–ï¼Œç£ç›˜åˆ†åŒºçš„å¸ƒå±€æ˜¯éšç€æ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒè€Œå˜åŒ–çš„ã€‚é€šå¸¸æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«ä¸€äº›å±æ€§ï¼Œå¦‚ä¸‹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928163718.png" srcset="/img/loading.gif" alt="" /></p><h3 id="è¶…çº§å—"><a class="markdownIt-Anchor" href="#è¶…çº§å—"></a> è¶…çº§å—</h3><p><code>è¶…çº§å—(Superblock)</code> çš„å¤§å°ä¸º <code>4096</code> å­—èŠ‚ï¼Œä»ç£ç›˜ä¸Šçš„å­—èŠ‚åç§» <code>4096</code> å¼€å§‹ã€‚è¶…çº§å—åŒ…å«æ–‡ä»¶ç³»ç»Ÿçš„æ‰€æœ‰å…³é”®å‚æ•°</p><ul><li><p>æ–‡ä»¶ç³»ç»Ÿçš„å¤§å°</p></li><li><p>æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®å—æ•°</p></li><li><p>æŒ‡ç¤ºæ–‡ä»¶ç³»ç»ŸçŠ¶æ€çš„æ ‡å¿—</p></li><li><p>åˆ†é…ç»„å¤§å°</p></li></ul><p>åœ¨è®¡ç®—æœºå¯åŠ¨æˆ–è€…æ–‡ä»¶ç³»ç»Ÿé¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè¶…çº§å—ä¼šè¢«è¯»å…¥å†…å­˜ã€‚</p><h3 id="ç©ºé—²ç©ºé—´å—"><a class="markdownIt-Anchor" href="#ç©ºé—²ç©ºé—´å—"></a> ç©ºé—²ç©ºé—´å—</h3><p>æ¥ç€æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­ç©ºé—²å—çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ç”¨ä½å›¾æˆ–è€…æŒ‡é’ˆåˆ—è¡¨çš„å½¢å¼ç»™å‡ºã€‚</p><ul><li><code>BitMap</code> ä½å›¾æˆ–è€… <code>Bit vector</code> ä½å‘é‡</li></ul><p>ä½å›¾æˆ–ä½å‘é‡æ˜¯ä¸€ç³»åˆ—ä½æˆ–ä½çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªä½å¯¹åº”ä¸€ä¸ªç£ç›˜å—ï¼Œè¯¥ä½å¯ä»¥é‡‡ç”¨ä¸¤ä¸ªå€¼ï¼š<code>0</code>å’Œ <code>1</code>ï¼Œ<code>0</code> è¡¨ç¤ºå·²åˆ†é…è¯¥å—ï¼Œè€Œ <code>1</code> è¡¨ç¤ºä¸€ä¸ªç©ºé—²å—ã€‚ä¸‹å›¾ä¸­çš„ç£ç›˜ä¸Šç»™å®šçš„ç£ç›˜å—å®ä¾‹ï¼ˆåˆ†é…äº†ç»¿è‰²å—ï¼‰å¯ä»¥ç”¨ <code>16ä½</code> çš„ä½å›¾è¡¨ç¤ºä¸ºï¼š<code>0000111000000110</code>ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928164045.png" srcset="/img/loading.gif" alt="" /></p><ul><li>ä½¿ç”¨é“¾è¡¨è¿›è¡Œç®¡ç†</li></ul><p>åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œç©ºé—²ç£ç›˜å—é“¾æ¥åœ¨ä¸€èµ·ï¼Œå³ä¸€ä¸ªç©ºé—²å—åŒ…å«æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²å—çš„æŒ‡é’ˆã€‚ç¬¬ä¸€ä¸ªç£ç›˜å—çš„å—å·å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„å•ç‹¬ä½ç½®ï¼Œä¹Ÿç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928164130.png" srcset="/img/loading.gif" alt="" /></p><h3 id="ç¢ç‰‡"><a class="markdownIt-Anchor" href="#ç¢ç‰‡"></a> ç¢ç‰‡</h3><p><code>ç¢ç‰‡(fragment)</code> ä¹Ÿç§°ä¸ºç‰‡æ®µã€‚ä¸€èˆ¬é›¶æ•£çš„å•ä¸ªæ•°æ®é€šå¸¸ç§°ä¸ºç‰‡æ®µã€‚ ç£ç›˜å—å¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºå›ºå®šå¤§å°çš„åˆ†é…å•å…ƒï¼Œç‰‡æ®µåªæ˜¯åœ¨é©±åŠ¨å™¨ä¸Šå½¼æ­¤ä¸ç›¸é‚»çš„æ–‡ä»¶ç‰‡æ®µã€‚å¦‚æœä½ ä¸ç†è§£è¿™ä¸ªæ¦‚å¿µå°±ç»™ä½ ä¸¾ä¸ªä¾‹å­ã€‚æ¯”å¦‚ä½ ç”¨ Windows ç”µè„‘åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªæ–‡ä»¶å¯ä»¥å­˜å‚¨åœ¨ä»»ä½•åœ°æ–¹ï¼Œæ¯”å¦‚å­˜åœ¨æ¡Œé¢ä¸Šï¼Œå­˜åœ¨ç£ç›˜ä¸­çš„æ–‡ä»¶å¤¹ä¸­æˆ–è€…å…¶ä»–åœ°æ–¹ã€‚ä½ å¯ä»¥æ‰“å¼€æ–‡ä»¶ï¼Œç¼–è¾‘æ–‡ä»¶ï¼Œåˆ é™¤æ–‡ä»¶ç­‰ç­‰ã€‚ä½ å¯èƒ½ä»¥ä¸ºè¿™äº›éƒ½åœ¨ä¸€ä¸ªåœ°æ–¹å‘ç”Ÿï¼Œä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯ï¼Œä½ çš„ç¡¬ç›˜é©±åŠ¨å™¨å¯èƒ½ä¼šå°†æ–‡ä»¶ä¸­çš„ä¸€éƒ¨åˆ†å­˜å‚¨åœ¨ä¸€ä¸ªåŒºåŸŸå†…ï¼Œå¦ä¸€éƒ¨åˆ†å­˜å‚¨åœ¨å¦å¤–ä¸€ä¸ªåŒºåŸŸï¼Œåœ¨ä½ æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œç¡¬ç›˜é©±åŠ¨å™¨ä¼šè¿…é€Ÿçš„å°†æ–‡ä»¶çš„æ‰€æœ‰éƒ¨åˆ†æ±‡æ€»åœ¨ä¸€èµ·ï¼Œä»¥ä¾¿å…¶ä»–è®¡ç®—æœºç³»ç»Ÿå¯ä»¥ä½¿ç”¨å®ƒã€‚</p><h3 id="inode"><a class="markdownIt-Anchor" href="#inode"></a> inode</h3><p><code>inode(index node)</code> ä¹Ÿç§°ä½œç´¢å¼•èŠ‚ç‚¹ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„çš„ç»“æ„ï¼Œæ¯ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ª <code>inode</code>ï¼Œ<code>inode</code> éå¸¸é‡è¦ï¼Œå®ƒè¯´æ˜äº†æ–‡ä»¶çš„æ–¹æ–¹é¢é¢ã€‚æ¯ä¸ªç´¢å¼•èŠ‚ç‚¹éƒ½å­˜å‚¨å¯¹è±¡æ•°æ®çš„å±æ€§å’Œç£ç›˜å—ä½ç½®ã€‚</p><p><code>inode</code> èŠ‚ç‚¹ä¸»è¦åŒ…æ‹¬äº†ä»¥ä¸‹ä¿¡æ¯</p><ul><li><p>æ¨¡å¼/æƒé™ï¼ˆä¿æŠ¤ï¼‰</p></li><li><p>æ‰€æœ‰è€… ID</p></li><li><p>ç»„ ID</p></li><li><p>æ–‡ä»¶å¤§å°</p></li><li><p>æ–‡ä»¶çš„ç¡¬é“¾æ¥æ•°</p></li><li><p>ä¸Šæ¬¡è®¿é—®æ—¶é—´</p></li><li><p>æœ€åä¿®æ”¹æ—¶é—´</p></li><li><p><code>inode</code> ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´</p></li></ul><p>æ–‡ä»¶åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç´¢å¼•èŠ‚ç‚¹å’Œå—ã€‚ä¸€æ—¦åˆ›å»ºåï¼Œæ¯ç§ç±»å‹çš„å—æ•°æ˜¯å›ºå®šçš„ã€‚ä½ ä¸èƒ½å¢åŠ åˆ†åŒºä¸Š <code>inode</code> çš„æ•°é‡ï¼Œä¹Ÿä¸èƒ½å¢åŠ ç£ç›˜å—çš„æ•°é‡ã€‚</p><p>ç´§è·Ÿåœ¨ <code>inode</code> åé¢çš„æ˜¯æ ¹ç›®å½•ï¼Œå®ƒå­˜æ”¾çš„æ˜¯æ–‡ä»¶ç³»ç»Ÿç›®å½•æ ‘çš„æ ¹éƒ¨ã€‚æœ€åï¼Œç£ç›˜çš„å…¶ä»–éƒ¨åˆ†å­˜æ”¾äº†å…¶ä»–æ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶ã€‚</p><h2 id="æ–‡ä»¶çš„å®ç°"><a class="markdownIt-Anchor" href="#æ–‡ä»¶çš„å®ç°"></a> æ–‡ä»¶çš„å®ç°</h2><p>æœ€é‡è¦çš„é—®é¢˜æ˜¯è®°å½•å„ä¸ªæ–‡ä»¶åˆ†åˆ«ç”¨åˆ°äº†å“ªäº›ç£ç›˜å—ã€‚ä¸åŒçš„ç³»ç»Ÿé‡‡ç”¨äº†ä¸åŒçš„æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬ä¼šæ¢è®¨ä¸€ä¸‹è¿™äº›æ–¹å¼ã€‚åˆ†é…èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯<strong>æœ‰æ•ˆåˆ©ç”¨æ–‡ä»¶ç©ºé—´å’Œå¿«é€Ÿè®¿é—®æ–‡ä»¶</strong>ï¼Œä¸»è¦æœ‰ä¸‰ç§åˆ†é…æ–¹æ¡ˆ</p><ul><li>è¿ç»­åˆ†é…</li><li>é“¾è¡¨åˆ†é…</li><li>ç´¢å¼•åˆ†é…</li></ul><h3 id="1-è¿ç»­åˆ†é…"><a class="markdownIt-Anchor" href="#1-è¿ç»­åˆ†é…"></a> 1. è¿ç»­åˆ†é…</h3><blockquote><p><code>CD-ROM</code>, <code>DVD</code>, è“å…‰å…‰ç›˜ä½¿ç”¨äº†è¿ç»­åˆ†é…æ–¹å¼ã€‚</p></blockquote><p>æœ€ç®€å•çš„åˆ†é…æ–¹æ¡ˆæ˜¯æŠŠæ¯ä¸ªæ–‡ä»¶ä½œä¸ºä¸€è¿ä¸²è¿ç»­æ•°æ®å—å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚å› æ­¤ï¼Œåœ¨å…·æœ‰ 1KB å—çš„ç£ç›˜ä¸Šï¼Œå°†ä¸º 50 KB æ–‡ä»¶åˆ†é… 50 ä¸ªè¿ç»­å—ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929143042.png" srcset="/img/loading.gif" alt="" /></p><p>è¿ç»­çš„ç£ç›˜ç©ºé—´åˆ†é…æœ‰ä¸¤ä¸ªä¼˜ç‚¹ã€‚</p><ul><li><p>ç¬¬ä¸€ï¼Œè¿ç»­æ–‡ä»¶å­˜å‚¨<strong>å®ç°èµ·æ¥æ¯”è¾ƒç®€å•</strong>ï¼Œåªéœ€è¦è®°ä½ä¸¤ä¸ªæ•°å­—å°±å¯ä»¥ï¼šä¸€ä¸ªæ˜¯ç¬¬ä¸€ä¸ªå—çš„æ–‡ä»¶åœ°å€å’Œæ–‡ä»¶çš„å—æ•°é‡ã€‚ç»™å®šç¬¬ä¸€ä¸ªå—çš„ç¼–å·ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„åŠ æ³•æ‰¾åˆ°ä»»ä½•å…¶ä»–å—çš„ç¼–å·ã€‚</p></li><li><p>ç¬¬äºŒç‚¹æ˜¯<strong>è¯»å–æ€§èƒ½æ¯”è¾ƒå¼º</strong>ï¼Œå¯ä»¥é€šè¿‡ä¸€æ¬¡æ“ä½œä»æ–‡ä»¶ä¸­è¯»å–æ•´ä¸ªæ–‡ä»¶ã€‚åªéœ€è¦ä¸€æ¬¡å¯»æ‰¾ç¬¬ä¸€ä¸ªå—ã€‚åé¢å°±ä¸å†éœ€è¦å¯»é“æ—¶é—´å’Œæ—‹è½¬å»¶è¿Ÿï¼Œæ‰€ä»¥æ•°æ®ä¼šä»¥å…¨å¸¦å®½è¿›å…¥ç£ç›˜ã€‚</p></li></ul><p>å› æ­¤ï¼Œè¿ç»­çš„ç©ºé—´åˆ†é…å…·æœ‰<strong>å®ç°ç®€å•ã€é«˜æ€§èƒ½</strong>çš„ç‰¹ç‚¹ã€‚</p><p>ä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç£ç›˜ä¼šå˜å¾—å¾ˆé›¶ç¢ã€‚ä¸‹å›¾è§£é‡Šäº†è¿™ç§ç°è±¡ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929143412.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™é‡Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ <code>D</code> å’Œ <code>F</code> è¢«åˆ é™¤äº†ã€‚å½“åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ­¤æ–‡ä»¶æ‰€å ç”¨çš„å—ä¹Ÿéšä¹‹é‡Šæ”¾ï¼Œå°±ä¼šåœ¨ç£ç›˜ç©ºé—´ä¸­ç•™ä¸‹ä¸€äº›ç©ºé—²å—ã€‚ç£ç›˜å¹¶ä¸ä¼šåœ¨è¿™ä¸ªä½ç½®æŒ¤å‹æ‰ç©ºé—²å—ï¼Œå› ä¸ºè¿™ä¼šå¤åˆ¶ç©ºé—²å—ä¹‹åçš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¯èƒ½ä¼šæœ‰ä¸Šç™¾ä¸‡çš„å—ï¼Œè¿™ä¸ªé‡çº§å°±å¤ªå¤§äº†ã€‚</p><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œè¿™ä¸ªç¢ç‰‡ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºæ¯ä¸ªæ–°æ–‡ä»¶éƒ½ä¼šåœ¨ä¹‹å‰æ–‡ä»¶çš„ç»“å°¾å¤„è¿›è¡Œå†™å…¥ã€‚ç„¶è€Œï¼Œç£ç›˜æœ€ç»ˆä¼šè¢«å¡«æ»¡ï¼Œ<strong>å› æ­¤è¦ä¹ˆå‹ç¼©ç£ç›˜ã€è¦ä¹ˆé‡æ–°ä½¿ç”¨ç©ºé—²å—çš„ç©ºé—´</strong>ã€‚</p><ul><li>å‹ç¼©ç£ç›˜çš„å¼€é”€å¤ªå¤§ï¼Œå› æ­¤ä¸å¯è¡Œï¼›</li><li>é‡æ–°ä½¿ç”¨ç©ºé—²å—çš„ç©ºé—´ä¼šç»´æŠ¤ä¸€ä¸ª<strong>ç©ºé—²åˆ—è¡¨</strong>ï¼Œè¿™ä¸ªæ˜¯å¯è¡Œçš„ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µåˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºç©ºé—²å—åŒ¹é…åˆé€‚å¤§å°çš„æ–‡ä»¶ï¼Œéœ€è¦çŸ¥é“è¯¥æ–‡ä»¶çš„æœ€ç»ˆå¤§å°ã€‚</li></ul><h3 id="2-é“¾è¡¨åˆ†é…"><a class="markdownIt-Anchor" href="#2-é“¾è¡¨åˆ†é…"></a> 2. é“¾è¡¨åˆ†é…</h3><p>ç¬¬äºŒç§å­˜å‚¨æ–‡ä»¶çš„æ–¹å¼æ˜¯ä¸ºæ¯ä¸ªæ–‡ä»¶æ„é€ ç£ç›˜å—é“¾è¡¨ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ç£ç›˜å—çš„é“¾æ¥åˆ—è¡¨ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929144116.png" srcset="/img/loading.gif" alt="" /></p><p>æ¯ä¸ªå—çš„ç¬¬ä¸€ä¸ªå­—ä½œä¸ºæŒ‡å‘ä¸‹ä¸€å—çš„æŒ‡é’ˆï¼Œå—çš„å…¶ä»–éƒ¨åˆ†å­˜æ”¾æ•°æ®ã€‚æ•´ä¸ªçš„é“¾è¡¨åˆ†é…æ–¹æ¡ˆï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929144259.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸è¿ç»­åˆ†é…æ–¹æ¡ˆä¸åŒï¼Œè¿™ä¸€æ–¹æ³•<strong>å¯ä»¥å……åˆ†åˆ©ç”¨æ¯ä¸ªç£ç›˜å—</strong>ã€‚é™¤äº†æœ€åä¸€ä¸ªç£ç›˜å—å¤–ï¼Œä¸ä¼šå› ä¸ºç£ç›˜ç¢ç‰‡è€Œæµªè´¹å­˜å‚¨ç©ºé—´ã€‚åŒæ ·ï¼Œåœ¨ç›®å½•é¡¹ä¸­ï¼Œåªè¦å­˜å‚¨äº†ç¬¬ä¸€ä¸ªæ–‡ä»¶å—ï¼Œé‚£ä¹ˆå…¶ä»–æ–‡ä»¶å—ä¹Ÿèƒ½å¤Ÿè¢«æ‰¾åˆ°ã€‚</p><ul><li><p>åœ¨é“¾è¡¨çš„åˆ†é…æ–¹æ¡ˆä¸­ï¼Œå°½ç®¡é¡ºåºè¯»å–éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯éšæœºè®¿é—®å´å¾ˆå›°éš¾ã€‚</p></li><li><p>ç”±äºæŒ‡é’ˆä¼šå ç”¨ä¸€äº›å­—èŠ‚ï¼Œæ¯ä¸ªç£ç›˜å—å®é™…å­˜å‚¨æ•°æ®çš„å­—èŠ‚æ•°å¹¶ä¸å†æ˜¯ <code>2</code> çš„æ•´æ•°æ¬¡å¹‚ã€‚è™½ç„¶è¿™ä¸ªé—®é¢˜å¹¶ä¸ä¼šå¾ˆä¸¥é‡ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼é™ä½äº†ç¨‹åºè¿è¡Œæ•ˆç‡ã€‚è®¸å¤šç¨‹åºéƒ½æ˜¯ä»¥é•¿åº¦ä¸º <code>2</code> çš„æ•´æ•°æ¬¡å¹‚æ¥è¯»å†™ç£ç›˜ï¼Œç”±äºæ¯ä¸ªå—çš„å‰å‡ ä¸ªå­—èŠ‚è¢«æŒ‡é’ˆæ‰€ä½¿ç”¨ï¼Œæ‰€ä»¥<strong>è¦è¯»å‡ºä¸€ä¸ªå®Œæˆçš„å—å¤§å°ä¿¡æ¯ï¼Œå°±éœ€è¦å½“å‰å—çš„ä¿¡æ¯å’Œä¸‹ä¸€å—çš„ä¿¡æ¯æ‹¼å‡‘è€Œæˆï¼Œå› æ­¤å°±å¼•å‘äº†æŸ¥æ‰¾å’Œæ‹¼æ¥çš„å¼€é”€</strong>ã€‚</p></li></ul><h3 id="3-ä½¿ç”¨å†…å­˜è¡¨è¿›è¡Œé“¾è¡¨åˆ†é…"><a class="markdownIt-Anchor" href="#3-ä½¿ç”¨å†…å­˜è¡¨è¿›è¡Œé“¾è¡¨åˆ†é…"></a> 3. ä½¿ç”¨å†…å­˜è¡¨è¿›è¡Œé“¾è¡¨åˆ†é…</h3><p>ç”±äºè¿ç»­åˆ†é…å’Œé“¾è¡¨åˆ†é…éƒ½æœ‰å…¶ä¸å¯å¿½è§†çš„ç¼ºç‚¹ã€‚æ‰€ä»¥æå‡ºäº†ä½¿ç”¨å†…å­˜ä¸­çš„è¡¨æ¥è§£å†³åˆ†é…é—®é¢˜ã€‚å–å‡ºæ¯ä¸ªç£ç›˜å—çš„æŒ‡é’ˆå­—ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨å†…å­˜çš„ä¸€ä¸ªè¡¨ä¸­ï¼Œå°±å¯ä»¥è§£å†³ä¸Šè¿°é“¾è¡¨çš„ä¸¤ä¸ªä¸è¶³ä¹‹å¤„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929144918.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾è¡¨ç¤ºäº†é“¾è¡¨å½¢æˆçš„ç£ç›˜å—çš„å†…å®¹ã€‚è¿™ä¸¤ä¸ªå›¾ä¸­éƒ½æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶ <code>A</code> ä¾æ¬¡ä½¿ç”¨äº†ç£ç›˜å—åœ°å€ <strong>4</strong>ã€<strong>7</strong>ã€ <strong>2</strong>ã€ <strong>10</strong>ã€ <strong>12</strong>ï¼Œæ–‡ä»¶ B ä½¿ç”¨äº†<strong>6</strong>ã€<strong>3</strong>ã€<strong>11</strong> å’Œ <strong>14</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶ <code>A</code> ä»åœ°å€ <code>4</code> å¤„å¼€å§‹ï¼Œé¡ºç€é“¾è¡¨èµ°å°±èƒ½æ‰¾åˆ°æ–‡ä»¶ <code>A</code> çš„å…¨éƒ¨ç£ç›˜å—ã€‚åŒæ ·ï¼Œä»ç¬¬ <code>6</code> å—å¼€å§‹ï¼Œé¡ºç€é“¾èµ°åˆ°æœ€åï¼Œä¹Ÿèƒ½å¤Ÿæ‰¾åˆ°æ–‡ä»¶ <code>B</code> çš„å…¨éƒ¨ç£ç›˜å—ã€‚è¿™ä¸¤ä¸ªé“¾è¡¨éƒ½ä»¥ä¸å±äºæœ‰æ•ˆç£ç›˜ç¼–å·çš„ç‰¹æ®Šæ ‡è®°ï¼ˆ-1ï¼‰ç»“æŸã€‚å†…å­˜ä¸­çš„è¿™ç§è¡¨æ ¼ç§°ä¸º <code>æ–‡ä»¶åˆ†é…è¡¨(File Application Table, FAT)</code>ã€‚</p><p>ä½¿ç”¨è¿™ç§ç»„ç»‡æ–¹å¼ï¼Œæ•´ä¸ªå—éƒ½å¯ä»¥å­˜æ”¾æ•°æ®ã€‚è¿›è€Œï¼Œéšæœºè®¿é—®ä¹Ÿå®¹æ˜“å¾ˆå¤šã€‚è™½ç„¶ä»è¦é¡ºç€é“¾åœ¨å†…å­˜ä¸­æŸ¥æ‰¾ç»™å®šçš„åç§»é‡ï¼Œä½†æ˜¯æ•´ä¸ªé“¾éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»»ä½•ç£ç›˜å¼•ç”¨ã€‚ä¸å‰é¢çš„æ–¹æ³•ç›¸åŒï¼Œä¸ç®¡æ–‡ä»¶æœ‰å¤šå¤§ï¼Œåœ¨ç›®å½•é¡¹ä¸­åªéœ€è®°å½•ä¸€ä¸ªæ•´æ•°ï¼ˆèµ·å§‹å—å·ï¼‰ï¼ŒæŒ‰ç…§å®ƒå°±å¯ä»¥æ‰¾åˆ°æ–‡ä»¶çš„å…¨éƒ¨å—ã€‚</p><p>è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºç‚¹ï¼Œé‚£å°±æ˜¯<strong>å¿…é¡»è¦æŠŠæ•´ä¸ªé“¾è¡¨æ”¾åœ¨å†…å­˜ä¸­</strong>ã€‚å¯¹äº 1TB çš„ç£ç›˜å’Œ 1KB çš„å¤§å°çš„å—ï¼Œé‚£ä¹ˆè¿™å¼ è¡¨éœ€è¦æœ‰ 10 äº¿é¡¹ã€‚æ¯ä¸€é¡¹å¯¹åº”äºè¿™ 10 äº¿ä¸ªç£ç›˜å—ä¸­çš„ä¸€å—ã€‚æ¯é¡¹è‡³å°‘ 3 ä¸ªå­—èŠ‚ï¼Œä¸ºäº†æé«˜æŸ¥æ‰¾é€Ÿåº¦ï¼Œæœ‰æ—¶éœ€è¦ 4 ä¸ªå­—èŠ‚ã€‚æ ¹æ®ç³»ç»Ÿå¯¹ç©ºé—´æˆ–æ—¶é—´çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œè¿™å¼ è¡¨è¦å ç”¨ 3GB æˆ– 2.4GB çš„å†…å­˜ã€‚FAT çš„ç®¡ç†æ–¹å¼ä¸èƒ½è¾ƒå¥½åœ°æ‰©å±•å¹¶åº”ç”¨äºå¤§å‹ç£ç›˜ä¸­ã€‚è€Œè¿™æ­£æ˜¯æœ€åˆ MS-DOS æ–‡ä»¶æ¯”è¾ƒå®ç”¨ï¼Œå¹¶ä»è¢«å„ä¸ª Windows ç‰ˆæœ¬æ‰€å®Œå…¨æ”¯æŒã€‚</p><h3 id="4-inode"><a class="markdownIt-Anchor" href="#4-inode"></a> 4. inode</h3><p>æœ€åä¸€ä¸ªè®°å½•å„ä¸ªæ–‡ä»¶åˆ†åˆ«åŒ…å«å“ªäº›ç£ç›˜å—çš„æ–¹æ³•æ˜¯ç»™æ¯ä¸ªæ–‡ä»¶èµ‹äºˆä¸€ä¸ªç§°ä¸º <code>inode(ç´¢å¼•èŠ‚ç‚¹)</code> çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½ä¸ä¸€ä¸ª <code>inode</code> è¿›è¡Œå…³è”ï¼Œ<code>inode</code> ç”±æ•´æ•°è¿›è¡Œæ ‡è¯†ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929150217.png" srcset="/img/loading.gif" alt="" /></p><p>ç»™å‡º <code>inode</code> çš„é•¿åº¦ï¼Œå°±èƒ½å¤Ÿæ‰¾åˆ°æ–‡ä»¶ä¸­çš„æ‰€æœ‰å—ã€‚</p><p>ç›¸å¯¹äºåœ¨å†…å­˜ä¸­ä½¿ç”¨è¡¨çš„æ–¹å¼è€Œè¨€ï¼Œè¿™ç§æœºåˆ¶å…·æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚å³<strong>åªæœ‰åœ¨æ–‡ä»¶æ‰“å¼€æ—¶ï¼Œå…¶ <code>inode</code> æ‰ä¼šåœ¨å†…å­˜ä¸­</strong>ã€‚å¦‚æœæ¯ä¸ª <code>inode</code> éœ€è¦ <code>n</code> ä¸ªå­—èŠ‚ï¼Œæœ€å¤š <code>k</code> ä¸ªæ–‡ä»¶åŒæ—¶æ‰“å¼€ï¼Œé‚£ä¹ˆ <code>inode</code> å æœ‰æ€»å…±æ‰“å¼€çš„æ–‡ä»¶æ˜¯ <code>kn</code> å­—èŠ‚ã€‚ä»…éœ€é¢„ç•™è¿™ä¹ˆå¤šç©ºé—´ã€‚</p><p>è¿™ä¸ªæ•°ç»„è¦æ¯”æˆ‘ä»¬ä¸Šé¢æè¿°çš„ <code>FAT(æ–‡ä»¶åˆ†é…è¡¨)</code> å ç”¨çš„ç©ºé—´å°çš„å¤šã€‚åŸå› æ˜¯<strong>ç”¨äºä¿å­˜æ‰€æœ‰ç£ç›˜å—çš„é“¾æ¥åˆ—è¡¨çš„è¡¨çš„å¤§å°ä¸ç£ç›˜æœ¬èº«æˆæ­£æ¯”</strong>ã€‚å¦‚æœç£ç›˜æœ‰ <code>n</code> ä¸ªå—ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨ä¹Ÿéœ€è¦ <code>n</code> é¡¹ã€‚éšç€ç£ç›˜ç©ºé—´çš„å˜å¤§ï¼Œé‚£ä¹ˆè¯¥è¡¨ä¹Ÿéšä¹‹çº¿æ€§å¢é•¿ã€‚ç›¸åï¼Œ<code>inode</code> éœ€è¦åœ¨å†…å­˜ä¸­æœ‰æ•°ç»„ï¼Œå…¶å¤§å°å’Œå¯èƒ½éœ€è¦æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶ä¸ªæ•°æˆæ­£æ¯”ã€‚å®ƒä¸ç£ç›˜æ˜¯ <code>100GB</code>ã€<code>4000GB</code> è¿˜æ˜¯ <code>10000GB</code> æ— å…³ã€‚</p><p><code>inode</code> çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚æœæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰å›ºå®šå¤§å°çš„ç£ç›˜åœ°å€ï¼Œé‚£ä¹ˆæ–‡ä»¶å¢é•¿åˆ°æ‰€èƒ½å…è®¸çš„æœ€å¤§å®¹é‡å¤–ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯<strong>æœ€åä¸€ä¸ªç£ç›˜åœ°å€ä¸æŒ‡å‘æ•°æ®å—</strong>ï¼Œè€Œæ˜¯æŒ‡å‘ä¸€ä¸ªåŒ…å«é¢å¤–ç£ç›˜å—åœ°å€çš„åœ°å€ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ä¸€ä¸ªæ›´é«˜çº§çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š<strong>æœ‰ä¸¤ä¸ªæˆ–è€…æ›´å¤šåŒ…å«ç£ç›˜åœ°å€çš„å—ï¼Œæˆ–è€…æŒ‡å‘å…¶ä»–å­˜æ”¾åœ°å€çš„ç£ç›˜å—çš„ç£ç›˜å—ã€‚</strong> <code>Windows</code> çš„ <code>NTFS</code> æ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨äº†ç›¸ä¼¼çš„æ–¹æ³•ï¼Œæ‰€ä¸åŒçš„ä»…ä»…æ˜¯å¤§çš„ <code>inode</code> ä¹Ÿå¯ä»¥è¡¨ç¤ºå°çš„æ–‡ä»¶ã€‚</p><blockquote><p><code>NTFS</code> çš„å…¨ç§°æ˜¯ <code>New Technology File System</code>ï¼Œæ˜¯å¾®è½¯å…¬å¸å¼€å‘çš„ä¸“ç”¨ç³»ç»Ÿæ–‡ä»¶ï¼Œ<code>NTFS</code> å–ä»£ <code>FAT(æ–‡ä»¶åˆ†é…è¡¨)</code> å’Œ <code>HPFS(é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿ)</code>ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥æ”¹è¿›ã€‚ä¾‹å¦‚å¢å¼ºå¯¹å…ƒæ•°æ®çš„æ”¯æŒï¼Œä½¿ç”¨æ›´é«˜çº§çš„æ•°æ®ç»“æ„ä»¥æå‡æ€§èƒ½ã€å¯é æ€§å’Œç£ç›˜ç©ºé—´åˆ©ç”¨ç‡ç­‰ã€‚</p></blockquote><h2 id="ç›®å½•çš„å®ç°"><a class="markdownIt-Anchor" href="#ç›®å½•çš„å®ç°"></a> ç›®å½•çš„å®ç°</h2><p>æ–‡ä»¶åªæœ‰æ‰“å¼€åæ‰èƒ½å¤Ÿè¢«è¯»å–ã€‚åœ¨æ–‡ä»¶æ‰“å¼€åï¼Œæ“ä½œç³»ç»Ÿä¼šä½¿ç”¨ç”¨æˆ·æä¾›çš„è·¯å¾„åæ¥å®šä½ç£ç›˜ä¸­çš„ç›®å½•ã€‚ç›®å½•é¡¹æä¾›äº†æŸ¥æ‰¾æ–‡ä»¶ç£ç›˜å—æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚æ ¹æ®ç³»ç»Ÿçš„ä¸åŒï¼Œæä¾›çš„ä¿¡æ¯ä¹Ÿä¸åŒï¼Œå¯èƒ½æä¾›çš„ä¿¡æ¯æ˜¯æ•´ä¸ªæ–‡ä»¶çš„ç£ç›˜åœ°å€ï¼Œæˆ–è€…æ˜¯ç¬¬ä¸€ä¸ªå—çš„æ•°é‡ï¼ˆä¸¤ä¸ªé“¾è¡¨æ–¹æ¡ˆï¼‰æˆ– inode çš„æ•°é‡ã€‚ä¸è¿‡ä¸ç®¡ç”¨å“ªç§æƒ…å†µï¼Œç›®å½•ç³»ç»Ÿçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯ <strong>å°†æ–‡ä»¶çš„ <code>ASCII</code> ç çš„åç§°æ˜ å°„åˆ°å®šä½æ•°æ®æ‰€éœ€çš„ä¿¡æ¯ä¸Šã€‚</strong></p><p>ä¸æ­¤å…³ç³»å¯†åˆ‡çš„é—®é¢˜æ˜¯å±æ€§åº”è¯¥å­˜æ”¾åœ¨å“ªé‡Œã€‚æ¯ä¸ªæ–‡ä»¶ç³»ç»ŸåŒ…å«ä¸åŒçš„æ–‡ä»¶å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œåˆ›å»ºæ—¶é—´ï¼Œéœ€è¦å­˜å‚¨çš„ä½ç½®ã€‚ä¸€ç§æ˜¾è€Œæ˜“è§çš„æ–¹æ³•æ˜¯ç›´æ¥æŠŠæ–‡ä»¶å±æ€§å­˜æ”¾åœ¨ç›®å½•ä¸­ã€‚æœ‰ä¸€äº›ç³»ç»Ÿæ°å¥½æ˜¯è¿™ä¹ˆåšçš„ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929151603.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨è¿™ç§ç®€å•çš„è®¾è®¡ä¸­ï¼Œç›®å½•æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„ç›®å½•é¡¹åˆ—è¡¨ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”ä¸€é¡¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ–‡ä»¶åï¼Œæ–‡ä»¶å±æ€§çš„ç»“æ„ä½“ä»¥åŠç”¨ä»¥è¯´æ˜ç£ç›˜å—ä½ç½®çš„ä¸€ä¸ªæˆ–å¤šä¸ªç£ç›˜åœ°å€ã€‚</p><p>å¯¹äºé‡‡ç”¨ <code>inode</code> çš„ç³»ç»Ÿï¼Œä¼šæŠŠ <code>inode</code> å­˜å‚¨åœ¨å±æ€§ä¸­è€Œä¸æ˜¯ç›®å½•é¡¹ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›®å½•é¡¹ä¼šæ›´çŸ­ï¼šä»…ä»…åªæœ‰æ–‡ä»¶åç§°å’Œ <code>inode</code> æ•°é‡ã€‚è¿™ç§æ–¹å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929151753.png" srcset="/img/loading.gif" alt="" /></p><h3 id="å¯å˜é•¿åº¦æ‰©å±•å"><a class="markdownIt-Anchor" href="#å¯å˜é•¿åº¦æ‰©å±•å"></a> å¯å˜é•¿åº¦æ‰©å±•å</h3><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å‡è®¾æ–‡ä»¶å…·æœ‰è¾ƒçŸ­çš„ã€å›ºå®šé•¿åº¦çš„åå­—ã€‚åœ¨ <code>MS-DOS</code> ä¸­ï¼Œå…·æœ‰ 1 - 8 ä¸ªå­—ç¬¦çš„åŸºæœ¬åç§°å’Œ 1 - 3 ä¸ªå­—ç¬¦çš„å¯æ‹“å±•åç§°ã€‚åœ¨ <code>UNIX</code> ç‰ˆæœ¬ 7 ä¸­ï¼Œæ–‡ä»¶æœ‰ 1 - 14 ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬ä»»ä½•æ‹“å±•ã€‚ç„¶è€Œï¼Œå‡ ä¹æ‰€æœ‰çš„ç°ä»£æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒå¯å˜é•¿åº¦çš„æ‰©å±•åã€‚è¿™æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</p><p>æœ€ç®€å•çš„æ–¹å¼æ˜¯ç»™äºˆæ–‡ä»¶åä¸€ä¸ªé•¿åº¦é™åˆ¶ï¼Œæ¯”å¦‚ 255 ä¸ªå­—ç¬¦ï¼Œç„¶åä½¿ç”¨ä¸Šå›¾ä¸­çš„è®¾è®¡ï¼Œå¹¶ä¸ºæ¯ä¸ªæ–‡ä»¶åä¿ç•™ 255 ä¸ªå­—ç¬¦ç©ºé—´ã€‚è¿™ç§å¤„ç†å¾ˆç®€å•ï¼Œä½†æ˜¯æµªè´¹äº†å¤§é‡çš„ç›®å½•ç©ºé—´ï¼Œå› ä¸ºåªæœ‰å¾ˆå°‘çš„æ–‡ä»¶ä¼šæœ‰é‚£ä¹ˆé•¿çš„æ–‡ä»¶åç§°ã€‚æ‰€ä»¥ï¼Œéœ€è¦ä¸€ç§å…¶ä»–çš„ç»“æ„æ¥å¤„ç†ã€‚</p><p>ä¸€ç§å¯é€‰æ‹©çš„æ–¹å¼æ˜¯æ”¾å¼ƒæ‰€æœ‰ç›®å½•é¡¹å¤§å°ç›¸åŒçš„æƒ³æ³•ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªç›®å½•é¡¹éƒ½åŒ…å«ä¸€ä¸ªå›ºå®šéƒ¨åˆ†ï¼Œè¿™ä¸ªå›ºå®šéƒ¨åˆ†é€šå¸¸ä»¥ç›®å½•é¡¹çš„é•¿åº¦å¼€å§‹ï¼Œåé¢æ˜¯å›ºå®šæ ¼å¼çš„æ•°æ®ï¼Œé€šå¸¸åŒ…æ‹¬æ‰€æœ‰è€…ã€åˆ›å»ºæ—¶é—´ã€ä¿æŠ¤ä¿¡æ¯å’Œå…¶ä»–å±æ€§ã€‚è¿™ä¸ªå›ºå®šé•¿åº¦çš„å¤´çš„åé¢æ˜¯ä¸€ä¸ªä»»æ„é•¿åº¦çš„å®é™…æ–‡ä»¶åï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929151951.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ <code>project-budget</code>ã€<code>personnel</code> å’Œ <code>foo</code>ã€‚æ¯ä¸ªæ–‡ä»¶åä»¥ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼ˆé€šå¸¸æ˜¯ 0 ï¼‰ç»“æŸï¼Œç”¨çŸ©å½¢ä¸­çš„å‰è¿›è¡Œè¡¨ç¤ºã€‚ä¸ºäº†ä½¿æ¯ä¸ªç›®å½•é¡¹ä»å­—çš„è¾¹ç•Œå¼€å§‹ï¼Œæ¯ä¸ªæ–‡ä»¶åè¢«å¡«å……æˆæ•´æ•°ä¸ªå­—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929152139.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¸ªæ–¹æ³•çš„ç¼ºç‚¹æ˜¯å½“æ–‡ä»¶è¢«ç§»é™¤åï¼Œå°±ä¼šç•™ä¸‹ä¸€å—å›ºå®šé•¿åº¦çš„ç©ºé—´ï¼Œè€Œæ–°æ·»åŠ è¿›æ¥çš„æ–‡ä»¶å¤§å°ä¸ä¸€å®šå’Œç©ºé—²ç©ºé—´å¤§å°ä¸€è‡´ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929152203.png" srcset="/img/loading.gif" alt="" /></p><p>è¿™ä¸ªé—®é¢˜ä¸æˆ‘ä»¬ä¸Šé¢æ¢è®¨çš„è¿ç»­ç£ç›˜æ–‡ä»¶çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œç”±äºæ•´ä¸ªç›®å½•åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥åªæœ‰å¯¹ç›®å½•è¿›è¡Œ<strong>ç´§å‡‘æ‹¼æ¥</strong>æ“ä½œæ‰å¯èŠ‚çœç©ºé—´ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸€ä¸ªç›®å½•é¡¹å¯èƒ½ä¼šåˆ†å¸ƒåœ¨å¤šä¸ªé¡µä¸Šï¼Œåœ¨è¯»å–æ–‡ä»¶åæ—¶å¯èƒ½å‘ç”Ÿ<strong>ç¼ºé¡µä¸­æ–­</strong>ã€‚</p><p>å¤„ç†å¯å˜é•¿åº¦æ–‡ä»¶åå­—çš„å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯ï¼Œ<strong>ä½¿ç›®å½•é¡¹è‡ªèº«å…·æœ‰å›ºå®šé•¿åº¦ï¼Œè€Œå°†æ–‡ä»¶åæ”¾åœ¨ç›®å½•æœ«å°¾çš„å †æ ˆä¸­ã€‚</strong> å¦‚ä¸Šå›¾æ‰€ç¤ºçš„è¿™ç§æ–¹å¼ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å½“ç›®å½•é¡¹è¢«ç§»é™¤åï¼Œä¸‹ä¸€ä¸ªæ–‡ä»¶å°†èƒ½å¤Ÿæ­£å¸¸åŒ¹é…ç§»é™¤æ–‡ä»¶çš„ç©ºé—´ã€‚å½“ç„¶ï¼Œå¿…é¡»è¦å¯¹å †è¿›è¡Œç®¡ç†ï¼Œå› ä¸ºåœ¨å¤„ç†æ–‡ä»¶åçš„æ—¶å€™ä¹Ÿä¼šå‘ç”Ÿç¼ºé¡µå¼‚å¸¸ã€‚</p><h3 id="åŠ å¿«æ–‡ä»¶æŸ¥æ‰¾"><a class="markdownIt-Anchor" href="#åŠ å¿«æ–‡ä»¶æŸ¥æ‰¾"></a> åŠ å¿«æ–‡ä»¶æŸ¥æ‰¾</h3><p>åˆ°ç›®å‰ä¸ºæ­¢çš„æ‰€æœ‰è®¾è®¡ä¸­ï¼Œåœ¨éœ€è¦æŸ¥æ‰¾æ–‡ä»¶åæ—¶ï¼Œæ‰€æœ‰çš„æ–¹æ¡ˆéƒ½æ˜¯çº¿æ€§çš„ä»å¤´åˆ°å°¾å¯¹ç›®å½•è¿›è¡Œæœç´¢ã€‚å¯¹äºç‰¹åˆ«é•¿çš„ç›®å½•ï¼Œçº¿æ€§æœç´¢çš„æ•ˆç‡å¾ˆä½ã€‚æé«˜æ–‡ä»¶æ£€ç´¢æ•ˆç‡çš„ä¸€ç§æ–¹å¼æ˜¯åœ¨æ¯ä¸ªç›®å½•ä¸Šä½¿ç”¨ <code>å“ˆå¸Œè¡¨(hash table)</code>ã€‚</p><ul><li><p>æ·»åŠ ï¼šæ— è®ºé‡‡ç”¨å“ªç§æ–¹å¼ï¼Œ<strong>åœ¨æ·»åŠ ä¸€ä¸ªæ–‡ä»¶æ—¶éƒ½è¦å¯¹ä¸æ•£åˆ—å€¼ç›¸å¯¹ åº”çš„æ•£åˆ—è¡¨è¿›è¡Œæ£€æŸ¥ã€‚</strong> å¦‚æœæ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œå°±ä¼šå°†ä¸€ä¸ªæŒ‡å‘ç›®å½•é¡¹çš„æŒ‡é’ˆæŒ‡å‘è¿™é‡Œã€‚æ–‡ä»¶ç›®å½•é¡¹ç´§è·Ÿç€å“ˆå¸Œè¡¨åé¢ã€‚å¦‚æœå·²ç»ä½¿ç”¨è¿‡ï¼Œå°±ä¼šæ„é€ ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨çš„è¡¨å¤´æŒ‡é’ˆå­˜æ”¾åœ¨è¡¨é¡¹ä¸­ï¼Œå¹¶é€šè¿‡å“ˆå¸Œå€¼å°†æ‰€æœ‰çš„è¡¨é¡¹ç›¸è¿ã€‚</p></li><li><p>æŸ¥æ‰¾ï¼šæŸ¥æ‰¾æ–‡ä»¶çš„è¿‡ç¨‹å’Œæ·»åŠ ç±»ä¼¼ï¼Œé¦–å…ˆå¯¹æ–‡ä»¶åè¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œåœ¨å“ˆå¸Œè¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰è¿™ä¸ªå“ˆå¸Œå€¼ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±æ£€æŸ¥è¿™æ¡é“¾ä¸Šæ‰€æœ‰çš„å“ˆå¸Œé¡¹ï¼ŒæŸ¥çœ‹æ–‡ä»¶åæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå“ˆå¸Œä¸åœ¨é“¾ä¸Šï¼Œé‚£ä¹ˆæ–‡ä»¶å°±ä¸åœ¨ç›®å½•ä¸­ã€‚</p></li></ul><p>ä½¿ç”¨å“ˆå¸Œè¡¨çš„ä¼˜åŠ¿æ˜¯æŸ¥æ‰¾éå¸¸è¿…é€Ÿï¼Œç¼ºç‚¹æ˜¯ç®¡ç†èµ·æ¥éå¸¸å¤æ‚ã€‚åªæœ‰åœ¨ç³»ç»Ÿä¸­ä¼šæœ‰æˆåƒä¸Šä¸‡ä¸ªç›®å½•é¡¹å­˜åœ¨æ—¶ï¼Œæ‰ä¼šè€ƒè™‘ä½¿ç”¨æ•£åˆ—è¡¨ä½œä¸ºè§£å†³æ–¹æ¡ˆã€‚</p><p>å¦å¤–ä¸€ç§åœ¨å¤§é‡ç›®å½•ä¸­åŠ å¿«æŸ¥æ‰¾æŒ‡ä»¤ç›®å½•çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>ç¼“å­˜</code>ï¼Œç¼“å­˜æŸ¥æ‰¾çš„ç»“æœã€‚åœ¨å¼€å§‹æŸ¥æ‰¾ä¹‹å‰ï¼Œä¼šé¦–å…ˆæ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åœ¨ç¼“å­˜ä¸­ã€‚å¦‚æœåœ¨ç¼“å­˜ä¸­ï¼Œé‚£ä¹ˆæ–‡ä»¶å°±èƒ½ç«‹åˆ»å®šä½ã€‚å½“ç„¶ï¼Œåªæœ‰åœ¨è¾ƒå°‘çš„æ–‡ä»¶ä¸‹è¿›è¡Œå¤šæ¬¡æŸ¥æ‰¾ï¼Œç¼“å­˜æ‰ä¼šå‘æŒ¥æœ€å¤§åŠŸæ•ˆã€‚</p><h2 id="å…±äº«æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å…±äº«æ–‡ä»¶"></a> å…±äº«æ–‡ä»¶</h2><p>å½“å¤šä¸ªç”¨æˆ·åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­å·¥ä½œæ—¶ï¼Œä»–ä»¬é€šå¸¸éœ€è¦å…±äº«æ–‡ä»¶ã€‚å¦‚æœè¿™ä¸ªå…±äº«æ–‡ä»¶åŒæ—¶å‡ºç°åœ¨å¤šä¸ªç”¨æˆ·ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆä»–ä»¬ååŒå·¥ä½œèµ·æ¥å°±å¾ˆæ–¹ä¾¿ã€‚ä¸‹é¢çš„è¿™å¼ å›¾æˆ‘ä»¬åœ¨ä¸Šé¢æåˆ°è¿‡ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ›´æ”¹çš„åœ°æ–¹ï¼Œå°±æ˜¯ <code>C</code> çš„ä¸€ä¸ªæ–‡ä»¶ä¹Ÿå‡ºç°åœ¨äº† <code>B</code> çš„ç›®å½•ä¸‹ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929153128.png" srcset="/img/loading.gif" alt="" /></p><p>å¦‚æœæŒ‰ç…§å¦‚ä¸Šå›¾çš„è¿™ç§ç»„ç»‡æ–¹å¼è€Œè¨€ï¼Œé‚£ä¹ˆ <code>B</code> çš„ç›®å½•ä¸è¯¥å…±äº«æ–‡ä»¶çš„è”ç³»ç§°ä¸º <code>é“¾æ¥(link)</code>ã€‚é‚£ä¹ˆæ–‡ä»¶ç³»ç»Ÿç°åœ¨å°±æ˜¯ä¸€ä¸ª <code>æœ‰å‘æ— ç¯å›¾(Directed Acyclic Graph, ç®€ç§° DAG)</code>ï¼Œè€Œä¸æ˜¯ä¸€æ£µæ ‘äº†ã€‚</p><p>å°†æ–‡ä»¶ç³»ç»Ÿç»„ç»‡æˆä¸ºæœ‰å‘æ— ç¯å›¾ä¼šä½¿å¾—ç»´æŠ¤å¤æ‚åŒ–ï¼Œä½†ä¹Ÿæ˜¯å¿…é¡»è¦ä»˜å‡ºçš„ä»£ä»·ã€‚</p><p>å…±äº«æ–‡ä»¶å¾ˆæ–¹ä¾¿ï¼Œä½†è¿™ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ã€‚<strong>å¦‚æœç›®å½•ä¸­åŒ…å«ç£ç›˜åœ°å€ï¼Œåˆ™å½“é“¾æ¥æ–‡ä»¶æ—¶ï¼Œå¿…é¡»æŠŠ <code>C</code> ç›®å½•ä¸­çš„ç£ç›˜åœ°å€å¤åˆ¶åˆ° <code>B</code> ç›®å½•ä¸­ã€‚</strong> å¦‚æœ <code>B</code> æˆ–è€… <code>C</code> éšååˆå‘æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ï¼Œåˆ™ä»…åœ¨æ‰§è¡Œè¿½åŠ çš„ç”¨æˆ·çš„ç›®å½•ä¸­æ˜¾ç¤ºæ–°å†™å…¥çš„æ•°æ®å—ã€‚è¿™ç§å˜æ›´å°†ä¼šå¯¹å…¶ä»–ç”¨æˆ·ä¸å¯è§ï¼Œä»è€Œç ´åäº†å…±äº«çš„ç›®çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929153402.png" srcset="/img/loading.gif" alt="" /></p><p>æœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä»¥è§£å†³è¿™ç§é—®é¢˜ã€‚</p><ul><li><p>ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œ<strong>ç£ç›˜å—ä¸åˆ—å…¥ç›®å½•ä¸­</strong>ï¼Œè€Œæ˜¯ä¼šæŠŠç£ç›˜å—æ”¾åœ¨ä¸æ–‡ä»¶æœ¬èº«ç›¸å…³è”çš„ <code>inode</code> ä¸­ã€‚ç›®å½•å°†æŒ‡å‘è¿™ä¸ª <code>inode</code>ã€‚è¿™æ˜¯ <code>UNIX</code> ä¸­ä½¿ç”¨çš„æ–¹å¼ã€‚</p></li><li><p>åœ¨ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œé€šè¿‡è®©ç³»ç»Ÿå»ºç«‹ä¸€ä¸ªç±»å‹ä¸º <code>LINK</code> çš„æ–°æ–‡ä»¶ï¼Œå¹¶æŠŠè¯¥æ–‡ä»¶æ”¾åœ¨ <code>B</code> çš„ç›®å½•ä¸‹ï¼Œä½¿å¾— <code>B</code> ä¸ <code>C</code> å»ºç«‹é“¾æ¥ã€‚æ–°çš„æ–‡ä»¶ä¸­åªåŒ…å«äº†å®ƒæ‰€é“¾æ¥çš„æ–‡ä»¶çš„è·¯å¾„åã€‚å½“ <code>B</code> æƒ³è¦è¯»å–æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ£€æŸ¥ <code>B</code> çš„ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªç±»å‹ä¸º <code>LINK</code> çš„æ–‡ä»¶ï¼Œè¿›è€Œæ‰¾åˆ°è¯¥é“¾æ¥çš„æ–‡ä»¶å’Œè·¯å¾„åï¼Œç„¶åå†å»è¯»æ–‡ä»¶ï¼Œè¿™ç§æ–¹å¼ç§°ä¸º <code>ç¬¦å·é“¾æ¥(symbolic linking)</code>ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929153627.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ"></a> æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ</h2><p><code>æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿ(Log-structured File System, LFS)</code> æ—¨åœ¨è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><p>ä¸æ–­å¢é•¿çš„ç³»ç»Ÿå†…å­˜</p></li><li><p>é¡ºåº <code>I/O</code> æ€§èƒ½èƒœè¿‡éšæœº <code>I/O</code> æ€§èƒ½</p></li><li><p>ç°æœ‰ä½æ•ˆç‡çš„æ–‡ä»¶ç³»ç»Ÿ</p></li><li><p>æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒ <code>RAIDï¼ˆè™šæ‹ŸåŒ–ï¼‰</code></p></li></ul><p>ä¸è®ºæ˜¯ <code>UNIX</code> è¿˜æ˜¯ <code>FFS</code>ï¼Œéƒ½æœ‰å¤§é‡çš„éšæœºè¯»å†™ï¼Œå› æ­¤æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚åŒæ—¶å› ä¸º <code>Page cache</code> çš„å­˜åœ¨ï¼Œä½œè€…è®¤ä¸ºéšæœºè¯»ä¸æ˜¯ä¸»è¦é—®é¢˜ï¼šéšç€è¶Šæ¥è¶Šå¤§çš„å†…å­˜ï¼Œå¤§éƒ¨åˆ†çš„è¯»æ“ä½œéƒ½èƒ½è¢« <code>cache</code>ï¼Œå› æ­¤ <code>LFS</code> ä¸»è¦è¦è§£å†³çš„æ˜¯<strong>å‡å°‘å¯¹ç¡¬ç›˜çš„éšæœºå†™æ“ä½œ</strong>ã€‚</p><p>åœ¨è¿™ç§è®¾è®¡ä¸­ï¼Œ<code>inode</code> ç”šè‡³å…·æœ‰ä¸ <code>UNIX</code> ä¸­ç›¸åŒçš„ç»“æ„ï¼Œä½†æ˜¯ç°åœ¨å®ƒä»¬åˆ†æ•£åœ¨æ•´ä¸ªæ—¥å¿—ä¸­ï¼Œè€Œä¸æ˜¯ä½äºç£ç›˜ä¸Šçš„å›ºå®šä½ç½®ã€‚æ‰€ä»¥ï¼Œ<code>inode</code> å¾ˆéš¾å®šä½ã€‚ä¸ºäº†èƒ½å¤Ÿæ‰¾åˆ° <code>inode</code> ï¼Œç»´æŠ¤äº†ä¸€ä¸ªç”± <code>inode</code> ç´¢å¼•çš„ <code>inode map</code>ã€‚è¡¨é¡¹ <code>i</code> æŒ‡å‘ç£ç›˜ä¸­çš„ç¬¬ <code>i</code> ä¸ª <code>inode</code>ã€‚è¿™ä¸ªæ˜ å°„ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œä½†æ˜¯ä¹Ÿä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼Œå› æ­¤ï¼Œä½¿ç”¨æœ€é¢‘ç¹çš„éƒ¨åˆ†å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨å†…å­˜ä¸­ã€‚</p><blockquote><p>æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿä¸»è¦ä½¿ç”¨å››ç§æ•°æ®ç»“æ„ï¼š<code>Inode</code>ã€<code>Inode Map</code>ã€<code>Segment</code>ã€<code>Segment Usage Table</code>ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929160054.png" srcset="/img/loading.gif" alt="" /></p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‰€æœ‰å†™å…¥æœ€åˆéƒ½ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”è¿½åŠ åœ¨æ—¥å¿—æœ«å°¾ï¼Œæ‰€æœ‰ç¼“å­˜çš„å†™å…¥éƒ½å®šæœŸåœ¨å•ä¸ªæ®µä¸­å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥ï¼Œç°åœ¨æ‰“å¼€æ–‡ä»¶ä¹Ÿå°±æ„å‘³ç€ç”¨æ˜ å°„å®šä½æ–‡ä»¶çš„ç´¢å¼•èŠ‚ç‚¹ã€‚ä¸€æ—¦ inode è¢«å®šä½åï¼Œç£ç›˜å—çš„åœ°å€å°±èƒ½å¤Ÿè¢«æ‰¾åˆ°ã€‚æ‰€æœ‰è¿™äº›å—æœ¬èº«éƒ½å°†ä½äºæ—¥å¿—ä¸­æŸå¤„çš„åˆ†æ®µä¸­ã€‚</p><p>çœŸå®æƒ…å†µä¸‹çš„ç£ç›˜å®¹é‡æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥æœ€ç»ˆæ—¥å¿—ä¼šå æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´ï¼Œè¿™ç§æƒ…å†µä¸‹å°±ä¼šå‡ºç°æ²¡æœ‰æ–°çš„ç£ç›˜å—è¢«å†™å…¥åˆ°æ—¥å¿—ä¸­ã€‚å¹¸è¿çš„æ˜¯ï¼Œè®¸å¤šç°æœ‰æ®µå¯èƒ½å…·æœ‰ä¸å†éœ€è¦çš„å—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶è¢«è¦†ç›–äº†ï¼Œé‚£ä¹ˆå®ƒçš„ <code>inode</code> å°†è¢«æŒ‡å‘æ–°çš„å—ï¼Œä½†æ˜¯æ—§çš„ç£ç›˜å—ä»åœ¨å…ˆå‰å†™å…¥çš„æ®µä¸­å æ®ç€ç©ºé—´ã€‚</p><p>ä¸ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜ï¼ŒLFS æœ‰ä¸€ä¸ª <code>æ¸…ç†ï¼ˆcleanï¼‰çº¿ç¨‹</code>ï¼Œ<strong>å®ƒä¼šå¾ªç¯æ‰«ææ—¥å¿—å¹¶å¯¹æ—¥å¿—è¿›è¡Œå‹ç¼©</strong>ã€‚é¦–å…ˆï¼Œé€šè¿‡æŸ¥çœ‹æ—¥å¿—ä¸­ç¬¬ä¸€éƒ¨åˆ†çš„ä¿¡æ¯æ¥æŸ¥çœ‹å…¶ä¸­å­˜åœ¨å“ªäº›ç´¢å¼•èŠ‚ç‚¹å’Œæ–‡ä»¶ã€‚å®ƒä¼šæ£€æŸ¥å½“å‰ <code>inode</code> çš„æ˜ å°„æ¥æŸ¥çœ‹ <code>inode</code> å¦åœ¨å½“å‰å—ä¸­ï¼Œæ˜¯å¦ä»åœ¨è¢«ä½¿ç”¨ã€‚å¦‚æœä¸æ˜¯ï¼Œè¯¥ä¿¡æ¯å°†è¢«ä¸¢å¼ƒã€‚å¦‚æœä»ç„¶åœ¨ä½¿ç”¨ï¼Œé‚£ä¹ˆ <code>inode</code> å’Œå—å°±ä¼šè¿›å…¥å†…å­˜ç­‰å¾…å†™å›åˆ°ä¸‹ä¸€ä¸ªæ®µä¸­ã€‚ç„¶ååŸæ¥çš„æ®µè¢«æ ‡è®°ä¸ºç©ºé—²ï¼Œä»¥ä¾¿æ—¥å¿—å¯ä»¥ç”¨æ¥å­˜æ”¾æ–°çš„æ•°æ®ã€‚ç”¨è¿™ç§æ–¹æ³•ï¼Œæ¸…ç†çº¿ç¨‹éå†æ—¥å¿—ï¼Œä»åé¢ç§»èµ°æ—§çš„æ®µï¼Œç„¶åå°†æœ‰æ•ˆçš„æ•°æ®æ”¾å…¥å†…å­˜ç­‰å¾…å†™åˆ°ä¸‹ä¸€ä¸ªæ®µä¸­ã€‚ç”±æ­¤ä¸€æ¥æ•´ä¸ªç£ç›˜ä¼šå½¢æˆä¸€ä¸ªå¤§çš„ç¯å½¢ç¼“å†²åŒºï¼Œå†™çº¿ç¨‹å°†æ–°çš„æ®µå†™åœ¨å‰é¢ï¼Œè€Œæ¸…ç†çº¿ç¨‹åˆ™æ¸…ç†åé¢çš„æ®µã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929160520.png" srcset="/img/loading.gif" alt="" /></p><h2 id="æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ"></a> æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿ</h2><p>è™½ç„¶æ—¥å¿—ç»“æ„ç³»ç»Ÿçš„è®¾è®¡å¾ˆä¼˜é›…ï¼Œä½†æ˜¯ç”±äºå®ƒä»¬å’Œç°æœ‰çš„æ–‡ä»¶ç³»ç»Ÿä¸ç›¸åŒ¹é…ï¼Œå› æ­¤è¿˜æ²¡æœ‰å¹¿æ³›ä½¿ç”¨ã€‚ä¸è¿‡ï¼Œä»æ—¥å¿—æ–‡ä»¶ç»“æ„ç³»ç»Ÿè¡ç”Ÿå‡ºæ¥ä¸€ç§æ–°çš„æ—¥å¿—ç³»ç»Ÿï¼Œå«åšæ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä¼šä¿å­˜ä¸€ä¸ªç³»ç»Ÿä¸‹ä¸€æ­¥å°†è¦åšä»€ä¹ˆçš„æ—¥å¿—ã€‚å¾®è½¯çš„ <code>NTFS</code> æ–‡ä»¶ç³»ç»Ÿã€<code>Linux</code> çš„ <code>ext3</code> å°±ä½¿ç”¨äº†æ—¥å¿—ã€‚ <code>OS X</code> å°†æ—¥å¿—ç³»ç»Ÿä½œä¸ºå¯ä¾›é€‰é¡¹ã€‚ä¸ºäº†çœ‹æ¸…å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬ä¸‹é¢è®¨è®ºä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ <code>ç§»é™¤æ–‡ä»¶</code>ï¼Œè¿™ä¸ªæ“ä½œåœ¨ <code>UNIX</code> ä¸­éœ€è¦ä¸‰ä¸ªæ­¥éª¤å®Œæˆï¼š</p><ol><li>åœ¨ç›®å½•ä¸­åˆ é™¤æ–‡ä»¶</li><li>é‡Šæ”¾ <code>inode</code> åˆ°ç©ºé—² <code>inode</code> æ± </li><li>å°†æ‰€æœ‰ç£ç›˜å—å½’è¿˜ç»™ç©ºé—²ç£ç›˜æ± ã€‚</li></ol><p>ä¸ºäº†è®©æ—¥å¿—èƒ½å¤Ÿæ­£ç¡®å·¥ä½œï¼Œè¢«å†™å…¥çš„æ—¥å¿—æ“ä½œå¿…é¡»æ˜¯ <code>å¹‚ç­‰çš„(idempotent)</code>ï¼Œå®ƒæ„å‘³ç€åªè¦æœ‰å¿…è¦ï¼Œå®ƒä»¬å°±å¯ä»¥é‡å¤æ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œå¹¶ä¸ä¼šå¸¦æ¥ç ´åã€‚åƒæ“ä½œ <code>æ›´æ–°ä½è¡¨å¹¶æ ‡è®° inode k æˆ–è€…å— n æ˜¯ç©ºé—²çš„</code> å¯ä»¥é‡å¤æ‰§è¡Œä»»æ„æ¬¡ã€‚åŒæ ·åœ°ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªç›®å½•å¹¶ä¸”åˆ é™¤æ‰€æœ‰å« foobar çš„é¡¹ä¹Ÿæ˜¯å¹‚ç­‰çš„ã€‚ç›¸åï¼ŒæŠŠä» inode k æ–°é‡Šæ”¾çš„å—åŠ å…¥ç©ºé—²è¡¨çš„æœ«ç«¯ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å·²ç»è¢«é‡Šæ”¾å¹¶å­˜æ”¾åœ¨é‚£é‡Œäº†ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929161137.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸ºäº†å¢åŠ å¯é æ€§ï¼Œä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå¯ä»¥å¼•å…¥æ•°æ®åº“ä¸­ <code>åŸå­äº‹åŠ¡(atomic transaction)</code> çš„æ¦‚å¿µã€‚ä½¿ç”¨è¿™ä¸ªæ¦‚å¿µï¼Œä¸€ç»„åŠ¨ä½œå¯ä»¥è¢«ç•Œå®šåœ¨å¼€å§‹äº‹åŠ¡å’Œç»“æŸäº‹åŠ¡æ“ä½œä¹‹é—´ã€‚è¿™æ ·ï¼Œæ–‡ä»¶ç³»ç»Ÿå°±ä¼šçŸ¥é“å®ƒå¿…é¡»å®Œæˆæ‰€æœ‰çš„åŠ¨ä½œï¼Œè¦ä¹ˆå°±ä¸€ä¸ªä¸åšã€‚</p><h2 id="è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ"></a> è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</h2><p>å³ä½¿åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šæˆ–è€…åœ¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸‹ï¼Œéƒ½ä¼šä½¿ç”¨å¾ˆå¤šä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚Windows ä¸­çš„ä¸»è¦æ–‡ä»¶ç³»ç»Ÿæ˜¯ NTFS æ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä¸æ˜¯è¯´ Windows åªæœ‰ NTFS æ“ä½œç³»ç»Ÿï¼Œå®ƒè¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä¾‹å¦‚æ—§çš„ FAT -32 æˆ– FAT -16 é©±åŠ¨å™¨æˆ–åˆ†åŒºï¼Œå…¶ä¸­åŒ…å«ä»éœ€è¦çš„æ•°æ®ï¼Œé—ªå­˜é©±åŠ¨å™¨ï¼Œæ—§çš„ CD-ROM æˆ– DVDï¼ˆæ¯ä¸ªéƒ½æœ‰è‡ªå·±çš„ç‹¬ç‰¹æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚<strong>Windows é€šè¿‡æŒ‡å®šä¸åŒçš„ç›˜ç¬¦æ¥å¤„ç†è¿™äº›ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œæ¯”å¦‚ <code>C:</code>ï¼Œ<code>D:</code> ç­‰ã€‚ç›˜ç¬¦å¯ä»¥æ˜¾ç¤ºå­˜åœ¨ä¹Ÿå¯ä»¥éšå¼å­˜åœ¨ï¼Œå¦‚æœä½ æƒ³æ‰¾æŒ‡å®šä½ç½®çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆç›˜ç¬¦æ˜¯æ˜¾ç¤ºå­˜åœ¨ï¼›å¦‚æœå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ­¤æ—¶ç›˜ç¬¦æ˜¯éšå¼å­˜åœ¨ï¼Œæ‰€ä»¥ Windows çŸ¥é“å‘å“ªä¸ªæ–‡ä»¶ç³»ç»Ÿä¼ é€’è¯·æ±‚ã€‚</p><p><code>UNIX</code> é‡‡ç”¨äº†ä¸€ç§ä¸åŒçš„æ–¹å¼ï¼Œå³ <strong><code>UNIX</code> æŠŠå¤šç§æ–‡ä»¶ç³»ç»Ÿæ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„ç»“æ„ä¸­</strong>ã€‚ä¸€ä¸ª <code>Linux</code> ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ ext2 ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œext3 åˆ†åŒºè£…è½½åœ¨ /usr ä¸‹ï¼Œå¦ä¸€å—é‡‡ç”¨ Reiser FS æ–‡ä»¶ç³»ç»Ÿçš„ç¡¬ç›˜è£…è½½åˆ° /homeä¸‹ï¼Œä»¥åŠä¸€ä¸ª ISO 9660 çš„ CD - ROM ä¸´æ—¶è£…è½½åˆ° /mnt ä¸‹ã€‚ä»ç”¨æˆ·çš„è§‚ç‚¹æ¥çœ‹ï¼Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå±‚çº§ï¼Œä½†æ˜¯äº‹å®ä¸Šå®ƒä»¬æ˜¯ç”±å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿç»„åˆè€Œæˆï¼Œ<strong>å¯¹äºç”¨æˆ·å’Œè¿›ç¨‹æ˜¯ä¸å¯è§çš„</strong>ã€‚</p><p><code>UNIX</code> æ“ä½œç³»ç»Ÿä½¿ç”¨ä¸€ç§ <code>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ(Virtual File System, VFS)</code> æ¥å°è¯•å°†å¤šç§æ–‡ä»¶ç³»ç»Ÿæ„æˆä¸€ä¸ªæœ‰åºçš„ç»“æ„ã€‚å…³é”®çš„æ€æƒ³æ˜¯<strong>æŠ½è±¡å‡ºæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿéƒ½å…±æœ‰çš„éƒ¨åˆ†ï¼Œå¹¶å°†è¿™éƒ¨åˆ†ä»£ç æ”¾åœ¨ä¸€å±‚ï¼Œè¿™ä¸€å±‚å†è°ƒç”¨å…·ä½“æ–‡ä»¶ç³»ç»Ÿæ¥ç®¡ç†æ•°æ®ã€‚</strong> ä¸‹é¢æ˜¯ä¸€ä¸ª <code>VFS</code> çš„ç³»ç»Ÿç»“æ„ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200929161745.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰€æœ‰å’Œæ–‡ä»¶ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨åœ¨æœ€åˆçš„å¤„ç†ä¸Šéƒ½æŒ‡å‘è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚è¿™äº›æ¥è‡ªç”¨æˆ·è¿›ç¨‹çš„è°ƒç”¨ï¼Œéƒ½æ˜¯æ ‡å‡†çš„ <code>POSIX</code> ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚ <code>open</code>ã€<code>read</code>ã€<code>write</code> å’Œ <code>seek</code> ç­‰ã€‚VFS å¯¹ç”¨æˆ·è¿›ç¨‹æœ‰ä¸€ä¸ª <code>ä¸Šå±‚</code> æ¥å£ï¼Œè¿™ä¸ªæ¥å£å°±æ˜¯è‘—åçš„ <code>POSIX</code> æ¥å£ã€‚</p><p><code>VFS</code> ä¹Ÿæœ‰ä¸€ä¸ªå¯¹äºå®é™…æ–‡ä»¶çš„ <code>ä¸‹å±‚</code> æ¥å£ï¼Œå°±æ˜¯ä¸Šå›¾ä¸­æ ‡è®°ä¸º <code>VFS</code> çš„æ¥å£ã€‚è¿™ä¸ªæ¥å£åŒ…å«è®¸å¤š<strong>åŠŸèƒ½è°ƒç”¨</strong>ï¼Œè¿™æ · <code>VFS</code> å¯ä»¥ä½¿æ¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå®Œæˆä»»åŠ¡ã€‚å› æ­¤ï¼Œè¦åˆ›å»ºä¸€ä¸ªå¯ä»¥ä¸ <code>VFS</code> ä¸€èµ·ä½¿ç”¨çš„æ–°æ–‡ä»¶ç³»ç»Ÿï¼Œæ–°æ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡è€…å¿…é¡»ç¡®ä¿å®ƒæä¾›äº† <code>VFS</code> è¦æ±‚çš„åŠŸèƒ½ã€‚ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å­æ˜¯ä»ç£ç›˜è¯»å–ç‰¹å®šçš„å—ï¼Œç„¶åå°†å…¶æ”¾å…¥æ–‡ä»¶ç³»ç»Ÿçš„ç¼“å†²åŒºé«˜é€Ÿç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›æŒ‡å‘è¯¥å—çš„æŒ‡é’ˆçš„å‡½æ•°ã€‚ å› æ­¤ï¼Œ<code>VFS</code> å…·æœ‰ä¸¤ä¸ªä¸åŒçš„æ¥å£ï¼š<strong>ä¸Šä¸€ä¸ªåˆ°ç”¨æˆ·è¿›ç¨‹ï¼Œä¸‹ä¸€ä¸ªåˆ°å…·ä½“æ–‡ä»¶ç³»ç»Ÿ</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 978. æœ€é•¿æ¹æµå­æ•°ç»„</title>
    <link href="/2020/09/27/LeetCode-978-longest-turbulent-subarray/"/>
    <url>/2020/09/27/LeetCode-978-longest-turbulent-subarray/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-turbulent-subarray/" target="_blank" rel="noopener">978. æœ€é•¿æ¹æµå­æ•°ç»„</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxTurbulenceSize</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A)</span> </span>&#123;    <span class="hljs-comment">// [9,4,2,10,7,8,8,1,9]</span>    <span class="hljs-comment">// dp[i]: ä»¥ç¬¬ i ä¸ªå…ƒç´ ç»“å°¾çš„æœ€å¤§å­æ•°ç»„é•¿åº¦</span>    <span class="hljs-comment">/*</span><span class="hljs-comment">      if A[i] == A[i - 1]</span><span class="hljs-comment">        dp[i] = 1</span><span class="hljs-comment">      if A[i - 2], A[i - 1] ä¸Šå‡ï¼ˆä¸‹é™ï¼‰</span><span class="hljs-comment">        if A[i - 1], A[i] ä¸‹é™ï¼ˆä¸Šå‡ï¼‰</span><span class="hljs-comment">           dp[i] = dp[i - 1] + 1</span><span class="hljs-comment">        else if A[i - 1], A[i] ä¸Šå‡ï¼ˆä¸‹é™ï¼‰</span><span class="hljs-comment">           dp[i] = 2</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> len;    &#125;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    Arrays.fill(dp, <span class="hljs-number">1</span>);    dp[<span class="hljs-number">1</span>] = A[<span class="hljs-number">1</span>] == A[<span class="hljs-number">0</span>] ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>;    <span class="hljs-keyword">int</span> max = dp[<span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// ä¸Šå‡</span>        <span class="hljs-keyword">if</span> (A[i - <span class="hljs-number">2</span>] &lt; A[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-comment">// ä¸‹é™</span>            <span class="hljs-keyword">if</span> (A[i - <span class="hljs-number">1</span>] &gt; A[i]) &#123;                dp[i] = dp[i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (A[i - <span class="hljs-number">1</span>] &lt; A[i]) &#123;                dp[i] = <span class="hljs-number">2</span>;            &#125;        &#125;        <span class="hljs-comment">// ä¸‹é™</span>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (A[i - <span class="hljs-number">2</span>] &gt; A[i - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-comment">// ä¸Šå‡</span>            <span class="hljs-keyword">if</span> (A[i - <span class="hljs-number">1</span>] &lt; A[i]) &#123;                dp[i] = dp[i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dp[i - <span class="hljs-number">1</span>] &gt; dp[i]) &#123;                dp[i] = <span class="hljs-number">2</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// A[i - 2] == A[i - 1]</span>            dp[i] = (A[i] == A[i - <span class="hljs-number">1</span>]) ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>;        &#125;        max = Math.max(max, dp[i]);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre><h1 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxTurbulenceSize</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] A)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = A.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> len;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">2</span>;    <span class="hljs-keyword">int</span> maxLen = A[<span class="hljs-number">0</span>] == A[<span class="hljs-number">1</span>] ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">if</span> (A[right] == A[right - <span class="hljs-number">1</span>]) &#123;            left = right;            right++;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// up</span>        <span class="hljs-keyword">if</span> (A[right - <span class="hljs-number">2</span>] &lt; A[right - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-comment">// up</span>            <span class="hljs-keyword">if</span> (A[right - <span class="hljs-number">1</span>] &lt; A[right]) &#123;                left = right - <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-comment">// down</span>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (A[right - <span class="hljs-number">2</span>] &gt; A[right - <span class="hljs-number">1</span>]) &#123;            <span class="hljs-comment">// down</span>            <span class="hljs-keyword">if</span> (A[right - <span class="hljs-number">1</span>] &gt; A[right]) &#123;                left = right - <span class="hljs-number">1</span>;            &#125;        &#125;        right++;        maxLen = Math.max(maxLen, right - left);    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 643. å­æ•°ç»„æœ€å¤§å¹³å‡æ•° I</title>
    <link href="/2020/09/25/LeetCode-643-maximum-average-subarray-i/"/>
    <url>/2020/09/25/LeetCode-643-maximum-average-subarray-i/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-average-subarray-i/" target="_blank" rel="noopener">643. å­æ•°ç»„æœ€å¤§å¹³å‡æ•° I</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">findMaxAverage</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">double</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-comment">// è®¡ç®—å‰ k ä¸ªå­æ•°ç»„å’Œ</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i++) &#123;        sum += nums[i];    &#125;    <span class="hljs-keyword">double</span> res = sum;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = k; i &lt; nums.length; i++) &#123;        <span class="hljs-comment">// [i, i + 1, ... , i + k, i + k + 1]</span>        <span class="hljs-comment">// 0, 1, 2, 3, 4</span>        sum = sum - nums[i - k] + nums[i];        res = Math.max(res, sum);    &#125;    <span class="hljs-keyword">return</span> res / k;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 567. å­—ç¬¦ä¸²çš„æ’åˆ—</title>
    <link href="/2020/09/25/LeetCode-567-permutation-in-string/"/>
    <url>/2020/09/25/LeetCode-567-permutation-in-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/permutation-in-string/" target="_blank" rel="noopener">567. å­—ç¬¦ä¸²çš„æ’åˆ—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">checkInclusion</span><span class="hljs-params">(String s1, String s2)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars1 = s1.toCharArray();    <span class="hljs-keyword">char</span>[] chars2 = s2.toCharArray();    <span class="hljs-keyword">int</span>[] window = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">int</span>[] needs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars1) &#123;        needs[c - <span class="hljs-string">'a'</span>]++;    &#125;    <span class="hljs-keyword">int</span> s1Len = chars1.length;    <span class="hljs-keyword">int</span> s2Len = chars2.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> validLen = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; s2Len) &#123;        <span class="hljs-keyword">int</span> curPos = chars2[right] - <span class="hljs-string">'a'</span>;        <span class="hljs-keyword">if</span> (needs[curPos] == <span class="hljs-number">0</span>) &#123;            right++;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-keyword">if</span> (window[curPos] &lt; needs[curPos]) &#123;            validLen++;        &#125;        window[curPos]++;        right++;        <span class="hljs-keyword">while</span> (validLen == s1Len) &#123;            <span class="hljs-comment">// åªæœ‰å½“å‰çª—å£é•¿åº¦ == s1 æ—¶ï¼Œæ‰ç®—æœ‰æ•ˆçš„æ’åˆ—</span>            <span class="hljs-keyword">if</span> (right - left == s1Len) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            <span class="hljs-keyword">int</span> leftPos = chars2[left] - <span class="hljs-string">'a'</span>;            <span class="hljs-comment">// å·¦è¾¹å­—ç¬¦ä¸åœ¨æ’åˆ—ä¸­</span>            <span class="hljs-keyword">if</span> (needs[leftPos] == <span class="hljs-number">0</span>) &#123;                left++;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// å·¦è¾¹å­—ç¬¦åœ¨æ’åˆ—ä¸­ï¼Œå‡å°æœ‰æ•ˆé•¿åº¦</span>            <span class="hljs-keyword">if</span> (window[leftPos] == needs[leftPos]) &#123;                validLen--;            &#125;            window[leftPos]--;            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦</title>
    <link href="/2020/09/24/LeetCode-424-longest-repeating-character-replacement/"/>
    <url>/2020/09/24/LeetCode-424-longest-repeating-character-replacement/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-repeating-character-replacement/" target="_blank" rel="noopener">424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦</a></p><p>å®é™…ä¸Šï¼Œçª—å£å§‹ç»ˆå¢å¤§ï¼Œå› ä¸ºè¦æ±‚æœ€é•¿å­ä¸²ï¼Œçª—å£å†…çš„å­—ç¬¦å‡ºç°æ¬¡æ•°åœ¨çª—å£æ”¶ç¼©ä¸€ä½åï¼Œæ²¡æœ‰å¿…è¦è¿›è¡Œæ›´æ–°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">characterReplacement</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-comment">// çª—å£å†…å­—ç¬¦çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] freq = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> maxCount = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> maxLen = Integer.MIN_VALUE;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-keyword">int</span> cur = chars[right] - <span class="hljs-string">'A'</span>;        freq[cur]++;        right++;        maxCount = Math.max(maxCount, freq[cur]);        <span class="hljs-comment">// çª—å£å¤§å° - é‡å¤å­—ç¬¦é•¿åº¦ &lt;= k ä¸ªæ›¿æ¢é•¿åº¦æ—¶</span>        <span class="hljs-comment">// è¡¨ç¤ºå¯ä»¥æ›¿æ¢çš„å­—ç¬¦è¿˜è¾¾ä¸åˆ° k ä¸ªï¼Œæ­¤æ—¶å¯ä»¥æ‰©å¤§çª—å£</span>        <span class="hljs-comment">// æ”¶ç¼© left ä¹‹åï¼Œçª—å£å†…æ­£å¥½å¯æ›¿æ¢ k ä¸ªå­—ç¬¦</span>        <span class="hljs-comment">// while (right - left - maxCount &gt; k) &#123;</span>        <span class="hljs-keyword">if</span> (right - left - maxCount &gt; k) &#123;            freq[chars[left] - <span class="hljs-string">'A'</span>]--;            left++;        &#125;        maxLen = Math.max(maxLen, right - left);    &#125;    <span class="hljs-keyword">return</span> maxLen;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼</title>
    <link href="/2020/09/24/LeetCode-239-sliding-window-maximum/"/>
    <url>/2020/09/24/LeetCode-239-sliding-window-maximum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sliding-window-maximum/" target="_blank" rel="noopener">239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] maxSlidingWindow(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len - k + <span class="hljs-number">1</span>];    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å•è°ƒé€’å‡é˜Ÿåˆ—ï¼šé˜Ÿé¦– &gt; é˜Ÿå°¾</span>    <span class="hljs-comment">// ç»´æŠ¤çª—å£å†…çš„æœ€å¤§å€¼ï¼Œå½“é˜Ÿé¦–ä¸åœ¨çª—å£å†…æ—¶åˆ™ç§»é™¤</span>    ArrayDeque&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// ç§»é™¤é˜Ÿåˆ—ä¸­æ¯”å½“å‰å€¼å°çš„å…ƒç´ </span>        <span class="hljs-keyword">while</span> (!queue.isEmpty() &amp;&amp; nums[queue.peekLast()] &lt; nums[i]) &#123;            queue.removeLast();        &#125;        <span class="hljs-comment">// æ·»åŠ å½“å‰å…ƒç´ </span>        queue.add(i);        <span class="hljs-comment">// åˆ¤æ–­é˜Ÿé¦–å€¼æ˜¯å¦åœ¨çª—å£å†…ï¼Œè‹¥ä¸åœ¨åˆ™ç§»é™¤</span>        <span class="hljs-keyword">if</span> (queue.getFirst() &lt;= i - k) &#123;            queue.removeFirst();        &#125;        <span class="hljs-comment">// å½¢æˆæœ‰æ•ˆçª—å£å¤§å°</span>        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) &#123;            res[j++] = nums[queue.getFirst()];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 209. é•¿åº¦æœ€å°çš„å­æ•°ç»„</title>
    <link href="/2020/09/24/LeetCode-209-minimum-size-subarray-sum/"/>
    <url>/2020/09/24/LeetCode-209-minimum-size-subarray-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-size-subarray-sum/" target="_blank" rel="noopener">209. é•¿åº¦æœ€å°çš„å­æ•°ç»„</a></p><h1 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minSubArrayLen</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> minLen = Integer.MAX_VALUE;    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; len) &#123;        <span class="hljs-comment">// è®¡ç®—å‰ç¼€å’Œ</span>        sum += nums[right];        right++;        <span class="hljs-comment">// å½“å‰ç¼€å’Œ &gt; targetï¼Œå°è¯•å³ç§» left</span>        <span class="hljs-keyword">while</span> (sum &gt;= s) &#123;            <span class="hljs-comment">// æ›´æ–°æœ€å°é•¿åº¦</span>            <span class="hljs-keyword">if</span> (right - left &lt; minLen) &#123;                minLen = right - left;            &#125;            <span class="hljs-comment">// å³ç§» left ä¹‹å‰è¦å‡å» left å¯¹åº”çš„å€¼</span>            sum -= nums[left];            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="hljs-number">0</span> : minLen;&#125;</code></pre><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minSubArrayLen</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// è®¡ç®—å‰ç¼€å’Œæ•°ç»„</span>    <span class="hljs-keyword">int</span>[] preSum = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    preSum[<span class="hljs-number">0</span>] = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        preSum[i] = nums[i] + preSum[i - <span class="hljs-number">1</span>];    &#125;    <span class="hljs-keyword">int</span> minLen = Integer.MAX_VALUE;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">int</span> s1 = s - nums[i];        <span class="hljs-comment">// preSum[i.....j]</span>        <span class="hljs-comment">// æ‰¾åˆ°ä¸€ä¸ª preSum[j]ï¼Œä½¿å¾— preSum[j] - preSum[i] &gt;= s</span>        <span class="hljs-keyword">int</span> j = binarySearch(preSum, i, len - <span class="hljs-number">1</span>, s1 + preSum[i]);        <span class="hljs-keyword">if</span> (j != -<span class="hljs-number">1</span>) &#123;            minLen = Math.min(minLen, j - i + <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> minLen == Integer.MAX_VALUE ? <span class="hljs-number">0</span> : minLen;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] preSum, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-keyword">int</span> mid = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt;= right) &#123;        mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (preSum[mid] == target) &#123;            <span class="hljs-keyword">return</span> mid;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (preSum[mid] &gt; target) &#123;            right = mid - <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-comment">// æ‰¾ä¸åˆ° == target çš„ preSum[j]ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ª &gt; target çš„å…ƒç´ </span>    <span class="hljs-keyword">return</span> preSum[mid] &gt; target ? mid : -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ å†…å­˜ç®¡ç†</title>
    <link href="/2020/09/24/os-ram-manage/"/>
    <url>/2020/09/24/os-ram-manage/</url>
    
    <content type="html"><![CDATA[<p><code>åˆ†å±‚å­˜å‚¨å™¨ä½“ç³»(memory hierarchy)</code>ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200924163759.png" srcset="/img/loading.gif" alt="" /></p><p>ä½äºé¡¶å±‚çš„å­˜å‚¨å™¨é€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯ç›¸å¯¹å®¹é‡æœ€å°ï¼Œæˆæœ¬éå¸¸é«˜ã€‚å±‚çº§ç»“æ„å‘ä¸‹ï¼Œå…¶è®¿é—®é€Ÿåº¦ä¼šå˜æ…¢ï¼Œä½†æ˜¯å®¹é‡ä¼šå˜å¤§ï¼Œç›¸å¯¹é€ ä»·ä¹Ÿå°±è¶Šä¾¿å®œã€‚ï¼ˆæ‰€ä»¥ä¸ªäººæ„Ÿè§‰ç›¸å¯¹å­˜å‚¨å®¹é‡æ¥è¯´ï¼Œè®¿é—®é€Ÿåº¦æ˜¯æ›´é‡è¦çš„ï¼‰</p><p>æ“ä½œç³»ç»Ÿä¸­ç®¡ç†å†…å­˜å±‚æ¬¡ç»“æ„çš„éƒ¨åˆ†ç§°ä¸º <code>å†…å­˜ç®¡ç†å™¨(memory manager)</code>ï¼Œå®ƒçš„ä¸»è¦å·¥ä½œæ˜¯æœ‰æ•ˆçš„ç®¡ç†å†…å­˜ï¼Œè®°å½•å“ªäº›å†…å­˜æ˜¯æ­£åœ¨ä½¿ç”¨çš„ï¼Œåœ¨è¿›ç¨‹éœ€è¦æ—¶åˆ†é…å†…å­˜ä»¥åŠåœ¨è¿›ç¨‹å®Œæˆæ—¶å›æ”¶å†…å­˜ã€‚æ‰€æœ‰ç°ä»£æ“ä½œç³»ç»Ÿéƒ½æä¾›å†…å­˜ç®¡ç†ã€‚</p><h1 id="æ— å­˜å‚¨å™¨æŠ½è±¡"><a class="markdownIt-Anchor" href="#æ— å­˜å‚¨å™¨æŠ½è±¡"></a> æ— å­˜å‚¨å™¨æŠ½è±¡</h1><p>æœ€ç®€å•çš„å­˜å‚¨å™¨æŠ½è±¡æ˜¯æ— å­˜å‚¨å™¨ã€‚æ—©æœŸå¤§å‹è®¡ç®—æœºï¼ˆ20 ä¸–çºª 60 å¹´ä»£ä¹‹å‰ï¼‰ï¼Œå°å‹è®¡ç®—æœºï¼ˆ20 ä¸–çºª 70 å¹´ä»£ä¹‹å‰ï¼‰å’Œä¸ªäººè®¡ç®—æœºï¼ˆ20 ä¸–çºª 80 å¹´ä»£ä¹‹å‰ï¼‰éƒ½æ²¡æœ‰å­˜å‚¨å™¨æŠ½è±¡ã€‚æ¯ä¸€ä¸ªç¨‹åºéƒ½ç›´æ¥è®¿é—®ç‰©ç†å†…å­˜ã€‚å½“ä¸€ä¸ªç¨‹åºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code class="hljs angelscript">MOV REGISTER1, <span class="hljs-number">1000</span></code></pre><p>è®¡ç®—æœºä¼šæŠŠä½ç½®ä¸º 1000 çš„ç‰©ç†å†…å­˜ä¸­çš„å†…å®¹ç§»åˆ° <code>REGISTER1</code> ä¸­ã€‚å› æ­¤å‘ˆç°ç»™ç¨‹åºå‘˜çš„å†…å­˜æ¨¡å‹å°±æ˜¯ç‰©ç†å†…å­˜ï¼Œå†…å­˜åœ°å€ä» 0 å¼€å§‹åˆ°å†…å­˜åœ°å€çš„æœ€å¤§å€¼ä¸­ï¼Œæ¯ä¸ªåœ°å€ä¸­éƒ½ä¼šåŒ…å«ä¸€ä¸ª <code>8 ä½</code> ä½æ•°çš„å†…å­˜å•å…ƒã€‚</p><p>æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹çš„è®¡ç®—æœº<strong>ä¸å¯èƒ½ä¼šæœ‰ä¸¤ä¸ªåº”ç”¨ç¨‹åºåŒæ—¶åœ¨å†…å­˜ä¸­</strong>ã€‚å¦‚æœç¬¬ä¸€ä¸ªç¨‹åºå‘å†…å­˜åœ°å€ 2000 çš„è¿™ä¸ªä½ç½®å†™å…¥äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆæ­¤å€¼å°†ä¼šæ›¿æ¢ç¬¬äºŒä¸ªç¨‹åº 2000 ä½ç½®ä¸Šçš„å€¼ï¼Œæ‰€ä»¥ï¼ŒåŒæ—¶è¿è¡Œä¸¤ä¸ªåº”ç”¨ç¨‹åºæ˜¯è¡Œä¸é€šçš„ï¼Œä¸¤ä¸ªç¨‹åºä¼šç«‹åˆ»å´©æºƒã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200924165101.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸è¿‡å³ä½¿å­˜å‚¨å™¨æ¨¡å‹å°±æ˜¯ç‰©ç†å†…å­˜ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸€äº›å¯å˜ä½“çš„ã€‚ä¸‹é¢å±•ç¤ºäº†ä¸‰ç§å˜ä½“ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200924165747.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨ä¸Šå›¾ <code>a</code> ä¸­ï¼Œæ“ä½œç³»ç»Ÿä½äº <code>RAM(Random Access Memory)</code> çš„åº•éƒ¨ï¼Œæˆ–åƒæ˜¯å›¾ <code>b</code> ä¸€æ ·ä½äº <code>ROM(Read-Only Memory)</code> é¡¶éƒ¨ï¼›è€Œåœ¨å›¾ <code>c</code> ä¸­ï¼Œ<strong>è®¾å¤‡é©±åŠ¨ç¨‹åº</strong>ä½äºé¡¶ç«¯çš„ <code>ROM</code> ä¸­ï¼Œè€Œæ“ä½œç³»ç»Ÿä½äºåº•éƒ¨çš„ <code>RAM</code> ä¸­ã€‚</p><ul><li>å›¾ a çš„æ¨¡å‹ä»¥å‰ç”¨åœ¨å¤§å‹æœºå’Œå°å‹æœºä¸Šï¼Œä½†ç°åœ¨å·²ç»å¾ˆå°‘ä½¿ç”¨äº†ï¼›</li><li>å›¾ b ä¸­çš„æ¨¡å‹ä¸€èˆ¬ç”¨äºæŒä¸Šç”µè„‘æˆ–è€…æ˜¯åµŒå…¥å¼ç³»ç»Ÿä¸­ã€‚</li><li>ç¬¬ä¸‰ç§æ¨¡å‹å°±åº”ç”¨åœ¨æ—©æœŸä¸ªäººè®¡ç®—æœºä¸­äº†ã€‚ROM ç³»ç»Ÿä¸­çš„ä¸€éƒ¨åˆ†æˆä¸º <code>BIOS (Basic Input Output System)</code>ã€‚æ¨¡å‹ a å’Œ c çš„ç¼ºç‚¹æ˜¯<strong>ç”¨æˆ·ç¨‹åºä¸­çš„é”™è¯¯å¯èƒ½ä¼šç ´åæ“ä½œç³»ç»Ÿ</strong>ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¾éš¾æ€§çš„åæœã€‚</li></ul><p>æŒ‰ç…§è¿™ç§æ–¹å¼ç»„ç»‡ç³»ç»Ÿæ—¶ï¼Œé€šå¸¸<strong>åŒä¸€ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œ</strong>ã€‚ä¸€æ—¦ç”¨æˆ·é”®å…¥äº†ä¸€ä¸ªå‘½ä»¤ï¼Œæ“ä½œç³»ç»Ÿå°±æŠŠéœ€è¦çš„ç¨‹åºä»ç£ç›˜å¤åˆ¶åˆ°å†…å­˜ä¸­å¹¶æ‰§è¡Œï¼›å½“è¿›ç¨‹è¿è¡Œç»“æŸåï¼Œæ“ä½œç³»ç»Ÿåœ¨ç”¨æˆ·ç»ˆç«¯æ˜¾ç¤ºæç¤ºç¬¦å¹¶ç­‰å¾…æ–°çš„å‘½ä»¤ã€‚æ”¶åˆ°æ–°çš„å‘½ä»¤åï¼Œå®ƒæŠŠæ–°çš„ç¨‹åºè£…å…¥å†…å­˜ï¼Œè¦†ç›–å‰ä¸€ä¸ªç¨‹åºã€‚</p><p>åœ¨æ²¡æœ‰å­˜å‚¨å™¨æŠ½è±¡çš„ç³»ç»Ÿä¸­å®ç°å¹¶è¡Œæ€§ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨å¤šçº¿ç¨‹æ¥ç¼–ç¨‹ã€‚ç”±äºåŒä¸€è¿›ç¨‹ä¸­çš„å¤šçº¿ç¨‹å†…éƒ¨å…±äº«åŒä¸€å†…å­˜æ˜ åƒï¼Œé‚£ä¹ˆå®ç°å¹¶è¡Œä¹Ÿå°±ä¸æ˜¯é—®é¢˜äº†ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å´å¹¶æ²¡æœ‰è¢«å¹¿æ³›é‡‡çº³ï¼Œå› ä¸ºäººä»¬é€šå¸¸å¸Œæœ›èƒ½å¤Ÿåœ¨åŒä¸€æ—¶é—´å†…è¿è¡Œæ²¡æœ‰å…³è”çš„ç¨‹åºï¼Œè€Œè¿™æ­£æ˜¯çº¿ç¨‹æŠ½è±¡æ‰€ä¸èƒ½æä¾›çš„ã€‚</p><h1 id="å­˜å‚¨å™¨æŠ½è±¡åœ°å€ç©ºé—´"><a class="markdownIt-Anchor" href="#å­˜å‚¨å™¨æŠ½è±¡åœ°å€ç©ºé—´"></a> å­˜å‚¨å™¨æŠ½è±¡ï¼šåœ°å€ç©ºé—´</h1><p>æŠŠç‰©ç†å†…å­˜æš´éœ²ç»™è¿›ç¨‹ä¼šæœ‰å‡ ä¸ªä¸»è¦çš„ç¼ºç‚¹ï¼š</p><ul><li><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœç”¨æˆ·ç¨‹åºå¯ä»¥å¯»å€å†…å­˜çš„æ¯ä¸ªå­—èŠ‚ï¼Œå®ƒä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“çš„<strong>ç ´åæ“ä½œç³»ç»Ÿ</strong>ï¼Œä»è€Œä½¿ç³»ç»Ÿåœæ­¢è¿è¡Œã€‚å³ä½¿åœ¨åªæœ‰ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå­˜åœ¨ã€‚</p></li><li><p>ç¬¬äºŒç‚¹æ˜¯ï¼Œ<strong>éš¾ä»¥è¿è¡Œå¤šä¸ªç¨‹åº</strong>ã€‚åœ¨ä¸ªäººè®¡ç®—æœºä¸Šï¼Œä¸€èˆ¬ä¼šæ‰“å¼€å¾ˆå¤šåº”ç”¨ç¨‹åºï¼Œè¿™äº›è¿›ç¨‹åœ¨ä¸åŒæ—¶åˆ»ä¼šæœ‰ä¸€ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œï¼Œå…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡é¼ æ ‡æ¥å”¤é†’ã€‚åœ¨ç³»ç»Ÿä¸­æ²¡æœ‰ç‰©ç†å†…å­˜çš„æƒ…å†µä¸‹å¾ˆéš¾å®ç°ã€‚</p></li></ul><h2 id="åœ°å€ç©ºé—´æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#åœ°å€ç©ºé—´æ¦‚å¿µ"></a> åœ°å€ç©ºé—´æ¦‚å¿µ</h2><p><code>åœ°å€ç©ºé—´(the address space)</code> åˆ›å»ºäº†ä¸€ç§æŠ½è±¡å†…å­˜ä¾›ç¨‹åºä½¿ç”¨ã€‚<strong>åœ°å€ç©ºé—´æ˜¯è¿›ç¨‹å¯ä»¥ç”¨æ¥å¯»å€å†…å­˜çš„åœ°å€é›†ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œç‹¬ç«‹äºå…¶ä»–è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œä½†æ˜¯æŸäº›è¿›ç¨‹ä¼šå¸Œæœ›å¯ä»¥å…±äº«åœ°å€ç©ºé—´ã€‚</strong></p><h3 id="åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨"><a class="markdownIt-Anchor" href="#åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨"></a> åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨</h3><p>æœ€ç®€å•çš„åŠæ³•æ˜¯ä½¿ç”¨ <code>åŠ¨æ€é‡å®šä½(dynamic relocation)</code> æŠ€æœ¯ï¼Œå®ƒå°±æ˜¯é€šè¿‡ä¸€ç§ç®€å•çš„æ–¹å¼<strong>å°†æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜ å°„åˆ°ç‰©ç†å†…å­˜çš„ä¸åŒåŒºåŸŸ</strong>ã€‚<br />ç»å…¸åŠæ³•æ˜¯ç»™æ¯ä¸ª <code>CPU</code> é…ç½®ä¸¤ä¸ªç‰¹æ®Šç¡¬ä»¶å¯„å­˜å™¨ï¼Œé€šå¸¸å«åš <code>åŸºå€å¯„å­˜å™¨(basic register)</code> å’Œ <code>å˜å€å¯„å­˜å™¨(limit register)</code>ã€‚å½“ä½¿ç”¨åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨æ—¶ï¼Œç¨‹åºä¼šè£…è½½åˆ°å†…å­˜ä¸­çš„è¿ç»­ä½ç½®å¹¶ä¸”åœ¨è£…è½½æœŸé—´æ— éœ€é‡å®šä½ã€‚</p><ul><li>åŸºå€å¯„å­˜å™¨ï¼šå­˜å‚¨æ•°æ®å†…å­˜çš„èµ·å§‹ä½ç½®</li><li>å˜å€å¯„å­˜å™¨ï¼šå­˜å‚¨åº”ç”¨ç¨‹åºçš„é•¿åº¦ã€‚</li></ul><p>æ¯å½“è¿›ç¨‹å¼•ç”¨å†…å­˜ä»¥è·å–æŒ‡ä»¤æˆ–è¯»å–ã€å†™å…¥æ•°æ®æ—¶ï¼Œ<code>CPU</code> éƒ½ä¼šè‡ªåŠ¨å°†åŸºå€å€¼æ·»åŠ åˆ°è¿›ç¨‹ç”Ÿæˆçš„åœ°å€ä¸­ï¼Œç„¶åå†å°†å…¶å‘é€åˆ°å†…å­˜æ€»çº¿ä¸Šã€‚åŒæ—¶ï¼Œå®ƒæ£€æŸ¥ç¨‹åºæä¾›çš„åœ°å€æ˜¯å¦å¤§äºæˆ–ç­‰äºå˜å€å¯„å­˜å™¨ä¸­çš„å€¼ã€‚å¦‚æœç¨‹åºæä¾›çš„åœ°å€è¦è¶…è¿‡å˜å€å¯„å­˜å™¨çš„èŒƒå›´ï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿé”™è¯¯å¹¶ä¸­æ­¢è®¿é—®ã€‚</p><p>æ‰§è¡Œ <code>JMP 28</code> è¿™æ¡æŒ‡ä»¤åï¼Œç¡¬ä»¶ä¼šæŠŠå®ƒè§£é‡Šä¸º <code>JMP 16412</code>ï¼Œæ‰€ä»¥ç¨‹åºèƒ½å¤Ÿè·³åˆ° <code>CMP</code> æŒ‡ä»¤ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925132116.png" srcset="/img/loading.gif" alt="" /></p><p>ä½¿ç”¨åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨æ˜¯ç»™æ¯ä¸ªè¿›ç¨‹æä¾›ç§æœ‰åœ°å€ç©ºé—´çš„ä¸€ç§éå¸¸å¥½çš„æ–¹æ³•ï¼Œå› ä¸ºæ¯ä¸ªå†…å­˜åœ°å€åœ¨é€åˆ°å†…å­˜ä¹‹å‰ï¼Œéƒ½ä¼šå…ˆåŠ ä¸ŠåŸºå€å¯„å­˜å™¨çš„å†…å®¹ã€‚åœ¨å¾ˆå¤šå®é™…ç³»ç»Ÿä¸­ï¼Œå¯¹åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨éƒ½ä¼šä»¥ä¸€å®šçš„æ–¹å¼åŠ ä»¥ä¿æŠ¤ï¼Œä½¿å¾—åªæœ‰æ“ä½œç³»ç»Ÿå¯ä»¥ä¿®æ”¹å®ƒä»¬ã€‚</p><p>ç¼ºç‚¹ï¼šåœ¨æ¯æ¬¡è®¿é—®å†…å­˜æ—¶ï¼Œéƒ½ä¼šè¿›è¡Œ <code>ADD</code> å’Œ <code>CMP</code> è¿ç®—ã€‚<code>CMP</code> æŒ‡ä»¤å¯ä»¥æ‰§è¡Œçš„å¾ˆå¿«ï¼Œä½†æ˜¯åŠ æ³•å°±ä¼šç›¸å¯¹æ…¢ä¸€äº›ï¼Œé™¤éä½¿ç”¨ç‰¹æ®Šçš„åŠ æ³•ç”µè·¯ï¼Œå¦åˆ™åŠ æ³•å› è¿›ä½ä¼ æ’­æ—¶é—´è€Œå˜æ…¢ã€‚</p><h2 id="äº¤æ¢æŠ€æœ¯"><a class="markdownIt-Anchor" href="#äº¤æ¢æŠ€æœ¯"></a> äº¤æ¢æŠ€æœ¯</h2><p>å®é™…ä¸Šï¼Œæ‰€æœ‰<strong>è¿›ç¨‹éœ€è¦çš„ <code>RAM</code> æ€»å®¹é‡è¦è¿œè¿œé«˜äºå†…å­˜çš„å®¹é‡</strong>ã€‚é’ˆå¯¹<strong>å†…å­˜ä¸è¶³</strong>çš„é—®é¢˜ï¼Œæå‡ºäº†ä¸¤ç§å¤„ç†æ–¹å¼ï¼š</p><ul><li><code>äº¤æ¢(swapping)</code> æŠ€æœ¯ï¼Œå³æŠŠä¸€ä¸ªè¿›ç¨‹å®Œæ•´çš„è°ƒå…¥å†…å­˜ï¼Œç„¶åå†å†…å­˜ä¸­è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œå†æŠŠå®ƒæ”¾å›ç£ç›˜ã€‚ç©ºé—²è¿›ç¨‹ä¼šå­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œæ‰€ä»¥è¿™äº›è¿›ç¨‹åœ¨æ²¡æœ‰è¿è¡Œæ—¶ä¸ä¼šå ç”¨å¤ªå¤šå†…å­˜ã€‚</li><li><code>è™šæ‹Ÿå†…å­˜(virtual memory)</code>ï¼Œè™šæ‹Ÿå†…å­˜æŠ€æœ¯èƒ½å¤Ÿå…è®¸åº”ç”¨ç¨‹åºéƒ¨åˆ†çš„è¿è¡Œåœ¨å†…å­˜ä¸­ã€‚</li></ul><h3 id="äº¤æ¢è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#äº¤æ¢è¿‡ç¨‹"></a> äº¤æ¢è¿‡ç¨‹</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925132623.png" srcset="/img/loading.gif" alt="" /></p><p>åˆšå¼€å§‹çš„æ—¶å€™ï¼Œåªæœ‰è¿›ç¨‹ A åœ¨å†…å­˜ä¸­ï¼Œç„¶åä»åˆ›å»ºè¿›ç¨‹ B å’Œè¿›ç¨‹ C æˆ–è€…ä»ç£ç›˜ä¸­æŠŠå®ƒä»¬æ¢å…¥å†…å­˜ï¼Œç„¶ååœ¨å›¾ d ä¸­ï¼ŒA è¢«æ¢å‡ºå†…å­˜åˆ°ç£ç›˜ä¸­ï¼Œæœ€å A é‡æ–°è¿›æ¥ã€‚å› ä¸ºå›¾ g ä¸­çš„è¿›ç¨‹ A ç°åœ¨åˆ°äº†ä¸åŒçš„ä½ç½®ï¼Œæ‰€ä»¥åœ¨è£…è½½è¿‡ç¨‹ä¸­éœ€è¦è¢«é‡æ–°å®šä½ï¼Œæˆ–è€…åœ¨äº¤æ¢ç¨‹åºæ—¶é€šè¿‡è½¯ä»¶æ¥æ‰§è¡Œï¼›æˆ–è€…åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´é€šè¿‡ç¡¬ä»¶æ¥é‡å®šä½ã€‚åŸºå€å¯„å­˜å™¨å’Œå˜å€å¯„å­˜å™¨å°±é€‚ç”¨äºè¿™ç§æƒ…å†µã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925132932.png" srcset="/img/loading.gif" alt="" /></p><p>äº¤æ¢åœ¨å†…å­˜åˆ›å»ºäº†å¤šä¸ª <code>ç©ºé—²åŒº(hole)</code>ï¼Œå†…å­˜ä¼šæŠŠæ‰€æœ‰çš„ç©ºé—²åŒºå°½å¯èƒ½å‘ä¸‹ç§»åŠ¨åˆå¹¶æˆä¸ºä¸€ä¸ªå¤§çš„ç©ºé—²åŒºã€‚è¿™é¡¹æŠ€æœ¯ç§°ä¸º <code>å†…å­˜ç´§ç¼©(memory compaction)</code>ã€‚ä½†æ˜¯è¿™é¡¹æŠ€æœ¯é€šå¸¸ä¸ä¼šä½¿ç”¨ï¼Œå› ä¸ºè¿™é¡¹æŠ€æœ¯ä¼šæ¶ˆè€—å¾ˆå¤š <code>CPU</code> æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ª 16GB å†…å­˜çš„æœºå™¨ä¸Šæ¯ 8ns å¤åˆ¶ 8 å­—èŠ‚ï¼Œå®ƒç´§ç¼©å…¨éƒ¨çš„å†…å­˜å¤§çº¦è¦èŠ±è´¹ 16sã€‚</p><h3 id="åŠ¨æ€å†…å­˜åˆ†é…"><a class="markdownIt-Anchor" href="#åŠ¨æ€å†…å­˜åˆ†é…"></a> åŠ¨æ€å†…å­˜åˆ†é…</h3><p>å¦‚æœè¿›ç¨‹è¢«åˆ›å»ºåå®ƒçš„å¤§å°æ˜¯å›ºå®šçš„å¹¶ä¸”ä¸å†æ”¹å˜ï¼Œé‚£ä¹ˆåˆ†é…ç­–ç•¥å°±æ¯”è¾ƒç®€å•ï¼šæ“ä½œç³»ç»Ÿä¼šå‡†ç¡®çš„æŒ‰å…¶éœ€è¦çš„å¤§å°è¿›è¡Œåˆ†é…ã€‚</p><p>è¿›ç¨‹çš„ <code>data segment</code> èƒ½å¤Ÿè‡ªåŠ¨å¢é•¿ï¼Œä¼šæœ‰ä¸‰ç§å¤„ç†æ–¹å¼ï¼š</p><ul><li><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸ç©ºé—²åŒºç›¸é‚»ï¼Œé‚£ä¹ˆå¯æŠŠè¯¥ç©ºé—²åŒºåˆ†é…ç»™è¿›ç¨‹ä»¥ä¾›å…¶å¢å¤§ã€‚</p></li><li><p>å¦‚æœè¿›ç¨‹ç›¸é‚»çš„æ˜¯å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œå°±ä¼šæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šè¦ä¹ˆæŠŠéœ€è¦å¢é•¿çš„è¿›ç¨‹ç§»åŠ¨åˆ°ä¸€ä¸ªå†…å­˜ä¸­ç©ºé—²åŒºè¶³å¤Ÿå¤§çš„åŒºåŸŸï¼Œè¦ä¹ˆæŠŠä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹äº¤æ¢å‡ºå»ï¼Œå·²å˜æˆç”Ÿæˆä¸€ä¸ªå¤§çš„ç©ºé—²åŒºã€‚</p></li><li><p>å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨å†…å­˜ä¸­ä¸èƒ½å¢é•¿ï¼Œè€Œä¸”ç£ç›˜ä¸Šçš„äº¤æ¢åŒºä¹Ÿæ»¡äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹åªæœ‰æŒ‚èµ·ä¸€äº›ç©ºé—²ç©ºé—´ï¼ˆæˆ–è€…å¯ä»¥ç»“æŸè¯¥è¿›ç¨‹ï¼‰ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925133850.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šé¢åªé’ˆå¯¹å•ä¸ªæˆ–è€…ä¸€å°éƒ¨åˆ†éœ€è¦å¢é•¿çš„è¿›ç¨‹é‡‡ç”¨çš„æ–¹å¼ï¼Œå¦‚æœå¤§éƒ¨åˆ†è¿›ç¨‹éƒ½è¦åœ¨è¿è¡Œæ—¶å¢é•¿ï¼Œä¸ºäº†å‡å°‘å› å†…å­˜åŒºåŸŸä¸å¤Ÿè€Œå¼•èµ·çš„è¿›ç¨‹äº¤æ¢å’Œç§»åŠ¨æ‰€äº§ç”Ÿçš„å¼€é”€ï¼Œä¸€ç§å¯ç”¨çš„æ–¹æ³•æ˜¯ï¼Œ<strong>åœ¨æ¢å…¥æˆ–ç§»åŠ¨è¿›ç¨‹æ—¶ä¸ºå®ƒåˆ†é…ä¸€äº›é¢å¤–çš„å†…å­˜</strong>ã€‚ç„¶è€Œï¼Œ<strong>å½“è¿›ç¨‹è¢«æ¢å‡ºåˆ°ç£ç›˜ä¸Šæ—¶ï¼Œåº”è¯¥åªäº¤æ¢å®é™…ä¸Šä½¿ç”¨çš„å†…å­˜</strong>ï¼Œå°†é¢å¤–çš„å†…å­˜äº¤æ¢ä¹Ÿæ˜¯ä¸€ç§æµªè´¹ï¼Œä¸‹é¢æ˜¯ä¸€ç§ä¸ºä¸¤ä¸ªè¿›ç¨‹åˆ†é…äº†å¢é•¿ç©ºé—´çš„å†…å­˜é…ç½®ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925134003.png" srcset="/img/loading.gif" alt="" /></p><p>å¦‚æœè¿›ç¨‹æœ‰ä¸¤ä¸ªå¯å¢é•¿çš„æ®µï¼Œä¾‹å¦‚ï¼Œä¾›å˜é‡åŠ¨æ€åˆ†é…å’Œé‡Šæ”¾çš„ä½œä¸ºå †(å…¨å±€å˜é‡)ä½¿ç”¨çš„ä¸€ä¸ª <code>æ•°æ®æ®µ(data segment)</code>ï¼Œä»¥åŠå­˜æ”¾å±€éƒ¨å˜é‡ä¸è¿”å›åœ°å€çš„ä¸€ä¸ª <code>å †æ ˆæ®µ(stack segment)</code>ï¼Œå°±å¦‚å›¾ b æ‰€ç¤ºã€‚åœ¨å›¾ä¸­å¯ä»¥çœ‹åˆ°æ‰€ç¤ºè¿›ç¨‹çš„<strong>å †æ ˆæ®µåœ¨è¿›ç¨‹æ‰€å å†…å­˜çš„é¡¶ç«¯å‘ä¸‹å¢é•¿</strong>ï¼Œç´§æ¥ç€åœ¨ç¨‹åºæ®µåçš„<strong>æ•°æ®æ®µå‘ä¸Šå¢é•¿</strong>ã€‚å½“å¢é•¿é¢„ç•™çš„å†…å­˜åŒºåŸŸä¸å¤Ÿäº†ï¼Œå¤„ç†æ–¹å¼å°±å¦‚ä¸Šé¢çš„æµç¨‹å›¾(<code>data segment</code> è‡ªåŠ¨å¢é•¿çš„ä¸‰ç§å¤„ç†æ–¹å¼)ä¸€æ ·äº†ã€‚</p><h2 id="ç©ºé—²å†…å­˜ç®¡ç†"><a class="markdownIt-Anchor" href="#ç©ºé—²å†…å­˜ç®¡ç†"></a> ç©ºé—²å†…å­˜ç®¡ç†</h2><p>åœ¨è¿›è¡Œå†…å­˜åŠ¨æ€åˆ†é…æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»å¯¹å…¶è¿›è¡Œç®¡ç†ã€‚å¤§è‡´ä¸Šè¯´ï¼Œæœ‰ä¸¤ç§ç›‘æ§å†…å­˜ä½¿ç”¨çš„æ–¹å¼</p><ul><li>ä½å›¾(<code>bitmap</code>)</li><li>ç©ºé—²åˆ—è¡¨(<code>free lists</code>)</li></ul><h3 id="1-ä½¿ç”¨ä½å›¾çš„å­˜å‚¨ç®¡ç†"><a class="markdownIt-Anchor" href="#1-ä½¿ç”¨ä½å›¾çš„å­˜å‚¨ç®¡ç†"></a> 1. ä½¿ç”¨ä½å›¾çš„å­˜å‚¨ç®¡ç†</h3><p>ä½¿ç”¨ä½å›¾æ–¹æ³•æ—¶ï¼Œå†…å­˜å¯èƒ½è¢«åˆ’åˆ†ä¸ºå°åˆ°å‡ ä¸ªå­—æˆ–å¤§åˆ°å‡ åƒå­—èŠ‚çš„åˆ†é…å•å…ƒã€‚æ¯ä¸ªåˆ†é…å•å…ƒå¯¹åº”äºä½å›¾ä¸­çš„ä¸€ä½ï¼Œ0 è¡¨ç¤ºç©ºé—²ï¼Œ 1 è¡¨ç¤ºå ç”¨ï¼ˆæˆ–è€…ç›¸åï¼‰ã€‚ä¸€å—å†…å­˜åŒºåŸŸå’Œå…¶å¯¹åº”çš„ä½å›¾å¦‚ä¸‹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925161159.png" srcset="/img/loading.gif" alt="" /></p><p>å›¾ <code>a</code> è¡¨ç¤ºä¸€æ®µæœ‰ 5 ä¸ªè¿›ç¨‹å’Œ 3 ä¸ªç©ºé—²åŒºçš„å†…å­˜ï¼Œåˆ»åº¦ä¸ºå†…å­˜åˆ†é…å•å…ƒï¼Œé˜´å½±åŒºè¡¨ç¤ºç©ºé—²ï¼ˆåœ¨ä½å›¾ä¸­ç”¨ 0 è¡¨ç¤ºï¼‰ï¼›å›¾ <code>b</code> è¡¨ç¤ºå¯¹åº”çš„ä½å›¾ï¼›å›¾ <code>c</code> è¡¨ç¤ºç”¨é“¾è¡¨è¡¨ç¤ºåŒæ ·çš„ä¿¡æ¯ã€‚</p><p>åˆ†é…å•å…ƒçš„å¤§å°æ˜¯ä¸€ä¸ªé‡è¦çš„è®¾è®¡å› ç´ ï¼Œ<strong>åˆ†é…å•ä½è¶Šå°ï¼Œä½å›¾è¶Šå¤§</strong>ã€‚ç„¶è€Œï¼Œå³ä½¿åªæœ‰ <code>4</code> å­—èŠ‚çš„åˆ†é…å•å…ƒï¼Œ<code>32</code> ä½çš„å†…å­˜ä¹Ÿä»…ä»…åªéœ€è¦ä½å›¾ä¸­çš„ <code>1</code> ä½ã€‚<code>32n</code> ä½çš„å†…å­˜éœ€è¦ <code>n</code> ä½çš„ä½å›¾ï¼Œæ‰€ä»¥ <code>1</code> ä¸ªä½å›¾åªå ç”¨äº† <code>1/32</code> çš„å†…å­˜ã€‚å¦‚æœé€‰æ‹©æ›´å¤§çš„å†…å­˜å•å…ƒï¼Œä½å›¾åº”è¯¥è¦æ›´å°ã€‚å¦‚æœè¿›ç¨‹çš„å¤§å°ä¸æ˜¯åˆ†é…å•å…ƒçš„æ•´æ•°å€ï¼Œé‚£ä¹ˆåœ¨æœ€åä¸€ä¸ªåˆ†é…å•å…ƒä¸­ä¼šæœ‰å¤§é‡çš„å†…å­˜è¢«æµªè´¹ã€‚</p><p>ä½å›¾æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•åœ¨å›ºå®šå¤§å°çš„å†…å­˜ä¸­è·Ÿè¸ªå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œå› ä¸º<strong>ä½å›¾çš„å¤§å°å–å†³äºå†…å­˜å’Œåˆ†é…å•å…ƒçš„å¤§å°</strong>ã€‚è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“å†³å®šä¸ºæŠŠå…·æœ‰ <code>k</code> ä¸ªåˆ†é…å•å…ƒçš„è¿›ç¨‹æ”¾å…¥å†…å­˜æ—¶ï¼Œ<code>å†…å®¹ç®¡ç†å™¨(memory manager)</code> å¿…é¡»æœç´¢ä½å›¾ï¼Œåœ¨ä½å›¾ä¸­æ‰¾å‡ºèƒ½å¤Ÿè¿è¡Œ <code>k</code> ä¸ªè¿ç»­ <code>0</code> ä½çš„ä¸²ã€‚<strong>åœ¨ä½å›¾ä¸­æ‰¾å‡ºåˆ¶å®šé•¿åº¦çš„è¿ç»­ <code>0</code> ä¸²æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„æ“ä½œï¼Œè¿™æ˜¯ä½å›¾çš„ç¼ºç‚¹ã€‚</strong></p><h3 id="2-ä½¿ç”¨é“¾è¡¨è¿›è¡Œç®¡ç†"><a class="markdownIt-Anchor" href="#2-ä½¿ç”¨é“¾è¡¨è¿›è¡Œç®¡ç†"></a> 2. ä½¿ç”¨é“¾è¡¨è¿›è¡Œç®¡ç†</h3><p>å¦ä¸€ç§è®°å½•å†…å­˜ä½¿ç”¨æƒ…å†µçš„æ–¹æ³•æ˜¯ï¼Œç»´æŠ¤ä¸€ä¸ªè®°å½•<strong>å·²åˆ†é…å†…å­˜æ®µå’Œç©ºé—²å†…å­˜æ®µçš„é“¾è¡¨</strong>ï¼Œæ®µä¼šåŒ…å«è¿›ç¨‹æˆ–è€…æ˜¯ä¸¤ä¸ªè¿›ç¨‹çš„ç©ºé—²åŒºåŸŸã€‚å¯ç”¨ä¸Šé¢çš„ <code>å›¾ c</code> æ¥è¡¨ç¤ºå†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚é“¾è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½å¯ä»¥ä»£è¡¨ä¸€ä¸ª <code>ç©ºé—²åŒº(H)</code> æˆ–è€…æ˜¯ <code>è¿›ç¨‹(P)</code> çš„èµ·å§‹æ ‡å¿—ï¼Œé•¿åº¦å’Œä¸‹ä¸€ä¸ªé“¾è¡¨é¡¹çš„ä½ç½®ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>æ®µé“¾è¡¨(segment list)</code> æ˜¯æŒ‰ç…§åœ°å€æ’åºçš„ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ï¼Œå½“è¿›ç¨‹ç»ˆæ­¢æˆ–è¢«äº¤æ¢æ—¶ï¼Œæ›´æ–°åˆ—è¡¨å¾ˆç®€å•ã€‚ä¸€ä¸ªç»ˆæ­¢è¿›ç¨‹é€šå¸¸æœ‰ä¸¤ä¸ªé‚»å±…ï¼ˆé™¤äº†å†…å­˜çš„é¡¶éƒ¨å’Œåº•éƒ¨å¤–ï¼‰ã€‚ç›¸é‚»çš„å¯èƒ½æ˜¯è¿›ç¨‹ä¹Ÿå¯èƒ½æ˜¯ç©ºé—²åŒºï¼Œå®ƒä»¬æœ‰å››ç§ç»„åˆæ–¹å¼ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925163044.png" srcset="/img/loading.gif" alt="" /></p><h3 id="3-é¡ºåºæœç´¢çš„åŠ¨æ€å†…å­˜åˆ†é…"><a class="markdownIt-Anchor" href="#3-é¡ºåºæœç´¢çš„åŠ¨æ€å†…å­˜åˆ†é…"></a> 3. é¡ºåºæœç´¢çš„åŠ¨æ€å†…å­˜åˆ†é…</h3><p>å½“æŒ‰ç…§åœ°å€é¡ºåºåœ¨é“¾è¡¨ä¸­å­˜æ”¾è¿›ç¨‹å’Œç©ºé—²åŒºæ—¶ï¼Œæœ‰å‡ ç§ç®—æ³•å¯ä»¥ä¸ºåˆ›å»ºçš„è¿›ç¨‹ï¼ˆæˆ–è€…ä»ç£ç›˜ä¸­æ¢å…¥çš„è¿›ç¨‹ï¼‰åˆ†é…å†…å­˜ã€‚</p><h4 id="31-é¦–æ¬¡é€‚é…first-fit"><a class="markdownIt-Anchor" href="#31-é¦–æ¬¡é€‚é…first-fit"></a> 3.1 <code>é¦–æ¬¡é€‚é…(first fit)</code></h4><p><strong>å†…å­˜ç®¡ç†å™¨ä¼šæ²¿ç€æ®µåˆ—è¡¨è¿›è¡Œæ‰«æï¼Œç›´åˆ°æ‰¾ä¸ªä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç©ºé—²åŒºä¸ºæ­¢</strong>ã€‚é™¤éç©ºé—²åŒºå¤§å°å’Œè¦åˆ†é…çš„ç©ºé—´å¤§å°ä¸€æ ·ï¼Œå¦åˆ™å°†ç©ºé—²åŒºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ä¾›è¿›ç¨‹ä½¿ç”¨ï¼›ä¸€éƒ¨åˆ†ç”Ÿæˆæ–°çš„ç©ºé—²åŒºã€‚é¦–æ¬¡é€‚é…ç®—æ³•æ˜¯ä¸€ç§é€Ÿåº¦å¾ˆå¿«çš„ç®—æ³•ï¼Œå› ä¸ºå®ƒä¼šå°½å¯èƒ½çš„æœç´¢é“¾è¡¨ã€‚</p><h4 id="32-ä¸‹æ¬¡é€‚é…next-fit"><a class="markdownIt-Anchor" href="#32-ä¸‹æ¬¡é€‚é…next-fit"></a> 3.2 <code>ä¸‹æ¬¡é€‚é…(next fit)</code></h4><p>å®ƒå’Œé¦–æ¬¡åŒ¹é…çš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œåªæœ‰ä¸€ä¸ªä¸åŒä¹‹å¤„é‚£å°±æ˜¯<strong>ä¸‹æ¬¡é€‚é…åœ¨æ¯æ¬¡æ‰¾åˆ°åˆé€‚çš„ç©ºé—²åŒºæ—¶å°±ä¼šè®°å½•å½“æ—¶çš„ä½ç½®</strong>ï¼Œä»¥ä¾¿ä¸‹æ¬¡å¯»æ‰¾ç©ºé—²åŒºæ—¶ä»ä¸Šæ¬¡ç»“æŸçš„åœ°æ–¹å¼€å§‹æœç´¢ï¼Œè€Œä¸æ˜¯åƒé¦–æ¬¡åŒ¹é…ç®—æ³•é‚£æ ·æ¯æ¬¡éƒ½ä¼šä»å¤´å¼€å§‹æœç´¢ã€‚</p><h4 id="33-æœ€ä½³é€‚é…best-fit"><a class="markdownIt-Anchor" href="#33-æœ€ä½³é€‚é…best-fit"></a> 3.3 <code>æœ€ä½³é€‚é…(best fit)</code></h4><p>æœ€ä½³é€‚é…ä¼šä»å¤´åˆ°å°¾å¯»æ‰¾æ•´ä¸ªé“¾è¡¨ï¼Œæ‰¾å‡ºèƒ½å¤Ÿå®¹çº³è¿›ç¨‹çš„<strong>æœ€å°ç©ºé—²åŒº</strong>ã€‚æœ€ä½³é€‚é…ç®—æ³•ä¼šè¯•å›¾<strong>æ‰¾å‡ºæœ€æ¥è¿‘å®é™…éœ€è¦çš„ç©ºé—²åŒº</strong>ï¼Œä»¥æœ€å¥½çš„åŒ¹é…è¯·æ±‚å’Œå¯ç”¨ç©ºé—²åŒºï¼Œè€Œä¸æ˜¯å…ˆä¸€æ¬¡æ‹†åˆ†ä¸€ä¸ªä»¥åå¯èƒ½ä¼šç”¨åˆ°çš„å¤§çš„ç©ºé—²åŒºã€‚æ¯”å¦‚ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¤§å°ä¸º 2 çš„å—ï¼Œé‚£ä¹ˆé¦–æ¬¡åŒ¹é…ç®—æ³•ä¼šæŠŠè¿™ä¸ªå—åˆ†é…åœ¨ä½ç½® 5 çš„ç©ºé—²åŒºï¼Œè€Œæœ€ä½³é€‚é…ç®—æ³•ä¼šæŠŠè¯¥å—åˆ†é…åœ¨ä½ç½®ä¸º 18 çš„ç©ºé—²åŒºï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200925162851.png" srcset="/img/loading.gif" alt="" /></p><p>æœ€ä½³é€‚é…ä¼šéå†æ•´ä¸ªé“¾è¡¨ï¼Œæ‰€ä»¥æœ€ä½³é€‚é…ç®—æ³•çš„æ€§èƒ½è¦æ¯”é¦–æ¬¡åŒ¹é…ç®—æ³•å·®ã€‚ä½†æœ€ä½³é€‚é…ç®—æ³•è¦æ¯”é¦–æ¬¡åŒ¹é…å’Œä¸‹æ¬¡åŒ¹é…ç®—æ³•æµªè´¹æ›´å¤šçš„å†…å­˜ï¼Œå› ä¸ºå®ƒä¼šäº§ç”Ÿå¤§é‡æ— ç”¨çš„å°ç¼“å†²åŒºï¼Œé¦–æ¬¡åŒ¹é…ç®—æ³•ç”Ÿæˆçš„ç©ºé—²åŒºä¼šæ›´å¤§ä¸€äº›ã€‚</p><h4 id="34-æœ€å·®é€‚é…worst-fit"><a class="markdownIt-Anchor" href="#34-æœ€å·®é€‚é…worst-fit"></a> 3.4 <code>æœ€å·®é€‚é…(worst fit)</code></h4><p><strong>æ€»æ˜¯åˆ†é…æœ€å¤§çš„å†…å­˜åŒºåŸŸ</strong>ï¼Œä½¿æ–°åˆ†é…çš„ç©ºé—²åŒºæ¯”è¾ƒå¤§ä»è€Œå¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚ä»¿çœŸç¨‹åºè¡¨æ˜æœ€å·®é€‚é…ç®—æ³•ä¹Ÿä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p><h4 id="35-å¿«é€Ÿé€‚é…quick-fit"><a class="markdownIt-Anchor" href="#35-å¿«é€Ÿé€‚é…quick-fit"></a> 3.5 <code>å¿«é€Ÿé€‚é…(quick fit)</code></h4><p><strong>ä¸ºé‚£äº›å¸¸ç”¨å¤§å°çš„ç©ºé—²åŒºç»´æŠ¤å•ç‹¬çš„é“¾è¡¨</strong>ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ª <code>n</code> é¡¹çš„è¡¨ï¼Œè¯¥è¡¨çš„ç¬¬ä¸€é¡¹æ˜¯æŒ‡å‘å¤§å°ä¸º <code>4 KB</code> çš„ç©ºé—²åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆï¼Œç¬¬äºŒé¡¹æ˜¯æŒ‡å‘å¤§å°ä¸º <code>8 KB</code> çš„ç©ºé—²åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆï¼Œç¬¬ä¸‰é¡¹æ˜¯æŒ‡å‘å¤§å°ä¸º <code>12 KB</code> çš„ç©ºé—²åŒºé“¾è¡¨è¡¨å¤´æŒ‡é’ˆï¼Œä»¥æ­¤ç±»æ¨ã€‚æ¯”å¦‚ <code>21 KB</code> è¿™æ ·çš„ç©ºé—²åŒºæ—¢å¯ä»¥æ”¾åœ¨ <code>20 KB</code> çš„é“¾è¡¨ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸€ä¸ªä¸“é—¨å­˜æ”¾å¤§å°æ¯”è¾ƒç‰¹åˆ«çš„ç©ºé—²åŒºé“¾è¡¨ä¸­ã€‚</p><p>å¿«é€ŸåŒ¹é…ç®—æ³•å¯»æ‰¾ä¸€ä¸ªæŒ‡å®šä»£é”€çš„ç©ºé—²åŒºä¹Ÿæ˜¯ååˆ†å¿«é€Ÿçš„ï¼Œä½†å®ƒå’Œæ‰€æœ‰å°†ç©ºé—²åŒºæŒ‰å¤§å°æ’åºçš„æ–¹æ¡ˆä¸€æ ·ï¼Œéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç¼ºç‚¹ï¼Œ<strong>å³åœ¨ä¸€ä¸ªè¿›ç¨‹ç»ˆæ­¢æˆ–è¢«æ¢å‡ºæ—¶ï¼Œå¯»æ‰¾å®ƒçš„ç›¸é‚»å—å¹¶æŸ¥çœ‹æ˜¯å¦å¯ä»¥åˆå¹¶çš„è¿‡ç¨‹éƒ½æ˜¯éå¸¸è€—æ—¶çš„ã€‚</strong> å¦‚æœä¸è¿›è¡Œåˆå¹¶ï¼Œå†…å­˜å°†ä¼šå¾ˆå¿«åˆ†è£‚å‡ºå¤§é‡è¿›ç¨‹æ— æ³•åˆ©ç”¨çš„å°ç©ºé—²åŒºã€‚</p><h1 id="è™šæ‹Ÿå†…å­˜"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿå†…å­˜"></a> è™šæ‹Ÿå†…å­˜</h1><p>åœ¨ä¸€äº›ä¸­å°åº”ç”¨ç¨‹åºå¯ä½¿ç”¨äº¤æ¢æŠ€æœ¯ï¼Œ<strong>å¦‚æœåº”ç”¨ç¨‹åºè¿‡å¤§ï¼Œäº¤æ¢æŠ€æœ¯å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„æ–¹æ¡ˆã€‚</strong><br />ä¸€ä¸ªå…¸å‹çš„ <code>SATA</code> ç£ç›˜çš„å³°å€¼ä¼ è¾“é€Ÿåº¦é«˜è¾¾å‡ ç™¾å…†/ç§’ï¼Œè¿™æ„å‘³ç€éœ€è¦å¥½å‡ ç§’æ‰èƒ½æ¢å‡ºæˆ–è€…æ¢å…¥ä¸€ä¸ª <code>1 GB</code> çš„ç¨‹åºã€‚</p><p><code>è™šæ‹Ÿå†…å­˜(virtual memory)</code> çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œ<strong>æ¯ä¸ªç¨‹åºéƒ½æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œè¿™ä¸ªåœ°å€ç©ºé—´è¢«åˆ’åˆ†ä¸ºå¤šä¸ªç§°ä¸º <code>é¡µé¢(page)</code> çš„å—ã€‚</strong> æ¯ä¸€é¡µéƒ½æ˜¯è¿ç»­çš„åœ°å€èŒƒå›´ã€‚<strong>è¿™äº›é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜</strong>ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„é¡µéƒ½å¿…é¡»åœ¨å†…å­˜ä¸­æ‰èƒ½è¿è¡Œç¨‹åºã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç¡¬ä»¶ä¼šç«‹åˆ»æ‰§è¡Œå¿…è¦çš„æ˜ å°„ã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿè´Ÿè´£å°†ç¼ºå¤±çš„éƒ¨åˆ†è£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„æŒ‡ä»¤ã€‚</p><p>è™šæ‹Ÿå†…å­˜å¾ˆé€‚åˆåœ¨å¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œè®¸å¤šç¨‹åºçš„ç‰‡æ®µåŒæ—¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå½“ä¸€ä¸ªç¨‹åºç­‰å¾…å®ƒçš„ä¸€éƒ¨åˆ†è¯»å…¥å†…å­˜æ—¶ï¼Œå¯ä»¥æŠŠ <code>CPU</code> äº¤ç»™å¦ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚</p><h2 id="åˆ†é¡µ"><a class="markdownIt-Anchor" href="#åˆ†é¡µ"></a> åˆ†é¡µ</h2><p>å¤§éƒ¨åˆ†ä½¿ç”¨è™šæ‹Ÿå†…å­˜çš„ç³»ç»Ÿä¸­éƒ½ä¼šä½¿ç”¨ä¸€ç§ <code>åˆ†é¡µ(paging)</code> æŠ€æœ¯ã€‚åœ¨ä»»ä½•ä¸€å°è®¡ç®—æœºä¸Šï¼Œç¨‹åºä¼šå¼•ç”¨ä½¿ç”¨ä¸€ç»„å†…å­˜åœ°å€ã€‚å½“ç¨‹åºæ‰§è¡Œ</p><pre><code class="hljs assembly">MOV REG, 1000</code></pre><p>è¿™æ¡æŒ‡ä»¤æ—¶ï¼Œå®ƒä¼šæŠŠå†…å­˜åœ°å€ä¸º <code>1000</code> çš„å†…å­˜å•å…ƒçš„å†…å®¹å¤åˆ¶åˆ° <code>REG</code> ä¸­ï¼ˆæˆ–è€…ç›¸åï¼Œè¿™å–å†³äºè®¡ç®—æœºï¼‰ã€‚åœ°å€å¯ä»¥é€šè¿‡ç´¢å¼•ã€åŸºå€å¯„å­˜å™¨ã€æ®µå¯„å­˜å™¨æˆ–å…¶ä»–æ–¹å¼äº§ç”Ÿã€‚</p><p>è¿™äº›ç¨‹åºç”Ÿæˆçš„åœ°å€è¢«ç§°ä¸º <code>è™šæ‹Ÿåœ°å€(virtual addresses)</code> å¹¶å½¢æˆ <code>è™šæ‹Ÿåœ°å€ç©ºé—´(virtual address space)</code>.</p><ul><li>åœ¨æ²¡æœ‰è™šæ‹Ÿå†…å­˜çš„è®¡ç®—æœºä¸Šï¼Œç³»ç»Ÿç›´æ¥å°†è™šæ‹Ÿåœ°å€é€åˆ°å†…å­˜æ€»çº¿ä¸Šï¼Œè¯»å†™æ“ä½œéƒ½ä½¿ç”¨åŒæ ·åœ°å€çš„ç‰©ç†å†…å­˜ã€‚</li><li>åœ¨ä½¿ç”¨è™šæ‹Ÿå†…å­˜æ—¶ï¼Œè™šæ‹Ÿåœ°å€ä¸ä¼šç›´æ¥å‘é€åˆ°å†…å­˜æ€»çº¿ä¸Šã€‚ç›¸åï¼Œä¼šä½¿ç”¨ <code>MMU(Memory Management Unit)</code> å†…å­˜ç®¡ç†å•å…ƒ<strong>æŠŠè™šæ‹Ÿåœ°å€æ˜ å°„ä¸ºç‰©ç†å†…å­˜åœ°å€</strong>ï¼Œåƒä¸‹å›¾è¿™æ ·ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927155103.png" srcset="/img/loading.gif" alt="" /></li></ul><p>ä¸‹é¢è¿™å¹…å›¾å±•ç¤ºäº†è¿™ç§æ˜ å°„æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927155203.png" srcset="/img/loading.gif" alt="" /></p><h3 id="1-å­˜åœ¨æ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„"><a class="markdownIt-Anchor" href="#1-å­˜åœ¨æ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„"></a> 1. å­˜åœ¨æ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„</h3><p>è™šæ‹Ÿåœ°å€ç©ºé—´ç”±å›ºå®šå¤§å°çš„å•å…ƒç»„æˆï¼Œè¿™ç§å›ºå®šå¤§å°çš„å•å…ƒç§°ä¸º <code>é¡µ(pages)</code>ã€‚è€Œç›¸å¯¹çš„ï¼Œç‰©ç†å†…å­˜ä¸­ä¹Ÿæœ‰å›ºå®šå¤§å°çš„ç‰©ç†å•å…ƒï¼Œç§°ä¸º <code>é¡µæ¡†(page frames)</code>ã€‚é¡µå’Œé¡µæ¡†çš„å¤§å°ä¸€æ ·ã€‚åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œé¡µçš„å¤§å°ä¸º <code>4KB</code> ï¼Œä½†æ˜¯å®é™…çš„ä½¿ç”¨è¿‡ç¨‹ä¸­é¡µçš„å¤§å°èŒƒå›´å¯èƒ½æ˜¯ <code>512</code> å­—èŠ‚ - <code>1G</code> å­—èŠ‚çš„å¤§å°ã€‚å¯¹åº”äº <code>64 KB</code> çš„è™šæ‹Ÿåœ°å€ç©ºé—´å’Œ <code>32 KB</code> çš„ç‰©ç†å†…å­˜ï¼Œå¯å¾—åˆ° <code>16</code> ä¸ªè™šæ‹Ÿé¡µé¢å’Œ <code>8</code> ä¸ªé¡µæ¡†ã€‚ <strong><code>RAM</code> å’Œç£ç›˜ä¹‹é—´çš„äº¤æ¢æ€»æ˜¯ä»¥æ•´ä¸ªé¡µä¸ºå•å…ƒè¿›è¡Œäº¤æ¢çš„ã€‚</strong></p><p>ç¨‹åºè¯•å›¾è®¿é—®åœ°å€æ—¶ï¼Œä¾‹å¦‚æ‰§è¡Œä¸‹é¢è¿™æ¡æŒ‡ä»¤ï¼š</p><pre><code class="hljs assembly">MOV REG, 0</code></pre><p>ä¼šå°†è™šæ‹Ÿåœ°å€ <code>0</code> é€åˆ° <code>MMU</code>ã€‚<code>MMU</code> çœ‹åˆ°è™šæ‹Ÿåœ°å€è½åœ¨<code>é¡µé¢ 0</code> ï¼ˆ<code>0 - 4095</code>ï¼‰ï¼Œæ ¹æ®å…¶æ˜ å°„ç»“æœï¼Œè¿™ä¸€é¡µé¢å¯¹åº”çš„<code>é¡µæ¡† 2</code> ï¼ˆ<code>8192 - 12287</code>ï¼‰ï¼Œå› æ­¤ <code>MMU</code> æŠŠåœ°å€å˜æ¢ä¸º <code>8192</code> ï¼Œå¹¶æŠŠåœ°å€ <code>8192</code> é€åˆ°æ€»çº¿ä¸Šã€‚å†…å­˜å¯¹ <code>MMU</code> ä¸€æ— æ‰€çŸ¥ï¼Œå®ƒåªçœ‹åˆ°ä¸€ä¸ªå¯¹ <code>8192</code> åœ°å€çš„è¯»å†™è¯·æ±‚å¹¶æ‰§è¡Œå®ƒã€‚<code>MMU</code> ä»è€Œæœ‰æ•ˆçš„æŠŠæ‰€æœ‰è™šæ‹Ÿåœ°å€ <code>0 - 4095</code> æ˜ å°„åˆ°äº† <code>8192 - 12287</code> çš„ç‰©ç†åœ°å€ã€‚åŒæ ·çš„ï¼ŒæŒ‡ä»¤</p><pre><code class="hljs assembly">MOV REG, 8192</code></pre><p>ä¹Ÿè¢«æœ‰æ•ˆçš„è½¬æ¢ä¸º</p><pre><code class="hljs assembly">MOV REG, 24576</code></pre><p>è™šæ‹Ÿåœ°å€ <code>8192</code>ï¼ˆåœ¨<code>è™šæ‹Ÿé¡µ 2</code> ä¸­ï¼‰è¢«æ˜ å°„åˆ°ç‰©ç†åœ°å€ <code>24576</code>ï¼ˆåœ¨ç‰©ç†<code>é¡µæ¡† 6</code> ä¸­ï¼‰ä¸Šã€‚</p><p>é€šè¿‡æ°å½“çš„è®¾ç½® <code>MMU</code>ï¼Œå¯ä»¥æŠŠ <code>16</code> ä¸ªè™šæ‹Ÿé¡µé¢æ˜ å°„åˆ° <code>8</code> ä¸ªé¡µæ¡†ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚ä½†æ˜¯è¿™å¹¶æ²¡æœ‰è§£å†³è™šæ‹Ÿåœ°å€ç©ºé—´æ¯”ç‰©ç†å†…å­˜å¤§çš„é—®é¢˜ã€‚</p><p>ä¸Šå›¾ä¸­æœ‰ <code>8</code> ä¸ªç‰©ç†é¡µæ¡†ï¼Œäºæ˜¯åªæœ‰ <code>8</code> ä¸ªè™šæ‹Ÿé¡µè¢«æ˜ å°„åˆ°äº†ç‰©ç†å†…å­˜ä¸­ï¼Œåœ¨ä¸Šå›¾ä¸­ç”¨ <code>X</code> å·è¡¨ç¤ºçš„å…¶ä»–é¡µé¢æ²¡æœ‰è¢«æ˜ å°„ã€‚åœ¨å®é™…çš„ç¡¬ä»¶ä¸­ï¼Œä¼šä½¿ç”¨ä¸€ä¸ª <code>åœ¨/ä¸åœ¨(Present/absent bit)ä½</code> è®°å½•é¡µé¢åœ¨å†…å­˜ä¸­çš„å®é™…å­˜åœ¨æƒ…å†µã€‚</p><h3 id="2-æœªæ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„"><a class="markdownIt-Anchor" href="#2-æœªæ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„"></a> 2. æœªæ˜ å°„çš„é¡µå¦‚ä½•æ˜ å°„</h3><p>å½“ç¨‹åºè®¿é—®ä¸€ä¸ªæœªæ˜ å°„çš„é¡µé¢ï¼Œå¦‚æ‰§è¡ŒæŒ‡ä»¤ï¼š</p><pre><code class="hljs assembly">MOV REG, 32780</code></pre><p>å°†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ<code>è™šæ‹Ÿé¡µé¢ 8</code> ï¼ˆä» <code>32768</code> å¼€å§‹ï¼‰çš„ç¬¬ <code>12</code> ä¸ªå­—èŠ‚æ‰€å¯¹åº”çš„ç‰©ç†åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ<code>MMU</code> æ³¨æ„åˆ°è¯¥é¡µé¢æ²¡æœ‰è¢«æ˜ å°„ï¼ˆåœ¨å›¾ä¸­ç”¨ <code>X</code> å·è¡¨ç¤ºï¼‰ï¼Œäºæ˜¯ <code>CPU</code> ä¼šé™·å…¥(<code>trap</code>)åˆ°æ“ä½œç³»ç»Ÿä¸­ã€‚è¿™ä¸ªé™·å…¥ç§°ä¸º <code>ç¼ºé¡µä¸­æ–­(page fault)</code> æˆ–è€…æ˜¯ <code>ç¼ºé¡µé”™è¯¯</code>ã€‚æ“ä½œç³»ç»Ÿä¼šé€‰æ‹©ä¸€ä¸ªå¾ˆå°‘ä½¿ç”¨çš„é¡µå¹¶æŠŠå®ƒçš„å†…å®¹å†™å…¥ç£ç›˜ï¼ˆå¦‚æœå®ƒä¸åœ¨ç£ç›˜ä¸Šï¼‰ã€‚éšåæŠŠéœ€è¦è®¿é—®çš„é¡µé¢è¯»åˆ°åˆšæ‰å›æ”¶çš„é¡µæ¡†ä¸­ï¼Œä¿®æ”¹æ˜ å°„å…³ç³»ï¼Œç„¶åé‡æ–°å¯åŠ¨å¼•èµ·é™·å…¥çš„æŒ‡ä»¤ã€‚æœ‰ç‚¹ä¸å¤ªå¥½ç†è§£ï¼Œä¸¾ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿå†³å®šæ”¾å¼ƒ <code>é¡µæ¡† 1</code>ï¼Œé‚£ä¹ˆå®ƒå°†æŠŠ <code>è™šæ‹Ÿé¡µé¢ 8</code> è£…å…¥ç‰©ç†åœ°å€ <code>4096</code>ï¼Œå¹¶å¯¹ <code>MMU</code> æ˜ å°„åšä¸¤å¤„ä¿®æ”¹ã€‚</p><ul><li>é¦–å…ˆï¼Œå®ƒè¦å°†è™šæ‹Ÿé¡µä¸­çš„ <code>1</code> è¡¨é¡¹æ ‡è®°ä¸º<code>æœªæ˜ å°„</code>ï¼Œä½¿ä»¥åä»»ä½•å¯¹è™šæ‹Ÿåœ°å€ <code>4096 - 8191</code> çš„è®¿é—®éƒ½å°†å¯¼è‡´é™·å…¥ã€‚</li><li>éšåæŠŠè™šæ‹Ÿé¡µé¢ <code>8</code> çš„è¡¨é¡¹çš„å‰å·æ”¹ä¸º <code>1</code>ï¼Œå› æ­¤åœ¨å¼•èµ·é™·é˜±çš„æŒ‡ä»¤é‡æ–°å¯åŠ¨æ—¶ï¼Œå®ƒå°†æŠŠè™šæ‹Ÿåœ°å€ <code>32780</code> æ˜ å°„ä¸ºç‰©ç†åœ°å€ï¼ˆ<code>4096 + 12</code>ï¼‰ã€‚</li></ul><p>ä¸‹é¢æŸ¥çœ‹ä¸€ä¸‹ <code>MMU</code> çš„å†…éƒ¨æ„é€ ä»¥ä¾¿äº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠäº†è§£ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰ç”¨çš„é¡µå¤§å°éƒ½æ˜¯ 2 çš„æ•´æ•°æ¬¡å¹‚ã€‚ä¸‹å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè™šæ‹Ÿåœ°å€çš„ä¾‹å­ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927163045.png" srcset="/img/loading.gif" alt="" /></p><blockquote><p>è™šæ‹Ÿåœ°å€ = è™šæ‹Ÿé¡µå· + é¡µå†…åç§»é‡<br />ç‰©ç†åœ°å€ = (è™šæ‹Ÿåœ°å€é¡µå· -&gt; ç‰©ç†åœ°å€é¡µå·) + é¡µå†…åç§»é‡</p></blockquote><p>è™šæ‹Ÿåœ°å€ <code>8196</code> ï¼ˆ<code>0010000000000100</code>ï¼‰ç”¨ä¸Šé¢çš„é¡µè¡¨æ˜ å°„å›¾æ‰€ç¤ºçš„ <code>MMU</code> æ˜ å°„æœºåˆ¶è¿›è¡Œæ˜ å°„ï¼Œè¾“å…¥çš„ <code>16</code> ä½è™šæ‹Ÿåœ°å€è¢«åˆ†ä¸º <code>4</code> ä½çš„<strong>é¡µå·</strong>å’Œ <code>12</code> ä½çš„<strong>åç§»é‡</strong>ã€‚<code>4</code> ä½çš„é¡µå·å¯ä»¥è¡¨ç¤º <code>16</code> ä¸ªé¡µé¢ï¼Œ<code>12</code> ä½çš„åç§»å¯ä»¥ä¸ºä¸€é¡µå†…çš„å…¨éƒ¨ <code>4096</code> ä¸ªå­—èŠ‚ã€‚</p><p>å¯ç”¨é¡µå·ä½œä¸º <code>é¡µè¡¨(page table)</code> çš„ç´¢å¼•ï¼Œä»¥å¾—å‡ºå¯¹åº”äºè¯¥è™šæ‹Ÿé¡µé¢çš„<strong>é¡µæ¡†å·</strong>ã€‚å¦‚æœåœ¨/ä¸åœ¨ä½æ˜¯ <code>0</code> ï¼Œåˆ™å¼•èµ·ä¸€ä¸ªæ“ä½œç³»ç»Ÿé™·å…¥ã€‚å¦‚æœè¯¥ä½æ˜¯ <code>1</code>ï¼Œåˆ™å°†åœ¨é¡µè¡¨ä¸­æŸ¥åˆ°çš„é¡µæ¡†å·å¤åˆ¶åˆ°è¾“å‡ºå¯„å­˜å™¨çš„<code>é«˜ 3 ä½</code>ä¸­ï¼Œå†åŠ ä¸Šè¾“å…¥è™šæ‹Ÿåœ°å€ä¸­çš„<code>ä½ 12 ä½åç§»é‡</code>ã€‚å¦‚æ­¤å°±æ„æˆäº† <code>15</code> ä½çš„ç‰©ç†åœ°å€ã€‚è¾“å‡ºå¯„å­˜å™¨çš„å†…å®¹éšå³è¢«ä½œä¸ºç‰©ç†åœ°å€é€åˆ°æ€»çº¿ã€‚</p><h2 id="é¡µè¡¨"><a class="markdownIt-Anchor" href="#é¡µè¡¨"></a> é¡µè¡¨</h2><p>åœ¨ä¸Šé¢è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ï¼Œè™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼šè™šæ‹Ÿåœ°å€è¢«åˆ†ä¸º<strong>è™šæ‹Ÿé¡µå·</strong>ï¼ˆé«˜ä½éƒ¨åˆ†ï¼‰å’Œ<strong>åç§»é‡</strong>ï¼ˆä½ä½éƒ¨åˆ†ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¯¹äº <code>16</code> ä½åœ°å€å’Œ <code>4 KB</code> çš„é¡µé¢å¤§å°ï¼Œ<strong>é«˜ 4 ä½</strong>å¯ä»¥æŒ‡å®š <code>16</code> ä¸ªè™šæ‹Ÿé¡µé¢ä¸­çš„ä¸€é¡µï¼Œè€Œ<strong>ä½ 12 ä½</strong>æ¥ç€ç¡®å®šäº†æ‰€é€‰é¡µé¢ä¸­çš„åç§»é‡ï¼ˆ<code>0-4095</code>ï¼‰ã€‚</p><p>è™šæ‹Ÿé¡µå·å¯ä½œä¸ºé¡µè¡¨çš„ç´¢å¼•ç”¨æ¥æ‰¾åˆ°è™šæ‹Ÿé¡µä¸­çš„å†…å®¹ã€‚ç”±é¡µè¡¨é¡¹å¯ä»¥æ‰¾åˆ°é¡µæ¡†å·ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ç„¶åæŠŠé¡µæ¡†å·æ‹¼æ¥åˆ°åç§»é‡çš„é«˜ä½ç«¯ï¼Œä»¥æ›¿æ¢æ‰è™šæ‹Ÿé¡µå·ï¼Œå½¢æˆç‰©ç†åœ°å€ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927164705.png" srcset="/img/loading.gif" alt="" /></p><p>å› æ­¤ï¼Œ<strong>é¡µè¡¨çš„ç›®çš„æ˜¯æŠŠè™šæ‹Ÿé¡µæ˜ å°„åˆ°é¡µæ¡†ä¸­</strong>ã€‚ä»æ•°å­¦ä¸Šè¯´ï¼Œé¡µè¡¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯è™šæ‹Ÿé¡µå·ï¼Œç»“æœæ˜¯ç‰©ç†é¡µæ¡†å·ã€‚</p><h3 id="é¡µè¡¨é¡¹çš„ç»“æ„"><a class="markdownIt-Anchor" href="#é¡µè¡¨é¡¹çš„ç»“æ„"></a> é¡µè¡¨é¡¹çš„ç»“æ„</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927164835.png" srcset="/img/loading.gif" alt="" /></p><p>é¡µè¡¨é¡¹çš„ç»“æ„æ˜¯ä¸æœºå™¨ç›¸å…³çš„ï¼Œä½†æ˜¯ä¸åŒæœºå™¨ä¸Šçš„é¡µè¡¨é¡¹å¤§è‡´ç›¸åŒã€‚ä¸Šé¢æ˜¯ä¸€ä¸ªé¡µè¡¨é¡¹çš„æ„æˆï¼Œä¸åŒè®¡ç®—æœºçš„é¡µè¡¨é¡¹å¯èƒ½ä¸åŒï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯ <code>32</code> ä½çš„ã€‚</p><ul><li><p><code>é¡µæ¡†å·(Page frame number)</code>: é¡µè¡¨é¡¹ä¸­æœ€é‡è¦çš„å­—æ®µï¼Œæ¯•ç«Ÿï¼Œé¡µè¡¨åˆ°é¡µæ¡†æœ€é‡è¦çš„ä¸€æ­¥æ“ä½œå°±æ˜¯è¦æŠŠæ­¤å€¼æ˜ å°„è¿‡å»ã€‚</p></li><li><p><code>åœ¨/ä¸åœ¨(Present/absent bit)ä½</code>: å¦‚æœæ­¤ä½ä¸Šçš„å€¼æ˜¯ 1ï¼Œé‚£ä¹ˆé¡µè¡¨é¡¹æ˜¯æœ‰æ•ˆçš„å¹¶ä¸”èƒ½å¤Ÿè¢«ä½¿ç”¨ã€‚å¦‚æœæ­¤å€¼æ˜¯ 0 çš„è¯ï¼Œåˆ™è¡¨ç¤ºè¯¥é¡µè¡¨é¡¹å¯¹åº”çš„è™šæ‹Ÿé¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼Œè®¿é—®è¯¥é¡µé¢ä¼šå¼•èµ·ä¸€ä¸ª <code>ç¼ºé¡µä¸­æ–­(page fault)</code>ã€‚</p></li><li><p><code>ä¿æŠ¤ä½(Protection)</code>: æŒ‡å‡ºä¸€ä¸ªé¡µå…è®¸ä»€ä¹ˆç±»å‹çš„è®¿é—®ã€‚æœ€ç®€å•çš„è¡¨ç¤ºå½¢å¼æ˜¯è¿™ä¸ªåŸŸåªæœ‰ä¸€ä½ï¼Œ0 è¡¨ç¤ºå¯è¯»å¯å†™ï¼Œ1 è¡¨ç¤ºçš„æ˜¯åªè¯»ã€‚</p></li><li><p><code>ä¿®æ”¹ä½(Modified)</code> å’Œ <code>è®¿é—®ä½(Referenced)</code> ä¼šè·Ÿè¸ªé¡µé¢çš„ä½¿ç”¨æƒ…å†µã€‚å½“ä¸€ä¸ªé¡µé¢è¢«å†™å…¥æ—¶ï¼Œç¡¬ä»¶ä¼šè‡ªåŠ¨çš„è®¾ç½®ä¿®æ”¹ä½ã€‚ä¿®æ”¹ä½åœ¨é¡µé¢é‡æ–°åˆ†é…é¡µæ¡†æ—¶å¾ˆæœ‰ç”¨ã€‚å¦‚æœä¸€ä¸ªé¡µé¢å·²ç»è¢«ä¿®æ”¹è¿‡ï¼ˆå³å®ƒæ˜¯ <code>è„</code> çš„ï¼‰ï¼Œåˆ™å¿…é¡»æŠŠå®ƒå†™å›ç£ç›˜ã€‚å¦‚æœä¸€ä¸ªé¡µé¢æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼ˆå³å®ƒæ˜¯ <code>å¹²å‡€</code> çš„ï¼‰ï¼Œé‚£ä¹ˆé‡æ–°åˆ†é…æ—¶è¿™ä¸ªé¡µæ¡†ä¼šè¢«ç›´æ¥ä¸¢å¼ƒï¼Œå› ä¸ºç£ç›˜ä¸Šçš„å‰¯æœ¬ä»ç„¶æ˜¯æœ‰æ•ˆçš„ã€‚è¿™ä¸ªä½æœ‰æ—¶ä¹Ÿå«åš <code>è„ä½(dirty bit)</code>ï¼Œå› ä¸ºå®ƒåæ˜ äº†é¡µé¢çš„çŠ¶æ€ã€‚</p></li><li><p><code>è®¿é—®ä½(Referenced)</code>: åœ¨é¡µé¢è¢«è®¿é—®æ—¶è¢«è®¾ç½®ï¼Œä¸ç®¡æ˜¯è¯»è¿˜æ˜¯å†™ã€‚è¿™ä¸ªå€¼èƒ½å¤Ÿå¸®åŠ©æ“ä½œç³»ç»Ÿåœ¨å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶é€‰æ‹©è¦æ·˜æ±°çš„é¡µã€‚ä¸å†ä½¿ç”¨çš„é¡µè¦æ¯”æ­£åœ¨ä½¿ç”¨çš„é¡µæ›´é€‚åˆè¢«æ·˜æ±°ã€‚è¿™ä¸ªä½åœ¨åé¢è¦è®¨è®ºçš„é¡µé¢ç½®æ¢ç®—æ³•ä¸­ä½œç”¨å¾ˆå¤§ã€‚</p></li><li><p><code>é«˜é€Ÿç¼“å­˜ç¦æ­¢ä½</code>: ç”¨äºç¦æ­¢è¯¥é¡µé¢è¢«é«˜é€Ÿç¼“å­˜ï¼Œè¿™ä¸ªåŠŸèƒ½å¯¹äºæ˜ å°„åˆ°è®¾å¤‡å¯„å­˜å™¨è¿˜æ˜¯å†…å­˜ä¸­èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚é€šè¿‡è¿™ä¸€ä½å¯ä»¥ç¦ç”¨é«˜é€Ÿç¼“å­˜ã€‚å…·æœ‰ç‹¬ç«‹çš„ <code>I/O</code> ç©ºé—´è€Œä¸æ˜¯ç”¨å†…å­˜æ˜ å°„ <code>I/O</code> çš„æœºå™¨æ¥è¯´ï¼Œå¹¶ä¸éœ€è¦è¿™ä¸€ä½ã€‚</p></li></ul><p>éœ€è¦å¼ºè°ƒä¸€ä¸‹ï¼š<strong>è™šæ‹Ÿå†…å­˜æœ¬è´¨ä¸Šæ˜¯ç”¨æ¥åˆ›é€ ä¸€ä¸ªåœ°å€ç©ºé—´çš„æŠ½è±¡ï¼Œç±»ä¼¼äºè¿›ç¨‹æ˜¯å¯¹ <code>CPU</code> çš„æŠ½è±¡ã€‚è™šæ‹Ÿå†…å­˜çš„å®ç°ï¼Œæœ¬è´¨æ˜¯å°†è™šæ‹Ÿåœ°å€ç©ºé—´åˆ†è§£æˆé¡µï¼Œå¹¶å°†æ¯ä¸€é¡¹æ˜ å°„åˆ°ç‰©ç†å†…å­˜çš„æŸä¸ªé¡µæ¡†ã€‚</strong> å› æ­¤æˆ‘ä»¬çš„é‡ç‚¹æ˜¯å¦‚ä½•ç®¡ç†è¿™ä¸ªè™šæ‹Ÿå†…å­˜çš„æŠ½è±¡ã€‚</p><h2 id="å¿«è¡¨"><a class="markdownIt-Anchor" href="#å¿«è¡¨"></a> å¿«è¡¨</h2><p>å¤§å¤šæ•°ç¨‹åºæ€»æ˜¯å¯¹å°‘é‡é¡µé¢è¿›è¡Œå¤šæ¬¡è®¿é—®ï¼Œè€Œä¸æ˜¯å¯¹å¤§é‡é¡µé¢è¿›è¡Œå°‘é‡è®¿é—®ã€‚å› æ­¤ï¼Œåªæœ‰å¾ˆå°‘çš„é¡µé¢èƒ½å¤Ÿè¢«å†æ¬¡è®¿é—®ï¼Œè€Œå…¶ä»–çš„é¡µè¡¨é¡¹å¾ˆå°‘è¢«è®¿é—®ã€‚</p><blockquote><p>é¡µè¡¨é¡¹ä¸€èˆ¬ä¹Ÿè¢«ç§°ä¸º <code>Page Table Entry(PTE)</code>ã€‚</p></blockquote><p>åŸºäºè¿™ç§è®¾æƒ³ï¼Œæå‡ºäº†ä¸€ç§æ–¹æ¡ˆï¼Œå³ä»ç¡¬ä»¶æ–¹é¢æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸ºè®¡ç®—æœºè®¾ç½®ä¸€ä¸ªå°å‹çš„ç¡¬ä»¶è®¾å¤‡ï¼Œèƒ½å¤Ÿå°†è™šæ‹Ÿåœ°å€ç›´æ¥æ˜ å°„åˆ°ç‰©ç†åœ°å€ï¼Œè€Œä¸å¿…å†è®¿é—®å†…å­˜ä¸­çš„é¡µè¡¨ã€‚è¿™ç§è®¾å¤‡è¢«ç§°ä¸º <code>è½¬æ¢æ£€æµ‹ç¼“å†²åŒº(Translation Lookaside Buffer, TLB)</code>ï¼Œæœ‰æ—¶åˆè¢«ç§°ä¸º <code>ç›¸è”å­˜å‚¨å™¨(associate memory)</code>ã€‚</p><p><code>TLB</code> é€šå¸¸ä½äº <code>MMU</code> ä¸­ï¼ŒåŒ…å«å°‘é‡çš„è¡¨é¡¹ï¼Œæ¯ä¸ªè¡¨é¡¹éƒ½è®°å½•äº†é¡µé¢çš„ç›¸å…³ä¿¡æ¯ï¼Œé™¤äº†è™šæ‹Ÿé¡µå·å¤–ï¼Œå…¶ä»–è¡¨é¡¹éƒ½å’Œé¡µè¡¨æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927172214.png" srcset="/img/loading.gif" alt="" /></p><p><code>TLB</code> å…¶å®å°±æ˜¯ä¸€ç§<strong>å†…å­˜ç¼“å­˜ï¼Œç”¨äºå‡å°‘è®¿é—®å†…å­˜æ‰€éœ€è¦çš„æ—¶é—´</strong>ï¼Œå®ƒå°±æ˜¯ <code>MMU</code> çš„ä¸€éƒ¨åˆ†ï¼Œ<code>TLB</code> ä¼šå°†è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢å­˜å‚¨èµ·æ¥ï¼Œé€šå¸¸å¯ä»¥ç§°ä¸º <code>åœ°å€ç¿»è¯‘ç¼“å­˜(address-translation cache)</code>ã€‚<code>TLB</code> é€šå¸¸ä½äº <code>CPU</code> å’Œ <code>CPU</code> ç¼“å­˜ä¹‹é—´ï¼Œå®ƒä¸ <code>CPU</code> ç¼“å­˜æ˜¯ä¸åŒçš„ç¼“å­˜çº§åˆ«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>TLB</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>å½“ä¸€ä¸ª <code>MMU</code> ä¸­çš„è™šæ‹Ÿåœ°å€éœ€è¦è¿›è¡Œè½¬æ¢æ—¶ï¼Œç¡¬ä»¶é¦–å…ˆæ£€æŸ¥è™šæ‹Ÿé¡µå·ä¸ <code>TLB</code> ä¸­æ‰€æœ‰è¡¨é¡¹è¿›è¡Œå¹¶è¡ŒåŒ¹é…ï¼Œåˆ¤æ–­è™šæ‹Ÿé¡µæ˜¯å¦åœ¨ <code>TLB</code> ä¸­ã€‚å¦‚æœæ‰¾åˆ°äº†æœ‰æ•ˆåŒ¹é…é¡¹ï¼Œå¹¶ä¸”è¦è¿›è¡Œçš„è®¿é—®æ“ä½œæ²¡æœ‰è¿åä¿æŠ¤ä½çš„è¯ï¼Œåˆ™å°†é¡µæ¡†å·ç›´æ¥ä» <code>TLB</code> ä¸­å–å‡ºè€Œ<strong>ä¸ç”¨å†ç›´æ¥è®¿é—®é¡µè¡¨</strong>ã€‚å¦‚æœè™šæ‹Ÿé¡µåœ¨ <code>TLB</code> ä¸­ä½†æ˜¯è¿åäº†ä¿æŠ¤ä½çš„æƒé™çš„è¯ï¼ˆæ¯”å¦‚åªå…è®¸è¯»ä½†æ˜¯æ˜¯ä¸€ä¸ªå†™æŒ‡ä»¤ï¼‰ï¼Œåˆ™ä¼šç”Ÿæˆä¸€ä¸ª <code>ä¿æŠ¤é”™è¯¯(protection fault)</code> è¿”å›ã€‚</p><p>ä¸Šé¢æ¢è®¨çš„æ˜¯è™šæ‹Ÿåœ°å€åœ¨ <code>TLB</code> ä¸­çš„æƒ…å†µï¼Œé‚£ä¹ˆå¦‚æœè™šæ‹Ÿåœ°å€ä¸å† <code>TLB</code> ä¸­è¯¥æ€ä¹ˆåŠï¼Ÿå¦‚æœ <code>MMU</code> æ£€æµ‹åˆ°æ²¡æœ‰æœ‰æ•ˆçš„åŒ¹é…é¡¹ï¼Œå°±ä¼šè¿›è¡Œæ­£å¸¸çš„é¡µè¡¨æŸ¥æ‰¾ï¼Œç„¶åä» <code>TLB</code> ä¸­é€å‡ºä¸€ä¸ªè¡¨é¡¹ç„¶åæŠŠä»é¡µè¡¨ä¸­æ‰¾åˆ°çš„é¡¹æ”¾åœ¨ <code>TLB</code> ä¸­ã€‚å½“ä¸€ä¸ªè¡¨é¡¹è¢«ä» <code>TLB</code> ä¸­æ¸…é™¤å‡ºï¼Œå°†ä¿®æ”¹ä½å¤åˆ¶åˆ°å†…å­˜ä¸­é¡µè¡¨é¡¹ï¼Œé™¤äº†è®¿é—®ä½ä¹‹å¤–ï¼Œå…¶ä»–ä½ä¿æŒä¸å˜ã€‚å½“é¡µè¡¨é¡¹ä»é¡µè¡¨è£…å…¥ <code>TLB</code> ä¸­æ—¶ï¼Œæ‰€æœ‰çš„å€¼éƒ½æ¥è‡ªäºå†…å­˜ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200927172423.png" srcset="/img/loading.gif" alt="" /></p><h1 id="é¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#é¡µé¢ç½®æ¢ç®—æ³•"></a> é¡µé¢ç½®æ¢ç®—æ³•</h1><p>å½“å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»åœ¨å†…å­˜ä¸­é€‰æ‹©ä¸€ä¸ªé¡µé¢å°†å…¶æ¢å‡ºå†…å­˜ï¼Œä»¥ä¾¿ä¸ºå³å°†è°ƒå…¥çš„é¡µé¢è…¾å‡ºç©ºé—´ã€‚<br />å¦‚æœè¦æ¢å‡ºçš„é¡µé¢åœ¨å†…å­˜é©»ç•™æœŸé—´å·²ç»è¢«ä¿®æ”¹è¿‡ï¼Œå°±å¿…é¡»æŠŠå®ƒå†™å›ç£ç›˜ä»¥æ›´æ–°è¯¥é¡µé¢åœ¨ç£ç›˜ä¸Šçš„å‰¯æœ¬ï¼›å¦‚æœè¯¥é¡µé¢æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œé‚£ä¹ˆç£ç›˜å‰¯æœ¬å·²ç»æ˜¯æœ€æ–°çš„ï¼Œä¸éœ€è¦å›å†™ï¼Œç›´æ¥ç”¨è°ƒå…¥çš„é¡µé¢è¦†ç›–è¢«æ·˜æ±°çš„é¡µé¢å°±å¯ä»¥äº†ã€‚</p><p>å½“å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œè™½ç„¶å¯ä»¥éšæœºçš„é€‰æ‹©ä¸€ä¸ªé¡µé¢è¿›è¡Œç½®æ¢ï¼Œä½†æ˜¯å¦‚æœæ¯æ¬¡éƒ½é€‰æ‹©ä¸€ä¸ªä¸å¸¸ç”¨çš„é¡µé¢ä¼šæå‡ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><blockquote><p><code>æŠ–åŠ¨ï¼ˆThrashingï¼‰</code>: å¦‚æœä¸€ä¸ªç»å¸¸ä½¿ç”¨çš„é¡µé¢è¢«æ¢å‡ºï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µé¢åœ¨çŸ­æ—¶é—´å†…åˆå¯èƒ½è¢«é‡å¤ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±å¯èƒ½ä¼šé€ æˆé¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</p></blockquote><h2 id="1-æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#1-æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•"></a> 1. æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•</h2><p>æœ€ä¼˜ <code>(Optimal)</code> é¡µé¢ç½®æ¢ç®—æ³•æ˜¯ä¸€ç§ç†è®ºä¸Šçš„ç®—æ³•ï¼Œ<strong>å…¶æ‰€é€‰æ‹©çš„è¢«æ·˜æ±°é¡µå°†æ˜¯ä»¥åæ°¸ä¸ä½¿ç”¨çš„ï¼Œæˆ–è®¸æ˜¯åœ¨æœ€é•¿ï¼ˆæœªæ¥ï¼‰æ—¶é—´å†…ä¸å†è¢«è®¿é—®çš„é¡µé¢ã€‚</strong> é‡‡ç”¨æœ€ä¼˜ç½®æ¢ç®—æ³•é€šå¸¸å¯ä¿è¯è·å¾—æœ€ä½çš„ç¼ºé¡µç‡ã€‚ä½†ç”±äºç›®å‰äººä»¬è¿˜æ— æ³•é¢„çŸ¥ï¼Œä¸€ä¸ªè¿›ç¨‹åœ¨å†…å­˜çš„è‹¥å¹²ä¸ªé¡µé¢ä¸­ï¼Œå“ªä¸€ä¸ªé¡µé¢æ˜¯æœªæ¥æœ€é•¿æ—¶é—´å†…ä¸å†è¢«è®¿é—®çš„ï¼Œå› è€Œè¯¥ç®—æ³•æ˜¯æ— æ³•å®ç°çš„ï¼Œä½†å¯ä»¥åˆ©ç”¨è¯¥ç®—æ³•å–è¯„ä»·å…¶ä»–ç®—æ³•ã€‚</p><p>æœ€ä¼˜åŒ–çš„é¡µé¢ç®—æ³•è¡¨æ˜åº”è¯¥æ ‡è®°æœ€å¤§çš„é¡µé¢ã€‚å¦‚æœä¸€ä¸ªé¡µé¢åœ¨ 800 ä¸‡æ¡æŒ‡ä»¤å†…ä¸ä¼šè¢«ä½¿ç”¨ï¼Œå¦å¤–ä¸€ä¸ªé¡µé¢åœ¨ 600 ä¸‡æ¡æŒ‡ä»¤å†…ä¸ä¼šè¢«ä½¿ç”¨ï¼Œåˆ™ç½®æ¢å‰ä¸€ä¸ªé¡µé¢ï¼Œä»è€ŒæŠŠéœ€è¦è°ƒå…¥è¿™ä¸ªé¡µé¢è€Œå‘ç”Ÿçš„ç¼ºé¡µä¸­æ–­æ¨è¿Ÿã€‚è®¡ç®—æœºä¹Ÿåƒäººç±»ä¸€æ ·ï¼Œä¼šæŠŠä¸æ„¿æ„åšçš„äº‹æƒ…å°½å¯èƒ½çš„å¾€åæ‹–ã€‚</p><p>è¿™ä¸ªç®—æ³•æœ€å¤§çš„é—®é¢˜æ—¶<strong>æ— æ³•å®ç°</strong>ã€‚å½“ç¼ºé¡µä¸­æ–­å‘ç”Ÿæ—¶ï¼Œæ“ä½œç³»ç»Ÿæ— æ³•çŸ¥é“å„ä¸ªé¡µé¢çš„ä¸‹ä¸€æ¬¡å°†åœ¨ä»€ä¹ˆæ—¶å€™è¢«è®¿é—®ã€‚è¿™ç§ç®—æ³•åœ¨å®é™…è¿‡ç¨‹ä¸­æ ¹æœ¬ä¸ä¼šä½¿ç”¨ã€‚</p><h2 id="2-æœ€è¿‘æœªä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•-nru"><a class="markdownIt-Anchor" href="#2-æœ€è¿‘æœªä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•-nru"></a> 2. æœ€è¿‘æœªä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³• (NRU)</h2><p>ä¸ºäº†èƒ½å¤Ÿè®©æ“ä½œç³»ç»Ÿæ”¶é›†é¡µé¢ä½¿ç”¨ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨è™šæ‹Ÿåœ°å€çš„è®¡ç®—æœºéƒ½æœ‰ä¸¤ä¸ªçŠ¶æ€ä½ï¼Œ<code>R</code> å’Œ <code>M</code>ï¼Œæ¥å’Œæ¯ä¸ªé¡µé¢è¿›è¡Œå…³è”ã€‚æ¯å½“<strong>è®¿é—®</strong>é¡µé¢æ—¶éƒ½è®¾ç½® <code>R</code>ï¼Œ<strong>å†™å…¥</strong>é¡µé¢æ—¶è®¾ç½® <code>M</code>ï¼Œè¿™äº›ä½åŒ…å«åœ¨æ¯ä¸ªé¡µè¡¨é¡¹ä¸­ï¼Œå°±åƒä¸‹é¢æ‰€ç¤ºï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928123701.png" srcset="/img/loading.gif" alt="" /><br />å› ä¸ºæ¯æ¬¡è®¿é—®æ—¶éƒ½ä¼šæ›´æ–°è¿™äº›ä½ï¼Œå› æ­¤ç”±ç¡¬ä»¶æ¥è®¾ç½®å®ƒä»¬éå¸¸é‡è¦ã€‚ä¸€æ—¦æŸä¸ªä½è¢«è®¾ç½®ä¸º <code>1</code>ï¼Œå°±ä¼šä¸€ç›´ä¿æŒ <code>1</code> ç›´åˆ°æ“ä½œç³»ç»Ÿä¸‹æ¬¡æ¥ä¿®æ”¹æ­¤ä½ã€‚</p><p>å¦‚æœç¡¬ä»¶æ²¡æœ‰è¿™äº›ä½ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„<code>ç¼ºé¡µä¸­æ–­</code>å’Œ<code>æ—¶é’Ÿä¸­æ–­</code>æœºåˆ¶æ¥è¿›è¡Œæ¨¡æ‹Ÿã€‚å½“å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œå°†å…¶æ‰€æœ‰çš„é¡µé¢éƒ½æ ‡è®°ä¸ºä¸åœ¨å†…å­˜ï¼›ä¸€æ—¦è®¿é—®ä»»ä½•ä¸€ä¸ªé¡µé¢å°±ä¼šå¼•å‘ä¸€æ¬¡ç¼ºé¡µä¸­æ–­ï¼Œæ­¤æ—¶æ“ä½œç³»ç»Ÿå°±å¯ä»¥è®¾ç½® <code>R ä½(åœ¨å®ƒçš„å†…éƒ¨è¡¨ä¸­)</code>ï¼Œä¿®æ”¹é¡µè¡¨é¡¹ä½¿å…¶æŒ‡å‘æ­£ç¡®çš„é¡µé¢ï¼Œå¹¶è®¾ç½®ä¸º <code>READ ONLY</code> æ¨¡å¼ï¼Œç„¶åé‡æ–°å¯åŠ¨å¼•èµ·ç¼ºé¡µä¸­æ–­çš„æŒ‡ä»¤ã€‚å¦‚æœé¡µé¢éšåè¢«ä¿®æ”¹ï¼Œå°±ä¼šå‘ç”Ÿå¦ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ã€‚ä»è€Œå…è®¸æ“ä½œç³»ç»Ÿè®¾ç½® <code>M</code> ä½å¹¶æŠŠé¡µé¢çš„æ¨¡å¼è®¾ç½®ä¸º <code>READ/WRITE</code>ã€‚</p><p>å¯ä»¥ç”¨ <code>R</code> ä½å’Œ <code>M</code> ä½æ¥æ„é€ ä¸€ä¸ªç®€å•çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼šå½“å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†å…¶æ‰€æœ‰é¡µé¢çš„ä¸¤ä¸ªä½éƒ½è®¾ç½®ä¸º <code>0</code>ã€‚<code>R</code> ä½å®šæœŸçš„è¢«æ¸…é›¶ï¼ˆåœ¨æ¯ä¸ªæ—¶é’Ÿä¸­æ–­ï¼‰ã€‚ç”¨æ¥å°†æœ€è¿‘æœªå¼•ç”¨çš„é¡µé¢å’Œå·²å¼•ç”¨çš„é¡µé¢åˆ†å¼€ã€‚</p><p>å½“å‡ºç°ç¼ºé¡µä¸­æ–­åï¼Œæ“ä½œç³»ç»Ÿä¼šæ£€æŸ¥æ‰€æœ‰çš„é¡µé¢ï¼Œå¹¶æ ¹æ®å®ƒä»¬çš„ <code>R</code> ä½å’Œ <code>M</code> ä½å°†å½“å‰å€¼åˆ†ä¸ºå››ç±»ï¼š</p><ul><li>ç¬¬ 0 ç±»ï¼šæ²¡æœ‰å¼•ç”¨ Rï¼Œæ²¡æœ‰ä¿®æ”¹ M</li><li>ç¬¬ 1 ç±»ï¼šæ²¡æœ‰å¼•ç”¨ Rï¼Œå·²ä¿®æ”¹ M</li><li>ç¬¬ 2 ç±»ï¼šå¼•ç”¨ R ï¼Œæ²¡æœ‰ä¿®æ”¹ M</li><li>ç¬¬ 3 ç±»ï¼šå·²è¢«è®¿é—® Rï¼Œå·²è¢«ä¿®æ”¹ M</li></ul><p>å°½ç®¡çœ‹èµ·æ¥å¥½åƒæ— æ³•å®ç°ç¬¬ä¸€ç±»é¡µé¢ï¼Œä½†æ˜¯å½“ç¬¬ä¸‰ç±»é¡µé¢çš„ <code>R</code> ä½è¢«æ—¶é’Ÿä¸­æ–­æ¸…é™¤æ—¶ï¼Œå®ƒä»¬å°±ä¼šå‘ç”Ÿã€‚æ—¶é’Ÿä¸­æ–­ä¸ä¼šæ¸…é™¤ <code>M</code> ä½ï¼Œå› ä¸ºéœ€è¦è¿™ä¸ªä¿¡æ¯æ‰èƒ½çŸ¥é“æ˜¯å¦å†™å›ç£ç›˜ä¸­ã€‚æ¸…é™¤ <code>R</code> ä½†ä¸æ¸…é™¤ <code>M</code> ä¼šå¯¼è‡´å‡ºç°ä¸€ç±»é¡µé¢ã€‚</p><p><code>NRU(Not Recently Used)</code> ç®—æ³•ä»ç¼–å·æœ€å°çš„éç©ºç±»ä¸­éšæœºåˆ é™¤ä¸€ä¸ªé¡µé¢ã€‚æ­¤ç®—æ³•éšå«çš„æ€æƒ³æ˜¯ï¼Œåœ¨ä¸€ä¸ªæ—¶é’Ÿå†…ï¼ˆçº¦ 20 msï¼‰<strong>æ·˜æ±°ä¸€ä¸ªå·²ä¿®æ”¹ä½†æ˜¯æ²¡æœ‰è¢«è®¿é—®çš„é¡µé¢</strong>è¦æ¯”ä¸€ä¸ªå¤§é‡å¼•ç”¨çš„æœªä¿®æ”¹é¡µé¢å¥½ï¼ŒNRU çš„ä¸»è¦ä¼˜ç‚¹æ˜¯<strong>æ˜“äºç†è§£å¹¶ä¸”èƒ½å¤Ÿæœ‰æ•ˆçš„å®ç°</strong>ã€‚</p><h2 id="3-å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³•-fifo"><a class="markdownIt-Anchor" href="#3-å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³•-fifo"></a> 3. å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³• (FIFO)</h2><p>æ“ä½œç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªæ‰€æœ‰åœ¨å½“å‰å†…å­˜ä¸­çš„é¡µé¢çš„é“¾è¡¨ï¼Œæœ€æ—©è¿›å…¥çš„æ”¾åœ¨è¡¨å¤´ï¼Œæœ€æ–°è¿›å…¥çš„é¡µé¢æ”¾åœ¨è¡¨å°¾ã€‚åœ¨å‘ç”Ÿç¼ºé¡µå¼‚å¸¸æ—¶ï¼Œä¼šæŠŠå¤´éƒ¨çš„é¡µç§»é™¤å¹¶ä¸”æŠŠæ–°çš„é¡µæ·»åŠ åˆ°è¡¨å°¾ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928125343.png" srcset="/img/loading.gif" alt="" /></p><h2 id="4-ç¬¬äºŒæ¬¡æœºä¼šé¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#4-ç¬¬äºŒæ¬¡æœºä¼šé¡µé¢ç½®æ¢ç®—æ³•"></a> 4. ç¬¬äºŒæ¬¡æœºä¼šé¡µé¢ç½®æ¢ç®—æ³•</h2><p>FIFO å¯èƒ½ä¼šæŠŠç»å¸¸ä½¿ç”¨çš„é¡µé¢ç½®æ¢å‡ºå»ï¼Œä¸ºäº†é¿å…è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹è¯¥ç®—æ³•åšä¸€ä¸ªç®€å•çš„ä¿®æ”¹ï¼šæˆ‘ä»¬æ£€æŸ¥æœ€è€é¡µé¢çš„ <code>R</code> ä½ï¼Œ</p><ul><li>å¦‚æœæ˜¯ <code>0</code> ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µé¢å°±æ˜¯<strong>æœ€è€çš„è€Œä¸”æ²¡æœ‰è¢«ä½¿ç”¨</strong>ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µé¢å°±ä¼šè¢«ç«‹åˆ»æ¢å‡ºã€‚</li><li>å¦‚æœ <code>R</code> ä½æ˜¯ <code>1</code>ï¼Œé‚£ä¹ˆå°±æ¸…é™¤æ­¤ä½ï¼Œæ­¤é¡µé¢ä¼šè¢«æ”¾åœ¨é“¾è¡¨çš„å°¾éƒ¨ï¼Œä¿®æ”¹å®ƒçš„è£…å…¥æ—¶é—´å°±åƒåˆšæ”¾è¿›æ¥çš„ä¸€æ ·ã€‚ç„¶åç»§ç»­æœç´¢ã€‚</li></ul><p>è¿™ç§ç®—æ³•å«åš <code>ç¬¬äºŒæ¬¡æœºä¼š(second chance)</code> ç®—æ³•ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼Œæˆ‘ä»¬çœ‹åˆ°é¡µé¢ <code>A</code> åˆ° <code>H</code> ä¿ç•™åœ¨é“¾è¡¨ä¸­ï¼Œå¹¶æŒ‰åˆ°è¾¾å†…å­˜çš„æ—¶é—´æ’åºã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928131405.png" srcset="/img/loading.gif" alt="" /></p><p>å‡è®¾ç¼ºé¡µå¼‚å¸¸å‘ç”Ÿåœ¨æ—¶åˆ» <code>20</code> å¤„ï¼Œè¿™æ—¶æœ€è€çš„é¡µé¢æ˜¯ <code>A</code> ï¼Œå®ƒæ˜¯åœ¨ <code>0</code> æ—¶åˆ»åˆ°è¾¾çš„ã€‚</p><ul><li>å¦‚æœ <code>A</code> çš„ <code>R</code> ä½æ˜¯ <code>0</code>ï¼Œé‚£ä¹ˆå®ƒå°†è¢«æ·˜æ±°å‡ºå†…å­˜ï¼Œæˆ–è€…æŠŠå®ƒå†™å›ç£ç›˜ï¼ˆå¦‚æœå®ƒå·²ç»è¢«ä¿®æ”¹è¿‡ï¼‰ï¼Œæˆ–è€…åªæ˜¯ç®€å•çš„æ”¾å¼ƒï¼ˆå¦‚æœå®ƒæ˜¯æœªè¢«ä¿®æ”¹è¿‡ï¼‰ã€‚</li><li>å¦‚æœå®ƒçš„ <code>R</code> ä½å·²ç»è®¾ç½®äº†ï¼Œåˆ™å°† <code>A</code> æ”¾åˆ°é“¾è¡¨çš„å°¾éƒ¨å¹¶ä¸”é‡æ–°è®¾ç½®è£…å…¥æ—¶é—´ä¸ºå½“å‰æ—¶åˆ»ï¼ˆ20 å¤„ï¼‰ï¼Œç„¶åæ¸…é™¤ <code>R</code> ä½ã€‚ç„¶åä» <code>B</code> é¡µé¢å¼€å§‹ç»§ç»­æœç´¢åˆé€‚çš„é¡µé¢ã€‚</li></ul><p>å¯»æ‰¾ç¬¬äºŒæ¬¡æœºä¼šçš„æ˜¯åœ¨<strong>æœ€è¿‘çš„æ—¶é’Ÿé—´éš”ä¸­æœªè¢«è®¿é—®è¿‡çš„é¡µé¢</strong>ã€‚å¦‚æœæ‰€æœ‰çš„é¡µé¢éƒ½è¢«è®¿é—®è¿‡ï¼Œè¯¥ç®—æ³•å°±ä¼šè¢«ç®€åŒ–ä¸ºå•çº¯çš„ <code>FIFO</code> ç®—æ³•ã€‚<br />å…·ä½“æ¥è¯´ï¼Œå‡è®¾å›¾ <code>a</code> ä¸­æ‰€æœ‰é¡µé¢éƒ½è®¾ç½®äº† <code>R</code> ä½ã€‚æ“ä½œç³»ç»Ÿå°†é¡µé¢ä¾æ¬¡ç§»åˆ°é“¾è¡¨æœ«å°¾ï¼Œæ¯æ¬¡éƒ½åœ¨æ·»åŠ åˆ°æœ«å°¾æ—¶æ¸…é™¤ <code>R</code> ä½ã€‚æœ€åï¼Œç®—æ³•åˆä¼šå›åˆ°é¡µé¢ <code>A</code>ï¼Œæ­¤æ—¶çš„ <code>R</code> ä½å·²ç»è¢«æ¸…é™¤ï¼Œé‚£ä¹ˆé¡µé¢ <code>A</code> å°±ä¼šè¢«æ‰§è¡Œå‡ºé“¾å¤„ç†ï¼Œå› æ­¤ç®—æ³•èƒ½å¤Ÿæ­£å¸¸ç»“æŸã€‚</p><h2 id="5-æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•-clock"><a class="markdownIt-Anchor" href="#5-æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•-clock"></a> 5. æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³• (Clock)</h2><p>ç¬¬äºŒæ¬¡é¡µé¢ç½®æ¢ç®—æ³•ç»å¸¸è¦åœ¨é“¾è¡¨ä¸­ç§»åŠ¨é¡µé¢ï¼Œæ—¢é™ä½äº†æ•ˆç‡ï¼Œè€Œä¸”è¿™ç§ç®—æ³•ä¹Ÿä¸æ˜¯å¿…é¡»çš„ã€‚ä¸€ç§æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯æŠŠæ‰€æœ‰çš„é¡µé¢éƒ½ä¿å­˜åœ¨ä¸€ä¸ªç±»ä¼¼é’Ÿé¢çš„ç¯å½¢é“¾è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨é’ˆæŒ‡å‘æœ€è€çš„é¡µé¢ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928131906.png" srcset="/img/loading.gif" alt="" /><br />å½“ç¼ºé¡µé”™è¯¯å‡ºç°æ—¶ï¼Œç®—æ³•é¦–å…ˆæ£€æŸ¥è¡¨é’ˆæŒ‡å‘çš„é¡µé¢ï¼Œ</p><ul><li>å¦‚æœå®ƒçš„ <code>R</code> ä½æ˜¯ <code>0</code> å°±æ·˜æ±°è¯¥é¡µé¢ï¼Œå¹¶æŠŠæ–°çš„é¡µé¢æ’å…¥åˆ°è¿™ä¸ªä½ç½®ï¼Œç„¶åæŠŠè¡¨é’ˆå‘å‰ç§»åŠ¨ä¸€ä½ï¼›</li><li>å¦‚æœ <code>R</code> ä½æ˜¯ <code>1</code> å°±æ¸…é™¤ R ä½å¹¶æŠŠè¡¨é’ˆå‰ç§»ä¸€ä¸ªä½ç½®ã€‚</li></ul><p>é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°æ‰¾åˆ°äº†ä¸€ä¸ª <code>R</code> ä½ä¸º <code>0</code> çš„é¡µé¢ä½ç½®ã€‚</p><h2 id="6-æœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•-lru"><a class="markdownIt-Anchor" href="#6-æœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•-lru"></a> 6. æœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³• (LRU)</h2><p>åœ¨å‰é¢å‡ æ¡æŒ‡ä»¤ä¸­é¢‘ç¹ä½¿ç”¨çš„é¡µé¢å¾ˆå¯èƒ½åœ¨åé¢çš„å‡ æ¡æŒ‡ä»¤ä¸­è¢«ä½¿ç”¨ã€‚åè¿‡æ¥è¯´ï¼Œå·²ç»å¾ˆä¹…æ²¡æœ‰ä½¿ç”¨çš„é¡µé¢æœ‰å¯èƒ½åœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…ä»ä¸ä¼šè¢«ä½¿ç”¨ã€‚è¿™ä¸ªæ€æƒ³æ­ç¤ºäº†ä¸€ä¸ªå¯ä»¥å®ç°çš„ç®—æ³•ï¼šåœ¨ç¼ºé¡µä¸­æ–­æ—¶ï¼Œç½®æ¢æœªä½¿ç”¨æ—¶é—´æœ€é•¿çš„é¡µé¢ã€‚è¿™ä¸ªç­–ç•¥ç§°ä¸º <code>LRU(Least Recently Used)</code>ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•ã€‚</p><p>è™½ç„¶ <code>LRU</code> åœ¨ç†è®ºä¸Šæ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯ä»é•¿è¿œçœ‹æ¥ä»£ä»·æ¯”è¾ƒé«˜ã€‚ä¸ºäº†å®Œå…¨å®ç° <code>LRU</code>ï¼Œä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæ‰€æœ‰é¡µé¢çš„é“¾è¡¨ï¼Œ<strong>æœ€é¢‘ç¹ä½¿ç”¨çš„é¡µä½äºè¡¨å¤´ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é¡µä½äºè¡¨å°¾</strong>ã€‚å›°éš¾çš„æ˜¯åœ¨<strong>æ¯æ¬¡å†…å­˜å¼•ç”¨æ—¶æ›´æ–°æ•´ä¸ªé“¾è¡¨</strong>ã€‚åœ¨é“¾è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ªé¡µé¢ï¼Œåˆ é™¤å®ƒï¼Œç„¶åæŠŠå®ƒç§»åŠ¨åˆ°è¡¨å¤´æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œï¼Œå³ä½¿ä½¿ç”¨ç¡¬ä»¶æ¥å®ç°ä¹Ÿæ˜¯ä¸€æ ·çš„è´¹æ—¶ã€‚</p><p>ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥é€šè¿‡ç¡¬ä»¶å®ç° <code>LRU</code>ã€‚è¿™ä¸ªæ–¹æ³•è¦æ±‚ç¡¬ä»¶æœ‰ä¸€ä¸ª <code>64</code> ä½çš„è®¡æ•°å™¨ï¼Œå®ƒåœ¨æ¯æ¡æŒ‡ä»¤æ‰§è¡Œå®Œæˆåè‡ªåŠ¨åŠ  <code>1</code>ï¼Œæ¯ä¸ªé¡µè¡¨å¿…é¡»æœ‰ä¸€ä¸ªè¶³å¤Ÿå®¹çº³è¿™ä¸ªè®¡æ•°å™¨å€¼çš„åŸŸã€‚åœ¨æ¯æ¬¡è®¿é—®å†…å­˜åï¼Œå°†å½“å‰çš„å€¼ä¿å­˜åˆ°è¢«è®¿é—®é¡µé¢çš„é¡µè¡¨é¡¹ä¸­ã€‚ä¸€æ—¦å‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œæ“ä½œç³»ç»Ÿå°±æ£€æŸ¥æ‰€æœ‰é¡µè¡¨é¡¹ä¸­è®¡æ•°å™¨çš„å€¼ï¼Œæ‰¾åˆ°å€¼æœ€å°çš„ä¸€ä¸ªé¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯æœ€å°‘ä½¿ç”¨çš„é¡µé¢ã€‚</p><h2 id="7-nfu-è€åŒ–ç®—æ³•"><a class="markdownIt-Anchor" href="#7-nfu-è€åŒ–ç®—æ³•"></a> 7. NFU, è€åŒ–ç®—æ³•</h2><p>å°½ç®¡ä¸Šé¢çš„ <code>LRU</code> ç®—æ³•åœ¨åŸåˆ™ä¸Šæ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯å¾ˆå°‘æœ‰æœºå™¨èƒ½å¤Ÿæ‹¥æœ‰é‚£äº›ç‰¹æ®Šçš„ç¡¬ä»¶ã€‚ä¸Šé¢æ˜¯ç¡¬ä»¶çš„å®ç°æ–¹å¼ï¼Œé‚£ä¹ˆç°åœ¨è€ƒè™‘è¦ç”¨è½¯ä»¶æ¥å®ç° <code>LRU</code> ã€‚ä¸€ç§å¯ä»¥å®ç°çš„æ–¹æ¡ˆæ˜¯ <code>NFU(Not Frequently Usedï¼Œæœ€ä¸å¸¸ç”¨)</code> ç®—æ³•ã€‚å®ƒéœ€è¦ä¸€ä¸ªè½¯ä»¶è®¡æ•°å™¨æ¥å’Œæ¯ä¸ªé¡µé¢å…³è”ï¼Œåˆå§‹åŒ–çš„æ—¶å€™æ˜¯ <code>0</code>ã€‚åœ¨æ¯ä¸ªæ—¶é’Ÿä¸­æ–­æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæµè§ˆå†…å­˜ä¸­çš„æ‰€æœ‰é¡µï¼Œä¼šå°†æ¯ä¸ªé¡µé¢çš„ <code>R</code> ä½ï¼ˆ<code>0</code> æˆ– <code>1</code>ï¼‰åŠ åˆ°å®ƒçš„è®¡æ•°å™¨ä¸Šã€‚è¿™ä¸ªè®¡æ•°å™¨å¤§ä½“ä¸Šè·Ÿè¸ªäº†å„ä¸ªé¡µé¢è®¿é—®çš„é¢‘ç¹ç¨‹åº¦ã€‚å½“ç¼ºé¡µå¼‚å¸¸å‡ºç°æ—¶ï¼Œåˆ™ç½®æ¢è®¡æ•°å™¨å€¼æœ€å°çš„é¡µé¢ã€‚</p><p>åªéœ€è¦å¯¹ <code>NFU</code> åšä¸€ä¸ªç®€å•çš„ä¿®æ”¹å°±å¯ä»¥è®©å®ƒæ¨¡æ‹Ÿ <code>LRU</code>ï¼Œè¿™ä¸ªä¿®æ”¹æœ‰ä¸¤ä¸ªæ­¥éª¤</p><ol><li>åœ¨ <code>R</code> ä½è¢«æ·»åŠ è¿›æ¥ä¹‹å‰å…ˆæŠŠ<strong>è®¡æ•°å™¨å³ç§»ä¸€ä½</strong>ï¼›</li><li><code>R</code> ä½è¢«æ·»åŠ åˆ°<strong>æœ€å·¦è¾¹</strong>çš„ä½è€Œä¸æ˜¯æœ€å³è¾¹çš„ä½ã€‚<br />ä¿®æ”¹ä»¥åçš„ç®—æ³•ç§°ä¸º <code>è€åŒ–(aging)</code> ç®—æ³•ï¼Œä¸‹å›¾è§£é‡Šäº†è€åŒ–ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928135317.png" srcset="/img/loading.gif" alt="" /></p><p>æˆ‘ä»¬å‡è®¾åœ¨ç¬¬ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…é¡µé¢ <code>0 - 5</code> çš„ <code>R</code> ä½ä¾æ¬¡æ˜¯ <code>1ï¼Œ0ï¼Œ1ï¼Œ0ï¼Œ1ï¼Œ1</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ <code>0</code> ä¸ªæ—¶é’Ÿå‘¨æœŸåˆ° <code>1</code> ä¸ªæ—¶é’Ÿå‘¨æœŸä¹‹é—´ï¼Œ<code>0ï¼Œ2ï¼Œ4ï¼Œ5</code> éƒ½è¢«å¼•ç”¨äº†ï¼Œä»è€ŒæŠŠå®ƒä»¬çš„ <code>R</code> ä½è®¾ç½®ä¸º <code>1</code>ï¼Œå‰©ä¸‹çš„è®¾ç½®ä¸º <code>0</code>ã€‚åœ¨ç›¸å…³çš„å…­ä¸ªè®¡æ•°å™¨è¢«å³ç§»ä¹‹å <code>R</code> ä½è¢«æ·»åŠ åˆ° å·¦ä¾§ ï¼Œå°±åƒä¸Šå›¾ä¸­çš„ <code>a</code>ã€‚å‰©ä¸‹çš„å››åˆ—æ˜¾ç¤ºäº†æ¥ä¸‹æ¥çš„å››ä¸ªæ—¶é’Ÿå‘¨æœŸå†…çš„å…­ä¸ªè®¡æ•°å™¨å˜åŒ–ã€‚</p><blockquote><p>CPUæ­£åœ¨ä»¥æŸä¸ªé¢‘ç‡å‰è¿›ï¼Œè¯¥é¢‘ç‡çš„å‘¨æœŸç§°ä¸ºæ—¶é’Ÿæ»´ç­”æˆ–æ—¶é’Ÿå‘¨æœŸã€‚ä¸€ä¸ª 100Mhz çš„å¤„ç†å™¨æ¯ç§’å°†æ¥æ”¶100,000,000ä¸ªæ—¶é’Ÿæ»´ç­”ã€‚</p></blockquote><p>å½“ç¼ºé¡µå¼‚å¸¸å‡ºç°æ—¶ï¼Œ<strong>å°†ç½®æ¢è®¡æ•°å™¨å€¼æœ€å°çš„é¡µé¢</strong>ã€‚å¦‚æœä¸€ä¸ªé¡µé¢åœ¨å‰é¢ <code>4</code> ä¸ªæ—¶é’Ÿå‘¨æœŸå†…éƒ½æ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå®ƒçš„è®¡æ•°å™¨åº”è¯¥ä¼šæœ‰å››ä¸ªè¿ç»­çš„ <code>0</code>ï¼Œå› æ­¤å®ƒçš„å€¼è‚¯å®šè¦æ¯”å‰é¢ <code>3</code> ä¸ªæ—¶é’Ÿå‘¨æœŸå†…éƒ½æ²¡æœ‰è¢«è®¿é—®è¿‡çš„é¡µé¢çš„è®¡æ•°å™¨å°ã€‚</p><p>è¿™ä¸ªç®—æ³•ä¸ <code>LRU</code> ç®—æ³•æœ‰ä¸¤ä¸ªé‡è¦çš„åŒºåˆ«ï¼šçœ‹ä¸€ä¸‹ä¸Šå›¾ä¸­çš„ <code>e</code>ï¼Œç¬¬ä¸‰åˆ—å’Œç¬¬äº”åˆ—ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928135342.png" srcset="/img/loading.gif" alt="" /></p><p>å®ƒä»¬åœ¨ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸå†…éƒ½æ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œåœ¨æ­¤ä¹‹å‰çš„æ—¶é’Ÿå‘¨æœŸå†…éƒ½å¼•ç”¨äº†ä¸¤ä¸ªé¡µé¢ã€‚æ ¹æ® <code>LRU</code> ç®—æ³•ï¼Œå¦‚æœéœ€è¦ç½®æ¢çš„è¯ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨è¿™ä¸¤ä¸ªé¡µé¢ä¸­é€‰æ‹©ä¸€ä¸ªã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªä¸ªï¼Ÿç°åœ¨çš„é—®é¢˜æ˜¯æˆ‘ä»¬ä¸çŸ¥é“æ—¶é’Ÿå‘¨æœŸ 1 åˆ°æ—¶é’Ÿå‘¨æœŸ 2 å†…å®ƒä»¬ä¸­å“ªä¸ªé¡µé¢æ˜¯åè¢«è®¿é—®åˆ°çš„ã€‚<strong>å› ä¸ºåœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå†…åªè®°å½•äº†ä¸€ä½ï¼Œæ‰€ä»¥æ— æ³•åŒºåˆ†åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å“ªä¸ªé¡µé¢æœ€æ—©è¢«å¼•ç”¨ï¼Œå“ªä¸ªé¡µé¢æ˜¯æœ€åè¢«å¼•ç”¨çš„ã€‚</strong> å› æ­¤ï¼Œæˆ‘ä»¬èƒ½åšçš„å°±æ˜¯ç½®æ¢ <code>é¡µé¢3</code>ï¼Œå› ä¸ºé¡µé¢ <code>3</code> åœ¨å‘¨æœŸ <code>0 - 1</code> å†…éƒ½æ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œè€Œé¡µé¢ <code>5</code> å´è¢«å¼•ç”¨è¿‡ã€‚</p><p><code>LRU</code> ä¸è€åŒ–ä¹‹å‰çš„ç¬¬ 2 ä¸ªåŒºåˆ«æ˜¯ï¼Œåœ¨è€åŒ–æœŸé—´ï¼Œ<strong>è®¡æ•°å™¨å…·æœ‰æœ‰é™æ•°é‡çš„ä½</strong>ï¼ˆè¿™ä¸ªä¾‹å­ä¸­æ˜¯ 8 ä½ï¼‰ï¼Œè¿™å°±é™åˆ¶äº†ä»¥å¾€çš„è®¿é—®è®°å½•ã€‚å¦‚æœä¸¤ä¸ªé¡µé¢çš„è®¡æ•°å™¨éƒ½æ˜¯ <code>0</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éšä¾¿é€‰æ‹©ä¸€ä¸ªè¿›è¡Œç½®æ¢ã€‚å®é™…ä¸Šï¼Œæœ‰å¯èƒ½å…¶ä¸­ä¸€ä¸ªé¡µé¢çš„è®¿é—®æ¬¡æ•°å®åœ¨ <code>9</code> ä¸ªæ—¶é’Ÿå‘¨æœŸä»¥å‰ï¼Œè€Œå¦å¤–ä¸€ä¸ªé¡µé¢æ˜¯åœ¨ <code>1000</code> ä¸ªæ—¶é’Ÿå‘¨æœŸä¹‹å‰ï¼Œä½†æ˜¯æˆ‘ä»¬å´æ— æ³•çœ‹åˆ°è¿™äº›ã€‚åœ¨å®é™…è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ—¶é’Ÿå‘¨æœŸæ˜¯ 20 msï¼Œ8 ä½ä¸€èˆ¬æ˜¯å¤Ÿç”¨çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ç»å¸¸æ‹¿ 20 ms æ¥ä¸¾ä¾‹ã€‚</p><h2 id="8-å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#8-å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³•"></a> 8. å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³•</h2><p>åœ¨æœ€å•çº¯çš„åˆ†é¡µç³»ç»Ÿä¸­ï¼Œåˆšå¯åŠ¨è¿›ç¨‹æ—¶ï¼Œåœ¨å†…å­˜ä¸­å¹¶æ²¡æœ‰é¡µé¢ã€‚æ­¤æ—¶å¦‚æœ <code>CPU</code> å°è¯•åŒ¹é…ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ï¼Œä½¿æ“ä½œç³»ç»Ÿè£…å…¥å«æœ‰ç¬¬ä¸€æ¡æŒ‡ä»¤çš„é¡µé¢ã€‚å…¶ä»–çš„é”™è¯¯æ¯”å¦‚ <code>å…¨å±€å˜é‡å’Œ å †æ ˆ</code> å¼•èµ·çš„ç¼ºé¡µå¼‚å¸¸é€šå¸¸ä¼šç´§æ¥ç€å‘ç”Ÿã€‚ä¸€æ®µæ—¶é—´ä»¥åï¼Œè¿›ç¨‹éœ€è¦çš„å¤§éƒ¨åˆ†é¡µé¢éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶è¿›ç¨‹å¼€å§‹åœ¨è¾ƒå°‘çš„ç¼ºé¡µå¼‚å¸¸ç¯å¢ƒä¸­è¿è¡Œã€‚è¿™ä¸ªç­–ç•¥ç§°ä¸º <code>è¯·æ±‚è°ƒé¡µ(demand paging)</code>ï¼Œå› ä¸ºé¡µé¢æ˜¯æ ¹æ®éœ€è¦è¢«è°ƒå…¥çš„ï¼Œè€Œä¸æ˜¯é¢„å…ˆè°ƒå…¥çš„ã€‚</p><p>åœ¨ä¸€ä¸ªå¤§çš„åœ°å€ç©ºé—´ä¸­ç³»ç»Ÿçš„è¯»æ‰€æœ‰çš„é¡µé¢ï¼Œå°†ä¼šé€ æˆå¾ˆå¤šç¼ºé¡µå¼‚å¸¸ï¼Œå› æ­¤ä¼šå¯¼è‡´æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥å®¹çº³è¿™äº›é¡µé¢ã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œå¤§éƒ¨åˆ†è¿›ç¨‹ä¸æ˜¯è¿™æ ·å·¥ä½œçš„ï¼Œå®ƒä»¬éƒ½ä¼šä»¥ <code>å±€éƒ¨æ€§æ–¹å¼(locality of reference)</code> æ¥è®¿é—®ï¼Œè¿™æ„å‘³ç€åœ¨æ‰§è¡Œçš„ä»»ä½•é˜¶æ®µï¼Œç¨‹åºåªå¼•ç”¨å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚</p><p>ä¸€ä¸ªè¿›ç¨‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„é¡µé¢çš„é›†åˆç§°ä¸ºå®ƒçš„ <code>å·¥ä½œé›†(working set)</code>ï¼Œå¦‚æœæ•´ä¸ªå·¥ä½œé›†éƒ½åœ¨å†…å­˜ä¸­ï¼Œé‚£ä¹ˆè¿›ç¨‹åœ¨è¿è¡Œåˆ°ä¸‹ä¸€è¿è¡Œé˜¶æ®µä¹‹å‰ï¼Œä¸ä¼šäº§ç”Ÿå¾ˆå¤šç¼ºé¡µä¸­æ–­ã€‚å¦‚æœå†…å­˜å¤ªå°ä»è€Œæ— æ³•å®¹çº³æ•´ä¸ªå·¥ä½œé›†ï¼Œé‚£ä¹ˆè¿›ç¨‹çš„è¿è¡Œè¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå¤§é‡çš„ç¼ºé¡µä¸­æ–­ï¼Œä¼šå¯¼è‡´è¿è¡Œé€Ÿåº¦ä¹Ÿä¼šå˜å¾—ç¼“æ…¢ã€‚å› ä¸ºé€šå¸¸åªéœ€è¦å‡ çº³ç§’å°±èƒ½æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œè€Œé€šå¸¸éœ€è¦åæ¯«ç§’æ‰èƒ½ä»ç£ç›˜ä¸Šè¯»å…¥ä¸€ä¸ªé¡µé¢ã€‚å¦‚æœä¸€ä¸ªç¨‹åºæ¯ 10 ms åªèƒ½æ‰§è¡Œä¸€åˆ°ä¸¤æ¡æŒ‡ä»¤ï¼Œé‚£ä¹ˆå®ƒå°†éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½è¿è¡Œå®Œã€‚å¦‚æœåªæ˜¯æ‰§è¡Œå‡ æ¡æŒ‡ä»¤å°±ä¼šäº§ç”Ÿä¸­æ–­ï¼Œé‚£ä¹ˆå°±ç§°ä½œè¿™ä¸ªç¨‹åºäº§ç”Ÿäº† é¢ ç°¸(thrashing)ã€‚</p><p>åœ¨å¤šé“ç¨‹åºçš„ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šæŠŠè¿›ç¨‹ç§»åˆ°ç£ç›˜ä¸Šï¼Œè¿™æ ·å¯ä»¥è®©å…¶ä»–è¿›ç¨‹æœ‰æœºä¼šå ç”¨ <code>CPU</code>ã€‚æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“è¿›ç¨‹æƒ³è¦å†æ¬¡æŠŠä¹‹å‰è°ƒå›ç£ç›˜çš„é¡µé¢è°ƒå›å†…å­˜æ€ä¹ˆåŠï¼Ÿä»æŠ€æœ¯çš„è§’åº¦ä¸Šæ¥è®²ï¼Œå¹¶ä¸éœ€è¦åšä»€ä¹ˆï¼Œæ­¤è¿›ç¨‹ä¼šä¸€ç›´äº§ç”Ÿç¼ºé¡µä¸­æ–­ç›´åˆ°å®ƒçš„å·¥ä½œé›†è¢«è°ƒå›å†…å­˜ã€‚ç„¶åï¼Œæ¯æ¬¡è£…å…¥ä¸€ä¸ªè¿›ç¨‹éœ€è¦ 20ã€100 ç”šè‡³ 1000 æ¬¡ç¼ºé¡µä¸­æ–­ï¼Œé€Ÿåº¦æ˜¾ç„¶å¤ªæ…¢äº†ï¼Œå¹¶ä¸”ç”±äº <code>CPU</code> éœ€è¦å‡ æ¯«ç§’æ—¶é—´å¤„ç†ä¸€ä¸ªç¼ºé¡µä¸­æ–­ï¼Œå› æ­¤ç”±ç›¸å½“å¤šçš„ <code>CPU</code> æ—¶é—´ä¹Ÿè¢«æµªè´¹äº†ã€‚</p><p>å› æ­¤ï¼Œä¸å°‘åˆ†é¡µç³»ç»Ÿä¸­éƒ½ä¼šè®¾æ³•è·Ÿè¸ªè¿›ç¨‹çš„å·¥ä½œé›†ï¼Œç¡®ä¿è¿™äº›å·¥ä½œé›†åœ¨è¿›ç¨‹è¿è¡Œæ—¶è¢«è°ƒå…¥å†…å­˜ã€‚è¿™ä¸ªæ–¹æ³•å«åš <code>å·¥ä½œé›†æ¨¡å¼(working set model)</code>ã€‚å®ƒè¢«è®¾è®¡ç”¨æ¥<strong>å‡å°‘ç¼ºé¡µä¸­æ–­çš„æ¬¡æ•°</strong>ã€‚åœ¨è¿›ç¨‹è¿è¡Œå‰é¦–å…ˆè£…å…¥å·¥ä½œé›†é¡µé¢çš„è¿™ä¸€ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º <code>é¢„å…ˆè°ƒé¡µ(prepaging)</code>ï¼Œå·¥ä½œé›†æ˜¯éšç€æ—¶é—´æ¥å˜åŒ–çš„ã€‚</p><p>æ ¹æ®ç ”ç©¶è¡¨æ˜ï¼Œå¤§å¤šæ•°ç¨‹åºå¹¶ä¸æ˜¯å‡åŒ€çš„è®¿é—®åœ°å€ç©ºé—´çš„ï¼Œè€Œè®¿é—®å¾€å¾€æ˜¯é›†ä¸­äºä¸€å°éƒ¨åˆ†é¡µé¢ã€‚ä¸€æ¬¡å†…å­˜è®¿é—®å¯èƒ½ä¼šå–å‡ºä¸€æ¡æŒ‡ä»¤ï¼Œä¹Ÿå¯èƒ½ä¼šå–å‡ºæ•°æ®ï¼Œæˆ–è€…æ˜¯å­˜å‚¨æ•°æ®ã€‚<br />åœ¨ä»»ä¸€æ—¶åˆ» <code>t</code>ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªé›†åˆï¼Œå®ƒåŒ…å«æ‰€æœ‰æœ€è¿‘ <code>k</code> æ¬¡å†…å­˜è®¿é—®æ‰€è®¿é—®è¿‡çš„é¡µé¢ã€‚è¿™ä¸ªé›†åˆ <code>w(k,t)</code> å°±æ˜¯å·¥ä½œé›†ã€‚å› ä¸ºæœ€è¿‘ <code>k = 1</code> æ¬¡è®¿é—®è‚¯å®šä¼šè®¿é—®æœ€è¿‘ <code>k &gt; 1</code> æ¬¡è®¿é—®æ‰€è®¿é—®è¿‡çš„é¡µé¢ï¼Œæ‰€ä»¥ <code>w(k,t)</code> æ˜¯ k çš„å•è°ƒé€’å‡å‡½æ•°ã€‚éšç€ <code>k</code> çš„å¢å¤§ï¼Œ<code>w(k,t)</code> æ˜¯ä¸ä¼šæ— é™å˜å¤§çš„ï¼Œå› ä¸ºç¨‹åºä¸å¯èƒ½è®¿é—®æ¯”æ‰€èƒ½å®¹çº³é¡µé¢æ•°é‡ä¸Šé™è¿˜å¤šçš„é¡µé¢ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928141451.png" srcset="/img/loading.gif" alt="" /></p><p><strong>äº‹å®ä¸Šå¤§å¤šæ•°åº”ç”¨ç¨‹åºåªä¼šä»»æ„è®¿é—®ä¸€å°éƒ¨åˆ†é¡µé¢é›†åˆï¼Œä½†æ˜¯è¿™ä¸ªé›†åˆä¼šéšç€æ—¶é—´è€Œç¼“æ…¢å˜åŒ–</strong>ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æ›²çº¿ä¼šå¿«é€Ÿä¸Šå‡è€Œ <code>k</code> è¾ƒå¤§æ—¶ä¸Šå‡ç¼“æ…¢ã€‚ä¸ºäº†å®ç°å·¥ä½œé›†æ¨¡å‹ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»è·Ÿè¸ªå“ªäº›é¡µé¢åœ¨å·¥ä½œé›†ä¸­ã€‚ä¸€ä¸ªè¿›ç¨‹ä»å®ƒå¼€å§‹æ‰§è¡Œåˆ°å½“å‰æ‰€å®é™…ä½¿ç”¨çš„ <code>CPU</code> æ—¶é—´æ€»æ•°é€šå¸¸ç§°ä½œ <code>å½“å‰å®é™…è¿è¡Œæ—¶é—´</code>ã€‚<strong>è¿›ç¨‹çš„å·¥ä½œé›†å¯ä»¥è¢«ç§°ä¸ºåœ¨è¿‡å»çš„ <code>t</code> ç§’å®é™…è¿è¡Œæ—¶é—´ä¸­å®ƒæ‰€è®¿é—®è¿‡çš„é¡µé¢é›†åˆã€‚</strong></p><p>ä¸‹é¢æ¥ç®€å•æè¿°ä¸€ä¸‹å·¥ä½œé›†çš„é¡µé¢ç½®æ¢ç®—æ³•ï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯<strong>æ‰¾å‡ºä¸€ä¸ªä¸åœ¨å·¥ä½œé›†ä¸­çš„é¡µé¢å¹¶æ·˜æ±°å®ƒ</strong>ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928141619.png" srcset="/img/loading.gif" alt="" /></p><h2 id="9-å·¥ä½œé›†æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#9-å·¥ä½œé›†æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•"></a> 9. å·¥ä½œé›†æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•</h2><p>å½“ç¼ºé¡µå¼‚å¸¸å‘ç”Ÿåï¼Œéœ€è¦æ‰«ææ•´ä¸ªé¡µè¡¨æ‰èƒ½ç¡®å®šè¢«æ·˜æ±°çš„é¡µé¢ï¼Œå› æ­¤åŸºæœ¬å·¥ä½œé›†ç®—æ³•è¿˜æ˜¯æ¯”è¾ƒæµªè´¹æ—¶é—´çš„ã€‚ä¸€ä¸ªå¯¹åŸºæœ¬å·¥ä½œé›†ç®—æ³•çš„æå‡æ˜¯<strong>åŸºäºæ—¶é’Ÿç®—æ³•ä½†æ˜¯å´ä½¿ç”¨å·¥ä½œé›†çš„ä¿¡æ¯</strong>ï¼Œè¿™ç§ç®—æ³•ç§°ä¸º<code>WSClock(å·¥ä½œé›†æ—¶é’Ÿ)</code>ã€‚ç”±äºå®ƒçš„å®ç°ç®€å•å¹¶ä¸”å…·æœ‰é«˜æ€§èƒ½ï¼Œå› æ­¤åœ¨å®è·µä¸­è¢«å¹¿æ³›åº”ç”¨ã€‚</p><p>ä¸æ—¶é’Ÿç®—æ³•ä¸€æ ·ï¼Œæ‰€éœ€çš„æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªä»¥é¡µæ¡†ä¸ºå…ƒç´ çš„å¾ªç¯åˆ—è¡¨ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200928142410.png" srcset="/img/loading.gif" alt="" /></p><p>æœ€åˆçš„æ—¶å€™ï¼Œè¯¥è¡¨æ˜¯ç©ºçš„ã€‚å½“è£…å…¥ç¬¬ä¸€ä¸ªé¡µé¢åï¼ŒæŠŠå®ƒåŠ è½½åˆ°è¯¥è¡¨ä¸­ã€‚éšç€æ›´å¤šçš„é¡µé¢çš„åŠ å…¥ï¼Œå®ƒä»¬å½¢æˆä¸€ä¸ªç¯å½¢ç»“æ„ã€‚æ¯ä¸ªè¡¨é¡¹åŒ…å«æ¥è‡ªåŸºæœ¬å·¥ä½œé›†ç®—æ³•çš„ä¸Šæ¬¡ä½¿ç”¨æ—¶é—´ï¼Œä»¥åŠ <code>R</code> ä½ï¼ˆå·²æ ‡æ˜ï¼‰å’Œ <code>M</code> ä½ï¼ˆæœªæ ‡æ˜ï¼‰ã€‚</p><p>ä¸æ—¶é’Ÿç®—æ³•ä¸€æ ·ï¼Œåœ¨æ¯ä¸ªç¼ºé¡µå¼‚å¸¸æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥æŒ‡é’ˆæŒ‡å‘çš„é¡µé¢ã€‚</p><ul><li><code>R = 1</code>ï¼Œè¯¥é¡µé¢åœ¨å½“å‰æ—¶é’Ÿå‘¨æœŸå†…å°±è¢«ä½¿ç”¨è¿‡ï¼Œé‚£ä¹ˆè¯¥é¡µé¢å°±ä¸é€‚åˆè¢«æ·˜æ±°ã€‚ç„¶åæŠŠè¯¥é¡µé¢çš„ <code>R</code> è®¾ç½®ä¸º <code>0</code>ï¼ŒæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œå¹¶é‡å¤è¯¥ç®—æ³•ã€‚è¯¥äº‹ä»¶åºåˆ—åŒ–åçš„çŠ¶æ€å‚è§å›¾ <code>b</code>ã€‚</li><li><code>R = 0</code><ul><li>å¦‚æœé¡µé¢çš„ä½¿ç”¨æœŸé™å¤§äº <code>t</code> å¹¶ä¸”é¡µé¢ä¸º<code>æœªè®¿é—®è¿‡</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µé¢å°±ä¸ä¼šåœ¨å·¥ä½œé›†ä¸­ï¼Œå¹¶ä¸”åœ¨ç£ç›˜ä¸Šä¼šæœ‰ä¸€ä¸ªæ­¤é¡µé¢çš„å‰¯æœ¬ã€‚ç”³è¯·é‡æ–°è°ƒå…¥ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œå¹¶æŠŠæ–°çš„é¡µé¢æ”¾åœ¨å…¶ä¸­ï¼Œå¦‚å›¾ <code>d</code> æ‰€ç¤ºã€‚</li><li>å¦‚æœé¡µé¢<code>è¢«ä¿®æ”¹è¿‡</code>ï¼Œå°±ä¸èƒ½é‡æ–°ç”³è¯·é¡µé¢ï¼Œå› ä¸ºè¿™ä¸ªé¡µé¢åœ¨ç£ç›˜ä¸Šæ²¡æœ‰æœ‰æ•ˆçš„å‰¯æœ¬ã€‚ä¸ºäº†é¿å…ç”±äºè°ƒåº¦å†™ç£ç›˜æ“ä½œå¼•èµ·çš„è¿›ç¨‹åˆ‡æ¢ï¼ŒæŒ‡é’ˆç»§ç»­å‘å‰èµ°ï¼Œç®—æ³•ç»§ç»­å¯¹ä¸‹ä¸€ä¸ªé¡µé¢è¿›è¡Œæ“ä½œã€‚æ¯•ç«Ÿï¼Œæœ‰å¯èƒ½å­˜åœ¨ä¸€ä¸ªè€çš„ï¼Œæ²¡æœ‰è¢«ä¿®æ”¹è¿‡çš„é¡µé¢å¯ä»¥ç«‹å³ä½¿ç”¨ã€‚</li></ul></li></ul><h2 id="é¡µé¢ç½®æ¢ç®—æ³•å°ç»“"><a class="markdownIt-Anchor" href="#é¡µé¢ç½®æ¢ç®—æ³•å°ç»“"></a> é¡µé¢ç½®æ¢ç®—æ³•å°ç»“</h2><table><thead><tr><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">æœ€ä¼˜ç®—æ³•</td><td style="text-align:center">ä¸å¯å®ç°ï¼Œä½†å¯ä»¥ç”¨ä½œåŸºå‡†</td></tr><tr><td style="text-align:center">NRU(æœ€è¿‘æœªä½¿ç”¨) ç®—æ³•</td><td style="text-align:center">å’Œ LRU ç®—æ³•å¾ˆç›¸ä¼¼</td></tr><tr><td style="text-align:center">FIFO(å…ˆè¿›å…ˆå‡º) ç®—æ³•</td><td style="text-align:center">æœ‰å¯èƒ½ä¼šæŠ›å¼ƒé‡è¦çš„é¡µé¢</td></tr><tr><td style="text-align:center">ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•</td><td style="text-align:center">æ¯” FIFO æœ‰è¾ƒå¤§çš„æ”¹å–„</td></tr><tr><td style="text-align:center">æ—¶é’Ÿç®—æ³•</td><td style="text-align:center">å®é™…ä½¿ç”¨</td></tr><tr><td style="text-align:center">LRU(æœ€è¿‘æœ€å°‘)ç®—æ³•</td><td style="text-align:center">æ¯”è¾ƒä¼˜ç§€ï¼Œä½†æ˜¯å¾ˆéš¾å®ç°</td></tr><tr><td style="text-align:center">NFU(æœ€ä¸ç»å¸¸ä½¿ç”¨)ç®—æ³•</td><td style="text-align:center">å’Œ LRU å¾ˆç±»ä¼¼</td></tr><tr><td style="text-align:center">è€åŒ–ç®—æ³•</td><td style="text-align:center">è¿‘ä¼¼ LRU çš„é«˜æ•ˆç®—æ³•</td></tr><tr><td style="text-align:center">å·¥ä½œé›†ç®—æ³•</td><td style="text-align:center">å®æ–½èµ·æ¥å¼€é”€å¾ˆå¤§</td></tr><tr><td style="text-align:center">å·¥ä½œé›†æ—¶é’Ÿç®—æ³•</td><td style="text-align:center">æ¯”è¾ƒæœ‰æ•ˆçš„ç®—æ³•</td></tr></tbody></table><ul><li><p>æœ€ä¼˜ç®—æ³•åœ¨å½“å‰é¡µé¢ä¸­<strong>ç½®æ¢æœ€åè¦è®¿é—®</strong>çš„é¡µé¢ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰åŠæ³•æ¥åˆ¤å®šå“ªä¸ªé¡µé¢æ˜¯æœ€åä¸€ä¸ªè¦è®¿é—®çš„ï¼Œå› æ­¤å®é™…ä¸Šè¯¥ç®—æ³•ä¸èƒ½ä½¿ç”¨ã€‚ç„¶è€Œï¼Œå®ƒå¯ä»¥ä½œä¸ºè¡¡é‡å…¶ä»–ç®—æ³•çš„æ ‡å‡†ã€‚</p></li><li><p><code>NRU</code> ç®—æ³•æ ¹æ® <code>R</code> ä½å’Œ <code>M</code> ä½çš„çŠ¶æ€å°†é¡µé¢åˆ†ä¸ºå››ç±»ã€‚ä»ç¼–å·æœ€å°çš„ç±»åˆ«ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªé¡µé¢ã€‚<code>NRU</code> ç®—æ³•æ˜“äºå®ç°ï¼Œä½†æ˜¯æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ã€‚å­˜åœ¨æ›´å¥½çš„ç®—æ³•ã€‚</p></li><li><p><code>FIFO</code> ä¼šè·Ÿè¸ªé¡µé¢åŠ è½½è¿›å…¥å†…å­˜ä¸­çš„é¡ºåºï¼Œå¹¶æŠŠé¡µé¢æ”¾å…¥ä¸€ä¸ªé“¾è¡¨ä¸­ã€‚æœ‰å¯èƒ½åˆ é™¤å­˜åœ¨æ—¶é—´æœ€é•¿ä½†æ˜¯è¿˜åœ¨ä½¿ç”¨çš„é¡µé¢ï¼Œå› æ­¤è¿™ä¸ªç®—æ³•ä¹Ÿä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p></li><li><p>ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•æ˜¯å¯¹ <code>FIFO</code> çš„ä¸€ä¸ªä¿®æ”¹ï¼Œå®ƒä¼šåœ¨åˆ é™¤é¡µé¢ä¹‹å‰æ£€æŸ¥è¿™ä¸ªé¡µé¢æ˜¯å¦ä»åœ¨ä½¿ç”¨ã€‚å¦‚æœé¡µé¢æ­£åœ¨ä½¿ç”¨ï¼Œå°±ä¼šè¿›è¡Œä¿ç•™ã€‚è¿™ä¸ªæ”¹è¿›å¤§å¤§æé«˜äº†æ€§èƒ½ã€‚</p></li><li><p><code>æ—¶é’Ÿ</code> ç®—æ³•æ˜¯ç¬¬äºŒæ¬¡æœºä¼šç®—æ³•çš„å¦å¤–ä¸€ç§å®ç°å½¢å¼ï¼Œæ—¶é’Ÿç®—æ³•å’Œç¬¬äºŒæ¬¡ç®—æ³•çš„æ€§èƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ä¼šèŠ±è´¹æ›´å°‘çš„æ—¶é—´æ¥æ‰§è¡Œç®—æ³•ã€‚</p></li><li><p><code>LRU</code> ç®—æ³•æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„ç®—æ³•ï¼Œä½†æ˜¯æ²¡æœ‰ç‰¹æ®Šçš„ç¡¬ä»¶(TLB)å¾ˆéš¾å®ç°ã€‚</p></li><li><p><code>NFU</code> ç®—æ³•æ˜¯ä¸€ç§è¿‘ä¼¼äº <code>LRU</code> çš„ç®—æ³•ï¼Œå®ƒçš„æ€§èƒ½ä¸æ˜¯éå¸¸å¥½ã€‚</p></li><li><p><code>è€åŒ–</code> ç®—æ³•æ˜¯ä¸€ç§æ›´æ¥è¿‘ LRU ç®—æ³•çš„å®ç°ï¼Œå¹¶ä¸”å¯ä»¥æ›´å¥½çš„å®ç°ï¼Œå› æ­¤æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p></li><li><p>æœ€åä¸¤ç§ç®—æ³•éƒ½ä½¿ç”¨äº†å·¥ä½œé›†ç®—æ³•ã€‚å·¥ä½œé›†ç®—æ³•æä¾›äº†åˆç†çš„æ€§èƒ½å¼€é”€ï¼Œä½†æ˜¯å®ƒçš„å®ç°æ¯”è¾ƒå¤æ‚ã€‚<code>WSClock</code> æ˜¯å¦å¤–ä¸€ç§å˜ä½“ï¼Œå®ƒä¸ä»…èƒ½å¤Ÿæä¾›è‰¯å¥½çš„æ€§èƒ½ï¼Œè€Œä¸”å¯ä»¥é«˜æ•ˆåœ°å®ç°ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 76. æœ€å°è¦†ç›–å­ä¸²</title>
    <link href="/2020/09/23/LeetCode-76-minimum-window-substring/"/>
    <url>/2020/09/23/LeetCode-76-minimum-window-substring/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-window-substring/" target="_blank" rel="noopener">76. æœ€å°è¦†ç›–å­ä¸²</a></p><p>ä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨ç»Ÿè®¡çª—å£å†…ç›®æ ‡å­—ç¬¦çš„å‡ºç°æ¬¡æ•°ï¼Œå½“æ»¡è¶³è¦æ±‚æ—¶ï¼Œç§»åŠ¨ leftï¼Œå¹¶æ›´æ–°æœ€å°é•¿åº¦ï¼Œè‹¥ç§»é™¤çš„å­—ç¬¦ä¸ºç›®æ ‡å­—ç¬¦ï¼Œåˆ™è®¡æ•°å™¨ä¹Ÿè¦å‡å°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">minWindow</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] sChar = s.toCharArray();    <span class="hljs-keyword">char</span>[] tChar = t.toCharArray();    <span class="hljs-keyword">int</span> sLen = s.length();    <span class="hljs-keyword">int</span> tLen = t.length();    <span class="hljs-comment">// åªç»Ÿè®¡çª—å£å†…ç›®æ ‡å­—ç¬¦çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] window = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">128</span>];    <span class="hljs-keyword">int</span>[] needs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">128</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : tChar) &#123;        needs[c]++;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>, begin = <span class="hljs-number">0</span>, minLen = sLen + <span class="hljs-number">1</span>;    <span class="hljs-comment">// æ»‘åŠ¨çª—å£å†…åŒ…å« t ä¸­å­—ç¬¦çš„ä¸ªæ•°</span>    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; sLen) &#123;        <span class="hljs-keyword">char</span> c = sChar[right];        <span class="hljs-comment">// å½“å‰å­—ç¬¦ä¸åœ¨ t ä¸­ï¼Œright å‘å³ç§»åŠ¨</span>        <span class="hljs-keyword">if</span> (needs[c] == <span class="hljs-number">0</span>) &#123;            right++;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// ç»Ÿè®¡çª—å£ä¸­ç›®æ ‡å­—ç¬¦çš„é•¿åº¦</span>        <span class="hljs-keyword">if</span> (window[c] &lt; needs[c]) &#123;            count++;        &#125;        <span class="hljs-comment">// æ›´æ–°çª—å£ä¸­ç›®æ ‡å­—ç¬¦å‡ºç°æ¬¡æ•°</span>        window[c]++;        right++;        <span class="hljs-comment">// æœ‰æ•ˆå­—ç¬¦ä¸ªæ•°æ»¡è¶³è¦æ±‚</span>        <span class="hljs-comment">// [left, right)</span>        <span class="hljs-keyword">while</span> (count == tLen) &#123;            <span class="hljs-comment">// æ›´æ–°æœ€å°é•¿åº¦</span>            <span class="hljs-keyword">if</span> (right - left &lt; minLen) &#123;                minLen = right - left;                begin = left;            &#125;            <span class="hljs-comment">// å·¦è¾¹éœ€è¦ç§»é™¤çš„å­—ç¬¦</span>            <span class="hljs-keyword">char</span> leftChar = sChar[left];            <span class="hljs-comment">// ç§»é™¤çš„å­—ç¬¦ä¸åœ¨ç›®æ ‡å­—ç¬¦ä¸­ï¼Œåˆ™ç›´æ¥ç§»åŠ¨ left</span>            <span class="hljs-keyword">if</span> (needs[leftChar] == <span class="hljs-number">0</span>) &#123;                left++;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// ç§»é™¤çš„å­—ç¬¦å‡ºç°çš„ç›®æ ‡å­—ç¬¦ä¸­ï¼Œåˆ™å‡å°‘æœ‰æ•ˆå­—ç¬¦é•¿åº¦</span>            <span class="hljs-keyword">if</span> (window[leftChar] == needs[leftChar]) &#123;                count--;            &#125;            window[leftChar]--;            left++;        &#125;    &#125;    <span class="hljs-keyword">if</span> (minLen == sLen + <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    <span class="hljs-keyword">return</span> s.substring(begin, begin + minLen);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 283. ç§»åŠ¨é›¶</title>
    <link href="/2020/09/22/LeetCode-283-move-zeroes/"/>
    <url>/2020/09/22/LeetCode-283-move-zeroes/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/move-zeroes/" target="_blank" rel="noopener">283. ç§»åŠ¨é›¶</a><br />ç»Ÿè®¡é 0 å…ƒç´ çš„ä¸ªæ•°ï¼Œè‹¥ <code>nums[i] != 0</code> åˆ™è¿›è¡Œäº¤æ¢ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">moveZeroes</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-comment">// é 0 å…ƒç´ çš„ä¸ªæ•°ï¼Œnums[0:j) != 0</span>        <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;            <span class="hljs-keyword">if</span> (nums[i] != <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">int</span> t = nums[i];                nums[i] = nums[j];                nums[j] = t;                j++;            &#125;        &#125;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 75. é¢œè‰²åˆ†ç±»</title>
    <link href="/2020/09/22/LeetCode-75-sort-colors/"/>
    <url>/2020/09/22/LeetCode-75-sort-colors/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-colors/" target="_blank" rel="noopener">75. é¢œè‰²åˆ†ç±»</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sortColors</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// 0,0,0,.zero.1,1,1,1,1.two.2,2,2,2,2,len</span>    <span class="hljs-comment">// [0, zero) 0</span>    <span class="hljs-comment">// [zero, i) 1</span>    <span class="hljs-comment">// [two, len) 2</span>    <span class="hljs-comment">// `0` çš„è¾¹ç•Œä» 0 å¼€å§‹</span>    <span class="hljs-keyword">int</span> zero = <span class="hljs-number">0</span>;    <span class="hljs-comment">// `2` çš„è¾¹ç•Œä»æœ€åä¸€ä¸ªå…ƒç´ å¼€å§‹</span>    <span class="hljs-keyword">int</span> two = len - <span class="hljs-number">1</span>;    <span class="hljs-comment">// éå†èµ·ç‚¹</span>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å½“ i == two æ—¶ï¼Œè¿˜å·®ä¸€ä¸ªå…ƒç´ æœªè®¿é—®</span>    <span class="hljs-keyword">while</span> (i &lt;= two) &#123;        <span class="hljs-keyword">if</span> (nums[i] == <span class="hljs-number">0</span>) &#123;            swap(nums, i, zero);            zero++;            i++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[i] == <span class="hljs-number">1</span>) &#123;            i++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[i] == <span class="hljs-number">2</span>) &#123;            <span class="hljs-comment">// æ­¤æ—¶ä¸éœ€è¦ i++ï¼Œå¦åˆ™äº¤æ¢è¿‡æ¥çš„ nums[i] æœªåˆ¤æ–­</span>            swap(nums, i, two);            two--;        &#125;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 451. æ ¹æ®å­—ç¬¦å‡ºç°é¢‘ç‡æ’åº</title>
    <link href="/2020/09/21/LeetCode-451-sort-characters-by-frequency/"/>
    <url>/2020/09/21/LeetCode-451-sort-characters-by-frequency/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-characters-by-frequency/" target="_blank" rel="noopener">451. æ ¹æ®å­—ç¬¦å‡ºç°é¢‘ç‡æ’åº</a></p><h1 id="æ’åº"><a class="markdownIt-Anchor" href="#æ’åº"></a> æ’åº</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">frequencySort</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    Map&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    List&lt;Character&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        <span class="hljs-keyword">if</span> (!list.contains(c)) &#123;            list.add(c);        &#125;        map.put(c, map.getOrDefault(c, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    &#125;    list.sort((o1, o2) -&gt; map.get(o2) - map.get(o1));    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : list) &#123;        <span class="hljs-keyword">int</span> count = map.get(c);        <span class="hljs-keyword">while</span> (count-- &gt; <span class="hljs-number">0</span>) &#123;            sb.append(c);        &#125;    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre><h1 id="å¤§é¡¶å †"><a class="markdownIt-Anchor" href="#å¤§é¡¶å †"></a> å¤§é¡¶å †</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">frequencySort</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    Map&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        map.put(c, map.getOrDefault(c, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    &#125;    PriorityQueue&lt;Character&gt; maxHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;((o1, o2) -&gt; map.get(o2) - map.get(o1));    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        <span class="hljs-keyword">if</span> (!maxHeap.contains(c)) &#123;            maxHeap.add(c);        &#125;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">while</span> (!maxHeap.isEmpty()) &#123;        <span class="hljs-keyword">char</span> key = maxHeap.poll();        <span class="hljs-keyword">int</span> count = map.get(key);        <span class="hljs-keyword">while</span> (count-- &gt; <span class="hljs-number">0</span>) &#123;            sb.append(key);        &#125;    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 189. æ—‹è½¬æ•°ç»„</title>
    <link href="/2020/09/21/LeetCode-189-rotate-array/"/>
    <url>/2020/09/21/LeetCode-189-rotate-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/rotate-array/" target="_blank" rel="noopener">189. æ—‹è½¬æ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rotate</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// æ¯æ¬¡åè½¬éƒ½æœ‰ k % n ä¸ª æ•°å­—è¢«ç§»åŠ¨åˆ°å‰éƒ¨</span>    k = k % len;    <span class="hljs-comment">// å…¨éƒ¨åè½¬</span>    reverse(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);    <span class="hljs-comment">// åè½¬å‰ k ä¸ª</span>    reverse(nums, <span class="hljs-number">0</span>, k - <span class="hljs-number">1</span>);    <span class="hljs-comment">// åè½¬ len - k ä¸ª</span>    reverse(nums, k, len - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reverse</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">while</span> (start &lt; end) &#123;        <span class="hljs-keyword">int</span> t = nums[start];        nums[start] = nums[end];        nums[end] = t;        start++;        end--;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿ è¿›ç¨‹ä¸çº¿ç¨‹</title>
    <link href="/2020/09/21/os-process-thread/"/>
    <url>/2020/09/21/os-process-thread/</url>
    
    <content type="html"><![CDATA[<h1 id="è¿›ç¨‹"><a class="markdownIt-Anchor" href="#è¿›ç¨‹"></a> è¿›ç¨‹</h1><p><strong>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå¯¹æ­£åœ¨è¿è¡Œä¸­çš„ç¨‹åºçš„ä¸€ä¸ªæŠ½è±¡</strong>ï¼Œæ“ä½œç³»ç»Ÿçš„å…¶ä»–æ‰€æœ‰å†…å®¹éƒ½æ˜¯é€šè¿‡è¿›ç¨‹å±•å¼€çš„ã€‚æ— è®ºæ˜¯åœ¨å•æ ¸è¿˜æ˜¯å¤šæ ¸ <code>CPU</code> ä¸­ï¼Œä¸€ä¸ª <code>CPU</code> éƒ½åƒæ˜¯åœ¨<strong>å¹¶å‘</strong>åœ°æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œè¿™æ˜¯é€šè¿‡å¤„ç†å™¨åœ¨è¿›ç¨‹é—´åˆ‡æ¢æ¥å®ç°çš„ï¼Œå³<strong>ä¼ªå¹¶è¡Œ</strong>ã€‚</p><blockquote><p><code>ä¼ªå¹¶è¡Œ</code>æ˜¯æŒ‡å•æ ¸æˆ–å¤šæ ¸å¤„ç†å™¨åŒæ—¶æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œä»è€Œä½¿ç¨‹åºæ›´å¿«ã€‚ é€šè¿‡ä»¥<strong>éå¸¸æœ‰é™çš„æ—¶é—´é—´éš”åœ¨ç¨‹åºä¹‹é—´å¿«é€Ÿåˆ‡æ¢ <code>CPU</code></strong>ï¼Œå› æ­¤ä¼šäº§ç”Ÿå¹¶è¡Œæ„Ÿã€‚ ç¼ºç‚¹æ˜¯ <code>CPU</code> æ—¶é—´å¯èƒ½åˆ†é…ç»™ä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼Œä¹Ÿå¯èƒ½ä¸åˆ†é…ç»™ä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚</p></blockquote><h2 id="è¿›ç¨‹æ¨¡å‹"><a class="markdownIt-Anchor" href="#è¿›ç¨‹æ¨¡å‹"></a> è¿›ç¨‹æ¨¡å‹</h2><p>åœ¨è¿›ç¨‹æ¨¡å‹ä¸­ï¼Œæ‰€æœ‰è®¡ç®—æœºä¸Šè¿è¡Œçš„è½¯ä»¶ï¼Œé€šå¸¸ä¹ŸåŒ…æ‹¬æ“ä½œç³»ç»Ÿï¼Œè¢«ç»„ç»‡ä¸ºè‹¥å¹²<strong>é¡ºåºè¿›ç¨‹</strong>(<code>sequential processes</code>)ï¼Œç®€ç§°ä¸º <strong>è¿›ç¨‹</strong>(<code>process</code>) ã€‚ä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ­£åœ¨æ‰§è¡Œçš„ç¨‹åºçš„å®ä¾‹ï¼Œè¿›ç¨‹ä¹ŸåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨å’Œå˜é‡çš„å½“å‰å€¼ã€‚ä»æ¦‚å¿µä¸Šæ¥è¯´ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å„è‡ªçš„è™šæ‹Ÿ <code>CPU</code>ï¼Œä½†æ˜¯å®é™…æƒ…å†µæ˜¯ <code>CPU</code> ä¼šåœ¨å„ä¸ªè¿›ç¨‹ä¹‹é—´è¿›è¡Œæ¥å›åˆ‡æ¢ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200918135528.png" srcset="/img/loading.gif" alt="" /><br />å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªå…·æœ‰ 4 ä¸ªç¨‹åºçš„å¤šé“å¤„ç†ç¨‹åºï¼Œåœ¨è¿›ç¨‹ä¸æ–­åˆ‡æ¢çš„è¿‡ç¨‹ä¸­ï¼Œç¨‹åºè®¡æ•°å™¨ä¹Ÿåœ¨ä¸åŒçš„å˜åŒ–ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200918135549.png" srcset="/img/loading.gif" alt="" /><br />åœ¨ä¸Šå›¾ä¸­ï¼Œè¿™ 4 é“ç¨‹åºè¢«æŠ½è±¡ä¸º 4 ä¸ªæ‹¥æœ‰å„è‡ªæ§åˆ¶æµç¨‹ï¼ˆå³æ¯ä¸ªè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼‰çš„è¿›ç¨‹ï¼Œå¹¶ä¸”æ¯ä¸ªç¨‹åºéƒ½ç‹¬ç«‹çš„è¿è¡Œã€‚<br />å½“ç„¶ï¼Œå®é™…ä¸Šåªæœ‰ä¸€ä¸ªç‰©ç†ç¨‹åºè®¡æ•°å™¨ï¼Œæ¯ä¸ªç¨‹åºè¦è¿è¡Œæ—¶ï¼Œå…¶é€»è¾‘ç¨‹åºè®¡æ•°å™¨ä¼šè£…è½½åˆ°ç‰©ç†ç¨‹åºè®¡æ•°å™¨ä¸­ã€‚<br />å½“ç¨‹åºè¿è¡Œç»“æŸåï¼Œå…¶ç‰©ç†ç¨‹åºè®¡æ•°å™¨å°±ä¼šæ˜¯çœŸæ­£çš„ç¨‹åºè®¡æ•°å™¨ï¼Œç„¶åå†æŠŠå®ƒæ”¾å›è¿›ç¨‹çš„é€»è¾‘è®¡æ•°å™¨ä¸­ã€‚</p><p>ä»ä¸‹å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è§‚å¯Ÿè¶³å¤Ÿé•¿çš„ä¸€æ®µæ—¶é—´åï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½è¿è¡Œäº†ï¼Œä½†<strong>åœ¨ä»»ä½•ä¸€ä¸ªç»™å®šçš„ç¬é—´ä»…æœ‰ä¸€ä¸ªè¿›ç¨‹çœŸæ­£è¿è¡Œã€‚</strong><br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200918135606.png" srcset="/img/loading.gif" alt="" /></p><p>å› æ­¤ï¼Œå½“æˆ‘ä»¬è¯´ä¸€ä¸ª <code>CPU</code> åªèƒ½çœŸæ­£ä¸€æ¬¡è¿è¡Œä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œå³ä½¿æœ‰ <code>2</code> ä¸ªæ ¸ï¼ˆæˆ– <code>CPU</code>ï¼‰ï¼Œ<strong>æ¯ä¸€ä¸ªæ ¸ä¹Ÿåªèƒ½ä¸€æ¬¡è¿è¡Œä¸€ä¸ªçº¿ç¨‹</strong>ã€‚</p><p>è¿™é‡Œçš„å…³é”®æ€æƒ³æ˜¯è®¤è¯†åˆ°ä¸€ä¸ªè¿›ç¨‹æ‰€éœ€çš„æ¡ä»¶ï¼Œ<strong>è¿›ç¨‹æ˜¯æŸä¸€ç±»ç‰¹å®šæ´»åŠ¨çš„æ€»å’Œï¼Œå®ƒæœ‰ç¨‹åºã€è¾“å…¥è¾“å‡ºä»¥åŠçŠ¶æ€ã€‚</strong> å•ä¸ªå¤„ç†å™¨å¯ä»¥è¢«è‹¥å¹²è¿›ç¨‹å…±äº«ï¼Œå®ƒä½¿ç”¨æŸç§è°ƒåº¦ç®—æ³•å†³å®šä½•æ—¶åœæ­¢ä¸€ä¸ªè¿›ç¨‹çš„å·¥ä½œï¼Œå¹¶è½¬è€Œä¸ºå¦å¤–ä¸€ä¸ªè¿›ç¨‹æä¾›æœåŠ¡ã€‚<br />å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹è¿è¡Œäº†ä¸¤éï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯ä¸¤ä¸ªè¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿèƒ½å¤Ÿä½¿å®ƒä»¬å…±äº«ä»£ç ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªå‰¯æœ¬æ”¾åœ¨å†…å­˜ä¸­ã€‚</p><h2 id="è¿›ç¨‹çš„åˆ›å»º"><a class="markdownIt-Anchor" href="#è¿›ç¨‹çš„åˆ›å»º"></a> è¿›ç¨‹çš„åˆ›å»º</h2><p>åˆ›å»ºè¿›ç¨‹çš„æ–¹å¼:</p><ol><li>ç³»ç»Ÿåˆå§‹åŒ–ï¼ˆ<code>init</code>ï¼‰</li><li>æ­£åœ¨è¿è¡Œçš„ç¨‹åºæ‰§è¡Œäº†åˆ›å»ºè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆæ¯”å¦‚ forkï¼‰</li><li>ç”¨æˆ·è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹</li><li>åˆå§‹åŒ–ä¸€ä¸ªæ‰¹å¤„ç†å·¥ä½œ</li></ol><p>åœ¨ <code>UNIX</code> å’Œ <code>Windows</code> ä¸­ï¼Œè¿›ç¨‹åˆ›å»ºä¹‹åï¼Œ<strong>çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹æœ‰å„è‡ªä¸åŒçš„åœ°å€ç©ºé—´</strong>ã€‚å¦‚æœå…¶ä¸­æŸä¸ªè¿›ç¨‹åœ¨å…¶åœ°å€ç©ºé—´ä¸­ä¿®æ”¹äº†ä¸€ä¸ªå­—ï¼Œè¿™ä¸ªä¿®æ”¹å°†å¯¹å¦ä¸€ä¸ªè¿›ç¨‹ä¸å¯è§ã€‚</p><ul><li><p>åœ¨ <code>UNIX</code> ä¸­ï¼Œå­è¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜¯çˆ¶è¿›ç¨‹çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œä½†æ˜¯è¿™é‡Œæ¶‰åŠä¸¤ä¸ªä¸åŒçš„åœ°å€ç©ºé—´ï¼›<strong>ä¸å¯å†™çš„å†…å­˜åŒºåŸŸæ˜¯å…±äº«çš„</strong>ï¼Œ<strong>å¯å†™çš„å†…å­˜æ˜¯ä¸èƒ½è¢«å…±äº«çš„</strong>ã€‚<br />æŸäº› <code>UNIX</code> å®ç°ä½¿å­è¿›ç¨‹å…±äº«çˆ¶è¿›ç¨‹çš„æ‰€æœ‰å†…å­˜ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹é€šè¿‡ <code>å†™æ—¶å¤åˆ¶ (copy-on-write)</code> å…±äº«ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦ä¸¤è€…ä¹‹ä¸€æƒ³è¦ä¿®æ”¹éƒ¨åˆ†å†…å­˜ï¼Œåˆ™è¿™å—å†…å­˜é¦–å…ˆè¢«æ˜ç¡®çš„å¤åˆ¶ï¼Œä»¥ç¡®ä¿ä¿®æ”¹å‘ç”Ÿåœ¨ç§æœ‰å†…å­˜åŒºåŸŸã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€ä¸ªæ–°åˆ›å»ºçš„è¿›ç¨‹æ¥è¯´ï¼Œç¡®å®æœ‰å¯èƒ½å…±äº«åˆ›å»ºè€…çš„èµ„æºï¼Œæ¯”å¦‚å¯ä»¥å…±äº«æ‰“å¼€çš„æ–‡ä»¶ã€‚</p></li><li><p>åœ¨ <code>Windows</code> ä¸­ï¼Œä»ä¸€å¼€å§‹çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´å’Œå­è¿›ç¨‹çš„åœ°å€ç©ºé—´å°±æ˜¯ä¸åŒçš„ã€‚</p></li></ul><h3 id="1-ç³»ç»Ÿåˆå§‹åŒ–"><a class="markdownIt-Anchor" href="#1-ç³»ç»Ÿåˆå§‹åŒ–"></a> 1. ç³»ç»Ÿåˆå§‹åŒ–</h3><p>å¯åŠ¨æ“ä½œç³»ç»Ÿæ—¶ï¼Œé€šå¸¸ä¼šåˆ›å»ºè‹¥å¹²ä¸ªè¿›ç¨‹ã€‚</p><ul><li><code>å‰å°è¿›ç¨‹ (numerous processes</code>) åŒç”¨æˆ·è¿›è¡Œäº¤äº’å¹¶æ›¿ä»–ä»¬å®Œæˆå·¥ä½œçš„è¿›ç¨‹ã€‚</li><li><code>å®ˆæŠ¤è¿›ç¨‹ (daemons)</code> è¿è¡Œåœ¨åå°ï¼Œå¹¶ä¸ä¸ç‰¹å®šçš„ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚</li></ul><h3 id="2-ç³»ç»Ÿè°ƒç”¨åˆ›å»º"><a class="markdownIt-Anchor" href="#2-ç³»ç»Ÿè°ƒç”¨åˆ›å»º"></a> 2. ç³»ç»Ÿè°ƒç”¨åˆ›å»º</h3><p>ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¼šå‘å‡º<code>ç³»ç»Ÿè°ƒç”¨</code>ç”¨æ¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªæ–°è¿›ç¨‹æ¥å¸®åŠ©å…¶å®Œæˆå·¥ä½œã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæœ‰å¤§é‡çš„æ•°æ®éœ€è¦ç»è¿‡ç½‘ç»œè°ƒå–å¹¶è¿›è¡Œé¡ºåºå¤„ç†ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªè¿›ç¨‹è¯»æ•°æ®ï¼Œå¹¶æŠŠæ•°æ®æ”¾åˆ°å…±äº«ç¼“å†²åŒºä¸­ï¼Œè€Œè®©ç¬¬äºŒä¸ªè¿›ç¨‹å–èµ°å¹¶æ­£ç¡®å¤„ç†ä¼šæ¯”è¾ƒå®¹æ˜“äº›ã€‚åœ¨å¤šå¤„ç†å™¨ä¸­ï¼Œè®©æ¯ä¸ªè¿›ç¨‹è¿è¡Œåœ¨ä¸åŒçš„ CPU ä¸Šä¹Ÿå¯ä»¥ä½¿å·¥ä½œåšçš„æ›´å¿«ã€‚</p><h3 id="3-ç”¨æˆ·è¯·æ±‚åˆ›å»º"><a class="markdownIt-Anchor" href="#3-ç”¨æˆ·è¯·æ±‚åˆ›å»º"></a> 3. ç”¨æˆ·è¯·æ±‚åˆ›å»º</h3><p>åœ¨è®¸å¤šäº¤äº’å¼ç³»ç»Ÿä¸­ï¼Œè¾“å…¥ä¸€ä¸ªå‘½ä»¤æˆ–è€…åŒå‡»å›¾æ ‡å°±å¯ä»¥å¯åŠ¨ç¨‹åºï¼Œä»¥ä¸Šä»»æ„ä¸€ç§æ“ä½œéƒ½å¯ä»¥é€‰æ‹©å¼€å¯ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œåœ¨åŸºæœ¬çš„ UNIX ç³»ç»Ÿä¸­è¿è¡Œ Xï¼Œæ–°è¿›ç¨‹å°†æ¥ç®¡å¯åŠ¨å®ƒçš„çª—å£ã€‚åœ¨ Windows ä¸­å¯åŠ¨è¿›ç¨‹æ—¶ï¼Œå®ƒä¸€èˆ¬æ²¡æœ‰çª—å£ï¼Œä½†æ˜¯å®ƒå¯ä»¥åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªçª—å£ã€‚æ¯ä¸ªçª—å£éƒ½å¯ä»¥è¿è¡Œè¿›ç¨‹ã€‚é€šè¿‡é¼ æ ‡æˆ–è€…å‘½ä»¤å°±å¯ä»¥åˆ‡æ¢çª—å£å¹¶ä¸è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚</p><h3 id="4-æ‰¹å¤„ç†åˆ›å»º"><a class="markdownIt-Anchor" href="#4-æ‰¹å¤„ç†åˆ›å»º"></a> 4. æ‰¹å¤„ç†åˆ›å»º</h3><p>æ‰¹å¤„ç†åˆ›å»ºä¼šåœ¨å¤§å‹æœºçš„<code>æ‰¹å¤„ç†ç³»ç»Ÿ</code>ä¸­åº”ç”¨ã€‚ç”¨æˆ·åœ¨è¿™ç§ç³»ç»Ÿä¸­æäº¤æ‰¹å¤„ç†ä½œä¸šã€‚å½“æ“ä½œç³»ç»Ÿå†³å®šå®ƒæœ‰èµ„æºæ¥è¿è¡Œå¦ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œå®ƒå°†åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹å¹¶ä»å…¶ä¸­çš„è¾“å…¥é˜Ÿåˆ—ä¸­è¿è¡Œä¸‹ä¸€ä¸ªä½œä¸šã€‚</p><h2 id="è¿›ç¨‹çš„ç»ˆæ­¢"><a class="markdownIt-Anchor" href="#è¿›ç¨‹çš„ç»ˆæ­¢"></a> è¿›ç¨‹çš„ç»ˆæ­¢</h2><p>è¿›ç¨‹åœ¨åˆ›å»ºä¹‹åï¼Œå®ƒå°±å¼€å§‹è¿è¡Œå¹¶åšå®Œæˆä»»åŠ¡ã€‚ç„¶è€Œï¼Œè¿›ç¨‹æ—©æ™šä¼šå‘ç”Ÿç»ˆæ­¢ï¼Œé€šå¸¸æ˜¯ç”±äºä»¥ä¸‹æƒ…å†µè§¦å‘çš„</p><ol><li>æ­£å¸¸é€€å‡º(è‡ªæ„¿çš„)</li><li>é”™è¯¯é€€å‡º(è‡ªæ„¿çš„)</li><li>ä¸¥é‡é”™è¯¯(éè‡ªæ„¿çš„)</li><li>è¢«å…¶ä»–è¿›ç¨‹æ€æ­»(éè‡ªæ„¿çš„)</li></ol><h3 id="1-æ­£å¸¸é€€å‡ºè‡ªæ„¿çš„"><a class="markdownIt-Anchor" href="#1-æ­£å¸¸é€€å‡ºè‡ªæ„¿çš„"></a> 1. æ­£å¸¸é€€å‡º(è‡ªæ„¿çš„)</h3><p>å¤šæ•°è¿›ç¨‹æ˜¯ç”±äºå®Œæˆäº†å·¥ä½œè€Œç»ˆæ­¢ã€‚å½“ç¼–è¯‘å™¨å®Œæˆäº†æ‰€ç»™å®šç¨‹åºçš„ç¼–è¯‘ä¹‹åï¼Œç¼–è¯‘å™¨ä¼šæ‰§è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å‘Šè¯‰æ“ä½œç³»ç»Ÿå®ƒå®Œæˆäº†å·¥ä½œã€‚<br />è¿™ä¸ªè°ƒç”¨åœ¨ <code>UNIX</code> ä¸­æ˜¯ <code>exit</code> ï¼Œåœ¨ <code>Windows</code> ä¸­æ˜¯ <code>ExitProcess</code>ã€‚</p><h3 id="2-é”™è¯¯é€€å‡ºè‡ªæ„¿çš„"><a class="markdownIt-Anchor" href="#2-é”™è¯¯é€€å‡ºè‡ªæ„¿çš„"></a> 2. é”™è¯¯é€€å‡º(è‡ªæ„¿çš„)</h3><p>è¿›ç¨‹å‘ç”Ÿç»ˆæ­¢çš„ç¬¬äºŒä¸ªåŸå› æ˜¯å‘ç°é”™è¯¯ã€‚<br />ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><pre><code class="hljs bash">cc foo.c</code></pre><p>è¦ç¼–è¯‘ <code>foo.c</code> ä½†æ˜¯è¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œäºæ˜¯ç¼–è¯‘å™¨å°±ä¼šå‘å‡ºå£°æ˜å¹¶é€€å‡ºã€‚åœ¨ç»™å‡ºäº†é”™è¯¯å‚æ•°æ—¶ï¼Œé¢å‘å±å¹•çš„äº¤äº’å¼è¿›ç¨‹é€šå¸¸å¹¶ä¸ä¼šç›´æ¥é€€å‡ºï¼Œå› ä¸ºè¿™ä»ç”¨æˆ·çš„è§’åº¦æ¥è¯´å¹¶ä¸åˆç†ï¼Œç”¨æˆ·éœ€è¦çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆå¹¶æƒ³è¦è¿›è¡Œé‡è¯•ï¼Œæ‰€ä»¥è¿™æ—¶å€™åº”ç”¨ç¨‹åºé€šå¸¸ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†å‘ŠçŸ¥ç”¨æˆ·å‘ç”Ÿäº†ç³»ç»Ÿé”™è¯¯ï¼Œæ˜¯éœ€è¦é‡è¯•è¿˜æ˜¯é€€å‡ºã€‚</p><h3 id="3-ä¸¥é‡é”™è¯¯éè‡ªæ„¿çš„"><a class="markdownIt-Anchor" href="#3-ä¸¥é‡é”™è¯¯éè‡ªæ„¿çš„"></a> 3. ä¸¥é‡é”™è¯¯(éè‡ªæ„¿çš„)</h3><p>ä¸¥é‡é”™è¯¯é€šå¸¸æ˜¯ç”±äºç¨‹åºä¸­çš„é”™è¯¯æ‰€å¯¼è‡´çš„ã€‚<br />ä¾‹å¦‚ï¼Œæ‰§è¡Œäº†ä¸€æ¡éæ³•æŒ‡ä»¤ï¼Œå¼•ç”¨ä¸å­˜åœ¨çš„å†…å­˜ï¼Œæˆ–è€…é™¤æ•°æ˜¯ 0 ç­‰ã€‚åœ¨æœ‰äº›ç³»ç»Ÿæ¯”å¦‚ <code>UNIX</code> ä¸­ï¼Œè¿›ç¨‹å¯ä»¥é€šçŸ¥æ“ä½œç³»ç»Ÿï¼Œå®ƒå¸Œæœ›è‡ªè¡Œå¤„ç†æŸç§ç±»å‹çš„é”™è¯¯ï¼Œåœ¨è¿™ç±»é”™è¯¯ä¸­ï¼Œè¿›ç¨‹ä¼šæ”¶åˆ°ä¿¡å·ï¼ˆä¸­æ–­ï¼‰ï¼Œè€Œä¸æ˜¯åœ¨è¿™ç±»é”™è¯¯å‡ºç°æ—¶ç›´æ¥ç»ˆæ­¢è¿›ç¨‹ã€‚</p><h3 id="4-è¢«å…¶ä»–è¿›ç¨‹æ€æ­»éè‡ªæ„¿çš„"><a class="markdownIt-Anchor" href="#4-è¢«å…¶ä»–è¿›ç¨‹æ€æ­»éè‡ªæ„¿çš„"></a> 4. è¢«å…¶ä»–è¿›ç¨‹æ€æ­»(éè‡ªæ„¿çš„)</h3><p>æŸä¸ªè¿›ç¨‹æ‰§è¡Œ<strong>ç³»ç»Ÿè°ƒç”¨</strong>å‘Šè¯‰æ“ä½œç³»ç»Ÿæ€æ­»æŸä¸ªè¿›ç¨‹ã€‚åœ¨ <code>UNIX</code> ä¸­ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨æ˜¯ <code>kill</code>ã€‚åœ¨ <code>Win32</code> ä¸­å¯¹åº”çš„å‡½æ•°æ˜¯ <code>TerminateProcess</code>ã€‚</p><h2 id="è¿›ç¨‹çš„å±‚æ¬¡ç»“æ„"><a class="markdownIt-Anchor" href="#è¿›ç¨‹çš„å±‚æ¬¡ç»“æ„"></a> è¿›ç¨‹çš„å±‚æ¬¡ç»“æ„</h2><p>åœ¨ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºäº†å…¶ä»–è¿›ç¨‹åï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å°±ä¼šä»¥æŸç§æ–¹å¼è¿›è¡Œå…³è”ã€‚å­è¿›ç¨‹å®ƒè‡ªå·±å°±ä¼šåˆ›å»ºæ›´å¤šè¿›ç¨‹ï¼Œä»è€Œå½¢æˆä¸€ä¸ªè¿›ç¨‹å±‚æ¬¡ç»“æ„ã€‚</p><h3 id="unix-è¿›ç¨‹ä½“ç³»"><a class="markdownIt-Anchor" href="#unix-è¿›ç¨‹ä½“ç³»"></a> <code>UNIX</code> è¿›ç¨‹ä½“ç³»</h3><p>åœ¨ UNIX ä¸­ï¼Œè¿›ç¨‹å’Œå®ƒçš„æ‰€æœ‰å­è¿›ç¨‹ä»¥åŠå­è¿›ç¨‹çš„å­è¿›ç¨‹å…±åŒç»„æˆä¸€ä¸ªè¿›ç¨‹ç»„ã€‚å½“ç”¨æˆ·ä»é”®ç›˜ä¸­å‘å‡ºä¸€ä¸ªä¿¡å·åï¼Œè¯¥ä¿¡å·è¢«å‘é€ç»™å½“å‰ä¸é”®ç›˜ç›¸å…³çš„è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰æˆå‘˜ï¼ˆå®ƒä»¬é€šå¸¸æ˜¯åœ¨å½“å‰çª—å£åˆ›å»ºçš„æ‰€æœ‰æ´»åŠ¨è¿›ç¨‹ï¼‰ã€‚æ¯ä¸ªè¿›ç¨‹å¯ä»¥åˆ†åˆ«æ•è·è¯¥ä¿¡å·ã€å¿½ç•¥è¯¥ä¿¡å·æˆ–é‡‡å–é»˜è®¤çš„åŠ¨ä½œï¼Œå³è¢«ä¿¡å· <code>kill</code> æ‰ã€‚</p><p><code>UNIX</code> åœ¨å¯åŠ¨æ—¶ä¼šè¿è¡Œ <code>init</code> è¿›ç¨‹ï¼Œå®ƒä¼šåˆå§‹åŒ–å¤šä¸ªå­è¿›ç¨‹ï¼Œå› æ­¤ï¼Œæ•´ä¸ªæ“ä½œç³»ç»Ÿä¸­çš„æ‰€æœ‰è¿›ç¨‹éƒ½å±äºä¸€ä¸ªä»¥ <code>init</code> ä¸ºæ ¹çš„è¿›ç¨‹æ ‘ã€‚</p><h3 id="windows-è¿›ç¨‹ä½“ç³»"><a class="markdownIt-Anchor" href="#windows-è¿›ç¨‹ä½“ç³»"></a> <code>Windows</code> è¿›ç¨‹ä½“ç³»</h3><p><code>Windows</code> ä¸­æ²¡æœ‰è¿›ç¨‹å±‚æ¬¡çš„æ¦‚å¿µï¼ŒWindows ä¸­æ‰€æœ‰è¿›ç¨‹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œå”¯ä¸€ç±»ä¼¼äºå±‚æ¬¡ç»“æ„çš„æ˜¯åœ¨åˆ›å»ºè¿›ç¨‹çš„æ—¶å€™ï¼Œçˆ¶è¿›ç¨‹å¾—åˆ°ä¸€ä¸ªç‰¹åˆ«çš„ä»¤ç‰Œï¼ˆç§°ä¸º<code>å¥æŸ„</code>ï¼‰ï¼Œè¯¥å¥æŸ„å¯ä»¥ç”¨æ¥æ§åˆ¶å­è¿›ç¨‹ã€‚ç„¶è€Œï¼Œè¿™ä¸ªä»¤ç‰Œå¯èƒ½ä¹Ÿä¼šç§»äº¤ç»™åˆ«çš„æ“ä½œç³»ç»Ÿï¼Œè¿™æ ·å°±ä¸å­˜åœ¨å±‚æ¬¡ç»“æ„äº†ã€‚è€Œåœ¨ <code>UNIX</code> ä¸­ï¼Œè¿›ç¨‹ä¸èƒ½å‰¥å¤ºå…¶å­è¿›ç¨‹çš„ <strong>è¿›ç¨‹æƒ</strong>ã€‚</p><h2 id="è¿›ç¨‹çŠ¶æ€"><a class="markdownIt-Anchor" href="#è¿›ç¨‹çŠ¶æ€"></a> è¿›ç¨‹çŠ¶æ€</h2><p>å°½ç®¡æ¯ä¸ªè¿›ç¨‹æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ä½“ï¼Œæœ‰å…¶è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨å’Œå†…éƒ¨çŠ¶æ€ï¼Œä½†æ˜¯ï¼Œè¿›ç¨‹ä¹‹é—´ä»ç„¶éœ€è¦ç›¸äº’å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¿›ç¨‹çš„ç»“æœå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªè¿›ç¨‹çš„è¾“å…¥ï¼Œåœ¨ <code>shell</code> å‘½ä»¤ä¸­</p><pre><code class="hljs shell">cat chapter1 chapter2 chapter3 | grep tree</code></pre><p>ç¬¬ä¸€ä¸ªè¿›ç¨‹æ˜¯ <code>cat</code>ï¼Œå°†ä¸‰ä¸ªæ–‡ä»¶çº§è”å¹¶è¾“å‡ºã€‚ç¬¬äºŒä¸ªè¿›ç¨‹æ˜¯ <code>grep</code>ï¼Œå®ƒä»è¾“å…¥ä¸­é€‰æ‹©å…·æœ‰åŒ…å«å…³é”®å­— <code>tree</code> çš„å†…å®¹ï¼Œæ ¹æ®è¿™ä¸¤ä¸ªè¿›ç¨‹çš„ç›¸å¯¹é€Ÿåº¦ï¼ˆè¿™å–å†³äºä¸¤ä¸ªç¨‹åºçš„ç›¸å¯¹å¤æ‚åº¦å’Œå„è‡ªæ‰€åˆ†é…åˆ°çš„ <code>CPU</code> æ—¶é—´ç‰‡ï¼‰ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸‹é¢è¿™ç§æƒ…å†µï¼Œ<code>grep</code> å‡†å¤‡å°±ç»ªå¼€å§‹è¿è¡Œï¼Œä½†æ˜¯è¾“å…¥è¿›ç¨‹è¿˜æ²¡æœ‰å®Œæˆï¼Œäºæ˜¯å¿…é¡»é˜»å¡ <code>grep</code> è¿›ç¨‹ï¼Œç›´åˆ°è¾“å…¥å®Œæ¯•ã€‚</p><p>å½“ä¸€ä¸ªè¿›ç¨‹å¼€å§‹è¿è¡Œæ—¶ï¼Œå®ƒå¯èƒ½ä¼šç»å†ä¸‹é¢è¿™å‡ ç§çŠ¶æ€</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921150701.png" srcset="/img/loading.gif" alt="" /></p><p>å›¾ä¸­ä¼šæ¶‰åŠä¸‰ç§çŠ¶æ€ï¼š</p><ol><li><strong>è¿è¡Œæ€</strong>ï¼Œè¯¥æ—¶åˆ»è¿›ç¨‹å®é™…å ç”¨ <code>CPU</code>ã€‚</li><li><strong>å°±ç»ªæ€</strong>ï¼Œå¯è¿è¡Œï¼Œä½†å› ä¸ºå…¶ä»–è¿›ç¨‹æ­£åœ¨è¿è¡Œè€Œå¤„äºå°±ç»ªçŠ¶æ€ã€‚</li><li><strong>é˜»å¡æ€</strong>ï¼Œé™¤éæŸç§å¤–éƒ¨äº‹ä»¶å‘ç”Ÿï¼Œå¦åˆ™è¿›ç¨‹ä¸èƒ½è¿è¡Œã€‚</li></ol><ul><li>é€»è¾‘ä¸Šæ¥è¯´ï¼Œè¿è¡Œæ€å’Œå°±ç»ªæ€æ˜¯å¾ˆç›¸ä¼¼çš„ã€‚éƒ½è¡¨ç¤ºè¿›ç¨‹å¯è¿è¡Œï¼Œä½†æ˜¯<strong>å°±ç»ªæ€</strong>æ²¡æœ‰è·å¾— <code>CPU</code> æ—¶é—´åˆ†ç‰‡ã€‚</li><li>é˜»å¡æ€ä¸å‰ä¸¤ç§çŠ¶æ€ä¸åŒçš„åŸå› æ˜¯<strong>è¿™ä¸ªè¿›ç¨‹ä¸èƒ½è¿è¡Œï¼Œ<code>CPU</code> ç©ºé—²æ—¶ä¹Ÿä¸èƒ½è¿è¡Œ</strong>ã€‚</li></ul><p>ä¸‰ç§çŠ¶æ€ä¼šæ¶‰åŠå››ç§çŠ¶æ€é—´çš„åˆ‡æ¢ï¼Œåœ¨æ“ä½œç³»ç»Ÿå‘ç°è¿›ç¨‹ä¸èƒ½ç»§ç»­æ‰§è¡Œæ—¶ä¼šå‘ç”Ÿ <code>çŠ¶æ€ 1</code> çš„è½®è½¬ã€‚<br /><code>è½¬æ¢ 2</code> å’Œ<code>è½¬æ¢ 3</code> éƒ½æ˜¯ç”±è¿›ç¨‹è°ƒåº¦ç¨‹åºå¼•èµ·çš„ï¼Œè¿›ç¨‹æœ¬èº«ä¸çŸ¥é“è°ƒåº¦ç¨‹åºçš„å­˜åœ¨ã€‚<br /><code>è½¬æ¢ 2</code> çš„å‡ºç°è¯´æ˜è¿›ç¨‹è°ƒåº¦å™¨è®¤å®šå½“å‰è¿›ç¨‹å·²ç»è¿è¡Œäº†è¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œæ˜¯æ—¶å€™è®©å…¶ä»–è¿›ç¨‹è¿è¡Œ <code>CPU</code> æ—¶é—´ç‰‡äº†ã€‚<br />å½“æ‰€æœ‰å…¶ä»–è¿›ç¨‹éƒ½è¿è¡Œè¿‡åï¼Œè¿™æ—¶å€™è¯¥æ˜¯è®©ç¬¬ä¸€ä¸ªè¿›ç¨‹é‡æ–°è·å¾— <code>CPU</code> æ—¶é—´ç‰‡çš„æ—¶å€™äº†ï¼Œå°±ä¼šå‘ç”Ÿ<code>è½¬æ¢ 3</code>ã€‚</p><blockquote><p>ç¨‹åºè°ƒåº¦æŒ‡çš„æ˜¯ï¼Œå†³å®šå“ªä¸ªè¿›ç¨‹ä¼˜å…ˆè¢«è¿è¡Œå’Œè¿è¡Œå¤šä¹…ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ã€‚å·²ç»è®¾è®¡å‡ºè®¸å¤šç®—æ³•æ¥å°è¯•å¹³è¡¡ç³»ç»Ÿæ•´ä½“æ•ˆç‡ä¸å„ä¸ªæµç¨‹ä¹‹é—´çš„ç«äº‰éœ€æ±‚ã€‚</p></blockquote><p>å½“è¿›ç¨‹ç­‰å¾…çš„ä¸€ä¸ªå¤–éƒ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆå¦‚ä»å¤–éƒ¨è¾“å…¥ä¸€äº›æ•°æ®åï¼‰ï¼Œåˆ™å‘ç”Ÿ<code>è½¬æ¢ 4</code>ã€‚å¦‚æœæ­¤æ—¶æ²¡æœ‰å…¶ä»–è¿›ç¨‹åœ¨è¿è¡Œï¼Œåˆ™ç«‹åˆ»è§¦å‘<code>è½¬æ¢ 3</code>ï¼Œè¯¥è¿›ç¨‹ä¾¿å¼€å§‹è¿è¡Œï¼Œå¦åˆ™è¯¥è¿›ç¨‹ä¼šå¤„äºå°±ç»ªé˜¶æ®µï¼Œç­‰å¾… <code>CPU</code> ç©ºé—²åå†è½®åˆ°å®ƒè¿è¡Œã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921152100.png" srcset="/img/loading.gif" alt="" /></p><p><strong>æ“ä½œç³»ç»Ÿæœ€åº•å±‚çš„å°±æ˜¯è°ƒåº¦ç¨‹åº</strong>ï¼Œåœ¨å®ƒä¸Šé¢æœ‰è®¸å¤šè¿›ç¨‹ã€‚æ‰€æœ‰å…³äºä¸­æ–­å¤„ç†ã€å¯åŠ¨è¿›ç¨‹å’Œåœæ­¢è¿›ç¨‹çš„å…·ä½“ç»†èŠ‚éƒ½éšè—åœ¨è°ƒåº¦ç¨‹åºä¸­ã€‚äº‹å®ä¸Šï¼Œè°ƒåº¦ç¨‹åºåªæ˜¯ä¸€æ®µéå¸¸å°çš„ç¨‹åºã€‚</p><h2 id="è¿›ç¨‹çš„å®ç°"><a class="markdownIt-Anchor" href="#è¿›ç¨‹çš„å®ç°"></a> è¿›ç¨‹çš„å®ç°</h2><p>æ“ä½œç³»ç»Ÿä¸ºäº†æ‰§è¡Œè¿›ç¨‹é—´çš„åˆ‡æ¢ï¼Œä¼šç»´æŠ¤ç€ä¸€å¼ è¡¨æ ¼ï¼Œè¿™å¼ è¡¨å°±æ˜¯ <code>è¿›ç¨‹è¡¨(process table)</code>ã€‚æ¯ä¸ªè¿›ç¨‹å ç”¨ä¸€ä¸ªè¿›ç¨‹è¡¨é¡¹ã€‚è¯¥è¡¨é¡¹åŒ…å«äº†è¿›ç¨‹çŠ¶æ€çš„é‡è¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬<strong>ç¨‹åºè®¡æ•°å™¨</strong>ã€<strong>å †æ ˆæŒ‡é’ˆ</strong>ã€<strong>å†…å­˜åˆ†é…çŠ¶å†µ</strong>ã€<strong>æ‰€æ‰“å¼€æ–‡ä»¶çš„çŠ¶æ€</strong>ã€<strong>è´¦å·å’Œè°ƒåº¦ä¿¡æ¯</strong>ï¼Œä»¥åŠå…¶ä»–åœ¨è¿›ç¨‹ç”±è¿è¡Œæ€è½¬æ¢åˆ°å°±ç»ªæ€æˆ–é˜»å¡æ€æ—¶æ‰€å¿…é¡»ä¿å­˜çš„ä¿¡æ¯ï¼Œä»è€Œä¿è¯è¯¥è¿›ç¨‹éšåèƒ½å†æ¬¡å¯åŠ¨ï¼Œå°±åƒä»æœªè¢«ä¸­æ–­è¿‡ä¸€æ ·ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921152615.webp" srcset="/img/loading.gif" alt="" /></p><p>ç¬¬ä¸€åˆ—å†…å®¹ä¸ <strong>è¿›ç¨‹ç®¡ç†</strong> æœ‰å…³ï¼Œç¬¬äºŒåˆ—å†…å®¹ä¸ <strong>å­˜å‚¨ç®¡ç†</strong> æœ‰å…³ï¼Œç¬¬ä¸‰åˆ—å†…å®¹ä¸ <strong>æ–‡ä»¶ç®¡ç†</strong> æœ‰å…³ã€‚</p><h1 id="çº¿ç¨‹"><a class="markdownIt-Anchor" href="#çº¿ç¨‹"></a> çº¿ç¨‹</h1><h2 id="çº¿ç¨‹çš„ä½¿ç”¨"><a class="markdownIt-Anchor" href="#çº¿ç¨‹çš„ä½¿ç”¨"></a> çº¿ç¨‹çš„ä½¿ç”¨</h2><p>ä¸ºä»€ä¹ˆè¦åœ¨è¿›ç¨‹çš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„æ¦‚å¿µï¼š</p><ul><li>å¤šçº¿ç¨‹ä¹‹é—´ä¼š<strong>å…±äº«åŒä¸€å—åœ°å€ç©ºé—´å’Œæ‰€æœ‰å¯ç”¨æ•°æ®</strong>çš„èƒ½åŠ›ï¼Œè¿™æ˜¯è¿›ç¨‹æ‰€ä¸å…·å¤‡çš„ã€‚</li><li>çº¿ç¨‹è¦æ¯”è¿›ç¨‹æ›´<strong>è½»é‡çº§</strong>ï¼Œå®ƒæ¯”è¿›ç¨‹æ›´å®¹æ˜“åˆ›å»ºï¼Œä¹Ÿæ›´å®¹æ˜“æ’¤é”€ã€‚åœ¨è®¸å¤šç³»ç»Ÿä¸­ï¼Œåˆ›å»ºä¸€ä¸ªçº¿ç¨‹è¦æ¯”åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¿« <code>10 - 100</code> å€ã€‚</li><li>æ€§èƒ½æ–¹é¢ï¼šå¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½æ˜¯ <code>CPU</code> å¯†é›†å‹çš„ï¼Œé‚£ä¹ˆå¹¶ä¸èƒ½è·å¾—æ€§èƒ½ä¸Šçš„å¢å¼ºï¼Œä½†æ˜¯å¦‚æœå­˜åœ¨ç€<strong>å¤§é‡çš„è®¡ç®—å’Œå¤§é‡çš„ <code>I/O</code> å¤„ç†</strong>ï¼Œæ‹¥æœ‰å¤šä¸ªçº¿ç¨‹èƒ½åœ¨è¿™äº›æ´»åŠ¨ä¸­å½¼æ­¤é‡å è¿›è¡Œï¼Œä»è€Œä¼šåŠ å¿«åº”ç”¨ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦ã€‚</li></ul><h3 id="1-å¤šçº¿ç¨‹è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#1-å¤šçº¿ç¨‹è§£å†³æ–¹æ¡ˆ"></a> 1. å¤šçº¿ç¨‹è§£å†³æ–¹æ¡ˆ</h3><p>ä¸€ä¸ª WEB æœåŠ¡å™¨ï¼Œå¯¹é¡µé¢çš„è¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ï¼Œè€Œæ‰€è¯·æ±‚çš„é¡µé¢å‘é€å›å®¢æˆ·ç«¯ã€‚åœ¨å¤šæ•° WEB ç«™ç‚¹ä¸Šï¼ŒæŸäº›é¡µé¢è¾ƒå…¶ä»–é¡µé¢ç›¸æ¯”æœ‰æ›´å¤šçš„è®¿é—®ã€‚Web æœåŠ¡å™¨å¯ä»¥æŠŠè·å¾—å¤§é‡è®¿é—®çš„é¡µé¢é›†åˆä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé¿å…åˆ°ç£ç›˜å»è°ƒå…¥è¿™äº›é¡µé¢ï¼Œä»è€Œæ”¹å–„æ€§èƒ½ã€‚è¿™ç§é¡µé¢çš„é›†åˆç§°ä¸º <code>é«˜é€Ÿç¼“å­˜(cache)</code>ï¼Œé«˜é€Ÿç¼“å­˜ä¹Ÿåº”ç”¨åœ¨è®¸å¤šåœºåˆä¸­ï¼Œæ¯”å¦‚è¯´ <code>CPU</code> ç¼“å­˜ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921153549.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šé¢æ˜¯ä¸€ä¸ª web æœåŠ¡å™¨çš„ç»„ç»‡æ–¹å¼ï¼Œä¸€ä¸ªå«åš <code>è°ƒåº¦çº¿ç¨‹(dispatcher thread)</code> çš„çº¿ç¨‹ä»ç½‘ç»œä¸­è¯»å…¥å·¥ä½œè¯·æ±‚ï¼Œåœ¨è°ƒåº¦çº¿ç¨‹æ£€æŸ¥å®Œè¯·æ±‚åï¼Œå®ƒä¼šé€‰æ‹©ä¸€ä¸ªç©ºé—²çš„ï¼ˆé˜»å¡çš„ï¼‰å·¥ä½œçº¿ç¨‹æ¥å¤„ç†è¯·æ±‚ï¼Œé€šå¸¸æ˜¯å°†æ¶ˆæ¯çš„æŒ‡é’ˆå†™å…¥åˆ°æ¯ä¸ªçº¿ç¨‹å…³è”çš„ç‰¹æ®Šå­—ä¸­ã€‚ç„¶åè°ƒåº¦çº¿ç¨‹ä¼šå”¤é†’æ­£åœ¨ç¡çœ ä¸­çš„å·¥ä½œçº¿ç¨‹ï¼ŒæŠŠå·¥ä½œçº¿ç¨‹çš„çŠ¶æ€ä»é˜»å¡æ€å˜ä¸ºå°±ç»ªæ€ã€‚</p><p>å½“<code>å·¥ä½œçº¿ç¨‹</code>å¯åŠ¨åï¼Œå®ƒä¼šæ£€æŸ¥è¯·æ±‚æ˜¯å¦åœ¨ web é¡µé¢çš„é«˜é€Ÿç¼“å­˜ä¸­å­˜åœ¨ï¼Œè¿™ä¸ªé«˜é€Ÿç¼“å­˜æ˜¯æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®çš„ã€‚å¦‚æœé«˜é€Ÿç¼“å­˜ä¸å­˜åœ¨è¿™ä¸ª web é¡µé¢çš„è¯ï¼Œå®ƒä¼šè°ƒç”¨ä¸€ä¸ª read æ“ä½œä»ç£ç›˜ä¸­è·å–é¡µé¢å¹¶ä¸”é˜»å¡çº¿ç¨‹ç›´åˆ°ç£ç›˜æ“ä½œå®Œæˆã€‚å½“çº¿ç¨‹é˜»å¡åœ¨ç¡¬ç›˜æ“ä½œçš„æœŸé—´ï¼Œä¸ºäº†å®Œæˆæ›´å¤šçš„å·¥ä½œï¼Œè°ƒåº¦çº¿ç¨‹å¯èƒ½æŒ‘é€‰å¦ä¸€ä¸ªçº¿ç¨‹è¿è¡Œï¼Œä¹Ÿå¯èƒ½æŠŠå¦ä¸€ä¸ªå½“å‰å°±ç»ªçš„å·¥ä½œçº¿ç¨‹æŠ•å…¥è¿è¡Œã€‚</p><p>è¿™ç§æ¨¡å‹å…è®¸<strong>å°†æœåŠ¡å™¨ç¼–å†™ä¸ºé¡ºåºçº¿ç¨‹</strong>çš„é›†åˆï¼Œåœ¨åˆ†æ´¾çº¿ç¨‹çš„ç¨‹åºä¸­åŒ…å«ä¸€ä¸ªæ­»å¾ªç¯ï¼Œè¯¥å¾ªç¯ç”¨æ¥è·å¾—å·¥ä½œè¯·æ±‚å¹¶ä¸”æŠŠè¯·æ±‚æ´¾ç»™å·¥ä½œçº¿ç¨‹ã€‚æ¯ä¸ªå·¥ä½œçº¿ç¨‹çš„ä»£ç åŒ…å«ä¸€ä¸ªä»è°ƒåº¦çº¿ç¨‹æ¥æ”¶çš„è¯·æ±‚ï¼Œå¹¶ä¸”æ£€æŸ¥ web é«˜é€Ÿç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨æ‰€éœ€é¡µé¢ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥æŠŠè¯¥é¡µé¢è¿”å›ç»™å®¢æˆ·ï¼Œæ¥ç€å·¥ä½œçº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…ä¸€ä¸ªæ–°è¯·æ±‚çš„åˆ°è¾¾ã€‚å¦‚æœæ²¡æœ‰ï¼Œå·¥ä½œçº¿ç¨‹å°±ä»ç£ç›˜è°ƒå…¥è¯¥é¡µé¢ï¼Œå°†è¯¥é¡µé¢è¿”å›ç»™å®¢æˆ·æœºï¼Œç„¶åå·¥ä½œçº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…ä¸€ä¸ªæ–°è¯·æ±‚ã€‚</p><h3 id="2-å•çº¿ç¨‹è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#2-å•çº¿ç¨‹è§£å†³æ–¹æ¡ˆ"></a> 2. å•çº¿ç¨‹è§£å†³æ–¹æ¡ˆ</h3><p>Web æœåŠ¡å™¨çš„ä¸»å¾ªç¯è·å–è¯·æ±‚å¹¶æ£€æŸ¥è¯·æ±‚ï¼Œå¹¶äº‰å–åœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚ä¹‹å‰å®Œæˆå·¥ä½œã€‚åœ¨ç­‰å¾…ç£ç›˜æ“ä½œæ—¶ï¼ŒæœåŠ¡å™¨ç©ºè½¬ï¼Œå¹¶ä¸”ä¸å¤„ç†ä»»ä½•åˆ°æ¥çš„å…¶ä»–è¯·æ±‚ã€‚ç»“æœä¼šå¯¼è‡´æ¯ç§’ä¸­åªæœ‰å¾ˆå°‘çš„è¯·æ±‚è¢«å¤„ç†ï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­èƒ½å¤Ÿè¯´æ˜å¤šçº¿ç¨‹æé«˜äº†ç¨‹åºçš„å¹¶è¡Œæ€§å¹¶æé«˜äº†ç¨‹åºçš„æ€§èƒ½ã€‚</p><h3 id="3-çŠ¶æ€æœºè§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#3-çŠ¶æ€æœºè§£å†³æ–¹æ¡ˆ"></a> 3. çŠ¶æ€æœºè§£å†³æ–¹æ¡ˆ</h3><p>å¦‚æœç›®å‰åªæœ‰ä¸€ä¸ªéé˜»å¡ç‰ˆæœ¬çš„ read ç³»ç»Ÿè°ƒç”¨å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆå½“è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œè¿™ä¸ªå”¯ä¸€çš„ read è°ƒç”¨çš„çº¿ç¨‹ä¼šè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœèƒ½å¤Ÿä»é«˜é€Ÿç¼“å­˜ä¸­å¾—åˆ°å“åº”ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™å¯åŠ¨ä¸€ä¸ªéé˜»å¡çš„ç£ç›˜æ“ä½œã€‚</p><p>æœåŠ¡å™¨åœ¨è¡¨ä¸­è®°å½•å½“å‰è¯·æ±‚çš„çŠ¶æ€ï¼Œç„¶åè¿›å…¥å¹¶è·å–ä¸‹ä¸€ä¸ªäº‹ä»¶ï¼Œç´§æ¥ç€ä¸‹ä¸€ä¸ªäº‹ä»¶å¯èƒ½å°±æ˜¯ä¸€ä¸ªæ–°å·¥ä½œçš„è¯·æ±‚æˆ–æ˜¯ç£ç›˜å¯¹å…ˆå‰æ“ä½œçš„å›ç­”ã€‚å¦‚æœæ˜¯æ–°å·¥ä½œçš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¼€å§‹å¤„ç†è¯·æ±‚ã€‚å¦‚æœæ˜¯ç£ç›˜çš„å“åº”ï¼Œå°±ä»è¡¨ä¸­å–å‡ºå¯¹åº”çš„çŠ¶æ€ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¯¹äºéé˜»å¡å¼ç£ç›˜ I/O è€Œè¨€ï¼Œè¿™ç§å“åº”ä¸€èˆ¬éƒ½æ˜¯ä¿¡å·ä¸­æ–­å“åº”ã€‚</p><p>æ¯æ¬¡æœåŠ¡å™¨ä»æŸä¸ªè¯·æ±‚å·¥ä½œçš„çŠ¶æ€åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œéƒ½å¿…é¡»æ˜¾ç¤ºçš„ä¿å­˜æˆ–è€…é‡æ–°è£…å…¥ç›¸åº”çš„è®¡ç®—çŠ¶æ€ã€‚è¿™é‡Œï¼Œæ¯ä¸ªè®¡ç®—éƒ½æœ‰ä¸€ä¸ªè¢«ä¿å­˜çš„çŠ¶æ€ï¼Œå­˜åœ¨ä¸€ä¸ªä¼šå‘ç”Ÿä¸”ä½¿å¾—ç›¸å…³çŠ¶æ€å‘ç”Ÿæ”¹å˜çš„äº‹ä»¶é›†åˆï¼Œæˆ‘ä»¬æŠŠè¿™ç±»è®¾è®¡ç§°ä¸º <code>æœ‰é™çŠ¶æ€æœº(finite-state machine)</code>ã€‚</p><ul><li>å¤šçº¿ç¨‹ä½¿å¾—é¡ºåºè¿›ç¨‹çš„æ€æƒ³å¾—ä»¥ä¿ç•™ä¸‹æ¥ï¼Œå¹¶ä¸”å®ç°äº†<strong>å¹¶è¡Œæ€§</strong>ï¼Œä½†æ˜¯é¡ºåºè¿›ç¨‹ä¼š<strong>é˜»å¡ç³»ç»Ÿè°ƒç”¨</strong>ï¼›</li><li>å•çº¿ç¨‹æœåŠ¡å™¨ä¿ç•™äº†é˜»å¡ç³»ç»Ÿçš„ç®€æ˜“æ€§ï¼Œä½†æ˜¯å´æ”¾å¼ƒäº†æ€§èƒ½ã€‚</li><li>æœ‰é™çŠ¶æ€æœºçš„å¤„ç†æ–¹æ³•è¿ç”¨äº†<strong>éé˜»å¡è°ƒç”¨</strong>å’Œä¸­æ–­ï¼Œé€šè¿‡<strong>å¹¶è¡Œ</strong>å®ç°äº†é«˜æ€§èƒ½ï¼Œä½†æ˜¯ç»™ç¼–ç¨‹å¢åŠ äº†å›°éš¾ã€‚</li></ul><h2 id="ç»å…¸çš„çº¿ç¨‹æ¨¡å‹"><a class="markdownIt-Anchor" href="#ç»å…¸çš„çº¿ç¨‹æ¨¡å‹"></a> ç»å…¸çš„çº¿ç¨‹æ¨¡å‹</h2><p>ç»„æˆï¼š</p><ul><li><strong>ç¨‹åºè®¡æ•°å™¨</strong>ï¼Œè®°å½•æ¥ç€è¦æ‰§è¡Œå“ªä¸€æ¡æŒ‡ä»¤ï¼›</li><li><strong>å¯„å­˜å™¨</strong>ï¼Œä¿å­˜çº¿ç¨‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„å˜é‡ï¼›</li><li><strong>å †æ ˆ</strong>ï¼Œè®°å½•ç¨‹åºçš„æ‰§è¡Œè·¯å¾„ã€‚</li></ul><p>åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå…è®¸å½¼æ­¤ä¹‹é—´æœ‰è¾ƒå¤§çš„ç‹¬ç«‹æ€§ä¸”äº’ä¸å¹²æ‰°ã€‚åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­å¹¶è¡Œè¿è¡Œå¤šä¸ªçº¿ç¨‹ç±»ä¼¼äºåœ¨ä¸€å°è®¡ç®—æœºä¸Šè¿è¡Œå¤šä¸ªè¿›ç¨‹ã€‚<br />åœ¨å¤šä¸ªçº¿ç¨‹ä¸­ï¼Œå„ä¸ªçº¿ç¨‹å…±äº«åŒä¸€åœ°å€ç©ºé—´å’Œå…¶ä»–èµ„æºã€‚<br />åœ¨å¤šä¸ªè¿›ç¨‹ä¸­ï¼Œè¿›ç¨‹å…±äº«ç‰©ç†å†…å­˜ã€ç£ç›˜ã€æ‰“å°æœºå’Œå…¶ä»–èµ„æºã€‚å› ä¸ºçº¿ç¨‹ä¼šåŒ…å«æœ‰ä¸€äº›è¿›ç¨‹çš„å±æ€§ï¼Œæ‰€ä»¥çº¿ç¨‹è¢«ç§°ä¸ºè½»é‡çš„è¿›ç¨‹(<code>lightweight processes</code>)ã€‚</p><p>ä¸‰ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„åœ°å€ç©ºé—´å’Œå•ä¸ªæ§åˆ¶çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ä¸åŒçš„åœ°å€ç©ºé—´ä¸­è¿è¡Œã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921155110.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸€ä¸ªè¿›ç¨‹ä¸‰ä¸ªçº¿ç¨‹çš„æƒ…å†µã€‚æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç›¸åŒçš„åœ°å€ç©ºé—´ä¸­è¿è¡Œã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921155327.png" srcset="/img/loading.gif" alt="" /></p><p>çº¿ç¨‹ä¸åƒæ˜¯è¿›ç¨‹é‚£æ ·å…·å¤‡è¾ƒå¼ºçš„ç‹¬ç«‹æ€§ã€‚<strong>åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šæœ‰å®Œå…¨ä¸€æ ·çš„åœ°å€ç©ºé—´</strong>ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¹Ÿ<strong>å…±äº«åŒæ ·çš„å…¨å±€å˜é‡</strong>ã€‚ç”±äºæ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è®¿é—®è¿›ç¨‹åœ°å€ç©ºé—´å†…æ¯ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¯»å–ã€å†™å…¥ç”šè‡³æ“¦é™¤å¦ä¸€ä¸ªçº¿ç¨‹çš„å †æ ˆã€‚çº¿ç¨‹ä¹‹é—´é™¤äº†å…±äº«åŒä¸€å†…å­˜ç©ºé—´å¤–ï¼Œè¿˜å…·æœ‰å¦‚ä¸‹ä¸åŒçš„å†…å®¹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921155439.png" srcset="/img/loading.gif" alt="" /></p><p>å’Œè¿›ç¨‹ä¸€æ ·ï¼Œçº¿ç¨‹å¯ä»¥å¤„äºä¸‹é¢è¿™å‡ ç§çŠ¶æ€ï¼š<strong>è¿è¡Œ</strong>ã€<strong>é˜»å¡</strong>ã€<strong>å°±ç»ª</strong>å’Œ<strong>ç»ˆæ­¢</strong>ã€‚<br />æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ‹¥æœ‰ <code>CPU</code> æ—¶é—´ç‰‡å¹¶ä¸”çŠ¶æ€æ˜¯è¿è¡Œä¸­ã€‚<br />ä¸€ä¸ªè¢«é˜»å¡çš„çº¿ç¨‹ä¼šç­‰å¾…æŸä¸ªé‡Šæ”¾å®ƒçš„äº‹ä»¶ã€‚<br />ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä»é”®ç›˜è¯»å…¥æ•°æ®çš„ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œè¯¥çº¿ç¨‹å°±è¢«é˜»å¡ç›´åˆ°æœ‰è¾“å…¥ä¸ºæ­¢ã€‚çº¿ç¨‹é€šå¸¸ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å®ƒç­‰å¾…æŸä¸ªå¤–éƒ¨äº‹ä»¶çš„å‘ç”Ÿæˆ–è€…æœ‰å…¶ä»–çº¿ç¨‹æ¥é‡Šæ”¾å®ƒã€‚çº¿ç¨‹ä¹‹é—´çš„çŠ¶æ€è½¬æ¢å’Œè¿›ç¨‹ä¹‹é—´çš„çŠ¶æ€è½¬æ¢æ˜¯ä¸€æ ·çš„ã€‚</p><p>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è‡ªå·±çš„å †æ ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921155658.png" srcset="/img/loading.gif" alt="" /></p><h2 id="çº¿ç¨‹å®ç°"><a class="markdownIt-Anchor" href="#çº¿ç¨‹å®ç°"></a> çº¿ç¨‹å®ç°</h2><h3 id="1-åœ¨ç”¨æˆ·ç©ºé—´ä¸­å®ç°çº¿ç¨‹"><a class="markdownIt-Anchor" href="#1-åœ¨ç”¨æˆ·ç©ºé—´ä¸­å®ç°çº¿ç¨‹"></a> 1. åœ¨ç”¨æˆ·ç©ºé—´ä¸­å®ç°çº¿ç¨‹</h3><p>ç¬¬ä¸€ç§æ–¹æ³•æ˜¯æŠŠæ•´ä¸ªçº¿ç¨‹åŒ…æ”¾åœ¨ç”¨æˆ·ç©ºé—´ä¸­ï¼Œå†…æ ¸å¯¹çº¿ç¨‹ä¸€æ— æ‰€çŸ¥ï¼Œå®ƒä¸çŸ¥é“çº¿ç¨‹çš„å­˜åœ¨ã€‚æ‰€æœ‰çš„è¿™ç±»å®ç°éƒ½æœ‰åŒæ ·çš„é€šç”¨ç»“æ„ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921160042.png" srcset="/img/loading.gif" alt="" /><br />çº¿ç¨‹åœ¨è¿è¡Œæ—¶ç³»ç»Ÿä¹‹ä¸Šè¿è¡Œï¼Œè¿è¡Œæ—¶ç³»ç»Ÿæ˜¯ç®¡ç†çº¿ç¨‹è¿‡ç¨‹çš„é›†åˆã€‚</p><blockquote><p><code>è¿è¡Œæ—¶ç³»ç»Ÿ(Runtime System)</code> ä¹Ÿå«åšè¿è¡Œæ—¶ç¯å¢ƒï¼Œ<strong>è¯¥è¿è¡Œæ—¶ç³»ç»Ÿæä¾›äº†ç¨‹åºåœ¨å…¶ä¸­è¿è¡Œçš„ç¯å¢ƒ</strong>ã€‚æ­¤ç¯å¢ƒå¯èƒ½ä¼šè§£å†³è®¸å¤šé—®é¢˜ï¼ŒåŒ…æ‹¬åº”ç”¨ç¨‹åºå†…å­˜çš„å¸ƒå±€ï¼Œç¨‹åºå¦‚ä½•è®¿é—®å˜é‡ï¼Œåœ¨è¿‡ç¨‹ä¹‹é—´ä¼ é€’å‚æ•°çš„æœºåˆ¶ï¼Œä¸æ“ä½œç³»ç»Ÿçš„æ¥å£ç­‰ç­‰ã€‚ç¼–è¯‘å™¨æ ¹æ®ç‰¹å®šçš„è¿è¡Œæ—¶ç³»ç»Ÿè¿›è¡Œå‡è®¾ä»¥ç”Ÿæˆæ­£ç¡®çš„ä»£ç ã€‚é€šå¸¸ï¼Œè¿è¡Œæ—¶ç³»ç»Ÿå°†è´Ÿè´£è®¾ç½®å’Œç®¡ç†å †æ ˆï¼Œå¹¶ä¸”ä¼šåŒ…å«è¯¸å¦‚åƒåœ¾æ”¶é›†ï¼Œçº¿ç¨‹æˆ–è¯­è¨€å†…ç½®çš„å…¶ä»–åŠ¨æ€çš„åŠŸèƒ½ã€‚</p></blockquote><p>åœ¨ç”¨æˆ·ç©ºé—´ç®¡ç†çº¿ç¨‹æ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹éœ€è¦æœ‰å…¶ä¸“ç”¨çš„ <code>çº¿ç¨‹è¡¨(thread table)</code>ï¼Œ<strong>ç”¨æ¥è·Ÿè¸ªè¯¥è¿›ç¨‹ä¸­çš„çº¿ç¨‹</strong>ã€‚è¿™äº›è¡¨å’Œå†…æ ¸ä¸­çš„è¿›ç¨‹è¡¨ç±»ä¼¼ï¼Œä¸è¿‡å®ƒä»…ä»…è®°å½•å„ä¸ªçº¿ç¨‹çš„å±æ€§ï¼Œå¦‚æ¯ä¸ªçº¿ç¨‹çš„ç¨‹åºè®¡æ•°å™¨ã€å †æ ˆæŒ‡é’ˆã€å¯„å­˜å™¨å’ŒçŠ¶æ€ã€‚<strong>è¯¥çº¿ç¨‹æ ‡ç”±è¿è¡Œæ—¶ç³»ç»Ÿç»Ÿä¸€ç®¡ç†</strong>ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è½¬æ¢åˆ°å°±ç»ªçŠ¶æ€æˆ–é˜»å¡çŠ¶æ€æ—¶ï¼Œåœ¨è¯¥çº¿ç¨‹è¡¨ä¸­å­˜æ”¾é‡æ–°å¯åŠ¨è¯¥çº¿ç¨‹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¸å†…æ ¸åœ¨è¿›ç¨‹è¡¨ä¸­å­˜æ”¾çš„ä¿¡æ¯å®Œå…¨ä¸€æ ·ã€‚</p><p>ä¼˜åŠ¿ï¼š</p><ul><li><p>ä¿å­˜çº¿ç¨‹çš„çŠ¶æ€å’Œè°ƒåº¦ç¨‹åºéƒ½æ˜¯<code>æœ¬åœ°è¿‡ç¨‹</code>ï¼Œæ‰€ä»¥å¯åŠ¨ä»–ä»¬æ¯”è¿›è¡Œå†…æ ¸è°ƒç”¨æ•ˆç‡æ›´é«˜ã€‚å› è€Œ<strong>ä¸éœ€è¦åˆ‡æ¢åˆ°å†…æ ¸ï¼Œä¹Ÿå°±ä¸éœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¹Ÿä¸éœ€è¦å¯¹å†…å­˜é«˜é€Ÿç¼“å­˜è¿›è¡Œåˆ·æ–°ï¼Œå› ä¸ºçº¿ç¨‹è°ƒåº¦éå¸¸ä¾¿æ·ï¼Œå› æ­¤æ•ˆç‡æ¯”è¾ƒé«˜ã€‚</strong></p></li><li><p>å…è®¸æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±å®šåˆ¶çš„è°ƒåº¦ç®—æ³•ã€‚</p></li></ul><h3 id="2-åœ¨å†…æ ¸ç©ºé—´ä¸­å®ç°çº¿ç¨‹"><a class="markdownIt-Anchor" href="#2-åœ¨å†…æ ¸ç©ºé—´ä¸­å®ç°çº¿ç¨‹"></a> 2. åœ¨å†…æ ¸ç©ºé—´ä¸­å®ç°çº¿ç¨‹</h3><p>ä½¿ç”¨å†…æ ¸æ¥å®ç°çº¿ç¨‹çš„æƒ…å†µï¼Œ<strong>ä¸å†éœ€è¦è¿è¡Œæ—¶ç¯å¢ƒ</strong>ï¼Œ<strong>æ¯ä¸ªè¿›ç¨‹ä¸­ä¹Ÿæ²¡æœ‰çº¿ç¨‹è¡¨</strong>ã€‚ç›¸åï¼Œåœ¨å†…æ ¸ä¸­ä¼šæœ‰ç”¨æ¥è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰çº¿ç¨‹çš„çº¿ç¨‹è¡¨ã€‚å½“æŸä¸ªçº¿ç¨‹å¸Œæœ›åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æˆ–æ’¤é”€ä¸€ä¸ªå·²æœ‰çº¿ç¨‹æ—¶ï¼Œå®ƒä¼šè¿›è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨é€šè¿‡å¯¹çº¿ç¨‹è¡¨çš„æ›´æ–°æ¥å®Œæˆçº¿ç¨‹åˆ›å»ºæˆ–é”€æ¯å·¥ä½œã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921161156.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰€æœ‰èƒ½å¤Ÿé˜»å¡çš„è°ƒç”¨éƒ½ä¼šé€šè¿‡<strong>ç³»ç»Ÿè°ƒç”¨</strong>çš„æ–¹å¼æ¥å®ç°ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹é˜»å¡æ—¶ï¼Œå†…æ ¸å¯ä»¥è¿›è¡Œé€‰æ‹©ï¼Œæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆå¦‚æœæœ‰å°±ç»ªçº¿ç¨‹çš„è¯ï¼‰è¿˜æ˜¯è¿è¡Œä¸€ä¸ªå¦ä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹ã€‚ä½†æ˜¯åœ¨ç”¨æˆ·å®ç°ä¸­ï¼Œè¿è¡Œæ—¶ç³»ç»Ÿå§‹ç»ˆè¿è¡Œè‡ªå·±çš„çº¿ç¨‹ï¼Œç›´åˆ°å†…æ ¸å‰¥å¤ºå®ƒçš„ <code>CPU</code> æ—¶é—´ç‰‡ï¼ˆæˆ–è€…æ²¡æœ‰å¯è¿è¡Œçš„çº¿ç¨‹å­˜åœ¨äº†ï¼‰ä¸ºæ­¢ã€‚</p><p>ç”±äºåœ¨å†…æ ¸ä¸­åˆ›å»ºæˆ–è€…é”€æ¯çº¿ç¨‹çš„å¼€é”€æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æŸäº›ç³»ç»Ÿä¼šé‡‡ç”¨<strong>å¯å¾ªç¯åˆ©ç”¨</strong>çš„æ–¹å¼æ¥å›æ”¶çº¿ç¨‹ã€‚<br />å½“æŸä¸ªçº¿ç¨‹è¢«é”€æ¯æ—¶ï¼Œå°±æŠŠå®ƒæ ‡å¿—ä¸ºä¸å¯è¿è¡Œçš„çŠ¶æ€ï¼Œä½†æ˜¯å…¶å†…éƒ¨ç»“æ„æ²¡æœ‰å—åˆ°å½±å“ã€‚ç¨åï¼Œåœ¨å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ—¶ï¼Œå°±ä¼šé‡æ–°å¯ç”¨æ—§çº¿ç¨‹ï¼ŒæŠŠå®ƒæ ‡å¿—ä¸ºå¯ç”¨çŠ¶æ€ã€‚</p><h3 id="3-åœ¨ç”¨æˆ·å’Œå†…æ ¸ç©ºé—´ä¸­æ··åˆå®ç°çº¿ç¨‹"><a class="markdownIt-Anchor" href="#3-åœ¨ç”¨æˆ·å’Œå†…æ ¸ç©ºé—´ä¸­æ··åˆå®ç°çº¿ç¨‹"></a> 3. åœ¨ç”¨æˆ·å’Œå†…æ ¸ç©ºé—´ä¸­æ··åˆå®ç°çº¿ç¨‹</h3><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921161507.png" srcset="/img/loading.gif" alt="" /></p><p>åœ¨è¿™ç§æ¨¡å‹ä¸­ï¼Œ<strong>ç¼–ç¨‹äººå‘˜å¯ä»¥è‡ªç”±æ§åˆ¶ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹çš„æ•°é‡</strong>ï¼Œå…·æœ‰å¾ˆå¤§çš„çµæ´»åº¦ã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œå†…æ ¸åªè¯†åˆ«å†…æ ¸çº§çº¿ç¨‹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè°ƒåº¦ã€‚å…¶ä¸­ä¸€äº›å†…æ ¸çº§çº¿ç¨‹ä¼šè¢«å¤šä¸ªç”¨æˆ·çº§çº¿ç¨‹<strong>å¤šè·¯å¤ç”¨</strong>ã€‚</p><h1 id="è¿›ç¨‹é—´é€šä¿¡"><a class="markdownIt-Anchor" href="#è¿›ç¨‹é—´é€šä¿¡"></a> è¿›ç¨‹é—´é€šä¿¡</h1><h2 id="ç«æ€æ¡ä»¶"><a class="markdownIt-Anchor" href="#ç«æ€æ¡ä»¶"></a> ç«æ€æ¡ä»¶</h2><p>åœ¨ä¸€äº›æ“ä½œç³»ç»Ÿä¸­ï¼Œåä½œçš„è¿›ç¨‹å¯èƒ½å…±äº«ä¸€äº›å½¼æ­¤éƒ½èƒ½è¯»å†™çš„å…¬å…±èµ„æºã€‚å…¬å…±èµ„æºå¯èƒ½åœ¨å†…å­˜ä¸­ä¹Ÿå¯èƒ½åœ¨ä¸€ä¸ªå…±äº«æ–‡ä»¶ã€‚<br />ä¸ºäº†è®²æ¸…æ¥šè¿›ç¨‹é—´æ˜¯å¦‚ä½•é€šä¿¡çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼šä¸€ä¸ªåå°æ‰“å°ç¨‹åºã€‚å½“ä¸€ä¸ªè¿›ç¨‹éœ€è¦æ‰“å°æŸä¸ªæ–‡ä»¶æ—¶ï¼Œå®ƒä¼šå°†æ–‡ä»¶åæ”¾åœ¨ä¸€ä¸ªç‰¹æ®Šçš„ <code>åå°ç›®å½•(spooler directory)</code> ä¸­ã€‚å¦ä¸€ä¸ªè¿›ç¨‹ <code>æ‰“å°åå°è¿›ç¨‹(printer daemon)</code> ä¼šå®šæœŸçš„æ£€æŸ¥æ˜¯å¦éœ€è¦æ–‡ä»¶è¢«æ‰“å°ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±æ‰“å°å¹¶å°†è¯¥æ–‡ä»¶åä»ç›®å½•ä¸‹åˆ é™¤ã€‚</p><p>å‡è®¾æˆ‘ä»¬çš„åå°ç›®å½•æœ‰éå¸¸å¤šçš„ <code>æ§½ä½(slot)</code>ï¼Œç¼–å·ä¾æ¬¡ä¸º 0ï¼Œ1ï¼Œ2ï¼Œâ€¦ï¼Œæ¯ä¸ªæ§½ä½å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶åã€‚åŒæ—¶å‡è®¾æœ‰ä¸¤ä¸ªå…±äº«å˜é‡ï¼š<code>out</code>ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªéœ€è¦æ‰“å°çš„æ–‡ä»¶ï¼›<code>in</code>ï¼ŒæŒ‡å‘ç›®å½•ä¸­ä¸‹ä¸ªç©ºé—²çš„æ§½ä½ã€‚å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶ä¿å­˜åœ¨ä¸€ä¸ªæ‰€æœ‰è¿›ç¨‹éƒ½èƒ½è®¿é—®çš„æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶çš„é•¿åº¦ä¸ºä¸¤ä¸ªå­—ã€‚åœ¨æŸä¸€æ—¶åˆ»ï¼Œ0 è‡³ 3 å·æ§½ä½ç©ºï¼Œ4 å·è‡³ 6 å·æ§½ä½è¢«å ç”¨ã€‚åœ¨åŒä¸€æ—¶åˆ»ï¼Œè¿›ç¨‹ A å’Œ è¿›ç¨‹ B éƒ½å†³å®šå°†ä¸€ä¸ªæ–‡ä»¶æ’é˜Ÿæ‰“å°ï¼Œæƒ…å†µå¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200921163828.webp" srcset="/img/loading.gif" alt="" /></p><p>åœ¨æŸä¸€æ—¶åˆ»ä¸¤ä¸ªè¿›ç¨‹éƒ½è®¤ä¸ºä¸‹ä¸€ä¸ªå¯ç”¨æ§½ä½æ˜¯ 7ã€‚<br />è¿›ç¨‹ B ä¼šå°†æ‰“å°æ–‡ä»¶åå†™å…¥åˆ° slot 7 ä¸­ï¼Œç„¶åæŠŠ in çš„æŒ‡é’ˆæ›´æ”¹ä¸º 8 ï¼Œç„¶åè¿›ç¨‹ B ç¦»å¼€å»åšå…¶ä»–çš„äº‹æƒ…ã€‚<br />è¿›ç¨‹ A ä¹Ÿå‘ç° slot 7 çš„æ§½ä½æ˜¯ç©ºçš„ï¼Œäºæ˜¯å°†æ‰“å°æ–‡ä»¶åå­˜å…¥ slot 7 ä¸­ï¼Œç„¶åæŠŠ in çš„å€¼æ›´æ–°ä¸º 8ï¼Œç”±äº slot 7 è¿™ä¸ªæ§½ä½ä¸­å·²ç»æœ‰è¿›ç¨‹ B å†™å…¥çš„å€¼ï¼Œæ‰€ä»¥è¿›ç¨‹ A çš„æ‰“å°æ–‡ä»¶åä¼šæŠŠè¿›ç¨‹ B çš„æ–‡ä»¶è¦†ç›–ï¼Œç”±äºæ‰“å°æœºå†…éƒ¨æ˜¯æ— æ³•å‘ç°æ˜¯å“ªä¸ªè¿›ç¨‹æ›´æ–°çš„ï¼Œå®ƒçš„åŠŸèƒ½æ¯”è¾ƒå±€é™ï¼Œæ‰€ä»¥è¿™æ—¶å€™è¿›ç¨‹ B æ°¸è¿œæ— æ³•æ‰“å°è¾“å‡ºï¼Œç±»ä¼¼è¿™ç§æƒ…å†µï¼Œå³<strong>ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸€å…±äº«æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œå½±å“ç¨‹åºè¿è¡Œçš„æ­£ç¡®æ€§æ—¶</strong>ï¼Œè¿™ç§å°±è¢«ç§°ä¸º <code>ç«æ€æ¡ä»¶(race condition)</code>ã€‚</p><h2 id="ä¸´ç•ŒåŒº"><a class="markdownIt-Anchor" href="#ä¸´ç•ŒåŒº"></a> ä¸´ç•ŒåŒº</h2><p>ä¸ä»…å…±äº«èµ„æºä¼šé€ æˆç«æ€æ¡ä»¶ï¼Œäº‹å®ä¸Šå…±äº«æ–‡ä»¶ã€å…±äº«å†…å­˜ä¹Ÿä¼šé€ æˆç«æ€æ¡ä»¶ã€é‚£ä¹ˆè¯¥å¦‚ä½•é¿å…å‘¢ï¼Ÿæˆ–è®¸ä¸€å¥è¯å¯ä»¥æ¦‚æ‹¬è¯´æ˜ï¼š<strong>ç¦æ­¢ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹åœ¨åŒä¸€æ—¶åˆ»å¯¹å…±äº«èµ„æºï¼ˆåŒ…æ‹¬å…±äº«å†…å­˜ã€å…±äº«æ–‡ä»¶ç­‰ï¼‰è¿›è¡Œè¯»å†™</strong>ã€‚<br />æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§ <code>äº’æ–¥(mutual exclusion)</code> æ¡ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨æŸç§æ–¹å¼ä¸‹ä½¿ç”¨å…±äº«å˜é‡å’Œæ–‡ä»¶çš„è¯ï¼Œé™¤è¯¥è¿›ç¨‹ä¹‹å¤–çš„å…¶ä»–è¿›ç¨‹å°±ç¦æ­¢åšè¿™ç§äº‹ï¼ˆè®¿é—®ç»Ÿä¸€èµ„æºï¼‰ã€‚</p><p>é¿å…ç«äº‰é—®é¢˜çš„æ¡ä»¶å¯ä»¥ç”¨ä¸€ç§æŠ½è±¡çš„æ–¹å¼å»æè¿°ã€‚å¤§éƒ¨åˆ†æ—¶é—´ï¼Œè¿›ç¨‹éƒ½ä¼šå¿™äºå†…éƒ¨è®¡ç®—å’Œå…¶ä»–ä¸ä¼šå¯¼è‡´ç«äº‰æ¡ä»¶çš„è®¡ç®—ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™è¿›ç¨‹ä¼šè®¿é—®å…±äº«å†…å­˜æˆ–æ–‡ä»¶ï¼Œæˆ–è€…åšä¸€äº›èƒ½å¤Ÿå¯¼è‡´ç«æ€æ¡ä»¶çš„æ“ä½œã€‚æˆ‘ä»¬æŠŠ<strong>å¯¹å…±äº«å†…å­˜è¿›è¡Œè®¿é—®çš„ç¨‹åºç‰‡æ®µ</strong>ç§°ä½œ <code>ä¸´ç•ŒåŒºåŸŸ(critical region)</code> æˆ– <code>ä¸´ç•ŒåŒº(critical section)</code>ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ­£ç¡®çš„æ“ä½œï¼Œä½¿ä¸¤ä¸ªä¸åŒè¿›ç¨‹ä¸å¯èƒ½åŒæ—¶å¤„äºä¸´ç•ŒåŒºï¼Œå°±èƒ½é¿å…ç«äº‰æ¡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯ä»æ“ä½œç³»ç»Ÿè®¾è®¡è§’åº¦æ¥è¿›è¡Œçš„ã€‚</p><p>å°½ç®¡ä¸Šé¢è¿™ç§è®¾è®¡é¿å…äº†ç«äº‰æ¡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ç¡®ä¿å¹¶å‘çº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«æ•°æ®çš„æ­£ç¡®æ€§å’Œé«˜æ•ˆæ€§ã€‚ä¸€ä¸ªå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œåº”è¯¥åŒ…å«ä¸‹é¢å››ç§æ¡ä»¶</p><ol><li>ä»»ä½•æ—¶å€™ä¸¤ä¸ªè¿›ç¨‹ä¸èƒ½åŒæ—¶å¤„äºä¸´ç•ŒåŒº</li><li>ä¸åº”å¯¹ CPU çš„é€Ÿåº¦å’Œæ•°é‡åšä»»ä½•å‡è®¾</li><li>ä½äºä¸´ç•ŒåŒºå¤–çš„è¿›ç¨‹ä¸å¾—é˜»å¡å…¶ä»–è¿›ç¨‹</li><li>ä¸èƒ½ä½¿ä»»ä½•è¿›ç¨‹æ— é™ç­‰å¾…è¿›å…¥ä¸´ç•ŒåŒº</li></ol><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200922124159.png" srcset="/img/loading.gif" alt="" /></p><p>ä»æŠ½è±¡çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›è¿›ç¨‹çš„è¡Œä¸ºå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ t1 æ—¶åˆ»ï¼Œè¿›ç¨‹ A è¿›å…¥ä¸´ç•ŒåŒºï¼Œåœ¨ t2 çš„æ—¶åˆ»ï¼Œè¿›ç¨‹ B å°è¯•è¿›å…¥ä¸´ç•ŒåŒºï¼Œå› ä¸ºæ­¤æ—¶è¿›ç¨‹ A æ­£åœ¨å¤„äºä¸´ç•ŒåŒºä¸­ï¼Œæ‰€ä»¥è¿›ç¨‹ B ä¼šé˜»å¡ç›´åˆ° t3 æ—¶åˆ»è¿›ç¨‹ A ç¦»å¼€ä¸´ç•ŒåŒºï¼Œæ­¤æ—¶è¿›ç¨‹ B èƒ½å¤Ÿå…è®¸è¿›å…¥ä¸´ç•ŒåŒºã€‚æœ€åï¼Œåœ¨ t4 æ—¶åˆ»ï¼Œè¿›ç¨‹ B ç¦»å¼€ä¸´ç•ŒåŒºï¼Œç³»ç»Ÿæ¢å¤åˆ°æ²¡æœ‰è¿›ç¨‹çš„åŸå§‹çŠ¶æ€ã€‚</p><h2 id="å¿™ç­‰äº’æ–¥"><a class="markdownIt-Anchor" href="#å¿™ç­‰äº’æ–¥"></a> å¿™ç­‰äº’æ–¥</h2><p>åœ¨å®ç°äº’æ–¥çš„å„ç§æ–¹æ¡ˆä¸­ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹æ­£å¿™äºæ›´æ–°å…¶ä¸´ç•ŒåŒºçš„å…±äº«å†…å­˜æ—¶ï¼Œæ²¡æœ‰å…¶ä»–è¿›ç¨‹ä¼šè¿›å…¥å…¶ä¸´ç•ŒåŒºï¼Œä¹Ÿä¸ä¼šé€ æˆå½±å“ã€‚</p><h3 id="1-å±è”½ä¸­æ–­"><a class="markdownIt-Anchor" href="#1-å±è”½ä¸­æ–­"></a> 1. å±è”½ä¸­æ–­</h3><p>åœ¨<code>å•å¤„ç†å™¨</code>ç³»ç»Ÿä¸Šï¼Œæœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯<strong>è®©æ¯ä¸ªè¿›ç¨‹åœ¨è¿›å…¥ä¸´ç•ŒåŒºåç«‹å³å±è”½æ‰€æœ‰ä¸­æ–­</strong>ï¼Œå¹¶<strong>åœ¨ç¦»å¼€ä¸´ç•ŒåŒºä¹‹å‰é‡æ–°å¯ç”¨å®ƒä»¬</strong>ã€‚å±è”½ä¸­æ–­åï¼Œæ—¶é’Ÿä¸­æ–­ä¹Ÿä¼šè¢«å±è”½ã€‚<code>CPU</code> åªæœ‰å‘ç”Ÿæ—¶é’Ÿä¸­æ–­æˆ–å…¶ä»–ä¸­æ–­æ—¶æ‰ä¼šè¿›è¡Œè¿›ç¨‹åˆ‡æ¢ã€‚è¿™æ ·ï¼Œåœ¨å±è”½ä¸­æ–­å <code>CPU</code> ä¸ä¼šåˆ‡æ¢åˆ°å…¶ä»–è¿›ç¨‹ã€‚<br />æ‰€ä»¥ï¼Œä¸€æ—¦æŸä¸ªè¿›ç¨‹å±è”½ä¸­æ–­ä¹‹åï¼Œå®ƒå°±å¯ä»¥æ£€æŸ¥å’Œä¿®æ”¹å…±äº«å†…å­˜ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå…¶ä»–è¿›ç¨‹ä»‹å…¥è®¿é—®å…±äº«æ•°æ®ã€‚</p><p>ç¼ºç‚¹ï¼š</p><ul><li>å¦‚æœç»è¿‡ä¸€æ®µè¾ƒé•¿æ—¶é—´åè¿›ç¨‹æ²¡æœ‰ç¦»å¼€ï¼Œä¸­æ–­ä¸€ç›´æ— æ³•å¯ç”¨ï¼Œå¯èƒ½ä¼šé€ æˆæ•´ä¸ªç³»ç»Ÿçš„ç»ˆæ­¢ã€‚</li><li>å¦‚æœæ˜¯<code>å¤šå¤„ç†å™¨</code>ç³»ç»Ÿï¼Œ<strong>å±è”½ä¸­æ–­ä»…ä»…å¯¹æ‰§è¡Œ <code>disable</code> æŒ‡ä»¤çš„ <code>CPU</code> æœ‰æ•ˆ</strong>ã€‚å…¶ä»– <code>CPU</code> ä»å°†ç»§ç»­è¿è¡Œï¼Œå¹¶å¯ä»¥è®¿é—®å…±äº«å†…å­˜ã€‚</li></ul><h3 id="2-é”å˜é‡"><a class="markdownIt-Anchor" href="#2-é”å˜é‡"></a> 2. é”å˜é‡</h3><p>è€ƒè™‘æœ‰å•ä¸ªå…±äº«çš„ï¼ˆé”ï¼‰å˜é‡ï¼Œåˆå§‹ä¸ºå€¼ä¸º 0 ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œå®ƒé¦–å…ˆä¼šæŸ¥çœ‹é”çš„å€¼æ˜¯å¦ä¸º 0 ï¼Œå¦‚æœé”çš„å€¼æ˜¯ 0 ï¼Œè¿›ç¨‹ä¼šæŠŠå®ƒè®¾ç½®ä¸º 1 å¹¶è®©è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœé”çš„çŠ¶æ€æ˜¯ 1ï¼Œè¿›ç¨‹ä¼šç­‰å¾…ç›´åˆ°é”å˜é‡çš„å€¼å˜ä¸º 0ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200922130139.png" srcset="/img/loading.gif" alt="" /><br />æ­¤æ—¶å‡è®¾ä¸€ä¸ªè¿›ç¨‹è¯»å‡ºé”å˜é‡çš„å€¼å¹¶å‘ç°å®ƒä¸º 0 ï¼Œè€Œæ°å¥½åœ¨å®ƒå°†å…¶è®¾ç½®ä¸º 1 ä¹‹å‰ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹è°ƒåº¦è¿è¡Œï¼Œè¯»å‡ºé”çš„å˜é‡ä¸º0 ï¼Œå¹¶å°†é”çš„å˜é‡è®¾ç½®ä¸º 1 ã€‚ç„¶åç¬¬ä¸€ä¸ªçº¿ç¨‹è¿è¡Œï¼ŒæŠŠé”å˜é‡çš„å€¼å†æ¬¡è®¾ç½®ä¸º 1ï¼Œæ­¤æ—¶ï¼Œä¸´ç•ŒåŒºåŸŸå°±ä¼šæœ‰ä¸¤ä¸ªè¿›ç¨‹åœ¨åŒæ—¶è¿è¡Œã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200922130639.png" srcset="/img/loading.gif" alt="" /></p><h3 id="3-ä¸¥æ ¼è½®è¯¢æ³•"><a class="markdownIt-Anchor" href="#3-ä¸¥æ ¼è½®è¯¢æ³•"></a> 3. ä¸¥æ ¼è½®è¯¢æ³•</h3><p>è¿›ç¨‹ 0ï¼šå½“ <code>turn == 0</code> è¿›å…¥ä¸´ç•ŒåŒº</p><pre><code class="hljs c"><span class="hljs-keyword">while</span>(TRUE)&#123;  <span class="hljs-keyword">while</span>(<span class="hljs-built_in">turn</span> == <span class="hljs-number">0</span>)&#123;    <span class="hljs-comment">/* è¿›å…¥ä¸´ç•ŒåŒº */</span>    critical_region();    <span class="hljs-built_in">turn</span> = <span class="hljs-number">1</span>;    <span class="hljs-comment">/* ç¦»å¼€ä¸´ç•ŒåŒº */</span>    noncritical_region();  &#125;&#125;</code></pre><p>è¿›ç¨‹ 1ï¼šå½“ <code>turn == 1</code> è¿›å…¥ä¸´ç•ŒåŒº</p><pre><code class="hljs c"><span class="hljs-keyword">while</span>(TRUE)&#123;  <span class="hljs-keyword">while</span>(<span class="hljs-built_in">turn</span> == <span class="hljs-number">1</span>)&#123;    <span class="hljs-comment">/* è¿›å…¥ä¸´ç•ŒåŒº */</span>    critical_region();    <span class="hljs-built_in">turn</span> = <span class="hljs-number">0</span>;    <span class="hljs-comment">/* ç¦»å¼€ä¸´ç•ŒåŒº */</span>    noncritical_region();  &#125;&#125;</code></pre><p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ <code>turn</code>ï¼Œåˆå§‹å€¼ä¸º <code>0</code> ï¼Œç”¨äºè®°å½•è½®åˆ°é‚£ä¸ªè¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œå¹¶æ£€æŸ¥æˆ–æ›´æ–°å…±äº«å†…å­˜ã€‚å¼€å§‹æ—¶ï¼Œ<code>è¿›ç¨‹ 0</code> æ£€æŸ¥ <code>turn</code>ï¼Œå‘ç°å…¶å€¼ä¸º <code>0</code>ï¼Œäºæ˜¯è¿›å…¥ä¸´ç•ŒåŒºã€‚<code>è¿›ç¨‹ 1</code> ä¹Ÿå‘ç°å…¶å€¼ä¸º <code>0</code> ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªç­‰å¾…å¾ªç¯ä¸­ä¸åœçš„æµ‹è¯• <code>turn</code>ï¼Œçœ‹å…¶å€¼ä½•æ—¶å˜ä¸º <code>1</code>ã€‚</p><blockquote><p>è¿ç»­æ£€æŸ¥ä¸€ä¸ªå˜é‡ç›´åˆ°æŸä¸ªå€¼å‡ºç°ä¸ºæ­¢ï¼Œè¿™ç§æ–¹æ³•ç§°ä¸º <code>å¿™ç­‰å¾…(busywaiting)</code>ã€‚ç”¨äºå¿™ç­‰å¾…çš„é”ï¼Œç§°ä¸º <code>è‡ªæ—‹é”(spinlock)</code>ã€‚<br />ç”±äºè¿™ç§æ–¹å¼<strong>æµªè´¹ <code>CPU</code> æ—¶é—´</strong>ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼é€šå¸¸åº”è¯¥è¦é¿å…ã€‚åªæœ‰åœ¨æœ‰ç†ç”±è®¤ä¸º<strong>ç­‰å¾…æ—¶é—´æ˜¯éå¸¸çŸ­çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤Ÿä½¿ç”¨å¿™ç­‰å¾…</strong>ã€‚</p></blockquote><p>å½“ <code>è¿›ç¨‹ 0</code> å’Œ <code>è¿›ç¨‹ 1</code> éƒ½åœ¨éä¸´ç•ŒåŒºæ—¶ï¼Œæ­¤æ—¶ <code>è¿›ç¨‹ 0</code> ç»“æŸäº†éä¸´ç•ŒåŒºçš„æ“ä½œå¹¶è¿”å›åˆ°å¾ªç¯çš„å¼€å§‹ã€‚ä½†æ˜¯ï¼Œè¿™æ—¶å®ƒä¸èƒ½è¿›å…¥ä¸´ç•ŒåŒºï¼Œå› ä¸º <code>turn == 1</code>ï¼Œæ­¤æ—¶ <code>è¿›ç¨‹ 1</code> è¿˜å¿™äºéä¸´ç•ŒåŒºçš„æ“ä½œï¼Œ<code>è¿›ç¨‹ 0</code> åªèƒ½ç»§ç»­é˜»å¡ï¼Œç›´åˆ°<code>è¿›ç¨‹ 1</code> æŠŠ <code>turn</code> çš„å€¼æ”¹ä¸º <code>0</code>ã€‚è¿™è¯´æ˜ï¼Œåœ¨<strong>ä¸€ä¸ªè¿›ç¨‹æ¯”å¦ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œé€Ÿåº¦æ…¢äº†å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œè½®æµè¿›å…¥ä¸´ç•ŒåŒºå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ³•ã€‚</strong></p><p>è¿™ç§æƒ…å†µè¿åäº†å‰é¢çš„å™è¿° 3 ï¼Œå³ <strong>ä½äºä¸´ç•ŒåŒºå¤–çš„è¿›ç¨‹ä¸å¾—é˜»å¡å…¶ä»–è¿›ç¨‹</strong>ï¼Œ<code>è¿›ç¨‹ 0</code> è¢«ä¸´ç•ŒåŒºå¤–çš„ <code>è¿›ç¨‹ 1</code> é˜»å¡ã€‚ç”±äºè¿åäº†ç¬¬ä¸‰æ¡ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½ä½œä¸ºä¸€ä¸ªå¥½çš„æ–¹æ¡ˆã€‚</p><h3 id="4-peterson-è§£æ³•"><a class="markdownIt-Anchor" href="#4-peterson-è§£æ³•"></a> 4. Peterson è§£æ³•</h3><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FALSE 0</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TRUE  1</span><span class="hljs-comment">/* è¿›ç¨‹æ•°é‡ */</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N     2</span><span class="hljs-comment">/* ç°åœ¨è½®åˆ°è° */</span><span class="hljs-keyword">int</span> <span class="hljs-built_in">turn</span>;<span class="hljs-comment">/* æ‰€æœ‰å€¼åˆå§‹åŒ–ä¸º 0 (FALSE) */</span><span class="hljs-keyword">int</span> interested[N];<span class="hljs-comment">/* è¿›ç¨‹æ˜¯ 0 æˆ– 1 */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">enter_region</span><span class="hljs-params">(<span class="hljs-keyword">int</span> <span class="hljs-built_in">process</span>)</span></span>&#123;    <span class="hljs-comment">/* å¦ä¸€ä¸ªè¿›ç¨‹å· */</span>  <span class="hljs-keyword">int</span> other;    <span class="hljs-comment">/* å¦ä¸€ä¸ªè¿›ç¨‹ */</span>  other = <span class="hljs-number">1</span> - <span class="hljs-built_in">process</span>;    <span class="hljs-comment">/* è¡¨ç¤ºæ„¿æ„è¿›å…¥ä¸´ç•ŒåŒº */</span>  interested[<span class="hljs-built_in">process</span>] = TRUE;  <span class="hljs-built_in">turn</span> = <span class="hljs-built_in">process</span>;    <span class="hljs-comment">/* é˜»å¡ */</span>  <span class="hljs-keyword">while</span>(<span class="hljs-built_in">turn</span> == <span class="hljs-built_in">process</span>         &amp;&amp; interested[other] == <span class="hljs-literal">true</span>)&#123;&#125;   &#125;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">leave_region</span><span class="hljs-params">(<span class="hljs-keyword">int</span> <span class="hljs-built_in">process</span>)</span></span>&#123;    <span class="hljs-comment">/* è¡¨ç¤ºç¦»å¼€ä¸´ç•ŒåŒº */</span>  interested[<span class="hljs-built_in">process</span>] == FALSE; &#125;</code></pre><p>åœ¨ä½¿ç”¨å…±äº«å˜é‡æ—¶ï¼ˆå³è¿›å…¥å…¶ä¸´ç•ŒåŒºï¼‰ä¹‹å‰ï¼Œå„ä¸ªè¿›ç¨‹ä½¿ç”¨å„è‡ªçš„è¿›ç¨‹å· <code>0</code> æˆ– <code>1</code> ä½œä¸ºå‚æ•°æ¥è°ƒç”¨ <code>enter_region</code>ï¼Œè¿™ä¸ªå‡½æ•°è°ƒç”¨åœ¨éœ€è¦æ—¶å°†ä½¿è¿›ç¨‹ç­‰å¾…ï¼Œç›´åˆ°èƒ½å¤Ÿå®‰å…¨çš„ä¸´ç•ŒåŒºã€‚åœ¨å®Œæˆå¯¹å…±äº«å˜é‡çš„æ“ä½œä¹‹åï¼Œè¿›ç¨‹å°†è°ƒç”¨ <code>leave_region</code> è¡¨ç¤ºæ“ä½œå®Œæˆï¼Œå¹¶ä¸”å…è®¸å…¶ä»–è¿›ç¨‹è¿›å…¥ã€‚</p><p>è€ƒè™‘ä¸€ç§ä¸¤ä¸ªè¿›ç¨‹åŒæ—¶è°ƒç”¨ <code>enter_region</code> çš„æƒ…å†µã€‚å®ƒä»¬éƒ½å°†è‡ªå·±çš„è¿›ç¨‹å­˜å…¥ <code>turn</code>ï¼Œä½†åªæœ‰æœ€åä¿å­˜è¿›å»çš„è¿›ç¨‹å·æ‰æœ‰æ•ˆï¼Œå‰ä¸€ä¸ªè¿›ç¨‹çš„è¿›ç¨‹å·å› ä¸ºé‡å†™è€Œä¸¢å¤±ã€‚å‡å¦‚ <code>è¿›ç¨‹ 1</code> æ˜¯æœ€åå­˜å…¥çš„ï¼Œåˆ™ <code>turn = 1</code> ã€‚å½“ä¸¤ä¸ªè¿›ç¨‹éƒ½è¿è¡Œåˆ° <code>while</code> çš„æ—¶å€™ï¼Œ<code>è¿›ç¨‹ 0</code> å°†ä¸ä¼šå¾ªç¯å¹¶è¿›å…¥ä¸´ç•ŒåŒºï¼Œè€Œ <code>è¿›ç¨‹ 1</code> å°†ä¼šæ— é™å¾ªç¯ä¸”ä¸ä¼šè¿›å…¥ä¸´ç•ŒåŒºï¼Œç›´åˆ° <code>è¿›ç¨‹ 0</code> é€€å‡ºä¸´ç•ŒåŒºä¸ºæ­¢ã€‚</p><h3 id="5-tsl-æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#5-tsl-æŒ‡ä»¤"></a> 5. <code>TSL</code> æŒ‡ä»¤</h3><p>ä¸€äº›è®¡ç®—æœºï¼Œç‰¹åˆ«æ˜¯é‚£äº›è®¾è®¡ä¸ºå¤šå¤„ç†å™¨çš„è®¡ç®—æœºï¼Œéƒ½ä¼šæœ‰ä¸‹é¢è¿™æ¡æŒ‡ä»¤</p><pre><code class="hljs cos">TSL RX,<span class="hljs-keyword">LOCK</span></code></pre><p>ç§°ä¸º <code>æµ‹è¯•å¹¶åŠ é”(test and set lock)</code>ï¼Œå®ƒå°†ä¸€ä¸ªå†…å­˜å­— <code>lock</code> è¯»åˆ°å¯„å­˜å™¨ <code>RX</code> ä¸­ï¼Œç„¶ååœ¨è¯¥å†…å­˜åœ°å€ä¸Šå­˜å‚¨ä¸€ä¸ªéé›¶å€¼ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹æ˜¯ä¸€æ¡åŸè¯­ã€‚åœ¨è¿™ä¸ªæŒ‡ä»¤ç»“æŸä¹‹å‰å…¶ä»–å¤„ç†å™¨å‡ä¸å…è®¸è®¿é—®å†…å­˜ã€‚æ‰§è¡Œ <code>TSL</code> æŒ‡ä»¤çš„ <code>CPU</code> å°†ä¼šé”ä½å†…å­˜æ€»çº¿ï¼Œç”¨æ¥ç¦æ­¢å…¶ä»– <code>CPU</code> åœ¨è¿™ä¸ªæŒ‡ä»¤ç»“æŸä¹‹å‰è®¿é—®å†…å­˜ã€‚</p><p>å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯é”ä½å†…å­˜æ€»çº¿å’Œç¦ç”¨ä¸­æ–­ä¸ä¸€æ ·ã€‚ç¦ç”¨ä¸­æ–­å¹¶ä¸èƒ½ä¿è¯ä¸€ä¸ªå¤„ç†å™¨åœ¨è¯»å†™æ“ä½œä¹‹é—´å¦ä¸€ä¸ªå¤„ç†å™¨å¯¹å†…å­˜çš„è¯»å†™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ <code>å¤„ç†å™¨ 1</code> ä¸Šå±è”½ä¸­æ–­å¯¹ <code>å¤„ç†å™¨ 2</code> æ²¡æœ‰å½±å“ã€‚è®© <code>å¤„ç†å™¨ 2</code> è¿œç¦»å†…å­˜ç›´åˆ° <code>å¤„ç†å™¨ 1</code> å®Œæˆè¯»å†™çš„æœ€å¥½çš„æ–¹å¼å°±æ˜¯<strong>é”ä½æ€»çº¿</strong>ã€‚è¿™éœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„ç¡¬ä»¶ï¼ˆåŸºæœ¬ä¸Šï¼Œä¸€æ ¹æ€»çº¿å°±å¯ä»¥ç¡®ä¿æ€»çº¿ç”±é”ä½å®ƒçš„å¤„ç†å™¨ä½¿ç”¨ï¼Œè€Œå…¶ä»–çš„å¤„ç†å™¨ä¸èƒ½ä½¿ç”¨ï¼‰ã€‚</p><h3 id="6-xchg-æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#6-xchg-æŒ‡ä»¤"></a> 6. <code>XCHG</code> æŒ‡ä»¤</h3><p><code>XCHG</code> æŒ‡ä»¤å¯ä»¥æ›¿æ¢ <code>TSL</code> çš„æŒ‡ä»¤ï¼Œå®ƒåŸå­æ€§çš„äº¤æ¢äº†ä¸¤ä¸ªä½ç½®çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªå¯„å­˜å™¨ä¸ä¸€ä¸ªå†…å­˜å­—ã€‚</p><p><code>XCHG</code> çš„æœ¬è´¨ä¸Šä¸ <code>TSL</code> çš„è§£å†³åŠæ³•ä¸€æ ·ã€‚æ‰€æœ‰çš„ <code>Intel x86</code> <code>CPU</code> åœ¨åº•å±‚åŒæ­¥ä¸­ä½¿ç”¨ <code>XCHG</code> æŒ‡ä»¤ã€‚</p><h2 id="ç¡çœ ä¸å”¤é†’"><a class="markdownIt-Anchor" href="#ç¡çœ ä¸å”¤é†’"></a> ç¡çœ ä¸å”¤é†’</h2><p><code>Peterson</code> ã€<code>TSL</code> å’Œ <code>XCHG</code> è§£æ³•éƒ½æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰<strong>å¿™ç­‰å¾…</strong>çš„ç¼ºç‚¹ã€‚è¿™äº›è§£æ³•çš„æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦èƒ½å¤Ÿè¿›å…¥ä¸´ç•ŒåŒºï¼Œè‹¥ä¸å…è®¸ï¼Œåˆ™è¯¥è¿›ç¨‹å°†åŸåœ°ç­‰å¾…ï¼Œç›´åˆ°å…è®¸ä¸ºæ­¢ã€‚</p><p>è¿™ç§æ–¹å¼ä¸ä½†æµªè´¹äº† <code>CPU</code> æ—¶é—´ï¼Œè€Œä¸”è¿˜å¯èƒ½å¼•èµ·æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚è€ƒè™‘ä¸€å°è®¡ç®—æœºä¸Šæœ‰ä¸¤ä¸ªè¿›ç¨‹ï¼Œè¿™ä¸¤ä¸ªè¿›ç¨‹å…·æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œ<code>H</code> æ˜¯å±äºä¼˜å…ˆçº§æ¯”è¾ƒé«˜çš„è¿›ç¨‹ï¼Œ<code>L</code> æ˜¯å±äºä¼˜å…ˆçº§æ¯”è¾ƒä½çš„è¿›ç¨‹ã€‚è¿›ç¨‹è°ƒåº¦çš„è§„åˆ™æ˜¯<strong>ä¸è®ºä½•æ—¶åªè¦ <code>H è¿›ç¨‹</code> å¤„äºå°±ç»ªæ€ <code>H</code> å°±å¼€å§‹è¿è¡Œ</strong>ã€‚<br />åœ¨æŸä¸€æ—¶åˆ»ï¼Œ<strong><code>L</code> å¤„äºä¸´ç•ŒåŒºä¸­</strong>ï¼Œæ­¤æ—¶ <code>H</code> å˜ä¸ºå°±ç»ªæ€ï¼Œå‡†å¤‡è¿è¡Œï¼ˆä¾‹å¦‚ï¼Œä¸€æ¡ I/O æ“ä½œç»“æŸï¼‰ã€‚ç°åœ¨ <code>H</code> è¦å¼€å§‹å¿™ç­‰ï¼Œä½†ç”±äºå½“ <code>H</code> å°±ç»ªæ—¶ <code>L</code> å°±ä¸ä¼šè¢«è°ƒåº¦ï¼Œ<code>L</code> ä»æ¥ä¸ä¼šæœ‰æœºä¼šç¦»å¼€ä¸´ç•ŒåŒºï¼Œæ‰€ä»¥ <code>H</code> ä¼šå˜æˆ<strong>æ­»å¾ªç¯</strong>ï¼Œæœ‰æ—¶å°†è¿™ç§æƒ…å†µç§°ä¸º <code>ä¼˜å…ˆçº§åè½¬é—®é¢˜(priority inversion problem)</code>ã€‚</p><p>è¿›ç¨‹é—´çš„é€šä¿¡åŸè¯­<strong>åœ¨ä¸å…è®¸å®ƒä»¬è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ä¼šé˜»å¡</strong>è€Œä¸æ˜¯æµªè´¹ <code>CPU</code> æ—¶é—´ï¼Œæœ€ç®€å•çš„æ˜¯ <code>sleep</code> å’Œ <code>wakeup</code>ã€‚</p><ul><li><code>Sleep</code> æ˜¯ä¸€ä¸ªèƒ½å¤Ÿé€ æˆè°ƒç”¨è€…é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨ä¼šæš‚åœç›´åˆ°å…¶ä»–è¿›ç¨‹å”¤é†’å®ƒã€‚</li><li><code>wakeup</code> è°ƒç”¨æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³è¦å”¤é†’çš„è¿›ç¨‹ã€‚</li></ul><p>è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ <code>wakeup</code> å’Œ <code>sleep</code> éƒ½æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³ <code>sleep</code> å’Œ <code>wakeup</code> éœ€è¦åŒ¹é…çš„å†…å­˜åœ°å€ã€‚</p><h3 id="ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"><a class="markdownIt-Anchor" href="#ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"></a> ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</h3><p><code>ç”Ÿäº§è€…-æ¶ˆè´¹è€…(producer-consumer)</code> é—®é¢˜ï¼Œä¹Ÿç§°ä½œ <code>æœ‰ç•Œç¼“å†²åŒº(bounded-buffer)</code> é—®é¢˜ã€‚ä¸¤ä¸ªè¿›ç¨‹å…±äº«ä¸€ä¸ªå…¬å…±çš„å›ºå®šå¤§å°çš„ç¼“å†²åŒºã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯<code>ç”Ÿäº§è€…(producer)</code>ï¼Œå°†ä¿¡æ¯æ”¾å…¥ç¼“å†²åŒºï¼Œ å¦ä¸€ä¸ªæ˜¯<code>æ¶ˆè´¹è€…(consumer)</code>ï¼Œä¼šä»ç¼“å†²åŒºä¸­å–å‡ºã€‚</p><p>å¦‚æœç¼“å†²é˜Ÿåˆ—å·²æ»¡ï¼Œé‚£ä¹ˆå½“ç”Ÿäº§è€…ä»æƒ³è¦å°†æ•°æ®å†™å…¥ç¼“å†²åŒºçš„æ—¶å€™ï¼Œä¼šå‡ºç°é—®é¢˜ã€‚å®ƒçš„è§£å†³åŠæ³•æ˜¯è®©ç”Ÿäº§è€…ç¡çœ ï¼Œä¹Ÿå°±æ˜¯é˜»å¡ç”Ÿäº§è€…ã€‚ç­‰åˆ°æ¶ˆè´¹è€…ä»ç¼“å†²åŒºä¸­å–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®é¡¹æ—¶å†å”¤é†’å®ƒã€‚åŒæ ·çš„ï¼Œå½“æ¶ˆè´¹è€…è¯•å›¾ä»ç¼“å†²åŒºä¸­å–æ•°æ®ï¼Œä½†æ˜¯å‘ç°ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…ä¹Ÿä¼šç¡çœ ï¼Œé˜»å¡ã€‚ç›´åˆ°ç”Ÿäº§è€…å‘å…¶ä¸­æ”¾å…¥ä¸€ä¸ªæ–°çš„æ•°æ®ã€‚</p><pre><code class="hljs c"><span class="hljs-comment">/* ç¼“å†²åŒº slot æ§½çš„æ•°é‡ */</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 100</span><span class="hljs-comment">/* ç¼“å†²åŒºæ•°æ®çš„æ•°é‡ */</span><span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>  <span class="hljs-comment">// ç”Ÿäº§è€…</span><span class="hljs-keyword">void</span> producer(<span class="hljs-keyword">void</span>)&#123;  <span class="hljs-keyword">int</span> item;    <span class="hljs-comment">/* æ— é™å¾ªç¯ */</span>  <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* ç”Ÿæˆä¸‹ä¸€é¡¹æ•°æ® */</span>    item = produce_item()    <span class="hljs-comment">/* å¦‚æœç¼“å­˜åŒºæ˜¯æ»¡çš„ï¼Œå°±ä¼šé˜»å¡ */</span>    <span class="hljs-keyword">if</span>(count == N)&#123;      sleep();    &#125;        <span class="hljs-comment">/* æŠŠå½“å‰æ•°æ®æ”¾åœ¨ç¼“å†²åŒºä¸­ */</span>    insert_item(item);    <span class="hljs-comment">/* å¢åŠ ç¼“å†²åŒº count çš„æ•°é‡ */</span>    count = count + <span class="hljs-number">1</span>;    <span class="hljs-keyword">if</span>(count == <span class="hljs-number">1</span>)&#123;      <span class="hljs-comment">/* ç¼“å†²åŒºæ˜¯å¦ä¸ºç©ºï¼Ÿ */</span>      wakeup(consumer);    &#125;  &#125;&#125;<span class="hljs-comment">// æ¶ˆè´¹è€…</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;    <span class="hljs-keyword">int</span> item;    <span class="hljs-comment">/* æ— é™å¾ªç¯ */</span>  <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* å¦‚æœç¼“å†²åŒºæ˜¯ç©ºçš„ï¼Œå°±ä¼šè¿›è¡Œé˜»å¡ */</span>    <span class="hljs-keyword">if</span>(count == <span class="hljs-number">0</span>)&#123;      sleep();    &#125;    <span class="hljs-comment">/* ä»ç¼“å†²åŒºä¸­å–å‡ºä¸€ä¸ªæ•°æ® */</span>    item = remove_item();    <span class="hljs-comment">/* å°†ç¼“å†²åŒºçš„ count æ•°é‡å‡ä¸€ */</span>    count = count - <span class="hljs-number">1</span>    <span class="hljs-comment">/* ç¼“å†²åŒºæ»¡ï¼Ÿ */</span>    <span class="hljs-keyword">if</span>(count == N - <span class="hljs-number">1</span>)&#123;      wakeup(producer);    &#125;    <span class="hljs-comment">/* æ‰“å°æ•°æ®é¡¹ */</span>    consumer_item(item);  &#125;  &#125;</code></pre><p>ä¸Šé¢ä»£ç ä¸­ä¼šäº§ç”Ÿç«äº‰æ¡ä»¶ã€‚æœ‰å¯èƒ½å‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼šç¼“å†²åŒºä¸ºç©ºï¼Œæ­¤æ—¶æ¶ˆè´¹è€…åˆšå¥½è¯»å– <code>count</code> çš„å€¼å‘ç°å®ƒä¸º <code>0</code>ã€‚æ­¤æ—¶<strong>è°ƒåº¦ç¨‹åºå†³å®šæš‚åœæ¶ˆè´¹è€…</strong>å¹¶å¯åŠ¨è¿è¡Œç”Ÿäº§è€…ã€‚ç”Ÿäº§è€…ç”Ÿäº§äº†ä¸€æ¡æ•°æ®å¹¶æŠŠå®ƒæ”¾åœ¨ç¼“å†²åŒºä¸­ï¼Œç„¶åå¢åŠ  <code>count</code> çš„å€¼ï¼Œ<code>count = 1</code> ã€‚ç”±äº <code>count</code> åˆå§‹ä¸º <code>0</code>ï¼Œæ¶ˆè´¹è€…å¿…é¡»å¤„äºç¡çœ çŠ¶æ€ï¼Œå› æ­¤ç”Ÿäº§è€…è°ƒç”¨ <code>wakeup</code> æ¥å”¤é†’æ¶ˆè´¹è€…ã€‚ä½†æ˜¯ï¼Œæ¶ˆè´¹è€…æ­¤æ—¶åœ¨é€»è¾‘ä¸Šå¹¶æ²¡æœ‰ç¡çœ ï¼Œæ‰€ä»¥ <code>wakeup</code> ä¿¡å·ä¼š<strong>ä¸¢å¤±</strong>ã€‚å½“æ¶ˆè´¹è€…ä¸‹æ¬¡å¯åŠ¨åï¼Œå®ƒä¼šæŸ¥çœ‹ä¹‹å‰è¯»å–çš„ <code>count</code> å€¼ï¼Œå‘ç°å®ƒçš„å€¼æ˜¯ <code>0</code>ï¼Œç„¶ååœ¨æ­¤è¿›è¡Œç¡çœ ã€‚ä¸ä¹…ä¹‹åç”Ÿäº§è€…ä¼šå¡«æ»¡æ•´ä¸ªç¼“å†²åŒºï¼Œåœ¨è¿™ä¹‹åä¼šé˜»å¡ï¼Œè¿™æ ·ä¸€æ¥ä¸¤ä¸ªè¿›ç¨‹å°†æ°¸è¿œç¡çœ ä¸‹å»ã€‚</p><p>å¼•èµ·ä¸Šé¢é—®é¢˜çš„æœ¬è´¨æ˜¯ <strong>å”¤é†’å°šæœªè¿›è¡Œç¡çœ çŠ¶æ€çš„è¿›ç¨‹ä¼šå¯¼è‡´å”¤é†’ä¸¢å¤±</strong>ã€‚å¦‚æœå®ƒæ²¡æœ‰ä¸¢å¤±ï¼Œåˆ™ä¸€åˆ‡éƒ½å¾ˆæ­£å¸¸ã€‚ä¸€ç§å¿«é€Ÿè§£å†³ä¸Šé¢é—®é¢˜çš„æ–¹å¼æ˜¯å¢åŠ ä¸€ä¸ª <code>å”¤é†’ç­‰å¾…ä½(wakeup waiting bit)</code>ã€‚å½“ä¸€ä¸ª <code>wakeup</code> ä¿¡å·å‘é€ç»™ä»åœ¨æ¸…é†’çš„è¿›ç¨‹åï¼Œè¯¥ä½ç½®ä¸º <code>1</code>ã€‚ä¹‹åï¼Œå½“è¿›ç¨‹å°è¯•ç¡çœ çš„æ—¶å€™ï¼Œå¦‚æœå”¤é†’ç­‰å¾…ä½ä¸º <code>1</code>ï¼Œåˆ™è¯¥ä½æ¸…é™¤ï¼Œè€Œè¿›ç¨‹ä»ç„¶ä¿æŒæ¸…é†’ã€‚</p><p>ç„¶è€Œï¼Œå½“è¿›ç¨‹æ•°é‡æœ‰è®¸å¤šçš„æ—¶å€™ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡å¢åŠ å”¤é†’ç­‰å¾…ä½çš„æ•°é‡æ¥å”¤é†’ç­‰å¾…ä½ï¼Œäºæ˜¯å°±æœ‰äº† 2ã€4ã€6ã€8 ä¸ªå”¤é†’ç­‰å¾…ä½ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ã€‚</p><h2 id="ä¿¡å·é‡"><a class="markdownIt-Anchor" href="#ä¿¡å·é‡"></a> ä¿¡å·é‡</h2><p>ä¸€ä¸ªä¿¡å·é‡çš„å–å€¼å¯ä»¥æ˜¯ <code>0</code> ï¼Œæˆ–ä»»æ„æ­£æ•°ã€‚<code>0</code> è¡¨ç¤ºçš„æ˜¯ä¸éœ€è¦ä»»ä½•å”¤é†’ï¼Œä»»æ„çš„æ­£æ•°è¡¨ç¤ºçš„å°±æ˜¯èµ„æºæ•°ç›®ï¼ˆå”¤é†’æ¬¡æ•°ï¼‰ã€‚</p><p>Dijkstra æå‡ºäº†ä¿¡å·é‡æœ‰ä¸¤ä¸ªæ“ä½œï¼Œç°åœ¨é€šå¸¸ä½¿ç”¨ <code>down (P)</code> å’Œ <code>up (V)</code>ï¼ˆåˆ†åˆ«å¯ä»¥ç”¨ <code>sleep</code> å’Œ <code>wakeup</code> æ¥è¡¨ç¤ºï¼‰ã€‚</p><ul><li><code>down</code> æ“ä½œä¼šæ£€æŸ¥å€¼æ˜¯å¦å¤§äº <code>0</code> ã€‚å¦‚æœå¤§äº <code>0</code> ï¼Œåˆ™å°†å…¶å€¼ <code>- 1</code> ï¼›è‹¥è¯¥å€¼ä¸º <code>0</code>ï¼Œåˆ™è¿›ç¨‹å°†ç¡çœ ï¼Œè€Œä¸”æ­¤æ—¶ <code>down</code> æ“ä½œå°†ä¼šç»§ç»­æ‰§è¡Œã€‚</li></ul><p><strong>æ£€æŸ¥æ•°å€¼</strong>ã€<strong>ä¿®æ”¹å˜é‡å€¼</strong>ä»¥åŠå¯èƒ½å‘ç”Ÿçš„<strong>ç¡çœ æ“ä½œ</strong>å‡ä¸ºä¸€ä¸ªå•ä¸€çš„ã€ä¸å¯åˆ†å‰²çš„ <code>åŸå­æ“ä½œ(atomic action)</code> å®Œæˆã€‚è¿™ä¼šä¿è¯ä¸€æ—¦ä¿¡å·é‡æ“ä½œå¼€å§‹ï¼Œæ²¡æœ‰å…¶ä»–çš„è¿›ç¨‹èƒ½å¤Ÿè®¿é—®ä¿¡å·é‡ï¼Œç›´åˆ°æ“ä½œå®Œæˆæˆ–è€…é˜»å¡ã€‚è¿™ç§åŸå­æ€§å¯¹äºè§£å†³åŒæ­¥é—®é¢˜å’Œé¿å…ç«äº‰ç»å¯¹å¿…ä¸å¯å°‘ã€‚</p><ul><li><code>up</code> æ“ä½œä¼šä½¿ä¿¡å·é‡çš„å€¼ <code>+ 1</code>ã€‚å¦‚æœä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿›ç¨‹åœ¨ä¿¡å·é‡ä¸Šç¡çœ ï¼Œæ— æ³•å®Œæˆä¸€ä¸ªå…ˆå‰çš„ <code>down</code> æ“ä½œï¼Œåˆ™ç”±ç³»ç»Ÿé€‰æ‹©ï¼ˆ<strong>éšæœºæŒ‘é€‰</strong>ï¼‰å…¶ä¸­çš„ä¸€ä¸ªå¹¶å…è®¸è¯¥ç¨‹å®Œæˆ <code>down</code> æ“ä½œã€‚</li></ul><p>å› æ­¤ï¼Œå¯¹ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶ä¸Šç¡çœ çš„ä¿¡å·é‡æ‰§è¡Œä¸€æ¬¡ <code>up</code> æ“ä½œä¹‹åï¼Œè¯¥ä¿¡å·é‡çš„å€¼ä»ç„¶æ˜¯ <code>0</code> ï¼Œä½†åœ¨å…¶ä¸Šç¡çœ çš„è¿›ç¨‹å´å°‘äº†ä¸€ä¸ªã€‚ä¿¡å·é‡çš„å€¼å¢ <code>1</code> å’Œå”¤é†’ä¸€ä¸ªè¿›ç¨‹åŒæ ·ä¹Ÿæ˜¯ä¸å¯åˆ†å‰²çš„ã€‚ä¸ä¼šæœ‰æŸä¸ªè¿›ç¨‹å› æ‰§è¡Œ <code>up</code> è€Œé˜»å¡ï¼Œæ­£å¦‚åœ¨å‰é¢çš„æ¨¡å‹ä¸­ä¸ä¼šæœ‰è¿›ç¨‹å› æ‰§è¡Œ <code>wakeup</code> è€Œé˜»å¡æ˜¯ä¸€æ ·çš„é“ç†ã€‚</p><h3 id="ç”¨ä¿¡å·é‡è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"><a class="markdownIt-Anchor" href="#ç”¨ä¿¡å·é‡è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"></a> ç”¨ä¿¡å·é‡è§£å†³ç”Ÿäº§è€… - æ¶ˆè´¹è€…é—®é¢˜</h3><p>ç”¨ä¿¡å·é‡è§£å†³ä¸¢å¤±çš„ <code>wakeup</code> é—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="hljs c"><span class="hljs-comment">/* å®šä¹‰ç¼“å†²åŒºæ§½çš„æ•°é‡ */</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 100</span><span class="hljs-comment">/* ä¿¡å·é‡æ˜¯ä¸€ç§ç‰¹æ®Šçš„ int */</span><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">int</span> semaphore;<span class="hljs-comment">/* æ§åˆ¶ä¸´ç•ŒåŒºçš„è®¿é—® */</span>semaphore mutex = <span class="hljs-number">1</span>;<span class="hljs-comment">/* ç»Ÿè®¡ buffer ç©ºæ§½çš„æ•°é‡ */</span>semaphore empty = N;<span class="hljs-comment">/* ç»Ÿè®¡ buffer æ»¡æ§½çš„æ•°é‡ */</span>semaphore full = <span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;     <span class="hljs-keyword">int</span> item;      <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* äº§ç”Ÿæ”¾åœ¨ç¼“å†²åŒºçš„ä¸€äº›æ•°æ® */</span>    item = producer_item();    <span class="hljs-comment">/* å°†ç©ºæ§½æ•°é‡å‡ 1  */</span>    <span class="hljs-comment">// è‹¥ç©ºæ§½æ•°é‡ä¸å¤Ÿï¼Œåˆ™é˜»å¡</span>    down(&amp;empty);        <span class="hljs-comment">/* è¿›å…¥ä¸´ç•ŒåŒº  */</span>    down(&amp;mutex);    <span class="hljs-comment">/* æŠŠæ•°æ®æ”¾å…¥ç¼“å†²åŒºä¸­ */</span>    insert_item(item);    <span class="hljs-comment">/* ç¦»å¼€ä¸´ç•ŒåŒº */</span>    up(&amp;mutex);        <span class="hljs-comment">/* å°† buffer æ»¡æ§½æ•°é‡ + 1 */</span>    up(&amp;full);  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;    <span class="hljs-keyword">int</span> item;    <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* ç¼“å­˜åŒºæ»¡æ§½æ•°é‡ - 1 */</span>    <span class="hljs-comment">// è‹¥æ»¡æ§½æ•°é‡ä¸è¶³ï¼Œæ— æ³•æ¶ˆè´¹ï¼Œåˆ™é˜»å¡</span>    down(&amp;full);        <span class="hljs-comment">/* è¿›å…¥ç¼“å†²åŒº */</span>    down(&amp;mutex);    <span class="hljs-comment">/* ä»ç¼“å†²åŒºå–å‡ºæ•°æ® */</span>    item = remove_item();    <span class="hljs-comment">/* ç¦»å¼€ä¸´ç•ŒåŒº */</span>    up(&amp;mutex);        <span class="hljs-comment">/* å°†ç©ºæ§½æ•°ç›® + 1 */</span>    <span class="hljs-comment">// æ¶ˆè´¹æ•°æ®å’Œä¸éœ€è¦åŒæ­¥ï¼Œæ‰€ä»¥å…ˆå¤„ç†ç©ºæ§½æ•°å†æ¶ˆè´¹å–å‡ºçš„æ•°æ®</span>    up(&amp;empty);        <span class="hljs-comment">/* æ¶ˆè´¹æ•°æ® */</span>    consume_item(item);  &#125;&#125;</code></pre><p>ä¸ºäº†ç¡®ä¿ä¿¡å·é‡èƒ½æ­£ç¡®å·¥ä½œï¼Œæœ€é‡è¦çš„æ˜¯è¦é‡‡ç”¨ä¸€ç§ä¸å¯åˆ†å‰²çš„æ–¹å¼æ¥å®ç°å®ƒã€‚é€šå¸¸æ˜¯å°† <code>up</code> å’Œ <code>down</code> ä½œä¸ºç³»ç»Ÿè°ƒç”¨æ¥å®ç°ã€‚è€Œä¸”æ“ä½œç³»ç»Ÿåªéœ€åœ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œæ—¶æš‚æ—¶å±è”½å…¨éƒ¨ä¸­æ–­ï¼š<strong>æ£€æŸ¥ä¿¡å·é‡</strong>ã€<strong>æ›´æ–°</strong>ã€<strong>å¿…è¦æ—¶ä½¿è¿›ç¨‹ç¡çœ </strong>ã€‚ç”±äºè¿™äº›æ“ä½œä»…éœ€è¦éå¸¸å°‘çš„æŒ‡ä»¤ï¼Œå› æ­¤ä¸­æ–­ä¸ä¼šé€ æˆå½±å“ã€‚å¦‚æœä½¿ç”¨å¤šä¸ª <code>CPU</code>ï¼Œé‚£ä¹ˆä¿¡å·é‡åº”è¯¥è¢«<strong>é”</strong>è¿›è¡Œä¿æŠ¤ã€‚ä½¿ç”¨ <code>TSL</code> æˆ–è€… <code>XCHG</code> æŒ‡ä»¤ç”¨æ¥ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª <code>CPU</code> å¯¹ä¿¡å·é‡è¿›è¡Œæ“ä½œã€‚</p><p>ä½¿ç”¨ <code>TSL</code> æˆ–è€… <code>XCHG</code> æ¥é˜²æ­¢å‡ ä¸ª <code>CPU</code> åŒæ—¶è®¿é—®ä¸€ä¸ªä¿¡å·é‡ï¼Œä¸ç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ä½¿ç”¨<strong>å¿™ç­‰å¾…</strong>æ¥ç­‰å¾…å…¶ä»–è…¾å‡ºæˆ–å¡«å……ç¼“å†²åŒºæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚å‰è€…çš„æ“ä½œä»…éœ€è¦å‡ ä¸ªæ¯«ç§’ï¼Œè€Œç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…å¯èƒ½éœ€è¦ä»»æ„é•¿çš„æ—¶é—´ã€‚</p><p>ä¸Šé¢è¿™ä¸ªè§£å†³æ–¹æ¡ˆä½¿ç”¨äº†ä¸‰ç§ä¿¡å·é‡ï¼šä¸€ä¸ªç§°ä¸º <code>full</code>ï¼Œç”¨æ¥è®°å½•å……æ»¡çš„ç¼“å†²æ§½æ•°ç›®ï¼›ä¸€ä¸ªç§°ä¸º <code>empty</code>ï¼Œè®°å½•ç©ºçš„ç¼“å†²æ§½æ•°ç›®ï¼›ä¸€ä¸ªç§°ä¸º <code>mutex</code>ï¼Œ<strong>ç”¨æ¥ç¡®ä¿ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ä¼šåŒæ—¶è¿›å…¥ç¼“å†²åŒº</strong>ã€‚<code>full</code> è¢«åˆå§‹åŒ–ä¸º <code>0</code>ï¼Œ<code>empty</code> åˆå§‹åŒ–ä¸ºç¼“å†²åŒºä¸­æ’æ§½æ•°ï¼Œ<code>mutex</code> åˆå§‹åŒ–ä¸º <code>1</code>ã€‚</p><blockquote><p>ä¾›ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ä½¿ç”¨çš„ä¿¡å·é‡ï¼Œåˆå§‹åŒ–ä¸º <code>1</code>ï¼Œä¿è¯å®ƒä»¬ä¸­åŒæ—¶åªæœ‰ä¸€ä¸ªå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºçš„ä¿¡å·è¢«ç§°ä¸º <code>äºŒè¿›åˆ¶ä¿¡å·é‡(binary semaphores)</code>ã€‚å¦‚æœæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰æ‰§è¡Œ <code>down</code> æ“ä½œï¼Œè€Œåœ¨ç¦»å¼€ä¸´ç•ŒåŒºä¹‹åæ‰§è¡Œ <code>up</code> æ“ä½œï¼Œåˆ™å¯ä»¥ç¡®ä¿ç›¸äº’äº’æ–¥ã€‚</p></blockquote><p>ä¿¡å·é‡çš„å¦ä¸€ç”¨é€”æ˜¯å®ç° <code>åŒæ­¥ï¼ˆsynchronizeationï¼‰</code>ã€‚ä¿¡å·é‡ <code>full</code> å’Œ <code>empty</code> ç”¨æ¥ä¿è¯æŸç§äº‹ä»¶çš„é¡ºåºå‘ç”Ÿæˆ–ä¸å‘ç”Ÿã€‚</p><h2 id="äº’æ–¥é‡"><a class="markdownIt-Anchor" href="#äº’æ–¥é‡"></a> äº’æ–¥é‡</h2><p>å¦‚æœä¸éœ€è¦ä¿¡å·é‡çš„è®¡æ•°èƒ½åŠ›æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¿¡å·é‡çš„ä¸€ä¸ªç®€å•ç‰ˆæœ¬ï¼Œç§°ä¸º <code>mutex (äº’æ–¥é‡)</code>ã€‚äº’æ–¥é‡çš„ä¼˜åŠ¿å°±åœ¨äºåœ¨ä¸€äº›å…±äº«èµ„æºå’Œä¸€æ®µä»£ç ä¸­ä¿æŒäº’æ–¥ã€‚ç”±äºäº’æ–¥çš„å®ç°æ—¢ç®€å•åˆæœ‰æ•ˆï¼Œè¿™ä½¿å¾—äº’æ–¥é‡åœ¨å®ç°ç”¨æˆ·ç©ºé—´çº¿ç¨‹åŒ…æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p>äº’æ–¥é‡æ˜¯ä¸€ä¸ªå¤„äº<strong>ä¸¤ç§çŠ¶æ€</strong>ä¹‹ä¸€çš„å…±äº«å˜é‡ï¼š<code>è§£é”(unlocked)</code> å’Œ <code>åŠ é”(locked)</code>ã€‚è¿™æ ·ï¼Œåªéœ€è¦<strong>ä¸€ä¸ªäºŒè¿›åˆ¶ä½</strong>æ¥è¡¨ç¤ºå®ƒï¼Œä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šå¸¸ä¼šç”¨ä¸€ä¸ª <code>æ•´å½¢(integer)</code> æ¥è¡¨ç¤ºã€‚<code>0</code> è¡¨ç¤ºè§£é”ï¼Œå…¶ä»–æ‰€æœ‰çš„å€¼è¡¨ç¤ºåŠ é”ï¼Œæ¯” <code>1</code> å¤§çš„å€¼è¡¨ç¤ºåŠ é”çš„æ¬¡æ•°ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–è€…è¿›ç¨‹ï¼‰éœ€è¦è®¿é—®ä¸´ç•ŒåŒºæ—¶ï¼Œä¼šè°ƒç”¨ <code>mutex_lock</code> è¿›è¡ŒåŠ é”ã€‚</p><ul><li>å¦‚æœäº’æ–¥é”å½“å‰å¤„äº<strong>æœªé”å®š</strong>çŠ¶æ€ï¼ˆè¡¨ç¤ºä¸´ç•ŒåŒºå¯ç”¨ï¼‰ï¼Œåˆ™è°ƒç”¨æˆåŠŸï¼Œå¹¶ä¸”è°ƒç”¨çº¿ç¨‹å¯ä»¥è‡ªç”±è¿›å…¥ä¸´ç•ŒåŒºã€‚</li><li>å¦‚æœ <code>mutex</code> äº’æ–¥é‡<strong>å·²ç»é”å®š</strong>ï¼Œè°ƒç”¨çº¿ç¨‹ä¼š<strong>é˜»å¡ç›´åˆ°ä¸´ç•ŒåŒºå†…çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å¹¶ä¸”è°ƒç”¨äº† <code>mutex_unlock</code>ã€‚</strong> å¦‚æœå¤šä¸ªçº¿ç¨‹åœ¨ <code>mutex</code> äº’æ–¥é‡ä¸Šé˜»å¡ï¼Œå°†éšæœºé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹å¹¶å…è®¸å®ƒè·å¾—é”ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200922155103.png" srcset="/img/loading.gif" alt="" /></p><p>éšç€å¹¶è¡Œçš„å¢åŠ ï¼Œæœ‰æ•ˆçš„ <code>åŒæ­¥(synchronization)</code> å’Œ <code>é”å®š(locking)</code> å¯¹äºæ€§èƒ½æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚</p><ul><li>å¦‚æœè¿›ç¨‹ç­‰å¾…æ—¶é—´å¾ˆçŸ­ï¼Œé‚£ä¹ˆ <code>è‡ªæ—‹é”(Spin lock)</code> æ˜¯éå¸¸æœ‰æ•ˆï¼›ä½†æ˜¯å¦‚æœç­‰å¾…æ—¶é—´æ¯”è¾ƒé•¿ï¼Œé‚£ä¹ˆè¿™ä¼šæµªè´¹ CPU å‘¨æœŸã€‚</li><li>å¦‚æœè¿›ç¨‹å¾ˆå¤šï¼Œé‚£ä¹ˆé˜»å¡æ­¤è¿›ç¨‹ï¼Œå¹¶ä»…å½“é”è¢«é‡Šæ”¾çš„æ—¶å€™è®©å†…æ ¸è§£é™¤é˜»å¡æ˜¯æ›´æœ‰æ•ˆçš„æ–¹å¼ã€‚<br />ä¸å¹¸çš„æ˜¯ï¼šå®ƒå¯ä»¥åœ¨è¿›ç¨‹ç«äº‰é¢‘ç¹çš„æ—¶å€™è¿è¡Œè‰¯å¥½ï¼Œä½†æ˜¯åœ¨ç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹å†…æ ¸åˆ‡æ¢çš„æ¶ˆè€—ä¼šéå¸¸å¤§ï¼Œè€Œä¸”æ›´å›°éš¾çš„æ˜¯ï¼Œé¢„æµ‹é”çš„ç«äº‰æ•°é‡æ›´ä¸å®¹æ˜“ã€‚</li></ul><h2 id="ç®¡ç¨‹"><a class="markdownIt-Anchor" href="#ç®¡ç¨‹"></a> ç®¡ç¨‹</h2><p>ç®¡ç¨‹æ˜¯ç¨‹åºã€å˜é‡å’Œæ•°æ®ç»“æ„ç­‰ç»„æˆçš„ä¸€ä¸ªé›†åˆï¼Œå®ƒä»¬ç»„æˆä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å—æˆ–è€…åŒ…ã€‚è¿›ç¨‹å¯ä»¥åœ¨ä»»ä½•éœ€è¦çš„æ—¶å€™è°ƒç”¨ç®¡ç¨‹ä¸­çš„ç¨‹åºï¼Œä½†æ˜¯å®ƒä»¬ä¸èƒ½ä»ç®¡ç¨‹å¤–éƒ¨è®¿é—®æ•°æ®ç»“æ„å’Œç¨‹åºã€‚</p><p><strong>åœ¨ä»»ä½•æ—¶å€™ç®¡ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ´»è·ƒçš„è¿›ç¨‹</strong>ï¼Œè¿™ä¸€ç‰¹æ€§ä½¿ç®¡ç¨‹èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„å®ç°äº’æ–¥æ“ä½œã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“è¿›ç¨‹è°ƒç”¨ç®¡ç¨‹ä¸­çš„ç¨‹åºæ—¶ï¼Œè¯¥ç¨‹åºçš„å‰å‡ æ¡æŒ‡ä»¤ä¼šæ£€æŸ¥ç®¡ç¨‹ä¸­æ˜¯å¦æœ‰å…¶ä»–æ´»è·ƒçš„è¿›ç¨‹ã€‚å¦‚æœæœ‰çš„è¯ï¼Œè°ƒç”¨è¿›ç¨‹å°†è¢«æŒ‚èµ·ï¼Œç›´åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ç¦»å¼€ç®¡ç¨‹æ‰å°†å…¶å”¤é†’ã€‚å¦‚æœæ²¡æœ‰æ´»è·ƒè¿›ç¨‹åœ¨ä½¿ç”¨ç®¡ç¨‹ï¼Œé‚£ä¹ˆè¯¥è°ƒç”¨è¿›ç¨‹æ‰å¯ä»¥è¿›å…¥ã€‚</p><p>å³ä½¿ç®¡ç¨‹æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥å®ç°äº’æ–¥ï¼Œä½†åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œè¿™è¿˜ä¸å¤Ÿã€‚å› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§<strong>ä½¿å¾—è¿›ç¨‹åœ¨æ— æ³•æ‰§è¡Œæ—¶è¢«é˜»å¡</strong>ã€‚åœ¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ä¸­ï¼Œå¾ˆå®¹æ˜“å°†é’ˆå¯¹ç¼“å†²åŒºæ»¡å’Œç¼“å†²åŒºç©ºçš„æµ‹è¯•æ”¾åœ¨ç®¡ç¨‹ç¨‹åºä¸­ï¼Œä½†æ˜¯ç”Ÿäº§è€…åœ¨å‘ç°ç¼“å†²åŒºæ»¡çš„æ—¶å€™è¯¥å¦‚ä½•é˜»å¡å‘¢ï¼Ÿ</p><p>è§£å†³çš„åŠæ³•æ˜¯å¼•å…¥ <code>æ¡ä»¶å˜é‡(condition variables)</code> ä»¥åŠç›¸å…³çš„ä¸¤ä¸ªæ“ä½œ <code>wait</code> å’Œ <code>signal</code>ã€‚å½“ä¸€ä¸ªç®¡ç¨‹ç¨‹åºå‘ç°å®ƒä¸èƒ½è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ï¼Œç”Ÿäº§è€…å‘ç°ç¼“å†²åŒºå·²æ»¡ï¼‰ï¼Œå®ƒä¼šåœ¨æŸä¸ªæ¡ä»¶å˜é‡ï¼ˆå¦‚ <code>full</code>ï¼‰ä¸Šæ‰§è¡Œ <code>wait</code> æ“ä½œã€‚è¿™ä¸ªæ“ä½œé€ æˆè°ƒç”¨è¿›ç¨‹é˜»å¡ï¼Œå¹¶ä¸”è¿˜å°†å¦ä¸€ä¸ªä»¥å‰ç­‰åœ¨ç®¡ç¨‹ä¹‹å¤–çš„è¿›ç¨‹è°ƒå…¥ç®¡ç¨‹ã€‚å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯”å¦‚æ¶ˆè´¹è€…å¯ä»¥é€šè¿‡æ‰§è¡Œ <code>signal</code> æ¥å”¤é†’é˜»å¡çš„è°ƒç”¨è¿›ç¨‹ã€‚</p><p>å¦‚æœåœ¨ä¸€ä¸ªæ¡ä»¶å˜é‡ä¸Šæœ‰è‹¥å¹²è¿›ç¨‹éƒ½åœ¨ç­‰å¾…ï¼Œåˆ™åœ¨å¯¹è¯¥æ¡ä»¶æ‰§è¡Œ <code>signal</code> æ“ä½œåï¼Œç³»ç»Ÿè°ƒåº¦ç¨‹åºåªèƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹æ¢å¤è¿è¡Œã€‚</p><blockquote><p>æ¡ä»¶å˜é‡ä¸æ˜¯è®¡æ•°å™¨ã€‚æ¡ä»¶å˜é‡ä¹Ÿä¸èƒ½åƒä¿¡å·é‡é‚£æ ·ç§¯ç´¯ä¿¡å·ä»¥ä¾¿ä»¥åä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœå‘ä¸€ä¸ªæ¡ä»¶å˜é‡å‘é€ä¿¡å·ï¼Œä½†æ˜¯è¯¥æ¡ä»¶å˜é‡ä¸Šæ²¡æœ‰ç­‰å¾…è¿›ç¨‹ï¼Œé‚£ä¹ˆä¿¡å·å°†ä¼šä¸¢å¤±ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong><code>wait</code> æ“ä½œå¿…é¡»åœ¨ <code>signal</code> ä¹‹å‰æ‰§è¡Œ</strong>ã€‚</p></blockquote><p>é€šè¿‡ä¸´ç•ŒåŒºè‡ªåŠ¨çš„äº’æ–¥ï¼Œ<strong>ç®¡ç¨‹æ¯”ä¿¡å·é‡æ›´å®¹æ˜“ä¿è¯å¹¶è¡Œç¼–ç¨‹çš„æ­£ç¡®æ€§</strong>ã€‚ä½†æ˜¯ç®¡ç¨‹ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œæˆ‘ä»¬å‰é¢è¯´åˆ°è¿‡ç®¡ç¨‹æ˜¯ä¸€ä¸ªç¼–ç¨‹è¯­è¨€çš„æ¦‚å¿µï¼Œç¼–è¯‘å™¨å¿…é¡»è¦è¯†åˆ«ç®¡ç¨‹å¹¶ç”¨æŸç§æ–¹å¼å¯¹å…¶äº’æ–¥ä½œå‡ºä¿è¯ã€‚Cã€Pascal ä»¥åŠå¤§å¤šæ•°å…¶ä»–ç¼–ç¨‹è¯­è¨€éƒ½æ²¡æœ‰ç®¡ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½ä¾é ç¼–è¯‘å™¨æ¥éµå®ˆäº’æ–¥è§„åˆ™ã€‚</p><p>ä¸ç®¡ç¨‹å’Œä¿¡å·é‡æœ‰å…³çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œ<strong>è¿™äº›æœºåˆ¶éƒ½æ˜¯è®¾è®¡ç”¨æ¥è§£å†³è®¿é—®å…±äº«å†…å­˜çš„ä¸€ä¸ªæˆ–å¤šä¸ª <code>CPU</code> ä¸Šçš„äº’æ–¥é—®é¢˜çš„</strong>ã€‚</p><ul><li>é€šè¿‡å°†ä¿¡å·é‡æ”¾åœ¨å…±äº«å†…å­˜ä¸­å¹¶ç”¨ <code>TSL</code> æˆ– <code>XCHG</code> æŒ‡ä»¤æ¥ä¿æŠ¤å®ƒä»¬ï¼Œå¯ä»¥é¿å…ç«äº‰ã€‚</li><li>ä½†æ˜¯å¦‚æœæ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¯èƒ½åŒæ—¶å…·æœ‰å¤šä¸ª <code>CPU</code> çš„æƒ…å†µï¼Œå¹¶ä¸”æ¯ä¸ª <code>CPU</code> éƒ½æœ‰è‡ªå·±çš„ç§æœ‰å†…å­˜å‘¢ï¼Œå®ƒä»¬é€šè¿‡ç½‘ç»œç›¸è¿ï¼Œé‚£ä¹ˆè¿™äº›åŸè¯­å°†ä¼šå¤±æ•ˆã€‚å› ä¸ºä¿¡å·é‡å¤ªä½çº§äº†ï¼Œè€Œç®¡ç¨‹åœ¨å°‘æ•°å‡ ç§ç¼–ç¨‹è¯­è¨€ä¹‹å¤–æ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦å…¶ä»–æ–¹æ³•ã€‚</li></ul><h2 id="æ¶ˆæ¯ä¼ é€’"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯ä¼ é€’"></a> æ¶ˆæ¯ä¼ é€’</h2><p><code>æ¶ˆæ¯ä¼ é€’(messaage passing)</code> ä½¿ç”¨ä¸¤ä¸ªåŸè¯­ <code>send</code> å’Œ <code>receive</code>ï¼Œå®ƒä»¬åƒä¿¡å·é‡è€Œä¸åƒç®¡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè°ƒç”¨è€Œä¸æ˜¯è¯­è¨€çº§åˆ«ã€‚ç¤ºä¾‹å¦‚ä¸‹</p><pre><code class="hljs c">send(destination, &amp;message);receive(source, &amp;message);</code></pre><p><code>send</code> æ–¹æ³•ç”¨äºå‘ä¸€ä¸ªç»™å®šçš„ç›®æ ‡å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œ<code>receive</code> ä»ä¸€ä¸ªç»™å®šçš„æºæ¥å—ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœæ²¡æœ‰æ¶ˆæ¯ï¼Œæ¥å—è€…å¯èƒ½è¢«é˜»å¡ï¼Œç›´åˆ°æ¥å—ä¸€æ¡æ¶ˆæ¯æˆ–è€…å¸¦ç€é”™è¯¯ç è¿”å›ã€‚</p><h3 id="è®¾è®¡è¦ç‚¹"><a class="markdownIt-Anchor" href="#è®¾è®¡è¦ç‚¹"></a> è®¾è®¡è¦ç‚¹</h3><p>æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿç°åœ¨é¢ä¸´ç€è®¸å¤šä¿¡å·é‡å’Œç®¡ç¨‹æ‰€æœªæ¶‰åŠçš„é—®é¢˜å’Œè®¾è®¡éš¾ç‚¹ï¼Œå°¤å…¶å¯¹é‚£äº›åœ¨ç½‘ç»œä¸­ä¸åŒæœºå™¨ä¸Šçš„é€šä¿¡çŠ¶å†µã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923130422.png" srcset="/img/loading.gif" alt="" /></p><ul><li><p><strong>æ¶ˆæ¯ä¸¢å¤±</strong> - ä¸ºäº†é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹å¯ä»¥è¾¾æˆä¸€è‡´ï¼šä¸€æ—¦æ¥å—åˆ°æ¶ˆæ¯åï¼Œæ¥æ”¶æ–¹é©¬ä¸Šå›é€ä¸€æ¡ç‰¹æ®Šçš„ <code>ç¡®è®¤(acknowledgement)</code> æ¶ˆæ¯ã€‚å¦‚æœå‘é€æ–¹åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…æœªæ”¶åˆ°ç¡®è®¤ï¼Œåˆ™é‡å‘æ¶ˆæ¯ã€‚</p></li><li><p><strong>ç¡®è®¤æ¶ˆæ¯ä¸¢å¤±</strong> - å‘é€è€…å°†é‡å‘æ¶ˆæ¯ï¼Œè¿™æ ·æ¥å—è€…å°†æ”¶åˆ°ä¸¤æ¬¡ç›¸åŒçš„æ¶ˆæ¯ã€‚å¯¹äºæ¥æ”¶è€…æ¥è¯´ï¼Œå¦‚ä½•åŒºåˆ†æ–°çš„æ¶ˆæ¯å’Œä¸€æ¡é‡å‘çš„è€æ¶ˆæ¯æ˜¯éå¸¸é‡è¦çš„ã€‚é€šå¸¸é‡‡ç”¨<strong>åœ¨æ¯æ¡åŸå§‹æ¶ˆæ¯ä¸­åµŒå…¥ä¸€ä¸ªè¿ç»­çš„åºå·</strong>æ¥è§£å†³æ­¤é—®é¢˜ã€‚å¦‚æœæ¥å—è€…æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œå®ƒå…·æœ‰ä¸å‰é¢æŸä¸€æ¡æ¶ˆæ¯ä¸€æ ·çš„åºå·ï¼Œå°±çŸ¥é“è¿™æ¡æ¶ˆæ¯æ˜¯é‡å¤çš„ï¼Œå¯ä»¥å¿½ç•¥ã€‚</p></li></ul><h3 id="ç”¨æ¶ˆæ¯ä¼ é€’è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"><a class="markdownIt-Anchor" href="#ç”¨æ¶ˆæ¯ä¼ é€’è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜"></a> ç”¨æ¶ˆæ¯ä¼ é€’è§£å†³ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜</h3><pre><code class="hljs c"><span class="hljs-comment">/* buffer ä¸­æ§½çš„æ•°é‡ */</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 100</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">producer</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;    <span class="hljs-keyword">int</span> item;  <span class="hljs-comment">/* buffer ä¸­æ§½çš„æ•°é‡ */</span>  message m;    <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* ç”Ÿæˆæ”¾å…¥ç¼“å†²åŒºçš„æ•°æ® */</span>    item = produce_item();    <span class="hljs-comment">/* ç­‰å¾…æ¶ˆè´¹è€…å‘é€ç©ºç¼“å†²åŒº */</span>    receive(consumer,&amp;m);    <span class="hljs-comment">/* å»ºç«‹ä¸€ä¸ªå¾…å‘é€çš„æ¶ˆæ¯ */</span>    build_message(&amp;m,item);    <span class="hljs-comment">/* å‘é€ç»™æ¶ˆè´¹è€… */</span>    send(consumer,&amp;m);  &#125;  &#125;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">consumer</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>&#123;    <span class="hljs-keyword">int</span> item,i;  message m;    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i &lt; N;i++)&#123;    <span class="hljs-comment">/* å‘é€ N ä¸ªç¼“å†²åŒº */</span>    send(producer,&amp;m);  &#125;  <span class="hljs-keyword">while</span>(TRUE)&#123;    <span class="hljs-comment">/* æ¥å—åŒ…å«æ•°æ®çš„æ¶ˆæ¯ */</span>    receive(producer,&amp;m);    <span class="hljs-comment">/* å°†æ•°æ®ä»æ¶ˆæ¯ä¸­æå–å‡ºæ¥ */</span>    item = extract_item(&amp;m);    <span class="hljs-comment">/* å°†ç©ºç¼“å†²åŒºå‘é€å›ç”Ÿäº§è€… */</span>    send(producer,&amp;m);    <span class="hljs-comment">/* å¤„ç†æ•°æ® */</span>    consume_item(item);  &#125;  &#125;</code></pre><p>åœ¨è¯¥è§£å†³æ–¹æ¡ˆä¸­å…±ä½¿ç”¨ <code>N</code> æ¡æ¶ˆæ¯ï¼Œè¿™å°±ç±»ä¼¼äºä¸€å—å…±äº«å†…å­˜ç¼“å†²åŒºçš„ <code>N</code> ä¸ªæ§½ã€‚æ¶ˆè´¹è€…é¦–å…ˆå°† <code>N</code> æ¡ç©ºæ¶ˆæ¯å‘é€ç»™ç”Ÿäº§è€…ã€‚å½“ç”Ÿäº§è€…å‘æ¶ˆè´¹è€…ä¼ é€’ä¸€ä¸ªæ•°æ®é¡¹æ—¶ï¼Œå®ƒå–èµ°ä¸€æ¡ç©ºæ¶ˆæ¯å¹¶è¿”å›ä¸€æ¡å¡«å……äº†å†…å®¹çš„æ¶ˆæ¯ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç³»ç»Ÿä¸­æ€»çš„æ¶ˆæ¯æ•°é‡ä¿æŒä¸å˜ï¼Œæ‰€ä»¥æ¶ˆæ¯éƒ½å¯ä»¥å­˜æ”¾åœ¨äº‹å…ˆç¡®å®šæ•°é‡çš„å†…å­˜ä¸­ã€‚</p><h2 id="å±éšœ"><a class="markdownIt-Anchor" href="#å±éšœ"></a> å±éšœ</h2><p>å±éšœæ˜¯ç”¨äº<strong>è¿›ç¨‹ç»„</strong>è€Œä¸æ˜¯è¿›ç¨‹é—´çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æƒ…å†µçš„ã€‚åœ¨æŸäº›åº”ç”¨ä¸­åˆ’åˆ†äº†è‹¥å¹²é˜¶æ®µï¼Œå¹¶ä¸”è§„å®šï¼Œé™¤é<strong>æ‰€æœ‰çš„è¿›ç¨‹éƒ½å°±ç»ª</strong>å‡†å¤‡è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œå¦åˆ™ä»»ä½•è¿›ç¨‹éƒ½ä¸èƒ½è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œå¯ä»¥é€šè¿‡åœ¨æ¯ä¸ªé˜¶æ®µçš„ç»“å°¾å®‰è£…ä¸€ä¸ª <code>å±éšœ(barrier)</code> æ¥å®ç°è¿™ç§è¡Œä¸ºã€‚å½“ä¸€ä¸ªè¿›ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå®ƒä¼šè¢«å±éšœæ‰€æ‹¦æˆªï¼Œç›´åˆ°æ‰€æœ‰çš„å±éšœéƒ½åˆ°è¾¾ä¸ºæ­¢ã€‚å±éšœå¯ç”¨äºä¸€ç»„è¿›ç¨‹åŒæ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923131256.png" srcset="/img/loading.gif" alt="" /></p><h1 id="è°ƒåº¦"><a class="markdownIt-Anchor" href="#è°ƒåº¦"></a> è°ƒåº¦</h1><p>åœ¨å¤šé“ç¨‹åºç³»ç»Ÿä¸­ï¼Œ<strong>è°ƒåº¦çš„å®è´¨æ˜¯ä¸€ç§èµ„æºåˆ†é…</strong>ï¼Œå¤šä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹åŒæ—¶ç«äº‰ <code>CPU</code> å’Œ<code>æ—¶é—´ç‰‡</code>ï¼Œé€šè¿‡è°ƒåº¦ç®—æ³•æ¥é€‰æ‹©éœ€è¦è¿è¡Œçš„è¿›ç¨‹/çº¿ç¨‹ã€‚</p><h2 id="è°ƒåº¦ä»‹ç»"><a class="markdownIt-Anchor" href="#è°ƒåº¦ä»‹ç»"></a> è°ƒåº¦ä»‹ç»</h2><p>æ‰¹å¤„ç†ç³»ç»Ÿçš„æ—¶ä»£ï¼šä¾æ¬¡è¿è¡Œç£å¸¦ä¸Šçš„æ¯ä¸€ä¸ªä½œä¸šã€‚<br />å¯¹äºå¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿï¼Œä¼šå¤æ‚ä¸€äº›ï¼Œå› ä¸ºé€šå¸¸ä¼šæœ‰å¤šä¸ªç”¨æˆ·åœ¨ç­‰å¾…æœåŠ¡ã€‚ä¸€äº›å¤§å‹æœºä»ç„¶å°† <code>æ‰¹å¤„ç†</code> å’Œ <code>åˆ†æ—¶æœåŠ¡</code> ç»“åˆä½¿ç”¨ï¼Œéœ€è¦è°ƒåº¦ç¨‹åºå†³å®šä¸‹ä¸€ä¸ªè¿è¡Œçš„æ˜¯ä¸€ä¸ªæ‰¹å¤„ç†ä½œä¸šè¿˜æ˜¯ç»ˆç«¯ä¸Šçš„ç”¨æˆ·ã€‚ç”±äºåœ¨è¿™äº›æœºå™¨ä¸­ <code>CPU</code> æ˜¯ç¨€ç¼ºèµ„æºï¼Œæ‰€ä»¥å¥½çš„è°ƒåº¦ç¨‹åºå¯ä»¥åœ¨æé«˜æ€§èƒ½å’Œç”¨æˆ·çš„æ»¡æ„åº¦æ–¹é¢å–å¾—å¾ˆå¤§çš„æˆæœã€‚</p><h3 id="è¿›ç¨‹è¡Œä¸º"><a class="markdownIt-Anchor" href="#è¿›ç¨‹è¡Œä¸º"></a> è¿›ç¨‹è¡Œä¸º</h3><p><strong>å‡ ä¹æ‰€æœ‰çš„è¿›ç¨‹ï¼ˆç£ç›˜æˆ–ç½‘ç»œï¼‰I/O è¯·æ±‚å’Œè®¡ç®—éƒ½æ˜¯äº¤æ›¿è¿è¡Œçš„ã€‚</strong><br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923134601.png" srcset="/img/loading.gif" alt="" /><br />ä¸Šé¢ <code>a</code> æ˜¯ <code>CPU å¯†é›†å‹</code> è¿›ç¨‹ï¼›<code>b</code> æ˜¯ <code>I/O å¯†é›†å‹</code> è¿›ç¨‹ï¼Œ<code>a</code> å› ä¸ºåœ¨è®¡ç®—çš„æ—¶é—´ä¸ŠèŠ±è´¹æ—¶é—´æ›´é•¿ï¼Œå› æ­¤ç§°ä¸º <code>è®¡ç®—å¯†é›†å‹(compute-bound)</code> æˆ–è€… <code>CPU å¯†é›†å‹(CPU-bound)</code>ï¼Œ<code>b</code> å› ä¸º <code>I/O</code> å‘ç”Ÿé¢‘ç‡æ¯”è¾ƒå¿«å› æ­¤ç§°ä¸º <code>I/O å¯†é›†å‹(I/O-bound)</code>ã€‚</p><ul><li>è®¡ç®—å¯†é›†å‹è¿›ç¨‹æœ‰è¾ƒé•¿çš„ <code>CPU</code> é›†ä¸­ä½¿ç”¨å’Œè¾ƒå°é¢‘åº¦çš„ <code>I/O</code> ç­‰å¾…ã€‚</li><li><code>I/O</code> å¯†é›†å‹è¿›ç¨‹æœ‰è¾ƒçŸ­çš„ <code>CPU</code> ä½¿ç”¨æ—¶é—´å’Œè¾ƒé¢‘ç¹çš„ <code>I/O</code> ç­‰å¾…ã€‚</li></ul><p>æ³¨æ„åˆ°ä¸Šé¢ä¸¤ç§è¿›ç¨‹çš„åŒºåˆ†å…³é”®åœ¨äº <strong><code>CPU</code> çš„æ—¶é—´å ç”¨</strong>è€Œä¸æ˜¯ <code>I/O</code> çš„æ—¶é—´å ç”¨ã€‚<br /><code>I/O å¯†é›†å‹</code> çš„åŸå› æ˜¯å› ä¸º<strong>å®ƒä»¬æ²¡æœ‰åœ¨ <code>I/O</code> ä¹‹é—´èŠ±è´¹æ›´å¤šçš„è®¡ç®—ã€è€Œä¸æ˜¯ <code>I/O</code> è¯·æ±‚æ—¶é—´ç‰¹åˆ«é•¿</strong>ã€‚æ— è®ºæ•°æ®åˆ°è¾¾åéœ€è¦èŠ±è´¹å¤šå°‘æ—¶é—´ï¼Œå®ƒä»¬éƒ½éœ€è¦èŠ±è´¹ç›¸åŒçš„æ—¶é—´æ¥å‘å‡ºè¯»å–ç£ç›˜å—çš„ç¡¬ä»¶è¯·æ±‚ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéšç€ <code>CPU</code> çš„é€Ÿåº¦è¶Šæ¥è¶Šå¿«ï¼Œæ›´å¤šçš„è¿›ç¨‹å€¾å‘äº <code>I/O å¯†é›†å‹</code>ã€‚è¿™ç§æƒ…å†µå‡ºç°çš„åŸå› æ˜¯ <code>CPU</code> é€Ÿåº¦çš„æå‡è¦è¿œè¿œé«˜äºç¡¬ç›˜ã€‚è¿™ç§æƒ…å†µå¯¼è‡´çš„ç»“æœæ˜¯ï¼Œæœªæ¥å¯¹ <code>I/O</code> å¯†é›†å‹è¿›ç¨‹çš„è°ƒåº¦å¤„ç†ä¼¼ä¹æ›´ä¸ºé‡è¦ã€‚è¿™é‡Œçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœéœ€è¦è¿è¡Œ <code>I/O</code> å¯†é›†å‹è¿›ç¨‹ï¼Œé‚£ä¹ˆå°±åº”è¯¥è®©å®ƒå°½å¿«å¾—åˆ°æœºä¼šï¼Œä»¥ä¾¿å‘å‡ºç£ç›˜è¯·æ±‚å¹¶ä¿æŒç£ç›˜å§‹ç»ˆå¿™ç¢Œã€‚</p><h3 id="ä½•æ—¶è°ƒåº¦"><a class="markdownIt-Anchor" href="#ä½•æ—¶è°ƒåº¦"></a> ä½•æ—¶è°ƒåº¦</h3><p>ç¬¬ä¸€ä¸ªå’Œè°ƒåº¦æœ‰å…³çš„é—®é¢˜æ˜¯<strong>ä½•æ—¶è¿›è¡Œè°ƒåº¦å†³ç­–</strong>ã€‚å­˜åœ¨ç€éœ€è¦è°ƒåº¦å¤„ç†çš„å„ç§æƒ…å½¢ã€‚</p><ul><li><p>é¦–å…ˆï¼Œåœ¨åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹åï¼Œéœ€è¦å†³å®šæ˜¯è¿è¡Œçˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ã€‚å› ä¸ºäºŒè€…çš„è¿›ç¨‹éƒ½å¤„äºå°±ç»ªæ€ä¸‹ï¼Œè¿™æ˜¯æ­£å¸¸çš„è°ƒåº¦å†³ç­–ï¼Œå¯ä»¥ä»»æ„é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒåº¦ç¨‹åºå¯ä»¥ä»»æ„çš„é€‰æ‹©å­è¿›ç¨‹æˆ–çˆ¶è¿›ç¨‹å¼€å§‹è¿è¡Œã€‚</p></li><li><p>ç¬¬äºŒï¼Œåœ¨è¿›ç¨‹é€€å‡ºæ—¶éœ€è¦ä½œå‡ºè°ƒåº¦å†³å®šã€‚å› ä¸ºæ­¤è¿›ç¨‹ä¸å†è¿è¡Œï¼ˆå› ä¸ºå®ƒå°†ä¸å†å­˜åœ¨ï¼‰ï¼Œå› æ­¤å¿…é¡»ä»å°±ç»ªè¿›ç¨‹ä¸­é€‰æ‹©å…¶ä»–è¿›ç¨‹è¿è¡Œã€‚å¦‚æœæ²¡æœ‰è¿›ç¨‹å¤„äºå°±ç»ªæ€ï¼Œç³»ç»Ÿæä¾›çš„ç©ºé—²è¿›ç¨‹é€šå¸¸ä¼šè¿è¡Œã€‚</p></li></ul><h3 id="è°ƒåº¦ç®—æ³•çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#è°ƒåº¦ç®—æ³•çš„åˆ†ç±»"></a> è°ƒåº¦ç®—æ³•çš„åˆ†ç±»</h3><p>ä¸åŒçš„ç¯å¢ƒä¸‹éœ€è¦ä¸åŒçš„è°ƒåº¦ç®—æ³•ã€‚ä¹‹æ‰€ä»¥å‡ºç°è¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºä¸åŒçš„åº”ç”¨ç¨‹åºå’Œä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„ç›®æ ‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>åœ¨ä¸åŒçš„ç³»ç»Ÿä¸­ï¼Œè°ƒåº¦ç¨‹åºçš„ä¼˜åŒ–ä¹Ÿæ˜¯ä¸åŒçš„</strong>ã€‚è¿™é‡Œæœ‰å¿…è¦åˆ’åˆ†å‡ºä¸‰ç§ç¯å¢ƒï¼š</p><ol><li><p><code>æ‰¹å¤„ç†(Batch)</code>ï¼š<br />æ‰¹å¤„ç†ç³»ç»Ÿå¹¿æ³›åº”ç”¨äºå•†ä¸šé¢†åŸŸï¼Œæ¯”å¦‚ç”¨æ¥å¤„ç†å·¥èµ„å•ã€å­˜è´§æ¸…å•ã€è´¦ç›®æ”¶å…¥ã€è´¦ç›®æ”¯å‡ºã€åˆ©æ¯è®¡ç®—ã€ç´¢èµ”å¤„ç†å’Œå…¶ä»–å‘¨æœŸæ€§ä½œä¸šã€‚åœ¨æ‰¹å¤„ç†ç³»ç»Ÿä¸­ï¼Œ<strong>ä¸€èˆ¬ä¼šé€‰æ‹©ä½¿ç”¨<code>éæŠ¢å å¼ç®—æ³•</code>æˆ–è€…<code>å‘¨æœŸæ€§æ¯”è¾ƒé•¿çš„æŠ¢å å¼ç®—æ³•</code></strong>ã€‚è¿™ç§æ–¹æ³•å¯ä»¥<code>å‡å°‘çº¿ç¨‹åˆ‡æ¢</code>å› æ­¤èƒ½å¤Ÿæå‡æ€§èƒ½ã€‚</p></li><li><p><code>äº¤äº’å¼(Interactive)</code>ï¼š<br />åœ¨äº¤äº’å¼ç”¨æˆ·ç¯å¢ƒä¸­ï¼Œä¸ºäº†é¿å…ä¸€ä¸ªè¿›ç¨‹éœ¸å  <code>CPU</code> æ‹’ç»ä¸ºå…¶ä»–è¿›ç¨‹æœåŠ¡ï¼Œæ‰€ä»¥éœ€è¦<code>æŠ¢å å¼ç®—æ³•</code>ã€‚å³ä½¿æ²¡æœ‰è¿›ç¨‹æœ‰æ„è¦ä¸€ç›´è¿è¡Œä¸‹å»ï¼Œä½†æ˜¯ï¼Œç”±äºæŸä¸ªè¿›ç¨‹å‡ºç°é”™è¯¯ä¹Ÿæœ‰å¯èƒ½æ— é™æœŸçš„æ’æ–¥å…¶ä»–æ‰€æœ‰è¿›ç¨‹ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒæŠ¢å å¼ä¹Ÿæ˜¯å¿…é¡»çš„ã€‚æœåŠ¡å™¨ä¹Ÿå±äºæ­¤ç±»åˆ«ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¸ºå¤šä¸ªï¼ˆè¿œç¨‹ï¼‰ç”¨æˆ·æä¾›æœåŠ¡ï¼Œè€Œè¿™äº›ç”¨æˆ·éƒ½éå¸¸ç€æ€¥ï¼Œè®¡ç®—æœºç”¨æˆ·æ€»æ˜¯å¾ˆå¿™ã€‚</p></li><li><p><code>å®æ—¶(Real time)</code>ï¼š<br />åœ¨å®æ—¶ç³»ç»Ÿä¸­ï¼ŒæŠ¢å æœ‰æ—¶æ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºè¿›ç¨‹çŸ¥é“è‡ªå·±å¯èƒ½è¿è¡Œä¸äº†å¾ˆé•¿æ—¶é—´ï¼Œé€šå¸¸å¾ˆå¿«çš„åšå®Œè‡ªå·±çš„å·¥ä½œå¹¶é˜»å¡ã€‚</p></li></ol><p>å®æ—¶ç³»ç»Ÿä¸äº¤äº’å¼ç³»ç»Ÿçš„å·®åˆ«æ˜¯ï¼Œå®æ—¶ç³»ç»Ÿåªè¿è¡Œé‚£äº›ç”¨æ¥æ¨è¿›ç°æœ‰åº”ç”¨çš„ç¨‹åºï¼Œè€Œäº¤äº’å¼ç³»ç»Ÿæ˜¯é€šç”¨çš„ï¼Œå®ƒå¯ä»¥è¿è¡Œä»»æ„çš„éåä½œç”šè‡³æ˜¯æœ‰æ¶æ„çš„ç¨‹åºã€‚</p><h3 id="è°ƒåº¦ç®—æ³•çš„ç›®æ ‡"><a class="markdownIt-Anchor" href="#è°ƒåº¦ç®—æ³•çš„ç›®æ ‡"></a> è°ƒåº¦ç®—æ³•çš„ç›®æ ‡</h3><p>æ‰€æœ‰ç³»ç»Ÿ:</p><ul><li>å…¬å¹³ï¼šç»™æ¯ä¸ªè¿›ç¨‹å…¬å¹³çš„ <code>CPU</code> ä»½é¢ã€‚</li><li>ç­–ç•¥å¼ºåˆ¶æ‰§è¡Œï¼šä¿è¯è§„å®šçš„ç­–ç•¥è¢«æ‰§è¡Œã€‚</li><li>å¹³è¡¡ï¼šä¿æŒç³»ç»Ÿçš„æ‰€æœ‰éƒ¨åˆ†éƒ½å¿™ç¢Œã€‚</li></ul><p>æ‰¹å¤„ç†ç³»ç»Ÿï¼š</p><ul><li>ååé‡ï¼šç³»ç»Ÿæ¯å°æ—¶å®Œæˆçš„ä½œä¸šæ•°é‡ã€‚</li><li>å‘¨è½¬æ—¶é—´ï¼šä¸€ä¸ªæ‰¹å¤„ç†æäº¤å¼€å§‹ç›´åˆ°ä½œä¸šå®Œæˆæ—¶åˆ»ä¸ºæ­¢å¹³å‡æ—¶é—´ã€‚è¯¥æ•°æ®åº¦é‡äº†ç”¨æˆ·è¦å¾—åˆ°è¾“å‡ºæ‰€éœ€çš„å¹³å‡ç­‰å¾…æ—¶é—´ã€‚å‘¨è½¬æ—¶é—´è¶Šå°è¶Šå¥½ã€‚</li><li><code>CPU</code> åˆ©ç”¨ç‡ï¼šä¿æŒ <code>CPU</code> æ—¶é’Ÿå¿™ç¢Œã€‚</li></ul><p>äº¤äº’å¼ç³»ç»Ÿï¼š</p><ul><li>å‡å°‘å“åº”æ—¶é—´ã€‚</li><li>å‡è¡¡æ€§ï¼šæ»¡è¶³ç”¨æˆ·æœŸæœ›ã€‚</li></ul><p>å®æ—¶ç³»ç»Ÿ</p><ul><li>å¿…é¡»æ»¡è¶³æœ€åçš„æˆªæ­¢æ—¶é—´ï¼šé¿å…æ•°æ®ä¸¢å¤±ã€‚</li><li>å¯é¢„æµ‹æ€§ï¼šå¤šåª’ä½“ç³»ç»Ÿä¸­é¿å…å“è´¨é™ä½ã€‚</li></ul><h2 id="ä¸€-æ‰¹å¤„ç†ä¸­çš„è°ƒåº¦"><a class="markdownIt-Anchor" href="#ä¸€-æ‰¹å¤„ç†ä¸­çš„è°ƒåº¦"></a> ä¸€. æ‰¹å¤„ç†ä¸­çš„è°ƒåº¦</h2><h3 id="1-å…ˆæ¥å…ˆæœåŠ¡"><a class="markdownIt-Anchor" href="#1-å…ˆæ¥å…ˆæœåŠ¡"></a> 1. å…ˆæ¥å…ˆæœåŠ¡</h3><p><code>å…ˆæ¥å…ˆæœåŠ¡(first-come,first-serverd)</code> <strong>å°†æŒ‰ç…§è¯·æ±‚é¡ºåºä¸ºè¿›ç¨‹åˆ†é… <code>CPU</code>ã€‚</strong> æœ€åŸºæœ¬çš„ï¼Œä¼šæœ‰ä¸€ä¸ªå°±ç»ªè¿›ç¨‹çš„ç­‰å¾…é˜Ÿåˆ—ã€‚</p><ul><li>å½“ç¬¬ä¸€ä¸ªä»»åŠ¡ä»å¤–éƒ¨è¿›å…¥ç³»ç»Ÿæ—¶ï¼Œå°†ä¼šç«‹å³å¯åŠ¨å¹¶å…è®¸è¿è¡Œä»»æ„é•¿çš„æ—¶é—´ã€‚å®ƒä¸ä¼šå› ä¸ºè¿è¡Œæ—¶é—´å¤ªé•¿è€Œä¸­æ–­ã€‚å½“å…¶ä»–ä½œä¸šè¿›å…¥æ—¶ï¼Œå®ƒä»¬æ’åˆ°å°±ç»ªé˜Ÿåˆ—å°¾éƒ¨ã€‚</li><li>å½“æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹é˜»å¡ï¼Œå¤„äºç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹å°±å¼€å§‹è¿è¡Œã€‚</li><li>å½“ä¸€ä¸ªé˜»å¡çš„è¿›ç¨‹é‡æ–°å¤„äºå°±ç»ªæ€æ—¶ï¼Œå®ƒä¼šåƒä¸€ä¸ªæ–°åˆ°è¾¾çš„ä»»åŠ¡ï¼Œä¼šæ’åœ¨é˜Ÿåˆ—çš„æœ«å°¾ï¼Œå³æ’åœ¨æ‰€æœ‰è¿›ç¨‹æœ€åã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923142129.png" srcset="/img/loading.gif" alt="" /></li></ul><p>ç¼ºç‚¹ï¼š<strong>æ²¡æœ‰ä¼˜å…ˆçº§çš„å…³ç³»</strong>ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæœ‰ 100 ä¸ª I/O è¿›ç¨‹æ­£åœ¨æ’é˜Ÿï¼Œç¬¬ 101 ä¸ªæ˜¯ä¸€ä¸ª CPU å¯†é›†å‹è¿›ç¨‹ï¼Œé‚£å²‚ä¸æ˜¯éœ€è¦ç­‰ 100 ä¸ª I/O è¿›ç¨‹è¿è¡Œå®Œæ¯•æ‰ä¼šç­‰åˆ°ä¸€ä¸ª CPU å¯†é›†å‹è¿›ç¨‹è¿è¡Œï¼Œè¿™åœ¨å®é™…æƒ…å†µä¸‹æ ¹æœ¬ä¸å¯èƒ½ï¼Œæ‰€ä»¥éœ€è¦ <code>ä¼˜å…ˆçº§</code> æˆ–è€… <code>æŠ¢å å¼</code> è¿›ç¨‹çš„å‡ºç°æ¥ä¼˜å…ˆé€‰æ‹©é‡è¦çš„è¿›ç¨‹è¿è¡Œã€‚</p><h3 id="2-æœ€çŸ­ä½œä¸šä¼˜å…ˆ"><a class="markdownIt-Anchor" href="#2-æœ€çŸ­ä½œä¸šä¼˜å…ˆ"></a> 2. æœ€çŸ­ä½œä¸šä¼˜å…ˆ</h3><p><code>æœ€çŸ­ä½œä¸šä¼˜å…ˆ(Shortest Job First)</code> ä»¥ä½œä¸šçš„é•¿çŸ­æ¥è®¡ç®—ä¼˜å…ˆçº§ï¼Œä½œä¸šè¶ŠçŸ­ï¼Œå…¶ä¼˜å…ˆçº§è¶Šé«˜ã€‚</p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ‰€æœ‰çš„è¿›ç¨‹éƒ½å¯ä»¥è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œæœ€çŸ­ä½œä¸šä¼˜å…ˆçš„ç®—æ³•æ‰æ˜¯æœ€ä¼˜çš„ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923142638.png" srcset="/img/loading.gif" alt="" /></p><h3 id="3-æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ"><a class="markdownIt-Anchor" href="#3-æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ"></a> 3. æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ</h3><p>æœ€çŸ­ä½œä¸šä¼˜å…ˆçš„<code>æŠ¢å å¼</code>ç‰ˆæœ¬è¢«ç§°ä½œä¸º <code>æœ€çŸ­å‰©ä½™æ—¶é—´ä¼˜å…ˆ(Shortest Remaining Time Next)</code> ç®—æ³•ã€‚ä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Œè°ƒåº¦ç¨‹åºæ€»æ˜¯é€‰æ‹©<strong>å‰©ä½™è¿è¡Œæ—¶é—´æœ€çŸ­</strong>çš„é‚£ä¸ªè¿›ç¨‹è¿è¡Œã€‚å½“ä¸€ä¸ªæ–°ä½œä¸šåˆ°è¾¾æ—¶ï¼Œå…¶æ•´ä¸ªæ—¶é—´åŒå½“å‰è¿›ç¨‹çš„å‰©ä½™æ—¶é—´åšæ¯”è¾ƒã€‚å¦‚æœæ–°çš„è¿›ç¨‹æ¯”å½“å‰è¿è¡Œè¿›ç¨‹éœ€è¦æ›´å°‘çš„æ—¶é—´ï¼Œå½“å‰è¿›ç¨‹å°±è¢«æŒ‚èµ·ï¼Œè€Œè¿è¡Œæ–°çš„è¿›ç¨‹ã€‚è¿™ç§æ–¹å¼èƒ½å¤Ÿä½¿çŸ­æœŸä½œä¸šè·å¾—è‰¯å¥½çš„æœåŠ¡ã€‚</p><h2 id="äºŒ-äº¤äº’å¼ç³»ç»Ÿä¸­çš„è°ƒåº¦"><a class="markdownIt-Anchor" href="#äºŒ-äº¤äº’å¼ç³»ç»Ÿä¸­çš„è°ƒåº¦"></a> äºŒ. äº¤äº’å¼ç³»ç»Ÿä¸­çš„è°ƒåº¦</h2><h3 id="1-è½®è¯¢è°ƒåº¦"><a class="markdownIt-Anchor" href="#1-è½®è¯¢è°ƒåº¦"></a> 1. è½®è¯¢è°ƒåº¦</h3><p>ä¸€ç§æœ€å¤è€ã€æœ€ç®€å•ã€æœ€å…¬å¹³å¹¶ä¸”æœ€å¹¿æ³›ä½¿ç”¨çš„ç®—æ³•å°±æ˜¯ <code>è½®è¯¢ç®—æ³•(round-robin)</code>ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ªæ—¶é—´æ®µï¼Œç§°ä¸º <code>æ—¶é—´ç‰‡(quantum)</code>ï¼Œåœ¨è¿™ä¸ªæ—¶é—´ç‰‡å†…å…è®¸è¿›ç¨‹è¿è¡Œã€‚</p><p>åˆ‡æ¢æ—¶æœºï¼š</p><ul><li>å¦‚æœæ—¶é—´ç‰‡ç»“æŸæ—¶è¿›ç¨‹è¿˜åœ¨è¿è¡Œçš„è¯ï¼Œåˆ™æŠ¢å ä¸€ä¸ª <code>CPU</code> å¹¶å°†å…¶åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹ã€‚</li><li>å¦‚æœè¿›ç¨‹åœ¨æ—¶é—´ç‰‡ç»“æŸå‰é˜»å¡æˆ–ç»“æŸï¼Œåˆ™ <code>CPU</code> ç«‹å³è¿›è¡Œåˆ‡æ¢ã€‚</li></ul><p>æ—¶é—´ç‰‡å¤§å°ï¼š</p><ul><li>å°æ—¶é—´ç‰‡æœ‰åˆ©äºçŸ­ä½œä¸šï¼Œä½†ä¼šé¢‘ç¹æ‰§è¡Œè¿›ç¨‹è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</li><li>é•¿æ—¶é—´ç‰‡ï¼Œä¸ºäº†ä½¿æ¯ä¸ªè¿›ç¨‹åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…å®Œæˆï¼ŒRR ç®—æ³•ä¾¿é€€åŒ–ä¸º FCFS ç®—æ³•ï¼Œæ— æ³•æ»¡è¶³çŸ­ä½œä¸šå’Œäº¤äº’ç”¨æˆ·çš„éœ€æ±‚ã€‚</li><li>ä¸€ä¸ªè¾ƒä¸ºå¯å–çš„æ—¶é—´ç‰‡å¤§å°æ˜¯ç•¥å¤§äºä¸€æ¬¡å…¸å‹çš„äº¤äº’æ‰€éœ€è¦çš„æ—¶é—´ï¼Œä½¿å¤§å¤šæ•°äº¤äº’å¼è¿›ç¨‹èƒ½åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…å®Œæˆï¼Œä»è€Œå¯ä»¥è·å¾—å¾ˆå°çš„å“åº”æ—¶é—´ã€‚</li></ul><p>è½®è¯¢ç®—æ³•æ¯”è¾ƒå®¹æ˜“å®ç°ã€‚è°ƒåº¦ç¨‹åºæ‰€åšçš„å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªå¯è¿è¡Œè¿›ç¨‹çš„åˆ—è¡¨ï¼Œå°±åƒä¸‹å›¾ä¸­çš„ <code>a</code>ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹ç”¨å®Œæ—¶é—´ç‰‡åå°±è¢«ç§»åˆ°é˜Ÿåˆ—çš„æœ«å°¾ï¼Œå°±åƒä¸‹å›¾çš„ <code>b</code>ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923143142.png" srcset="/img/loading.gif" alt="" /></p><h3 id="2-ä¼˜å…ˆçº§è°ƒåº¦"><a class="markdownIt-Anchor" href="#2-ä¼˜å…ˆçº§è°ƒåº¦"></a> 2. ä¼˜å…ˆçº§è°ƒåº¦</h3><p><code>ä¼˜å…ˆçº§è°ƒåº¦(priority scheduling)</code> æ˜¯æŠŠå¤„ç†æœºåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹ã€‚</p><p>ä½†æ˜¯ä¹Ÿä¸æ„å‘³ç€é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹èƒ½å¤Ÿæ°¸è¿œä¸€ç›´è¿è¡Œä¸‹å»ï¼Œè°ƒåº¦ç¨‹åºä¼šåœ¨æ¯ä¸ªæ—¶é’Ÿä¸­æ–­æœŸé—´é™ä½å½“å‰è¿è¡Œè¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚å¦‚æœæ­¤æ“ä½œå¯¼è‡´å…¶ä¼˜å…ˆçº§é™ä½åˆ°ä¸‹ä¸€ä¸ªæœ€é«˜è¿›ç¨‹çš„ä¼˜å…ˆçº§ä»¥ä¸‹ï¼Œåˆ™ä¼šå‘ç”Ÿè¿›ç¨‹åˆ‡æ¢ã€‚æˆ–è€…ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…å…è®¸è¿è¡Œçš„æœ€å¤§æ—¶é—´é—´éš”ã€‚å½“æ—¶é—´é—´éš”ç”¨å®Œåï¼Œä¸‹ä¸€ä¸ªé«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹ä¼šå¾—åˆ°è¿è¡Œçš„æœºä¼šã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923144447.png" srcset="/img/loading.gif" alt="" /><br />ç®—æ³•ç±»å‹ï¼š</p><ul><li>éæŠ¢å å¼ï¼šä¸€æ—¦ CPU åˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹åï¼Œè¯¥è¿›ç¨‹ä¾¿ä¸€ç›´æ‰§è¡Œä¸‹å»ç›´è‡³å®Œæˆã€‚</li><li>æŠ¢å å¼ï¼šåœ¨ä¼˜å…ˆçº§æœ€é«˜çš„è¿›ç¨‹æ‰§è¡ŒæœŸé—´ï¼Œåªè¦å‡ºç°å¦ä¸€ä¸ªä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹ï¼Œå°±å°† CPU åˆ†é…ç»™æ–°çš„æœ€é«˜ä¼˜å…ˆçº§è¿›ç¨‹ã€‚</li></ul><p>ä¼˜å…ˆçº§ç±»å‹ï¼š</p><ul><li>é™æ€ä¼˜å…ˆçº§ï¼šåœ¨åˆ›å»ºè¿›ç¨‹æ—¶ç¡®å®šä¼˜å…ˆçº§ï¼Œåœ¨è¿›ç¨‹çš„æ•´ä¸ªè¿è¡ŒæœŸé—´ä¿æŒä¸å˜ã€‚</li><li>åŠ¨æ€ä¼˜å…ˆçº§ï¼šåœ¨åˆ›å»ºè¿›ç¨‹ä¹‹åˆï¼Œå…ˆèµ‹äºˆä¸€ä¸ªä¼˜å…ˆçº§ï¼Œç„¶åå…¶å€¼éšè¿›ç¨‹çš„æ¨è¿›æˆ–ç­‰å¾…æ—¶é—´çš„å¢åŠ è€Œæ”¹å˜ï¼Œä»¥ä¾¿è·å¾—æ›´å¥½çš„è°ƒåº¦æ€§èƒ½ã€‚</li></ul><h3 id="3-å¤šçº§é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#3-å¤šçº§é˜Ÿåˆ—"></a> 3. å¤šçº§é˜Ÿåˆ—</h3><p>å°†ç³»ç»Ÿä¸­çš„è¿›ç¨‹å°±ç»ªé˜Ÿåˆ—ä»ä¸€ä¸ªæ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªï¼Œå°†ä¸åŒç±»å‹æˆ–æ€§è´¨çš„è¿›ç¨‹å›ºå®šåˆ†é…åœ¨ä¸åŒçš„å°±ç»ªé˜Ÿåˆ—ï¼Œä¸åŒçš„å°±ç»ªé˜Ÿåˆ—é‡‡ç”¨ä¸åŒçš„è°ƒåº¦ç®—æ³•ï¼Œä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹å¯ä»¥è®¾ç½®ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œå°±ç»ªé˜Ÿåˆ—æœ¬èº«ä¹Ÿå¯ä»¥è®¾ç½®ä¸åŒçš„ä¼˜å…ˆçº§ã€‚</p><h3 id="4-æœ€çŸ­è¿›ç¨‹ä¼˜å…ˆ"><a class="markdownIt-Anchor" href="#4-æœ€çŸ­è¿›ç¨‹ä¼˜å…ˆ"></a> 4. æœ€çŸ­è¿›ç¨‹ä¼˜å…ˆ</h3><p>æ ¹æ®è¿›ç¨‹è¿‡å»çš„è¡Œä¸ºè¿›è¡Œæ¨æµ‹ï¼Œå¹¶æ‰§è¡Œä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„é‚£ä¸€ä¸ªã€‚<br />å‡è®¾æ¯ä¸ªç»ˆç«¯ä¸Šæ¯æ¡å‘½ä»¤çš„é¢„ä¼°è¿è¡Œæ—¶é—´ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œç°åœ¨å‡è®¾æµ‹é‡åˆ°å…¶ä¸‹ä¸€æ¬¡è¿è¡Œæ—¶é—´ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œå¯ä»¥ç”¨ä¸¤ä¸ªå€¼çš„åŠ æƒæ¥æ”¹è¿›ä¼°è®¡æ—¶é—´ï¼Œå³ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><msub><mi>T</mi><mn>0</mn></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">)</mo><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">aT_0 + (1 - a)T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚é€šè¿‡é€‰æ‹© <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> çš„å€¼ï¼Œå¯ä»¥å†³å®šæ˜¯å°½å¿«å¿˜æ‰è€çš„è¿è¡Œæ—¶é—´ï¼Œè¿˜æ˜¯åœ¨ä¸€æ®µé•¿æ—¶é—´å†…å§‹ç»ˆè®°ä½å®ƒä»¬ã€‚å½“ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a = \frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢è¿™ä¸ªåºåˆ—ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>T</mi><mn>0</mn></msub><mn>2</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>1</mn></msub><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{T_0}{2} + \frac{T_1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>T</mi><mn>0</mn></msub><mn>4</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>1</mn></msub><mn>4</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>2</mn></msub><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{T_0}{4} + \frac{T_1}{4} + \frac{T_2}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>T</mi><mn>0</mn></msub><mn>8</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>1</mn></msub><mn>8</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>2</mn></msub><mn>4</mn></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mn>3</mn></msub><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{T_0}{8} + \frac{T_1}{8} + \frac{T_2}{4} + \frac{T_3}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸‰è½®è¿‡åï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> åœ¨æ–°çš„ä¼°è®¡å€¼ä¸­æ‰€å æ¯”é‡ä¸‹é™è‡³ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">1/8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">8</span></span></span></span>ã€‚</p><p>æœ‰æ—¶æŠŠè¿™ç§é€šè¿‡å½“å‰æµ‹é‡å€¼å’Œå…ˆå‰ä¼°è®¡å€¼è¿›è¡ŒåŠ æƒå¹³å‡ä»è€Œå¾—åˆ°ä¸‹ä¸€ä¸ªä¼°è®¡å€¼çš„æŠ€æœ¯ç§°ä½œ <code>è€åŒ–(aging)</code>ã€‚è¿™ç§æ–¹æ³•ä¼šä½¿ç”¨å¾ˆå¤šé¢„æµ‹å€¼åŸºäºå½“å‰å€¼çš„æƒ…å†µã€‚</p><h3 id="5-ä¿è¯è°ƒåº¦"><a class="markdownIt-Anchor" href="#5-ä¿è¯è°ƒåº¦"></a> 5. ä¿è¯è°ƒåº¦</h3><p>å¯¹ç”¨æˆ·åšå‡ºæ˜ç¡®çš„æ€§èƒ½ä¿è¯ã€‚ä¸€ç§å®é™…è€Œä¸”å®¹æ˜“å®ç°çš„ä¿è¯æ˜¯ï¼šåœ¨ä¸€ä¸ªæœ‰ <code>n</code> ä¸ªè¿›ç¨‹è¿è¡Œçš„å•ç”¨æˆ·ç³»ç»Ÿä¸­ï¼Œè‹¥æ‰€æœ‰çš„è¿›ç¨‹éƒ½ç­‰ä»·ï¼Œåˆ™æ¯ä¸ªè¿›ç¨‹å°†è·å¾— <code>1/n</code> çš„ <code>CPU</code> æ—¶é—´ã€‚</p><h3 id="6-å½©ç¥¨è°ƒåº¦"><a class="markdownIt-Anchor" href="#6-å½©ç¥¨è°ƒåº¦"></a> 6. å½©ç¥¨è°ƒåº¦</h3><p><code>å½©ç¥¨è°ƒåº¦(lottery scheduling)ç®—æ³•</code> ä¸ºè¿›ç¨‹æä¾›å„ç§ç³»ç»Ÿèµ„æºï¼ˆä¾‹å¦‚ CPU æ—¶é—´ï¼‰çš„å½©ç¥¨ã€‚å½“åšå‡ºä¸€ä¸ªè°ƒåº¦å†³ç­–çš„æ—¶å€™ï¼Œå°±éšæœºæŠ½å‡ºä¸€å¼ å½©ç¥¨ï¼Œæ‹¥æœ‰å½©ç¥¨çš„è¿›ç¨‹å°†è·å¾—è¯¥èµ„æºã€‚åœ¨åº”ç”¨åˆ° CPU è°ƒåº¦æ—¶ï¼Œç³»ç»Ÿå¯ä»¥æ¯ç§’æŒæœ‰ 50 æ¬¡æŠ½å¥–ï¼Œæ¯ä¸ªä¸­å¥–è€…å°†è·å¾—æ¯”å¦‚ 20 æ¯«ç§’çš„ CPU æ—¶é—´ä½œä¸ºå¥–åŠ±ã€‚</p><ul><li><p><strong>æ‰€æœ‰çš„è¿›ç¨‹æ˜¯å¹³ç­‰çš„ï¼Œä½†æ˜¯æŸäº›è¿›ç¨‹èƒ½å¤Ÿæ›´å¹³ç­‰ä¸€äº›ã€‚</strong> ä¸€äº›é‡è¦çš„è¿›ç¨‹å¯ä»¥ç»™å®ƒä»¬é¢å¤–çš„å½©ç¥¨ï¼Œä»¥ä¾¿å¢åŠ ä»–ä»¬èµ¢å¾—çš„æœºä¼šã€‚<br />å¦‚æœå‡ºå”®äº† 100 å¼ å½©ç¥¨ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªè¿›ç¨‹æŒæœ‰äº†å®ƒä»¬ä¸­çš„ 20 å¼ ï¼Œå®ƒå°±ä¼šæœ‰ 20% çš„æœºä¼šå»èµ¢å¾—å½©ç¥¨ä¸­å¥–ã€‚åœ¨é•¿æ—¶é—´çš„è¿è¡Œä¸­ï¼Œå®ƒå°±ä¼šè·å¾— 20% çš„CPUã€‚ç›¸åï¼Œå¯¹äºä¼˜å…ˆçº§è°ƒåº¦ç¨‹åºï¼Œå¾ˆéš¾è¯´æ˜æ‹¥æœ‰ä¼˜å…ˆçº§ 40 ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¿™é‡Œçš„è§„åˆ™å¾ˆæ¸…æ¥šï¼Œæ‹¥æœ‰å½©ç¥¨ f ä»½é¢çš„è¿›ç¨‹å¤§çº¦å¾—åˆ°ç³»ç»Ÿèµ„æºçš„ f ä»½é¢ã€‚</p></li><li><p><strong>å¦‚æœå¸Œæœ›è¿›ç¨‹ä¹‹é—´åä½œçš„è¯å¯ä»¥äº¤æ¢å®ƒä»¬ä¹‹é—´çš„ç¥¨æ®ã€‚</strong> ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯è¿›ç¨‹ç»™æœåŠ¡å™¨è¿›ç¨‹å‘é€äº†ä¸€æ¡æ¶ˆæ¯åé˜»å¡ï¼Œå®¢æˆ·ç«¯è¿›ç¨‹å¯èƒ½ä¼šæŠŠè‡ªå·±æ‰€æœ‰çš„ç¥¨æ®éƒ½äº¤ç»™æœåŠ¡å™¨ï¼Œæ¥å¢åŠ ä¸‹ä¸€æ¬¡æœåŠ¡å™¨è¿è¡Œçš„æœºä¼šã€‚å½“æœåŠ¡å®Œæˆåï¼Œå®ƒä¼šæŠŠå½©ç¥¨è¿˜ç»™å®¢æˆ·ç«¯è®©å…¶æœ‰æœºä¼šå†æ¬¡è¿è¡Œã€‚äº‹å®ä¸Šï¼Œå¦‚æœæ²¡æœ‰å®¢æˆ·æœºï¼ŒæœåŠ¡å™¨ä¹Ÿæ ¹æœ¬ä¸éœ€è¦å½©ç¥¨ã€‚</p></li></ul><h3 id="7-å…¬å¹³åˆ†äº«è°ƒåº¦"><a class="markdownIt-Anchor" href="#7-å…¬å¹³åˆ†äº«è°ƒåº¦"></a> 7. å…¬å¹³åˆ†äº«è°ƒåº¦</h3><p>ä¸€äº›ç³»ç»Ÿåœ¨è°ƒåº¦å‰ä¼šæŠŠ<strong>è¿›ç¨‹çš„æ‹¥æœ‰è€…</strong>è€ƒè™‘åœ¨å†…ã€‚åœ¨è¿™ç§æ¨¡å‹ä¸‹ï¼Œ<strong>æ¯ä¸ªç”¨æˆ·éƒ½ä¼šåˆ†é…ä¸€äº› <code>CPU</code> æ—¶é—´ï¼Œè€Œè°ƒåº¦ç¨‹åºä¼šé€‰æ‹©è¿›ç¨‹å¹¶å¼ºåˆ¶æ‰§è¡Œã€‚</strong> å› æ­¤å¦‚æœä¸¤ä¸ªç”¨æˆ·æ¯ä¸ªéƒ½ä¼šæœ‰ <code>50%</code> çš„ <code>CPU</code> æ—¶é—´ç‰‡ä¿è¯ï¼Œé‚£ä¹ˆæ— è®ºä¸€ä¸ªç”¨æˆ·æœ‰å¤šå°‘ä¸ªè¿›ç¨‹ï¼Œéƒ½å°†è·å¾—ç›¸åŒçš„ <code>CPU</code> ä»½é¢ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923151340.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ä¸‰-å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦"><a class="markdownIt-Anchor" href="#ä¸‰-å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦"></a> ä¸‰. å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦</h2><p><code>å®æ—¶ç³»ç»Ÿ(real-time)</code> æ˜¯ä¸€ä¸ªæ—¶é—´æ‰®æ¼”äº†é‡è¦ä½œç”¨çš„ç³»ç»Ÿã€‚å…¸å‹çš„ï¼Œä¸€ç§æˆ–å¤šç§å¤–éƒ¨ç‰©ç†è®¾å¤‡å‘ç»™è®¡ç®—æœºä¸€ä¸ªæœåŠ¡è¯·æ±‚ï¼Œè€Œè®¡ç®—æœº<strong>å¿…é¡»åœ¨ä¸€ä¸ªç¡®å®šçš„æ—¶é—´èŒƒå›´å†…æ°å½“çš„åšå‡ºååº”</strong>ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ CD æ’­æ”¾å™¨ä¸­çš„è®¡ç®—æœºä¼šè·å¾—ä»é©±åŠ¨å™¨è¿‡æ¥çš„ä½æµï¼Œç„¶åå¿…é¡»åœ¨éå¸¸çŸ­çš„æ—¶é—´å†…å°†ä½æµè½¬æ¢ä¸ºéŸ³ä¹æ’­æ”¾å‡ºæ¥ã€‚å¦‚æœè®¡ç®—æ—¶é—´è¿‡é•¿ï¼Œé‚£ä¹ˆéŸ³ä¹å°±ä¼šå¬èµ·æ¥æœ‰å¼‚å¸¸ã€‚<br />å†æ¯”å¦‚è¯´åŒ»é™¢ç‰¹åˆ«æŠ¤ç†éƒ¨é—¨çš„ç—…äººç›‘æŠ¤è£…ç½®ã€é£æœºä¸­çš„è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿã€åˆ—è½¦ä¸­çš„çƒŸé›¾è­¦å‘Šè£…ç½®ç­‰ï¼Œåœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œæ­£ç¡®ä½†æ˜¯å´ç¼“æ…¢çš„å“åº”è¦æ¯”æ²¡æœ‰å“åº”ç”šè‡³è¿˜ç³Ÿç³•ã€‚</p><p>å®æ—¶ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œ<code>ç¡¬å®æ—¶(hard real time)</code> å’Œ <code>è½¯å®æ—¶(soft real time)</code> ç³»ç»Ÿï¼Œå‰è€…æ„å‘³ç€å¿…é¡»è¦<strong>æ»¡è¶³ç»å¯¹çš„æˆªæ­¢æ—¶é—´</strong>ï¼›åè€…çš„å«ä¹‰æ˜¯è™½ç„¶ä¸å¸Œæœ›å¶å°”é”™å¤±æˆªæ­¢æ—¶é—´ï¼Œä½†æ˜¯å¯ä»¥å®¹å¿ã€‚åœ¨è¿™ä¸¤ç§æƒ…å½¢ä¸­ï¼Œå®æ—¶éƒ½æ˜¯é€šè¿‡æŠŠç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„è¿›ç¨‹è€Œå®ç°çš„ï¼Œå…¶ä¸­æ¯ä¸ªè¿›ç¨‹çš„è¡Œä¸ºæ˜¯å¯é¢„æµ‹å’Œæå‰å¯çŸ¥çš„ã€‚è¿™äº›è¿›ç¨‹ä¸€èˆ¬å¯¿å‘½è¾ƒçŸ­ï¼Œå¹¶ä¸”æå¿«çš„è¿è¡Œå®Œæˆã€‚åœ¨æ£€æµ‹åˆ°ä¸€ä¸ªå¤–éƒ¨ä¿¡å·æ—¶ï¼Œè°ƒåº¦ç¨‹åºçš„ä»»åŠ¡å°±æ˜¯æŒ‰ç…§æ»¡è¶³æ‰€æœ‰æˆªæ­¢æ—¶é—´çš„è¦æ±‚è°ƒåº¦è¿›ç¨‹ã€‚</p><p>å®æ—¶ç³»ç»Ÿä¸­çš„äº‹ä»¶å¯ä»¥æŒ‰ç…§å“åº”æ–¹å¼è¿›ä¸€æ­¥åˆ†ç±»ä¸º <code>å‘¨æœŸæ€§(ä»¥è§„åˆ™çš„æ—¶é—´é—´éš”å‘ç”Ÿ)</code> äº‹ä»¶æˆ– <code>éå‘¨æœŸæ€§(å‘ç”Ÿæ—¶é—´ä¸å¯é¢„çŸ¥)</code> äº‹ä»¶ã€‚ä¸€ä¸ªç³»ç»Ÿå¯èƒ½è¦å“åº”å¤šä¸ªå‘¨æœŸæ€§äº‹ä»¶æµï¼Œæ ¹æ®æ¯ä¸ªäº‹ä»¶å¤„ç†æ‰€éœ€çš„æ—¶é—´ï¼Œå¯èƒ½ç”šè‡³æ— æ³•å¤„ç†æ‰€æœ‰äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> ä¸ªå‘¨æœŸäº‹ä»¶ï¼Œäº‹ä»¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> ä»¥å‘¨æœŸ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å‘ç”Ÿï¼Œå¹¶éœ€è¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç§’ <code>CPU</code> æ—¶é—´å¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥å¤„ç†è´Ÿè½½çš„æ¡ä»¶æ˜¯</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mfrac><msub><mi>C</mi><mi>i</mi></msub><msub><mi>P</mi><mi>i</mi></msub></mfrac><mo>â‰¤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{m} \frac{C_i}{P_i} \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p><p>åªæœ‰æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„å®æ—¶ç³»ç»Ÿç§°ä¸º <code>å¯è°ƒåº¦</code> çš„ï¼Œè¿™æ„å‘³ç€å®ƒå®é™…ä¸Šèƒ½å¤Ÿè¢«å®ç°ã€‚ä¸€ä¸ªä¸æ»¡è¶³æ­¤æ£€éªŒæ ‡å‡†çš„è¿›ç¨‹ä¸èƒ½è¢«è°ƒåº¦ï¼Œå› ä¸ºè¿™äº›è¿›ç¨‹å…±åŒéœ€è¦çš„ <code>CPU</code> æ—¶é—´æ€»å’Œå¤§äº <code>CPU</code> èƒ½æä¾›çš„æ—¶é—´ã€‚</p><h2 id="çº¿ç¨‹è°ƒåº¦"><a class="markdownIt-Anchor" href="#çº¿ç¨‹è°ƒåº¦"></a> çº¿ç¨‹è°ƒåº¦</h2><p>å½“è‹¥å¹²è¿›ç¨‹éƒ½æœ‰å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œå°±å­˜åœ¨ä¸¤ä¸ªå±‚æ¬¡çš„å¹¶è¡Œï¼šè¿›ç¨‹å’Œçº¿ç¨‹ã€‚åœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­è°ƒåº¦å¤„ç†æœ‰æœ¬è´¨çš„å·®åˆ«ï¼Œè¿™å–å†³äºæ‰€æ”¯æŒçš„æ˜¯ç”¨æˆ·çº§çº¿ç¨‹è¿˜æ˜¯å†…æ ¸çº§çº¿ç¨‹ï¼ˆæˆ–ä¸¤è€…éƒ½æ”¯æŒï¼‰ã€‚</p><p>é¦–å…ˆè€ƒè™‘ <code>ç”¨æˆ·çº§çº¿ç¨‹</code>ï¼Œç”±äºå†…æ ¸å¹¶ä¸çŸ¥é“æœ‰çº¿ç¨‹å­˜åœ¨ï¼Œæ‰€ä»¥å†…æ ¸è¿˜æ˜¯å’Œä»¥å‰ä¸€æ ·åœ°æ“ä½œï¼Œé€‰å–ä¸€ä¸ªè¿›ç¨‹ï¼Œå‡è®¾ä¸º Aï¼Œå¹¶ç»™äºˆ A ä»¥æ—¶é—´ç‰‡æ§åˆ¶ã€‚<strong>è¿›ç¨‹ A ä¸­çš„çº¿ç¨‹è°ƒåº¦ç¨‹åºå†³å®šå“ªä¸ªçº¿ç¨‹è¿è¡Œã€‚</strong> å‡è®¾ä¸º A1ã€‚ç”±äºå¤šé“çº¿ç¨‹å¹¶ä¸å­˜åœ¨æ—¶é’Ÿä¸­æ–­ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹å¯ä»¥æŒ‰å…¶æ„æ„¿ä»»æ„è¿è¡Œå¤šé•¿æ—¶é—´ã€‚å¦‚æœè¯¥çº¿ç¨‹ç”¨å®Œäº†è¿›ç¨‹çš„å…¨éƒ¨æ—¶é—´ç‰‡ï¼Œå†…æ ¸å°±ä¼šé€‰æ‹©å¦ä¸€ä¸ªè¿›ç¨‹ç»§ç»­è¿è¡Œã€‚</p><p>åœ¨è¿›ç¨‹ A ç»ˆäºåˆä¸€æ¬¡è¿è¡Œæ—¶ï¼Œçº¿ç¨‹ A1 ä¼šæ¥ç€è¿è¡Œã€‚è¯¥çº¿ç¨‹ä¼šç»§ç»­è€—è´¹ A è¿›ç¨‹çš„æ‰€æœ‰æ—¶é—´ï¼Œç›´åˆ°å®ƒå®Œæˆå·¥ä½œã€‚ä¸è¿‡ï¼Œçº¿ç¨‹è¿è¡Œä¸ä¼šå½±å“åˆ°å…¶ä»–è¿›ç¨‹ã€‚å…¶ä»–è¿›ç¨‹ä¼šå¾—åˆ°è°ƒåº¦ç¨‹åºæ‰€åˆ†é…çš„åˆé€‚ä»½é¢ï¼Œä¸ä¼šè€ƒè™‘è¿›ç¨‹ A å†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚</p><p>ç°åœ¨è€ƒè™‘ A çº¿ç¨‹æ¯æ¬¡ CPU è®¡ç®—çš„å·¥ä½œæ¯”è¾ƒå°‘çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼šåœ¨ 50 ms çš„æ—¶é—´ç‰‡ä¸­æœ‰ 5 ms çš„è®¡ç®—å·¥ä½œã€‚äºæ˜¯ï¼Œæ¯ä¸ªçº¿ç¨‹è¿è¡Œä¸€ä¼šå„¿ï¼Œç„¶åæŠŠ CPU äº¤å›ç»™çº¿ç¨‹è°ƒåº¦ç¨‹åºã€‚è¿™æ ·åœ¨å†…æ ¸åˆ‡æ¢åˆ°è¿›ç¨‹ B ä¹‹å‰ï¼Œå°±ä¼šæœ‰åºåˆ— A1, A2, A3, A1, A2, A3, A1, A2, A3, A1ã€‚ å¦‚ä¸‹æ‰€ç¤º</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923154350.png" srcset="/img/loading.gif" alt="" /></p><p>è¿è¡Œæ—¶ç³»ç»Ÿä½¿ç”¨çš„è°ƒåº¦ç®—æ³•å¯ä»¥æ˜¯ä¸Šé¢ä»‹ç»ç®—æ³•çš„ä»»æ„ä¸€ç§ã€‚ä»å®ç”¨æ–¹é¢è€ƒè™‘ï¼Œ<strong>è½®è½¬è°ƒåº¦å’Œä¼˜å…ˆçº§è°ƒåº¦æ›´ä¸ºå¸¸ç”¨</strong>ã€‚å”¯ä¸€çš„å±€é™æ˜¯ï¼Œç¼ºä¹ä¸€ä¸ªæ—¶é’Ÿä¸­æ–­è¿è¡Œè¿‡é•¿çš„çº¿ç¨‹ã€‚ä½†ç”±äºçº¿ç¨‹ä¹‹é—´çš„åˆä½œå…³ç³»ï¼Œè¿™é€šå¸¸ä¹Ÿä¸æ˜¯é—®é¢˜ã€‚</p><p>ç°åœ¨è€ƒè™‘ä½¿ç”¨<code>å†…æ ¸çº¿ç¨‹</code> çš„æƒ…å†µï¼Œ<strong>å†…æ ¸é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„çº¿ç¨‹è¿è¡Œ</strong>ã€‚<strong>å®ƒä¸ç”¨è€ƒè™‘çº¿ç¨‹å±äºå“ªä¸ªè¿›ç¨‹</strong>ï¼Œä¸è¿‡å¦‚æœæœ‰å¿…è¦çš„è¯ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆåšã€‚å¯¹è¢«é€‰æ‹©çš„çº¿ç¨‹èµ‹äºˆä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œè€Œä¸”å¦‚æœè¶…è¿‡äº†æ—¶é—´ç‰‡ï¼Œå°±ä¼šå¼ºåˆ¶æŒ‚èµ·è¯¥çº¿ç¨‹ã€‚ä¸€ä¸ªçº¿ç¨‹åœ¨ 50 ms çš„æ—¶é—´ç‰‡å†…ï¼Œ5 ms ä¹‹åè¢«é˜»å¡ï¼Œåœ¨ 30 ms çš„æ—¶é—´ç‰‡ä¸­ï¼Œçº¿ç¨‹çš„é¡ºåºä¼šæ˜¯ A1, B1, A2, B2, A3, B3ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200923154416.png" srcset="/img/loading.gif" alt="" /></p><p>ç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ä¹‹é—´çš„ä¸»è¦å·®åˆ«åœ¨äº<code>æ€§èƒ½</code>ã€‚<strong>ç”¨æˆ·çº§çº¿ç¨‹çš„åˆ‡æ¢éœ€è¦å°‘é‡çš„æœºå™¨æŒ‡ä»¤ï¼Œè€Œå†…æ ¸çº¿ç¨‹éœ€è¦å®Œæ•´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ï¼Œä¿®æ”¹å†…å­˜æ˜ åƒï¼Œä½¿é«˜é€Ÿç¼“å­˜å¤±æ•ˆï¼Œè¿™ä¼šå¯¼è‡´äº†è‹¥å¹²æ•°é‡çº§çš„å»¶è¿Ÿã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨ä½¿ç”¨å†…æ ¸çº§çº¿ç¨‹æ—¶ï¼Œä¸€æ—¦çº¿ç¨‹é˜»å¡åœ¨ <code>I/O</code> ä¸Šå°±ä¸éœ€è¦åœ¨ç”¨æˆ·çº§çº¿ç¨‹ä¸­é‚£æ ·å°†æ•´ä¸ªè¿›ç¨‹æŒ‚èµ·ã€‚</p><p>ä»è¿›ç¨‹ A çš„ä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°è¿›ç¨‹ B çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶æ¶ˆè€—è¦è¿œé«˜äºè¿è¡Œè¿›ç¨‹ A çš„ä¸¤ä¸ªçº¿ç¨‹ï¼ˆæ¶‰åŠä¿®æ”¹å†…å­˜æ˜ åƒï¼Œä¿®æ”¹é«˜é€Ÿç¼“å­˜ï¼‰ï¼Œå†…æ ¸å¯¹è¿™ç§åˆ‡æ¢çš„æ¶ˆè€—æ˜¯äº†è§£åˆ°ï¼Œå¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯ä½œå‡ºå†³å®šã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</title>
    <link href="/2020/09/20/LeetCode-88-merge-sorted-array/"/>
    <url>/2020/09/20/LeetCode-88-merge-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/merge-sorted-array/" target="_blank" rel="noopener">88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span>[] nums2, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> k = m + n - <span class="hljs-number">1</span>;    m--;    n--;    <span class="hljs-keyword">while</span> (m &gt;= <span class="hljs-number">0</span> &amp;&amp; n &gt;= <span class="hljs-number">0</span>) &#123;        nums1[k--] = nums1[m] &gt; nums2[n] ? nums1[m--] : nums2[n--];    &#125;    <span class="hljs-keyword">while</span> (n &gt;= <span class="hljs-number">0</span>) &#123;        nums1[k--] = nums2[n--];    &#125;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span>[] nums2, <span class="hljs-keyword">int</span> n)</span> </span>&#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;            nums1[m++] = nums2[i];        &#125;        Arrays.sort(nums1);    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 66. åŠ ä¸€</title>
    <link href="/2020/09/19/LeetCode-66-plus-one/"/>
    <url>/2020/09/19/LeetCode-66-plus-one/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/plus-one/" target="_blank" rel="noopener">66. åŠ ä¸€</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] plusOne(<span class="hljs-keyword">int</span>[] digits) &#123;    <span class="hljs-keyword">int</span> len = digits.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        digits[i]++;        <span class="hljs-comment">// è¶…è¿‡ 10ï¼Œåˆ™å¯¹ 10 å–ä½™ï¼Œä¸‹ä¸€ä½è¿›ä½</span>        <span class="hljs-keyword">if</span> (digits[i] &gt;= <span class="hljs-number">10</span>) &#123;            digits[i] = digits[i] % <span class="hljs-number">10</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// ä¸è¶…è¿‡ 10ï¼Œè¿”å›ç»“æœ</span>            <span class="hljs-keyword">return</span> digits;        &#125;    &#125;    <span class="hljs-comment">// ç¬¬ä¸€ä½ä¹Ÿè¶…è¿‡ 10ï¼Œåˆ™é•¿åº¦ + 1ï¼Œå¦‚ 999</span>    <span class="hljs-keyword">int</span>[] newDigits = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len + <span class="hljs-number">1</span>];    newDigits[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;    <span class="hljs-keyword">return</span> newDigits;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 27. ç§»é™¤å…ƒç´ </title>
    <link href="/2020/09/18/LeetCode-27-remove-element/"/>
    <url>/2020/09/18/LeetCode-27-remove-element/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-element/" target="_blank" rel="noopener">27. ç§»é™¤å…ƒç´ </a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">removeElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> val)</span> </span>&#123;    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; len) &#123;        <span class="hljs-keyword">if</span> (nums[i] != val) &#123;            nums[j++] = nums[i];        &#125;        i++;    &#125;    <span class="hljs-keyword">return</span> j;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 26. åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</title>
    <link href="/2020/09/18/LeetCode-26-remove-duplicates-from-sorted-array/"/>
    <url>/2020/09/18/LeetCode-26-remove-duplicates-from-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/" target="_blank" rel="noopener">26. åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">removeDuplicates</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, j = <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (i &lt; len) &#123;        <span class="hljs-keyword">if</span> (nums[i] == nums[i - <span class="hljs-number">1</span>]) &#123;            i++;        &#125; <span class="hljs-keyword">else</span> &#123;            nums[j++] = nums[i++];        &#125;    &#125;    <span class="hljs-keyword">return</span> j;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°</title>
    <link href="/2020/09/17/LeetCode-315-count-of-smaller-numbers-after-self/"/>
    <url>/2020/09/17/LeetCode-315-count-of-smaller-numbers-after-self/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/count-of-smaller-numbers-after-self/" target="_blank" rel="noopener">315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°</a></p><p>åˆ©ç”¨ç´¢å¼•æ•°ç»„ï¼Œå¯¹ç´¢å¼•æ•°ç»„æ’åºï¼Œå°±å¯æ ¹æ®ç´¢å¼•ä¿å­˜å¯¹åº”ä½ç½®çš„é€†åºæ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">countSmaller</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> list;    &#125;    <span class="hljs-comment">// ç´¢å¼•æ•°ç»„</span>    <span class="hljs-keyword">int</span>[] indexes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// ä¿å­˜æ¯ä¸ªä½ç½®çš„é€†åºæ•°</span>    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        indexes[i] = i;    &#125;    mergeSort(indexes, nums, res, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> count : res) &#123;        list.add(count);    &#125;    <span class="hljs-keyword">return</span> list;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mergeSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] indexes, <span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span>[] res, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">if</span> (left &gt;= right) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;    mergeSort(indexes, nums, res, left, mid);    mergeSort(indexes, nums, res, mid + <span class="hljs-number">1</span>, right);    <span class="hljs-keyword">if</span> (nums[indexes[mid]] &lt;= nums[indexes[mid + <span class="hljs-number">1</span>]]) &#123;        <span class="hljs-keyword">return</span>;    &#125;    mergeAndCountSmaller(indexes, nums, res, left, mid, right);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mergeAndCountSmaller</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] indexes, <span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span>[] res, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = right - left + <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span> i = left, j = mid + <span class="hljs-number">1</span>, k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= right) &#123;        <span class="hljs-comment">// æ¯”è¾ƒç´¢å¼•å¯¹åº”ä½ç½®ä¸Šçš„æ•°</span>        <span class="hljs-keyword">if</span> (nums[indexes[i]] &lt;= nums[indexes[j]]) &#123;            <span class="hljs-comment">// æ›´æ–°æ¯” nums[idx[i]] å°çš„æ•°</span>            res[indexes[i]] += j - mid - <span class="hljs-number">1</span>;            tmp[k++] = indexes[i++];        &#125; <span class="hljs-keyword">else</span> &#123;            tmp[k++] = indexes[j++];        &#125;    &#125;    <span class="hljs-comment">// åˆå¹¶å‰©ä¸‹çš„æ•°</span>    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        <span class="hljs-comment">// å·¦è¾¹è¿˜æœ‰å‰©ä½™ï¼Œè¯´æ˜å³è¾¹æ¯”å®ƒå°çš„éƒ½å·²ç»å½’å¹¶å›å»äº†</span>        res[indexes[i]] += j - mid - <span class="hljs-number">1</span>;        tmp[k++] = indexes[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= right) &#123;        tmp[k++] = indexes[j++];    &#125;    System.arraycopy(tmp, <span class="hljs-number">0</span>, indexes, left, len);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 442. æ•°ç»„ä¸­é‡å¤çš„æ•°æ®</title>
    <link href="/2020/09/16/LeetCode-442-find-all-duplicates-in-an-array/"/>
    <url>/2020/09/16/LeetCode-442-find-all-duplicates-in-an-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-all-duplicates-in-an-array/" target="_blank" rel="noopener">442. æ•°ç»„ä¸­é‡å¤çš„æ•°æ®</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">findDuplicates</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">while</span> (nums[i] != nums[nums[i] - <span class="hljs-number">1</span>]) &#123;            swap(nums, i, nums[i] - <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] != i + <span class="hljs-number">1</span>) &#123;            res.add(nums[i]);        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = nums[i];    nums[i] = nums[j];    nums[j] = t;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 448. æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—</title>
    <link href="/2020/09/16/LeetCode-448-find-all-numbers-disappeared-in-an-array/"/>
    <url>/2020/09/16/LeetCode-448-find-all-numbers-disappeared-in-an-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-all-numbers-disappeared-in-an-array/" target="_blank" rel="noopener">448. æ‰¾åˆ°æ‰€æœ‰æ•°ç»„ä¸­æ¶ˆå¤±çš„æ•°å­—</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">findDisappearedNumbers</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span> &lt;= nums[i] &amp;&amp; nums[i] &lt;= len &amp;&amp; nums[i] != nums[nums[i] - <span class="hljs-number">1</span>]) &#123;            swap(nums, i, nums[i] - <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] != i + <span class="hljs-number">1</span>) &#123;            res.add(i + <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = nums[i];    nums[i] = nums[j];    nums[j] = t;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</title>
    <link href="/2020/09/16/LeetCode-41-first-missing-positive/"/>
    <url>/2020/09/16/LeetCode-41-first-missing-positive/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/first-missing-positive/" target="_blank" rel="noopener">41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</a></p><h1 id="å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#å“ˆå¸Œ"></a> å“ˆå¸Œ</h1><p>ç©ºé—´ä¸ç¬¦åˆ</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">firstMissingPositive</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        map.put(num, <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len + <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-keyword">if</span> (!map.containsKey(i)) &#123;            <span class="hljs-keyword">return</span> i;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><p>æ—¶é—´ä¸ç¬¦åˆ</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">firstMissingPositive</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    quickSort(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len; i++) &#123;        <span class="hljs-keyword">int</span> pos = binarySearch(i, nums);        <span class="hljs-keyword">if</span> (pos == -<span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> i;        &#125;    &#125;    <span class="hljs-keyword">return</span> len + <span class="hljs-number">1</span>;&#125;</code></pre><h1 id="åŸåœ°å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#åŸåœ°å“ˆå¸Œ"></a> åŸåœ°å“ˆå¸Œ</h1><p>ç¬¬ i ä¸ªä½ç½®å­˜æ”¾çš„æ•° = i + 1</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">firstMissingPositive</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// nums[i] = i + 1</span>        <span class="hljs-comment">// æœªå‡ºç°çš„æ•°ä¸€å®šåœ¨ [1, len + 1]</span>        <span class="hljs-keyword">while</span> (nums[i] &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] &lt;= len &amp;&amp; nums[i] != nums[nums[i] - <span class="hljs-number">1</span>]) &#123;            swap(nums, i, nums[i] - <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-comment">// å½“ ç¬¬ i ä¸ªä½ç½®ä¸Šçš„æ•°ä¸æ˜¯ i + 1 æ—¶ï¼Œè¯´æ˜ i + 1 æ²¡æœ‰å‡ºç°è¿‡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] != i + <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> len + <span class="hljs-number">1</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = nums[i];    nums[i] = nums[j];    nums[j] = t;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ“ä½œç³»ç»Ÿæ€»è§ˆ</title>
    <link href="/2020/09/16/os-overview/"/>
    <url>/2020/09/16/os-overview/</url>
    
    <content type="html"><![CDATA[<h1 id="æ“ä½œç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#æ“ä½œç³»ç»Ÿ"></a> æ“ä½œç³»ç»Ÿ</h1><h2 id="ç»„æˆ"><a class="markdownIt-Anchor" href="#ç»„æˆ"></a> ç»„æˆ</h2><p>ç°ä»£è®¡ç®—æœºç³»ç»Ÿç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¤„ç†å™¨ã€ä¸»å­˜ã€æ‰“å°æœºã€é”®ç›˜ã€é¼ æ ‡ã€æ˜¾ç¤ºå™¨ã€ç½‘ç»œæ¥å£ä»¥åŠå„ç§è¾“å…¥/è¾“å‡ºè®¾å¤‡æ„æˆã€‚</p><p>ç„¶è€Œï¼Œç¨‹åºå‘˜ä¸ä¼šç›´æ¥å’Œè¿™äº›ç¡¬ä»¶æ‰“äº¤é“ï¼Œåœ¨ç¡¬ä»¶çš„åŸºç¡€ä¹‹ä¸Šï¼Œè®¡ç®—æœºå®‰è£…äº†ä¸€å±‚è½¯ä»¶ï¼Œè¿™å±‚è½¯ä»¶èƒ½å¤Ÿé€šè¿‡å“åº”ç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤è¾¾åˆ°æ§åˆ¶ç¡¬ä»¶çš„æ•ˆæœï¼Œä»è€Œæ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼Œè¿™ç§è½¯ä»¶ç§°ä¹‹ä¸º <code>æ“ä½œç³»ç»Ÿ</code>ï¼Œå®ƒçš„ä»»åŠ¡å°±æ˜¯ä¸ºç”¨æˆ·ç¨‹åºæä¾›ä¸€ä¸ªæ›´å¥½ã€æ›´ç®€å•ã€æ›´æ¸…æ™°çš„è®¡ç®—æœºæ¨¡å‹ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916142646.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ç”¨æˆ·æ€å’Œå†…æ ¸æ€"><a class="markdownIt-Anchor" href="#ç”¨æˆ·æ€å’Œå†…æ ¸æ€"></a> ç”¨æˆ·æ€å’Œå†…æ ¸æ€</h2><p>å¤§éƒ¨åˆ†è®¡ç®—æœºæœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š<code>å†…æ ¸æ€</code> å’Œ <code>ç”¨æˆ·æ€</code>ï¼Œ</p><ul><li>è½¯ä»¶ä¸­æœ€åŸºç¡€çš„éƒ¨åˆ†æ˜¯æ“ä½œç³»ç»Ÿï¼Œå®ƒè¿è¡Œåœ¨ <code>å†…æ ¸æ€</code> ä¸­ï¼Œå†…æ ¸æ€ä¹Ÿç§°ä¸º <code>ç®¡æ€</code> å’Œ <code>æ ¸å¿ƒæ€</code>ï¼Œå®ƒä»¬éƒ½æ˜¯æ“ä½œç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€ï¼Œåªä¸è¿‡æ˜¯ä¸åŒçš„å«æ³•è€Œå·²ã€‚æ“ä½œç³»ç»Ÿå…·æœ‰ç¡¬ä»¶çš„è®¿é—®æƒï¼Œå¯ä»¥æ‰§è¡Œæœºå™¨èƒ½å¤Ÿè¿è¡Œçš„ä»»ä½•æŒ‡ä»¤ã€‚è½¯ä»¶çš„å…¶ä½™éƒ¨åˆ†è¿è¡Œåœ¨ <code>ç”¨æˆ·æ€</code> ä¸‹ã€‚</li><li>ç”¨æˆ·æ¥å£ç¨‹åº(<code>shell</code> æˆ–è€… <code>GUI</code>)å¤„äº<code>ç”¨æˆ·æ€</code>ä¸­ï¼Œå¹¶ä¸”å®ƒä»¬ä½äºç”¨æˆ·æ€çš„æœ€ä½å±‚ï¼Œå…è®¸ç”¨æˆ·è¿è¡Œå…¶ä»–ç¨‹åºï¼Œä¾‹å¦‚ Web æµè§ˆå™¨ã€ç”µå­é‚®ä»¶é˜…è¯»å™¨ã€éŸ³ä¹æ’­æ”¾å™¨ç­‰ã€‚è€Œä¸”ï¼Œè¶Šé è¿‘ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºè¶Šå®¹æ˜“ç¼–å†™ã€‚</li></ul><h1 id="è®¡ç®—æœºç¡¬ä»¶ç®€ä»‹"><a class="markdownIt-Anchor" href="#è®¡ç®—æœºç¡¬ä»¶ç®€ä»‹"></a> è®¡ç®—æœºç¡¬ä»¶ç®€ä»‹</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916143656.png" srcset="/img/loading.gif" alt="" /></p><p>ä»æ¦‚å¿µä¸Šæ¥çœ‹ï¼Œä¸€å°ç®€å•çš„ä¸ªäººç”µè„‘å¯ä»¥è¢«æŠ½è±¡ä¸ºä¸Šé¢è¿™ç§ç›¸ä¼¼çš„æ¨¡å‹ï¼ŒCPUã€å†…å­˜ã€I/O è®¾å¤‡éƒ½å’Œæ€»çº¿ä¸²è”èµ·æ¥å¹¶é€šè¿‡æ€»çº¿ä¸å…¶ä»–è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚</p><h2 id="cpu"><a class="markdownIt-Anchor" href="#cpu"></a> CPU</h2><p>CPU ä¸»è¦å’Œå†…å­˜è¿›è¡Œäº¤äº’ï¼Œä»å†…å­˜ä¸­æå–æŒ‡ä»¤å¹¶æ‰§è¡Œå®ƒã€‚ä¸€ä¸ª CPU çš„æ‰§è¡Œå‘¨æœŸæ˜¯ä»å†…å­˜ä¸­æå–ç¬¬ä¸€æ¡æŒ‡ä»¤ã€è§£ç å¹¶å†³å®šå®ƒçš„ç±»å‹å’Œæ“ä½œæ•°ï¼Œæ‰§è¡Œï¼Œç„¶åå†æå–ã€è§£ç æ‰§è¡Œåç»­çš„æŒ‡ä»¤ã€‚é‡å¤è¯¥å¾ªç¯ç›´åˆ°ç¨‹åºè¿è¡Œå®Œæ¯•ã€‚</p><ul><li>ç¨‹åºè®¡æ•°å™¨ (<code>Program Counter</code>): æ˜¯ CPU çš„æ ¸å¿ƒï¼Œåœ¨ä»»ä½•æ—¶åˆ»ï¼Œ<strong>PC éƒ½æŒ‡å‘ä¸»å­˜ä¸­çš„æŸæ¡æœºå™¨è¯­è¨€æŒ‡ä»¤ã€‚</strong></li><li>å †æ ˆæŒ‡é’ˆ (<code>stack pointer</code>): å®ƒæŒ‡å‘å†…å­˜ä¸­å½“å‰æ ˆçš„é¡¶ç«¯ã€‚å †æ ˆæŒ‡é’ˆä¼šåŒ…å«è¾“å…¥è¿‡ç¨‹ä¸­çš„æœ‰å…³å‚æ•°ã€å±€éƒ¨å˜é‡ä»¥åŠæ²¡æœ‰ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­çš„ä¸´æ—¶å˜é‡ã€‚</li><li>ç¨‹åºçŠ¶æ€å­—å¯„å­˜å™¨ (<code>Program Status Word</code>): <strong>å®ƒä¼šè·Ÿè¸ªå½“å‰ç³»ç»Ÿçš„çŠ¶æ€</strong>ã€‚é™¤éå‘ç”Ÿç³»ç»Ÿç»“æŸï¼Œå¦åˆ™æˆ‘ä»¬å¯ä»¥å¿½ç•¥ PSW ã€‚ç”¨æˆ·ç¨‹åºé€šå¸¸å¯ä»¥è¯»å–æ•´ä¸ªPSWï¼Œä½†é€šå¸¸åªèƒ½å†™å…¥å…¶æŸäº›å­—æ®µã€‚PSW åœ¨ç³»ç»Ÿè°ƒç”¨å’Œ I/O ä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚</li></ul><h2 id="å†…å­˜"><a class="markdownIt-Anchor" href="#å†…å­˜"></a> å†…å­˜</h2><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œå†…å­˜åº”è¯¥éå¸¸å¿«é€Ÿ(æ¯”æ‰§è¡Œä¸€æ¡æŒ‡ä»¤è¦å¿«ï¼Œä»è€Œä¸ä¼šæ‹–æ…¢ CPU æ‰§è¡Œæ•ˆç‡)ï¼Œè€Œä¸”è¶³å¤Ÿå¤§ä¸”ä¾¿å®œï¼Œä½†æ˜¯ç›®å‰çš„æŠ€æœ¯æ‰‹æ®µæ— æ³•æ»¡è¶³ä¸‰è€…çš„éœ€æ±‚ã€‚äºæ˜¯é‡‡ç”¨äº†ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œå­˜å‚¨å™¨ç³»ç»Ÿé‡‡ç”¨ä¸€ç§åˆ†å±‚æ¬¡çš„ç»“æ„<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916144656.png" srcset="/img/loading.gif" alt="" /><br />é¡¶å±‚çš„å­˜å‚¨å™¨é€Ÿåº¦æœ€é«˜ï¼Œä½†æ˜¯å®¹é‡æœ€å°ï¼Œæˆæœ¬éå¸¸é«˜ï¼Œå±‚çº§ç»“æ„è¶Šå‘ä¸‹ï¼Œå…¶è®¿é—®æ•ˆç‡è¶Šæ…¢ï¼Œå®¹é‡è¶Šå¤§ï¼Œä½†æ˜¯é€ ä»·ä¹Ÿå°±è¶Šä¾¿å®œã€‚</p><h3 id="å¯„å­˜å™¨"><a class="markdownIt-Anchor" href="#å¯„å­˜å™¨"></a> å¯„å­˜å™¨</h3><p>å­˜å‚¨å™¨çš„é¡¶å±‚æ˜¯ CPU ä¸­çš„å¯„å­˜å™¨ï¼Œå®ƒä»¬ç”¨å’Œ CPU ä¸€æ ·çš„ææ–™åˆ¶æˆï¼Œæ‰€ä»¥å’Œ CPU ä¸€æ ·å¿«ã€‚ç¨‹åºå¿…é¡»åœ¨è½¯ä»¶ä¸­è‡ªè¡Œç®¡ç†è¿™äº›å¯„å­˜å™¨ï¼ˆå³å†³å®šå¦‚ä½•ä½¿ç”¨å®ƒä»¬ï¼‰</p><h3 id="é«˜é€Ÿç¼“å­˜"><a class="markdownIt-Anchor" href="#é«˜é€Ÿç¼“å­˜"></a> é«˜é€Ÿç¼“å­˜</h3><p>ä½äºå¯„å­˜å™¨ä¸‹é¢çš„æ˜¯é«˜é€Ÿç¼“å­˜ï¼Œå®ƒå¤šæ•°ç”±ç¡¬ä»¶æ§åˆ¶ã€‚ä¸»å­˜è¢«åˆ†å‰²æˆé«˜é€Ÿç¼“å­˜è¡Œ(<code>cache lines</code>)ã€‚</p><p>ä½¿ç”¨æœ€é¢‘ç¹çš„é«˜é€Ÿç¼“å­˜è¡Œä¿å­˜åœ¨ä½äº <code>CPU</code> å†…éƒ¨æˆ–éå¸¸é è¿‘ <code>CPU</code> çš„é«˜é€Ÿç¼“å­˜ä¸­ã€‚å½“åº”ç”¨ç¨‹åºéœ€è¦ä»å†…å­˜ä¸­è¯»å–å…³é”®è¯çš„æ—¶å€™ï¼Œé«˜é€Ÿç¼“å­˜çš„ç¡¬ä»¶ä¼šæ£€æŸ¥æ‰€éœ€è¦çš„é«˜é€Ÿç¼“å­˜è¡Œæ˜¯å¦åœ¨é«˜é€Ÿç¼“å­˜ä¸­ã€‚å¦‚æœåœ¨çš„è¯ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯é«˜é€Ÿç¼“å­˜å‘½ä¸­(<code>cache hit</code>)ã€‚</p><p>é«˜é€Ÿç¼“å­˜å‘½ä¸­é€šå¸¸éœ€è¦èŠ±è´¹ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚ç¼“å­˜æœªå‘½ä¸­éœ€è¦ä»å†…å­˜ä¸­æå–ï¼Œè¿™ä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚é«˜é€Ÿç¼“å­˜è¡Œä¼šé™åˆ¶å®¹é‡çš„å¤§å°å› ä¸ºå®ƒçš„é€ ä»·éå¸¸æ˜‚è´µã€‚æœ‰ä¸€äº›æœºå™¨ä¼šæœ‰ä¸¤ä¸ªæˆ–è€…ä¸‰ä¸ªé«˜é€Ÿç¼“å­˜çº§åˆ«ï¼Œæ¯ä¸€çº§é«˜é€Ÿç¼“å­˜æ¯”å‰ä¸€çº§æ…¢ä¸”å®¹é‡æ›´å¤§ã€‚</p><p>ç°ä»£ <code>CPU</code> è®¾è®¡äº†ä¸¤ç§ç¼“å­˜ã€‚ç¬¬ä¸€çº§ç¼“å­˜æˆ–è€…è¯´æ˜¯ <code>L1 cache</code> æ€»æ˜¯ä½äº CPU å†…éƒ¨ï¼Œç”¨æ¥å°†å·²è§£ç çš„æŒ‡ä»¤è°ƒå…¥ <code>CPU</code> çš„æ‰§è¡Œå¼•æ“ã€‚å…¸å‹çš„ <code>L1 cache</code> çš„å¤§å°ä¸º <code>16 KB</code>ã€‚<br />å¦å¤–ï¼Œå¾€å¾€è¿˜è®¾æœ‰äºŒçº§ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯ <code>L2 cache</code>ï¼Œç”¨æ¥å­˜æ”¾æœ€è¿‘ä½¿ç”¨è¿‡çš„å…³é”®å­—ï¼Œä¸€èˆ¬æ˜¯<code>å…†å­—èŠ‚</code>ä¸ºå•ä½ã€‚<code>L1 cache</code> å’Œ <code>L2 cache</code> æœ€å¤§çš„ä¸åŒåœ¨äºæ˜¯å¦å­˜åœ¨å»¶è¿Ÿã€‚è®¿é—® <code>L1 cache</code> æ²¡æœ‰ä»»ä½•çš„å»¶è¿Ÿï¼Œç„¶è€Œè®¿é—® L2 cache ä¼šæœ‰ 1 - 2 ä¸ªæ—¶é’Ÿå‘¨æœŸçš„å»¶åã€‚</p><h3 id="ä¸»å­˜"><a class="markdownIt-Anchor" href="#ä¸»å­˜"></a> ä¸»å­˜</h3><p>åœ¨ä¸Šé¢çš„å±‚æ¬¡ç»“æ„ä¸­å†ä¸‹ä¸€å±‚æ˜¯ä¸»å­˜ï¼Œè¿™æ˜¯å†…å­˜ç³»ç»Ÿçš„ä¸»åŠ›å†›ï¼Œä¸»å­˜é€šå¸¸å«åš <code>RAM</code>(<code>Random Access Memory</code>)ã€‚æ‰€æœ‰ä¸èƒ½åœ¨é«˜é€Ÿç¼“å­˜ä¸­å¾—åˆ°æ»¡è¶³çš„å†…å­˜è®¿é—®è¯·æ±‚éƒ½ä¼šè½¬å¾€ä¸»å­˜ä¸­ã€‚</p><p>ä¸»å­˜æ˜¯ä¸€ä¸ªä¸´æ—¶å­˜å‚¨è®¾å¤‡ï¼Œåœ¨å¤„ç†å™¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œç”¨æ¥å­˜æ”¾ç¨‹åºå’Œç¨‹åºå¤„ç†çš„æ•°æ®ã€‚</p><ul><li>ä»ç‰©ç†ä¸Šæ¥è¯´ï¼Œä¸»å­˜æ˜¯ç”±ä¸€ç»„<code>åŠ¨æ€éšæœºå­˜å–å­˜å‚¨å™¨</code>ï¼ˆ<code>DRAM</code>ï¼‰èŠ¯ç‰‡ç»„æˆçš„ã€‚</li><li>ä»é€»è¾‘ä¸Šæ¥è¯´ï¼Œå­˜å‚¨å™¨æ˜¯ä¸€ä¸ªçº¿æ€§çš„å­—èŠ‚æ•°ç»„ï¼Œæ¯ä¸ªå­—èŠ‚éƒ½æœ‰å…¶å”¯ä¸€çš„åœ°å€ï¼ˆå³æ•°ç»„ç´¢å¼•ï¼‰ã€‚</li></ul><h3 id="ç£ç›˜"><a class="markdownIt-Anchor" href="#ç£ç›˜"></a> ç£ç›˜</h3><p>ä¸‹ä¸€ä¸ªå±‚æ¬¡æ˜¯ç£ç›˜(ç¡¬ç›˜)ï¼Œç£ç›˜åŒ RAM ç›¸æ¯”ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶ä½çš„æˆæœ¬ä½äº†ä¸¤ä¸ªæ•°é‡çº§ï¼Œè€Œä¸”ç»å¸¸ä¹Ÿæœ‰ä¸¤ä¸ªæ•°é‡çº§å¤§çš„å®¹é‡ã€‚ç£ç›˜å”¯ä¸€çš„é—®é¢˜æ˜¯éšæœºè®¿é—®æ•°æ®æ—¶é—´å¤§çº¦æ…¢äº†ä¸‰ä¸ªæ•°é‡çº§ã€‚ç£ç›˜è®¿é—®æ…¢çš„åŸå› æ˜¯å› ä¸ºç£ç›˜çš„æ„é€ ä¸åŒã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916150003.png" srcset="/img/loading.gif" alt="" /></p><blockquote><p>éœ€è¦æ³¨æ„ï¼Œå›ºæ€ç¡¬ç›˜(Solid State Disk, SSD)ä¸æ˜¯ç£ç›˜ï¼Œå›ºæ€ç¡¬ç›˜å¹¶æ²¡æœ‰å¯ä»¥ç§»åŠ¨çš„éƒ¨åˆ†ï¼Œå¤–å½¢ä¹Ÿä¸åƒå”±ç‰‡ï¼Œå¹¶ä¸”æ•°æ®æ˜¯å­˜å‚¨åœ¨å­˜å‚¨å™¨ï¼ˆé—ªå­˜ï¼‰ä¸­ï¼Œä¸ç£ç›˜å”¯ä¸€çš„ç›¸ä¼¼ä¹‹å¤„å°±æ˜¯å®ƒä¹Ÿå­˜å‚¨äº†å¤§é‡å³ä½¿åœ¨ç”µæºå…³é—­ä¹Ÿä¸ä¼šä¸¢å¤±çš„æ•°æ®ã€‚</p></blockquote><p>è®¸å¤šè®¡ç®—æœºæ”¯æŒä¸€ç§è‘—åçš„<strong>è™šæ‹Ÿå†…å­˜</strong>æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶ä½¿å¾—æœŸæœ›è¿è¡Œçš„å­˜å‚¨ç©ºé—´å¤§äºå®é™…çš„ç‰©ç†å­˜å‚¨ç©ºé—´ã€‚å…¶æ–¹æ³•æ˜¯å°†ç¨‹åºæ”¾åœ¨ç£ç›˜ä¸Šï¼Œè€Œå°†ä¸»å­˜ä½œä¸ºä¸€éƒ¨åˆ†ç¼“å­˜ï¼Œç”¨æ¥ä¿å­˜æœ€é¢‘ç¹ä½¿ç”¨çš„éƒ¨åˆ†ç¨‹åºï¼Œè¿™ç§æœºåˆ¶éœ€è¦å¿«é€Ÿæ˜ åƒå†…å­˜åœ°å€ï¼Œç”¨æ¥æŠŠç¨‹åºç”Ÿæˆçš„åœ°å€è½¬æ¢ä¸ºæœ‰å…³å­—èŠ‚åœ¨ <code>RAM</code> ä¸­çš„ç‰©ç†åœ°å€ã€‚è¿™ç§æ˜ åƒç”± <code>CPU</code> ä¸­çš„ä¸€ä¸ªç§°ä¸º <strong>å­˜å‚¨å™¨ç®¡ç†å•å…ƒ</strong>(<code>Memory Management Unit</code>, <code>MMU</code>) çš„éƒ¨ä»¶æ¥å®Œæˆã€‚</p><p>ç¼“å­˜å’Œ <code>MMU</code> çš„å‡ºç°æ˜¯å¯¹ç³»ç»Ÿçš„æ€§èƒ½æœ‰å¾ˆé‡è¦çš„å½±å“ï¼Œåœ¨å¤šé“ç¨‹åºç³»ç»Ÿä¸­ï¼Œä»ä¸€ä¸ªç¨‹åºåˆ‡æ¢åˆ°å¦ä¸€ä¸ªç¨‹åºçš„æœºåˆ¶ç§°ä¸º <strong>ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>(<code>context switch</code>)ï¼Œå¯¹æ¥è‡ªç¼“å­˜ä¸­çš„èµ„æºè¿›è¡Œä¿®æ”¹å¹¶æŠŠå…¶å†™å›ç£ç›˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><h2 id="io-è®¾å¤‡"><a class="markdownIt-Anchor" href="#io-è®¾å¤‡"></a> I/O è®¾å¤‡</h2><p>I/O è®¾å¤‡ä¸€èˆ¬åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>è®¾å¤‡æ§åˆ¶å™¨</strong>å’Œ<strong>è®¾å¤‡</strong>æœ¬èº«ã€‚</p><ul><li>æ§åˆ¶å™¨æœ¬èº«æ˜¯ä¸€å—èŠ¯ç‰‡æˆ–è€…ä¸€ç»„èŠ¯ç‰‡ï¼Œå®ƒèƒ½å¤Ÿæ§åˆ¶ç‰©ç†è®¾å¤‡ã€‚<br />æ§åˆ¶å™¨çš„å·¥ä½œå°±æ˜¯æ¥æ”¶æ“ä½œç³»ç»Ÿçš„æŒ‡ä»¤ï¼Œä¸ºæ“ä½œç³»ç»Ÿæä¾›ä¸€ä¸ªæ›´ç®€å•çš„æ¥å£ã€‚ä¹Ÿå°±æ˜¯å±è”½ç‰©ç†ç»†èŠ‚ã€‚</li><li>è®¾å¤‡æœ¬èº«æœ‰ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ¥å£ã€‚</li></ul><p>æ¯ç§ç±»å‹çš„è®¾å¤‡æ§åˆ¶å™¨éƒ½æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥éœ€è¦ä¸åŒçš„è½¯ä»¶è¿›è¡Œæ§åˆ¶ã€‚ä¸“é—¨ä¸æ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯äº¤æµï¼Œå‘å‡ºå‘½ä»¤å¤„ç†æŒ‡ä»¤æ¥æ”¶å“åº”çš„è½¯ä»¶ï¼Œç§°ä¸º <strong>è®¾å¤‡é©±åŠ¨ç¨‹åº</strong>(<code>device driver</code>)ã€‚ æ¯ä¸ªæ§åˆ¶å™¨å‚å®¶éƒ½åº”è¯¥é’ˆå¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿæä¾›ä¸åŒçš„è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚</p><p>ä¸ºäº†ä½¿è®¾å¤‡é©±åŠ¨ç¨‹åºèƒ½å¤Ÿå·¥ä½œï¼Œå¿…é¡»æŠŠå®ƒå®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿™æ ·èƒ½å¤Ÿä½¿å®ƒåœ¨å†…æ ¸æ€ä¸­è¿è¡Œã€‚<br />è¦å°†è®¾å¤‡é©±åŠ¨ç¨‹åºè£…å…¥æ“ä½œç³»ç»Ÿï¼Œä¸€èˆ¬æœ‰ä¸‰ä¸ªé€”å¾„ï¼š</p><ol><li>å°†å†…æ ¸ä¸è®¾å¤‡å¯åŠ¨ç¨‹åºé‡æ–°è¿æ¥ï¼Œç„¶åé‡å¯ç³»ç»Ÿã€‚è¿™æ˜¯ <code>UNIX</code> ç³»ç»Ÿé‡‡ç”¨çš„å·¥ä½œæ–¹å¼ã€‚</li><li>åœ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ–‡ä»¶ä¸­è®¾ç½®ä¸€ä¸ªå…¥å£ï¼Œé€šçŸ¥è¯¥æ–‡ä»¶éœ€è¦ä¸€ä¸ªè®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œç„¶åé‡æ–°å¯åŠ¨ç³»ç»Ÿã€‚åœ¨é‡å¯ç³»ç»Ÿæ—¶ï¼Œæ“ä½œç³»ç»Ÿå›å¯»æ‰¾æœ‰å…³çš„è®¾å¤‡å¯åŠ¨ç¨‹åºå¹¶æŠŠå®ƒè£…è½½ï¼Œè¿™æ˜¯ <code>Windows</code> é‡‡ç”¨çš„å·¥ä½œæ–¹å¼ã€‚</li><li>æ“ä½œç³»ç»Ÿèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶æ¥æ”¶æ–°çš„è®¾å¤‡é©±åŠ¨ç¨‹åºå¹¶ç«‹åˆ»å®‰è£…ï¼Œæ— éœ€é‡å¯æ“ä½œç³»ç»Ÿã€‚çƒ­æ’æ‹”è®¾å¤‡ï¼Œæ¯”å¦‚ <code>USB</code> éœ€è¦åŠ¨æ€å¯è£…è½½çš„è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚</li></ol><p>å®ç°è¾“å…¥å’Œè¾“å‡ºçš„æ–¹å¼æœ‰ä¸‰ç§ã€‚</p><ol><li><p>åœ¨æœ€ç®€å•çš„æ–¹å¼ä¸­ï¼Œç”¨æˆ·ç¨‹åºä¼šå‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œå†…æ ¸ä¼šå°†å…¶è½¬æ¢ä¸ºç›¸åº”é©±åŠ¨ç¨‹åºçš„ç¨‹åºè°ƒç”¨ï¼Œç„¶åè®¾å¤‡é©±åŠ¨ç¨‹åºå¯åŠ¨ <code>I/O</code> å¹¶å¾ªç¯æ£€æŸ¥è¯¥è®¾å¤‡ï¼Œçœ‹è¯¥è®¾å¤‡æ˜¯å¦å®Œæˆäº†å·¥ä½œï¼ˆä¸€èˆ¬ä¼šæœ‰ä¸€äº›äºŒè¿›åˆ¶ä½ç”¨æ¥æŒ‡ç¤ºè®¾å¤‡ä»åœ¨å¿™ç¢Œä¸­ï¼‰ã€‚å½“ <code>I/O</code> è°ƒç”¨å®Œæˆåï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºæŠŠæ•°æ®é€åˆ°æŒ‡å®šçš„åœ°æ–¹å¹¶è¿”å›ã€‚ç„¶åæ“ä½œç³»ç»Ÿä¼šå°†æ§åˆ¶æƒäº¤ç»™è°ƒç”¨è€…ã€‚è¿™ç§æ–¹å¼ç§°ä¸º <strong>å¿™ç­‰å¾…</strong>(<code>busy waiting</code>)ï¼Œè¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯è¦ä¸€ç›´å æ® <code>CPU</code>ï¼Œ<code>CPU</code> ä¼šä¸€ç›´è½®è¯¢ <code>I/O</code> è®¾å¤‡ç›´åˆ° <code>I/O</code> æ“ä½œå®Œæˆã€‚</p></li><li><p><strong>è®¾å¤‡é©±åŠ¨ç¨‹åºå¯åŠ¨è®¾å¤‡å¹¶ä¸”è®©è¯¥è®¾å¤‡åœ¨æ“ä½œå®Œæˆæ—¶å‘ç”Ÿä¸­æ–­</strong>ã€‚è®¾å¤‡é©±åŠ¨ç¨‹åºåœ¨è¿™ä¸ªæ—¶åˆ»è¿”å›ã€‚æ“ä½œç³»ç»Ÿæ¥ç€åœ¨éœ€è¦æ—¶é˜»å¡è°ƒç”¨è€…å¹¶å®‰æ’å…¶ä»–å·¥ä½œè¿›è¡Œã€‚å½“è®¾å¤‡é©±åŠ¨ç¨‹åºæ£€æµ‹åˆ°è¯¥è®¾å¤‡æ“ä½œå®Œæˆæ—¶ï¼Œå®ƒå‘å‡ºä¸€ä¸ª <strong>ä¸­æ–­</strong> é€šçŸ¥æ“ä½œå®Œæˆã€‚</p></li></ol><ul><li>ä½¿ç”¨ç‰¹æ®Šçš„ç¡¬ä»¶ï¼š<strong>ç›´æ¥å­˜å‚¨å™¨è®¿é—®</strong>(<code>Direct Memory Access</code>, <code>DMA</code>) èŠ¯ç‰‡ã€‚å®ƒå¯ä»¥æ§åˆ¶å†…å­˜å’ŒæŸäº›æ§åˆ¶å™¨ä¹‹é—´çš„ä½æµï¼Œè€Œæ— éœ€ <code>CPU</code> çš„å¹²é¢„ã€‚<code>CPU</code> ä¼šå¯¹ <code>DMA</code> èŠ¯ç‰‡è¿›è¡Œè®¾ç½®ï¼Œè¯´æ˜éœ€è¦ä¼ é€çš„å­—èŠ‚æ•°ï¼Œæœ‰å…³çš„è®¾å¤‡å’Œå†…å­˜åœ°å€ä»¥åŠæ“ä½œæ–¹å‘ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916153323.png" srcset="/img/loading.gif" alt="" /><br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916152741.png" srcset="/img/loading.gif" alt="" /></li></ul><p>å½“å¦ä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åºæ­£åœ¨è¿è¡Œæ—¶ï¼Œä¸­æ–­å¯èƒ½ï¼ˆå¹¶ä¸”ç»å¸¸ï¼‰å‘ç”Ÿåœ¨ä¸åˆå®œçš„æ—¶é—´ã€‚ å› æ­¤ï¼ŒCPU å¯ä»¥ç¦ç”¨ä¸­æ–­ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¹‹åé‡å¯ä¸­æ–­ã€‚<br />åœ¨ CPU å…³é—­ä¸­æ–­åï¼Œä»»ä½•å·²ç»å‘å‡ºä¸­æ–­çš„è®¾å¤‡ï¼Œå¯ä»¥ç»§ç»­ä¿æŒå…¶ä¸­æ–­ä¿¡å·å¤„ç†ï¼Œä½†æ˜¯ CPU ä¸ä¼šä¸­æ–­ï¼Œç›´è‡³ä¸­æ–­å†æ¬¡å¯ç”¨ä¸ºæ­¢ã€‚<br />å¦‚æœåœ¨å…³é—­ä¸­æ–­æ—¶ï¼Œå·²ç»æœ‰å¤šä¸ªè®¾å¤‡å‘å‡ºäº†ä¸­æ–­ä¿¡å·ï¼Œä¸­æ–­æ§åˆ¶å™¨å°†å†³å®šä¼˜å…ˆå¤„ç†å“ªä¸ªä¸­æ–­ï¼Œé€šå¸¸è¿™å–å†³äºäº‹å…ˆèµ‹äºˆæ¯ä¸ªè®¾å¤‡çš„ä¼˜å…ˆçº§ï¼Œæœ€é«˜ä¼˜å…ˆçº§çš„è®¾å¤‡ä¼˜å…ˆèµ¢å¾—ä¸­æ–­æƒï¼Œå…¶ä»–è®¾å¤‡åˆ™å¿…é¡»ç­‰å¾…ã€‚</p><h2 id="æ€»çº¿"><a class="markdownIt-Anchor" href="#æ€»çº¿"></a> æ€»çº¿</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916153432.png" srcset="/img/loading.gif" alt="" /><br />æ€»çº¿è´¯ç©¿æ•´ä¸ªç³»ç»Ÿï¼Œå®ƒæºå¸¦ä¿¡æ¯å­—èŠ‚å¹¶è´Ÿè´£åœ¨å„ä¸ªéƒ¨ä»¶é—´ä¼ é€’ã€‚</p><p>ä¸Šå›¾ä¸­çš„ x86 ç³»ç»ŸåŒ…å«å¾ˆå¤šæ€»çº¿ï¼Œé«˜é€Ÿç¼“å­˜ã€å†…å­˜ã€PCIeã€PCIã€USBã€SATA å’Œ DMIï¼Œæ¯æ¡æ€»çº¿éƒ½æœ‰ä¸åŒçš„ä¼ è¾“é€Ÿç‡å’ŒåŠŸèƒ½ã€‚æ“ä½œç³»ç»Ÿå¿…é¡»äº†è§£æ‰€æœ‰çš„æ€»çº¿é…ç½®å’Œç®¡ç†ã€‚å…¶ä¸­æœ€ä¸»è¦çš„æ€»çº¿æ˜¯ <code>PCIe</code>(<code>Peripheral Component Interconnect Express</code>) æ€»çº¿ã€‚</p><p><code>PCIe</code> é€‰ç”¨äº†ä¸²è¡Œæ€»çº¿æ¶æ„(<code>serial bus architecture</code>) ï¼Œå¹¶é€šè¿‡å•ä¸ªè¿æ¥ï¼ˆç§°ä¸ºé€šé“ï¼‰å‘é€æ¶ˆæ¯ä¸­çš„æ‰€æœ‰æ¯”ç‰¹æ•°æ®ï¼Œå°±åƒç½‘ç»œæ•°æ®åŒ…ä¸€æ ·ã€‚è¿™æ ·åšä¼šç®€åŒ–å¾ˆå¤šï¼Œå› ä¸ºä¸å†ç¡®ä¿æ‰€æœ‰ 32 ä½æ•°æ®åœ¨åŒä¸€æ—¶åˆ»å‡†ç¡®åˆ°è¾¾ç›¸åŒçš„ç›®çš„åœ°ã€‚é€šè¿‡å°†å¤šä¸ªæ•°æ®é€šè·¯å¹¶è¡Œèµ·æ¥ï¼Œå¹¶è¡Œæ€§ä»å¯ä»¥æœ‰æ•ˆåˆ©ç”¨ã€‚</p><h2 id="è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹"></a> è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹</h2><ul><li><p>ä¸€ã€<code>BIOS</code></p><ul><li>1.1 ç¡¬ä»¶è‡ªæ£€<br /><code>BIOS</code> ç¨‹åºé¦–å…ˆæ£€æŸ¥ï¼Œè®¡ç®—æœºç¡¬ä»¶èƒ½å¦æ»¡è¶³è¿è¡Œçš„åŸºæœ¬æ¡ä»¶ï¼Œè¿™å«åš&quot;ç¡¬ä»¶è‡ªæ£€&quot;ï¼ˆ<code>Power-On Self-Test</code>ï¼‰ï¼Œç¼©å†™ä¸º <code>POST</code>ã€‚<br />å¦‚æœç¡¬ä»¶å‡ºç°é—®é¢˜ï¼Œä¸»æ¿ä¼šå‘å‡ºä¸åŒå«ä¹‰çš„èœ‚é¸£ï¼Œå¯åŠ¨ä¸­æ­¢ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå±å¹•å°±ä¼šæ˜¾ç¤ºå‡ºCPUã€å†…å­˜ã€ç¡¬ç›˜ç­‰ä¿¡æ¯ã€‚</li><li>1.2 å¯åŠ¨é¡ºåº<br />ç¡¬ä»¶è‡ªæ£€å®Œæˆåï¼Œ<code>BIOS</code> æŠŠæ§åˆ¶æƒè½¬äº¤ç»™ä¸‹ä¸€é˜¶æ®µçš„å¯åŠ¨ç¨‹åºã€‚è¿™æ—¶ï¼Œ<code>BIOS</code> éœ€è¦çŸ¥é“ï¼Œâ€œä¸‹ä¸€é˜¶æ®µçš„å¯åŠ¨ç¨‹åº&quot;å…·ä½“å­˜æ”¾åœ¨å“ªä¸€ä¸ªè®¾å¤‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>BIOS</code> éœ€è¦æœ‰ä¸€ä¸ªå¤–éƒ¨å‚¨å­˜è®¾å¤‡çš„æ’åºï¼Œæ’åœ¨å‰é¢çš„è®¾å¤‡å°±æ˜¯ä¼˜å…ˆè½¬äº¤æ§åˆ¶æƒçš„è®¾å¤‡ã€‚è¿™ç§æ’åºå«åš&quot;å¯åŠ¨é¡ºåºâ€ï¼ˆ<code>Boot Sequence</code>ï¼‰ã€‚</li></ul></li><li><p>äºŒã€ä¸»å¼•å¯¼è®°å½•(<code>MBR</code>)<br /><code>BIOS</code> æŒ‰ç…§&quot;å¯åŠ¨é¡ºåº&quot;ï¼ŒæŠŠæ§åˆ¶æƒè½¬äº¤ç»™æ’åœ¨ç¬¬ä¸€ä½çš„å‚¨å­˜è®¾å¤‡ã€‚<br />è®¡ç®—æœºè¯»å–è¯¥è®¾å¤‡çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œä¹Ÿå°±æ˜¯è¯»å–æœ€å‰é¢çš„ <code>512</code> ä¸ªå­—èŠ‚ã€‚å¦‚æœè¿™ <code>512</code> ä¸ªå­—èŠ‚çš„æœ€åä¸¤ä¸ªå­—èŠ‚æ˜¯ <code>0x55</code> å’Œ <code>0xAA</code>ï¼Œè¡¨æ˜è¿™ä¸ªè®¾å¤‡å¯ä»¥ç”¨äºå¯åŠ¨ï¼›å¦‚æœä¸æ˜¯ï¼Œè¡¨æ˜è®¾å¤‡ä¸èƒ½ç”¨äºå¯åŠ¨ï¼Œæ§åˆ¶æƒäºæ˜¯è¢«è½¬äº¤ç»™&quot;å¯åŠ¨é¡ºåº&quot;ä¸­çš„ä¸‹ä¸€ä¸ªè®¾å¤‡ã€‚</p></li><li><p>ä¸‰ã€ç¡¬ç›˜å¯åŠ¨<br />è¿™æ—¶ï¼Œè®¡ç®—æœºçš„æ§åˆ¶æƒå°±è¦è½¬äº¤ç»™ç¡¬ç›˜çš„æŸä¸ªåˆ†åŒºäº†ï¼Œè¿™é‡Œåˆåˆ†æˆä¸‰ç§æƒ…å†µã€‚</p><ul><li>3.1 æƒ…å†µ Aï¼šå·å¼•å¯¼è®°å½•<br />&quot;å·å¼•å¯¼è®°å½•&quot;çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Œå‘Šè¯‰è®¡ç®—æœºï¼Œæ“ä½œç³»ç»Ÿåœ¨è¿™ä¸ªåˆ†åŒºé‡Œçš„ä½ç½®ã€‚ç„¶åï¼Œè®¡ç®—æœºå°±ä¼šåŠ è½½æ“ä½œç³»ç»Ÿäº†ã€‚</li><li>3.2 æƒ…å†µ Bï¼šæ‰©å±•åˆ†åŒºå’Œé€»è¾‘åˆ†åŒº<br />è®¡ç®—æœºå…ˆè¯»å–æ‰©å±•åˆ†åŒºçš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œå«åš&quot;æ‰©å±•å¼•å¯¼è®°å½•&quot;ï¼ˆ<code>Extended boot record</code>, <code>EBR</code>ï¼‰ã€‚å®ƒé‡Œé¢ä¹ŸåŒ…å«ä¸€å¼  64 å­—èŠ‚çš„åˆ†åŒºè¡¨ï¼Œä½†æ˜¯æœ€å¤šåªæœ‰ä¸¤é¡¹ï¼ˆä¹Ÿå°±æ˜¯ä¸¤ä¸ªé€»è¾‘åˆ†åŒºï¼‰ã€‚è®¡ç®—æœºæ¥ç€è¯»å–ç¬¬äºŒä¸ªé€»è¾‘åˆ†åŒºçš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œå†ä»é‡Œé¢çš„åˆ†åŒºè¡¨ä¸­æ‰¾åˆ°ç¬¬ä¸‰ä¸ªé€»è¾‘åˆ†åŒºçš„ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æŸä¸ªé€»è¾‘åˆ†åŒºçš„åˆ†åŒºè¡¨åªåŒ…å«å®ƒè‡ªèº«ä¸ºæ­¢ï¼ˆå³åªæœ‰ä¸€ä¸ªåˆ†åŒºé¡¹ï¼‰ã€‚å› æ­¤ï¼Œæ‰©å±•åˆ†åŒºå¯ä»¥åŒ…å«æ— æ•°ä¸ªé€»è¾‘åˆ†åŒºã€‚</li><li>3.3 æƒ…å†µ Cï¼šå¯åŠ¨ç®¡ç†å™¨åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®¡ç®—æœºè¯»å–&quot;ä¸»å¼•å¯¼è®°å½•&quot;å‰é¢ 446 å­—èŠ‚çš„æœºå™¨ç ä¹‹åï¼Œä¸å†æŠŠæ§åˆ¶æƒè½¬äº¤ç»™æŸä¸€ä¸ªåˆ†åŒºï¼Œè€Œæ˜¯è¿è¡Œäº‹å…ˆå®‰è£…çš„&quot;å¯åŠ¨ç®¡ç†å™¨&quot;ï¼ˆ<code>boot loader</code>ï¼‰ï¼Œç”±ç”¨æˆ·é€‰æ‹©å¯åŠ¨å“ªä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚</li></ul></li><li><p>å››ã€æ“ä½œç³»ç»Ÿ<br />æ§åˆ¶æƒè½¬äº¤ç»™æ“ä½œç³»ç»Ÿåï¼Œæ“ä½œç³»ç»Ÿçš„å†…æ ¸é¦–å…ˆè¢«è½½å…¥å†…å­˜ã€‚</p><ol><li>ä»¥ <code>Linux</code> ç³»ç»Ÿä¸ºä¾‹ï¼Œå…ˆè½½å…¥ <code>/boot</code> ç›®å½•ä¸‹é¢çš„ <code>kernel</code>ã€‚</li><li>å†…æ ¸åŠ è½½æˆåŠŸåï¼Œç¬¬ä¸€ä¸ªè¿è¡Œçš„ç¨‹åºæ˜¯ <code>/sbin/init</code>ã€‚å®ƒæ ¹æ®é…ç½®æ–‡ä»¶äº§ç”Ÿ <code>init</code> è¿›ç¨‹ã€‚è¿™æ˜¯ <code>Linux</code> å¯åŠ¨åçš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œ<code>pid</code> è¿›ç¨‹ç¼–å·ä¸º <code>1</code>ï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯å®ƒçš„åä»£ã€‚</li><li><code>init</code> çº¿ç¨‹åŠ è½½ç³»ç»Ÿçš„å„ä¸ªæ¨¡å—ï¼Œæ¯”å¦‚çª—å£ç¨‹åºå’Œç½‘ç»œç¨‹åºï¼Œç›´è‡³æ‰§è¡Œ <code>/bin/login</code> ç¨‹åºï¼Œè·³å‡ºç™»å½•ç•Œé¢ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</li></ol></li></ul><h1 id="æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ"></a> æ¦‚å¿µ</h1><h2 id="è¿›ç¨‹"><a class="markdownIt-Anchor" href="#è¿›ç¨‹"></a> è¿›ç¨‹</h2><p>è¿›ç¨‹çš„æœ¬è´¨å°±æ˜¯æ“ä½œç³»ç»Ÿæ‰§è¡Œçš„ä¸€ä¸ªç¨‹åºã€‚</p><ul><li>ä¸æ¯ä¸ªè¿›ç¨‹ç›¸å…³çš„æ˜¯åœ°å€ç©ºé—´(<code>address space</code>)ï¼Œè¿™æ˜¯ä»æŸä¸ªæœ€å°å€¼çš„å­˜å‚¨ä½ç½®ï¼ˆé€šå¸¸æ˜¯ 0ï¼‰åˆ°æŸä¸ªæœ€å¤§å€¼çš„å­˜å‚¨ä½ç½®çš„åˆ—è¡¨ã€‚åœ¨è¿™ä¸ªåœ°å€ç©ºé—´ä¸­ï¼Œè¿›ç¨‹å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œã€‚<strong>åœ°å€ç©ºé—´ä¸­å­˜æ”¾æœ‰å¯æ‰§è¡Œç¨‹åºï¼Œç¨‹åºæ‰€éœ€è¦çš„æ•°æ®å’Œå®ƒçš„æ ˆã€‚</strong></li><li>ä¸æ¯ä¸ªè¿›ç¨‹ç›¸å…³çš„è¿˜æœ‰èµ„æºé›†ï¼Œé€šå¸¸åŒ…æ‹¬å¯„å­˜å™¨(<code>registers</code>)ï¼ˆå¯„å­˜å™¨ä¸€èˆ¬åŒ…æ‹¬<strong>ç¨‹åºè®¡æ•°å™¨</strong>(<code>program counter</code>)å’Œ<strong>å †æ ˆæŒ‡é’ˆ</strong>(<code>stack pointer</code>)ï¼‰ã€æ‰“å¼€æ–‡ä»¶çš„æ¸…å•ã€çªå‘çš„æŠ¥è­¦ã€æœ‰å…³çš„è¿›ç¨‹æ¸…å•å’Œå…¶ä»–éœ€è¦æ‰§è¡Œç¨‹åºçš„ä¿¡æ¯ã€‚</li></ul><h2 id="åœ°å€ç©ºé—´"><a class="markdownIt-Anchor" href="#åœ°å€ç©ºé—´"></a> åœ°å€ç©ºé—´</h2><p>åœ°å€ç©ºé—´ç”¨æ¥ä¿å­˜æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºã€‚<br />æ¯ä¸ªè¿›ç¨‹æœ‰ä¸€äº›å¯ä»¥ä½¿ç”¨çš„åœ°å€é›†åˆï¼Œå…¸å‹å€¼ä» 0 å¼€å§‹ç›´åˆ°æŸä¸ªæœ€å¤§å€¼ã€‚ä¸€ä¸ªè¿›ç¨‹å¯æ‹¥æœ‰çš„æœ€å¤§åœ°å€ç©ºé—´å°äºä¸»å­˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿è¿›ç¨‹ç”¨å®Œå…¶åœ°å€ç©ºé—´ï¼Œå†…å­˜ä¹Ÿä¼šæœ‰è¶³å¤Ÿçš„å†…å­˜è¿è¡Œè¯¥è¿›ç¨‹ã€‚</p><h1 id="æ“ä½œç³»ç»Ÿç»“æ„"><a class="markdownIt-Anchor" href="#æ“ä½œç³»ç»Ÿç»“æ„"></a> æ“ä½œç³»ç»Ÿç»“æ„</h1><h2 id="å•ä½“ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#å•ä½“ç³»ç»Ÿ"></a> å•ä½“ç³»ç»Ÿ</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œæ•´ä¸ªç³»ç»Ÿåœ¨å†…æ ¸æ€ä»¥å•ä¸€ç¨‹åºçš„æ–¹å¼è¿è¡Œã€‚<br />åœ¨å•ä½“ç³»ç»Ÿä¸­æ„é€ å®é™…ç›®æ ‡ç¨‹åºæ—¶ï¼Œä¼šé¦–å…ˆç¼–è¯‘æ‰€æœ‰å•ä¸ªè¿‡ç¨‹ï¼ˆæˆ–åŒ…å«è¿™äº›è¿‡ç¨‹çš„æ–‡ä»¶ï¼‰ï¼Œç„¶åä½¿ç”¨ç³»ç»Ÿé“¾æ¥å™¨å°†å®ƒä»¬å…¨éƒ¨ç»‘å®šåˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚<br />åœ¨å•ä½“ç³»ç»Ÿä¸­ï¼Œå¯¹äºæ¯ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½ä¼šæœ‰ä¸€ä¸ªæœåŠ¡ç¨‹åºæ¥ä¿éšœå’Œè¿è¡Œã€‚éœ€è¦ä¸€ç»„å®ç”¨ç¨‹åºæ¥å¼¥è¡¥æœåŠ¡ç¨‹åºéœ€è¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä»ç”¨æˆ·ç¨‹åºä¸­è·å–æ•°æ®ã€‚å¯å°†å„ç§è¿‡ç¨‹åˆ’åˆ†ä¸ºä¸€ä¸ªä¸‰å±‚æ¨¡å‹ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916163823.png" srcset="/img/loading.gif" alt="" /></p><h2 id="åˆ†å±‚ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#åˆ†å±‚ç³»ç»Ÿ"></a> åˆ†å±‚ç³»ç»Ÿ</h2><p>åˆ†å±‚ç³»ç»Ÿä½¿ç”¨å±‚æ¥åˆ†éš”ä¸åŒçš„åŠŸèƒ½å•å…ƒã€‚æ¯ä¸€å±‚åªä¸è¯¥å±‚çš„ä¸Šå±‚å’Œä¸‹å±‚é€šä¿¡ã€‚æ¯ä¸€å±‚éƒ½ä½¿ç”¨ä¸‹é¢çš„å±‚æ¥æ‰§è¡Œå…¶åŠŸèƒ½ã€‚å±‚ä¹‹é—´çš„é€šä¿¡é€šè¿‡é¢„å®šä¹‰çš„å›ºå®šæ¥å£é€šä¿¡ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916163904.png" srcset="/img/loading.gif" alt="" /></p><h2 id="å¾®å†…æ ¸"><a class="markdownIt-Anchor" href="#å¾®å†…æ ¸"></a> å¾®å†…æ ¸</h2><p>åœ¨åˆ†å±‚æ–¹å¼ä¸­ï¼Œè®¾è®¡è€…è¦ç¡®å®šåœ¨å“ªé‡Œåˆ’åˆ† <strong>å†…æ ¸-ç”¨æˆ·</strong> çš„è¾¹ç•Œã€‚ä¼ ç»Ÿä¸Šï¼Œæ‰€æœ‰çš„å±‚éƒ½åœ¨å†…æ ¸ä¸­ï¼Œä½†æ˜¯è¿™æ ·åšæ²¡æœ‰å¿…è¦ã€‚äº‹å®ä¸Šï¼Œå°½å¯èƒ½å‡å°‘å†…æ ¸æ€ä¸­åŠŸèƒ½å¯èƒ½æ˜¯æ›´å¥½çš„åšæ³•ã€‚å› ä¸ºå†…æ ¸ä¸­çš„é”™è¯¯å¾ˆéš¾å¤„ç†ï¼Œä¸€æ—¦å†…æ ¸æ€ä¸­å‡ºé”™è¯¯ä¼šæ‹–ç´¯æ•´ä¸ªç³»ç»Ÿã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916165043.png" srcset="/img/loading.gif" alt="" /><br />æ‰€ä»¥ï¼Œä¸ºäº†å®ç°é«˜å¯é æ€§ï¼Œå°†æ“ä½œç³»ç»Ÿåˆ’åˆ†æˆå°çš„ã€å±‚çº§ä¹‹é—´èƒ½å¤Ÿæ›´å¥½å®šä¹‰çš„æ¨¡å—æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œåªæœ‰ä¸€ä¸ªæ¨¡å— â€” å¾®å†…æ ¸ â€” è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå…¶ä½™æ¨¡å—å¯ä»¥ä½œä¸ºæ™®é€šç”¨æˆ·è¿›ç¨‹è¿è¡Œã€‚ç”±äºæŠŠæ¯ä¸ªè®¾å¤‡é©±åŠ¨å’Œæ–‡ä»¶ç³»ç»Ÿåˆ†åˆ«ä½œä¸ºæ™®é€šç”¨æˆ·è¿›ç¨‹ï¼Œè¿™äº›æ¨¡å—ä¸­çš„é”™è¯¯è™½ç„¶ä¼šä½¿è¿™äº›æ¨¡å—å´©æºƒï¼Œä½†æ˜¯ä¸ä¼šä½¿æ•´ä¸ªç³»ç»Ÿæ­»æœºã€‚</p><h2 id="å®¢æˆ·-æœåŠ¡å™¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#å®¢æˆ·-æœåŠ¡å™¨æ¨¡å¼"></a> å®¢æˆ·-æœåŠ¡å™¨æ¨¡å¼</h2><p>å¾®å†…æ ¸æ€æƒ³çš„ç­–ç•¥æ˜¯æŠŠè¿›ç¨‹åˆ’åˆ†ä¸ºä¸¤ç±»ï¼š<strong>æœåŠ¡å™¨</strong>ï¼Œæ¯ä¸ªæœåŠ¡å™¨ç”¨æ¥æä¾›æœåŠ¡ï¼›<strong>å®¢æˆ·ç«¯</strong>ï¼Œä½¿ç”¨è¿™äº›æœåŠ¡ã€‚è¿™ä¸ªæ¨¡å¼å°±æ˜¯æ‰€è°“çš„ <strong>å®¢æˆ·-æœåŠ¡å™¨æ¨¡å¼</strong>ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200916164806.png" srcset="/img/loading.gif" alt="" /><br />å®¢æˆ·-æœåŠ¡å™¨æ¨¡å¼ä¼šæœ‰ä¸¤ç§è½½ä½“ï¼Œä¸€ç§æƒ…å†µæ˜¯ä¸€å°è®¡ç®—æœºæ—¢æ˜¯å®¢æˆ·åˆæ˜¯æœåŠ¡å™¨ï¼Œåœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œæ“ä½œç³»ç»Ÿä¼šæœ‰æŸç§ä¼˜åŒ–ï¼›ä½†æ˜¯æ™®éæƒ…å†µä¸‹æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œå®ƒä»¬é€šè¿‡å±€åŸŸç½‘æˆ–å¹¿åŸŸç½‘è¿æ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </title>
    <link href="/2020/09/15/LeetCode-215-kth-largest-element-in-an-array/"/>
    <url>/2020/09/15/LeetCode-215-kth-largest-element-in-an-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/" target="_blank" rel="noopener">215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </a></p><h1 id="å¿«æ’"><a class="markdownIt-Anchor" href="#å¿«æ’"></a> å¿«æ’</h1><p>æ€æƒ³ï¼šæ’åºåç¬¬ <code>k</code> ä¸ªæœ€å¤§å…ƒç´ ä½ç½® <code>= len - k</code>ï¼Œæ¯æ¬¡ <code>partition</code> åï¼Œéƒ½ä¼šå°† <code>pivot</code> ç§»åŠ¨åˆ°å…¶æœ€ç»ˆä½ç½®ï¼Œæ­¤æ—¶å°±å¯æ¯”è¾ƒè¯¥ä½ç½®æ˜¯å¦æ˜¯ç›®æ ‡ä½ç½®ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// æ’åºåç¬¬ k å¤§çš„æ•°æ‰€åœ¨ä½ç½®</span>    <span class="hljs-keyword">int</span> target = len - k;    <span class="hljs-keyword">return</span> quickSort(nums, target, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">int</span> pivotPos = partition(nums, left, right);    <span class="hljs-comment">// æ‰¾åˆ°ç›®æ ‡ä½ç½®ï¼Œè¿”å›</span>    <span class="hljs-keyword">if</span> (pivotPos == target) &#123;        <span class="hljs-keyword">return</span> nums[target];    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pivotPos &gt; target) &#123;        <span class="hljs-comment">// æ¯”ç›®æ ‡ä½ç½®å¤§ï¼Œåˆ™å¾€å‰æŸ¥æ‰¾</span>        <span class="hljs-keyword">return</span> quickSort(nums, target, left, pivotPos - <span class="hljs-number">1</span>);    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">return</span> quickSort(nums, target, pivotPos + <span class="hljs-number">1</span>, right);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">int</span> pivot = nums[left];    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[right] &gt;= pivot) &#123;            right--;        &#125;        nums[left] = nums[right];        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; nums[left] &lt;= pivot) &#123;            left++;        &#125;        nums[right] = nums[left];    &#125;    nums[left] = pivot;    <span class="hljs-keyword">return</span> left;&#125;</code></pre><h1 id="ä¼˜å…ˆé˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#ä¼˜å…ˆé˜Ÿåˆ—"></a> ä¼˜å…ˆé˜Ÿåˆ—</h1><p>å°é¡¶å †</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-comment">// å°é¡¶å † =&gt; å¼¹å‡ºæ¯” ç›®æ ‡å°çš„ len - k ä¸ªå…ƒç´ ï¼Œå †é¡¶å³ä¸ºç¬¬ k å¤§</span>    PriorityQueue&lt;Integer&gt; minHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        minHeap.add(num);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length - k; i++) &#123;        minHeap.poll();    &#125;    <span class="hljs-keyword">return</span> minHeap.peek();&#125;</code></pre><p>å¤§é¡¶å †</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// å¤§é¡¶å † =&gt; å¼¹å‡ºæ¯” ç›®æ ‡å¤§çš„ k - 1 ä¸ªå…ƒç´ ï¼Œå †é¡¶å³ä¸ºç¬¬ k å¤§</span>    PriorityQueue&lt;Integer&gt; maxHeap = <span class="hljs-keyword">new</span> PriorityQueue&lt;&gt;(len, (a, b) -&gt; b - a);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        maxHeap.add(num);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k - <span class="hljs-number">1</span>; i++) &#123;        maxHeap.poll();    &#125;    <span class="hljs-keyword">return</span> maxHeap.peek();&#125;</code></pre><h1 id="å †æ’åº"><a class="markdownIt-Anchor" href="#å †æ’åº"></a> å †æ’åº</h1><p>æ¯æ¬¡è°ƒæ•´éƒ½æŠŠæœ€å¤§çš„å…ƒç´ æ”¾åˆ°åé¢ï¼Œå› æ­¤è¦æ‰¾åˆ°ç¬¬ <code>K</code> å¤§çš„å…ƒç´ åªéœ€è¦éå† <code>K</code> æ¬¡ã€‚</p><p>æˆ–è€…ï¼šä½¿ç”¨å°é¡¶å †</p><ol><li>å¯¹ <code>K</code> ä¸ªå…ƒç´ å…ˆå»ºå †</li><li>éå†å‰©ä¸‹çš„å…ƒç´ ï¼Œè‹¥å¤§äºå †é¡¶ï¼Œåˆ™åŠ å…¥å †å¹¶è°ƒæ•´ã€‚</li><li>å †é¡¶å…ƒç´ å³ä¸ºç¬¬ <code>K</code> å¤§çš„å…ƒç´ </li></ol><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// å°†æ•°ç»„æ•´ç†æˆå †</span>    heapify(nums);    <span class="hljs-comment">// å¾ªç¯ä¸å˜é‡ï¼šåŒºé—´ [0, i] å †æœ‰åº</span>    <span class="hljs-comment">// æ¯æ¬¡è°ƒæ•´éƒ½æŠŠæœ€å¤§çš„å…ƒç´ æ”¾åˆ°åé¢</span>    <span class="hljs-comment">// å› æ­¤è¦æ‰¾åˆ°ç¬¬ K å¤§çš„å…ƒç´ åªéœ€è¦éå† K æ¬¡</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt; len - <span class="hljs-number">1</span> - k; ) &#123;        <span class="hljs-comment">// æŠŠå †é¡¶å…ƒç´ ï¼ˆå½“å‰æœ€å¤§ï¼‰äº¤æ¢åˆ°æ•°ç»„æœ«å°¾</span>        swap(nums, <span class="hljs-number">0</span>, i);        <span class="hljs-comment">// é€æ­¥å‡å°‘å †æœ‰åºçš„éƒ¨åˆ†</span>        i--;        <span class="hljs-comment">// ä¸‹æ ‡ 0 ä½ç½®ä¸‹æ²‰æ“ä½œï¼Œä½¿å¾—åŒºé—´ [0, i] å †æœ‰åº</span>        siftDown(nums, <span class="hljs-number">0</span>, i);    &#125;    <span class="hljs-keyword">return</span> nums[len - k];&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å°†æ•°ç»„æ•´ç†æˆå †ï¼ˆå †æœ‰åºï¼‰</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> nums</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">heapify</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// åªéœ€è¦ä» i = (len - 1) / 2 è¿™ä¸ªä½ç½®å¼€å§‹é€å±‚ä¸‹ç§»</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = (len - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        siftDown(nums, i, len - <span class="hljs-number">1</span>);    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> nums</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> k    å½“å‰ä¸‹æ²‰å…ƒç´ çš„ä¸‹æ ‡</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> end  [0, end] æ˜¯ nums çš„æœ‰æ•ˆéƒ¨åˆ†</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">siftDown</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">while</span> (<span class="hljs-number">2</span> * k &lt; end) &#123;        <span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span> * k + <span class="hljs-number">1</span>;        <span class="hljs-comment">// å·¦ç»“ç‚¹ &lt; å³ç»“ç‚¹ï¼Œj æŒ‡å‘å³ç»“ç‚¹</span>        <span class="hljs-keyword">if</span> (j &lt; end &amp;&amp; nums[j + <span class="hljs-number">1</span>] &gt; nums[j]) &#123;            j++;        &#125;        <span class="hljs-comment">// å­ç»“ç‚¹å¤§äºçˆ¶ç»“ç‚¹</span>        <span class="hljs-keyword">if</span> (nums[j] &gt; nums[k]) &#123;            swap(nums, j, k);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">break</span>;        &#125;        k = j;    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> temp = nums[i];    nums[i] = nums[j];    nums[j] = temp;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
      <tag>ä¼˜å…ˆé˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰‘æŒ‡ Offer 51. æ•°ç»„ä¸­çš„é€†åºå¯¹</title>
    <link href="/2020/09/14/LeetCode-offer-51-shu-zu-zhong-de-ni-xu-dui-lcof/"/>
    <url>/2020/09/14/LeetCode-offer-51-shu-zu-zhong-de-ni-xu-dui-lcof/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/shu-zu-zhong-de-ni-xu-dui-lcof/" target="_blank" rel="noopener">å‰‘æŒ‡ Offer 51. æ•°ç»„ä¸­çš„é€†åºå¯¹</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reversePairs</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">return</span> reverse(nums, <span class="hljs-number">0</span>, nums.length - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reverse</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">if</span> (left &gt;= right) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> mid = left + ((right - left) &gt;&gt; <span class="hljs-number">1</span>);    <span class="hljs-keyword">int</span> leftPairs = reverse(nums, left, mid);    <span class="hljs-keyword">int</span> rightPairs = reverse(nums, mid + <span class="hljs-number">1</span>, right);    <span class="hljs-keyword">if</span> (nums[mid] &lt;= nums[mid + <span class="hljs-number">1</span>]) &#123;        <span class="hljs-keyword">return</span> leftPairs + rightPairs;    &#125;    <span class="hljs-comment">// åœ¨å³åŒºé—´çš„å…ƒç´ åˆå¹¶æ—¶ï¼Œè®¡ç®—å¤§äºè¯¥å…ƒç´ çš„ä¸ªæ•°</span>    <span class="hljs-comment">// å·¦åŒºé—´çš„æ‰€æœ‰å…ƒç´ éƒ½å¤§äºè¯¥å…ƒç´ ï¼Œåˆ™é€†åºæ•° = å·¦åŒºé—´é•¿åº¦ = mid - i + 1</span>    <span class="hljs-keyword">int</span> crossPairs = mergeAndCount(nums, left, mid, right);    <span class="hljs-keyword">return</span> leftPairs + crossPairs + rightPairs;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">mergeAndCount</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = right - left + <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span> i = left, j = mid + <span class="hljs-number">1</span>, k = <span class="hljs-number">0</span>;    <span class="hljs-comment">// [left, mid] [mid + 1, right]</span>    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= right) &#123;        <span class="hljs-keyword">if</span> (nums[j] &lt; nums[i]) &#123;            tmp[k++] = nums[j++];            <span class="hljs-comment">// è®¡ç®—å·¦åŒºé—´é•¿åº¦</span>            count += mid - i + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            tmp[k++] = nums[i++];        &#125;    &#125;    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        tmp[k++] = nums[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= right) &#123;        tmp[k++] = nums[j++];    &#125;    System.arraycopy(tmp, <span class="hljs-number">0</span>, nums, left, len);    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ’åº</tag>
      
      <tag>å‰‘æŒ‡ Offer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 912. æ’åºæ•°ç»„</title>
    <link href="/2020/09/14/LeetCode-912-sort-an-array/"/>
    <url>/2020/09/14/LeetCode-912-sort-an-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sort-an-array/" target="_blank" rel="noopener">912. æ’åºæ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortArray(<span class="hljs-keyword">int</span>[] nums) &#123;    mergeSort(nums, <span class="hljs-number">0</span>, nums.length - <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> nums;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mergeSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt;&gt; <span class="hljs-number">1</span>;        mergeSort(nums, low, mid);        mergeSort(nums, mid + <span class="hljs-number">1</span>, high);        merge(nums, low, mid, high);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = high - low + <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// [low...mid] [mid + 1, high]</span>    <span class="hljs-keyword">int</span> i = low, j = mid + <span class="hljs-number">1</span>, k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= high) &#123;        tmp[k++] = nums[i] &gt; nums[j] ? nums[j++] : nums[i++];    &#125;    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        tmp[k++] = nums[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= high) &#123;        tmp[k++] = nums[j++];    &#125;    System.arraycopy(tmp, <span class="hljs-number">0</span>, nums, low, len);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-keyword">int</span> pivotPos = partition(nums, low, high);        quickSort(nums, low, pivotPos - <span class="hljs-number">1</span>);        quickSort(nums, pivotPos + <span class="hljs-number">1</span>, high);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> cur = nums[low];    <span class="hljs-keyword">while</span> (low &lt; high) &#123;        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; cur &lt;= nums[high]) &#123;            high--;        &#125;        nums[low] = nums[high];        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; cur &gt;= nums[low]) &#123;            low++;        &#125;        nums[high] = nums[low];    &#125;    nums[low] = cur;    <span class="hljs-keyword">return</span> low;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</title>
    <link href="/2020/09/14/string-matching-algorithms/"/>
    <url>/2020/09/14/string-matching-algorithms/</url>
    
    <content type="html"><![CDATA[<h1 id="kmp"><a class="markdownIt-Anchor" href="#kmp"></a> KMP</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">kmpSearch</span><span class="hljs-params">(String str, String pattern)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-comment">// next æ•°ç»„</span>    <span class="hljs-keyword">int</span>[] next = <span class="hljs-keyword">new</span> Solution().getNext(pattern);    <span class="hljs-keyword">char</span>[] s = str.toCharArray();    <span class="hljs-keyword">char</span>[] p = pattern.toCharArray();    <span class="hljs-comment">// i: è¦åŒ¹é…çš„å­—ç¬¦ä¸²ä½ç½®</span>    <span class="hljs-comment">// j: æ¨¡å¼ä¸²ä½ç½®</span>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; s.length &amp;&amp; j &lt; p.length) &#123;        <span class="hljs-comment">// pattern åŒ¹é…æˆåŠŸï¼Œç»§ç»­åç§»ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰å¤šä¸ª pattern åœ¨ str ä¸­å‡ºç°</span>        <span class="hljs-keyword">if</span> (j == p.length - <span class="hljs-number">1</span> &amp;&amp; s[i] == p[j]) &#123;            res.add(i - j);            j = next[j];        &#125;        <span class="hljs-comment">// å½“å‰å­—ç¬¦åŒ¹é…æˆåŠŸï¼Œè¿›è¡Œä¸‹ä¸€ä¸ªå­—ç¬¦çš„åŒ¹é…</span>        <span class="hljs-keyword">if</span> (j == -<span class="hljs-number">1</span> || s[i] == p[j]) &#123;            i++;            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// åŒ¹é…ä¸æˆåŠŸï¼Œpattern å‰ç§»ï¼Œä» str å¤±é…å¤„ç»§ç»­åŒ¹é…</span>            j = next[j];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * è·å–æ¨¡å¼ä¸²çš„ next æ•°ç»„</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> patternStr æ¨¡å¼ä¸²</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> next[]</span><span class="hljs-comment"> */</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] getNext(String patternStr) &#123;    <span class="hljs-keyword">char</span>[] pattern = patternStr.toCharArray();    <span class="hljs-keyword">int</span> n = pattern.length;    <span class="hljs-keyword">int</span>[] next = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n];    <span class="hljs-comment">// ç¬¬ i ä¸ªä½ç½®å‰ç¼€ = next[i + 1]</span>    next[<span class="hljs-number">0</span>] = -<span class="hljs-number">1</span>;    <span class="hljs-comment">// åˆå§‹å‰ç¼€é•¿åº¦ä¸º -1</span>    <span class="hljs-keyword">int</span> len = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; n - <span class="hljs-number">1</span>) &#123;        <span class="hljs-comment">// åœ¨ä¸Šä¸€ä¸ªå‰ç¼€çš„åŸºç¡€ä¸Šæ–°å¢çš„å­—ç¬¦åŒ¹é…ï¼Œåˆ™ prefix[i] = len + 1</span>        <span class="hljs-keyword">if</span> (len == -<span class="hljs-number">1</span> || pattern[i] == pattern[len]) &#123;            len++;            <span class="hljs-comment">// i + 1 ä½ç½®å­˜æ”¾ pattern[i] çš„å‰ç¼€é•¿åº¦</span>            i++;            next[i] = len;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// å‰ç¼€ä¸åŒ¹é…ï¼Œå¾€å‰æŸ¥æ‰¾ä¸ pattern[i] ç›¸ç­‰çš„å­—ç¬¦ç›´åˆ° len == -1</span>            len = next[len];        &#125;    &#125;    <span class="hljs-keyword">return</span> next;&#125;</code></pre><h1 id="bm"><a class="markdownIt-Anchor" href="#bm"></a> BM</h1><ol><li>åå­—ç¬¦<ul><li>åå­—ç¬¦ä¸åœ¨æ¨¡å¼ä¸²ä¸­ï¼Œç§»åŠ¨æ¨¡å¼ä¸²è‡³åå­—ç¬¦åä¸€ä½ï¼›</li><li>åå­—ç¬¦åœ¨æ¨¡å¼ä¸²ä¸­ï¼Œç§»åŠ¨æ¨¡å¼ä¸²ä¸­æœ€é åçš„é‚£ä¸ªå­—ç¬¦ã€‚</li></ul></li><li>å¥½åç¼€<ul><li>å¥½åç¼€ä¸åœ¨æ¨¡å¼ä¸²ä¸­ï¼Œç§»åŠ¨æ¨¡å¼ä¸²è‡³å¥½åç¼€çš„åä¸€ä½ï¼›</li><li>å¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­ï¼Œç§»åŠ¨æ¨¡å¼ä¸²è‡³å¥½åç¼€åŒ¹é…çš„åœ°æ–¹ï¼›</li><li>å¥½åç¼€çš„å­ä¸²å’Œæ¨¡å¼ä¸²éƒ¨åˆ†åŒ¹é…ï¼Œç§»åŠ¨æ¨¡å¼ä¸²è‡³å¥½åç¼€çš„å­ä¸²é‡åˆçš„åœ°æ–¹ã€‚</li></ul></li></ol><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">bmSearch</span><span class="hljs-params">(String s, String p)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] str = s.toCharArray();    <span class="hljs-keyword">char</span>[] pattern = p.toCharArray();    <span class="hljs-keyword">int</span> m = str.length;    <span class="hljs-keyword">int</span> n = pattern.length;    <span class="hljs-comment">// ç”Ÿæˆåå­—ç¬¦åœ¨æ¨¡å¼ä¸²ä¸­çš„ä½ç½®æ•°ç»„</span>    <span class="hljs-keyword">int</span>[] badChars = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">256</span>];    badCharRule(pattern, badChars);    <span class="hljs-comment">// é•¿åº¦ = i çš„åç¼€å­ä¸²åœ¨æ¨¡å¼ä¸²ä¸­çš„èµ·å§‹ä½ç½®</span>    <span class="hljs-keyword">int</span>[] suffix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n];    <span class="hljs-comment">// é•¿åº¦ = i çš„åç¼€å­ä¸²æ˜¯å¦æœ‰å¯åŒ¹é…çš„å‰ç¼€å­ä¸²</span>    <span class="hljs-keyword">boolean</span>[] hasPrefix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n];    goodSuffixRule(pattern, suffix, hasPrefix);    <span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (i &lt; m) &#123;        <span class="hljs-keyword">int</span> j = n - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span> &amp;&amp; pattern[j] == str[i]) &#123;            i--;            j--;            <span class="hljs-keyword">if</span> (j == -<span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-comment">// åå­—ç¬¦è§„åˆ™çš„ç§»åŠ¨æ¬¡æ•°</span>        <span class="hljs-keyword">int</span> moveWithBC = j - badChars[str[i]];        <span class="hljs-comment">// å¥½åç¼€è§„åˆ™çš„ç§»åŠ¨æ¬¡æ•°</span>        <span class="hljs-keyword">int</span> moveWithGS = Integer.MIN_VALUE;        <span class="hljs-keyword">if</span> (j &lt; n - <span class="hljs-number">1</span>) &#123;            moveWithGS = moveWithGS(n, j, suffix, hasPrefix);        &#125;        i += Math.max(moveWithBC, moveWithGS);    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å¥½åç¼€è§„åˆ™ä¸‹çš„ç§»åŠ¨æ¬¡æ•°</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> n         æ¨¡å¼ä¸²é•¿åº¦</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> j         å¤±é…ä½ç½®</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> suffix    é•¿åº¦ = i çš„åç¼€å­ä¸²åœ¨æ¨¡å¼ä¸²ä¸­çš„èµ·å§‹ä½ç½®</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hasPrefix é•¿åº¦ = i çš„åç¼€å­ä¸²æ˜¯å¦æœ‰å¯åŒ¹é…çš„å‰ç¼€å­ä¸²</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">moveWithGS</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span>[] suffix, <span class="hljs-keyword">boolean</span>[] hasPrefix)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = n - j - <span class="hljs-number">1</span>;    <span class="hljs-comment">// åç¼€å­˜åœ¨äºæ¨¡å¼ä¸²å‰ç¼€ä¸­</span>    <span class="hljs-keyword">if</span> (suffix[len] != -<span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> j - suffix[len] + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">// è‹¥ä¸å­˜åœ¨å‰ç¼€ä¸åç¼€åŒ¹é…ï¼Œåˆ™æ‰¾åç¼€çš„å­ä¸²ä½ç½®</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-keyword">if</span> (hasPrefix[i]) &#123;            <span class="hljs-keyword">return</span> n - i;        &#125;    &#125;    <span class="hljs-keyword">return</span> n;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * ç”Ÿæˆå¥½åç¼€æ•°ç»„</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> pattern</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> suffix</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hasPrefix</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">goodSuffixRule</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] pattern, <span class="hljs-keyword">int</span>[] suffix, <span class="hljs-keyword">boolean</span>[] hasPrefix)</span> </span>&#123;    Arrays.fill(suffix, -<span class="hljs-number">1</span>);    <span class="hljs-keyword">int</span> n = pattern.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-keyword">int</span> j = i;        <span class="hljs-comment">// åç¼€å­ä¸²çš„é•¿åº¦</span>        <span class="hljs-keyword">int</span> len = <span class="hljs-number">0</span>;        <span class="hljs-comment">// è‹¥å­—ç¬¦åŒ¹é…ï¼Œåˆ™å¾€å‰æŸ¥æ‰¾åç¼€</span>        <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span> &amp;&amp; pattern[j] == pattern[n - <span class="hljs-number">1</span> - len]) &#123;            j--;            len++;            suffix[len] = j + <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">if</span> (j == -<span class="hljs-number">1</span>) &#123;            hasPrefix[len] = <span class="hljs-keyword">true</span>;        &#125;    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * è®°å½• pattern ä¸­æ¯ä¸ªå­—ç¬¦çš„æœ€é åä½ç½®</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> pattern</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> badChars</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">badCharRule</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] pattern, <span class="hljs-keyword">int</span>[] badChars)</span> </span>&#123;    Arrays.fill(badChars, -<span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pattern.length; i++) &#123;        badChars[pattern[i]] = i;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 350. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›† II</title>
    <link href="/2020/09/13/LeetCode-350-intersection-of-two-arrays-ii/"/>
    <url>/2020/09/13/LeetCode-350-intersection-of-two-arrays-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/intersection-of-two-arrays-ii/" target="_blank" rel="noopener">350. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›† II</a></p><h1 id="å“ˆå¸Œè¡¨"><a class="markdownIt-Anchor" href="#å“ˆå¸Œè¡¨"></a> å“ˆå¸Œè¡¨</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] intersect(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-comment">// map ä¸­å­˜å‚¨æ¯ä¸ªæ•°çš„å‡ºç°æ¬¡æ•°</span>    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums1) &#123;        map.put(num, map.getOrDefault(num, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> key : nums2) &#123;        <span class="hljs-keyword">if</span> (!map.containsKey(key)) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-keyword">int</span> count = map.get(key);        <span class="hljs-comment">// å‡ºç°æ¬¡æ•°å¤§äº 1 æ‰æœ‰æ•ˆ</span>        <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) &#123;            list.add(key);            <span class="hljs-comment">// æ›´æ–°å‰©ä¸‹çš„æ¬¡æ•°</span>            map.put(key, count - <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[list.size()];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : list) &#123;        res[k++] = num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] intersect(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    Arrays.sort(nums1);    Arrays.sort(nums2);    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; nums1.length &amp;&amp; j &lt; nums2.length) &#123;        <span class="hljs-keyword">if</span> (nums1[i] == nums2[j]) &#123;            list.add(nums1[i]);            i++;            j++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums1[i] &gt; nums2[j]) &#123;            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            i++;        &#125;    &#125;    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[list.size()];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : list) &#123;        res[k++] = num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</title>
    <link href="/2020/09/13/LeetCode-349-intersection-of-two-arrays/"/>
    <url>/2020/09/13/LeetCode-349-intersection-of-two-arrays/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/intersection-of-two-arrays/" target="_blank" rel="noopener">349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</a></p><h1 id="å“ˆå¸Œè¡¨"><a class="markdownIt-Anchor" href="#å“ˆå¸Œè¡¨"></a> å“ˆå¸Œè¡¨</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] intersection(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    Set&lt;Integer&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums1) &#123;        map.put(num, map.getOrDefault(num, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> key : nums2) &#123;        <span class="hljs-keyword">if</span> (map.containsKey(key)) &#123;            set.add(key);        &#125;    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[set.size()];    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : set) &#123;        res[i++] = num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><p>ä¸¤ä¸ªæ•°ç»„æ’åºåï¼Œåˆ†åˆ«æŸ¥æ‰¾ç›¸ç­‰çš„æ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] intersection(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    Set&lt;Integer&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    Arrays.sort(nums1);    Arrays.sort(nums2);    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; nums1.length &amp;&amp; j &lt; nums2.length) &#123;        <span class="hljs-comment">// ç›¸ç­‰ï¼ŒåŠ å…¥é›†åˆ</span>        <span class="hljs-keyword">if</span> (nums1[i] == nums2[j]) &#123;            set.add(nums1[i]);            i++;            j++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums1[i] &gt; nums2[j]) &#123;            <span class="hljs-comment">// num2[j] å¤ªå°ï¼Œå¾€åæŸ¥æ‰¾</span>            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            i++;        &#125;    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[set.size()];    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : set) &#123;        res[k++] = num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] intersection(<span class="hljs-keyword">int</span>[] nums1, <span class="hljs-keyword">int</span>[] nums2) &#123;    Set&lt;Integer&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    Arrays.sort(nums2);    <span class="hljs-comment">// åœ¨ num2 ä¸­æŸ¥æ‰¾ nums1 ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : nums1) &#123;        <span class="hljs-keyword">if</span> (binarySearch(value, nums2) &amp;&amp; !set.contains(value)) &#123;            set.add(value);        &#125;    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[set.size()];    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : set) &#123;        res[k++] = num;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(<span class="hljs-keyword">int</span> target, <span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt;= right) &#123;        <span class="hljs-keyword">int</span> mid = (left + right) &gt;&gt; <span class="hljs-number">1</span>;        <span class="hljs-keyword">if</span> (nums[mid] == target) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;            right = mid - <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 227. åŸºæœ¬è®¡ç®—å™¨ II</title>
    <link href="/2020/09/12/LeetCode-227-basic-calculator-ii/"/>
    <url>/2020/09/12/LeetCode-227-basic-calculator-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/basic-calculator-ii/" target="_blank" rel="noopener">227. åŸºæœ¬è®¡ç®—å™¨ II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">calculate</span><span class="hljs-params">(String s)</span> </span>&#123;        <span class="hljs-keyword">char</span>[] chars = s.toCharArray();        Deque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        <span class="hljs-comment">// æ¯ä¸ªæ•°å­—å‰çš„ç¬¦å·</span>        <span class="hljs-keyword">char</span> sign = <span class="hljs-string">'+'</span>;        <span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> len = chars.length;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;            <span class="hljs-keyword">char</span> c = chars[i];            <span class="hljs-comment">// è½¬æ¢æ•°å­—</span>            <span class="hljs-keyword">if</span> (Character.isDigit(c)) &#123;                num = num * <span class="hljs-number">10</span> + (c - <span class="hljs-string">'0'</span>);            &#125;            <span class="hljs-comment">// åªèƒ½åœ¨è¿™é‡Œå»é™¤ç©ºæ ¼ï¼Œè‹¥ç©ºæ ¼åœ¨æœ€åä¸€ä½ï¼Œä¼šè·³è¿‡è®¡ç®—ç»“æœ</span>            <span class="hljs-keyword">if</span> ((!Character.isDigit(c) &amp;&amp; c != <span class="hljs-string">' '</span>) || i == len - <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">switch</span> (sign) &#123;                    <span class="hljs-keyword">case</span> <span class="hljs-string">'+'</span>:                        stack.push(num);                        <span class="hljs-keyword">break</span>;                    <span class="hljs-keyword">case</span> <span class="hljs-string">'-'</span>:                        stack.push(-num);                        <span class="hljs-keyword">break</span>;                    <span class="hljs-keyword">case</span> <span class="hljs-string">'*'</span>:                        stack.push(stack.pop() * num);                        <span class="hljs-keyword">break</span>;                    <span class="hljs-keyword">case</span> <span class="hljs-string">'/'</span>:                        stack.push(stack.pop() / num);                        <span class="hljs-keyword">break</span>;                    <span class="hljs-keyword">default</span>:                        <span class="hljs-keyword">break</span>;                &#125;                <span class="hljs-comment">// æ›´æ–°ç¬¦å·</span>                sign = c;                <span class="hljs-comment">// é‡ç½®æ•°å­—</span>                num = <span class="hljs-number">0</span>;            &#125;        &#125;        <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;            res += stack.pop();        &#125;        <span class="hljs-keyword">return</span> res;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1. ä¸¤æ•°ä¹‹å’Œ</title>
    <link href="/2020/09/12/LeetCode-1-two-sum/"/>
    <url>/2020/09/12/LeetCode-1-two-sum/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/two-sum/" target="_blank" rel="noopener">1. ä¸¤æ•°ä¹‹å’Œ</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] twoSum(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target) &#123;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;        <span class="hljs-keyword">int</span> another = target - nums[i];        <span class="hljs-keyword">if</span> (map.containsKey(another)) &#123;            res[<span class="hljs-number">0</span>] = i;            res[<span class="hljs-number">1</span>] = map.get(another);            <span class="hljs-keyword">break</span>;        &#125;        map.put(nums[i], i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 560. å’Œä¸ºKçš„å­æ•°ç»„</title>
    <link href="/2020/09/12/LeetCode-560-subarray-sum-equals-k/"/>
    <url>/2020/09/12/LeetCode-560-subarray-sum-equals-k/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/subarray-sum-equals-k/" target="_blank" rel="noopener">560. å’Œä¸ºKçš„å­æ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">subarraySum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å½“å‰å‰ç¼€å’Œ sum, ä¹‹å‰çš„æŸä¸ªå‰ç¼€å’Œ preSum</span>    <span class="hljs-comment">// sum - preSum = kï¼ŒpreSum å‡ºç°çš„æ¬¡æ•°å°±æ˜¯å½“å‰ä½ç½®å’Œä¸º k çš„ä¸ªæ•°</span>    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;    <span class="hljs-comment">// key: å‰ç¼€å’Œ value: è¯¥å‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°</span>    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    map.put(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        sum += num;        <span class="hljs-keyword">int</span> preSum = sum - k;        <span class="hljs-comment">// è·å– æœ‰å¤šå°‘ä¸ª preSumï¼Œä½¿å¾— sum - preSum = k</span>        <span class="hljs-keyword">if</span> (map.containsKey(preSum)) &#123;            count += map.get(preSum);        &#125;        <span class="hljs-comment">// æ›´æ–°å‰ç¼€å’Œ</span>        map.put(sum, map.getOrDefault(sum, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 224. åŸºæœ¬è®¡ç®—å™¨</title>
    <link href="/2020/09/12/LeetCode-224-basic-calculator/"/>
    <url>/2020/09/12/LeetCode-224-basic-calculator/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/basic-calculator/" target="_blank" rel="noopener">224. åŸºæœ¬è®¡ç®—å™¨</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">calculate</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-comment">/*</span><span class="hljs-comment">        æ•°å­—ï¼šå…¥ numStack</span><span class="hljs-comment">        è¿ç®—ç¬¦ï¼šè¿›è¡ŒåŠ å‡è¿ç®—ç›´åˆ°æ ˆç©ºæˆ–é‡åˆ° '('</span><span class="hljs-comment">        '(': å…¥ opStack</span><span class="hljs-comment">        ')': å‡ºæ ˆå¹¶è®¡ç®—ç›´åˆ°é‡åˆ° '('</span><span class="hljs-comment">    */</span>    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    Deque&lt;Integer&gt; numStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    Deque&lt;Character&gt; opStack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> num = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        <span class="hljs-comment">// é‡åˆ°æ•°å­—ï¼Œç»„åˆæ•°å­—å¹¶å‹å…¥ numStack</span>        <span class="hljs-keyword">if</span> (Character.isDigit(c)) &#123;            num = num == -<span class="hljs-number">1</span> ? c - <span class="hljs-string">'0'</span> : num * <span class="hljs-number">10</span> + c - <span class="hljs-string">'0'</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// æ•°å­—å…¥æ ˆ</span>            <span class="hljs-keyword">if</span> (num != -<span class="hljs-number">1</span>) &#123;                numStack.push(num);                num = -<span class="hljs-number">1</span>;            &#125;            <span class="hljs-comment">// è¿ç®—ç¬¦ï¼Œè¿›è¡ŒåŠ å‡è¿ç®—ç›´åˆ°æ ˆç©ºæˆ–é‡åˆ° '('</span>            <span class="hljs-keyword">if</span> (isOperation(c)) &#123;                <span class="hljs-keyword">while</span> (!opStack.isEmpty()) &#123;                    <span class="hljs-keyword">if</span> (opStack.peek() == <span class="hljs-string">'('</span>) &#123;                        <span class="hljs-keyword">break</span>;                    &#125;                    <span class="hljs-keyword">int</span> ans = calc(numStack, opStack);                    numStack.push(ans);                &#125;                <span class="hljs-comment">// å½“å‰è¿ç®—ç¬¦å…¥æ ˆ</span>                opStack.push(c);            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">'('</span>) &#123;                <span class="hljs-comment">// '(' ç›´æ¥å…¥æ ˆ</span>                opStack.push(c);            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">')'</span>) &#123;                <span class="hljs-comment">// ')': å‡ºæ ˆå¹¶è®¡ç®—ç›´åˆ°é‡åˆ° ')'</span>                <span class="hljs-keyword">while</span> (opStack.peek() != <span class="hljs-string">'('</span>) &#123;                    <span class="hljs-keyword">int</span> ans = calc(numStack, opStack);                    numStack.push(ans);                &#125;                <span class="hljs-comment">// å°† '(' å‡ºæ ˆ</span>                opStack.pop();            &#125;        &#125;    &#125;    <span class="hljs-keyword">if</span> (num != -<span class="hljs-number">1</span>) &#123;        numStack.push(num);    &#125;    <span class="hljs-comment">// è‹¥ æ“ä½œç¬¦æ ˆä¸ä¸ºç©ºï¼Œç»§ç»­è¿ç®—</span>    <span class="hljs-keyword">while</span> (!opStack.isEmpty()) &#123;        <span class="hljs-keyword">int</span> ans = calc(numStack, opStack);        numStack.push(ans);    &#125;    <span class="hljs-keyword">return</span> numStack.pop();&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * ä» numStack ä¸­å‡ºæ ˆä¸¤ä¸ªæ•°è¿›è¡ŒåŠ å‡è¿ç®—</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> numStack æ•°å­—æ ˆ</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> opStack  æ“ä½œç¬¦æ ˆ</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">calc</span><span class="hljs-params">(Deque&lt;Integer&gt; numStack, Deque&lt;Character&gt; opStack)</span> </span>&#123;    <span class="hljs-keyword">int</span> num1 = numStack.pop();    <span class="hljs-keyword">int</span> num2 = numStack.pop();    <span class="hljs-keyword">char</span> op = opStack.pop();    <span class="hljs-keyword">if</span> (op == <span class="hljs-string">'+'</span>) &#123;        <span class="hljs-keyword">return</span> num1 + num2;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">return</span> num2 - num1;    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ¤æ–­ c æ˜¯å¦ä¸ºè¿ç®—ç¬¦</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> c</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOperation</span><span class="hljs-params">(<span class="hljs-keyword">char</span> c)</span> </span>&#123;    <span class="hljs-keyword">return</span> c == <span class="hljs-string">'+'</span> || c == <span class="hljs-string">'-'</span> || c == <span class="hljs-string">'*'</span> || c == <span class="hljs-string">'/'</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 205. åŒæ„å­—ç¬¦ä¸²</title>
    <link href="/2020/09/11/LeetCode-205-isomorphic-strings/"/>
    <url>/2020/09/11/LeetCode-205-isomorphic-strings/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/isomorphic-strings/" target="_blank" rel="noopener">205. åŒæ„å­—ç¬¦ä¸²</a></p><p>éœ€è¦ä»ä¸¤ä¸ªæ–¹å‘åˆ¤æ–­ï¼</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isIsomorphic</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">return</span> check(s, t) &amp;&amp; check(t, s);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">check</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    Map&lt;Character, Character&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">char</span> c = s.charAt(i);        <span class="hljs-keyword">char</span> key = t.charAt(i);        <span class="hljs-keyword">if</span> (map.containsKey(key)) &#123;            <span class="hljs-keyword">char</span> target = map.get(key);            <span class="hljs-keyword">if</span> (c != target) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            map.put(key, c);        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isIsomorphic</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-comment">// åŒå‘éªŒè¯</span>    <span class="hljs-keyword">return</span> check(s, t) &amp;&amp; check(t, s);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">check</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">int</span>[] map = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">128</span>];    <span class="hljs-keyword">char</span>[] chars1 = s.toCharArray();    <span class="hljs-keyword">char</span>[] chars2 = t.toCharArray();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">int</span> target = map[chars1[i]];        <span class="hljs-comment">// åˆ¤æ–­å¯¹åº”ä½ç½®æ˜¯å¦åŒ¹é…</span>        <span class="hljs-keyword">if</span> (target != <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">if</span> (target != chars2[i]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// æ–°å¢ map</span>        map[chars1[i]] = chars2[i];    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 583. ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ</title>
    <link href="/2020/09/10/LeetCode-583-delete-operation-for-two-strings/"/>
    <url>/2020/09/10/LeetCode-583-delete-operation-for-two-strings/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/delete-operation-for-two-strings/" target="_blank" rel="noopener">583. ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ</a></p><p>å’Œ <a href="https://leetcode-cn.com/problems/edit-distance/" target="_blank" rel="noopener">72. ç¼–è¾‘è·ç¦»</a> ç±»ä¼¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minDistance</span><span class="hljs-params">(String word1, String word2)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = word1.length();    <span class="hljs-keyword">int</span> cols = word2.length();    <span class="hljs-keyword">char</span>[] chars1 = word1.toCharArray();    <span class="hljs-keyword">char</span>[] chars2 = word2.toCharArray();    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows + <span class="hljs-number">1</span>][cols + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = i;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= cols; i++) &#123;        dp[<span class="hljs-number">0</span>][i] = i;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cols; j++) &#123;            <span class="hljs-keyword">if</span> (chars1[i - <span class="hljs-number">1</span>] == chars2[j - <span class="hljs-number">1</span>]) &#123;                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];            &#125; <span class="hljs-keyword">else</span> &#123;                dp[i][j] = <span class="hljs-number">1</span> + Math.min(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - <span class="hljs-number">1</span>]);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[rows][cols];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 44. é€šé…ç¬¦åŒ¹é…</title>
    <link href="/2020/09/09/LeetCode-44-wildcard-matching/"/>
    <url>/2020/09/09/LeetCode-44-wildcard-matching/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/wildcard-matching/" target="_blank" rel="noopener">44. é€šé…ç¬¦åŒ¹é…</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isMatch</span><span class="hljs-params">(String s, String p)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = p.length();    <span class="hljs-keyword">int</span> cols = s.length();    <span class="hljs-keyword">char</span>[] sChars = s.toCharArray();    <span class="hljs-keyword">char</span>[] pChars = p.toCharArray();    <span class="hljs-keyword">boolean</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows + <span class="hljs-number">1</span>][cols + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;    <span class="hljs-comment">// è‹¥ä»¥ '*' å¼€å§‹ï¼Œåˆ™ p å¯ä»¥åŒ¹é… ç©ºä¸²</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        <span class="hljs-keyword">if</span> (pChars[i - <span class="hljs-number">1</span>] == <span class="hljs-string">'*'</span>) &#123;            dp[i][<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">break</span>;        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cols; j++) &#123;            <span class="hljs-comment">// å¯¹åº”å­—ç¬¦åŒ¹é… || p[j] == '?' å¯åŒ¹é…ä»»æ„å­—ç¬¦</span>            <span class="hljs-keyword">if</span> (sChars[j - <span class="hljs-number">1</span>] == pChars[i - <span class="hljs-number">1</span>] || pChars[i - <span class="hljs-number">1</span>] == <span class="hljs-string">'?'</span>) &#123;                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pChars[i - <span class="hljs-number">1</span>] == <span class="hljs-string">'*'</span>) &#123;                <span class="hljs-comment">// '*' å¯åŒ¹é…ä»»æ„é•¿åº¦</span>                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] || dp[i][j - <span class="hljs-number">1</span>];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[rows][cols];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 10. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</title>
    <link href="/2020/09/09/LeetCode-10-regular-expression-matching/"/>
    <url>/2020/09/09/LeetCode-10-regular-expression-matching/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/regular-expression-matching/" target="_blank" rel="noopener">10. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</a></p><p><code>dp[i][j]</code> è¡¨ç¤º <code>s[0:i]</code> æ˜¯å¦èƒ½åŒ¹é…åˆ° <code>p[0:j]</code></p><ul><li><code>s[i] == p[j]</code>ï¼Œå¯¹åº”ä½ç½®åŒ¹é…<br /><code>dp[i][j] = dp[i - 1][j - 1]</code></li><li><code>p[j] == '.'</code>ï¼Œ<code>'.'</code> å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦<br /><code>dp[i][j] = dp[i - 1][j - 1]</code></li><li><code>s[i] != p[j]</code>ï¼Œè‹¥ <code>p[j] != '*'</code>ï¼Œåˆ™è‚¯å®šæ— æ³•åŒ¹é…ï¼Œåªæœ‰å½“ <code>*</code> æ—¶æ‰æœ‰å¯èƒ½æ¶ˆé™¤ä¸åŒ¹é…çš„å­—ç¬¦ã€‚<ul><li><code>s[i] != p[j - 1]</code>ï¼Œ <code>*</code> çš„å‰ä¸€ä¸ªå­—ç¬¦ä¸ <code>s[i]</code> æ— æ³•åŒ¹é…ï¼Œåˆ™æ¶ˆå» <code>s[i]</code>ï¼Œæ­¤æ—¶ <code>#*</code> ä»£è¡¨ <code>#</code> å– 0 ä¸ªã€‚<br /><code>dp[i][j] = dp[j - 2]</code></li><li><code>s[i] == p[j - 1]</code>ï¼Œ <code>*</code> çš„å‰ä¸€ä¸ªå­—ç¬¦ä¸ <code>s[i]</code> åŒ¹é…ï¼Œåˆ™ <code>p[j - 2]</code> å¯ä»¥å– 0 ä¸ªï¼Œ 1 ä¸ªæˆ–å¤šä¸ª<br /><code>dp[i][j] = dp[j - 2] || dp[i][j - 1] || dp[i - 1][j]</code><ul><li>å– 0 ä¸ªï¼šaab - aab b*</li><li>å– 1 ä¸ªï¼šaab - aa b*</li><li>å– n ä¸ªï¼šaabbbb - aa b*</li></ul></li></ul></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isMatch</span><span class="hljs-params">(String s, String p)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = s.length();    <span class="hljs-keyword">int</span> cols = p.length();    <span class="hljs-keyword">boolean</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows + <span class="hljs-number">1</span>][cols + <span class="hljs-number">1</span>];    <span class="hljs-comment">// ç©ºä¸²è‚¯å®šèƒ½åŒ¹é…</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= cols; i++) &#123;        <span class="hljs-keyword">if</span> (p.charAt(i - <span class="hljs-number">1</span>) == <span class="hljs-string">'*'</span> &amp;&amp; dp[<span class="hljs-number">0</span>][i - <span class="hljs-number">2</span>]) &#123;            dp[<span class="hljs-number">0</span>][i] = <span class="hljs-keyword">true</span>;        &#125;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cols; j++) &#123;            <span class="hljs-comment">// s å’Œ p å½“å‰åŒ¹é…åˆ°çš„å­—ç¬¦</span>            <span class="hljs-keyword">char</span> sc = s.charAt(i - <span class="hljs-number">1</span>);            <span class="hljs-keyword">char</span> pc = p.charAt(j - <span class="hljs-number">1</span>);            <span class="hljs-comment">// i, j åŒ¹é…æˆ– j å¯å–ä»»æ„å€¼</span>            <span class="hljs-keyword">if</span> (sc == pc || pc == <span class="hljs-string">'.'</span>) &#123;                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pc == <span class="hljs-string">'*'</span>) &#123;                <span class="hljs-comment">// `*` çš„å‰ä¸€ä¸ªå­—ç¬¦</span>                <span class="hljs-keyword">char</span> last = p.charAt(j - <span class="hljs-number">2</span>);                <span class="hljs-comment">// last ä¸ s çš„å½“å‰ä½ç½®åŒ¹é…ï¼Œåˆ™ last å¯å– 1 ä½æˆ–å¤šä½</span>                <span class="hljs-keyword">if</span> (sc == last || last == <span class="hljs-string">'.'</span>) &#123;                    dp[i][j] = dp[i][j - <span class="hljs-number">1</span>] || dp[i - <span class="hljs-number">1</span>][j];                &#125;                <span class="hljs-comment">// å°è¯•ä¸å– last</span>                dp[i][j] = dp[i][j] || dp[i][j - <span class="hljs-number">2</span>];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[rows][cols];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 5. æœ€é•¿å›æ–‡å­ä¸²</title>
    <link href="/2020/09/09/LeetCode-5-longest-palindromic-substring/"/>
    <url>/2020/09/09/LeetCode-5-longest-palindromic-substring/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-palindromic-substring/" target="_blank" rel="noopener">5. æœ€é•¿å›æ–‡å­ä¸²</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><ul><li><p>å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤´å°¾ä¸¤ä¸ªå­—ç¬¦éƒ½ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²ä¸€å®šä¸æ˜¯å›æ–‡ä¸²ï¼›</p></li><li><p>å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤´å°¾ä¸¤ä¸ªå­—ç¬¦ç›¸ç­‰ï¼Œæ‰æœ‰å¿…è¦ç»§ç»­åˆ¤æ–­ä¸‹å»ã€‚</p><ul><li><p>å¦‚æœé‡Œé¢çš„å­ä¸²æ˜¯å›æ–‡ï¼Œæ•´ä½“å°±æ˜¯å›æ–‡ä¸²ï¼›</p></li><li><p>å¦‚æœé‡Œé¢çš„å­ä¸²ä¸æ˜¯å›æ–‡ä¸²ï¼Œæ•´ä½“å°±ä¸æ˜¯å›æ–‡ä¸²ã€‚</p></li></ul></li></ul><p>çŠ¶æ€ï¼š<code>dp[i][j]</code> - <code>s[i:j]</code> æ˜¯å¦ä¸ºå›æ–‡ä¸²<br />çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<code>dp[i][j] = s[i] == s[j] and dp[i + 1][j - 1]</code></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">longestPalindrome</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    <span class="hljs-keyword">boolean</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len][len];    <span class="hljs-comment">// èµ·ç‚¹</span>    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-comment">// å›æ–‡é•¿åº¦</span>    <span class="hljs-keyword">int</span> maxLen = <span class="hljs-number">1</span>;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; len; j++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; j; i++) &#123;            <span class="hljs-comment">// ä¸¤ä¾§ä¸ç­‰ï¼Œä¸€å®šæ— æ³•æ„æˆå›æ–‡</span>            <span class="hljs-keyword">if</span> (chars[i] != chars[j]) &#123;                dp[i][j] = <span class="hljs-keyword">false</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// å­ä¸²åªæœ‰ 0 ä¸ªæˆ– 1 ä¸ªå­—ç¬¦</span>                <span class="hljs-keyword">if</span> (j - i &lt;= <span class="hljs-number">2</span>) &#123;                    dp[i][j] = <span class="hljs-keyword">true</span>;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// ä¸¤ä¾§ç›¸ç­‰ï¼Œçœ‹å­ä¸²æ˜¯ä¸æ˜¯å›æ–‡</span>                    dp[i][j] = dp[i + <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];                &#125;            &#125;            <span class="hljs-comment">// æ›´æ–°æœ€é•¿å›æ–‡ä½ç½®</span>            <span class="hljs-keyword">if</span> (dp[i][j] &amp;&amp; j - i + <span class="hljs-number">1</span> &gt; maxLen) &#123;                maxLen = j - i + <span class="hljs-number">1</span>;                start = i;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> s.substring(start, start + maxLen);&#125;</code></pre><h1 id="ä¸­å¿ƒæ‰©æ•£"><a class="markdownIt-Anchor" href="#ä¸­å¿ƒæ‰©æ•£"></a> ä¸­å¿ƒæ‰©æ•£</h1><p>å°è¯•ä»¥æ¯ä¸ªå­—ç¬¦å’Œæ¯ä¸ªå­—ç¬¦é—´çš„é—´éš™ä¸ºä¸­å¿ƒï¼Œå‘ä¸¤ç«¯æ‰©æ•£ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200909134124.jpeg" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">longestPalindrome</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> s;    &#125;    String res = s.substring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-comment">// å¥‡æ•°æ‰©æ•£ï¼Œä»¥ s[i] ä¸ºä¸­å¿ƒ</span>        String oddStr = centerSpread(s, i, i);        <span class="hljs-comment">// å¶æ•°æ‰©æ•£ï¼Œä»¥ s[i] s[i + 1] ä¸ºä¸­å¿ƒ</span>        String evenStr = centerSpread(s, i, i + <span class="hljs-number">1</span>);        String cur = oddStr.length() &gt; evenStr.length() ? oddStr : evenStr;        <span class="hljs-keyword">if</span> (cur.length() &gt; res.length()) &#123;            res = cur;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">centerSpread</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">while</span> (left &gt;= <span class="hljs-number">0</span> &amp;&amp; right &lt; len) &#123;        <span class="hljs-keyword">if</span> (s.charAt(left) != s.charAt(right)) &#123;            <span class="hljs-keyword">break</span>;        &#125;        left--;        right++;    &#125;    <span class="hljs-comment">// s[left] != s[right]ï¼Œå–ä¸­é—´çš„å›æ–‡éƒ¨åˆ† s[left + 1:right - 1]</span>    <span class="hljs-keyword">return</span> s.substring(left + <span class="hljs-number">1</span>, right);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 680. éªŒè¯å›æ–‡å­—ç¬¦ä¸² â…¡</title>
    <link href="/2020/09/09/LeetCode-680-valid-palindrome-ii/"/>
    <url>/2020/09/09/LeetCode-680-valid-palindrome-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-palindrome-ii/" target="_blank" rel="noopener">680. éªŒè¯å›æ–‡å­—ç¬¦ä¸² â…¡</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">validPalindrome</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = s.length() - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-comment">// æœ€å¤šåˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œå½“æœ‰ä¸€ä¸ªå­—ç¬¦ä¸ç­‰æ—¶ï¼Œåˆ¤æ–­åˆ é™¤è¯¥å­—ç¬¦åå‰©ä¸‹çš„éƒ¨åˆ†æ˜¯å¦ä¸ºå›æ–‡</span>        <span class="hljs-keyword">if</span> (s.charAt(left) != s.charAt(right)) &#123;            <span class="hljs-keyword">return</span> isPalindrome(s, left + <span class="hljs-number">1</span>, right) || isPalindrome(s, left, right - <span class="hljs-number">1</span>);        &#125;        left++;        right--;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPalindrome</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">if</span> (s.charAt(left) != s.charAt(right)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        left++;        right--;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 125. éªŒè¯å›æ–‡ä¸²</title>
    <link href="/2020/09/09/LeetCode-125-valid-palindrome/"/>
    <url>/2020/09/09/LeetCode-125-valid-palindrome/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-palindrome/" target="_blank" rel="noopener">125. éªŒè¯å›æ–‡ä¸²</a></p><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPalindrome</span><span class="hljs-params">(String s)</span> </span>&#123;    s = s.toLowerCase();    <span class="hljs-keyword">int</span> right = s.length() - <span class="hljs-number">1</span>;    <span class="hljs-keyword">if</span> (right &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; !Character.isLetterOrDigit(s.charAt(left))) &#123;            left++;        &#125;        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; !Character.isLetterOrDigit(s.charAt(right))) &#123;            right--;        &#125;        <span class="hljs-keyword">if</span> (s.charAt(left) != s.charAt(right)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        left++;        right--;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> reverse</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPalindrome</span><span class="hljs-params">(String s)</span> </span>&#123;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;        <span class="hljs-keyword">char</span> c = s.charAt(i);        <span class="hljs-keyword">if</span> (Character.isLetterOrDigit(c)) &#123;            sb.append(Character.toLowerCase(c));        &#125;    &#125;    String s1 = sb.toString();    String s2 = sb.reverse().toString();    <span class="hljs-keyword">return</span> s1.equals(s2);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 818. èµ›è½¦</title>
    <link href="/2020/09/08/LeetCode-818-race-car/"/>
    <url>/2020/09/08/LeetCode-818-race-car/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/race-car/" target="_blank" rel="noopener">818. èµ›è½¦</a></p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><p>éœ€è¦æ³¨æ„ï¼š<code>newPos &lt; target * 2</code>ï¼Œå› ä¸ºå¯¹äº <code>target</code> è€Œè¨€ï¼Œ</p><ul><li>å¯ä»¥åœ¨ <code>target</code> ä¹‹å‰è¿›è¡ŒåŠ é€Ÿæˆ–å‡é€Ÿæ“ä½œï¼›</li><li>æˆ–è€…è¶…è¿‡ <code>target</code> ä¹‹åè¿›è¡Œå‡é€Ÿæ“ä½œï¼›</li></ul><p>è¿™ä¸¤ç§æ–¹å¼éƒ½å¯èƒ½åˆ°è¾¾ <code>target</code>ï¼ŒæŠŠ <code>newPos</code> é™åˆ¶åœ¨ <code>2 * target</code> é‡Œï¼Œæ˜¯ä¸ºäº†è®©æ“ä½œçš„æ­¥æ•°ä¸å†é€’å¢ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°ç»ˆç‚¹ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">racecar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> target)</span> </span>&#123;    Deque&lt;Car&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    Set&lt;String&gt; visited = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    queue.add(<span class="hljs-keyword">new</span> Car(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>));    visited.add(<span class="hljs-string">"0@1"</span>);    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        count++;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            Car car = queue.poll();            <span class="hljs-keyword">int</span> curPos = car.position;            <span class="hljs-comment">// è¾¾åˆ°ç»ˆç‚¹</span>            <span class="hljs-keyword">if</span> (curPos == target) &#123;                <span class="hljs-keyword">return</span> count;            &#125;            <span class="hljs-keyword">int</span> speed = car.speed;            <span class="hljs-comment">// åŠ é€Ÿ</span>            <span class="hljs-keyword">int</span> newPos = curPos + speed;            <span class="hljs-keyword">int</span> newSpeed = speed &lt;&lt; <span class="hljs-number">1</span>;            String key = newPos + <span class="hljs-string">"@"</span> + newSpeed;            <span class="hljs-keyword">if</span> (!visited.contains(key) &amp;&amp; <span class="hljs-number">0</span> &lt; newPos &amp;&amp; newPos &lt; (target &lt;&lt; <span class="hljs-number">1</span>)) &#123;                queue.add(<span class="hljs-keyword">new</span> Car(newPos, newSpeed));                visited.add(key);            &#125;            <span class="hljs-comment">// å‡é€Ÿ</span>            newSpeed = speed &gt; <span class="hljs-number">0</span> ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>;            key = curPos + <span class="hljs-string">"@"</span> + newSpeed;            <span class="hljs-keyword">if</span> (!visited.contains(key) &amp;&amp; <span class="hljs-number">0</span> &lt; curPos &amp;&amp; curPos &lt; (target &lt;&lt; <span class="hljs-number">1</span>)) &#123;                queue.add(<span class="hljs-keyword">new</span> Car(curPos, newSpeed));                visited.add(key);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>&#123;    <span class="hljs-keyword">int</span> position;    <span class="hljs-keyword">int</span> speed;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Car</span><span class="hljs-params">(<span class="hljs-keyword">int</span> position, <span class="hljs-keyword">int</span> speed)</span> </span>&#123;        <span class="hljs-keyword">this</span>.position = position;        <span class="hljs-keyword">this</span>.speed = speed;    &#125;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">racecar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-comment">// dp[i]: åˆ°è¾¾ i ä½ç½®çš„æœ€å°æ­¥æ•°</span>    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[target + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= target; i++) &#123;        dp[i] = Integer.MAX_VALUE;        <span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>, cnt1 = <span class="hljs-number">1</span>;        <span class="hljs-comment">// åœ¨ i ä½ç½®ä¹‹å‰è¿›è¡ŒåŠ é€Ÿã€å‡é€Ÿæ“ä½œ</span>        <span class="hljs-comment">// j æ¯æ¬¡åŠ é€Ÿåˆ° 2 ^ cnt1 - 1 ä½ç½®</span>        <span class="hljs-keyword">for</span> (; j &lt; i; j = (<span class="hljs-number">1</span> &lt;&lt; ++cnt1) - <span class="hljs-number">1</span>) &#123;            <span class="hljs-comment">// k æ¯æ¬¡åå‘åŠ é€Ÿåˆ° 2 ^ cnt2 - 1 ä½ç½®</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>, cnt2 = <span class="hljs-number">0</span>; k &lt; j; k = (<span class="hljs-number">1</span> &lt;&lt; ++cnt2) - <span class="hljs-number">1</span>) &#123;                <span class="hljs-comment">// æ­£å‘èµ°äº† (j - k) æ­¥ + åŠ é€Ÿ + 2 æ¬¡åå‘æ“ä½œ</span>                dp[i] = Math.min(dp[i], dp[i - (j - k)] + cnt1 + <span class="hljs-number">1</span> + cnt2 + <span class="hljs-number">1</span>);            &#125;        &#125;        <span class="hljs-comment">// ç»è¿‡ cnt1 æ¬¡æ­£å‘åŠ é€Ÿï¼Œæ­¤æ—¶ä½ç½®è¶…è¿‡ iï¼Œç„¶åè¿›è¡Œ 1 æ¬¡åå‘æ“ä½œ</span>        <span class="hljs-comment">// è‹¥ i == j åˆ°è¾¾ targetï¼Œå¦åˆ™è¿˜å·® j - i åˆ°è¾¾ i ä½ç½®</span>        dp[i] = Math.min(dp[i], cnt1 + (i == j ? <span class="hljs-number">0</span> : dp[j - i] + <span class="hljs-number">1</span>));    &#125;    <span class="hljs-keyword">return</span> dp[target];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 115. ä¸åŒçš„å­åºåˆ—</title>
    <link href="/2020/09/08/LeetCode-115-distinct-subsequences/"/>
    <url>/2020/09/08/LeetCode-115-distinct-subsequences/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/distinct-subsequences/" target="_blank" rel="noopener">115. ä¸åŒçš„å­åºåˆ—</a></p><h1 id="å›æº¯"><a class="markdownIt-Anchor" href="#å›æº¯"></a> å›æº¯</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    Map&lt;String, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numDistinct</span><span class="hljs-params">(String s, String t)</span> </span>&#123;        backtrack(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, s, t);        <span class="hljs-keyword">return</span> count;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> sPos, <span class="hljs-keyword">int</span> tPos, String s, String t)</span> </span>&#123;        <span class="hljs-comment">// t åŒ¹é…å®Œæˆ</span>        <span class="hljs-keyword">if</span> (tPos == t.length()) &#123;            count++;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// s åˆ°è¾¾ç»ˆç‚¹</span>        <span class="hljs-keyword">if</span> (sPos == s.length()) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// è®°å¿†åŒ–</span>        String key = sPos + <span class="hljs-string">"@"</span> + tPos;        <span class="hljs-keyword">if</span> (map.containsKey(key)) &#123;            count += map.get(key);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">int</span> pre = count;        <span class="hljs-comment">// å½“å‰å­—ç¬¦ç›¸ç­‰ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå­—ç¬¦</span>        <span class="hljs-comment">// s, t åŒæ—¶å‘å</span>        <span class="hljs-keyword">if</span> (s.charAt(sPos) == t.charAt(tPos)) &#123;            backtrack(sPos + <span class="hljs-number">1</span>, tPos + <span class="hljs-number">1</span>, s, t);        &#125;        <span class="hljs-comment">// s å‘åï¼Œt ä¸å˜</span>        backtrack(sPos + <span class="hljs-number">1</span>, tPos, s, t);        <span class="hljs-comment">// å­˜å‚¨æœ¬åœ°å›æº¯çš„ count å¢é‡</span>        <span class="hljs-keyword">int</span> diff = count - pre;        map.put(key, diff);    &#125;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numDistinct</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = t.length();    <span class="hljs-keyword">int</span> cols = s.length();    <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span> || cols == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows + <span class="hljs-number">1</span>][cols + <span class="hljs-number">1</span>];    Arrays.fill(dp[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cols; j++) &#123;            <span class="hljs-keyword">if</span> (t.charAt(i - <span class="hljs-number">1</span>) != s.charAt(j - <span class="hljs-number">1</span>)) &#123;                <span class="hljs-comment">// ä¸ç›¸ç­‰ï¼šå»é™¤ s[j]ï¼Œå– s[:j - 1] å’Œ t[:i] çš„ç›¸åŒåºåˆ—æ•°</span>                dp[i][j] = dp[i][j - <span class="hljs-number">1</span>];            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// s[j] å¯å–ï¼Œå¯ä¸å–</span>                <span class="hljs-comment">// è‹¥å– s[j]ï¼Œå› ä¸º s[j] == t[i]ï¼Œæ¯”è¾ƒ s[:j - 1] å’Œ t[:i - 1]</span>                <span class="hljs-comment">// è‹¥ä¸å– s[j]ï¼Œæ¯”è¾ƒ s[:j - 1] å’Œ t[:i]</span>                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + dp[i][j - <span class="hljs-number">1</span>];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[rows][cols];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 85. æœ€å¤§çŸ©å½¢</title>
    <link href="/2020/09/08/LeetCode-85-maximal-rectangle/"/>
    <url>/2020/09/08/LeetCode-85-maximal-rectangle/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximal-rectangle/" target="_blank" rel="noopener">85. æœ€å¤§çŸ©å½¢</a></p><h1 id="æš´åŠ›"><a class="markdownIt-Anchor" href="#æš´åŠ›"></a> æš´åŠ›</h1><p>ä¿å­˜æ¯ä¸ª <code>1</code> å…ƒç´ çš„æœ€é•¿è·ç¦»ï¼Œå‘ä¸ŠæŸ¥æ‰¾é«˜åº¦ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maximalRectangle</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] matrix)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = matrix.length;    <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> cols = matrix[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-comment">// ä»¥ widths[row][col] ç»“å°¾çš„æœ€é•¿ `1` çš„ä¸ªæ•°</span>    <span class="hljs-keyword">int</span>[][] widths = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows][cols];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-comment">// å½“å‰ä½ç½®ä¸º `1`</span>            <span class="hljs-keyword">if</span> (matrix[i][j] == <span class="hljs-string">'1'</span>) &#123;                widths[i][j] = <span class="hljs-number">1</span>;                <span class="hljs-comment">// ä¸æ˜¯ç¬¬ä¸€åˆ—ï¼Œåˆ™ = 1 + å·¦è¾¹é‚£ä¸ªæ ¼å­çš„æœ€é•¿æ•°</span>                <span class="hljs-keyword">if</span> (j != <span class="hljs-number">0</span>) &#123;                    widths[i][j] += widths[i][j - <span class="hljs-number">1</span>];                &#125;            &#125; <span class="hljs-keyword">else</span> &#123;                widths[i][j] = <span class="hljs-number">0</span>;            &#125;            <span class="hljs-keyword">int</span> minWidth = widths[i][j];            <span class="hljs-comment">// å‘ä¸ŠæŸ¥æ‰¾æœ€å°çŸ©å½¢</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> row = i; row &gt;= <span class="hljs-number">0</span>; row--) &#123;                minWidth = Math.min(minWidth, widths[row][j]);                <span class="hljs-keyword">int</span> height = i - row + <span class="hljs-number">1</span>;                res = Math.max(res, minWidth * height);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="å•è°ƒæ ˆ"><a class="markdownIt-Anchor" href="#å•è°ƒæ ˆ"></a> å•è°ƒæ ˆ</h1><p>åœ¨ <a href="https://leetcode-cn.com/problems/largest-rectangle-in-histogram/" target="_blank" rel="noopener">84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢</a> çš„åŸºç¡€ä¸Šï¼Œè½¬åŒ–ä¸ºæŒ‰è¡Œæ±‚æ¯è¡Œçš„æœ€å¤§çŸ©å½¢é¢ç§¯ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maximalRectangle</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] matrix)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = matrix.length;    <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> cols = matrix[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// ä¿å­˜æ¯ä¸€åˆ—çš„é«˜åº¦</span>    <span class="hljs-keyword">int</span>[] heights = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[cols];    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (matrix[i][j] == <span class="hljs-string">'1'</span>) &#123;                <span class="hljs-comment">// å½“å‰åˆ—ä¸º 1ï¼Œåœ¨ä¸Šä¸€è¡Œçš„åŸºç¡€ä¸Š + 1</span>                heights[j]++;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// é‡æ–°å¼€å§‹</span>                heights[j] = <span class="hljs-number">0</span>;            &#125;        &#125;        <span class="hljs-comment">// æ±‚æ¯ä¸€è¡Œçš„æœ€å¤§å€¼</span>        res = Math.max(res, largestRectangleArea(heights));    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢</title>
    <link href="/2020/09/08/LeetCode-84-largest-rectangle-in-histogram/"/>
    <url>/2020/09/08/LeetCode-84-largest-rectangle-in-histogram/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/largest-rectangle-in-histogram/" target="_blank" rel="noopener">84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">largestRectangleArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] heights)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = heights.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> heights[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-comment">// æ·»åŠ å“¨å…µï¼Œå¤´å°¾éƒ½åŠ ä¸€ä¸ª 0ï¼Œé¿å…è¾¹ç•Œåˆ¤æ–­</span>    <span class="hljs-keyword">int</span>[] newHeights = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len + <span class="hljs-number">2</span>];    System.arraycopy(heights, <span class="hljs-number">0</span>, newHeights, <span class="hljs-number">1</span>, len);    <span class="hljs-comment">// å•è°ƒé€’å¢æ ˆï¼Œå½“è¦å…¥æ ˆå…ƒç´ å°äºæ ˆé¡¶å…ƒç´ æ—¶</span>    <span class="hljs-comment">// æ ˆé¡¶å…ƒç´ ä¸ºæœ€å¤§å€¼ï¼Œå¯è®¡ç®—ä»¥æ ˆé¡¶ä¸ºé«˜åº¦çš„æœ€å¤§çŸ©å½¢é¢ç§¯</span>    Deque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;(len);    stack.push(<span class="hljs-number">0</span>);    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; newHeights.length; i++) &#123;        <span class="hljs-comment">// ä¸¥æ ¼é€’å‡ï¼Œåˆ™è®¡ç®—é¢ç§¯</span>        <span class="hljs-keyword">while</span> (newHeights[i] &lt; newHeights[stack.peek()]) &#123;            <span class="hljs-comment">// é«˜åº¦ä¸ºå½“å‰æ ˆé¡¶å…ƒç´ </span>            <span class="hljs-keyword">int</span> height = newHeights[stack.pop()];            <span class="hljs-comment">// æ ˆé¡¶å‡ºæ ˆåï¼Œæ–°çš„æ ˆé¡¶ = å·¦è¾¹å°äº height çš„å…ƒç´ </span>            <span class="hljs-keyword">int</span> width = i - stack.peek() - <span class="hljs-number">1</span>;            res = Math.max(res, height * width);        &#125;        stack.push(i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>å•è°ƒæ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯</title>
    <link href="/2020/09/07/LeetCode-438-find-all-anagrams-in-a-string/"/>
    <url>/2020/09/07/LeetCode-438-find-all-anagrams-in-a-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-all-anagrams-in-a-string/" target="_blank" rel="noopener">438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯</a></p><h1 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h1><p>å³æŒ‡é’ˆä¸æ–­å‘å³ç§»åŠ¨ï¼Œå¹¶ä¸”åˆ¤æ–­å½“å‰å­—ç¬¦å­—ç¬¦æ˜¯å¦æ»¡è¶³ç›®æ ‡å­—ç¬¦çš„å‡ºç°é¢‘ç‡ï¼Œè‹¥ä¸æ»¡è¶³ï¼Œåˆ™ç§»åŠ¨å·¦æŒ‡é’ˆç›´åˆ°æ»¡è¶³ä¸ºæ­¢ã€‚å½“çª—å£å¤§å°æ»¡è¶³è¦æ±‚æ—¶ï¼Œçª—å£å†…çš„æ‰€æœ‰å­—ç¬¦éƒ½æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¿å­˜æ­¤æ—¶çš„ <code>left</code>ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">findAnagrams</span><span class="hljs-params">(String s, String p)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">char</span>[] sChar = s.toCharArray();    <span class="hljs-keyword">char</span>[] pChar = p.toCharArray();    <span class="hljs-comment">// ä¿å­˜ç›®æ ‡å­—ç¬¦ä¸²çš„å­—ç¬¦å‡ºç°é¢‘ç‡</span>    <span class="hljs-keyword">int</span>[] needs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : pChar) &#123;        needs[c - <span class="hljs-string">'a'</span>]++;    &#125;    <span class="hljs-comment">// çª—å£å†…å­—ç¬¦ä¸²çš„å‡ºç°é¢‘ç‡</span>    <span class="hljs-keyword">int</span>[] window = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = p.length();    <span class="hljs-keyword">while</span> (right &lt; s.length()) &#123;        <span class="hljs-keyword">int</span> curPos = sChar[right] - <span class="hljs-string">'a'</span>;        window[curPos]++;        right++;        <span class="hljs-comment">// è®©çª—å£å†…çš„å­—ç¬¦é¢‘ç‡å’Œç›®æ ‡é¢‘ç‡ä¸€è‡´</span>        <span class="hljs-keyword">while</span> (needs[curPos] &lt; window[curPos]) &#123;            window[sChar[left] - <span class="hljs-string">'a'</span>]--;            left++;        &#125;        <span class="hljs-comment">// é•¿åº¦æ»¡è¶³ç›®æ ‡é•¿åº¦</span>        <span class="hljs-keyword">if</span> (right - left == len) &#123;            res.add(left);        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">findAnagrams</span><span class="hljs-params">(String s, String p)</span> </span>&#123;    List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">char</span>[] sChar = s.toCharArray();    <span class="hljs-keyword">char</span>[] pChar = p.toCharArray();    <span class="hljs-comment">// çª—å£ä¸­æ¯ä¸ªæœ‰æ•ˆå­—ç¬¦çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] window = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-comment">// éœ€è¦çš„å­—ç¬¦å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] needs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : pChar) &#123;        needs[c - <span class="hljs-string">'a'</span>]++;    &#125;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> sLen = s.length();    <span class="hljs-keyword">int</span> pLen = p.length();    <span class="hljs-comment">// çª—å£ä¸­æ»¡è¶³è¦æ±‚çš„æœ‰æ•ˆå­—ç¬¦æ•°</span>    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (right &lt; sLen) &#123;        <span class="hljs-keyword">int</span> pos = sChar[right] - <span class="hljs-string">'a'</span>;        <span class="hljs-comment">// ä¸æ˜¯æœ‰æ•ˆå­—ç¬¦</span>        <span class="hljs-keyword">if</span> (needs[pos] == <span class="hljs-number">0</span>) &#123;            right++;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// å½“å‰å­—ç¬¦æ»¡è¶³è¦æ±‚</span>        <span class="hljs-keyword">if</span> (window[pos] &lt; needs[pos]) &#123;            count++;        &#125;        window[pos]++;        right++;        <span class="hljs-comment">// å­—ç¬¦æ•°ç­‰äºç›®æ ‡å¤§å°</span>        <span class="hljs-keyword">while</span> (count == pLen) &#123;            <span class="hljs-comment">// å¼‚ä½è¯ï¼šçª—å£é•¿åº¦ == ç›®æ ‡é•¿åº¦ æ‰æ›´æ–°</span>            <span class="hljs-keyword">if</span> (right - left == pLen) &#123;                res.add(left);            &#125;            <span class="hljs-keyword">int</span> leftPos = sChar[left] - <span class="hljs-string">'a'</span>;            <span class="hljs-comment">// left ä¸åœ¨ç›®æ ‡å­—ç¬¦ä¸­</span>            <span class="hljs-keyword">if</span> (needs[leftPos] == <span class="hljs-number">0</span>) &#123;                left++;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// left åœ¨ç›®æ ‡å­—ç¬¦ä¸­</span>            <span class="hljs-keyword">if</span> (window[leftPos] == needs[leftPos]) &#123;                count--;            &#125;            window[leftPos]--;            left++;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 49. å­—æ¯å¼‚ä½è¯åˆ†ç»„</title>
    <link href="/2020/09/06/LeetCode-49-group-anagrams/"/>
    <url>/2020/09/06/LeetCode-49-group-anagrams/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/group-anagrams/" target="_blank" rel="noopener">49. å­—æ¯å¼‚ä½è¯åˆ†ç»„</a></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;String&gt;&gt; groupAnagrams(String[] strs) &#123;    Map&lt;String, List&lt;String&gt;&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (String s : strs) &#123;        <span class="hljs-keyword">char</span>[] chars = s.toCharArray();        Arrays.sort(chars);        String key = <span class="hljs-keyword">new</span> String(chars);        List&lt;String&gt; list = map.getOrDefault(key, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;());        list.add(s);        map.put(key, list);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(map.values());&#125;</code></pre><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;String&gt;&gt; groupAnagrams(String[] strs) &#123;    Map&lt;String, List&lt;String&gt;&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">for</span> (String s : strs) &#123;        <span class="hljs-comment">// æ•°å­—å“ˆå¸Œï¼Œè‹¥å­—æ¯ç›¸åŒï¼Œåˆ™æœ€ç»ˆçš„å‡ºç°æ¬¡æ•°ç›¸åŒ</span>        <span class="hljs-keyword">char</span>[] keys = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[<span class="hljs-number">26</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : s.toCharArray()) &#123;            keys[c - <span class="hljs-string">'a'</span>]++;        &#125;        String key = <span class="hljs-keyword">new</span> String(keys);        List&lt;String&gt; list = map.getOrDefault(key, <span class="hljs-keyword">new</span> ArrayList&lt;&gt;());        list.add(s);        map.put(key, list);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(map.values());&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 32. æœ€é•¿æœ‰æ•ˆæ‹¬å·</title>
    <link href="/2020/09/05/LeetCode-32-longest-valid-parentheses/"/>
    <url>/2020/09/05/LeetCode-32-longest-valid-parentheses/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-valid-parentheses/" target="_blank" rel="noopener">32. æœ€é•¿æœ‰æ•ˆæ‹¬å·</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200905165736.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">longestValidParentheses</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// åªæœ‰é‡åˆ° ) æ‰èƒ½ç»„æˆæœ‰æ•ˆæ‹¬å·</span>        <span class="hljs-keyword">if</span> (s.charAt(i) == <span class="hljs-string">')'</span>) &#123;            <span class="hljs-comment">// .....() çš„æƒ…å†µ: i - 2 ä½ç½®ä¸Šçš„æœ€é•¿ dp[i - 2] + 2 (æ–°çš„æ‹¬å·)</span>            <span class="hljs-keyword">if</span> (s.charAt(i - <span class="hljs-number">1</span>) == <span class="hljs-string">'('</span>) &#123;                <span class="hljs-keyword">if</span> (i - <span class="hljs-number">2</span> &gt;= <span class="hljs-number">0</span>) &#123;                    dp[i] = <span class="hljs-number">2</span> + dp[i - <span class="hljs-number">2</span>];                &#125; <span class="hljs-keyword">else</span> &#123;                    dp[i] = <span class="hljs-number">2</span>;                &#125;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// pairPos: ä¸ ) é…å¯¹çš„ ( ä½ç½®</span>                <span class="hljs-comment">// .....)) çš„æƒ…å†µ: 2 + [pairPos:i] ä¹‹é—´çš„æœ‰æ•ˆæ‹¬å· + pairPos ä¹‹å‰çš„æœ‰æ•ˆæ‹¬å·</span>                <span class="hljs-keyword">int</span> pairPos = i - dp[i - <span class="hljs-number">1</span>] - <span class="hljs-number">1</span>;                <span class="hljs-comment">// pairPos ä½ç½®æœ‰æ•ˆ &amp;&amp; è¯¥ä½ç½® = '('</span>                <span class="hljs-keyword">if</span> (pairPos &gt;= <span class="hljs-number">0</span> &amp;&amp; s.charAt(pairPos) == <span class="hljs-string">'('</span>) &#123;                    <span class="hljs-keyword">if</span> (pairPos - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>) &#123;                        dp[i] = <span class="hljs-number">2</span> + dp[i - <span class="hljs-number">1</span>] + dp[pairPos - <span class="hljs-number">1</span>];                    &#125; <span class="hljs-keyword">else</span> &#123;                        dp[i] = <span class="hljs-number">2</span> + dp[i - <span class="hljs-number">1</span>];                    &#125;                &#125;            &#125;            res = Math.max(res, dp[i]);        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="æ ˆ"><a class="markdownIt-Anchor" href="#æ ˆ"></a> æ ˆ</h1><p>æ ˆä¸­å­˜æ”¾æœ€åä¸€ä¸ª æ²¡æœ‰è¢«åŒ¹é…çš„æ‹¬å·ä½ç½®ï¼Œç›¸å½“äºä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œå½“è¿›æ¥çš„å³æ‹¬å·æ²¡æœ‰åŒ¹é…æ—¶ï¼Œå°±å¯æ ¹æ®å·®å€¼è®¡ç®—æœ‰æ•ˆæ‹¬å·é•¿åº¦ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">longestValidParentheses</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// æ ˆä¸­å­˜æ”¾æœ€åä¸€ä¸ª æ²¡æœ‰è¢«åŒ¹é…çš„æ‹¬å·ä½ç½®</span>    Deque&lt;Integer&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    stack.push(-<span class="hljs-number">1</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// å·¦æ‹¬å·ç›´æ¥å…¥æ ˆ</span>        <span class="hljs-keyword">if</span> (s.charAt(i) == <span class="hljs-string">'('</span>) &#123;            stack.push(i);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// é‡åˆ°å³æ‹¬å·ï¼Œå…ˆå¼¹å‡ºå†åˆ¤æ–­æ˜¯å¦æœ‰åŒ¹é…çš„å·¦æ‹¬å·</span>            stack.pop();            <span class="hljs-comment">// è‹¥æ ˆç©ºï¼Œè¡¨ç¤ºå½“å‰å³æ‹¬å·æ²¡æœ‰è¢«åŒ¹é…</span>            <span class="hljs-keyword">if</span> (stack.isEmpty()) &#123;                stack.push(i);            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// æ ˆä¸ä¸ºç©ºï¼Œè¡¨ç¤ºå½“å‰å³æ‹¬å·æœ‰åŒ¹é…å…ƒç´ ï¼Œå³è¢«å‡ºæ ˆçš„é‚£ä¸ªå…ƒç´ </span>                <span class="hljs-comment">// æœ‰æ•ˆæ‹¬å·é•¿åº¦ = å½“å‰ä½ç½® - æœ€åä¸€ä¸ªæ²¡æœ‰è¢«åŒ¹é…çš„æ‹¬å·ä½ç½®</span>                res = Math.max(res, i - stack.peek());            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 20. æœ‰æ•ˆçš„æ‹¬å·</title>
    <link href="/2020/09/05/LeetCode-20-valid-parentheses/"/>
    <url>/2020/09/05/LeetCode-20-valid-parentheses/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-parentheses/" target="_blank" rel="noopener">20. æœ‰æ•ˆçš„æ‹¬å·</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(String s)</span> </span>&#123;    Deque&lt;Character&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    Map&lt;Character, Character&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">3</span>);    map.put(<span class="hljs-string">')'</span>, <span class="hljs-string">'('</span>);    map.put(<span class="hljs-string">'&#125;'</span>, <span class="hljs-string">'&#123;'</span>);    map.put(<span class="hljs-string">']'</span>, <span class="hljs-string">'['</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;        <span class="hljs-keyword">char</span> c = s.charAt(i);        <span class="hljs-comment">// å³æ‹¬å·</span>        <span class="hljs-keyword">if</span> (map.containsKey(c)) &#123;            <span class="hljs-keyword">char</span> top = stack.isEmpty() ? <span class="hljs-string">'#'</span> : stack.pop();            <span class="hljs-comment">// å’Œæ ˆé¡¶å…ƒç´ ä¸åŒ¹é…ï¼Œç›´æ¥è¿”å›</span>            <span class="hljs-comment">// å› ä¸ºåç»­å…ƒç´ ä¸ä¼šä¸å½“å‰å³æ‹¬å·åŒ¹é…</span>            <span class="hljs-keyword">if</span> (top != map.get(c)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// å·¦æ‹¬å· || æ ˆä¸ºç©º ç›´æ¥å…¥æ ˆ</span>            stack.push(c);        &#125;    &#125;    <span class="hljs-keyword">return</span> stack.isEmpty();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 91. è§£ç æ–¹æ³•</title>
    <link href="/2020/09/05/LeetCode-91-Decode-Ways/"/>
    <url>/2020/09/05/LeetCode-91-Decode-Ways/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/decode-ways/" target="_blank" rel="noopener">91. è§£ç æ–¹æ³•</a></p><p>è€ƒè™‘ <code>s = 1234</code>ï¼Œåˆ™å¯ä»¥çœ‹æˆä¸¤ç§æ–¹æ¡ˆï¼š<code>234</code> å’Œ <code>34</code>ï¼Œå³å»é™¤ä¸€ä½æˆ–ä¸¤ä½ï¼›è€Œ <code>234</code> å’Œ <code>34</code> åˆå¯ä»¥ç»§ç»­å»é™¤ä¸€ä½æˆ–ä¸¤ä½ï¼Œå½¢æˆæ–°çš„æ–¹æ¡ˆã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200905160755.png" srcset="/img/loading.gif" alt="" /></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200905161307.png" srcset="/img/loading.gif" alt="" /></p><ul><li>çŠ¶æ€ï¼š<code>dp[i]</code> - <code>s[0:i]</code> èƒ½ç»„æˆçš„æ–¹æ¡ˆæ•°</li><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<ul><li><code>s[i]</code> ä¸ä¸º <code>0</code> æ—¶æ‰æœ‰æ•ˆï¼Œæ­¤æ—¶ <code>dp[i] = dp[i - 1]</code></li><li><code>s[i]</code> å’Œ <code>s[i - 1]</code> å¯ä»¥ç»„æˆä¸€ä¸ªæ•°ï¼Œæ­¤æ—¶ <code>dp[i] = dp[i - 2]</code></li></ul></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numDecodings</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length();    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;    <span class="hljs-comment">// dp[1] -&gt; s[0]</span>    dp[<span class="hljs-number">1</span>] = s.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">'0'</span> ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; len + <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-comment">// s[i] ä¸ä¸º 0ï¼Œè¡¨ç¤ºå¯ä»¥å•ç‹¬ç»„æˆä¸€ä¸ªè§£ç æ–¹æ¡ˆ</span>        <span class="hljs-keyword">if</span> (s.charAt(i - <span class="hljs-number">1</span>) != <span class="hljs-string">'0'</span>) &#123;            dp[i] += dp[i - <span class="hljs-number">1</span>];        &#125;        <span class="hljs-comment">// 10 &lt;= s[i - 1:i] &lt;= 26 å¯ä»¥ç»„æˆä¸€ä¸ªè§£ç æ–¹æ¡ˆ</span>        <span class="hljs-keyword">int</span> num = (s.charAt(i - <span class="hljs-number">2</span>) - <span class="hljs-string">'0'</span>) * <span class="hljs-number">10</span> + (s.charAt(i - <span class="hljs-number">1</span>) - <span class="hljs-string">'0'</span>);        <span class="hljs-keyword">if</span> (<span class="hljs-number">10</span> &lt;= num &amp;&amp; num &lt;= <span class="hljs-number">26</span>) &#123;            dp[i] += dp[i - <span class="hljs-number">2</span>];        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[len];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</title>
    <link href="/2020/09/04/LeetCode-3-longest-substring-without-repeating-characters/"/>
    <url>/2020/09/04/LeetCode-3-longest-substring-without-repeating-characters/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/" target="_blank" rel="noopener">3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a></p><p>åˆ¤æ–­é‡å¤ï¼šä½¿ç”¨ <code>map</code> ä¿å­˜å½“å‰å­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè‹¥é‡å¤ï¼Œåˆ™æ ¹æ®è¯¥ä½ç½®æ›´æ–°åŒºé—´çš„èµ·ç‚¹ã€‚</p><p>èµ·ç‚¹å– <code>max</code> çš„åŸå› ï¼šå§‹ç»ˆä¿è¯ <code>start</code> ä¸ä¼šå·¦ç§»ï¼Œå¦åˆ™è‹¥ <code>start &lt; map[c]</code>æ—¶ï¼Œç›´æ¥èµ‹å€¼ <code>start = map[c]</code>ï¼Œä¼šå¯¼è‡´å·¦ç§»ï¼Œå¯èƒ½æ— æ³•è¿‡æ»¤é‡å¤å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">if</span> (s.length() == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// value è¡¨ç¤ºå­—ç¬¦ c æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</span>    Map&lt;Character, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-comment">// [start, end] åŒºé—´å†…çš„å…ƒç´ éƒ½æ˜¯ä¸é‡å¤çš„</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>, end = <span class="hljs-number">0</span>; end &lt; s.length(); end++) &#123;        <span class="hljs-keyword">char</span> c = s.charAt(end);        <span class="hljs-comment">// è‹¥å‡ºç°é‡å¤ï¼Œåˆ™é‡æ–°è®¡ç®— start ä½ç½®</span>        <span class="hljs-keyword">if</span> (map.containsKey(c)) &#123;            <span class="hljs-comment">// å– max çš„åŸå› ï¼šå§‹ç»ˆä¿è¯ start ä¸ä¼šå·¦ç§»ï¼Œè‹¥å·¦ç§»å¯èƒ½æ— æ³•è¿‡æ»¤é‡å¤å€¼</span>            <span class="hljs-comment">// e.g. ...a1...b1....a2...a3....b2... </span>            <span class="hljs-comment">// å½“åˆ°è¾¾ b2ï¼Œæ­¤æ—¶ start = a3, b = b1, è‹¥ä¸å– max, start = b1 + 1, å¯¼è‡´ a é‡å¤</span>            start = Math.max(start, map.get(c) + <span class="hljs-number">1</span>);        &#125;        <span class="hljs-comment">// æ¯æ¬¡éƒ½ä¼šæ›´æ–°æœ€å¤§çš„åŒºé—´</span>        res = Math.max(res, end - start + <span class="hljs-number">1</span>);        <span class="hljs-comment">// æ›´æ–° c çš„æœ€æ–°ä½ç½®ï¼Œè‹¥ä¸‹æ¬¡å‡ºç°é‡å¤çš„ cï¼Œåˆ™ start ä» map[c] + 1 å¼€å§‹è®¡ç®—</span>        map.put(c, end);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ»‘åŠ¨çª—å£</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 300. æœ€é•¿ä¸Šå‡å­åºåˆ—</title>
    <link href="/2020/09/04/LeetCode-300-longest-increasing-subsequence/"/>
    <url>/2020/09/04/LeetCode-300-longest-increasing-subsequence/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-increasing-subsequence/" target="_blank" rel="noopener">300. æœ€é•¿ä¸Šå‡å­åºåˆ—</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><ul><li>çŠ¶æ€ï¼š<code>dp[i]</code> è¡¨ç¤ºä»¥ <code>nums[i]</code> ç»“å°¾çš„ã€Œä¸Šå‡å­åºåˆ—ã€çš„é•¿åº¦</li><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹<ol><li>åœ¨è®¿é—® <code>nums[i]</code> æ—¶ï¼Œéœ€è¦æŠŠ <code>i</code> ä¹‹å‰çš„æ•°éƒ½æŸ¥çœ‹ä¸€éï¼›</li><li>åªè¦ <code>nums[j] &lt; nums[i]</code>ï¼Œè¡¨ç¤ºå¯ä»¥å½¢æˆä¸€ä¸ªä¸Šå‡å­åºåˆ—ï¼›</li><li><code>dp[i] = max(dp[0:i]) + 1</code></li></ol></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLIS</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> len;    &#125;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">int</span> max = -<span class="hljs-number">1</span>;        <span class="hljs-comment">// éå†ä¹‹å‰åºåˆ—ä¸­ä¸Šå‡çš„æ•°ï¼Œæ‰¾åˆ°æœ€å¤§å€¼</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &gt;= <span class="hljs-number">0</span>; j--) &#123;            <span class="hljs-comment">// ä¸¥æ ¼ä¸Šå‡</span>            <span class="hljs-keyword">if</span> (nums[j] &lt; nums[i]) &#123;                <span class="hljs-comment">// å¯»æ‰¾æœ€å¤§ä¸Šå‡å€¼</span>                <span class="hljs-keyword">if</span> (dp[j] &gt; max) &#123;                    max = dp[j];                &#125;            &#125;        &#125;        dp[i] = max == -<span class="hljs-number">1</span> ? <span class="hljs-number">1</span> : max + <span class="hljs-number">1</span>;        res = Math.max(res, dp[i]);    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’-äºŒåˆ†"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’-äºŒåˆ†"></a> åŠ¨æ€è§„åˆ’ + äºŒåˆ†</h1><ul><li>çŠ¶æ€ï¼š<code>tail[i]</code> è¡¨ç¤ºé•¿åº¦ä¸º <code>i + 1</code> çš„æ‰€æœ‰ä¸Šå‡å­åºåˆ—çš„ç»“å°¾çš„æœ€å°å€¼ã€‚ç»“å°¾çš„å…ƒç´ è¶Šå°ï¼Œåˆ™è¶Šå¯èƒ½æ„é€ æ›´é•¿çš„ä¸Šå‡å­åºåˆ—ã€‚</li><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<ol><li>æ¯æ¥ä¸€ä¸ªæ–°æ•° <code>num</code>ï¼Œå¦‚æœè¿™ä¸ªæ•°ä¸¥æ ¼å¤§äºæœ‰åºæ•°ç»„ <code>tail</code> çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°±æŠŠ <code>num</code> æ”¾åœ¨æœ‰åºæ•°ç»„ <code>tail</code> çš„åé¢ï¼›å¦åˆ™è¿›å…¥ 2, 3ã€‚</li><li>å¦‚æœæœ‰åºæ•°ç»„ <code>tail</code> ä¸­å­˜åœ¨ç­‰äº <code>num</code> çš„å…ƒç´ ï¼Œä»€ä¹ˆéƒ½ä¸åšï¼Œå› ä¸ºä»¥ <code>num</code> ç»“å°¾çš„æœ€çŸ­çš„ã€Œä¸Šå‡å­åºåˆ—ã€å·²ç»å­˜åœ¨ï¼›</li><li>å¦‚æœæœ‰åºæ•°ç»„ <code>tail</code> ä¸­å­˜åœ¨å¤§äº <code>num</code> çš„å…ƒç´ ï¼Œæ‰¾åˆ°ç¬¬ <code>1</code> ä¸ªï¼Œè®©å®ƒå˜å°ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°äº†ä¸€ä¸ª<strong>ç»“å°¾æ›´å°çš„ç›¸åŒé•¿åº¦çš„ä¸Šå‡å­åºåˆ—</strong>ã€‚</li></ol></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLIS</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> len;    &#125;    <span class="hljs-comment">// tail[i] è¡¨ç¤ºé•¿åº¦ä¸º i + 1 çš„ LIS åºåˆ— çš„æœ€å°å€¼</span>    <span class="hljs-keyword">int</span>[] tail = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªæ•° LIS é•¿åº¦å³ä¸º 1</span>    tail[<span class="hljs-number">0</span>] = nums[<span class="hljs-number">0</span>];    <span class="hljs-comment">// end è¡¨ç¤º tail ä¸­æœ€åä¸€ä¸ªå·²èµ‹å€¼çš„å…ƒç´ ç´¢å¼•</span>    <span class="hljs-keyword">int</span> end = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (tail[end] &lt; nums[i]) &#123;            <span class="hljs-comment">// æ„é€ é€’å¢çš„ tail æ•°ç»„</span>            tail[++end] = nums[i];        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// tail[end] &gt; nums[i]ï¼Œåˆ™è¿›è¡Œæ›´æ–°</span>            <span class="hljs-comment">// åœ¨ tail ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ª &gt; nums[i] çš„å€¼è¿›è¡Œæ›´æ–°</span>            <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;            <span class="hljs-keyword">int</span> right = end;            <span class="hljs-keyword">while</span> (left &lt; right) &#123;                <span class="hljs-keyword">int</span> mid = left + ((right - left) &gt;&gt;&gt; <span class="hljs-number">1</span>);                <span class="hljs-keyword">if</span> (tail[mid] &lt; nums[i]) &#123;                    left = mid + <span class="hljs-number">1</span>;                &#125; <span class="hljs-keyword">else</span> &#123;                    right = mid;                &#125;            &#125;            <span class="hljs-comment">// &gt; nums[i] çš„å€¼ä¸€å®šå­˜åœ¨ï¼Œç›´æ¥æ›´æ–°</span>            tail[left] = nums[i];        &#125;    &#125;    <span class="hljs-keyword">return</span> end + <span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 72. ç¼–è¾‘è·ç¦»</title>
    <link href="/2020/09/04/LeetCode-72-edit-distance/"/>
    <url>/2020/09/04/LeetCode-72-edit-distance/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/edit-distance/" target="_blank" rel="noopener">72. ç¼–è¾‘è·ç¦»</a></p><ul><li>çŠ¶æ€ï¼š<code>dp[i][j]</code> - <code>word1[0:i]</code> å’Œ <code>word2[0:j]</code> çš„æœ€å°ç¼–è¾‘è·ç¦»ã€‚</li><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<ul><li>è‹¥ <code>i</code>, <code>j</code> ä½ç½®ç›¸ç­‰ï¼Œåˆ™è·³è¿‡ï¼Œå¦åˆ™è¿›è¡Œåˆ é™¤ï¼Œæ’å…¥ï¼Œæ›¿æ¢æ“ä½œï¼Œå–æœ€å°å€¼ã€‚</li><li>åˆ é™¤ <code>word1[i]</code> =&gt; <code>dp[i - 1][j] + 1</code></li><li>åœ¨ <code>word1[i + 1]</code> æ’å…¥ <code>word2[j]</code> =&gt; <code>dp[i][j - 1] + 1</code></li><li>æ›¿æ¢ <code>word1[i]</code> æˆ– <code>word2[j]</code> =&gt; <code>dp[i - 1][j - 1] + 1</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200910115038.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minDistance</span><span class="hljs-params">(String word1, String word2)</span> </span>&#123;    <span class="hljs-keyword">int</span> len1 = word1.length();    <span class="hljs-keyword">int</span> len2 = word2.length();    <span class="hljs-comment">// 0 è¡Œå’Œ 0 åˆ—è¡¨ç¤ºæœ‰ä¸€ä¸ªå•è¯ä¸ºç©ºï¼Œå¦ä¸€ä¸ªå•è¯ä¸ä¸ºç©ºçš„æƒ…å†µ</span>    <span class="hljs-comment">// æ‰€ä»¥è€ƒè™‘åˆ°ç©ºå­—ç¬¦ä¸²çš„æƒ…å†µä¸‹ï¼Œå¤šåˆ†é…ä¸€ä¸ªç©ºé—´</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len1 + <span class="hljs-number">1</span>][len2 + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len1; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len2; i++) &#123;        dp[<span class="hljs-number">0</span>][i] = dp[<span class="hljs-number">0</span>][i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len1; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= len2; j++) &#123;            <span class="hljs-comment">// å­—ç¬¦ç›¸åŒï¼ŒåŒæ—¶å»é™¤è¯¥å­—ç¬¦ï¼Œç›´æ¥å–ä¸Šä¸€ä¸ªè·ç¦»</span>            <span class="hljs-keyword">if</span> (word1.charAt(i - <span class="hljs-number">1</span>) == word2.charAt(j - <span class="hljs-number">1</span>)) &#123;                dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// å­—ç¬¦ä¸åŒï¼Œä¾æ¬¡å°è¯•å»é™¤ä¸åŒä½ç½®ï¼Œå–æœ€å°è·ç¦» + 1</span>                dp[i][j] = Math.min(dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>], Math.min(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - <span class="hljs-number">1</span>])) + <span class="hljs-number">1</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[len1][len2];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</title>
    <link href="/2020/09/04/LeetCode-746-min-cost-climbing-stairs/"/>
    <url>/2020/09/04/LeetCode-746-min-cost-climbing-stairs/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/min-cost-climbing-stairs/" target="_blank" rel="noopener">746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</a></p><table><thead><tr><th style="text-align:center">0</th><th style="text-align:center">1</th><th style="text-align:center">2</th><th style="text-align:center">3</th></tr></thead><tbody><tr><td style="text-align:center">10</td><td style="text-align:center">15</td><td style="text-align:center">20</td><td style="text-align:center"></td></tr></tbody></table><p>çˆ¬ä¸Šç¬¬ <code>3</code> é˜¶æ¥¼æ¢¯å¯ä»¥ä»ç¬¬ <code>1</code> é˜¶çˆ¬ä¸¤æ­¥æˆ–è€…ä»ç¬¬ <code>2</code> é˜¶çˆ¬ä¸€æ­¥ã€‚</p><p>é¢˜æ„ï¼šé˜¶æ¢¯æ€»æ•° = <code>cost.length</code>ï¼Œçˆ¬ä¸Šç¬¬ <code>i</code> é˜¶æ¥¼æ¢¯ &lt;=&gt; ä¸èƒ½ç®—ä¸Šç¬¬ <code>i</code> é˜¶æ¥¼æ¢¯çš„èŠ±è´¹ <code>cost[i]</code>ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ç®—åˆ° <code>i - 1</code> å’Œ <code>i - 2</code> é˜¶æ¥¼æ¢¯ã€‚</p><ul><li>çŠ¶æ€è½¬ç§»æ–¹ç¨‹: <code>dp[i] = Math.min(dp[i - 1], dp[i - 2]) + cost[i]</code></li><li>ç»“æœ: <code>min(dp[len - 1], dp[len - 2])</code></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minCostClimbingStairs</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] cost)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = cost.length;        <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];        dp[<span class="hljs-number">0</span>] = cost[<span class="hljs-number">0</span>];        dp[<span class="hljs-number">1</span>] = cost[<span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; len; i++) &#123;            dp[i] = Math.min(dp[i - <span class="hljs-number">1</span>], dp[i - <span class="hljs-number">2</span>]) + cost[i];        &#125;        <span class="hljs-keyword">return</span> Math.min(dp[len - <span class="hljs-number">1</span>], dp[len - <span class="hljs-number">2</span>]);    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 493. ç¿»è½¬å¯¹</title>
    <link href="/2020/09/03/LeetCode-493-reverse-pairs/"/>
    <url>/2020/09/03/LeetCode-493-reverse-pairs/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-pairs/" target="_blank" rel="noopener">493. ç¿»è½¬å¯¹</a></p><p>è§£æ³•ï¼š</p><ul><li>ä½¿ç”¨å½’å¹¶æ’åºï¼ŒæŠŠæ•°ç»„åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼Œä¸”éƒ½å•è°ƒé€’å¢ï¼›</li><li>åˆ™æ¯æ¬¡éƒ½å›ºå®šå·¦è¾¹å…ƒç´ ï¼Œéå†å³è¾¹å…ƒç´ ï¼›</li><li>å› ä¸ºéƒ½æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ä»ä½ç½®ç´¢å¼•å°±èƒ½è·å–ä¸ªæ•°ï¼Œä¸”å³è¾¹çš„å…ƒç´ åªè¦éå†ä¸€éã€‚</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reversePairs</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">return</span> mergeSort(nums, <span class="hljs-number">0</span>, nums.length - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">mergeSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt; <span class="hljs-number">1</span>;        count = mergeSort(arr, low, mid) + mergeSort(arr, mid + <span class="hljs-number">1</span>, high);        <span class="hljs-comment">// å¯¹äº [low, mid] ä¸­çš„æ¯ä¸ªå…ƒç´ </span>        <span class="hljs-comment">// å¯»æ‰¾ä»–ä»¬åœ¨ [mid + 1, high] ä¸­çš„ç¿»è½¬æ•°</span>        <span class="hljs-keyword">int</span> j = mid + <span class="hljs-number">1</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = low; i &lt;= mid; i++) &#123;            <span class="hljs-comment">// (arr[i] &gt;&gt; 1) + (arr[i] &amp; 1) &gt; arr[j]</span>            <span class="hljs-comment">// while (j &lt;= high &amp;&amp; arr[i] &gt; (long) arr[j] &lt;&lt; 1) &#123;</span>            <span class="hljs-keyword">while</span> (j &lt;= high &amp;&amp; arr[i] &gt; (<span class="hljs-keyword">long</span>) arr[j] * <span class="hljs-number">2</span>) &#123;                j++;            &#125;            count += j - mid - <span class="hljs-number">1</span>;        &#125;        merge(arr, low, mid, high);    &#125;    <span class="hljs-keyword">return</span> count;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = high - low + <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-keyword">int</span> i = low, j = mid + <span class="hljs-number">1</span>, k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= high) &#123;        tmp[k++] = arr[i] &lt; arr[j] ? arr[i++] : arr[j++];    &#125;    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        tmp[k++] = arr[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= high) &#123;        tmp[k++] = arr[j++];    &#125;    System.arraycopy(tmp, <span class="hljs-number">0</span>, arr, low, len);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 56. åˆå¹¶åŒºé—´</title>
    <link href="/2020/09/03/LeetCode-56-merge-intervals/"/>
    <url>/2020/09/03/LeetCode-56-merge-intervals/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/merge-intervals/" target="_blank" rel="noopener">56. åˆå¹¶åŒºé—´</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] merge(<span class="hljs-keyword">int</span>[][] intervals) &#123;    <span class="hljs-keyword">int</span> len = intervals.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> intervals;    &#125;    quickSort(intervals, <span class="hljs-number">0</span>, len - <span class="hljs-number">1</span>);    System.out.println(Arrays.deepToString(intervals));    List&lt;<span class="hljs-keyword">int</span>[]&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">int</span> start = intervals[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];    <span class="hljs-keyword">int</span> end = intervals[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// å¯ä»¥åˆå¹¶ï¼š(i + 1).å¼€å§‹ &lt;= i.ç»“æŸ</span>        <span class="hljs-comment">// å¼€å§‹ = i.å¼€å§‹ï¼Œç»“æŸ = max(i.ç»“æŸ, (i + 1).ç»“æŸ)</span>        <span class="hljs-keyword">if</span> (intervals[i][<span class="hljs-number">0</span>] &lt;= end) &#123;            <span class="hljs-comment">// æ›´æ–° end</span>            end = Math.max(end, intervals[i][<span class="hljs-number">1</span>]);        &#125; <span class="hljs-keyword">else</span> &#123;            list.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;start, end&#125;);            <span class="hljs-comment">// æ›´æ–° startï¼Œç”¨äºä¸‹ä¸€æ¬¡åˆå¹¶</span>            start = intervals[i][<span class="hljs-number">0</span>];            end = intervals[i][<span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-comment">// æ·»åŠ æœ€åä¸€ä¸ªåŒºé—´</span>    list.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;start, end&#125;);    <span class="hljs-keyword">int</span> count = list.size();    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[count][<span class="hljs-number">2</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) &#123;        res[i] = list.get(i);    &#125;    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-keyword">int</span> pivotPos = partition(arr, low, high);        quickSort(arr, low, pivotPos - <span class="hljs-number">1</span>);        quickSort(arr, pivotPos + <span class="hljs-number">1</span>, high);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] pivot = arr[low];    <span class="hljs-keyword">while</span> (low &lt; high) &#123;        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; arr[high][<span class="hljs-number">0</span>] &gt;= pivot[<span class="hljs-number">0</span>]) &#123;            high--;        &#125;        arr[low] = arr[high];        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; arr[low][<span class="hljs-number">0</span>] &lt;= pivot[<span class="hljs-number">0</span>]) &#123;            low++;        &#125;        arr[high] = arr[low];    &#125;    arr[low] = pivot;    <span class="hljs-keyword">return</span> low;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[][] merge(<span class="hljs-keyword">int</span>[][] intervals) &#123;    <span class="hljs-keyword">int</span> len = intervals.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> intervals;    &#125;    Arrays.sort(intervals, Comparator.comparingInt(a -&gt; a[<span class="hljs-number">0</span>]));    <span class="hljs-keyword">int</span>[][] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];    <span class="hljs-keyword">int</span> idx = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] interval : intervals) &#123;        <span class="hljs-comment">// å¯ä»¥åˆå¹¶ï¼šå¼€å§‹ &lt;= ç»“æŸ</span>        <span class="hljs-keyword">if</span> (idx == -<span class="hljs-number">1</span> || interval[<span class="hljs-number">0</span>] &gt; res[idx][<span class="hljs-number">1</span>]) &#123;            <span class="hljs-comment">// æ— æ³•åˆå¹¶æˆ– res ä¸ºç©ºï¼Œæ·»åŠ æ–°åŒºé—´</span>            res[++idx] = interval;        &#125; <span class="hljs-keyword">else</span> &#123;            res[idx][<span class="hljs-number">1</span>] = Math.max(res[idx][<span class="hljs-number">1</span>], interval[<span class="hljs-number">1</span>]);        &#125;    &#125;    <span class="hljs-keyword">return</span> Arrays.copyOf(res, idx + <span class="hljs-number">1</span>);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 242. æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</title>
    <link href="/2020/09/03/LeetCode-242-valid-anagram/"/>
    <url>/2020/09/03/LeetCode-242-valid-anagram/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-anagram/" target="_blank" rel="noopener">242. æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isAnagram</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] sc = s.toCharArray();    <span class="hljs-keyword">char</span>[] tc = t.toCharArray();    Arrays.sort(sc);    Arrays.sort(tc);    <span class="hljs-keyword">return</span> Arrays.equals(sc, tc);&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isAnagram</span><span class="hljs-params">(String s, String t)</span> </span>&#123;    <span class="hljs-keyword">if</span> (s.length() != t.length()) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-keyword">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; s.length(); i++) &#123;        arr[s.charAt(i) - <span class="hljs-string">'a'</span>]++;        arr[t.charAt(i) - <span class="hljs-string">'a'</span>]--;    &#125;    <span class="hljs-comment">// è‹¥åŒä¸€å­—ç¬¦æ•°é‡ä¸ç›¸ç­‰ï¼Œåˆ™å¯¹åº”ä½ç½®ä¸ä¸º 0</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : arr) &#123;        <span class="hljs-keyword">if</span> (value != <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1122. æ•°ç»„çš„ç›¸å¯¹æ’åº</title>
    <link href="/2020/09/03/LeetCode-1122-relative-sort-array/"/>
    <url>/2020/09/03/LeetCode-1122-relative-sort-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/relative-sort-array/" target="_blank" rel="noopener">1122. æ•°ç»„çš„ç›¸å¯¹æ’åº</a></p><p>ä½¿ç”¨è®¡æ•°æ’åºã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] relativeSortArray(<span class="hljs-keyword">int</span>[] arr1, <span class="hljs-keyword">int</span>[] arr2) &#123;    <span class="hljs-keyword">int</span> len1 = arr1.length;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len1];    <span class="hljs-comment">// è®°å½• arr1 ä¸­æ¯ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span>[] bucket = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1001</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr1) &#123;        bucket[num]++;    &#125;    <span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>;    <span class="hljs-comment">// è¾“å‡º arr2 ä¸­å­˜åœ¨äº arr1 ä¸­çš„å…ƒç´ </span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr2) &#123;        <span class="hljs-keyword">while</span> (bucket[num]-- &gt; <span class="hljs-number">0</span>) &#123;            res[k++] = num;        &#125;    &#125;    <span class="hljs-comment">// è‹¥å‰©ä½™çš„å…ƒç´ å‡ºç°æ¬¡æ•° &gt; 0ï¼Œåˆ™ç›´æ¥è¾“å‡º</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; bucket.length; i++) &#123;        <span class="hljs-keyword">while</span> (bucket[i]-- &gt; <span class="hljs-number">0</span>) &#123;            res[k++] = i;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 917. ä»…ä»…åè½¬å­—æ¯</title>
    <link href="/2020/09/02/LeetCode-917-reverse-only-letters/"/>
    <url>/2020/09/02/LeetCode-917-reverse-only-letters/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-only-letters/" target="_blank" rel="noopener">917. ä»…ä»…åè½¬å­—æ¯</a></p><h1 id="åŒæŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#åŒæŒ‡é’ˆ"></a> åŒæŒ‡é’ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseOnlyLetters</span><span class="hljs-params">(String S)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = S.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-comment">// æ‰¾åˆ°å·¦è¾¹ä¸ºå­—æ¯çš„ä½ç½®</span>        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; !Character.isLetter(chars[left])) &#123;            left++;        &#125;        <span class="hljs-comment">// æ‰¾åˆ°å³è¾¹ä¸ºå­—æ¯çš„ä½ç½®</span>        <span class="hljs-keyword">while</span> (left &lt; right &amp;&amp; !Character.isLetter(chars[right])) &#123;            right--;        &#125;        <span class="hljs-keyword">char</span> c = chars[left];        chars[left++] = chars[right];        chars[right--] = c;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(chars);&#125;</code></pre><h1 id="æ ˆ"><a class="markdownIt-Anchor" href="#æ ˆ"></a> æ ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseOnlyLetters</span><span class="hljs-params">(String S)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = S.toCharArray();    Deque&lt;Character&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-comment">// å°†æ‰€æœ‰å­—æ¯å…¥æ ˆ</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        <span class="hljs-keyword">if</span> (Character.isLetter(c)) &#123;            stack.push(c);        &#125;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        <span class="hljs-comment">// è‹¥æ˜¯å­—æ¯ä»æ ˆä¸­å–ï¼Œå¦åˆ™å–å­—ç¬¦ä¸²çš„åŸå­—ç¬¦</span>        <span class="hljs-keyword">if</span> (Character.isLetter(c)) &#123;            sb.append(stack.pop());        &#125; <span class="hljs-keyword">else</span> &#123;            sb.append(c);        &#125;    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 557. åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯ III</title>
    <link href="/2020/09/02/LeetCode-557-reverse-words-in-a-string-iii/"/>
    <url>/2020/09/02/LeetCode-557-reverse-words-in-a-string-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-words-in-a-string-iii/" target="_blank" rel="noopener">557. åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯ III</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseWords</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (chars[i] == <span class="hljs-string">' '</span>) &#123;            reverseWord(chars, start, i - <span class="hljs-number">1</span>);            start = i + <span class="hljs-number">1</span>;        &#125;    &#125;    reverseWord(chars, start, len - <span class="hljs-number">1</span>);    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(chars);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reverseWord</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] chars, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">while</span> (start &lt; end) &#123;        <span class="hljs-keyword">char</span> c = chars[start];        chars[start++] = chars[end];        chars[end--] = c;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 151. ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯</title>
    <link href="/2020/09/02/LeetCode-151-reverse-words-in-a-string/"/>
    <url>/2020/09/02/LeetCode-151-reverse-words-in-a-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-words-in-a-string/" target="_blank" rel="noopener">151. ç¿»è½¬å­—ç¬¦ä¸²é‡Œçš„å•è¯</a></p><h1 id="æ ˆ"><a class="markdownIt-Anchor" href="#æ ˆ"></a> æ ˆ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseWords</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> end = len - <span class="hljs-number">1</span>;    <span class="hljs-comment">// å»é™¤å‰é¢ç©ºæ ¼</span>    <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; chars[start] == <span class="hljs-string">' '</span>) &#123;        start++;    &#125;    <span class="hljs-comment">// å»é™¤åé¢ç©ºæ ¼</span>    <span class="hljs-keyword">while</span> (end &gt;= <span class="hljs-number">0</span> &amp;&amp; chars[end] == <span class="hljs-string">' '</span>) &#123;        end--;    &#125;    <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    System.out.println(chars[end]);    Deque&lt;String&gt; stack = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">int</span> srcPos = start;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt;= end; i++) &#123;        <span class="hljs-keyword">if</span> (chars[i] == <span class="hljs-string">' '</span>) &#123;            String word = s.substring(srcPos, i);            <span class="hljs-comment">// è‹¥æ˜¯ç©ºå•è¯åˆ™è·³è¿‡</span>            <span class="hljs-keyword">if</span> (!<span class="hljs-string">""</span>.equals(word)) &#123;                stack.push(word);            &#125;            srcPos = i + <span class="hljs-number">1</span>;        &#125;        <span class="hljs-comment">// å¤„ç†æœ€åä¸€ä¸ªå•è¯</span>        <span class="hljs-keyword">if</span> (i == end) &#123;            stack.push(s.substring(srcPos, Math.max(end, end + <span class="hljs-number">1</span>)));        &#125;    &#125;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">while</span> (!stack.isEmpty()) &#123;        sb.append(stack.pop());        <span class="hljs-keyword">if</span> (!stack.isEmpty()) &#123;            sb.append(<span class="hljs-string">" "</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> sb.toString();&#125;</code></pre><h1 id="åŒç«¯é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#åŒç«¯é˜Ÿåˆ—"></a> åŒç«¯é˜Ÿåˆ—</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseWords</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> end = len - <span class="hljs-number">1</span>;    <span class="hljs-comment">// å»é™¤å‰é¢ç©ºæ ¼</span>    <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; chars[start] == <span class="hljs-string">' '</span>) &#123;        start++;    &#125;    <span class="hljs-comment">// å»é™¤åé¢ç©ºæ ¼</span>    <span class="hljs-keyword">while</span> (end &gt;= <span class="hljs-number">0</span> &amp;&amp; chars[end] == <span class="hljs-string">' '</span>) &#123;        end--;    &#125;    <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    Deque&lt;String&gt; deque = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    StringBuilder curWord = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start; i &lt;= end; i++) &#123;        <span class="hljs-keyword">char</span> c = chars[i];        <span class="hljs-comment">// å­—ç¬¦ä¸ºç©º &amp;&amp; å•è¯ä¸ä¸ºç©º</span>        <span class="hljs-keyword">if</span> (curWord.length() != <span class="hljs-number">0</span> &amp;&amp; (c == <span class="hljs-string">' '</span>)) &#123;            <span class="hljs-comment">// æ·»åŠ åˆ°é˜Ÿåˆ—å‰éƒ¨</span>            deque.addFirst(curWord.toString());            <span class="hljs-comment">// é‡ç½®å½“å‰å•è¯</span>            curWord.setLength(<span class="hljs-number">0</span>);        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c != <span class="hljs-string">' '</span>) &#123;            curWord.append(c);        &#125;    &#125;    <span class="hljs-comment">// å› ä¸º[start, end] æœ«å°¾ != ' '</span>    <span class="hljs-comment">// æ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ·»åŠ æœ€åä¸€ä¸ªå•è¯</span>    deque.addFirst(curWord.toString());    <span class="hljs-keyword">return</span> String.join(<span class="hljs-string">" "</span>, deque);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
      <tag>æ ˆ</tag>
      
      <tag>é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 541. åè½¬å­—ç¬¦ä¸² II</title>
    <link href="/2020/09/02/LeetCode-541-reverse-string-ii/"/>
    <url>/2020/09/02/LeetCode-541-reverse-string-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-string-ii/" target="_blank" rel="noopener">541. åè½¬å­—ç¬¦ä¸² II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">reverseStr</span><span class="hljs-params">(String s, <span class="hljs-keyword">int</span> k)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span> len = chars.length;    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt; len) &#123;        <span class="hljs-comment">// å¯¹ (i, i + k) ä¹‹é—´çš„å­—ç¬¦ç¿»è½¬</span>        <span class="hljs-comment">// éœ€è¦æ³¨æ„è¶Šç•Œçš„æƒ…å†µ</span>        reverseString(chars, i, Math.min(i + k, len) - <span class="hljs-number">1</span>);        i = i + <span class="hljs-number">2</span> * k;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(chars);&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reverseString</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] s, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">char</span> c = s[left];        s[left] = s[right];        s[right] = c;        left++;        right--;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 344. åè½¬å­—ç¬¦ä¸²</title>
    <link href="/2020/09/02/LeetCode-344-reverse-string/"/>
    <url>/2020/09/02/LeetCode-344-reverse-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-string/" target="_blank" rel="noopener">344. åè½¬å­—ç¬¦ä¸²</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reverseString</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] s)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = s.length;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = len - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">char</span> c = s[left];        s[left] = s[right];        s[right] = c;        left++;        right--;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŒæŒ‡é’ˆ</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 14. æœ€é•¿å…¬å…±å‰ç¼€</title>
    <link href="/2020/09/01/LeetCode-14-longest-common-prefix/"/>
    <url>/2020/09/01/LeetCode-14-longest-common-prefix/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-common-prefix/" target="_blank" rel="noopener">14. æœ€é•¿å…¬å…±å‰ç¼€</a></p><p>åªè¦æ±‚å‰ç¼€è€Œä¸æ˜¯å­ä¸²ï¼Œæ‰€ä»¥å¯ä»¥ä»èµ·ç‚¹å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ã€‚</p><h1 id="è§£æ³•ä¸€æ¨ªå‘æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€æ¨ªå‘æ¯”è¾ƒ"></a> è§£æ³•ä¸€ï¼šæ¨ªå‘æ¯”è¾ƒ</h1><pre><code class="hljs java"> <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">longestCommonPrefix</span><span class="hljs-params">(String[] strs)</span> </span>&#123;    <span class="hljs-keyword">if</span> (strs.length == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    <span class="hljs-comment">// å‡è®¾å‰ç¼€ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²</span>    String res = strs[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; strs.length; i++) &#123;        <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;        <span class="hljs-comment">// å°† res ä¸æ¯ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒ</span>        <span class="hljs-keyword">for</span> (; j &lt; res.length() &amp;&amp; j &lt; strs[i].length(); j++) &#123;            <span class="hljs-keyword">if</span> (res.charAt(j) != strs[i].charAt(j)) &#123;                <span class="hljs-keyword">break</span>;            &#125;        &#125;        <span class="hljs-comment">// j è¡¨ç¤ºå…¬å…±å‰ç¼€çš„ä½ç½®</span>        res = res.substring(<span class="hljs-number">0</span>, j);        <span class="hljs-keyword">if</span> (<span class="hljs-string">""</span>.equals(res)) &#123;            <span class="hljs-keyword">return</span> res;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="è§£æ³•äºŒæ¨ªå‘æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒæ¨ªå‘æ¯”è¾ƒ"></a> è§£æ³•äºŒï¼šæ¨ªå‘æ¯”è¾ƒ</h1><p>è§£æ³•ä¸€çš„å¦ä¸€ç§å†™æ³•</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">longestCommonPrefix</span><span class="hljs-params">(String[] strs)</span> </span>&#123;    <span class="hljs-keyword">if</span> (strs.length == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    String prefix = strs[<span class="hljs-number">0</span>];    <span class="hljs-comment">// ä¸¤ä¸¤æ¯”è¾ƒå‰ç¼€</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; strs.length; i++) &#123;        prefix = getPrefix(prefix, strs[i]);        <span class="hljs-keyword">if</span> (prefix.length() == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">break</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> prefix;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * è·å– str1 å’Œ str2 çš„æœ€é•¿å…¬å…±å‰ç¼€</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> str1</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> str2</span><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getPrefix</span><span class="hljs-params">(String str1, String str2)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = Math.min(str1.length(), str2.length());    <span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">if</span> (str1.charAt(i) != str2.charAt(i)) &#123;            <span class="hljs-keyword">break</span>;        &#125;        idx++;    &#125;    <span class="hljs-keyword">return</span> str1.substring(<span class="hljs-number">0</span>, idx);&#125;</code></pre><h1 id="è§£æ³•ä¸‰çºµå‘æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸‰çºµå‘æ¯”è¾ƒ"></a> è§£æ³•ä¸‰ï¼šçºµå‘æ¯”è¾ƒ</h1><p>å°†æ¯ä¸ªå­—ç¬¦ä¸²çš„æ¯ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">longestCommonPrefix</span><span class="hljs-params">(String[] strs)</span> </span>&#123;    <span class="hljs-keyword">if</span> (strs.length == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;    &#125;    <span class="hljs-keyword">int</span> len = strs[<span class="hljs-number">0</span>].length();    <span class="hljs-comment">// i è¡¨ç¤ºè¦æ¯”è¾ƒçš„æ¯ä¸ªå­—ç¬¦ä½ç½®</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">char</span> cur = strs[<span class="hljs-number">0</span>].charAt(i);        <span class="hljs-comment">// å°†ç¬¬ i ä¸ªå­—ç¬¦ä¸ strs[] é‡Œçš„æ¯ä¸ªä¸²å¯¹åº”ä½ç½®è¿›è¡Œæ¯”è¾ƒ</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; strs.length; j++) &#123;            String str = strs[j];            <span class="hljs-comment">// prefix ä¸²é•¿åº¦ == str é•¿åº¦</span>            <span class="hljs-comment">// å½“å‰ä½ç½®çš„å­—ç¬¦ä¸åŒ¹é…</span>            <span class="hljs-keyword">if</span> (i == str.length() || str.charAt(i) != cur) &#123;                <span class="hljs-keyword">return</span> strs[<span class="hljs-number">0</span>].substring(<span class="hljs-number">0</span>, i);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> strs[<span class="hljs-number">0</span>];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 8. å­—ç¬¦ä¸²è½¬æ¢æ•´æ•° (atoi)</title>
    <link href="/2020/09/01/LeetCode-8-string-to-integer-atoi/"/>
    <url>/2020/09/01/LeetCode-8-string-to-integer-atoi/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/string-to-integer-atoi/" target="_blank" rel="noopener">8. å­—ç¬¦ä¸²è½¬æ¢æ•´æ•° (atoi)</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-keyword">new</span> Solution().myAtoi(<span class="hljs-string">"-2147483647"</span>);    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">myAtoi</span><span class="hljs-params">(String str)</span> </span>&#123;        <span class="hljs-keyword">char</span>[] chars = str.toCharArray();        <span class="hljs-keyword">int</span> len = chars.length;        <span class="hljs-keyword">int</span> start = <span class="hljs-number">0</span>;        <span class="hljs-comment">// å»é™¤å‰éƒ¨çš„ç©ºæ ¼</span>        <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; chars[start] == <span class="hljs-string">' '</span>) &#123;            start++;        &#125;        <span class="hljs-comment">// åˆ°è¾¾ç»ˆç‚¹</span>        <span class="hljs-keyword">if</span> (start == len) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">boolean</span> negative = <span class="hljs-keyword">false</span>;        <span class="hljs-keyword">if</span> (chars[start] == <span class="hljs-string">'-'</span>) &#123;            <span class="hljs-comment">// è´Ÿæ•°</span>            negative = <span class="hljs-keyword">true</span>;            start++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (chars[start] == <span class="hljs-string">'+'</span>) &#123;            <span class="hljs-comment">// æ­£æ•°</span>            start++;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!Character.isDigit(chars[start])) &#123;            <span class="hljs-comment">// é¦–ä½éæ•°å­—</span>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (start &lt; len &amp;&amp; Character.isDigit(chars[start])) &#123;            <span class="hljs-keyword">int</span> digit = chars[start] - <span class="hljs-string">'0'</span>;            <span class="hljs-comment">// æº¢å‡ºåˆ¤æ–­</span>            <span class="hljs-comment">/*if (negative) &#123;</span><span class="hljs-comment">                if (-num &lt; Integer.MIN_VALUE / 10 || (-num == Integer.MIN_VALUE / 10 &amp;&amp; -digit &lt; -8)) &#123;</span><span class="hljs-comment">                    return Integer.MIN_VALUE;</span><span class="hljs-comment">                &#125;</span><span class="hljs-comment">            &#125; else &#123;</span><span class="hljs-comment">                if (num &gt; Integer.MAX_VALUE / 10 || (num == Integer.MAX_VALUE / 10 &amp;&amp; digit &gt; 7)) &#123;</span><span class="hljs-comment">                    return Integer.MAX_VALUE;</span><span class="hljs-comment">                &#125;</span><span class="hljs-comment">            &#125;*/</span>            <span class="hljs-comment">// num * 10 + digit &gt; INT_MAX å¯èƒ½è¶Šç•Œ</span>            <span class="hljs-keyword">if</span> (num &gt; (Integer.MAX_VALUE - digit) / <span class="hljs-number">10</span>) &#123;                <span class="hljs-keyword">return</span> negative ? Integer.MIN_VALUE : Integer.MAX_VALUE;            &#125;            <span class="hljs-comment">// æ‹¼è£…æ•°å­—</span>            num = num * <span class="hljs-number">10</span> + digit;            <span class="hljs-comment">// ä¸‹ä¸€ä½</span>            start++;        &#125;        <span class="hljs-keyword">return</span> negative ? -num : num;    &#125;&#125;</code></pre><h1 id="è§£æ³•äºŒè‡ªåŠ¨æœº"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒè‡ªåŠ¨æœº"></a> è§£æ³•äºŒï¼šè‡ªåŠ¨æœº</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200901204413.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">myAtoi</span><span class="hljs-params">(String str)</span> </span>&#123;        Automaton automaton = <span class="hljs-keyword">new</span> Automaton();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : str.toCharArray()) &#123;            automaton.get(c);        &#125;        <span class="hljs-keyword">return</span> automaton.sign * (<span class="hljs-keyword">int</span>)automaton.ans;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Automaton</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> START = <span class="hljs-number">0</span>;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> SIGNED = <span class="hljs-number">1</span>;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> IN_NUM = <span class="hljs-number">2</span>;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> END = <span class="hljs-number">3</span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è‡ªåŠ¨æœºçš„çŠ¶æ€</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> state = START;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * çŠ¶æ€è½¬ç§»è¡¨</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> Map&lt;Integer, <span class="hljs-keyword">int</span>[]&gt; map;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç¬¦å·</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> sign = <span class="hljs-number">1</span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç»“æœ</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> ans = <span class="hljs-number">0</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Automaton</span><span class="hljs-params">()</span> </span>&#123;        map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        map.put(START, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;START, SIGNED, IN_NUM, END&#125;);        map.put(SIGNED, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;END, END, IN_NUM, END&#125;);        map.put(IN_NUM, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;END, END, IN_NUM, END&#125;);        map.put(END, <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;END, END, END, END&#125;);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCol</span><span class="hljs-params">(<span class="hljs-keyword">char</span> c)</span> </span>&#123;        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">' '</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">'+'</span> || c == <span class="hljs-string">'-'</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">if</span> (Character.isDigit(c)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">char</span> c)</span> </span>&#123;        <span class="hljs-comment">// æ–°çš„çŠ¶æ€</span>        state = map.get(state)[getCol(c)];        <span class="hljs-comment">// è½¬ç§»åˆ° æ•°å­—</span>        <span class="hljs-keyword">if</span> (state == IN_NUM) &#123;            <span class="hljs-keyword">int</span> digit = c - <span class="hljs-string">'0'</span>;            ans = ans * <span class="hljs-number">10</span> + digit;            <span class="hljs-keyword">if</span> (sign == <span class="hljs-number">1</span>) &#123;                <span class="hljs-comment">// æ­£æ•°</span>                ans = Math.min(ans, Integer.MAX_VALUE);            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// è´Ÿæ•°</span>                ans = Math.min(ans, -(<span class="hljs-keyword">long</span>) Integer.MIN_VALUE);            &#125;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state == SIGNED) &#123;            <span class="hljs-comment">// è½¬ç§»åˆ°ç¬¦å·</span>            sign = (c == <span class="hljs-string">'+'</span>) ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;        &#125;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 387. å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦</title>
    <link href="/2020/09/01/LeetCode-387-first-unique-character-in-a-string/"/>
    <url>/2020/09/01/LeetCode-387-first-unique-character-in-a-string/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/first-unique-character-in-a-string/" target="_blank" rel="noopener">387. å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>è®°å½•æ¯ä¸ªå­—æ¯å‡ºç°çš„æ¬¡æ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">firstUniqChar</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">int</span>[] counts = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">26</span>];    <span class="hljs-comment">// è®°å½•æ¯ä¸ªå­—æ¯å‡ºç°çš„æ¬¡æ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : chars) &#123;        counts[c - <span class="hljs-string">'a'</span>]++;    &#125;    <span class="hljs-comment">// å¯»æ‰¾å‡ºç°æ¬¡æ•°ä¸º 1 çš„å­—æ¯ä½ç½®</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; chars.length; i++) &#123;        <span class="hljs-keyword">if</span> (counts[chars[i] - <span class="hljs-string">'a'</span>] == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> i;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>åˆ¤æ–­é¦–æ¬¡å‡ºç°çš„ä½ç½®å’Œæœ€åå‡ºç°çš„ä½ç½®æ˜¯å¦ç›¸ç­‰ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">firstUniqChar</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = s.toCharArray();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; chars.length; i++) &#123;        <span class="hljs-keyword">if</span> (s.indexOf(chars[i]) == s.lastIndexOf(chars[i])) &#123;            <span class="hljs-keyword">return</span> i;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ’åºç®—æ³•</title>
    <link href="/2020/09/01/sorting-algorithms/"/>
    <url>/2020/09/01/sorting-algorithms/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="æ’å…¥æ’åº"><a class="markdownIt-Anchor" href="#æ’å…¥æ’åº"></a> æ’å…¥æ’åº</h1><h2 id="1-ç›´æ¥æ’å…¥æ’åº"><a class="markdownIt-Anchor" href="#1-ç›´æ¥æ’å…¥æ’åº"></a> 1. ç›´æ¥æ’å…¥æ’åº</h2><blockquote><p>å°†æ¯ä¸ªå…ƒç´ ä¾æ¬¡æ’å…¥å‰é¢å·²ç»æ’åºå¥½çš„åºåˆ—ã€‚éœ€è¦åå¤æŠŠå·²æ’åºå…ƒç´ å‘åç§»ï¼Œä¸ºæ–°å…ƒç´ æä¾›æ’å…¥ç©ºé—´ã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šæ¯è¶Ÿæ“ä½œéƒ½è¦æ¯”è¾ƒå…³é”®å­—å’Œç§»åŠ¨å…ƒç´ ï¼Œè€Œæ¯”è¾ƒæ¬¡æ•°å’Œç§»åŠ¨æ¬¡æ•°å–å†³äºå¾…æ’åºè¡¨çš„åˆå§‹çŠ¶æ€ã€‚<ul><li>æœ€å¥½æƒ…å†µï¼šå…ƒç´ å·²ç»æœ‰åºï¼Œæ¯ä¸ªå…ƒç´ åªéœ€æ¯”è¾ƒä¸€æ¬¡ - <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>æœ€åæƒ…å†µï¼šå…ƒç´ é€†åº - <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>å¹³å‡ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong> - æ¯æ¬¡æ’å…¥æ€»æ˜¯å…ˆæ¯”è¾ƒå†ç§»åŠ¨ï¼Œä¸ä¼šå‡ºç°ç›¸åŒå…ƒç´ çš„ç›¸å¯¹ä½ç½®å˜åŒ–ã€‚</li><li><strong>é€‚ç”¨æ€§</strong>ï¼šé€‚ç”¨äºé¡ºåºå­˜å‚¨å’Œé“¾å¼å­˜å‚¨çš„çº¿æ€§è¡¨</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insertSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> cur, j;    <span class="hljs-comment">// ä½ç½® 0 ä½œä¸ºç¬¬ä¸€ä¸ªæœ‰åºå…ƒç´ </span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; arr.length; i++) &#123;        <span class="hljs-comment">// å½“ cur &lt; å‰ä¸€ä¸ªå…ƒç´ ï¼Œè¿›è¡Œæ’åº</span>        <span class="hljs-keyword">if</span> (arr[i] &lt; arr[i - <span class="hljs-number">1</span>]) &#123;            cur = arr[i];            <span class="hljs-comment">// åç§»ç›´åˆ° cur &gt;= arr[j]</span>            <span class="hljs-keyword">for</span> (j = i - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span> &amp;&amp; arr[j] &gt; cur; --j) &#123;                arr[j + <span class="hljs-number">1</span>] = arr[j];            &#125;            <span class="hljs-comment">// æ’å…¥å½“å‰å…ƒç´ </span>            arr[j + <span class="hljs-number">1</span>] = cur;        &#125;    &#125;&#125;</code></pre><h2 id="2-æŠ˜åŠæ’å…¥æ’åº"><a class="markdownIt-Anchor" href="#2-æŠ˜åŠæ’å…¥æ’åº"></a> 2. æŠ˜åŠæ’å…¥æ’åº</h2><blockquote><p>åœ¨æŸ¥æ‰¾æœ‰åºè¡¨æ—¶ä½¿ç”¨æŠ˜åŠæŸ¥æ‰¾å®ç°ã€‚</p></blockquote><p>ä»…ä»…å‡å°‘äº†æ¯”è¾ƒæ¬¡æ•°ï¼Œå…¶ä»–ä¸ç›´æ¥æ’å…¥ç›¸åŒã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insertSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> low, high;    <span class="hljs-keyword">int</span> cur;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; arr.length; i++) &#123;        cur = arr[i];        low = <span class="hljs-number">0</span>;        high = i - <span class="hljs-number">1</span>;        <span class="hljs-comment">// low = high + 1 æ—¶ç»“æŸï¼Œå³ low ä¸ºæœ€ç»ˆæ’å…¥ä½ç½®</span>        <span class="hljs-keyword">while</span> (low &lt;= high) &#123;            <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt; <span class="hljs-number">1</span>;            <span class="hljs-keyword">if</span> (arr[mid] &gt; cur) &#123;                high = mid - <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                low = mid + <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-comment">// ç§»åŠ¨ low ç›´åˆ° i ä½ç½®</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i - <span class="hljs-number">1</span>; j &gt;= low; j--) &#123;            arr[j + <span class="hljs-number">1</span>] = arr[j];        &#125;        arr[low] = cur;    &#125;&#125;</code></pre><h2 id="3-å¸Œå°”æ’åº"><a class="markdownIt-Anchor" href="#3-å¸Œå°”æ’åº"></a> 3. å¸Œå°”æ’åº</h2><blockquote><p>æ ¹æ®å¢é‡åºåˆ—ï¼Œå¯¹å­åºåˆ—è¿›è¡Œæ’åºã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šä¾èµ–äºå¢é‡å‡½æ•°<ul><li><strong>æœ€å¥½</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>æœ€å</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>å¹³å‡</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>1.3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{1.3})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ä¸ç¨³å®š</strong> - å½“ç›¸åŒå…ƒç´ è¢«åˆ’åˆ†åˆ°ä¸åŒçš„å­åºåˆ—æ—¶ï¼Œç›¸å¯¹ä½ç½®å¯èƒ½æ”¹å˜ã€‚</li><li><strong>é€‚ç”¨æ€§</strong>ï¼šé¡ºåºå­˜å‚¨çš„çº¿æ€§è¡¨</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shellSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = arr.length;    <span class="hljs-keyword">int</span> cur;    <span class="hljs-keyword">int</span> j;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> dk = n / <span class="hljs-number">2</span>; dk &gt;= <span class="hljs-number">1</span>; dk /= <span class="hljs-number">2</span>) &#123;        <span class="hljs-comment">// å¯¹å¢é‡ dk å†…çš„æ¯ä¸ªå…ƒç´ æ’åº</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = dk + <span class="hljs-number">1</span>; i &lt; n; i++) &#123;            <span class="hljs-keyword">if</span> (arr[i] &lt; arr[i - dk]) &#123;                cur = arr[i];                <span class="hljs-comment">// å¯»æ‰¾æ’å…¥ä½ç½®</span>                <span class="hljs-keyword">for</span> (j = i - dk; j &gt;= <span class="hljs-number">0</span> &amp;&amp; arr[j] &gt; cur; j -= dk) &#123;                    arr[j + dk] = arr[j];                &#125;                arr[j + dk] = cur;            &#125;        &#125;    &#125;&#125;</code></pre><h1 id="äº¤æ¢æ’åº"><a class="markdownIt-Anchor" href="#äº¤æ¢æ’åº"></a> äº¤æ¢æ’åº</h1><h2 id="1-å†’æ³¡æ’åº"><a class="markdownIt-Anchor" href="#1-å†’æ³¡æ’åº"></a> 1. å†’æ³¡æ’åº</h2><blockquote><p>ä¸¤ä¸¤æ¯”è¾ƒç›¸é‚»å…ƒç´ çš„å€¼ï¼Œè‹¥é€†åºåˆ™äº¤æ¢ï¼Œä¸€è¶Ÿå†’æ³¡ç»“æŸåï¼Œå½“å‰æ­¥éª¤çš„æœ€å¤§å…ƒç´ åˆ°è¾¾æœ€ç»ˆä½ç½®ã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<ul><li><strong>æœ€å¥½</strong>ï¼šåˆå§‹åºåˆ—æœ‰åº - <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>æœ€å</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>å¹³å‡</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong> - å…ƒç´ ç›¸ç­‰æ—¶ä¸è¿›è¡Œäº¤æ¢</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bubbleSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; arr.length - <span class="hljs-number">1</span> - i; j++) &#123;            <span class="hljs-keyword">if</span> (arr[j] &gt; arr[j + <span class="hljs-number">1</span>]) &#123;                <span class="hljs-keyword">int</span> t = arr[j];                arr[j] = arr[j + <span class="hljs-number">1</span>];                arr[j + <span class="hljs-number">1</span>] = t;            &#125;        &#125;    &#125;&#125;</code></pre><h2 id="2-å¿«é€Ÿæ’åº"><a class="markdownIt-Anchor" href="#2-å¿«é€Ÿæ’åº"></a> 2. å¿«é€Ÿæ’åº</h2><blockquote><p>é€‰å–ä¸€ä¸ªåŸºå‡†å…ƒç´ ï¼Œå°†æ’åºè¡¨åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¯¥å…ƒç´ è¢«æ”¾åˆ°æœ€ç»ˆä½ç½®ï¼Œé€’å½’æ‰§è¡Œè¯¥è¿‡ç¨‹ã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šä¸æ ˆæ·±åº¦ä¸€è‡´<ul><li>æœ€å¥½ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log_2(n+1))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li>æœ€åï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(logn)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>å¹³å‡ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šä¸åˆ’åˆ†æ˜¯å¦å¯¹ç§°æœ‰å…³<ul><li><strong>æœ€å¥½</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>æœ€å</strong>ï¼šæœ‰åºæˆ–é€†åº - <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>å¹³å‡</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ä¸ç¨³å®š</strong> - ä¼šè¿›è¡Œå·¦å³åŒºé—´çš„äº¤æ¢</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-comment">// pivot çš„æœ€ç»ˆä½ç½®</span>        <span class="hljs-keyword">int</span> pivotPos = partition(arr, low, high);        <span class="hljs-comment">// å¯¹å·¦åŠéƒ¨åˆ†é€’å½’æ’åº</span>        quickSort(arr, low, pivotPos - <span class="hljs-number">1</span>);        <span class="hljs-comment">// å¯¹å³åŠéƒ¨åˆ†é€’å½’æ’åº</span>        quickSort(arr, pivotPos + <span class="hljs-number">1</span>, high);    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> pivot = arr[low];    <span class="hljs-keyword">while</span> (low &lt; high) &#123;        <span class="hljs-comment">// æ‰¾åˆ°æ¯” low å°çš„å…ƒç´ </span>        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; arr[high] &gt;= pivot) &#123;            <span class="hljs-comment">// å‘å‰æŸ¥æ‰¾</span>            high--;        &#125;        <span class="hljs-comment">// å°å…ƒç´ ç§»åˆ° low</span>        arr[low] = arr[high];        <span class="hljs-comment">// æ‰¾åˆ°æ¯” pivot å¤§çš„å…ƒç´ </span>        <span class="hljs-keyword">while</span> (low &lt; high &amp;&amp; arr[low] &lt;= pivot) &#123;            <span class="hljs-comment">// å‘åæŸ¥æ‰¾</span>            low++;        &#125;        <span class="hljs-comment">// å¤§å…ƒç´ ç§»åˆ° high</span>        arr[high] = arr[low];    &#125;    <span class="hljs-comment">// pivot çš„æœ€ç»ˆä½ç½®</span>    arr[low] = pivot;    <span class="hljs-keyword">return</span> low;&#125;</code></pre><h1 id="é€‰æ‹©æ’åº"><a class="markdownIt-Anchor" href="#é€‰æ‹©æ’åº"></a> é€‰æ‹©æ’åº</h1><h2 id="1-ç®€å•é€‰æ‹©æ’åº"><a class="markdownIt-Anchor" href="#1-ç®€å•é€‰æ‹©æ’åº"></a> 1. ç®€å•é€‰æ‹©æ’åº</h2><blockquote><p>åœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å¤§ï¼ˆæœ€å°ï¼‰å€¼ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„æœ«å°¾ã€‚ä¸€è¶Ÿæ’åºå¯ä»¥ç¡®å®šä¸€ä¸ªå…ƒç´ çš„æœ€ç»ˆä½ç½®ã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ä¸ç¨³å®š</strong></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = arr.length;    <span class="hljs-comment">// ä» 0 å¼€å§‹å­˜æ”¾å…ƒç´ </span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i++) &#123;        <span class="hljs-keyword">int</span> min = i;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; n; j++) &#123;            <span class="hljs-comment">// æ‰¾åˆ°æœ€å°çš„å…ƒç´ ä½ç½®</span>            <span class="hljs-keyword">if</span> (arr[j] &lt; arr[min]) &#123;                min = j;            &#125;        &#125;        <span class="hljs-comment">// äº¤æ¢ç¬¬ i ä¸ªå…ƒç´ å’Œ min</span>        <span class="hljs-keyword">if</span> (min != i) &#123;            swap(arr, i, min);        &#125;    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> min)</span> </span>&#123;    <span class="hljs-keyword">int</span> t = arr[i];    arr[i] = arr[min];    arr[min] = t;&#125;</code></pre><h2 id="2-å †æ’åº"><a class="markdownIt-Anchor" href="#2-å †æ’åº"></a> 2. å †æ’åº</h2><blockquote><p>ä½¿ç”¨å¤§é¡¶å †æˆ–å°é¡¶å †ã€‚</p></blockquote><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] sortArray(<span class="hljs-keyword">int</span>[] nums) &#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// å°†æ•°ç»„æ•´ç†æˆå †</span>    heapify(nums);    <span class="hljs-comment">// å¾ªç¯ä¸å˜é‡ï¼šåŒºé—´ [0, i] å †æœ‰åº</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">1</span>; ) &#123;        <span class="hljs-comment">// æŠŠå †é¡¶å…ƒç´ ï¼ˆå½“å‰æœ€å¤§ï¼‰äº¤æ¢åˆ°æ•°ç»„æœ«å°¾</span>        swap(nums, <span class="hljs-number">0</span>, i);        <span class="hljs-comment">// é€æ­¥å‡å°‘å †æœ‰åºçš„éƒ¨åˆ†</span>        i--;        <span class="hljs-comment">// ä¸‹æ ‡ 0 ä½ç½®ä¸‹æ²‰æ“ä½œï¼Œä½¿å¾—åŒºé—´ [0, i] å †æœ‰åº</span>        siftDown(nums, <span class="hljs-number">0</span>, i);    &#125;    <span class="hljs-keyword">return</span> nums;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å°†æ•°ç»„æ•´ç†æˆå †ï¼ˆå †æœ‰åºï¼‰</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> nums</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">heapify</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-comment">// åªéœ€è¦ä» i = (len - 1) / 2 è¿™ä¸ªä½ç½®å¼€å§‹é€å±‚ä¸‹ç§»</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = (len - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        siftDown(nums, i, len - <span class="hljs-number">1</span>);    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> nums</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> k    å½“å‰ä¸‹æ²‰å…ƒç´ çš„ä¸‹æ ‡</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> end  [0, end] æ˜¯ nums çš„æœ‰æ•ˆéƒ¨åˆ†</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">siftDown</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">while</span> (<span class="hljs-number">2</span> * k &lt; end) &#123;        <span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span> * k + <span class="hljs-number">1</span>;        <span class="hljs-comment">// å·¦ç»“ç‚¹ &lt; å³ç»“ç‚¹ï¼Œj æŒ‡å‘å³ç»“ç‚¹</span>        <span class="hljs-keyword">if</span> (j &lt; end &amp;&amp; nums[j + <span class="hljs-number">1</span>] &gt; nums[j]) &#123;            j++;        &#125;        <span class="hljs-comment">// å­ç»“ç‚¹å¤§äºçˆ¶ç»“ç‚¹</span>        <span class="hljs-keyword">if</span> (nums[j] &gt; nums[k]) &#123;            swap(nums, j, k);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">break</span>;        &#125;        k = j;    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;    <span class="hljs-keyword">int</span> temp = nums[i];    nums[i] = nums[j];    nums[j] = temp;&#125;</code></pre><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ä¸ç¨³å®š</strong></li></ul><h1 id="å½’å¹¶æ’åº"><a class="markdownIt-Anchor" href="#å½’å¹¶æ’åº"></a> å½’å¹¶æ’åº</h1><h2 id="1-äºŒè·¯å½’å¹¶æ’åº"><a class="markdownIt-Anchor" href="#1-äºŒè·¯å½’å¹¶æ’åº"></a> 1. äºŒè·¯å½’å¹¶æ’åº</h2><blockquote><p>å°†ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„æœ‰åºè¡¨ç»„åˆæˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ã€‚</p></blockquote><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ä¸€è¶Ÿå½’å¹¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ï¼Œå…± <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">log_2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span></span></span></span> è¶Ÿ</li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mergeSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">if</span> (low &lt; high) &#123;        <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt; <span class="hljs-number">1</span>;        mergeSort(arr, low, mid);        mergeSort(arr, mid + <span class="hljs-number">1</span>, high);        merge(arr, low, mid, high);    &#125;&#125;<span class="hljs-comment">// å†™æ³•ä¸€</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[arr.length];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = low; i &lt;= high; i++) &#123;        tmp[i] = arr[i];    &#125;    <span class="hljs-keyword">int</span> i, j, k;    <span class="hljs-comment">// åˆå¹¶ [low, mid]...[mid + 1, high]</span>    <span class="hljs-keyword">for</span> (i = low, j = mid + <span class="hljs-number">1</span>, k = i; i &lt;= mid &amp;&amp; j &lt;= high; k++) &#123;        <span class="hljs-keyword">if</span> (tmp[i] &lt; tmp[j]) &#123;            arr[k] = tmp[i];            i++;        &#125; <span class="hljs-keyword">else</span> &#123;            arr[k] = tmp[j];            j++;        &#125;    &#125;    <span class="hljs-comment">// åˆå¹¶å‰©ä½™å…ƒç´ </span>    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        arr[k++] = tmp[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= high) &#123;        arr[k++] = tmp[j++];    &#125;&#125;<span class="hljs-comment">// å†™æ³•äºŒ</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> mid, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = high - low + <span class="hljs-number">1</span>;    <span class="hljs-keyword">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len];    <span class="hljs-comment">// [low...mid] [mid + 1, high]</span>    <span class="hljs-keyword">int</span> i = low, j = mid + <span class="hljs-number">1</span>, k = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= high) &#123;        tmp[k++] = nums[i] &gt; nums[j] ? nums[j++] : nums[i++];    &#125;    <span class="hljs-keyword">while</span> (i &lt;= mid) &#123;        tmp[k++] = nums[i++];    &#125;    <span class="hljs-keyword">while</span> (j &lt;= high) &#123;        tmp[k++] = nums[j++];    &#125;    System.arraycopy(tmp, <span class="hljs-number">0</span>, nums, low, len);&#125;</code></pre><h1 id="éæ¯”è¾ƒæ’åº"><a class="markdownIt-Anchor" href="#éæ¯”è¾ƒæ’åº"></a> éæ¯”è¾ƒæ’åº</h1><h2 id="1-è®¡æ•°æ’åº"><a class="markdownIt-Anchor" href="#1-è®¡æ•°æ’åº"></a> 1. è®¡æ•°æ’åº</h2><blockquote><p>å°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ã€‚ ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ã€‚</p></blockquote><p>å±€é™æ€§ï¼š</p><ol><li>å½“æ•°åˆ—æœ€å¤§æœ€å°å€¼å·®è·è¿‡å¤§æ—¶ï¼Œå¹¶ä¸é€‚ç”¨è®¡æ•°æ’åºã€‚</li><li>å½“æ•°åˆ—å…ƒç´ ä¸æ˜¯æ•´æ•°ï¼Œå¹¶ä¸é€‚ç”¨è®¡æ•°æ’åºã€‚</li></ol><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span>[] countSort(<span class="hljs-keyword">int</span>[] arr) &#123;    <span class="hljs-keyword">int</span> max = Integer.MIN_VALUE;    <span class="hljs-keyword">int</span> min = Integer.MAX_VALUE;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        max = Math.max(max, num);        min = Math.min(min, num);    &#125;    <span class="hljs-comment">// æ¡¶æ•°ç»„çš„å¤§å°ä¸º æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®å€¼</span>    <span class="hljs-keyword">int</span>[] bucket = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[max - min + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : arr) &#123;        <span class="hljs-comment">// value åç§»ä½ç½® = value - min</span>        bucket[value - min]++;    &#125;    <span class="hljs-comment">// å¯¹æ¯ä¸ªå€¼åŠ ä¸Šä¹‹å‰çš„å’Œ ä½œä¸ºå½“å‰å€¼</span>    <span class="hljs-comment">// bucket[i] è¡¨ç¤º ç¬¬ i ä¸ªå…ƒç´ çš„é¡ºåº</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; bucket.length; i++) &#123;        bucket[i] += bucket[i - <span class="hljs-number">1</span>];    &#125;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[arr.length];    <span class="hljs-comment">// è·å–åŸæ•°ç»„çš„æ¯ä¸ªå…ƒç´ çš„æ–°ä½ç½®</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : arr) &#123;        <span class="hljs-comment">// ç¬¬ value - min ä¸ªå…ƒç´ çš„åºå·</span>        <span class="hljs-keyword">int</span> pos = bucket[value - min] - <span class="hljs-number">1</span>;        res[pos] = value;        <span class="hljs-comment">// æ›´æ–° ç¬¬ value - min ä¸ªå…ƒç´ çš„æ–°ä½ç½®ï¼šç”¨äºé‡å¤å…ƒç´ çš„æƒ…å†µ</span>        bucket[value - min]--;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong></li><li>å…¶æ’åºé€Ÿåº¦å¿«äºä»»ä½•æ¯”è¾ƒæ’åºç®—æ³•ã€‚å½“ <code>k</code> ä¸æ˜¯å¾ˆå¤§å¹¶ä¸”åºåˆ—æ¯”è¾ƒé›†ä¸­æ—¶ï¼Œè®¡æ•°æ’åºæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚</li></ul><h2 id="2-æ¡¶æ’åº"><a class="markdownIt-Anchor" href="#2-æ¡¶æ’åº"></a> 2. æ¡¶æ’åº</h2><blockquote><p>å°†æ•°æ®åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶å†åˆ†åˆ«æ’åºï¼Œæœ€åè¾“å‡ºæ¯ä¸ªæ¡¶çš„æ•°æ®ã€‚</p></blockquote><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bucketSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> bucketCount = arr.length;    <span class="hljs-keyword">int</span> min = arr[<span class="hljs-number">0</span>];    <span class="hljs-keyword">int</span> max = arr[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : arr) &#123;        min = Math.min(min, value);        max = Math.max(max, value);    &#125;    <span class="hljs-comment">// æ¯ä¸ªæ¡¶çš„å¤§å°</span>    <span class="hljs-keyword">double</span> space = (<span class="hljs-keyword">double</span>) (max - min) / (bucketCount - <span class="hljs-number">1</span>);    <span class="hljs-comment">// åˆå§‹åŒ–æ¡¶</span>    List&lt;List&lt;Integer&gt;&gt; buckets = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; bucketCount; i++) &#123;        buckets.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());    &#125;    <span class="hljs-comment">// æ¯ä¸ªæ•°æ®å…¥æ¡¶</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : arr) &#123;        <span class="hljs-comment">// æ¯ä¸ªå…ƒç´ å¯¹åº”çš„æ¡¶åºå·</span>        <span class="hljs-keyword">int</span> bucket = (<span class="hljs-keyword">int</span>) ((value - min) / space) - <span class="hljs-number">1</span>;        <span class="hljs-keyword">if</span> (bucket &lt; <span class="hljs-number">0</span>) &#123;            bucket = <span class="hljs-number">0</span>;        &#125;        buckets.get(bucket).add(value);    &#125;    <span class="hljs-comment">// å¯¹æ¯ä¸ªæ¡¶æ’åº</span>    <span class="hljs-keyword">for</span> (List&lt;Integer&gt; bucket : buckets) &#123;        Collections.sort(bucket);    &#125;    <span class="hljs-comment">// è¾“å‡ºæ¡¶å†…çš„æ¯ä¸ªå…ƒç´ </span>    <span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (List&lt;Integer&gt; bucket : buckets) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : bucket) &#123;            arr[idx++] = num;        &#125;    &#125;&#125;</code></pre><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<ul><li><strong>æœ€å¥½</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li><strong>æœ€å</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong>å¹³å‡</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n + k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li></ul></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong></li></ul><h2 id="3-åŸºæ•°æ’åº"><a class="markdownIt-Anchor" href="#3-åŸºæ•°æ’åº"></a> 3. åŸºæ•°æ’åº</h2><blockquote><p>æŒ‰ç…§ä½ä½å…ˆæ’åºï¼Œç„¶åæ”¶é›†ï¼›å†æŒ‰ç…§é«˜ä½æ’åºï¼Œç„¶åå†æ”¶é›†ï¼›ä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æœ€é«˜ä½ã€‚</p></blockquote><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">radixSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] arr)</span> </span>&#123;    <span class="hljs-keyword">int</span> max = arr[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;        max = Math.max(max, num);    &#125;    List&lt;List&lt;Integer&gt;&gt; buckets = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-comment">// ä½™æ•° 0 ~ 9 å¯¹åº”çš„æ¡¶</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i++) &#123;            buckets.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;());    &#125;    <span class="hljs-comment">// å½“å‰æ’åºä½ç½®</span>    <span class="hljs-keyword">int</span> location = <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;        <span class="hljs-keyword">int</span> radix = (<span class="hljs-keyword">int</span>) Math.pow(<span class="hljs-number">10</span>, (location - <span class="hljs-number">1</span>));        <span class="hljs-comment">// max &lt; éœ€è¦å–ä½™çš„æ•°ï¼Œè¯´æ˜æ¯ä¸€ä½éƒ½å·²æ’åºå®Œæˆ</span>        <span class="hljs-keyword">if</span> (max &lt; radix) &#123;            <span class="hljs-keyword">break</span>;        &#125;        <span class="hljs-comment">// æŠŠæ¯ä¸ªå…ƒç´ æ”¾å…¥å¯¹åº”çš„æ¡¶</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : arr) &#123;            <span class="hljs-comment">// è®¡ç®—ä½™æ•°</span>            <span class="hljs-keyword">int</span> bucket = (num / radix) % <span class="hljs-number">10</span>;            buckets.get(bucket).add(num);        &#125;        <span class="hljs-comment">// å–å‡ºæ¡¶å†…å…ƒç´ å†™å›åŸæ•°ç»„</span>        <span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : buckets.get(i)) &#123;                arr[idx++] = num;            &#125;            <span class="hljs-comment">// æ¸…ç©ºæœ¬æ¬¡æ’åºçš„æ¡¶</span>            buckets.get(i).clear();        &#125;        location++;    &#125;&#125;</code></pre><ul><li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></li><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(d(n + r))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></li><li><strong>ç¨³å®šæ€§</strong>ï¼š<strong>ç¨³å®š</strong></li></ul><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æ¯ä¸€æ¬¡æ’åºä¹‹åéƒ½èƒ½ç¡®å®šè‡³å°‘ä¸€ä¸ªå…ƒç´ ä½ç½®çš„æ’åºæ–¹æ³•åŒ…æ‹¬ï¼š</p><ol><li><p><strong>é€‰æ‹©æ’åº</strong>ï¼šæ¯æ¬¡å°†æœ€å¤§çš„æ•°æ”¾åˆ°æœ€åã€‚æ‰€ä»¥æœ€å¤§çš„æ•°æ’ä¸€æ¬¡åºåä½ç½®å°±ç¡®å®šäº†ã€‚</p></li><li><p><strong>å†’æ³¡æ’åº</strong>ï¼šåŒé€‰æ‹©æ’åºã€‚æ¯ä¸€æ¬¡æ’åºæœ€å¤§çš„å€¼ä½ç½®ç¡®å®šã€‚</p></li><li><p><strong>å¿«æ’</strong>ï¼šæ¯ä¸€æ¬¡æ’åº <code>pivot</code> çš„ä½ç½®ç¡®å®šã€‚</p></li><li><p><strong>å †æ’åº</strong>ï¼šæ¯ä¸€æ¬¡æ’åºæ—¶ï¼Œéƒ½æ˜¯å°†å †é¡¶çš„å…ƒç´ å’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹äº’æ¢ï¼Œç„¶åè°ƒæ•´å †ï¼Œå†å°†å †å¤§å°å‡1ã€‚æ‰€ä»¥æ¯ä¸€æ¬¡æ’åºå †é¡¶å…ƒç´ ç¡®å®šã€‚</p></li></ol><table><thead><tr><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">æœ€å¥½</th><th style="text-align:center">å¹³å‡</th><th style="text-align:center">æœ€å</th><th style="text-align:center">ç©ºé—´å¤æ‚åº¦</th><th style="text-align:center">ç¨³å®šæ€§</th></tr></thead><tbody><tr><td style="text-align:center">ç›´æ¥æ’å…¥</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr><tr><td style="text-align:center">å¸Œå°”</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>1.3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^{1.3})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">.</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><code>ä¸ç¨³å®š</code></td></tr><tr><td style="text-align:center">å†’æ³¡</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr><tr><td style="text-align:center">å¿«æ’</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><code>ä¸ç¨³å®š</code></td></tr><tr><td style="text-align:center">ç®€å•é€‰æ‹©</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><code>ä¸ç¨³å®š</code></td></tr><tr><td style="text-align:center">å †æ’åº</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><code>ä¸ç¨³å®š</code></td></tr><tr><td style="text-align:center">äºŒè·¯å½’å¹¶</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(nlog_2n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr><tr><td style="text-align:center">è®¡æ•°æ’åº</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr><tr><td style="text-align:center">æ¡¶æ’åº</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n+k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr><tr><td style="text-align:center">åŸºæ•°æ’åº</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>d</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(d(d+r))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>d</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(d(d+r))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>d</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(d(d+r))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center">ç¨³å®š</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ’åº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 771. å®çŸ³ä¸çŸ³å¤´</title>
    <link href="/2020/08/31/LeetCode-771-jewels-and-stones/"/>
    <url>/2020/08/31/LeetCode-771-jewels-and-stones/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/jewels-and-stones/" target="_blank" rel="noopener">771. å®çŸ³ä¸çŸ³å¤´</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numJewelsInStones</span><span class="hljs-params">(String J, String S)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">char</span>[] js = J.toCharArray();    <span class="hljs-keyword">char</span>[] ss = S.toCharArray();    Set&lt;Character&gt; set = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : js) &#123;        set.add(c);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : ss) &#123;        <span class="hljs-keyword">if</span> (set.contains(c)) &#123;            count++;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 58. æœ€åä¸€ä¸ªå•è¯çš„é•¿åº¦</title>
    <link href="/2020/08/31/LeetCode-58-length-of-last-word/"/>
    <url>/2020/08/31/LeetCode-58-length-of-last-word/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/length-of-last-word/" target="_blank" rel="noopener">58. æœ€åä¸€ä¸ªå•è¯çš„é•¿åº¦</a></p><p>éœ€è¦æ³¨æ„æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºç©ºçš„æƒ…å†µã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">lengthOfLastWord</span><span class="hljs-params">(String s)</span> </span>&#123;    <span class="hljs-keyword">int</span> end = s.length() - <span class="hljs-number">1</span>;    <span class="hljs-comment">// æ‰¾åˆ°æœ«å°¾ä¸ä¸ºç©ºçš„å­—ç¬¦ä½ç½®</span>    <span class="hljs-keyword">while</span> (end &gt;= <span class="hljs-number">0</span> &amp;&amp; s.charAt(end) == <span class="hljs-string">' '</span>) &#123;        end--;    &#125;    <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// ä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªç©ºçš„ä½ç½®</span>    <span class="hljs-keyword">int</span> start = end;    <span class="hljs-keyword">while</span> (start &gt;= <span class="hljs-number">0</span> &amp;&amp; s.charAt(start) != <span class="hljs-string">' '</span>) &#123;        start--;    &#125;    <span class="hljs-keyword">return</span> end - start;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 709. è½¬æ¢æˆå°å†™å­—æ¯</title>
    <link href="/2020/08/31/LeetCode-709-to-lower-case/"/>
    <url>/2020/08/31/LeetCode-709-to-lower-case/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/to-lower-case/" target="_blank" rel="noopener">709. è½¬æ¢æˆå°å†™å­—æ¯</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toLowerCase</span><span class="hljs-params">(String str)</span> </span>&#123;    <span class="hljs-keyword">char</span>[] chars = str.toCharArray();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; chars.length; i++) &#123;        <span class="hljs-keyword">if</span> (chars[i] &gt;= <span class="hljs-string">'A'</span> &amp;&amp; chars[i] &lt;= <span class="hljs-string">'Z'</span>) &#123;            chars[i] = (<span class="hljs-keyword">char</span>) (chars[i] + <span class="hljs-number">32</span>);        &#125;    &#125;    <span class="hljs-keyword">return</span> String.valueOf(chars);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 146. LRU ç¼“å­˜æœºåˆ¶</title>
    <link href="/2020/08/30/LeetCode-146-lru-cache/"/>
    <url>/2020/08/30/LeetCode-146-lru-cache/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/lru-cache/" target="_blank" rel="noopener">146. LRUç¼“å­˜æœºåˆ¶</a></p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * ç»“ç‚¹ç±»</span><span class="hljs-comment"> */</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    <span class="hljs-keyword">int</span> key;    <span class="hljs-keyword">int</span> value;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key, <span class="hljs-keyword">int</span> value)</span> </span>&#123;        <span class="hljs-keyword">this</span>.key = key;        <span class="hljs-keyword">this</span>.value = value;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LRUCache</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Cache å¯¹åº”çš„é“¾è¡¨ï¼Œç”¨äºå¢åˆ ç»“ç‚¹ O(1)</span><span class="hljs-comment">     * Node&lt;k1, v1&gt; -&gt; Node&lt;k2, v2&gt; -&gt; ...</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> LinkedList&lt;Node&gt; cache;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * key åˆ° Node çš„æ˜ å°„ï¼Œç”¨äºæŸ¥è¯¢ O(1)</span><span class="hljs-comment">     * key -&gt; Node</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> Map&lt;Integer, Node&gt; map;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æœ€å¤§å®¹é‡</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> capacity;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">LRUCache</span><span class="hljs-params">(<span class="hljs-keyword">int</span> capacity)</span> </span>&#123;        cache = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        <span class="hljs-keyword">this</span>.capacity = capacity;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è‹¥ key å­˜åœ¨ï¼Œè¿”å›ï¼Œä¸”è¦æŠŠå¯¹åº”ç»“ç‚¹ç§»åˆ°å‰é¢</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> value</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>&#123;        <span class="hljs-keyword">if</span> (map.containsKey(key)) &#123;            <span class="hljs-keyword">int</span> value = map.get(key).value;            <span class="hljs-comment">// ä½¿ç”¨ put æ–¹æ³•ç§»åŠ¨å·²å­˜åœ¨ç»“ç‚¹åˆ°å‰é¢</span>            put(key, value);            <span class="hljs-keyword">return</span> value;        &#125;        <span class="hljs-comment">// ç»“ç‚¹ä¸å­˜åœ¨</span>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è‹¥ key å­˜åœ¨ï¼Œåˆ é™¤æ—§ç»“ç‚¹ï¼Œæ·»åŠ æ–°ç»“ç‚¹ï¼Œå¹¶æŠŠå¯¹åº”ç»“ç‚¹ç§»åˆ°å‰é¢</span><span class="hljs-comment">     * å¦åˆ™æ’å…¥æ–°ç»“ç‚¹</span><span class="hljs-comment">     * è‹¥å®¹é‡è¾¾åˆ°ä¸Šé™ï¼Œåˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„ç»“ç‚¹</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> value</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key, <span class="hljs-keyword">int</span> value)</span> </span>&#123;        Node node = <span class="hljs-keyword">new</span> Node(key, value);        <span class="hljs-comment">// è¯¥ç»“ç‚¹å·²å­˜åœ¨</span>        <span class="hljs-keyword">if</span> (map.containsKey(key)) &#123;            <span class="hljs-comment">// åˆ é™¤æ—§ç»“ç‚¹</span>            cache.remove(map.get(key));            map.remove(key);        &#125;        <span class="hljs-comment">// è¯¥ç»“ç‚¹ä¸å­˜åœ¨ï¼Œåˆ™è¦åˆ¤æ–­æ˜¯å¦æœ‰ç©ºä½ç½®ç”¨æ¥æ–°å¢ç»“ç‚¹</span>        <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// cache å®¹é‡è¾¾åˆ°ä¸Šé™ï¼Œåˆ é™¤æœ€åä¸€ä¸ªç»“ç‚¹</span>            <span class="hljs-keyword">if</span> (cache.size() == capacity) &#123;                Node last = cache.getLast();                cache.removeLast();                map.remove(last.key);            &#125;        &#125;        <span class="hljs-comment">// æ·»åŠ æ–°ç»“ç‚¹</span>        cache.addFirst(node);        map.put(key, node);    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸ƒéš†è¿‡æ»¤å™¨</title>
    <link href="/2020/08/29/bloom-filter/"/>
    <url>/2020/08/29/bloom-filter/</url>
    
    <content type="html"><![CDATA[<h1 id="bloom-filter-æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#bloom-filter-æ¦‚å¿µ"></a> <code>Bloom Filter</code> æ¦‚å¿µ</h1><p>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆ<code>Bloom Filter</code>ï¼‰æ˜¯1970å¹´ç”±ä¸€ä¸ªå«å¸ƒéš†çš„å°ä¼™å­æå‡ºçš„ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ç³»åˆ—éšæœºæ˜ å°„å‡½æ•°ã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡å’Œåˆ é™¤å›°éš¾ã€‚</p><p><em><strong>é¢è¯•å…³è”ï¼šä¸€èˆ¬éƒ½ä¼šåœ¨å›ç­”ç¼“å­˜ç©¿é€ï¼Œæˆ–è€…æµ·é‡æ•°æ®å»é‡è¿™ä¸ªæ—¶å€™å¼•å‡ºæ¥ï¼ŒåŠ åˆ†é¡¹å“Ÿ</strong></em></p><h1 id="bloom-filter-åŸç†"><a class="markdownIt-Anchor" href="#bloom-filter-åŸç†"></a> <code>Bloom Filter</code> åŸç†</h1><p>å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†æ˜¯ï¼Œå½“ä¸€ä¸ªå…ƒç´ è¢«åŠ å…¥é›†åˆæ—¶ï¼Œé€šè¿‡ <code>K</code> ä¸ªæ•£åˆ—å‡½æ•°å°†è¿™ä¸ªå…ƒç´ æ˜ å°„æˆä¸€ä¸ªä½æ•°ç»„ä¸­çš„ <code>K</code> ä¸ªç‚¹ï¼ŒæŠŠå®ƒä»¬ç½®ä¸º <code>1</code>ã€‚æ£€ç´¢æ—¶ï¼Œæˆ‘ä»¬åªè¦çœ‹çœ‹è¿™äº›ç‚¹æ˜¯ä¸æ˜¯éƒ½æ˜¯ <code>1</code> å°±ï¼ˆå¤§çº¦ï¼‰çŸ¥é“é›†åˆä¸­æœ‰æ²¡æœ‰å®ƒäº†ï¼š</p><ul><li>å¦‚æœè¿™äº›ç‚¹æœ‰ä»»ä½•ä¸€ä¸ª <code>0</code>ï¼Œåˆ™è¢«æ£€å…ƒç´ ä¸€å®šä¸åœ¨ï¼›</li><li>å¦‚æœéƒ½æ˜¯ <code>1</code>ï¼Œåˆ™è¢«æ£€å…ƒç´ å¾ˆå¯èƒ½åœ¨ã€‚è¿™å°±æ˜¯å¸ƒéš†è¿‡æ»¤å™¨çš„åŸºæœ¬æ€æƒ³ã€‚</li></ul><p><code>Bloom Filter</code> è·Ÿå•å“ˆå¸Œå‡½æ•° <code>Bit-Map</code> ä¸åŒä¹‹å¤„åœ¨äºï¼š<code>Bloom Filter</code> ä½¿ç”¨äº† <code>k</code> ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²è·Ÿ <code>k</code> ä¸ª <code>bit</code> å¯¹åº”ã€‚ä»è€Œé™ä½äº†å†²çªçš„æ¦‚ç‡ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200829182232.jpeg" srcset="/img/loading.gif" alt="" /></p><p>ç®€å•çš„è¯´ä¸€ä¸‹å°±æ˜¯æˆ‘ä»¬å…ˆæŠŠæˆ‘ä»¬æ•°æ®åº“çš„æ•°æ®éƒ½åŠ è½½åˆ°æˆ‘ä»¬çš„è¿‡æ»¤å™¨ä¸­ï¼Œæ¯”å¦‚æ•°æ®åº“çš„ <code>id</code> ç°åœ¨æœ‰ï¼š<code>1</code>ã€<code>2</code>ã€<code>3</code></p><p>é‚£å°±ç”¨ <code>id = 1</code> ä¸ºä¾‹å­ä»–åœ¨ä¸Šå›¾ä¸­ç»è¿‡ä¸‰æ¬¡ <code>hash</code> ä¹‹åï¼ŒæŠŠä¸‰æ¬¡åŸæœ¬å€¼ <code>0</code> çš„åœ°æ–¹æ”¹ä¸º <code>1</code>ã€‚</p><p>ä¸‹æ¬¡æˆ‘è¿›æ¥æŸ¥è¯¢å¦‚æœ <code>id</code>ä¹Ÿæ˜¯ <code>1</code> é‚£æˆ‘å°±æŠŠ <code>1</code> æ‹¿å»ä¸‰æ¬¡ <code>hash</code> å‘ç°è·Ÿä¸Šé¢çš„ä¸‰ä¸ªä½ç½®å®Œå…¨ä¸€æ ·ï¼Œé‚£å°±èƒ½è¯æ˜è¿‡æ»¤å™¨ä¸­æœ‰ <code>1</code> çš„ã€‚</p><p>åä¹‹å¦‚æœä¸ä¸€æ ·å°±è¯´æ˜ä¸å­˜åœ¨äº†</p><p>é‚£åº”ç”¨çš„åœºæ™¯åœ¨å“ªé‡Œå‘¢ï¼Ÿä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šç”¨æ¥<strong>é˜²æ­¢ç¼“å­˜å‡»ç©¿</strong>ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯ä½ æ•°æ®åº“çš„idéƒ½æ˜¯1å¼€å§‹ç„¶åè‡ªå¢çš„ï¼Œé‚£æˆ‘çŸ¥é“ä½ æ¥å£æ˜¯é€šè¿‡ <code>id</code> æŸ¥è¯¢çš„ï¼Œæˆ‘å°±æ‹¿è´Ÿæ•°å»æŸ¥è¯¢ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¼šå‘ç°ç¼“å­˜é‡Œé¢æ²¡è¿™ä¸ªæ•°æ®ï¼Œæˆ‘åˆå»æ•°æ®åº“æŸ¥ä¹Ÿæ²¡æœ‰ï¼Œä¸€ä¸ªè¯·æ±‚è¿™æ ·ï¼Œ100 ä¸ªï¼Œ1000 ä¸ªï¼Œ10000 ä¸ªå‘¢ï¼Ÿä½ çš„ DB åŸºæœ¬ä¸Šå°±æ‰›ä¸ä½äº†ï¼Œå¦‚æœåœ¨ç¼“å­˜é‡Œé¢åŠ ä¸Šè¿™ä¸ªï¼Œæ˜¯ä¸æ˜¯å°±ä¸å­˜åœ¨äº†ï¼Œä½ åˆ¤æ–­æ²¡è¿™ä¸ªæ•°æ®å°±ä¸å»æŸ¥äº†ï¼Œç›´æ¥ return ä¸€ä¸ªæ•°æ®ä¸ºç©ºä¸å°±å¥½äº†å˜›ã€‚</p><p>è¿™ç©æ„è¿™ä¹ˆå¥½ä½¿é‚£æœ‰å•¥ç¼ºç‚¹ä¹ˆï¼Ÿæœ‰çš„ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹</p><h1 id="bloom-filter-çš„ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#bloom-filter-çš„ç¼ºç‚¹"></a> Bloom Filter çš„ç¼ºç‚¹</h1><p><code>Bloom Filter</code> ä¹‹æ‰€ä»¥èƒ½åšåˆ°åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šçš„æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œæ˜¯å› ä¸ºç‰ºç‰²äº†åˆ¤æ–­çš„å‡†ç¡®ç‡ã€åˆ é™¤çš„ä¾¿åˆ©æ€§</p><ul><li><p><strong>å­˜åœ¨è¯¯åˆ¤</strong>ã€‚å¯èƒ½è¦æŸ¥åˆ°çš„å…ƒç´ å¹¶æ²¡æœ‰åœ¨å®¹å™¨ä¸­ï¼Œä½†æ˜¯ <code>hash</code> ä¹‹åå¾—åˆ°çš„ <code>k</code> ä¸ªä½ç½®ä¸Šå€¼éƒ½æ˜¯ <code>1</code>ã€‚å¦‚æœ <code>bloom filter</code> ä¸­å­˜å‚¨çš„æ˜¯é»‘åå•ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å»ºç«‹ä¸€ä¸ªç™½åå•æ¥å­˜å‚¨å¯èƒ½ä¼šè¯¯åˆ¤çš„å…ƒç´ ã€‚</p></li><li><p><strong>åˆ é™¤å›°éš¾</strong>ã€‚ä¸€ä¸ªæ”¾å…¥å®¹å™¨çš„å…ƒç´ æ˜ å°„åˆ° <code>bit</code> æ•°ç»„çš„ <code>k</code> ä¸ªä½ç½®ä¸Šæ˜¯ <code>1</code>ï¼Œåˆ é™¤çš„æ—¶å€™ä¸èƒ½ç®€å•çš„ç›´æ¥ç½®ä¸º <code>0</code>ï¼Œå¯èƒ½ä¼šå½±å“å…¶ä»–å…ƒç´ çš„åˆ¤æ–­ã€‚å¯ä»¥é‡‡ç”¨ <a href="http://wiki.corp.qunar.com/confluence/download/attachments/199003276/US9740797.pdf?version=1&amp;modificationDate=1526538500000&amp;api=v2" target="_blank" rel="noopener">Counting Bloom Filter</a></p></li></ul><h1 id="bloom-filter-å®ç°"><a class="markdownIt-Anchor" href="#bloom-filter-å®ç°"></a> <code>Bloom Filter</code> å®ç°</h1><p>å¸ƒéš†è¿‡æ»¤å™¨æœ‰è®¸å¤šå®ç°ä¸ä¼˜åŒ–ï¼ŒGuavaä¸­å°±æä¾›äº†ä¸€ç§ <code>Bloom Filter</code> çš„å®ç°ã€‚</p><ul><li><p>åœ¨ä½¿ç”¨ <code>bloom filter</code> æ—¶ï¼Œç»•ä¸è¿‡çš„ä¸¤ç‚¹æ˜¯é¢„ä¼°æ•°æ®é‡ <code>n</code> ä»¥åŠæœŸæœ›çš„è¯¯åˆ¤ç‡ <code>fpp</code>ï¼Œ</p></li><li><p>åœ¨å®ç° <code>bloom filter</code> æ—¶ï¼Œç»•ä¸è¿‡çš„ä¸¤ç‚¹å°±æ˜¯ <code>hash</code> å‡½æ•°çš„é€‰å–ä»¥åŠ <code>bit</code> æ•°ç»„çš„å¤§å°ã€‚</p></li></ul><p>å¯¹äºä¸€ä¸ªç¡®å®šçš„åœºæ™¯ï¼Œæˆ‘ä»¬é¢„ä¼°è¦å­˜çš„æ•°æ®é‡ä¸º <code>n</code>ï¼ŒæœŸæœ›çš„è¯¯åˆ¤ç‡ä¸º <code>fpp</code>ï¼Œç„¶åéœ€è¦è®¡ç®—æˆ‘ä»¬éœ€è¦çš„ <code>Bit</code> æ•°ç»„çš„å¤§å° <code>m</code>ï¼Œä»¥åŠ <code>hash</code> å‡½æ•°çš„ä¸ªæ•° <code>k</code>ï¼Œå¹¶é€‰æ‹© <code>hash</code> å‡½æ•°</p><h2 id="1-bit-æ•°ç»„å¤§å°é€‰æ‹©"><a class="markdownIt-Anchor" href="#1-bit-æ•°ç»„å¤§å°é€‰æ‹©"></a> (1) <code>Bit</code> æ•°ç»„å¤§å°é€‰æ‹©</h2><p>æ ¹æ®é¢„ä¼°æ•°æ®é‡ <code>n</code> ä»¥åŠè¯¯åˆ¤ç‡ <code>fpp</code>ï¼Œ<code>bit</code> æ•°ç»„å¤§å°çš„ <code>m</code> çš„è®¡ç®—æ–¹å¼ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>=</mo><mo>âˆ’</mo><mfrac><mrow><mi>n</mi><mi>l</mi><mi>n</mi><mi>f</mi><mi>p</mi><mi>p</mi></mrow><mrow><mo stretchy="false">(</mo><mi>l</mi><mi>n</mi><mn>2</mn><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">m = -\frac{nlnfpp}{(ln2)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3074399999999997em;vertical-align:-0.936em;"></span><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="2-å“ˆå¸Œå‡½æ•°é€‰æ‹©"><a class="markdownIt-Anchor" href="#2-å“ˆå¸Œå‡½æ•°é€‰æ‹©"></a> (2) å“ˆå¸Œå‡½æ•°é€‰æ‹©</h2><p>ç”±é¢„ä¼°æ•°æ®é‡ <code>n</code> ä»¥åŠ <code>bit</code> æ•°ç»„é•¿åº¦ <code>m</code>ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª <code>hash</code> å‡½æ•°çš„ä¸ªæ•° <code>k</code>ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><mi>m</mi><mi>n</mi></mfrac><mi>l</mi><mi>n</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">k = \frac{m}{n}ln2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord">2</span></span></span></span></span></p><p>å“ˆå¸Œå‡½æ•°çš„é€‰æ‹©å¯¹æ€§èƒ½çš„å½±å“åº”è¯¥æ˜¯å¾ˆå¤§çš„ï¼Œä¸€ä¸ªå¥½çš„å“ˆå¸Œå‡½æ•°è¦èƒ½è¿‘ä¼¼ç­‰æ¦‚ç‡çš„å°†å­—ç¬¦ä¸²æ˜ å°„åˆ°å„ä¸ª<code>Bit</code>ã€‚é€‰æ‹© <code>k</code> ä¸ªä¸åŒçš„å“ˆå¸Œå‡½æ•°æ¯”è¾ƒéº»çƒ¦ï¼Œä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯é€‰æ‹©ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œç„¶åé€å…¥ <code>k</code> ä¸ªä¸åŒçš„å‚æ•°ã€‚</p><p>å“ˆå¸Œå‡½æ•°ä¸ªæ•° <code>k</code>ã€ä½æ•°ç»„å¤§å° <code>m</code>ã€åŠ å…¥çš„å­—ç¬¦ä¸²æ•°é‡ <code>n</code> çš„å…³ç³»å¯ä»¥å‚è€ƒ <a href="http://pages.cs.wisc.edu/~cao/papers/summary-cache/node8.html" target="_blank" rel="noopener">Bloom Filters - the math</a>ï¼Œ<a href="https://en.wikipedia.org/wiki/Bloom_filter" target="_blank" rel="noopener">Bloom_filter-wikipedia</a></p><h1 id="åº”ç”¨"><a class="markdownIt-Anchor" href="#åº”ç”¨"></a> åº”ç”¨</h1><h2 id="ä½¿ç”¨æ–¹æ³•"><a class="markdownIt-Anchor" href="#ä½¿ç”¨æ–¹æ³•"></a> ä½¿ç”¨æ–¹æ³•</h2><p>è¦ä½¿ç”¨ <code>BloomFilter</code>ï¼Œéœ€è¦å¼•å…¥ <code>guava</code>åŒ…ï¼š</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>23.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre><p>æµ‹è¯•åˆ†ä¸¤æ­¥ï¼š<br />1ã€å¾€è¿‡æ»¤å™¨ä¸­æ”¾ä¸€ç™¾ä¸‡ä¸ªæ•°ï¼Œç„¶åå»éªŒè¯è¿™ä¸€ç™¾ä¸‡ä¸ªæ•°æ˜¯å¦èƒ½é€šè¿‡è¿‡æ»¤å™¨<br />2ã€å¦å¤–æ‰¾ä¸€ä¸‡ä¸ªæ•°ï¼Œå»æ£€éªŒæ¼ç½‘ä¹‹é±¼çš„æ•°é‡</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * æµ‹è¯•å¸ƒéš†è¿‡æ»¤å™¨</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestBloomFilter</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> total = <span class="hljs-number">100_0000</span>;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> BloomFilter&lt;Integer&gt; bf = BloomFilter.create(Funnels.integerFunnel(), total);<span class="hljs-comment">//    private static BloomFilter&lt;Integer&gt; bf = BloomFilter.create(Funnels.integerFunnel(), total, 0.001);</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-comment">// åˆå§‹åŒ– 1000000 æ¡æ•°æ®åˆ°è¿‡æ»¤å™¨ä¸­</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; total; i++) &#123;            bf.put(i);        &#125;        <span class="hljs-comment">// åŒ¹é…å·²åœ¨è¿‡æ»¤å™¨ä¸­çš„å€¼ï¼Œæ˜¯å¦æœ‰åŒ¹é…ä¸ä¸Šçš„</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; total; i++) &#123;            <span class="hljs-keyword">if</span> (!bf.mightContain(i)) &#123;                System.out.println(<span class="hljs-string">"æœ‰åäººé€ƒè„±äº†~~~"</span>);            &#125;        &#125;        <span class="hljs-comment">// åŒ¹é…ä¸åœ¨è¿‡æ»¤å™¨ä¸­çš„ 10000 ä¸ªå€¼ï¼Œæœ‰å¤šå°‘åŒ¹é…å‡ºæ¥</span>        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = total; i &lt; total + <span class="hljs-number">10000</span>; i++) &#123;            <span class="hljs-keyword">if</span> (bf.mightContain(i)) &#123;                count++;            &#125;        &#125;        System.out.println(<span class="hljs-string">"è¯¯ä¼¤çš„æ•°é‡ï¼š"</span> + count);    &#125;&#125;</code></pre><h2 id="æºç "><a class="markdownIt-Anchor" href="#æºç "></a> æºç </h2><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">BloomFilter&lt;T&gt; <span class="hljs-title">create</span><span class="hljs-params">(Funnel&lt;? <span class="hljs-keyword">super</span> T&gt; funnel, <span class="hljs-keyword">int</span> expectedInsertions)</span> </span>&#123;        <span class="hljs-keyword">return</span> create(funnel, (<span class="hljs-keyword">long</span>) expectedInsertions);    &#125;      <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">BloomFilter&lt;T&gt; <span class="hljs-title">create</span><span class="hljs-params">(Funnel&lt;? <span class="hljs-keyword">super</span> T&gt; funnel, <span class="hljs-keyword">long</span> expectedInsertions)</span> </span>&#123;        <span class="hljs-keyword">return</span> create(funnel, expectedInsertions, <span class="hljs-number">0.03</span>); <span class="hljs-comment">// FYI, for 3%, we always get 5 hash functions</span>    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">BloomFilter&lt;T&gt; <span class="hljs-title">create</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">          Funnel&lt;? <span class="hljs-keyword">super</span> T&gt; funnel, <span class="hljs-keyword">long</span> expectedInsertions, <span class="hljs-keyword">double</span> fpp)</span> </span>&#123;        <span class="hljs-keyword">return</span> create(funnel, expectedInsertions, fpp, BloomFilterStrategies.MURMUR128_MITZ_64);    &#125;    <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">BloomFilter&lt;T&gt; <span class="hljs-title">create</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">      Funnel&lt;? <span class="hljs-keyword">super</span> T&gt; funnel, <span class="hljs-keyword">long</span> expectedInsertions, <span class="hljs-keyword">double</span> fpp, Strategy strategy)</span> </span>&#123;     ......    &#125;</code></pre><p><code>BloomFilter</code> ä¸€å…±å››ä¸ª <code>create</code> æ–¹æ³•ï¼Œä¸è¿‡æœ€ç»ˆéƒ½æ˜¯èµ°å‘ç¬¬å››ä¸ªã€‚çœ‹ä¸€ä¸‹æ¯ä¸ªå‚æ•°çš„å«ä¹‰ï¼š</p><ol><li><p><code>funnel</code>ï¼šæ•°æ®ç±»å‹(ä¸€èˆ¬æ˜¯è°ƒç”¨ <code>Funnels</code> å·¥å…·ç±»ä¸­çš„)</p></li><li><p><code>expectedInsertions</code>ï¼šæœŸæœ›æ’å…¥çš„å€¼çš„ä¸ªæ•°</p></li><li><p><code>fpp</code> é”™è¯¯ç‡(é»˜è®¤å€¼ä¸º <code>0.03</code>)</p></li><li><p><code>strategy</code> å“ˆå¸Œç®—æ³•</p></li></ol><p>ä½¿ç”¨ç¬¬ä¸‰ä¸ª <code>create</code> æ–¹æ³•ï¼Œæˆ‘ä»¬è®¾ç½®ä¸‹é”™è¯¯ç‡ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> BloomFilter&lt;Integer&gt; bf = BloomFilter.create(Funnels.integerFunnel(), total, <span class="hljs-number">0.0003</span>);</code></pre><p><strong>é”™è¯¯ç‡è¶Šå¤§ï¼Œæ‰€éœ€ç©ºé—´å’Œæ—¶é—´è¶Šå°ï¼Œé”™è¯¯ç‡è¶Šå°ï¼Œæ‰€éœ€ç©ºé—´å’Œæ—¶é—´è¶Šå¤§ã€‚</strong></p><h2 id="åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#åº”ç”¨åœºæ™¯"></a> åº”ç”¨åœºæ™¯</h2><ul><li><p><code>cerberus</code> åœ¨æ”¶é›†ç›‘æ§æ•°æ®çš„æ—¶å€™, æœ‰çš„ç³»ç»Ÿçš„ç›‘æ§é¡¹é‡ä¼šå¾ˆå¤§, éœ€è¦æ£€æŸ¥ä¸€ä¸ªç›‘æ§é¡¹çš„åå­—æ˜¯å¦å·²ç»è¢«è®°å½•åˆ° db è¿‡äº†, å¦‚æœæ²¡æœ‰çš„è¯å°±éœ€è¦å†™å…¥ db.</p></li><li><p>çˆ¬è™«è¿‡æ»¤å·²æŠ“åˆ°çš„ url å°±ä¸å†æŠ“ï¼Œå¯ç”¨ bloom filter è¿‡æ»¤</p></li><li><p>åƒåœ¾é‚®ä»¶è¿‡æ»¤ã€‚å¦‚æœç”¨å“ˆå¸Œè¡¨ï¼Œæ¯å­˜å‚¨ä¸€äº¿ä¸ª email åœ°å€ï¼Œå°±éœ€è¦ 1.6GB çš„å†…å­˜ï¼ˆç”¨å“ˆå¸Œè¡¨å®ç°çš„å…·ä½“åŠæ³•æ˜¯å°†æ¯ä¸€ä¸ª email åœ°å€å¯¹åº”æˆä¸€ä¸ªå…«å­—èŠ‚çš„ä¿¡æ¯æŒ‡çº¹ï¼Œç„¶åå°†è¿™äº›ä¿¡æ¯æŒ‡çº¹å­˜å…¥å“ˆå¸Œè¡¨ï¼Œç”±äºå“ˆå¸Œè¡¨çš„å­˜å‚¨æ•ˆç‡ä¸€èˆ¬åªæœ‰ 50%ï¼Œå› æ­¤ä¸€ä¸ª email åœ°å€éœ€è¦å ç”¨åå…­ä¸ªå­—èŠ‚ã€‚ä¸€äº¿ä¸ªåœ°å€å¤§çº¦è¦ 1.6GBï¼Œå³åå…­äº¿å­—èŠ‚çš„å†…å­˜ï¼‰ã€‚å› æ­¤å­˜è´®å‡ åäº¿ä¸ªé‚®ä»¶åœ°å€å¯èƒ½éœ€è¦ä¸Šç™¾ GB çš„å†…å­˜ã€‚è€Œ Bloom Filter åªéœ€è¦å“ˆå¸Œè¡¨ 1/8 åˆ° 1/4 çš„å¤§å°å°±èƒ½è§£å†³åŒæ ·çš„é—®é¢˜ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç¼“å­˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 52. Nçš‡å II</title>
    <link href="/2020/08/29/LeetCode-52-n-queens-ii/"/>
    <url>/2020/08/29/LeetCode-52-n-queens-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/n-queens-ii/" target="_blank" rel="noopener">52. Nçš‡å II</a></p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> n;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">totalNQueens</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;        <span class="hljs-keyword">this</span>.n = n;        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        <span class="hljs-keyword">char</span>[][] board = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[n][n];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span>[] line : board) &#123;            Arrays.fill(line, <span class="hljs-string">'.'</span>);        &#125;        backtrack(<span class="hljs-number">0</span>, board);        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> row, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        <span class="hljs-keyword">if</span> (row == n) &#123;            res++;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> col = <span class="hljs-number">0</span>; col &lt; n; col++) &#123;            <span class="hljs-keyword">if</span> (!isValid(row, col, board)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            board[row][col] = <span class="hljs-string">'Q'</span>;            backtrack(row + <span class="hljs-number">1</span>, board);            board[row][col] = <span class="hljs-string">'.'</span>;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(<span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> col, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span>[] line : board) &#123;            <span class="hljs-keyword">if</span> (line[col] == <span class="hljs-string">'Q'</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = row - <span class="hljs-number">1</span>, j = col - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &gt;= <span class="hljs-number">0</span>; i--, j--)&#123;            <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'Q'</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = row - <span class="hljs-number">1</span>, j = col + <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &lt; n; i--, j++) &#123;            <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'Q'</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 7. æ•´æ•°åè½¬</title>
    <link href="/2020/08/29/LeetCode-7-reverse-integer/"/>
    <url>/2020/08/29/LeetCode-7-reverse-integer/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-integer/" target="_blank" rel="noopener">7. æ•´æ•°åè½¬</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reverse</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (x != <span class="hljs-number">0</span>) &#123;        <span class="hljs-comment">// ä¸ªä½æ•°</span>        <span class="hljs-keyword">int</span> pop = x % <span class="hljs-number">10</span>;        <span class="hljs-comment">// å»é™¤ä¸ªä½æ•°</span>        x = x / <span class="hljs-number">10</span>;        <span class="hljs-keyword">if</span> (res &gt; Integer.MAX_VALUE / <span class="hljs-number">10</span>                <span class="hljs-comment">// æœ€åä¸€ä½æº¢å‡º</span>                || (res == Integer.MAX_VALUE / <span class="hljs-number">10</span> &amp;&amp; pop &gt; <span class="hljs-number">7</span>)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">if</span> (res &lt; Integer.MIN_VALUE / <span class="hljs-number">10</span>                <span class="hljs-comment">// æœ€åä¸€ä½æº¢å‡º</span>                || (res == Integer.MIN_VALUE / <span class="hljs-number">10</span> &amp;&amp; pop &lt; -<span class="hljs-number">8</span>)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-comment">// ç¿»è½¬åçš„æ•°</span>        res = res * <span class="hljs-number">10</span> + pop;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 338. æ¯”ç‰¹ä½è®¡æ•°</title>
    <link href="/2020/08/28/LeetCode-338-counting-bits/"/>
    <url>/2020/08/28/LeetCode-338-counting-bits/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/counting-bits/" target="_blank" rel="noopener">338. æ¯”ç‰¹ä½è®¡æ•°</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>æ¯ä¸ªæ•°ä¾æ¬¡è®¡æ•°</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] countBits(<span class="hljs-keyword">int</span> num) &#123;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[num + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= num; i++) &#123;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> n = i;        <span class="hljs-keyword">while</span> (n != <span class="hljs-number">0</span>) &#123;            n = n &amp; (n - <span class="hljs-number">1</span>);            count++;        &#125;        res[i] = count;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>ç”¨å¥‡å¶æ•°åˆ¤æ–­å¦™çš„å¾ˆå•Šï¼ï¼ï¼</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] countBits(<span class="hljs-keyword">int</span> num) &#123;    <span class="hljs-keyword">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[num + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= num; i++) &#123;        <span class="hljs-keyword">if</span> ((i &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span>) &#123;            <span class="hljs-comment">// å¥‡æ•°æ¯”å‰é¢çš„å¶æ•°å¤šä¸€ä¸ª 1</span>            res[i] = res[i - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;             <span class="hljs-comment">// å¶æ•°çš„æœ€ä½ä½æ˜¯ 0ï¼Œæ‰€ä»¥ i ä¸­ 1 çš„ä¸ªæ•°å’Œå»é™¤ä½ä½ 0 åçš„é‚£ä¸ªæ•°ä¸€æ ·å¤š</span>             res[i] = res[i &gt;&gt; <span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><p>å…¶å®ä¹Ÿæ˜¯å¥‡å¶æ•°çš„æ€è·¯ã€‚<br /><code>i</code> å’Œ <code>i &gt;&gt; 1</code> ä¸­ <code>1</code> çš„ä¸ªæ•°æ˜¯æœ€ä½æœ‰æ•ˆä½ä¸Šçš„å·®åˆ«ã€‚</p><pre><code class="hljs java">i = (<span class="hljs-number">100101</span>)i &gt;&gt; <span class="hljs-number">1</span> = (<span class="hljs-number">10010</span>)</code></pre><p>çŠ¶æ€ï¼š<code>dp[i]</code> - æ•°å­— <code>i</code> ä¸­ <code>1</code> çš„ä¸ªæ•°ã€‚<br />çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<code>dp[i] = dp[i &gt;&gt; 1] + æœ€ä½æœ‰æ•ˆä½</code>ã€‚</p><hr /><p><code>i</code> å’Œ <code>i &amp; (i - 1)</code> ä¸­ <code>1</code> çš„ä¸ªæ•°æ€»æ˜¯ç›¸å·® <code>1</code>ï¼Œå› ä¸º <code>i</code> ä¸­çš„æœ€åä¸€ä½ <code>1</code> å·²ç»å˜ä¸º <code>0</code>ã€‚<br />çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<code>dp[i] = dp[i &amp; (i - 1)] + 1</code></p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span>[] countBits(<span class="hljs-keyword">int</span> num) &#123;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[num + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= num; i++) &#123;        <span class="hljs-comment">// ä½¿ç”¨æœ€ä½æœ‰æ•ˆä½è®¡ç®—</span>        <span class="hljs-comment">// dp[i] = dp[i &gt;&gt; 1] + (i &amp; 1);</span>        <span class="hljs-comment">// æŠ¹é™¤æœ€ä½ä½çš„ 1</span>        dp[i] = dp[i &amp; (i - <span class="hljs-number">1</span>)] + <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> dp;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 190. é¢ å€’äºŒè¿›åˆ¶ä½</title>
    <link href="/2020/08/28/LeetCode-190-reverse-bits/"/>
    <url>/2020/08/28/LeetCode-190-reverse-bits/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/reverse-bits/" target="_blank" rel="noopener">190. é¢ å€’äºŒè¿›åˆ¶ä½</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>é€ä½ç§»åŠ¨ï¼Œ<code>n</code> ä»<strong>å³å¾€å·¦å–</strong>ï¼Œå–å‡ºçš„æ¯ä¸€ä½æ”¾åˆ° <code>res</code> ä¸­ï¼Œ<code>res</code> ä»<strong>å·¦å¾€å³æ”¾</strong>ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reverseBits</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> mask = <span class="hljs-number">31</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;        <span class="hljs-comment">// å…ˆå·¦ç§»ç©ºå‡ºæœ€å³è¾¹ä¸€ä½ï¼Œå†åŠ ä¸Š n çš„æœ€åä¸€ä½</span>        res = (res &lt;&lt; <span class="hljs-number">1</span>) + (n &amp; <span class="hljs-number">1</span>);        <span class="hljs-comment">// åˆ é™¤æœ€åä¸€ä½</span>        n &gt;&gt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒï¼š</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reverseBits</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-comment">// å–æœ€åä¸€ä½ç§»åˆ°å·¦è¾¹</span>        res += (n &amp; <span class="hljs-number">1</span>) &lt;&lt; i;        <span class="hljs-comment">// åˆ é™¤æœ€åä¸€ä½</span>        n &gt;&gt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 50. Pow(x, n)</title>
    <link href="/2020/08/28/LeetCode-50-powx-n/"/>
    <url>/2020/08/28/LeetCode-50-powx-n/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/powx-n/" target="_blank" rel="noopener">50. Pow(x, n)</a></p><h1 id="å¿«é€Ÿå¹‚-é€’å½’"><a class="markdownIt-Anchor" href="#å¿«é€Ÿå¹‚-é€’å½’"></a> å¿«é€Ÿå¹‚ + é€’å½’</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>77</mn></msup><mo>â†</mo><msup><mi>x</mi><mn>38</mn></msup><mo>â‹…</mo><mi>x</mi><mo>â†</mo><msup><mi>x</mi><mn>19</mn></msup><mo>â†</mo><msup><mi>x</mi><mn>9</mn></msup><mo>â‹…</mo><mi>x</mi><mo>â†</mo><msup><mi>x</mi><mn>4</mn></msup><mo>â‹…</mo><mi>x</mi><mo>â†</mo><msup><mi>x</mi><mn>2</mn></msup><mo>â†</mo><mi>x</mi><mo>â†</mo><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">x^{77} \leftarrow x^{38} \cdot x \leftarrow x^{19} \leftarrow x^9 \cdot x \leftarrow x^4 \cdot x \leftarrow x^2 \leftarrow x \leftarrow x^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></p><p>è‹¥ <code>n</code> ä¸ºå¶æ•°ï¼Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup><mo>=</mo><msup><mi>x</mi><mfrac><mi>n</mi><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">x^n = x^{\frac{n}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.89708em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.89708em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915428571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>è‹¥ <code>n</code> ä¸ºå¥‡æ•°ï¼Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup><mo>=</mo><msup><mi>x</mi><mfrac><mi>n</mi><mn>2</mn></mfrac></msup><mo>â‹…</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">x^n = x^{\frac{n}{2}} \cdot x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.89708em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.89708em;"><span style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915428571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">myPow</span><span class="hljs-params">(<span class="hljs-keyword">double</span> x, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">long</span> N = n;    <span class="hljs-keyword">return</span> N &gt;= <span class="hljs-number">0</span> ? getPow(x, N) : <span class="hljs-number">1.0</span> / getPow(x, N);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getPow</span><span class="hljs-params">(<span class="hljs-keyword">double</span> x, <span class="hljs-keyword">long</span> n)</span> </span>&#123;    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span>;    &#125;    <span class="hljs-keyword">double</span> y = getPow(x, n / <span class="hljs-number">2</span>);    <span class="hljs-keyword">return</span> (n &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span> ? y * y * x : y * y;&#125;</code></pre><h1 id="å¿«é€Ÿå¹‚-è¿­ä»£"><a class="markdownIt-Anchor" href="#å¿«é€Ÿå¹‚-è¿­ä»£"></a> å¿«é€Ÿå¹‚ + è¿­ä»£</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup><mo>=</mo><msup><mi>x</mi><mrow><msub><mi>b</mi><mi>m</mi></msub><msub><mo>â‹¯</mo><mn>3</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>b</mi><mn>1</mn></msub></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow><msub><mi>b</mi><mn>1</mn></msub><mo>Ã—</mo><mn>1</mn></mrow></msup><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><msub><mi>b</mi><mn>2</mn></msub><mo>Ã—</mo><msup><mn>2</mn><mn>1</mn></msup></mrow></msup><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><msub><mi>b</mi><mn>3</mn></msub><mo>Ã—</mo><msup><mn>2</mn><mn>2</mn></msup></mrow></msup><mo separator="true">â‹…</mo><mo>â€¦</mo><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><msub><mi>b</mi><mi>m</mi></msub><mo>Ã—</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow></msup><mo separator="true">â‹…</mo></mrow><annotation encoding="application/x-tex">x^n = x^{b_m\dotsb_3b_2b_1} = x^{b_1\times1}Â·x^{b_2\times2^1}Â·x^{b_3\times2^2}Â·\dotsÂ·x^{b_m\times2^{m-1}}Â·</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.899108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="minner mtight"><span class="minner mtight">â‹¯</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0369199999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.899108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>9</mn></msup><mo>=</mo><msup><mi>x</mi><mn>1001</mn></msup><mo>=</mo><msup><mi>x</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>1</mn></mrow></msup><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><mn>0</mn><mo>Ã—</mo><mn>2</mn></mrow></msup><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><mn>0</mn><mo>Ã—</mo><mn>4</mn></mrow></msup><mo separator="true">â‹…</mo><msup><mi>x</mi><mrow><mn>1</mn><mo>Ã—</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x^9 = x^{1001} = x^{1\times1}Â·x^{0\times2}Â·x^{0\times4}Â·x^{1\times8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mbin mtight">Ã—</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mbin mtight">Ã—</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">Ã—</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>æ‰€ä»¥å½“ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">b_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> = 0 æ—¶ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><msub><mi>b</mi><mi>m</mi></msub><mo>Ã—</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow></msup></mrow><annotation encoding="application/x-tex">x^{b_m\times2^{m-1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9869199999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> = 1ï¼Œæ­¤æ—¶è¯¥é¡¹ä¸ç”¨è®¡ç®—ï¼Œæ¯ä¸€é¡¹çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><msub><mi>b</mi><mi>m</mi></msub><mo>Ã—</mo><msup><mn>2</mn><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>b</mi><mi>m</mi></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>x</mi><msup><mn>2</mn><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>b</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">x^{b_m\times2^{m-1}} = \begin{cases}1, &amp; b_m = 0 \\x^{2^{m-1}}, &amp; b_m = 1\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0369199999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0369199999999998em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">Ã—</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>æœ€ç»ˆçš„è®¡ç®—è§„åˆ™ï¼š</p><ul><li>å…ˆè·å–äºŒè¿›åˆ¶ä½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>m</mi></msub><msub><mo>â‹¯</mo><mn>3</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>b</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">b_m\dotsb_3b_2b_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner">â‹¯</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„å€¼<ul><li><code>n &amp; 1</code>: è·å–æœ€åä¸€ä½</li><li><code>n &gt;&gt; 1</code>: åˆ é™¤æœ€åä¸€ä½ï¼Œè·å–ä¸‹ä¸€ä½</li></ul></li><li>è‹¥ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">b_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> == 1ï¼Œåˆ™æ›´æ–°ç»“æœï¼š<code>res *= x</code></li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>1</mn></msup><mo separator="true">,</mo><msup><mi>x</mi><mn>2</mn></msup><mo separator="true">,</mo><msup><mi>x</mi><mn>4</mn></msup><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msup><mi>x</mi><msup><mn>2</mn><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></msup></mrow><annotation encoding="application/x-tex">x^1, x^2, x^4, \dots, x^{2^{m-1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.18136em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> çš„å€¼ï¼šå¾ªç¯æ“ä½œ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x = x^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">double</span> <span class="hljs-title">myPow</span><span class="hljs-params">(<span class="hljs-keyword">double</span> x, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">long</span> N = n;    <span class="hljs-keyword">return</span> N &gt;= <span class="hljs-number">0</span> ? getPow(x, N) : <span class="hljs-number">1.0</span> / getPow(x, -N);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> <span class="hljs-title">getPow</span><span class="hljs-params">(<span class="hljs-keyword">double</span> x, <span class="hljs-keyword">long</span> n)</span> </span>&#123;    <span class="hljs-keyword">double</span> res = <span class="hljs-number">1.0</span>;    <span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-comment">// æœ€åä¸€ä½ä¸º 1ï¼Œè¡¨ç¤ºæ­¤æ—¶ x^n æœ‰æ•ˆ</span>        <span class="hljs-comment">// è‹¥ä¸º 0ï¼Œå¢ç›Šä¸º 0ï¼Œç»“æœä¸å˜</span>        <span class="hljs-keyword">if</span> ((n &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span>) &#123;            res *= x;        &#125;        <span class="hljs-comment">// ä¿å­˜å½“å‰ä½çš„ x^i</span>        x *= x;        <span class="hljs-comment">// åˆ é™¤æœ€åä¸€ä½ï¼Œè¿›è¡Œä¸‹ä¸€ä½è®¡ç®—</span>        n &gt;&gt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 231. 2çš„å¹‚</title>
    <link href="/2020/08/27/LeetCode-231-power-of-two/"/>
    <url>/2020/08/27/LeetCode-231-power-of-two/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/power-of-two/" target="_blank" rel="noopener">231. 2çš„å¹‚</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><blockquote><p>äºŒè¿›åˆ¶ä¸‹ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> åªæœ‰ä¸€ä½æ˜¯ <code>1</code>ã€‚</p></blockquote><p>è‹¥ <code>x &amp; (x - 1) == 0</code>ï¼Œè¡¨ç¤º <code>x</code> åªæœ‰ <code>1</code> ä¸ª <code>1</code>ï¼Œå³ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>ã€‚</p><table><thead><tr><th style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">2^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></th><th style="text-align:center">n</th><th style="text-align:center">n-1</th><th style="text-align:center">n &amp; (n - 1)</th></tr></thead><tbody><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">2^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">1</td><td style="text-align:center">0000</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">2^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">10</td><td style="text-align:center">0001</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">100</td><td style="text-align:center">0011</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">2^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></td><td style="text-align:center">1000</td><td style="text-align:center">0111</td><td style="text-align:center">0</td></tr></tbody></table><p>è¯æ˜ï¼š<br />è‹¥ <code>n</code> ä¸º <code>2</code> çš„å¹‚ï¼Œåˆ™ <code>n</code> çš„äºŒè¿›åˆ¶ä½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub><msub><mi>n</mi><mn>3</mn></msub><msub><mi>n</mi><mn>4</mn></msub><mo>â€¦</mo></mrow><annotation encoding="application/x-tex">n_1 n_2 n_3n_4\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span></span></span></span> æœ‰ä¸”åªæœ‰ä¸€ä½ä¸º <code>1</code>ï¼Œä¸”ä¸ºæœ€é«˜ä½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™ <code>n - 1</code> çš„äºŒè¿›åˆ¶ä½é™¤äº†æœ€é«˜ä½ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n_1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> å¤–å…¶ä½™ä½éƒ½ä¸º <code>1</code>ã€‚<br />åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>n &amp; (n - 1) == 0</code>ï¼Œå› æ­¤å¯ç”¨æ¥åˆ¤æ–­ <code>n</code> æ˜¯ä¸æ˜¯ <code>2</code> çš„å¹‚ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPowerOfTwo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">return</span> n &gt; <span class="hljs-number">0</span> &amp;&amp; (n &amp; (n - <span class="hljs-number">1</span>)) == <span class="hljs-number">0</span>;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPowerOfTwo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">// é™¤ 1 ä¹‹å¤–çš„å¥‡æ•°</span>    <span class="hljs-keyword">if</span> (n % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-keyword">while</span> (n != <span class="hljs-number">0</span>) &#123;        <span class="hljs-comment">// 2 çš„å¹‚æœ€åå•†æ˜¯ 1</span>        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">// æ˜¯å¥‡æ•°</span>        <span class="hljs-keyword">if</span> ((n &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        n &gt;&gt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 191. ä½1çš„ä¸ªæ•°</title>
    <link href="/2020/08/27/LeetCode-191-number-of-1-bits/"/>
    <url>/2020/08/27/LeetCode-191-number-of-1-bits/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/number-of-1-bits/" target="_blank" rel="noopener">191. ä½1çš„ä¸ªæ•°</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>ä»»ä½•æ•°å­— <code>&amp; 1</code> éƒ½ä¼šè·å¾—è¿™ä¸ªæ•°å­—çš„æœ€ä½ä½ï¼Œå› æ­¤åªè¦ <code>mask</code> å·¦ç§»å°±èƒ½è·å–æ¯ä¸ªæ•°å­—çš„æœ€ä½ä½ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hammingWeight</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> mask = <span class="hljs-number">1</span>;    <span class="hljs-comment">// 32 ä½æ•´æ•°</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;        <span class="hljs-keyword">if</span> ((n &amp; mask) != <span class="hljs-number">0</span>) &#123;            count++;        &#125;        mask &lt;&lt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hammingWeight</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;        count += n &amp; <span class="hljs-number">1</span>;        n &gt;&gt;= <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p><code>n &amp; n - 1</code> å¯ä»¥æŠŠæœ€ä½ä½çš„ <code>1</code> å˜ä¸º <code>0</code>ï¼Œå› æ­¤åªè¦å¾ªç¯æ“ä½œï¼Œç›´åˆ° <code>n == 0</code>ï¼Œæ“ä½œçš„æ¬¡æ•°å°±æ˜¯ <code>1</code> çš„ä¸ªæ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hammingWeight</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (n != <span class="hljs-number">0</span>) &#123;        n = n &amp; (n - <span class="hljs-number">1</span>);        count++;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 773. æ»‘åŠ¨è°œé¢˜</title>
    <link href="/2020/08/27/LeetCode-773-sliding-puzzle/"/>
    <url>/2020/08/27/LeetCode-773-sliding-puzzle/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sliding-puzzle/" target="_blank" rel="noopener">773. æ»‘åŠ¨è°œé¢˜</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>éœ€è¦æ³¨æ„æ£‹ç›˜çš„æ·±æ‹·è´ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">slidingPuzzle</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] board)</span> </span>&#123;        <span class="hljs-keyword">int</span> rows = board.length;        <span class="hljs-keyword">int</span> cols = board[<span class="hljs-number">0</span>].length;        Node start = <span class="hljs-keyword">null</span>;        String startBoardStr = <span class="hljs-string">""</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-number">0</span>) &#123;                    startBoardStr = Arrays.deepToString(board);                    start = <span class="hljs-keyword">new</span> Node(i, j, board.clone(), startBoardStr);                &#125;            &#125;        &#125;        <span class="hljs-keyword">if</span> (start == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;        String target = Arrays.deepToString(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[][]&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>&#125;&#125;);        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        Set&lt;String&gt; used = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        Queue&lt;Node&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();        queue.add(start);        used.add(startBoardStr);        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            count++;            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                Node curNode = queue.poll();                String curBoardStr = curNode.boardStr;                System.out.println(curBoardStr);                <span class="hljs-keyword">if</span> (target.equals(curBoardStr)) &#123;                    <span class="hljs-keyword">return</span> count - <span class="hljs-number">1</span>;                &#125;                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                    <span class="hljs-keyword">int</span> newX = curNode.zeroX + dir[<span class="hljs-number">0</span>];                    <span class="hljs-keyword">int</span> newY = curNode.zeroY + dir[<span class="hljs-number">1</span>];                    <span class="hljs-comment">// è¶Šç•Œ</span>                    <span class="hljs-keyword">if</span> (!inArea(newX, newY, rows, cols)) &#123;                        <span class="hljs-keyword">continue</span>;                    &#125;                    <span class="hljs-keyword">int</span>[][] newBoard = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows][cols];                    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] line : curNode.board) &#123;                        newBoard[i++] = line.clone();                    &#125;                    <span class="hljs-comment">// äº¤æ¢æ•°å­—</span>                    newBoard[curNode.zeroX][curNode.zeroY] = newBoard[newX][newY];                    newBoard[newX][newY] = <span class="hljs-number">0</span>;                    String newBoardStr = Arrays.deepToString(newBoard);                    <span class="hljs-comment">// å·²è¢«ä½¿ç”¨</span>                    <span class="hljs-keyword">if</span> (used.contains(newBoardStr)) &#123;                        <span class="hljs-keyword">continue</span>;                    &#125;                    <span class="hljs-comment">// åŠ å…¥é˜Ÿåˆ—å¹¶æ ‡è®°</span>                    queue.add(<span class="hljs-keyword">new</span> Node(newX, newY, newBoard, newBoardStr));                    used.add(newBoardStr);                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> cols)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    <span class="hljs-keyword">int</span> zeroX;    <span class="hljs-keyword">int</span> zeroY;    <span class="hljs-keyword">int</span>[][] board;    String boardStr;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> zeroX, <span class="hljs-keyword">int</span> zeroY, <span class="hljs-keyword">int</span>[][] board, String boardStr)</span> </span>&#123;        <span class="hljs-keyword">this</span>.zeroX = zeroX;        <span class="hljs-keyword">this</span>.zeroY = zeroY;        <span class="hljs-keyword">this</span>.board = board;        <span class="hljs-keyword">this</span>.boardStr = boardStr;    &#125;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>æŠŠäºŒç»´æ•°ç»„æ˜ å°„ä¸ºå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªæ•°å­—å°±ç›¸å½“äºäº¤æ¢å­—ç¬¦ï¼Œçœå»äº†å¾ˆå¤šè¾¹ç•Œåˆ¤æ–­ã€‚</p><pre><code class="hljs java">String TARGET = <span class="hljs-string">"123450"</span>;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">slidingPuzzle</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">int</span>[][] dirs = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[][]&#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">5</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">4</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>&#125;, &#123;<span class="hljs-number">2</span>, <span class="hljs-number">4</span>&#125;&#125;;    StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] row : board) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : row) &#123;            sb.append(num);        &#125;    &#125;    String start = sb.toString();    <span class="hljs-keyword">if</span> (TARGET.equals(start)) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    Set&lt;String&gt; used = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();    Queue&lt;String&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    queue.add(start);    used.add(start);    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        count++;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            String cur = queue.poll();            <span class="hljs-keyword">if</span> (TARGET.equals(cur)) &#123;                <span class="hljs-keyword">return</span> count - <span class="hljs-number">1</span>;            &#125;            <span class="hljs-keyword">char</span>[] arr = cur.toCharArray();            <span class="hljs-comment">// ä¸€å®šä¼šæ‰¾åˆ° 0ï¼Œä¸ç”¨ç‰¹åˆ¤</span>            <span class="hljs-keyword">int</span> zeroIdx = cur.indexOf(<span class="hljs-string">'0'</span>);            <span class="hljs-keyword">int</span>[] moves = dirs[zeroIdx];            <span class="hljs-comment">// å°è¯•äº¤æ¢æ¯ä¸ªä½ç½®</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> next : moves) &#123;                <span class="hljs-comment">// äº¤æ¢ 0</span>                arr[zeroIdx] = arr[next];                arr[next] = <span class="hljs-string">'0'</span>;                <span class="hljs-comment">// è‹¥æœªå‡ºç°è¿‡ï¼Œåˆ™åŠ å…¥é˜Ÿåˆ—</span>                String candidate = String.valueOf(arr);                <span class="hljs-keyword">if</span> (!used.contains(candidate)) &#123;                    queue.add(candidate);                    used.add(candidate);                &#125;                <span class="hljs-comment">// è¿˜åŸ</span>                arr[next] = arr[zeroIdx];                arr[zeroIdx] = <span class="hljs-string">'0'</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1091. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„æœ€çŸ­è·¯å¾„</title>
    <link href="/2020/08/27/LeetCode-1091-shortest-path-in-binary-matrix/"/>
    <url>/2020/08/27/LeetCode-1091-shortest-path-in-binary-matrix/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/shortest-path-in-binary-matrix/" target="_blank" rel="noopener">1091. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„æœ€çŸ­è·¯å¾„</a></p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><p>éœ€è¦æ³¨æ„èµ·ç‚¹å’Œç»ˆç‚¹éƒ½è¦ <code>== 0</code>ï¼Œæäº¤äº†å¥½å¤šæ¬¡éƒ½åœ¨åˆ¤æ–­è¾¹ç•Œã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">shortestPathBinaryMatrix</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] grid)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = grid.length;        <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-comment">// ä¸€å¼€å§‹å°±èµ°ä¸é€š</span>        <span class="hljs-keyword">if</span> (grid[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªå…ƒç´ </span>        <span class="hljs-keyword">if</span> (len == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;&#125;;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">boolean</span>[][] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[len][len];        Queue&lt;Node&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.add(<span class="hljs-keyword">new</span> Node(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>));        visited[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-keyword">true</span>;        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            count++;            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                Node curNode = queue.poll();                <span class="hljs-comment">// System.out.println(count + ": " + curNode.x + ", " + curNode.y);</span>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                    <span class="hljs-keyword">int</span> newX = curNode.x + dir[<span class="hljs-number">0</span>];                    <span class="hljs-keyword">int</span> newY = curNode.y + dir[<span class="hljs-number">1</span>];                    <span class="hljs-comment">// System.out.println(newX + ", " + newY + ", len = " + len);</span>                    <span class="hljs-keyword">if</span> (!inArea(newX, newY, len) || visited[newX][newY] || grid[newX][newY] == <span class="hljs-number">1</span>) &#123;                        <span class="hljs-keyword">continue</span>;                    &#125;                    <span class="hljs-comment">// grid[i][j] == 0 æ—¶æ‰æœ‰æ•ˆ</span>                    <span class="hljs-keyword">if</span> (newX == (len - <span class="hljs-number">1</span>) &amp;&amp; newY == (len - <span class="hljs-number">1</span>)) &#123;                        <span class="hljs-keyword">return</span> count + <span class="hljs-number">1</span>;                    &#125;                    queue.add(<span class="hljs-keyword">new</span> Node(newX, newY));                    visited[newX][newY] = <span class="hljs-keyword">true</span>;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> len)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; len &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; len;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    <span class="hljs-keyword">int</span> x;    <span class="hljs-keyword">int</span> y;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">this</span>.x = x;        <span class="hljs-keyword">this</span>.y = y;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 37. è§£æ•°ç‹¬</title>
    <link href="/2020/08/26/LeetCode-37-sudoku-solver/"/>
    <url>/2020/08/26/LeetCode-37-sudoku-solver/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sudoku-solver/" target="_blank" rel="noopener">37. è§£æ•°ç‹¬</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">solveSudoku</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = <span class="hljs-number">9</span>;    <span class="hljs-keyword">boolean</span>[][] rows = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">boolean</span>[][] cols = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">boolean</span>[][] boxes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++) &#123;            <span class="hljs-keyword">if</span> (board[i][j] != <span class="hljs-string">'.'</span>) &#123;                <span class="hljs-keyword">int</span> num = board[i][j] - <span class="hljs-string">'0'</span>;                <span class="hljs-keyword">int</span> box = i / <span class="hljs-number">3</span> * <span class="hljs-number">3</span> + j / <span class="hljs-number">3</span>;                boxes[box][num] = <span class="hljs-keyword">true</span>;                rows[i][num] = <span class="hljs-keyword">true</span>;                cols[j][num] = <span class="hljs-keyword">true</span>;            &#125;        &#125;    &#125;    backtrack(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, n, board, rows, cols, boxes);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> n, <span class="hljs-keyword">char</span>[][] board, <span class="hljs-keyword">boolean</span>[][] rows, <span class="hljs-keyword">boolean</span>[][] cols, <span class="hljs-keyword">boolean</span>[][] boxes)</span> </span>&#123;    <span class="hljs-comment">// åˆ°è¾¾ç»ˆç‚¹</span>    <span class="hljs-keyword">if</span> (i == n) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">// åˆ°è¾¾æŸè¡Œçš„æœ€åä¸€åˆ—</span>    <span class="hljs-keyword">if</span> (j == n) &#123;        <span class="hljs-keyword">return</span> backtrack(i + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, n, board, rows, cols, boxes);    &#125;    <span class="hljs-comment">// å·²ç»æ˜¯æ•°å­—ï¼Œè·³è¿‡</span>    <span class="hljs-keyword">if</span> (board[i][j] != <span class="hljs-string">'.'</span>) &#123;        <span class="hljs-keyword">return</span> backtrack(i, j + <span class="hljs-number">1</span>, n, board, rows, cols, boxes);    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num = <span class="hljs-number">1</span>; num &lt;= <span class="hljs-number">9</span>; num++) &#123;        <span class="hljs-keyword">if</span> (notValid(i, j, num, rows, cols, boxes)) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-comment">// å°è¯•æ”¾æ•°å­—çš„åŒæ—¶ä¹Ÿè¦è¿›è¡Œæ ‡è®°</span>        placeNum(i, j, num, rows, cols, boxes, board);        <span class="hljs-keyword">if</span> (backtrack(i, j + <span class="hljs-number">1</span>, n, board, rows, cols, boxes)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        removeNum(i, j, num, rows, cols, boxes, board);    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">placeNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> num, <span class="hljs-keyword">boolean</span>[][] rows, <span class="hljs-keyword">boolean</span>[][] cols, <span class="hljs-keyword">boolean</span>[][] boxes, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">int</span> box = i / <span class="hljs-number">3</span> * <span class="hljs-number">3</span> + j / <span class="hljs-number">3</span>;    boxes[box][num] = <span class="hljs-keyword">true</span>;    board[i][j] = (<span class="hljs-keyword">char</span>) (num + <span class="hljs-string">'0'</span>);    rows[i][num] = <span class="hljs-keyword">true</span>;    cols[j][num] = <span class="hljs-keyword">true</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> num, <span class="hljs-keyword">boolean</span>[][] rows, <span class="hljs-keyword">boolean</span>[][] cols, <span class="hljs-keyword">boolean</span>[][] boxes, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">int</span> box = i / <span class="hljs-number">3</span> * <span class="hljs-number">3</span> + j / <span class="hljs-number">3</span>;    boxes[box][num] = <span class="hljs-keyword">false</span>;    board[i][j] = <span class="hljs-string">'.'</span>;    rows[i][num] = <span class="hljs-keyword">false</span>;    cols[j][num] = <span class="hljs-keyword">false</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">notValid</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> num, <span class="hljs-keyword">boolean</span>[][] rows, <span class="hljs-keyword">boolean</span>[][] cols, <span class="hljs-keyword">boolean</span>[][] boxes)</span> </span>&#123;    <span class="hljs-keyword">int</span> box = i / <span class="hljs-number">3</span> * <span class="hljs-number">3</span> + j / <span class="hljs-number">3</span>;    <span class="hljs-keyword">return</span> boxes[box][num] || rows[i][num] || cols[j][num];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 36. æœ‰æ•ˆçš„æ•°ç‹¬</title>
    <link href="/2020/08/26/LeetCode-36-valid-sudoku/"/>
    <url>/2020/08/26/LeetCode-36-valid-sudoku/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-sudoku/" target="_blank" rel="noopener">36. æœ‰æ•ˆçš„æ•°ç‹¬</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p><code>board[i][j]</code> æ˜¯å­—ç¬¦å‹ï¼Œåˆ¤æ–­ä¹å®«æ ¼é‡å¤æ—¶ä¸è¦å¿˜äº†è½¬ä¸ºæ•°å­—ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-keyword">int</span>[][] boxes;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValidSudoku</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        rows = board.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        cols = board[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        <span class="hljs-comment">// 9 ä¸ªæ ¼å­ï¼Œæ¯ä¸ªæ ¼å­ 9 ä¸ªæ•°</span>        <span class="hljs-comment">// ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ ¼å­ï¼Œè‹¥æ ¼å­ä¸­æŸä¸ªä½ç½®ä¸º 1ï¼Œè¡¨ç¤ºè¯¥ä½ç½®å¯¹åº”çš„æ•°å·²ç»å‡ºç°è¿‡</span>        boxes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">9</span>][<span class="hljs-number">10</span>];        <span class="hljs-keyword">return</span> dfs(<span class="hljs-number">0</span>, board);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> row, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        <span class="hljs-comment">// æ‰€æœ‰è¡Œéå†å®Œæˆï¼Œåˆ™ç»“æŸ</span>        <span class="hljs-keyword">if</span> (row == rows) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-comment">// å¯¹å½“å‰è¡Œçš„æ¯ä¸€ä¸ªä½ç½®åˆ¤æ–­</span>        <span class="hljs-keyword">char</span>[] curLine = board[row];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> col = <span class="hljs-number">0</span>; col &lt; curLine.length; col++) &#123;            <span class="hljs-keyword">if</span> (board[row][col] == <span class="hljs-string">'.'</span>) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">if</span> (!isValid(row, col, board)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€è¡Œ</span>        <span class="hljs-keyword">return</span> dfs(row + <span class="hljs-number">1</span>, board);    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(<span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> col, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        <span class="hljs-comment">// åˆ¤æ–­åˆ—æ˜¯å¦é‡å¤</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">if</span> (i != row &amp;&amp; board[i][col] == board[row][col]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// åˆ¤æ–­è¡Œæ˜¯å¦é‡å¤</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (j != col &amp;&amp; board[row][j] == board[row][col]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// åˆ¤æ–­ä¹å®«æ ¼æ˜¯å¦é‡å¤</span>        <span class="hljs-keyword">int</span> boxNum = (row / <span class="hljs-number">3</span>) * <span class="hljs-number">3</span> + col / <span class="hljs-number">3</span>;        <span class="hljs-keyword">int</span> num = board[row][col] - <span class="hljs-string">'0'</span>;        <span class="hljs-keyword">if</span> (boxes[boxNum][num] == <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        <span class="hljs-comment">// æœªå‡ºç°è¿‡åˆ™è®¾ç½®ä¸º 1ï¼Œç”¨äºä¸‹ä¸€ä¸ªæ•°å­—åˆ¤æ–­</span>        boxes[boxNum][num] = <span class="hljs-number">1</span>;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>æŠŠè¡Œåˆ—ï¼Œä¹å®«æ ¼çš„æ•°å­—éƒ½æ˜ å°„åˆ°æ•°ç»„é‡Œï¼ŒåŠ å¿«åˆ¤æ–­æ•ˆç‡ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValidSudoku</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-comment">// æ¯è¡Œè®°å½• board çš„æ¯è¡Œæ•°å­—æ˜¯å¦å‡ºç°</span>    <span class="hljs-comment">// ä¸‹æ ‡ä»£è¡¨å¯¹åº”å…ƒç´ </span>    <span class="hljs-comment">// 1: å‡ºç° 0: æœªå‡ºç°</span>    <span class="hljs-keyword">int</span>[][] rows = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">9</span>][<span class="hljs-number">10</span>];    <span class="hljs-comment">// æ¯è¡Œè®°å½• board çš„æ¯åˆ—æ•°å­—æ˜¯å¦å‡ºç°</span>    <span class="hljs-keyword">int</span>[][] cols = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">9</span>][<span class="hljs-number">10</span>];    <span class="hljs-comment">// æ¯è¡Œè®°å½• board æ¯ä¸ªä¹å®«æ ¼æ˜¯å¦å‡ºç°</span>    <span class="hljs-keyword">int</span>[][] boxes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">9</span>][<span class="hljs-number">10</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">9</span>; j++) &#123;            <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'.'</span>) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">int</span> num = board[i][j] - <span class="hljs-string">'0'</span>;            <span class="hljs-keyword">if</span> (rows[i][num] == <span class="hljs-number">1</span> || cols[j][num] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-keyword">int</span> box = (i / <span class="hljs-number">3</span>) * <span class="hljs-number">3</span> + j / <span class="hljs-number">3</span>;            <span class="hljs-keyword">if</span> (boxes[box][num] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-comment">// æ ‡è®°å¯¹åº”å…ƒç´ </span>            rows[i][num] = <span class="hljs-number">1</span>;            cols[j][num] = <span class="hljs-number">1</span>;            boxes[box][num] = <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 130. è¢«å›´ç»•çš„åŒºåŸŸ</title>
    <link href="/2020/08/25/LeetCode-130-surrounded-regions/"/>
    <url>/2020/08/25/LeetCode-130-surrounded-regions/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/surrounded-regions/" target="_blank" rel="noopener">130. è¢«å›´ç»•çš„åŒºåŸŸ</a></p><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><p>å…ˆæ ‡è®°è¾¹ç•Œä»¥åŠå’Œè¾¹ç•Œè¿é€šçš„ <code>O</code>ï¼Œå‰©ä¸‹çš„å°±æ˜¯éœ€è¦å¡«å……çš„æ ¼å­ï¼Œæœ€åè¿˜åŸä¹‹å‰æ ‡è®°çš„æ ¼å­ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        rows = board.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        cols = board[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-comment">// å·¦</span>            <span class="hljs-keyword">if</span> (board[i][<span class="hljs-number">0</span>] == <span class="hljs-string">'O'</span>) &#123;                dfs(i, <span class="hljs-number">0</span>, board);            &#125;            <span class="hljs-comment">// å³</span>            <span class="hljs-keyword">if</span> (board[i][cols - <span class="hljs-number">1</span>] == <span class="hljs-string">'O'</span>) &#123;                dfs(i, cols - <span class="hljs-number">1</span>, board);            &#125;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cols; i++) &#123;            <span class="hljs-comment">// ä¸Š</span>            <span class="hljs-keyword">if</span> (board[<span class="hljs-number">0</span>][i] == <span class="hljs-string">'O'</span>) &#123;                dfs(<span class="hljs-number">0</span>, i, board);            &#125;            <span class="hljs-comment">// ä¸‹</span>            <span class="hljs-keyword">if</span> (board[rows - <span class="hljs-number">1</span>][i] == <span class="hljs-string">'O'</span>) &#123;                dfs(rows - <span class="hljs-number">1</span>, i, board);            &#125;        &#125;        <span class="hljs-comment">// å¡«å…… O ä¸º X</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'O'</span>) &#123;                    board[i][j] = <span class="hljs-string">'X'</span>;                &#125;            &#125;        &#125;        <span class="hljs-comment">// è¿˜åŸ O</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'#'</span>) &#123;                    board[i][j] = <span class="hljs-string">'O'</span>;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        board[x][y] = <span class="hljs-string">'#'</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;            <span class="hljs-keyword">int</span> newX = x + dir[<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> newY = y + dir[<span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (inArea(newX, newY) &amp;&amp; board[newX][newY] == <span class="hljs-string">'O'</span>) &#123;                dfs(newX, newY, board);            &#125;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;    &#125;&#125;</code></pre><h1 id="å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#å¹¶æŸ¥é›†"></a> å¹¶æŸ¥é›†</h1><ul><li>å°†è¾¹ç•Œçš„ <code>O</code> ä¸ <code>dummy</code> è¿æ¥</li><li>å°†å†…éƒ¨çš„ <code>O</code> äº’ç›¸è¿æ¥ï¼Œå‰©ä¸‹çš„æœªä¸ <code>dummy</code> è¿æ¥çš„ <code>O</code> å³ä¸ºéœ€è¦å¡«å……çš„éƒ¨åˆ†</li></ul><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-keyword">int</span> dummy;    UnionFind uf;    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        rows = board.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        cols = board[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// æ‰€æœ‰æœªè¢«å›´ç»•çš„ O éƒ½ä¸ dummy è¿æ¥</span>        dummy = rows * cols;        uf = <span class="hljs-keyword">new</span> UnionFind(dummy + <span class="hljs-number">1</span>);        <span class="hljs-comment">// è¿æ¥å·¦å³è¾¹ç•Œ</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-comment">// å·¦</span>            <span class="hljs-keyword">if</span> (board[i][<span class="hljs-number">0</span>] == <span class="hljs-string">'O'</span>) &#123;                uf.union(dummy, getIndex(i, <span class="hljs-number">0</span>));            &#125;            <span class="hljs-comment">// å³</span>            <span class="hljs-keyword">if</span> (board[i][cols - <span class="hljs-number">1</span>] == <span class="hljs-string">'O'</span>) &#123;                uf.union(dummy, getIndex(i, cols - <span class="hljs-number">1</span>));            &#125;        &#125;        <span class="hljs-comment">// è¿æ¥ä¸Šä¸‹è¾¹ç•Œ</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cols; i++) &#123;            <span class="hljs-comment">// ä¸Š</span>            <span class="hljs-keyword">if</span> (board[<span class="hljs-number">0</span>][i] == <span class="hljs-string">'O'</span>) &#123;                uf.union(dummy, getIndex(<span class="hljs-number">0</span>, i));            &#125;            <span class="hljs-comment">// ä¸‹</span>            <span class="hljs-keyword">if</span> (board[rows - <span class="hljs-number">1</span>][i] == <span class="hljs-string">'O'</span>) &#123;                uf.union(dummy, getIndex(rows - <span class="hljs-number">1</span>, i));            &#125;        &#125;        <span class="hljs-comment">// éå†ä¸­é—´çš„ Oï¼Œå¹¶å°†å®ƒä»¬äº’ç›¸è¿æ¥</span>        <span class="hljs-comment">// åˆ™æœªä¸ dummy è¿æ¥çš„ O å³ä¸ºéœ€è¦å¡«å……çš„</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; rows - <span class="hljs-number">1</span>; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; cols - <span class="hljs-number">1</span>; j++) &#123;                <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">'O'</span>) &#123;                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                        <span class="hljs-keyword">int</span> newX = i + dir[<span class="hljs-number">0</span>];                        <span class="hljs-keyword">int</span> newY = j + dir[<span class="hljs-number">1</span>];                        <span class="hljs-keyword">if</span> (board[newX][newY] == <span class="hljs-string">'O'</span>) &#123;                            uf.union(getIndex(i, j), getIndex(newX, newY));                        &#125;                    &#125;                &#125;            &#125;        &#125;        <span class="hljs-comment">// æœªä¸ dummy è¿æ¥çš„ O å¡«å……ä¸º X</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-keyword">if</span> (!uf.connected(dummy, i * cols + j)) &#123;                    board[i][j] = <span class="hljs-string">'O'</span>;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> x * cols + y;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å¹¶æŸ¥é›†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 547. æœ‹å‹åœˆ</title>
    <link href="/2020/08/25/LeetCode-547-friend-circles/"/>
    <url>/2020/08/25/LeetCode-547-friend-circles/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/friend-circles/" target="_blank" rel="noopener">547. æœ‹å‹åœˆ</a></p><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java"><span class="hljs-keyword">boolean</span>[] visited;<span class="hljs-keyword">int</span> n;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findCircleNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] M)</span> </span>&#123;    n = M.length;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[n];    <span class="hljs-comment">// i è¡¨ç¤ºç¬¬ i ä¸ªäºº</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;        <span class="hljs-keyword">if</span> (!visited[i]) &#123;            count++;            dfs(i, M);        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span>[][] m)</span> </span>&#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j++) &#123;        <span class="hljs-comment">// i å’Œ j ä¸ºæœ‹å‹ï¼Œåˆ™ä» j å¼€å§‹é€’å½’æŸ¥æ‰¾</span>        <span class="hljs-comment">// ç›´åˆ° j çš„æœ‹å‹ä¸ºç©º</span>        <span class="hljs-keyword">if</span> (m[i][j] == <span class="hljs-number">1</span> &amp;&amp; !visited[j]) &#123;            visited[j] = <span class="hljs-keyword">true</span>;            dfs(j, m);        &#125;    &#125;&#125;</code></pre><h1 id="å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#å¹¶æŸ¥é›†"></a> å¹¶æŸ¥é›†</h1><p>å¹¶æŸ¥é›†çš„è¿é€šåˆ†é‡æ•°å°±æ˜¯æœ‹å‹åœˆçš„æ•°é‡ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findCircleNum</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] M)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = M.length;    UnionFind uf = <span class="hljs-keyword">new</span> UnionFind(n);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; M[<span class="hljs-number">0</span>].length; j++) &#123;            <span class="hljs-keyword">if</span> (M[i][j] == <span class="hljs-number">1</span>) &#123;                uf.union(i, j);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> uf.getCount();&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å¹¶æŸ¥é›†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶æŸ¥é›†</title>
    <link href="/2020/08/25/data-structure-union-find/"/>
    <url>/2020/08/25/data-structure-union-find/</url>
    
    <content type="html"><![CDATA[<pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UnionFind</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è¿é€šåˆ†é‡ä¸ªæ•°</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> count;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å¹¶æŸ¥é›†å¯¹åº”çš„æ ‘</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] parent;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ¯æ£µæ ‘çš„å­ç»“ç‚¹æ•°é‡</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] size;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UnionFind</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;        <span class="hljs-keyword">this</span>.count = n;        <span class="hljs-keyword">this</span>.parent = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-keyword">this</span>.count];        <span class="hljs-keyword">this</span>.size = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-keyword">this</span>.count];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.count; i++) &#123;            <span class="hljs-comment">// åˆå§‹æ ¹èŠ‚ç‚¹ä¸ºè‡ªå·±</span>            parent[i] = i;            <span class="hljs-comment">// åˆå§‹å­ç»“ç‚¹åªæœ‰è‡ªå·±</span>            size[i] = <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è·å–è¿é€šåˆ†é‡ä¸ªæ•°</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCount</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.count;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è¿æ¥ p, q ç»“ç‚¹</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> p</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> q</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">union</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p, <span class="hljs-keyword">int</span> q)</span> </span>&#123;        <span class="hljs-keyword">int</span> rootP = findRoot(p);        <span class="hljs-keyword">int</span> rootQ = findRoot(q);        <span class="hljs-comment">// p, q å·²ç»è¿æ¥</span>        <span class="hljs-keyword">if</span> (rootP == rootQ) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// æŠŠ å°æ ‘ æŒ‚åˆ° å¤§æ ‘ ä¸‹ï¼Œä½¿å¾—æ•´æ£µæ ‘æ›´å¹³è¡¡</span>        <span class="hljs-keyword">if</span> (size[rootP] &gt; size[rootQ]) &#123;            parent[rootQ] = rootP;            size[rootP] += size[rootQ];        &#125; <span class="hljs-keyword">else</span> &#123;            parent[rootP] = rootQ;            size[rootQ] += size[rootP];        &#125;        <span class="hljs-keyword">this</span>.count--;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ¤æ–­ p, q ç»“ç‚¹æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> p</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> q</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">connected</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p, <span class="hljs-keyword">int</span> q)</span> </span>&#123;        <span class="hljs-keyword">int</span> rootP = findRoot(p);        <span class="hljs-keyword">int</span> rootQ = findRoot(q);        <span class="hljs-comment">// è‹¥æ ¹ç»“ç‚¹ç›¸åŒ åˆ™å±äºåŒä¸€ä¸ªé›†åˆ</span>        <span class="hljs-keyword">return</span> rootP == rootQ;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ‰¾åˆ° x çš„æ ¹èŠ‚ç‚¹</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> x</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findRoot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;        <span class="hljs-comment">// parent[x] == x è¡¨ç¤º åˆ°è¾¾æ ¹ç»“ç‚¹</span>        <span class="hljs-keyword">while</span> (parent[x] != x) &#123;            <span class="hljs-comment">// è·¯å¾„å‹ç¼©ï¼ŒæŠŠ x æŒ‚åˆ° x çš„ çˆ·çˆ·ä¸Š</span>            <span class="hljs-comment">// å‹ç¼©æ ‘çš„é«˜åº¦</span>            parent[x] = parent[parent[x]];            x = parent[x];        &#125;        <span class="hljs-keyword">return</span> x;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¹¶æŸ¥é›†</tag>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 212. å•è¯æœç´¢ II</title>
    <link href="/2020/08/24/LeetCode-212-word-search-ii/"/>
    <url>/2020/08/24/LeetCode-212-word-search-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-search-ii/" target="_blank" rel="noopener">212. å•è¯æœç´¢ II</a><br />å‘ï¼šæŸ¥æ‰¾å‰ç¼€æ—¶ï¼Œè‹¥æ‰¾åˆ° <code>word</code>ï¼Œä¸èƒ½ <code>return</code>ï¼Œå¦åˆ™é€’å½’ç»“æŸä¼šå¯¼è‡´ä¸ <code>word</code> åŒå‰ç¼€çš„å•è¯ä¸¢å¤±ï¼Œå¦‚ <code>aaba</code> å’Œ <code>aaab</code>ï¼Œåªèƒ½æ‰¾åˆ° <code>aaba</code>ã€‚</p><p>è¿˜æ˜¯å¯¹å‰ç¼€æ ‘ç†è§£ä¸å¤Ÿï¼Œæ‰¾äº†å¥½ä¹…æ‰å‘ç°ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">boolean</span>[][] used;    <span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">findWords</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, String[] words)</span> </span>&#123;        rows = board.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span> || words.length == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        cols = board[<span class="hljs-number">0</span>].length;        used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows][cols];        Trie trie = <span class="hljs-keyword">new</span> Trie();        <span class="hljs-keyword">for</span> (String word : words) &#123;            trie.insert(word);        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                backtrack(i, j, board, trie.root);            &#125;        &#125;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">char</span>[][] board, TrieNode node)</span> </span>&#123;        node = node.links[board[i][j] - <span class="hljs-string">'a'</span>];        <span class="hljs-keyword">if</span> (node == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">if</span> (node.word != <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">if</span> (!res.contains(node.word)) &#123;                res.add(node.word);                <span class="hljs-comment">// ä¸€å®šä¸èƒ½ returnï¼Œå¦åˆ™ä¼šä¸¢å¤±å‰ç¼€</span>                <span class="hljs-comment">// return;</span>            &#125;        &#125;        used[i][j] = <span class="hljs-keyword">true</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;            <span class="hljs-keyword">int</span> newX = i + dir[<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> newY = j + dir[<span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (inArea(newX, newY) &amp;&amp; !used[newX][newY]) &#123;                backtrack(newX, newY, board, node);            &#125;        &#125;        used[i][j] = <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrieNode</span> </span>&#123;    TrieNode[] links;    String word;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> R = <span class="hljs-number">26</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TrieNode</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.links = <span class="hljs-keyword">new</span> TrieNode[R];    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">containsKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>] != <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> TrieNode <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>];    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key, TrieNode node)</span> </span>&#123;        <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>] = node;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Trie</span> </span>&#123;    TrieNode root;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Trie</span><span class="hljs-params">()</span> </span>&#123;        root = <span class="hljs-keyword">new</span> TrieNode();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(String word)</span> </span>&#123;        TrieNode node = root;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; word.length(); i++) &#123;            <span class="hljs-keyword">char</span> key = word.charAt(i);            <span class="hljs-keyword">if</span> (!node.containsKey(key)) &#123;                node.put(key, <span class="hljs-keyword">new</span> TrieNode());            &#125;            node = node.get(key);        &#125;        node.word = word;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
      <tag>å­—å…¸æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 79. å•è¯æœç´¢</title>
    <link href="/2020/08/24/LeetCode-79-word-search/"/>
    <url>/2020/08/24/LeetCode-79-word-search/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-search/" target="_blank" rel="noopener">79. å•è¯æœç´¢</a></p><p>è¿˜æ˜¯ç±»ä¼¼å²›å±¿æ•°é‡çš„å›æº¯æ€æƒ³ï¼Œæ•´ä½“ä¸éš¾ï¼Œæ³¨æ„ç»†èŠ‚ã€‚<br />ä¸€å¼€å§‹æ–¹å‘çš„åæ ‡å†™é‡å¤äº†ä¸€ä¸ªï¼Œè¿˜å¿˜äº†çŠ¶æ€é‡ç½®ï¼Œä¸€ç›´æ— æ³•é€šè¿‡ï¼Œè°ƒäº†å¾ˆä¹…æ‰å‘ç°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">exist</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, String word)</span> </span>&#123;    <span class="hljs-keyword">int</span> rows = board.length;    <span class="hljs-keyword">int</span> cols = board[<span class="hljs-number">0</span>].length;    <span class="hljs-keyword">char</span>[] str = word.toCharArray();    <span class="hljs-keyword">boolean</span>[][] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows][cols];    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-keyword">if</span> (backtrack(i, j, <span class="hljs-number">0</span>, str, dirs, rows, cols, visited, board)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j, <span class="hljs-keyword">int</span> pos, <span class="hljs-keyword">char</span>[] str, <span class="hljs-keyword">int</span>[][] dirs, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> cols, <span class="hljs-keyword">boolean</span>[][] visited, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">if</span> (pos == str.length - <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> board[i][j] == str[pos];    &#125;    <span class="hljs-comment">// å­—ç¬¦ç›¸ç­‰æ‰è¿›å…¥ä¸‹ä¸€ä¸ª</span>    <span class="hljs-keyword">if</span> (str[pos] != board[i][j]) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-comment">// board[i][j] == str[pos]</span>    <span class="hljs-comment">// ä» (i, j) çš„å››ä¸ªæ–¹å‘æŸ¥æ‰¾ str çš„ä¸‹ä¸€ä¸ªå­—ç¬¦</span>    visited[i][j] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;        <span class="hljs-keyword">int</span> newX = i + dir[<span class="hljs-number">0</span>];        <span class="hljs-keyword">int</span> newY = j + dir[<span class="hljs-number">1</span>];        <span class="hljs-keyword">if</span> (!inArea(newX, newY, rows, cols) || visited[newX][newY]) &#123;            <span class="hljs-keyword">continue</span>;        &#125;        <span class="hljs-keyword">if</span> (backtrack(newX, newY, pos + <span class="hljs-number">1</span>, str, dirs, rows, cols, visited, board)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;    &#125;    visited[i][j] = <span class="hljs-keyword">false</span>;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> cols)</span> </span>&#123;    <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 208. å®ç° Trie (å‰ç¼€æ ‘)</title>
    <link href="/2020/08/24/LeetCode-208-implement-trie-prefix-tree/"/>
    <url>/2020/08/24/LeetCode-208-implement-trie-prefix-tree/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/implement-trie-prefix-tree/" target="_blank" rel="noopener">208. å®ç° Trie (å‰ç¼€æ ‘)</a></p><p>å­—å…¸æ ‘ ç»“ç‚¹å®šä¹‰ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * å­—å…¸æ ‘ ç»“ç‚¹</span><span class="hljs-comment"> */</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrieNode</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ¯ä¸ªç»“ç‚¹ç›¸å½“äºä¸€ä¸ªæ•°ç»„</span><span class="hljs-comment">     * è‹¥æ•°ç»„çš„æŸä¸ªä½ç½®ä¸ä¸ºç©ºï¼Œåˆ™æŒ‡å‘ä¸‹ä¸€ä¸ªç»“ç‚¹</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> TrieNode[] links;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ•°ç»„çš„é•¿åº¦</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> R = <span class="hljs-number">26</span>;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * æ˜¯å¦åˆ°è¾¾å¶å­ç»“ç‚¹</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> isEnd;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TrieNode</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.links = <span class="hljs-keyword">new</span> TrieNode[R];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ¤æ–­ key ä½ç½®ä¸Šæ˜¯å¦ä¸ºç©º</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key ç”¨äºè®¡ç®— key æ‰€åœ¨ä½ç½®</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">containsKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>] != <span class="hljs-keyword">null</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è·å– key ä½ç½®ä¸Šçš„ä¸‹ä¸€ä¸ªç»“ç‚¹</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> TrieNode <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>];    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½® key ä½ç½®ä¸Šçš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸º node</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> node</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-keyword">char</span> key, TrieNode node)</span> </span>&#123;        <span class="hljs-keyword">this</span>.links[key - <span class="hljs-string">'a'</span>] = node;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ¤æ–­æ˜¯å¦åˆ°è¾¾å¶å­ç»“ç‚¹</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEnd</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isEnd;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è®¾ç½®å¶å­ç»“ç‚¹</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEnd</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">this</span>.isEnd = <span class="hljs-keyword">true</span>;    &#125;&#125;</code></pre><p>å­—å…¸æ ‘ï¼š</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Trie</span> </span>&#123;    <span class="hljs-keyword">private</span> TrieNode root;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Initialize your data structure here.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Trie</span><span class="hljs-params">()</span> </span>&#123;        root = <span class="hljs-keyword">new</span> TrieNode();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Inserts a word into the trie.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(String word)</span> </span>&#123;        TrieNode node = root;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; word.length(); i++) &#123;            <span class="hljs-keyword">char</span> key = word.charAt(i);            <span class="hljs-keyword">if</span> (!node.containsKey(key)) &#123;                node.put(key, <span class="hljs-keyword">new</span> TrieNode());            &#125;            node = node.get(key);        &#125;        node.setEnd();    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> TrieNode <span class="hljs-title">searchPrefix</span><span class="hljs-params">(String word)</span> </span>&#123;        TrieNode node = root;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; word.length(); i++) &#123;            <span class="hljs-keyword">char</span> key = word.charAt(i);            <span class="hljs-keyword">if</span> (!node.containsKey(key)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;            &#125;            node = node.get(key);        &#125;        <span class="hljs-keyword">return</span> node;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Returns if the word is in the trie.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">search</span><span class="hljs-params">(String word)</span> </span>&#123;        TrieNode node = searchPrefix(word);        <span class="hljs-keyword">return</span> node != <span class="hljs-keyword">null</span> &amp;&amp; node.isEnd();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * Returns if there is any word in the trie that starts with the given prefix.</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">startsWith</span><span class="hljs-params">(String prefix)</span> </span>&#123;        <span class="hljs-keyword">return</span> searchPrefix(prefix) != <span class="hljs-keyword">null</span>;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å­—å…¸æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 309. æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ</title>
    <link href="/2020/08/23/LeetCode-309-best-time-to-buy-and-sell-stock-with-cooldown/"/>
    <url>/2020/08/23/LeetCode-309-best-time-to-buy-and-sell-stock-with-cooldown/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/" target="_blank" rel="noopener">309. æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">/*</span><span class="hljs-comment">    0 rest</span><span class="hljs-comment">    1 ä¹°å…¥</span><span class="hljs-comment">    2 å–å‡º</span><span class="hljs-comment">    3 å–å‡ºåçš„å†·å†»æœŸ</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">4</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] = Integer.MIN_VALUE;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">3</span>] - prices[i]));        dp[i][<span class="hljs-number">2</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);        dp[i][<span class="hljs-number">3</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">3</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]);    &#125;    <span class="hljs-keyword">return</span> Math.max(dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], Math.max(dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>], dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">3</span>]));&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 714. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹</title>
    <link href="/2020/08/22/LeetCode-309-best-time-to-buy-and-sell-stock-with-transaction-fee/"/>
    <url>/2020/08/22/LeetCode-309-best-time-to-buy-and-sell-stock-with-transaction-fee/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/" target="_blank" rel="noopener">714. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹</a></p><p>æ­¤é¢˜åŠ äº†æ‰‹ç»­è´¹ï¼Œä½†è§£æ³•è¿˜æ˜¯å’Œç¬¬äºŒé¢˜ç±»ä¼¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices, <span class="hljs-keyword">int</span> fee)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -(prices[<span class="hljs-number">0</span>] + fee);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);        dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i] - fee);    &#125;    <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];&#125;</code></pre><p>å¯è¿›è¡ŒçŠ¶æ€å‹ç¼©</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices, <span class="hljs-keyword">int</span> fee)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = prices.length;        <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> dp0 = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> dp1 = -(prices[<span class="hljs-number">0</span>] + fee);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;            <span class="hljs-comment">// ä¿å­˜å‰ä¸€å¤©æŒæœ‰ç°é‡‘æ—¶çš„æœ€å¤§æ”¶ç›Š</span>            <span class="hljs-keyword">int</span> pre = dp0;            dp0 = Math.max(dp0, dp1 + prices[i]);            dp1 = Math.max(dp1, pre - prices[i] - fee);        &#125;        <span class="hljs-keyword">return</span> dp0;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 188.  ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV</title>
    <link href="/2020/08/22/LeetCode-188-best-time-to-buy-and-sell-stock-iv/"/>
    <url>/2020/08/22/LeetCode-188-best-time-to-buy-and-sell-stock-iv/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iv/" target="_blank" rel="noopener">188. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV</a></p><blockquote><p>ä¸€æ¬¡äº¤æ˜“è‡³å°‘éœ€è¦ 2 å¤©ï¼Œä¸€å¤©ä¹°ï¼Œä¸€å¤©å–ã€‚å› æ­¤å¦‚æœ <code>k</code> å¾ˆå¤§ï¼Œå¤§åˆ°å¤§äºç­‰äº <code>len / 2</code>ï¼Œå°±ç›¸å½“äºè‚¡ç¥¨ç³»åˆ—çš„ç¬¬ 2 é¢˜ï¼Œä½¿ç”¨è´ªå¿ƒç®—æ³•å»åšå°±å¯ä»¥äº†ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹åˆ¤ã€‚</p></blockquote><p>å¯è¿›è¡ŒçŠ¶æ€å‹ç¼©ï¼Œçœå»ç¬¬ä¸€ç»´ç©ºé—´ã€‚åŠ ä¸Šæ— é™äº¤æ˜“æ¬¡æ•°çš„è´ªå¿ƒç‰ˆæœ¬ï¼Œå¯åŠ å¿«é€Ÿåº¦ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// è‹¥ äº¤æ˜“æ¬¡æ•° &gt; å¤©æ•° / 2ï¼Œåˆ™æ— æ³•è¾¾æˆæœ‰æ•ˆçš„äº¤æ˜“ï¼Œæ­¤æ—¶ç­‰ä»·äºæ— é™æ¬¡äº¤æ˜“æ¬¡æ•°</span>    <span class="hljs-keyword">if</span> (k &gt; len / <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> maxProfit(prices);    &#125;    <span class="hljs-keyword">int</span>[][][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][k + <span class="hljs-number">1</span>][<span class="hljs-number">2</span>];    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€æ¬¡çŠ¶æ€</span>    <span class="hljs-comment">// 1 æ¬¡ä¹°å…¥</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; k + <span class="hljs-number">1</span>; i++) &#123;        dp[<span class="hljs-number">0</span>][i][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = k; j &gt; <span class="hljs-number">0</span>; j--) &#123;            dp[i][j][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>] + prices[i]);            dp[i][j][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i]);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][k][<span class="hljs-number">0</span>];&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);        dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i]);    &#125;    <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III</title>
    <link href="/2020/08/22/LeetCode-123-best-time-to-buy-and-sell-stock-iii/"/>
    <url>/2020/08/22/LeetCode-123-best-time-to-buy-and-sell-stock-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii/" target="_blank" rel="noopener">123. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> k = <span class="hljs-number">2</span>;    <span class="hljs-keyword">int</span>[][][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][k + <span class="hljs-number">1</span>][<span class="hljs-number">2</span>];    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€å¤©çŠ¶æ€ï¼Œåªéœ€è¦è€ƒè™‘æŒæœ‰è‚¡ç¥¨çš„æƒ…å†µ</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    <span class="hljs-comment">// 1 æ¬¡äº¤æ˜“ä¹°å…¥</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    <span class="hljs-comment">// 2 æ¬¡äº¤æ˜“ä¹°å…¥</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡äº¤æ˜“</span>        dp[i][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);        <span class="hljs-comment">// å¯èƒ½ä¹°å…¥ dp[i - 1][0][0] - prices[i]</span>        dp[i][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] - prices[i]);        <span class="hljs-comment">// ç¬¬äºŒæ¬¡äº¤æ˜“</span>        dp[i][<span class="hljs-number">2</span>][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">1</span>] + prices[i]);        <span class="hljs-comment">// å¯èƒ½ä¹°å…¥ dp[i - 1][1][0] - prices[i]</span>        dp[i][<span class="hljs-number">2</span>][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i]);    &#125;    <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][k][<span class="hljs-number">0</span>];&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">/*</span><span class="hljs-comment">    dp[i][0] æ²¡æœ‰äº¤æ˜“ rest</span><span class="hljs-comment">    dp[i][1] ç¬¬ä¸€æ¬¡ä¹°å…¥</span><span class="hljs-comment">    dp[i][2] ç¬¬ä¸€æ¬¡å–å‡º</span><span class="hljs-comment">    dp[i][3] ç¬¬äºŒæ¬¡ä¹°å…¥</span><span class="hljs-comment">    dp[i][4] ç¬¬äºŒæ¬¡å–å‡º</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">5</span>];    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡ä¹°å…¥</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    <span class="hljs-comment">// ç¬¬äºŒæ¬¡ä¹°å…¥å–å‡ºéƒ½è¿˜æ²¡å‘ç”Ÿ</span>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>] = Integer.MIN_VALUE;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>] = Integer.MIN_VALUE;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i]);        dp[i][<span class="hljs-number">2</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);        dp[i][<span class="hljs-number">3</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">3</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] - prices[i]);        dp[i][<span class="hljs-number">4</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">4</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">3</span>] + prices[i]);    &#125;    <span class="hljs-comment">// æ²¡æœ‰äº¤æ˜“ ç¬¬ä¸€æ¬¡å–å‡º ç¬¬äºŒæ¬¡å–å‡º ä¸­å¯èƒ½å­˜åœ¨æœ€å¤§å€¼</span>    <span class="hljs-keyword">return</span> Math.max(Math.max(dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">2</span>]), dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">4</span>]);&#125;</code></pre><p>å¯è¿›è¡ŒçŠ¶æ€å‹ç¼©ï¼Œçœå»ç¬¬ä¸€ç»´ç©ºé—´ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</title>
    <link href="/2020/08/22/LeetCode-121-best-time-to-buy-and-sell-stock/"/>
    <url>/2020/08/22/LeetCode-121-best-time-to-buy-and-sell-stock/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/" target="_blank" rel="noopener">121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</a></p><h1 id="è§£æ³•ä¸€"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€"></a> è§£æ³•ä¸€</h1><p>çŠ¶æ€ï¼š<br /><code>dp[i][j][s]</code>: ç¬¬ <code>i</code> å¤©æœ€å¤šè¿›è¡Œäº† <code>j</code> æ¬¡äº¤æ˜“åï¼ŒæŒæœ‰è‚¡ç¥¨çŠ¶æ€ä¸º <code>s</code> çš„æœ€å¤§åˆ©æ¶¦ã€‚</p><ul><li><code>i</code>: ç¬¬ <code>i</code> å¤©</li><li><code>j</code>: åˆ°ä»Šå¤©è¿›è¡Œçš„æœ€å¤§äº¤æ˜“æ¬¡æ•°</li><li><code>s</code>: ä»Šå¤©æ˜¯å¦æŒæœ‰è‚¡ç¥¨</li></ul><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><ul><li><code>dp[i][j][0] = max(dp[i-1][j][0], dp[i-1][j][1] + prices[i])</code><ul><li>æ˜¨å¤©å°±æ²¡æœ‰æŒæœ‰ï¼Œç„¶åä»Šå¤©é€‰æ‹© <code>rest</code>ï¼Œæ‰€ä»¥æˆ‘ä»Šå¤©è¿˜æ˜¯æ²¡æœ‰æŒæœ‰ï¼›</li><li>æ˜¨å¤©æŒæœ‰è‚¡ç¥¨ï¼Œä½†æ˜¯ä»Šå¤©æˆ‘ <code>sell</code> äº†ï¼Œæ‰€ä»¥æˆ‘ä»Šå¤©æ²¡æœ‰æŒæœ‰è‚¡ç¥¨äº†ã€‚</li></ul></li><li><code>dp[i][j][1] = max(dp[i-1][j][1], dp[i-1][j-1][0] - prices[i])</code><ul><li>æ˜¨å¤©å°±æŒæœ‰ç€è‚¡ç¥¨ï¼Œç„¶åä»Šå¤©é€‰æ‹© <code>rest</code>ï¼Œæ‰€ä»¥æˆ‘ä»Šå¤©è¿˜æŒæœ‰ç€è‚¡ç¥¨ï¼›</li><li>æ˜¨å¤©æœ¬æ²¡æœ‰æŒæœ‰ï¼Œä½†ä»Šå¤©æˆ‘é€‰æ‹© <code>buy</code>ï¼Œæ‰€ä»¥ä»Šå¤©æˆ‘å°±æŒæœ‰è‚¡ç¥¨äº†ã€‚</li></ul></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = prices.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> k = <span class="hljs-number">2</span>;    <span class="hljs-comment">// dp[i][j][1]: ç¬¬ i å¤©ï¼ŒæŒæœ‰è‚¡ç¥¨ï¼Œè‡³ä»Šå·²ç»è¿›è¡Œäº† j æ¬¡äº¤æ˜“</span>    <span class="hljs-keyword">int</span>[][][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][k][<span class="hljs-number">2</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; k; j++) &#123;            dp[i][j][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>] + prices[i]);            dp[i][j][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i], dp[i - <span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>]);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][k - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];&#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>çŠ¶æ€ï¼š</p><ul><li><code>dp[i][0]</code> - æŒæœ‰ç°é‡‘ è¡¨ç¤ºç¬¬ <code>i</code> å¤©<strong>å–å‡ºè‚¡ç¥¨åçš„æœ€å¤§åˆ©æ¶¦</strong></li><li><code>dp[i][1]</code> - æŒæœ‰è‚¡ç¥¨ è¡¨ç¤ºç¬¬ <code>i</code> å¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</li></ul><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p><ul><li><code>dp[i][0] = Math.max(dp[i - 1][0], dp[i - 1][1] + prices[i]);</code><ul><li>æ˜¨å¤©æŒæœ‰ç°é‡‘ï¼Œä»Šå¤© <code>rest</code>ï¼Œä»Šå¤©ä»æŒæœ‰ç°é‡‘</li><li>æ˜¨å¤©æŒæœ‰è‚¡ç¥¨ï¼Œä»Šå¤© <code>sell</code>ï¼Œä»Šå¤©å˜ä¸ºæŒæœ‰ç°é‡‘</li></ul></li><li><code>dp[i][1] = Math.max(dp[i - 1][1], -prices[i]);</code><ul><li>æ˜¨å¤©æŒæœ‰è‚¡ç¥¨ï¼Œä»Šå¤© <code>rest</code>ï¼Œä»Šå¤©ä»æŒæœ‰è‚¡ç¥¨</li><li>æ˜¨å¤©æŒæœ‰ç°é‡‘ï¼Œä»Šå¤© <code>buy</code>ï¼Œä»Šå¤©å˜ä¸ºæŒæœ‰è‚¡ç¥¨ï¼Œç”±äºåªèƒ½è¿›è¡Œä¸€æ¬¡äº¤æ˜“ï¼Œåªèƒ½ä¹°å…¥ä¸€æ¬¡è‚¡ç¥¨ï¼Œä¸èƒ½åŠ ä¸Šæ˜¨å¤©å–å‡ºè‚¡ç¥¨åçš„æœ€å¤§åˆ©æ¶¦</li></ul></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = prices.length;        <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-comment">// dp[i][0] - æŒæœ‰ç°é‡‘ è¡¨ç¤ºç¬¬ i å¤©å–å‡ºè‚¡ç¥¨åçš„æœ€å¤§åˆ©æ¶¦</span>        <span class="hljs-comment">// dp[i][1] - æŒæœ‰è‚¡ç¥¨ è¡¨ç¤ºç¬¬ i å¤©ä¹°å…¥è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</span>        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];        dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;        dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;            dp[i][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);            <span class="hljs-comment">// åªèƒ½è¿›è¡Œä¸€æ¬¡äº¤æ˜“ï¼Œæ„å‘³ç€åªèƒ½å–å‡ºä¸€æ¬¡è‚¡ç¥¨ï¼Œdp[i][1] ä¸å¯ä»¥ä» dp[i][0] è½¬ç§»è€Œæ¥</span>            dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], -prices[i]);        &#125;        <span class="hljs-keyword">return</span> dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];    &#125;</code></pre><h1 id="è§£æ³•ä¸‰"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸‰"></a> è§£æ³•ä¸‰</h1><p>ä½¿ç”¨å·®åˆ†æ•°ç»„ï¼Œæ±‚æ•°ç»„çš„æœ€å¤§å­åºå’Œå°±æ˜¯æœ€å¤§ç›ˆåˆ©ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;        <span class="hljs-keyword">int</span> len = prices.length;        <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">2</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span>[] diff = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len - <span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;            diff[i - <span class="hljs-number">1</span>] = prices[i] - prices[i - <span class="hljs-number">1</span>];        &#125;        <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len - <span class="hljs-number">1</span>];        dp[<span class="hljs-number">0</span>] = diff[<span class="hljs-number">0</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;            dp[i] = Math.max(dp[i - <span class="hljs-number">1</span>] + diff[i], diff[i]);        &#125;                <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; len - <span class="hljs-number">1</span>; i++) &#123;            max = Math.max(max, dp[i]);        &#125;        <span class="hljs-keyword">return</span> max;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 337. æ‰“å®¶åŠ«èˆ III</title>
    <link href="/2020/08/21/LeetCode-337-house-robber-iii/"/>
    <url>/2020/08/21/LeetCode-337-house-robber-iii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/house-robber-iii/" target="_blank" rel="noopener">337. æ‰“å®¶åŠ«èˆ III</a></p><h1 id="è§£æ³•ä¸€è®°å¿†åŒ–é€’å½’"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€è®°å¿†åŒ–é€’å½’"></a> è§£æ³•ä¸€ï¼šè®°å¿†åŒ–é€’å½’</h1><pre><code class="hljs java">Map&lt;TreeNode, Integer&gt; memo = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rob</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">if</span> (memo.containsKey(root)) &#123;            <span class="hljs-keyword">return</span> memo.get(root);        &#125;        <span class="hljs-comment">// æ‰“åŠ«æ ¹ç»“ç‚¹</span>        <span class="hljs-keyword">int</span> doRob = root.val;        <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) &#123;            doRob += rob(root.left.left) + rob(root.left.right);        &#125;        <span class="hljs-keyword">if</span> (root.right != <span class="hljs-keyword">null</span>) &#123;            doRob += rob(root.right.left) + rob(root.right.right);        &#125;        <span class="hljs-comment">// ä¸æ‰“åŠ«æ ¹ç»“ç‚¹</span>        <span class="hljs-keyword">int</span> notRob = rob(root.left) + rob(root.right);        <span class="hljs-keyword">int</span> res = Math.max(doRob, notRob);        memo.put(root, res);        <span class="hljs-keyword">return</span> res;    &#125;</code></pre><h1 id="è§£æ³•äºŒ"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒ"></a> è§£æ³•äºŒ</h1><p>çŠ¶æ€ï¼š</p><ul><li><code>dp[root][0]</code> - ä¸æ‰“åŠ« <code>root</code> ç»“ç‚¹</li><li><code>dp[root][1]</code> - æ‰“åŠ« <code>root</code> ç»“ç‚¹</li></ul><p>è½¬ç§»æ–¹ç¨‹ï¼š</p><ul><li><code>dp[root][0]</code>ï¼šå·¦å³å­ç»“ç‚¹å¯é€‰æ‹©å·æˆ–ä¸å·ï¼Œå–ä»–ä»¬çš„æœ€å¤§å€¼</li><li><code>dp[root][1]</code>ï¼šå·¦å³å­ç»“ç‚¹ä¸å·</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rob</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] res = robber(root);    <span class="hljs-keyword">return</span> Math.max(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>]);&#125;<span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] robber(TreeNode root) &#123;    <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;    &#125;    <span class="hljs-comment">// ååºéå†ï¼Œè‡ªåº•å‘ä¸Šï¼Œå…ˆè®¡ç®—å·¦å³ç»“ç‚¹ï¼Œå†è®¡ç®— root</span>    <span class="hljs-keyword">int</span>[] left = robber(root.left);    <span class="hljs-keyword">int</span>[] right = robber(root.right);    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];    <span class="hljs-comment">// æ‰“åŠ« root</span>    dp[<span class="hljs-number">1</span>] = root.val + left[<span class="hljs-number">0</span>] + right[<span class="hljs-number">0</span>];    <span class="hljs-comment">// ä¸æ‰“åŠ« root</span>    dp[<span class="hljs-number">0</span>] = Math.max(left[<span class="hljs-number">0</span>], left[<span class="hljs-number">1</span>]) + Math.max(right[<span class="hljs-number">0</span>], right[<span class="hljs-number">1</span>]);    <span class="hljs-keyword">return</span> dp;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 213. æ‰“å®¶åŠ«èˆ II</title>
    <link href="/2020/08/21/LeetCode-213-house-robber-ii/"/>
    <url>/2020/08/21/LeetCode-213-house-robber-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/house-robber-ii/" target="_blank" rel="noopener">213. æ‰“å®¶åŠ«èˆ II</a></p><p>é¢˜ç›®è¯´æ˜ï¼šé¦–å°¾ä¸èƒ½åŒæ—¶ robï¼Œé‚£ä¹ˆå¯ä»¥å»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ æˆ–å»é™¤æœ€åä¸€ä¸ªå…ƒç´ è¿›è¡Œ robï¼Œè¿˜æ˜¯ä½¿ç”¨ <a href="https://leetcode-cn.com/problems/house-robber/" target="_blank" rel="noopener">198. æ‰“å®¶åŠ«èˆ</a> çš„è§£æ³•</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rob</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> nums[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">return</span> Math.max(robRange(nums, <span class="hljs-number">0</span>, len - <span class="hljs-number">2</span>), robRange(nums, <span class="hljs-number">1</span>, len - <span class="hljs-number">1</span>));&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">robRange</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> end)</span> </span>&#123;    <span class="hljs-keyword">int</span> i_2 = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> i_1 = nums[start];    <span class="hljs-keyword">int</span> cur = nums[start];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = start + <span class="hljs-number">1</span>; i &lt;= end; i++) &#123;        cur = Math.max(i_1, i_2 + nums[i]);        i_2 = i_1;        i_1 = cur;    &#125;    <span class="hljs-keyword">return</span> cur;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 198. æ‰“å®¶åŠ«èˆ</title>
    <link href="/2020/08/21/LeetCode-198-house-robber/"/>
    <url>/2020/08/21/LeetCode-198-house-robber/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/house-robber/" target="_blank" rel="noopener">198. æ‰“å®¶åŠ«èˆ</a></p><p>çŠ¶æ€ï¼š<code>dp[i]</code> ç¬¬ <code>i</code> ä¸ªæ•°ç»“å°¾çš„æœ€å¤§å­åºåˆ—å’Œ<br />è½¬ç§»ï¼š</p><ul><li>ä¸å· <code>nums[i]</code>, <code>dp[i] = dp[i - 1]</code></li><li>å· <code>nums[i - 2]</code>, <code>dp[i] = dp[i - 2] + nums[i - 1]</code></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rob</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len + <span class="hljs-number">1</span>];    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    dp[<span class="hljs-number">1</span>] = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= len; i++) &#123;        dp[i] = Math.max(dp[i - <span class="hljs-number">1</span>], dp[i - <span class="hljs-number">2</span>] + nums[i - <span class="hljs-number">1</span>]);    &#125;    <span class="hljs-keyword">return</span> dp[len];&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rob</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-comment">// 0: ä¸å·ï¼Œ1: å·</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];    dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);        dp[i][<span class="hljs-number">1</span>] = nums[i] + dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">return</span> Math.max(dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[len - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</title>
    <link href="/2020/08/21/LeetCode-152-maximum-product-subarray/"/>
    <url>/2020/08/21/LeetCode-152-maximum-product-subarray/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-product-subarray/" target="_blank" rel="noopener">152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</a></p><p>çŠ¶æ€ï¼š</p><ul><li><code>dp[i][0]</code>: ä»¥ <code>nums[i]</code> ç»“å°¾çš„å­æ•°ç»„æœ€å°å€¼</li><li><code>dp[i][1]</code>: ä»¥ <code>nums[i]</code> ç»“å°¾çš„å­æ•°ç»„æœ€å¤§å€¼</li></ul><p>çŠ¶æ€è½¬ç§»ï¼š</p><ul><li><code>nums[i] &gt; 0</code><ul><li><code>æœ€å¤§å€¼ * nums[i]</code> è¿˜æ˜¯æœ€å¤§å€¼</li><li><code>æœ€å°å€¼ * nums[i]</code> è¿˜æ˜¯æœ€å°å€¼</li></ul></li><li><code>nums[i] &gt; 0</code><ul><li><code>æœ€å¤§å€¼ * nums[i]</code> = æœ€å°å€¼</li><li><code>æœ€å°å€¼ * nums[i]</code> = æœ€å¤§å€¼</li></ul></li></ul><p>å’Œ <a href="https://leetcode-cn.com/problems/maximum-subarray/" target="_blank" rel="noopener">53. æœ€å¤§å­åºå’Œ</a> ç±»ä¼¼ï¼Œåªè¦è®¡ç®—å½“å‰æ•°å­— <code>nums[i]</code> å¯¹ <code>min</code> æˆ– <code>max</code> çš„å¢ç›Šï¼Œè‹¥æœ‰åˆ©äºä»–ä»¬çš„æœ€å€¼ï¼Œåˆ™è¿›è¡Œæ›´æ–°ï¼Œå¦åˆ™ä» <code>nums[i]</code> å¼€å§‹é‡æ–°è®¡ç®—æœ€å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProduct</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-comment">/*</span><span class="hljs-comment">         nums[i] &gt; 0:</span><span class="hljs-comment">            max * nums[i] -&gt; max</span><span class="hljs-comment">                dp[i - 1][1] &gt; 0, max = nums[i] * dp[i - 1][1] else nums[i]</span><span class="hljs-comment">            min * nums[i] -&gt; min</span><span class="hljs-comment">                dp[i - 1][0] &lt; 0, min = nums[i] * dp[i - 1][0] else nums[i]</span><span class="hljs-comment"></span><span class="hljs-comment">         num[i] &lt; 0:</span><span class="hljs-comment">            max * nums[i] -&gt; min</span><span class="hljs-comment">                dp[i - 1][1] &gt; 0, min = nums[i] * dp[i - 1][1] else nums[i]</span><span class="hljs-comment">            min * nums[i] -&gt; max</span><span class="hljs-comment">                dp[i - 1][0] &lt; 0, max = nums[i] * dp[i - 1][0] else nums[i]</span><span class="hljs-comment">         */</span>        <span class="hljs-keyword">int</span> len = nums.length;        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len][<span class="hljs-number">2</span>];        dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = nums[<span class="hljs-number">0</span>];        dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = nums[<span class="hljs-number">0</span>];        <span class="hljs-keyword">int</span> max = dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;            <span class="hljs-keyword">if</span> (nums[i] &gt; <span class="hljs-number">0</span>) &#123;                dp[i][<span class="hljs-number">0</span>] = Math.min(nums[i], nums[i] * dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>]);                dp[i][<span class="hljs-number">1</span>] = Math.max(nums[i], nums[i] * dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);            &#125; <span class="hljs-keyword">else</span> &#123;                dp[i][<span class="hljs-number">0</span>] = Math.min(nums[i], nums[i] * dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);                dp[i][<span class="hljs-number">1</span>] = Math.max(nums[i], nums[i] * dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>]);            &#125;            max = Math.max(max, dp[i][<span class="hljs-number">1</span>]);        &#125;        <span class="hljs-keyword">return</span> max;    &#125;&#125;</code></pre><p>ç©ºé—´ä¼˜åŒ–ï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProduct</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> len = nums.length;    <span class="hljs-keyword">int</span> imax = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">int</span> imin = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">int</span> max = imax;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;        <span class="hljs-comment">// äº¤æ¢ imax å’Œ iminï¼Œçœå»åé¢çš„äºŒæ¬¡åˆ¤æ–­</span>        <span class="hljs-comment">// å¦åˆ™ä¼šå‡ºç° imax å’Œ imin äº’ç›¸ä¾èµ–çš„æƒ…å†µ</span>        <span class="hljs-keyword">if</span> (nums[i] &lt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">int</span> t = imin;            imin = imax;            imax = t;        &#125;        imin = Math.min(nums[i], nums[i] * imin);        imax = Math.max(nums[i], nums[i] * imax);        max = Math.max(max, imax);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 53. æœ€å¤§å­åºå’Œ</title>
    <link href="/2020/08/20/LeetCode-53-maximum-subarray/"/>
    <url>/2020/08/20/LeetCode-53-maximum-subarray/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/maximum-subarray/" target="_blank" rel="noopener">53. æœ€å¤§å­åºå’Œ</a></p><p>çŠ¶æ€è½¬ç§»ï¼šå¦‚æœå‰ä¸€ä¸ªå­åºåˆ—å’Œ <code>nums[i - 1]</code> æ— æ³•ä¸º <code>nums[i]</code> å¸¦æ¥æ­£å¢ç›Šï¼Œåˆ™ <code>nums[i]</code> ä¸º <code>dp[i]</code> çš„æœ€å¤§å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * çŠ¶æ€ï¼šdp[i] ä»¥ nums[i] ç»“å°¾çš„å­æ•°ç»„æœ€å¤§å’Œ</span><span class="hljs-comment"> * è½¬ç§»æ–¹ç¨‹ï¼š</span><span class="hljs-comment"> * dp[i] = å‰ä¸€ä¸ªå­åºåˆ— + nums[i] if å‰ä¸€ä¸ªå­åºåˆ— + nums[i] &gt; nums[i] else nums[i]</span><span class="hljs-comment"> * dp[i] = nums[i] è¡¨ç¤ºé‡æ–°å¼€å§‹è®¡ç®—æ–°çš„å­åºåˆ—å’Œ</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSubArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> max = Integer.MIN_VALUE;    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[nums.length];    dp[<span class="hljs-number">0</span>] = nums[<span class="hljs-number">0</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; nums.length; i++) &#123;        dp[i] = Math.max(nums[i], dp[i - <span class="hljs-number">1</span>] + nums[i]);        max = Math.max(dp[i], max);    &#125;    <span class="hljs-keyword">return</span> max;&#125;</code></pre><p>ç©ºé—´ä¼˜åŒ–ï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxSubArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">int</span> dp = nums[<span class="hljs-number">0</span>];        <span class="hljs-keyword">int</span> max = dp;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; nums.length; i++) &#123;            dp = Math.max(nums[i], dp + nums[i]);            max = Math.max(dp, max);        &#125;        <span class="hljs-keyword">return</span> max;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</title>
    <link href="/2020/08/20/LeetCode-120-triangle/"/>
    <url>/2020/08/20/LeetCode-120-triangle/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/triangle/" target="_blank" rel="noopener">120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</a></p><p>æœ€å¼€å§‹ç”¨å›æº¯ï¼Œæœ€åä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æœªé€šè¿‡ï¼ŒåŸå› æ˜¯è¾“å‡ºå¤ªé•¿äº†ã€‚<br />ç„¶åç”¨åŠ¨æ€è§„åˆ’ï¼š<br />çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<br /><code>dp[i][j] = triangle[i][j] + min(dp[i + 1][j], dp[i + 1][j + 1])</code></p><h1 id="è‡ªé¡¶å‘ä¸‹"><a class="markdownIt-Anchor" href="#è‡ªé¡¶å‘ä¸‹"></a> è‡ªé¡¶å‘ä¸‹</h1><p>åˆ¤æ–­å¾ˆå¤šï¼Œæœ€åè¿˜è¦æ’åºï¼Œè™½ç„¶ä¹Ÿè¿‡äº†ï¼Œåæ¥é¢˜è§£å‘ç°å¯ä»¥é‡‡ç”¨è‡ªåº•å‘ä¸Šå¯ä»¥æ–¹ä¾¿å¾ˆå¤šã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minimumTotal</span><span class="hljs-params">(List&lt;List&lt;Integer&gt;&gt; triangle)</span> </span>&#123;    <span class="hljs-keyword">int</span> size = triangle.size();    <span class="hljs-keyword">if</span> (size == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[size][size];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] line : dp) &#123;        Arrays.fill(line, Integer.MAX_VALUE);    &#125;    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = triangle.get(<span class="hljs-number">0</span>).get(<span class="hljs-number">0</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; size; i++) &#123;        List&lt;Integer&gt; curRow = triangle.get(i);        <span class="hljs-comment">// æ¯è¡Œçš„ç¬¬ä¸€ä¸ªä½ç½®</span>        dp[i][<span class="hljs-number">0</span>] = dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + curRow.get(<span class="hljs-number">0</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; curRow.size(); j++) &#123;            dp[i][j] = Math.min(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]) + curRow.get(j);        &#125;    &#125;    <span class="hljs-comment">// æ±‚æœ€åä¸€è¡Œçš„æœ€å°å€¼</span>    Arrays.sort(dp[size - <span class="hljs-number">1</span>]);    <span class="hljs-keyword">return</span> dp[size - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];&#125;</code></pre><h1 id="è‡ªåº•å‘ä¸Š"><a class="markdownIt-Anchor" href="#è‡ªåº•å‘ä¸Š"></a> è‡ªåº•å‘ä¸Š</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minimumTotal</span><span class="hljs-params">(List&lt;List&lt;Integer&gt;&gt; triangle)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = triangle.size();    <span class="hljs-comment">// å¤šåˆ†é…ä¸€è¡Œï¼Œä¸ç”¨åˆ¤æ–­è¾¹ç•Œ</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n + <span class="hljs-number">1</span>][n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-comment">// æ¯è¡Œå…ƒç´ çš„ä¸ªæ•°å°±æ˜¯è¯¥è¡Œ è¡Œå·</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;            <span class="hljs-comment">// å› ä¸ºä¸Šé¢çš„è¡Œæ•°æ€»æ˜¯ &lt; ä¸‹é¢çš„è¡Œæ•°ï¼Œä¸ç”¨æ‹…å¿ƒè¶Šç•Œ</span>            dp[i][j] = triangle.get(i).get(j) + Math.min(dp[i + <span class="hljs-number">1</span>][j], dp[i + <span class="hljs-number">1</span>][j + <span class="hljs-number">1</span>]);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];&#125;</code></pre><p>ç©ºé—´ä¼˜åŒ–ï¼š<br />è®¡ç®— <code>dp[i][j]dp[i][j]</code> æ—¶ï¼Œåªç”¨åˆ°äº†ä¸‹ä¸€è¡Œçš„ <code>dp[i + 1][j]dp[i+1][j]</code> å’Œ <code>dp[i + 1][j + 1]dp[i+1][j+1]</code>ï¼Œå› æ­¤åªç”¨ä¸€è¡Œå°±å¯ä»¥äº†ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minimumTotal</span><span class="hljs-params">(List&lt;List&lt;Integer&gt;&gt; triangle)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = triangle.size();    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n + <span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j++) &#123;            dp[j] = triangle.get(i).get(j) + Math.min(dp[j], dp[j + <span class="hljs-number">1</span>]);        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[<span class="hljs-number">0</span>];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 1143. æœ€é•¿å…¬å…±å­åºåˆ—</title>
    <link href="/2020/08/20/LeetCode-1143-longest-common-subsequence/"/>
    <url>/2020/08/20/LeetCode-1143-longest-common-subsequence/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/longest-common-subsequence/" target="_blank" rel="noopener">1143. æœ€é•¿å…¬å…±å­åºåˆ—</a></p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200820153633.png" srcset="/img/loading.gif" alt="" /></p><p>base: ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰ä¸€ä¸ªä¸ºç©ºï¼Œåˆ™ <code>dp[0][j] = 0</code> æˆ– <code>dp[i][0] = 0</code><br />çŠ¶æ€ï¼š<code>dp[i][j]</code> -&gt; <code>str1[:i]</code> å’Œ <code>str[:j]</code> çš„æœ€é•¿åºåˆ—<br />è½¬ç§»ï¼š</p><ul><li>æ¯”è¾ƒä½ç½®ï¼š<code>str[:i], str[:j]</code> || <code>str1[:i-1]</code>, <code>str2[:j]</code> || <code>str1[:i]</code>, <code>str2[:j-1]</code></li><li>è‹¥ <code>i</code>, <code>j</code> ä½ç½®ç›¸ç­‰ï¼Œç›´æ¥ + 1</li><li>è‹¥ä¸ç­‰ï¼šå– <code>str1[:i-1]</code>, <code>str2[:j]</code> å’Œ <code>str1[:i]</code>, <code>str2[:j-1]</code> ä¸­çš„æœ€å¤§å€¼</li></ul><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">longestCommonSubsequence</span><span class="hljs-params">(String text1, String text2)</span> </span>&#123;        <span class="hljs-keyword">int</span> len1 = text1.length();        <span class="hljs-keyword">int</span> len2 = text2.length();        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[len1 + <span class="hljs-number">1</span>][len2 + <span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= len1; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= len2; j++) &#123;                <span class="hljs-keyword">if</span> (text1.charAt(i - <span class="hljs-number">1</span>) == text2.charAt(j - <span class="hljs-number">1</span>)) &#123;                    dp[i][j] = dp[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;                &#125; <span class="hljs-keyword">else</span> &#123;                    dp[i][j] = Math.max(dp[i - <span class="hljs-number">1</span>][j], dp[i][j - <span class="hljs-number">1</span>]);                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> dp[len1][len2];    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 322. é›¶é’±å…‘æ¢</title>
    <link href="/2020/08/19/LeetCode-322-coin-change/"/>
    <url>/2020/08/19/LeetCode-322-coin-change/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/coin-change/" target="_blank" rel="noopener">322. é›¶é’±å…‘æ¢</a></p><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">coinChange</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] coins, <span class="hljs-keyword">int</span> amount)</span> </span>&#123;    <span class="hljs-keyword">int</span>[] mem = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[amount + <span class="hljs-number">1</span>];    <span class="hljs-keyword">return</span> dp(amount, coins, mem);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> amount, <span class="hljs-keyword">int</span>[] coins, <span class="hljs-keyword">int</span>[] mem)</span> </span>&#123;    <span class="hljs-keyword">if</span> (amount == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">if</span> (amount &lt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">// è‹¥å‘½ä¸­ç¼“å­˜ï¼Œç›´æ¥è¿”å›</span>    <span class="hljs-keyword">if</span> (mem[amount] != <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> mem[amount];    &#125;    <span class="hljs-keyword">int</span> count = Integer.MAX_VALUE;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> coin : coins) &#123;        <span class="hljs-comment">// è®¡ç®—å‡å» coin åæœ€å°çš„ç¡¬å¸æ•°é‡</span>        <span class="hljs-keyword">int</span> prev = amount - coin;        <span class="hljs-keyword">int</span> prevCount = dp(prev, coins, mem);        <span class="hljs-comment">// è‹¥èƒ½æ‰¾åˆ° prev çš„æœ€å°æ•°ç›®ï¼Œè®¡ç®—æœ¬æ¬¡ count çš„æœ€å°å€¼</span>        <span class="hljs-keyword">if</span> (prevCount != -<span class="hljs-number">1</span>) &#123;            count = Math.min(prevCount + <span class="hljs-number">1</span>, count);        &#125;    &#125;    <span class="hljs-comment">// æ›´æ–°ç¼“å­˜</span>    mem[amount] = count == Integer.MAX_VALUE ? -<span class="hljs-number">1</span> : count;    <span class="hljs-keyword">return</span> mem[amount];&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">coinChange</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] coins, <span class="hljs-keyword">int</span> amount)</span> </span>&#123;    <span class="hljs-comment">// 1, 2, 5 =&gt; 11</span>    <span class="hljs-comment">// 10: dp[10] + 1</span>    <span class="hljs-comment">// 9: dp[9] + 1</span>    <span class="hljs-comment">// 6: dp[6] + 1</span>    <span class="hljs-comment">// base: 0, 1, 1</span>    <span class="hljs-comment">// çŠ¶æ€: dp[i] è¡¨ç¤ºç¬¬ i ä¸ªå€¼éœ€è¦çš„æœ€å°ç¡¬å¸æ•°</span>    <span class="hljs-comment">// é€‰æ‹©ï¼šæ¯ä¸€ç§ç¡¬å¸</span>    <span class="hljs-comment">// dp[i] = min(dp[i - coin])</span>    <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[amount + <span class="hljs-number">1</span>];    Arrays.fill(dp, Integer.MAX_VALUE);    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; amount; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> coin : coins) &#123;            <span class="hljs-comment">// å‰ä¸€ä¸ªå€¼æœ‰æ•ˆ &amp;&amp; å‰ä¸€ä¸ªå€¼èƒ½å¤Ÿå–å¾—æœ€å°ç¡¬å¸æ•°</span>            <span class="hljs-keyword">if</span> (i - coin &gt;= <span class="hljs-number">0</span> &amp;&amp; dp[i - coin] != Integer.MAX_VALUE) &#123;                dp[i] = Math.min(dp[i - coin] + <span class="hljs-number">1</span>, dp[i]);            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[amount] == Integer.MAX_VALUE ? -<span class="hljs-number">1</span> : dp[amount];&#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">coinChange</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] coins, <span class="hljs-keyword">int</span> amount)</span> </span>&#123;    ArrayDeque&lt;Integer&gt; queue = <span class="hljs-keyword">new</span> ArrayDeque&lt;&gt;();    <span class="hljs-keyword">boolean</span>[] visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[amount + <span class="hljs-number">1</span>];    queue.add(amount);    visited[amount] = <span class="hljs-keyword">true</span>;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        count++;        <span class="hljs-keyword">int</span> size = queue.size();        <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">int</span> cur = queue.poll();            <span class="hljs-keyword">if</span> (cur == <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> count - <span class="hljs-number">1</span>;            &#125;            <span class="hljs-comment">// ä¾æ¬¡å˜æ¢é›¶é’±</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> coin : coins) &#123;                <span class="hljs-keyword">int</span> diff = cur - coin;                <span class="hljs-keyword">if</span> (diff &gt;= <span class="hljs-number">0</span> &amp;&amp; !visited[diff]) &#123;                    queue.add(diff);                    visited[diff] = <span class="hljs-keyword">true</span>;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL å¤åˆ¶</title>
    <link href="/2020/08/19/MySQL-replication/"/>
    <url>/2020/08/19/MySQL-replication/</url>
    
    <content type="html"><![CDATA[<h1 id="å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#å·¥ä½œåŸç†"></a> å·¥ä½œåŸç†</h1><ol><li>ä¸»æœåŠ¡å™¨æŠŠæ•°æ®æ›´æ”¹è®°å½•åˆ°äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚</li><li>ä»æœåŠ¡å™¨æŠŠä¸»æœåŠ¡å™¨çš„äºŒè¿›åˆ¶æ—¥å¿—å¤åˆ¶åˆ°è‡ªå·±çš„ä¸­ç»§æ—¥å¿—ä¸­ã€‚</li><li>ä»æœåŠ¡å™¨é‡åšä¸­ç»§æ—¥å¿—ä¸­çš„æ—¥å¿—ï¼ŒæŠŠæ›´æ”¹åº”ç”¨åˆ°è‡ªå·±çš„æ•°æ®åº“ä¸Šï¼Œä»¥è¾¾åˆ°æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¤åˆ¶ä¸æ˜¯å®Œå…¨å®æ—¶åœ°è¿›è¡ŒåŒæ­¥ï¼Œè€Œæ˜¯<strong>å¼‚æ­¥å®æ—¶</strong>ã€‚è¿™ä¸­é—´å­˜åœ¨ä¸»ä»æœåŠ¡å™¨ä¹‹é—´çš„æ‰§è¡Œå»¶æ—¶ï¼Œå¦‚æœä¸»æœåŠ¡å™¨çš„å‹åŠ›å¾ˆå¤§ï¼Œåˆ™å¯èƒ½å¯¼è‡´ä¸»ä»æœåŠ¡å™¨å»¶æ—¶è¾ƒå¤§ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819125023.png" srcset="/img/loading.gif" alt="" /></p><h1 id="å¿«ç…§-å¤åˆ¶çš„å¤‡ä»½æ¶æ„"><a class="markdownIt-Anchor" href="#å¿«ç…§-å¤åˆ¶çš„å¤‡ä»½æ¶æ„"></a> å¿«ç…§ + å¤åˆ¶çš„å¤‡ä»½æ¶æ„</h1><p>å¤åˆ¶çš„ä¸»è¦åŠŸèƒ½ï¼š</p><ul><li><strong>æ•°æ®åˆ†å¸ƒ</strong><br />å¯ä»¥åœ¨ä¸åŒçš„æ•°æ®ä¸­å¿ƒå®ç°æ•°æ®çš„å¤åˆ¶ã€‚</li><li><strong>è¯»å–çš„è´Ÿè½½å¹³è¡¡</strong><br />é€šè¿‡å»ºç«‹å¤šä¸ªä»æœåŠ¡å™¨ï¼Œå¯å°†è¯»å–å¹³å‡åœ°åˆ†å¸ƒåˆ°è¿™äº›ä»æœåŠ¡å™¨ä¸­ï¼Œå¹¶ä¸”å‡å°‘äº†ä¸»æœåŠ¡å™¨çš„å‹åŠ›</li><li><strong>æ•°æ®åº“å¤‡ä»½</strong><br />å¤åˆ¶å¯¹å¤‡ä»½å¾ˆæœ‰å¸®åŠ©ï¼Œä½†æ˜¯ä»æœåŠ¡å™¨ä¸æ˜¯å¤‡ä»½ï¼Œä¸èƒ½å®Œå…¨ä»£æ›¿å¤‡ä»½ã€‚</li><li><strong>é«˜å¯ç”¨æ€§å’Œæ•…éšœè½¬ç§»</strong><br />ä»æœåŠ¡å™¨æœ‰åŠ©äºæ•…éšœè½¬ç§»ï¼Œå‡å°‘æ•…éšœçš„åœæœºæ—¶é—´å’Œæ¢å¤æ—¶é—´</li></ul><p>é€šè¿‡å¯¹ä»æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æ‰€åœ¨åˆ†åŒºåšå¿«ç…§ï¼Œå¯é¿å…è¯¯æ“ä½œå¯¹å¤åˆ¶é€ æˆå½±å“ã€‚å½“å‘ç”Ÿä¸»æœåŠ¡å™¨ä¸Šçš„è¯¯æ“ä½œæ—¶ï¼Œåªéœ€è¦å°†ä»æœåŠ¡å™¨ä¸Šçš„å¿«ç…§è¿›è¡Œæ¢å¤ï¼Œç„¶åå†æ ¹æ®äºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œ <code>point-in-time</code> çš„æ¢å¤ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819131452.png" srcset="/img/loading.gif" alt="" /></p><h1 id="å¤åˆ¶çš„åŸç†"><a class="markdownIt-Anchor" href="#å¤åˆ¶çš„åŸç†"></a> å¤åˆ¶çš„åŸç†</h1><p>é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ï¼Œå¦‚æœå‘ç°è¯­å¥æ— æ³•è¢«æ­£ç¡®åœ°å¤åˆ¶ï¼Œå°±åˆ‡æ¢åˆ°åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼ã€‚</p><h2 id="åŸºäºè¯­å¥çš„å¤åˆ¶"><a class="markdownIt-Anchor" href="#åŸºäºè¯­å¥çš„å¤åˆ¶"></a> åŸºäºè¯­å¥çš„å¤åˆ¶</h2><p>åœ¨åŸºäºè¯­å¥çš„å¤åˆ¶æ¨¡å¼ä¸‹ï¼Œä¸»åº“ä¼šè®°å½•é‚£äº›é€ æˆæ•°æ®æ›´æ”¹çš„æŸ¥è¯¢ï¼Œå½“å¤‡åº“è¯»å–å¹¶é‡æ”¾è¿™äº›äº‹ä»¶æ—¶ï¼Œå®é™…ä¸Šåªæ˜¯æŠŠä¸»åº“ä¸Šæ‰§è¡Œçš„ <code>SQL</code> è¯­å¥å†æ‰§è¡Œä¸€éã€‚</p><p><code>mysqlbinlog</code> å·¥å…·æ˜¯ä½¿ç”¨åŸºäºè¯­å¥çš„æ—¥å¿—çš„æœ€ä½³å·¥å…·ã€‚</p><p>å¥½å¤„ï¼š</p><ol><li>å®ç°ç®€å•ã€‚åªè¦è®°å½•å’Œæ‰§è¡Œ <code>SQL</code> è¯­å¥ã€‚</li><li>äºŒè¿›åˆ¶æ—¥å¿—é‡Œçš„äº‹ä»¶æ›´åŠ ç´§å‡‘ï¼Œä¸ä¼šä½¿ç”¨å¤ªå¤šå¸¦å®½ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨çš„è¯­å¥å¤åˆ¶æ—¶å¯èƒ½å­˜åœ¨é—®é¢˜ï¼ˆæ—¶é—´æˆ³ã€ç”¨æˆ·ï¼‰ã€‚</li><li>æ›´æ–°å¿…é¡»æ˜¯ä¸²è¡Œçš„ï¼Œéœ€è¦æ›´å¤šçš„é”ã€‚</li></ol><h2 id="åŸºäºè¡Œçš„å¤åˆ¶"><a class="markdownIt-Anchor" href="#åŸºäºè¡Œçš„å¤åˆ¶"></a> åŸºäºè¡Œçš„å¤åˆ¶</h2><p>åŸºäºè¡Œçš„å¤åˆ¶ä¼šå°†å®é™…æ•°æ®è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚</p><p>å¥½å¤„ï¼š</p><ol><li>å‡ ä¹æ²¡æœ‰åŸºäºè¡Œçš„å¤åˆ¶æ¨¡å¼æ— æ³•å¤„ç†çš„åœºæ™¯ã€‚</li><li>å¯èƒ½å‡å°‘é”çš„ä½¿ç”¨ã€‚</li><li>ä¼šè®°å½•æ•°æ®å˜æ›´ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>ç”±äºè¯­å¥å¹¶æ²¡æœ‰åœ¨æ—¥å¿—é‡Œè®°å½•ï¼Œæ— æ³•åˆ¤æ–­æ‰§è¡Œäº†å“ªäº› <code>SQL</code>ã€‚</li><li>ä½¿ç”¨ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼åœ¨å¤‡åº“è¿›è¡Œæ•°æ®å˜æ›´ï¼Œæ— æ³•çŸ¥é“æœåŠ¡å™¨åœ¨åšä»€ä¹ˆã€‚</li></ol><h1 id="å¤åˆ¶æ‹“æ‰‘"><a class="markdownIt-Anchor" href="#å¤åˆ¶æ‹“æ‰‘"></a> å¤åˆ¶æ‹“æ‰‘</h1><p>åŸºæœ¬åŸåˆ™ï¼š</p><ol><li>ä¸€ä¸ª <code>MySQL</code> å¤‡åº“å®ä¾‹åªèƒ½æœ‰ä¸€ä¸ªä¸»åº“ã€‚</li><li>ä¸€ä¸ªä¸»åº“å¯ä»¥æœ‰å¤šä¸ªå¤‡åº“ã€‚</li><li>æ¯ä¸ªå¤‡åº“å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„æœåŠ¡å™¨ <code>ID</code>ã€‚</li><li>å¦‚æœæ‰“å¼€äº† <code>log_slave_updates</code> é€‰é¡¹ï¼Œä¸€ä¸ªå¤‡åº“å¯ä»¥æŠŠå…¶ä¸»åº“ä¸Šçš„æ•°æ®å˜åŒ–ä¼ æ’­åˆ°å…¶ä»–å¤‡åº“ã€‚</li></ol><h2 id="ä¸€ä¸»åº“å¤šå¤‡åº“"><a class="markdownIt-Anchor" href="#ä¸€ä¸»åº“å¤šå¤‡åº“"></a> ä¸€ä¸»åº“å¤šå¤‡åº“</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819135637.png" srcset="/img/loading.gif" alt="" /></p><p>ç”¨é€”ï¼š</p><ol><li>ä¸ºä¸åŒçš„è§’è‰²ä½¿ç”¨ä¸åŒçš„å¤‡åº“ã€‚</li><li>æŠŠä¸€å°å¤‡åº“å½“ä½œå¾…ç”¨çš„ä¸»åº“ï¼Œé™¤äº†å¤åˆ¶æ²¡æœ‰å…¶ä»–æ•°æ®ä¼ è¾“ã€‚</li><li>å°†ä¸€å°å¤‡åº“æ”¾åˆ°è¿œç¨‹æ•°æ®ä¸­å¿ƒï¼Œç”¨ä½œç¾éš¾æ¢å¤ã€‚</li><li>å°†ä¸€å°å¤‡åº“ä½œä¸ºå¤‡ä»½ã€åŸ¹è®­ã€å¼€å‘ã€æµ‹è¯•æœåŠ¡å™¨ã€‚</li></ol><h2 id="ä¸»åŠ¨-ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶"><a class="markdownIt-Anchor" href="#ä¸»åŠ¨-ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶"></a> ä¸»åŠ¨-ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819135956.png" srcset="/img/loading.gif" alt="" /></p><ul><li>ä¸»-ä¸»å¤åˆ¶åŒ…å«ä¸¤å°æœåŠ¡å™¨ï¼Œæ¯ä¸€ä¸ªéƒ½è¢«é…ç½®æˆå¯¹æ–¹çš„ä¸»åº“å’Œå¤‡åº“ï¼Œå®ƒä»¬æ˜¯ä¸€å¯¹ä¸»åº“ã€‚</li><li>è¯¥æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯æ˜¯ä¸¤ä¸ªå¤„äºä¸åŒåœ°ç†ä½ç½®çš„åŠå…¬å®¤ï¼Œå¹¶ä¸”éƒ½éœ€è¦ä¸€ä»½å¯å†™çš„æ•°æ®æ‹·è´ã€‚</li></ul><h2 id="ä¸»åŠ¨-è¢«åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶"><a class="markdownIt-Anchor" href="#ä¸»åŠ¨-è¢«åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶"></a> ä¸»åŠ¨-è¢«åŠ¨æ¨¡å¼ä¸‹çš„ä¸»-ä¸»å¤åˆ¶</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819140316.png" srcset="/img/loading.gif" alt="" /></p><ul><li>è¿™æ˜¯ä¸»-ä¸»ç»“æ„çš„å˜ä½“ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå…¶ä¸­çš„ä¸€å°æœåŠ¡å™¨æ˜¯åªè¯»çš„è¢«åŠ¨æœåŠ¡å™¨ã€‚</li><li>è¿™ç§æ–¹å¼ä½¿å¾—åå¤åˆ‡æ¢ä¸»åŠ¨å’Œè¢«åŠ¨æœåŠ¡å™¨éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºæœåŠ¡å™¨æ˜¯å¯¹ç§°çš„ã€‚</li><li>è¯¥ç»“æ„ç±»ä¼¼äºåˆ›å»ºä¸€ä¸ªçƒ­å¤‡ä»½ï¼Œç”¨æ¥æé«˜æ€§èƒ½ã€‚</li></ul><h2 id="æ‹¥æœ‰å¤‡åº“çš„ä¸»-ä¸»ç»“æ„"><a class="markdownIt-Anchor" href="#æ‹¥æœ‰å¤‡åº“çš„ä¸»-ä¸»ç»“æ„"></a> æ‹¥æœ‰å¤‡åº“çš„ä¸»-ä¸»ç»“æ„</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819140659.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸ºæ¯ä¸ªä¸»åº“å¢åŠ ä¸€ä¸ªå¤‡åº“ï¼Œå¢åŠ äº†å†—ä½™ï¼Œå¯¹äºä¸åŒåœ°ç†ä½ç½®çš„å¤åˆ¶æ‹“æ‰‘ï¼Œèƒ½å¤Ÿæ¶ˆé™¤å•ç‚¹å¤±æ•ˆçš„é—®é¢˜ã€‚å½“ä¸»åº“å¤±æ•ˆæ—¶ï¼Œç”¨å¤‡åº“æ¥ä»£æ›¿ä¸»åº“æ˜¯å¯è¡Œçš„ã€‚</p><h2 id="ç¯å½¢å¤åˆ¶"><a class="markdownIt-Anchor" href="#ç¯å½¢å¤åˆ¶"></a> ç¯å½¢å¤åˆ¶</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819141026.png" srcset="/img/loading.gif" alt="" /></p><ul><li><p>ç¯å½¢ç»“æ„å¯ä»¥æ‹¥æœ‰ä¸‰ä¸ªæˆ–æ›´å¤šçš„ä¸»åº“ã€‚æ¯ä¸ªæœåŠ¡å™¨éƒ½æ˜¯åœ¨å®ƒä¹‹å‰çš„æœåŠ¡å™¨çš„å¤‡åº“ï¼Œæ˜¯åœ¨å®ƒä¹‹åæœåŠ¡å™¨çš„ä¸»åº“ã€‚</p></li><li><p>ç¯å½¢ç»“æ„å®Œå…¨ä¾èµ–äºç¯ä¸Šçš„æ¯ä¸€ä¸ªç»“ç‚¹ï¼Œè¿™å¤§å¤§å¢åŠ äº†ç³»ç»Ÿå¤±æ•ˆçš„å‡ ç‡ã€‚å¦‚æœä»ç¯ä¸­ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹å‘èµ·çš„äº‹ä»¶å°±ä¼šé™·å…¥æ— é™å¾ªç¯ï¼šå®ƒä»¬å°†æ°¸è¿œç»•ç€æœåŠ¡å™¨é“¾å¾ªç¯ã€‚</p></li></ul><h2 id="ä¸»åº“-åˆ†å‘ä¸»åº“ä»¥åŠå¤‡åº“"><a class="markdownIt-Anchor" href="#ä¸»åº“-åˆ†å‘ä¸»åº“ä»¥åŠå¤‡åº“"></a> ä¸»åº“ã€åˆ†å‘ä¸»åº“ä»¥åŠå¤‡åº“</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819141525.png" srcset="/img/loading.gif" alt="" /></p><p>åˆ†å‘ä¸»åº“äº‹å®ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå¤‡åº“ï¼Œå®ƒçš„å”¯ä¸€ç›®çš„å°±æ˜¯æå–å’Œæä¾›ä¸»åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚å¤šä¸ªå¤‡åº“è¿æ¥åˆ°åˆ†å‘ä¸»åº“ï¼Œè¿™ä½¿åŸæ¥çš„ä¸»åº“æ‘†è„±äº†è´Ÿæ‹…ã€‚</p><h2 id="æ ‘æˆ–é‡‘å­—å¡”å½¢"><a class="markdownIt-Anchor" href="#æ ‘æˆ–é‡‘å­—å¡”å½¢"></a> æ ‘æˆ–é‡‘å­—å¡”å½¢</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200819142034.png" srcset="/img/loading.gif" alt="" /></p><p>å’Œåˆ†å‘ä¸»åº“ä¸€æ ·ï¼Œå‡è½»äº†ä¸»åº“çš„è´Ÿæ‹…ã€‚<br />å®ƒçš„ç¼ºç‚¹æ˜¯ä¸­é—´å±‚å‡ºç°çš„ä»»ä½•é”™è¯¯éƒ½ä¼šå½±å“åˆ°å¤šä¸ªæœåŠ¡å™¨ï¼Œä¸­é—´å±‚æ¬¡è¶Šå¤šï¼Œå¤„ç†æ•…éšœä¼šæ›´å›°éš¾ã€æ›´å¤æ‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 63. ä¸åŒè·¯å¾„ II</title>
    <link href="/2020/08/18/LeetCode-63-unique-paths-ii/"/>
    <url>/2020/08/18/LeetCode-63-unique-paths-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/unique-paths-ii/" target="_blank" rel="noopener">63. ä¸åŒè·¯å¾„ II</a></p><p>ä¸€å¼€å§‹åˆ¤æ–­ç¬¬ä¸€è¡Œæˆ–ç¬¬ä¸€åˆ—çš„éšœç¢æ—¶æ²¡æœ‰åŠæ—¶ <code>break</code>ï¼Œå¯¼è‡´è‹¥åªæœ‰ä¸€è¡Œæˆ–ä¸€åˆ—çš„æƒ…å†µä¸‹å‡ºé”™ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">uniquePathsWithObstacles</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] obstacleGrid)</span> </span>&#123;        <span class="hljs-comment">/**</span><span class="hljs-comment">         * base: è‹¥å·¦è¾¹æˆ–ä¸Šè¾¹å­˜åœ¨éšœç¢ï¼Œåˆ™ä¸èƒ½ç»§ç»­å¾€ä¸‹èµ°</span><span class="hljs-comment">         * çŠ¶æ€ï¼šdp[i][j]</span><span class="hljs-comment">         * é€‰æ‹©ï¼šå·¦ï¼Œä¸Š</span><span class="hljs-comment">         * dp[i][[j] = dp[i - 1][j] + dp[i][j - 1]</span><span class="hljs-comment">         */</span>        <span class="hljs-keyword">int</span> rows = obstacleGrid.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> cols = obstacleGrid[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows][cols];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-comment">// å¦‚æœæœ‰ä¸€ä¸ªä½ç½®æœ‰éšœç¢ï¼Œé‚£ä¹ˆè¯¥åˆ—å‰©ä¸‹çš„ä½ç½®éƒ½èµ°ä¸è¿‡å»äº†</span>            <span class="hljs-keyword">if</span> (obstacleGrid[i][<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">break</span>;            &#125;            dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cols; i++) &#123;            <span class="hljs-comment">// å¦‚æœæœ‰ä¸€ä¸ªä½ç½®æœ‰éšœç¢ï¼Œé‚£ä¹ˆè¯¥è¡Œå‰©ä¸‹çš„ä½ç½®éƒ½èµ°ä¸è¿‡å»äº†</span>            <span class="hljs-keyword">if</span> (obstacleGrid[<span class="hljs-number">0</span>][i] == <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">break</span>;            &#125;            dp[<span class="hljs-number">0</span>][i] = <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; cols; j++) &#123;                <span class="hljs-keyword">if</span> (obstacleGrid[i][j] == <span class="hljs-number">0</span>) &#123;                    dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>];                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> dp[rows - <span class="hljs-number">1</span>][cols - <span class="hljs-number">1</span>];    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 62. ä¸åŒè·¯å¾„</title>
    <link href="/2020/08/18/LeetCode-62-unique-paths/"/>
    <url>/2020/08/18/LeetCode-62-unique-paths/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/unique-paths/" target="_blank" rel="noopener">62. ä¸åŒè·¯å¾„</a></p><p>è¾¹ç•Œæ¡ä»¶ï¼šç¬¬ä¸€è¡Œ <code>dp[0][i]</code> å’Œç¬¬ä¸€åˆ— <code>dp[i][0]</code> å€¼ä¸º <code>1</code>ï¼šåªæœ‰ä¸€æ¡è·¯å¾„å¯åˆ°è¾¾è¯¥ä½ç½®ã€‚<br />çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šæ¯ä¸ªä½ç½®çš„è·¯å¾„ = å·¦è¾¹è·¯å¾„æ•° + ä¸Šè¾¹è·¯å¾„æ•°ã€‚</p><table><thead><tr><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th></tr></thead><tbody><tr><td style="text-align:center"><strong>1</strong></td><td style="text-align:center"><code>2</code></td><td style="text-align:center"><code>3</code></td><td style="text-align:center"><code>4</code></td><td style="text-align:center"><code>5</code></td><td style="text-align:center"><code>6</code></td><td style="text-align:center"><code>7</code></td></tr><tr><td style="text-align:center"><strong>1</strong></td><td style="text-align:center"><code>3</code></td><td style="text-align:center"><code>6</code></td><td style="text-align:center"><code>10</code></td><td style="text-align:center"><code>15</code></td><td style="text-align:center"><code>21</code></td><td style="text-align:center"><code>28</code></td></tr></tbody></table><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">uniquePaths</span><span class="hljs-params">(<span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span> n)</span> </span>&#123;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * base: ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—ä¸º 1</span><span class="hljs-comment">     * çŠ¶æ€ï¼šdp[i][j] æ¯ä¸ªä½ç½®è·¯å¾„æ•° = å·¦ + ä¸Š</span><span class="hljs-comment">     * é€‰æ‹©ï¼šå·¦ï¼Œä¸Š</span><span class="hljs-comment">     * dp[i][j] = dp[i - 1][j] + dp[i][j - 1]</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[m][n];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i++) &#123;        dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;        dp[<span class="hljs-number">0</span>][i] = <span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; m; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; n; j++) &#123;            dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>];        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[m - <span class="hljs-number">1</span>][n - <span class="hljs-number">1</span>];&#125;</code></pre><p>ä¼˜åŒ–ï¼š</p><table><thead><tr><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th><th style="text-align:center">1</th></tr></thead><tbody></tbody></table><table><thead><tr><th style="text-align:center">1</th><th style="text-align:center"><code>2</code></th><th style="text-align:center"><code>3</code></th><th style="text-align:center"><code>4</code></th><th style="text-align:center"><code>5</code></th><th style="text-align:center"><code>6</code></th><th style="text-align:center"><code>7</code></th></tr></thead><tbody></tbody></table><p>çœå»åˆ—ä¸Šçš„ç©ºé—´ï¼š<code>dp[j] = dp[j] + dp[j - 1]</code><br /><code>dp[j]</code> åœ¨æ›´æ–°å‰ç›¸å½“äºä¸Šè¾¹çš„å€¼<br /><code>dp[j - 1]</code> åœ¨æ›´æ–° <code>dp[j]</code> æ—¶ï¼Œå·²ç»æ›´æ–°äº† <code>dp[j - 1]</code> ï¼Œæ‰€ä»¥å®ƒç›¸å½“äºå·¦è¾¹çš„å€¼ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">uniquePaths</span><span class="hljs-params">(<span class="hljs-keyword">int</span> m, <span class="hljs-keyword">int</span> n)</span> </span>&#123;     <span class="hljs-keyword">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[n];     Arrays.fill(dp, <span class="hljs-number">1</span>);     <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; m; i++) &#123;         <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt; n; j++) &#123;             dp[j] += dp[j - <span class="hljs-number">1</span>];         &#125;     &#125;     <span class="hljs-keyword">return</span> dp[n - <span class="hljs-number">1</span>]; &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL å¤‡ä»½ä¸æ¢å¤</title>
    <link href="/2020/08/18/MySQL-backup-recovery/"/>
    <url>/2020/08/18/MySQL-backup-recovery/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h1><p>æ ¹æ®å¤‡ä»½æ–¹æ³•ï¼š</p><ul><li><strong>çƒ­å¤‡</strong>ï¼ˆ<code>Hot Backup</code>ï¼‰ï¼šè¿è¡Œçš„æ•°æ®åº“ä¸­å¤‡ä»½ï¼Œå¯¹æ•°æ®åº“æ“ä½œæ²¡æœ‰å½±å“</li><li><strong>å†·å¤‡</strong>ï¼ˆ<code>Cold Backup</code>ï¼‰ï¼šæ•°æ®åº“åœæ­¢çš„æƒ…å†µä¸‹ï¼Œå¤åˆ¶ç‰©ç†æ–‡ä»¶</li><li><strong>æ¸©å¤‡</strong>ï¼ˆ<code>Warm Backup</code>ï¼‰ï¼šè¿è¡Œçš„æ•°æ®åº“ï¼Œä½†å¯¹æ•°æ®åº“æ“ä½œæœ‰å½±å“ï¼Œå¦‚åŠ ä¸€ä¸ªå…¨å±€è¯»é”ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚</li></ul><p>æ ¹æ®å¤‡ä»½åæ–‡ä»¶çš„å†…å®¹ï¼š</p><ul><li><strong>é€»è¾‘å¤‡ä»½</strong>ï¼šå†…å®¹ä¸€èˆ¬æ˜¯ä¸€æ¡æ¡ <code>SQL</code> è¯­å¥ï¼Œæ¢å¤æ—¶é—´é•¿</li><li><strong>è£¸æ–‡ä»¶å¤‡ä»½</strong>ï¼šå¤åˆ¶æ•°æ®åº“çš„ç‰©ç†æ–‡ä»¶ï¼Œæ¢å¤æ—¶é—´çŸ­</li></ul><p>æ ¹æ®å¤‡ä»½æ•°æ®åº“çš„å†…å®¹ï¼š</p><ul><li><strong>å®Œå…¨å¤‡ä»½</strong>ï¼šå¯¹æ•°æ®åº“è¿›è¡Œä¸€ä¸ªå®Œæ•´çš„å¤‡ä»½ã€‚</li><li><strong>å¢é‡å¤‡ä»½</strong>ï¼šåœ¨ä¸Šæ¬¡å®Œå…¨å¤‡ä»½çš„åŸºç¡€ä¸Šï¼Œå¯¹äºæ›´æ”¹çš„æ•°æ®è¿›è¡Œå¤‡ä»½ã€‚</li><li><strong>æ—¥å¿—å¤‡ä»½</strong>ï¼šå¯¹äºŒè¿›åˆ¶æ—¥å¿—çš„å¤‡ä»½ï¼Œé€šè¿‡å¯¹äºŒè¿›åˆ¶æ—¥å¿—çš„é‡åšå®Œæˆæ¢å¤ã€‚</li></ul><h1 id="å†·å¤‡"><a class="markdownIt-Anchor" href="#å†·å¤‡"></a> å†·å¤‡</h1><p>åªéœ€è¦å¤‡ä»½ <code>MySQL</code> æ•°æ®åº“çš„ <code>frm</code> æ–‡ä»¶ï¼Œå…±äº«è¡¨ç©ºé—´æ–‡ä»¶ï¼Œç‹¬ç«‹è¡¨ç©ºé—´ï¼ˆ<code>*.ibd</code>ï¼‰æ–‡ä»¶ï¼Œé‡åšæ—¥å¿—æ–‡ä»¶ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¤‡ä»½ç®€å•ï¼Œåªè¦å¤åˆ¶ç›¸å…³æ–‡ä»¶å³å¯</li><li>å¤‡ä»½æ–‡ä»¶æ˜“äºåœ¨ä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒ <code>MySQL</code> ç‰ˆæœ¬ä¸Šæ¢å¤</li><li>æ¢å¤ç®€å•ï¼Œåªè¦æŠŠæ–‡ä»¶æ¢å¤åˆ°æŒ‡å®šä½ç½®å³å¯</li><li>æ¢å¤é€Ÿåº¦å¿«ï¼Œä¸éœ€è¦æ‰§è¡Œä»»ä½• <code>SQL</code> è¯­å¥ï¼Œä¹Ÿä¸éœ€è¦é‡å»ºç´¢å¼•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å†·å¤‡çš„æ–‡ä»¶é€šå¸¸æ¯”é€»è¾‘æ–‡ä»¶å¤§å¾ˆå¤šï¼Œå› ä¸ºè¡¨ç©ºé—´ä¸­å­˜æ”¾ç€å¾ˆå¤šå…¶ä»–çš„æ•°æ®ï¼Œå¦‚ <code>undo</code> æ®µï¼Œæ’å…¥ç¼“å†²ç­‰ä¿¡æ¯ã€‚</li><li>å†·å¤‡ä¸æ€»æ˜¯å¯ä»¥è½»æ˜“åœ°è·¨å¹³å°ã€‚æ“ä½œç³»ç»Ÿã€<code>MySQL</code> çš„ç‰ˆæœ¬ã€æ–‡ä»¶å¤§å°å†™æ•æ„Ÿå’Œæµ®ç‚¹æ•°æ ¼å¼éƒ½ä¼šæˆä¸ºé—®é¢˜ã€‚</li></ul><h1 id="çƒ­å¤‡"><a class="markdownIt-Anchor" href="#çƒ­å¤‡"></a> çƒ­å¤‡</h1><h2 id="ibbackup"><a class="markdownIt-Anchor" href="#ibbackup"></a> <code>ibbackup</code></h2><p><code>ibbackup</code> å¯ä»¥åŒæ—¶å¤‡ä»½ <code>MyISAM</code> å’Œ <code>InnoDB</code> å­˜å‚¨å¼•æ“è¡¨ã€‚å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ol><li>è®°å½•å¤‡ä»½å¼€å§‹æ—¶ï¼Œé‡åšæ—¥å¿—æ–‡ä»¶æ£€æŸ¥ç‚¹çš„ <code>LSN</code>ã€‚</li><li>å¤åˆ¶å…±äº«è¡¨ç©ºé—´æ–‡ä»¶åŠç‹¬ç«‹è¡¨ç©ºé—´æ–‡ä»¶ã€‚</li><li>è®°å½•å¤åˆ¶å®Œè¡¨ç©ºé—´æ–‡ä»¶åï¼Œé‡åšæ—¥å¿—æ–‡ä»¶æ£€æŸ¥ç‚¹çš„ <code>LSN</code>ã€‚</li><li>å¤åˆ¶åœ¨å¤‡ä»½æ—¶äº§ç”Ÿçš„é‡åšæ—¥å¿—ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ul><li>åœ¨çº¿å¤‡ä»½ï¼Œä¸é˜»å¡ä»»ä½•çš„ <code>SQL</code> è¯­å¥ã€‚</li><li>å¤‡ä»½æ€§èƒ½å¥½ï¼Œ<strong>å¤‡ä»½çš„å®è´¨æ˜¯å¤åˆ¶æ•°æ®åº“æ–‡ä»¶å’Œé‡åšæ—¥å¿—æ–‡ä»¶</strong>ã€‚</li><li>æ”¯æŒå‹ç¼©å¤‡ä»½ï¼Œé€šè¿‡é€‰é¡¹ï¼Œå¯ä»¥æ”¯æŒä¸åŒçº§åˆ«çš„å‹ç¼©ã€‚</li><li>è·¨å¹³å°æ”¯æŒã€‚</li></ul><p>æ¢å¤æ­¥éª¤ï¼š</p><ul><li>æ¢å¤è¡¨ç©ºé—´æ–‡ä»¶ã€‚</li><li>åº”ç”¨é‡åšæ—¥å¿—æ–‡ä»¶ã€‚</li></ul><h2 id="xtrabackup"><a class="markdownIt-Anchor" href="#xtrabackup"></a> <code>XtraBackup</code></h2><p><code>XtraBackup</code> æ˜¯ä¸€æ¬¾å¼€æºå…è´¹çš„çƒ­å¤‡å·¥å…·ï¼Œå®ƒå®ç°äº† <code>ibbackup</code> çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶ä¸”æ”¯æŒäº†çœŸæ­£çš„å¢é‡å¤‡ä»½åŠŸèƒ½ï¼Œæ˜¯çƒ­å¤‡çš„æ›´å¥½é€‰æ‹©ã€‚</p><p>å·¥ä½œåŸç†ï¼š</p><ol><li>é¦–å…ˆå®Œæˆä¸€ä¸ªå…¨å¤‡ï¼Œå¹¶è®°å½•ä¸‹æ­¤æ—¶æ£€æŸ¥ç‚¹çš„ <code>LSN</code>ã€‚</li><li>åœ¨è¿›è¡Œå¢é‡å¤‡ä»½æ—¶ï¼Œæ¯”è¾ƒè¡¨ç©ºé—´ä¸­æ¯ä¸ªé¡µçš„ <code>LSN</code> æ˜¯å¦å¤§äºä¸Šæ¬¡å¤‡ä»½æ—¶çš„ <code>LSN</code>ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å¤‡ä»½è¯¥é¡µï¼ŒåŒæ—¶è®°å½•å½“å‰æ£€æŸ¥ç‚¹çš„ <code>LSN</code>ã€‚</li></ol><h1 id="é€»è¾‘å¤‡ä»½"><a class="markdownIt-Anchor" href="#é€»è¾‘å¤‡ä»½"></a> é€»è¾‘å¤‡ä»½</h1><h2 id="å¤‡ä»½æ–¹å¼"><a class="markdownIt-Anchor" href="#å¤‡ä»½æ–¹å¼"></a> å¤‡ä»½æ–¹å¼</h2><h3 id="mysqldump"><a class="markdownIt-Anchor" href="#mysqldump"></a> <code>mysqldump</code></h3><p><code>mysqldump</code> é€šå¸¸ç”¨æ¥å®Œæˆè½¬å­˜ï¼ˆ<code>dump</code>ï¼‰æ•°æ®åº“çš„å¤‡ä»½åŠä¸åŒæ•°æ®åº“ä¹‹é—´çš„ç§»æ¤ã€‚</p><h3 id="selectinto-outfile"><a class="markdownIt-Anchor" href="#selectinto-outfile"></a> <code>SELECT...INTO OUTFILE</code></h3><p><code>SELECT...INTO OUTFILE</code> å¯ä»¥å¯¼å‡ºä¸€å¼ è¡¨ä¸­çš„æ•°æ®ã€‚</p><h2 id="é€»è¾‘å¤‡ä»½çš„æ¢å¤"><a class="markdownIt-Anchor" href="#é€»è¾‘å¤‡ä»½çš„æ¢å¤"></a> é€»è¾‘å¤‡ä»½çš„æ¢å¤</h2><h3 id="mysqldump-2"><a class="markdownIt-Anchor" href="#mysqldump-2"></a> <code>mysqldump</code></h3><p><code>mysqldump</code> çš„æ¢å¤æ“ä½œæ¯”è¾ƒç®€å•ï¼Œå› ä¸ºå¤‡ä»½çš„æ–‡ä»¶å°±æ˜¯å¯¼å‡ºçš„ <code>SQL</code> è¯­å¥ï¼Œä¸€èˆ¬åªéœ€è¦æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p><p><code>mysqldump</code> <strong>ä¸èƒ½å¯¼å‡ºè§†å›¾</strong>ï¼Œå› æ­¤è‹¥æ•°æ®åº“ä¸­ä½¿ç”¨äº†è§†å›¾ï¼Œè¿˜éœ€è¦å¯¼å‡ºè§†å›¾çš„å®šä¹‰ï¼Œæˆ–è€…å¤‡ä»½è§†å›¾å®šä¹‰çš„ <code>frm</code> æ–‡ä»¶ï¼Œå¹¶åœ¨æ¢å¤æ—¶è¿›è¡Œå¯¼å…¥ã€‚</p><h3 id="load-data-infile"><a class="markdownIt-Anchor" href="#load-data-infile"></a> <code>LOAD DATA INFILE</code></h3><p>è‹¥é€šè¿‡ <code>mysqldump-tab</code>ï¼Œæˆ–è€…é€šè¿‡ <code>SELECT...INTO OUTFILE</code> å¯¼å‡ºçš„æ•°æ®éœ€è¦æ¢å¤ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ <code>LOAD DATA INFILE</code> æ¥è¿›è¡Œå¯¼å…¥ã€‚</p><h3 id="mysqlimport"><a class="markdownIt-Anchor" href="#mysqlimport"></a> <code>mysqlimport</code></h3><p><code>mysqlimport</code> æ˜¯ <code>LOAD DATA INFILE</code> çš„å‘½ä»¤æ¥å£ï¼Œè€Œä¸”å¤§å¤šæ•°é€‰é¡¹éƒ½å’Œ <code>LOAD DATA INFILE</code> è¯­æ³•ç›¸åŒã€‚</p><p>å’Œ <code>LOAD DATA INFILE</code> ä¸åŒçš„æ˜¯ï¼Œ<code>mysqlimport</code> å¯ä»¥ç”¨æ¥å¯¼å…¥<strong>å¤šå¼ è¡¨</strong>ï¼Œæˆ–è€…<strong>å¹¶å‘åœ°å¯¼å…¥å¤šä¸ªæ–‡ä»¶</strong>ã€‚</p><h1 id="äºŒè¿›åˆ¶æ—¥å¿—å¤‡ä»½ä¸æ¢å¤"><a class="markdownIt-Anchor" href="#äºŒè¿›åˆ¶æ—¥å¿—å¤‡ä»½ä¸æ¢å¤"></a> äºŒè¿›åˆ¶æ—¥å¿—å¤‡ä»½ä¸æ¢å¤</h1><p>åœ¨é»˜è®¤æƒ…å†µä¸‹å¹¶ä¸å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå¯ç”¨å®ƒéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼š</p><pre><code class="hljs ini"><span class="hljs-section">[mysqld]</span><span class="hljs-attr">log-bin</span>=mysql-bin</code></pre><p>é€šè¿‡ <code>mysqlbinlog</code> å¯æ¢å¤äºŒè¿›åˆ¶æ—¥å¿—ã€‚<br />å¦‚æœéœ€è¦æ¢å¤å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å…ˆé€šè¿‡ <code>mysqlbinlog</code> å‘½ä»¤å¯¼å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡ <code>SOURCE</code> å‘½ä»¤æ¥å¯¼å…¥ã€‚</p><h1 id="å¿«ç…§å¤‡ä»½"><a class="markdownIt-Anchor" href="#å¿«ç…§å¤‡ä»½"></a> å¿«ç…§å¤‡ä»½</h1><p><code>MySQL</code> æ•°æ®åº“æœ¬èº«å¹¶ä¸æ”¯æŒå¿«ç…§åŠŸèƒ½ï¼Œå› æ­¤å¿«ç…§å¤‡ä»½æ˜¯æŒ‡é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ”¯æŒçš„å¿«ç…§åŠŸèƒ½å¯¹æ•°æ®åº“è¿›è¡Œå¤‡ä»½ã€‚</p><ul><li>å¤‡ä»½çš„å‰ææ˜¯å°†æ‰€æœ‰æ•°æ®åº“æ–‡ä»¶æ”¾åœ¨åŒä¸€æ–‡ä»¶åˆ†åŒºä¸­ï¼Œç„¶åå¯¹è¯¥åˆ†åŒºè¿›è¡Œå¿«ç…§æ“ä½œã€‚</li><li>æ”¯æŒå¿«ç…§åŠŸèƒ½çš„æ–‡ä»¶ç³»ç»Ÿå’Œè®¾å¤‡åŒ…æ‹¬ <code>FreeBSD</code> çš„ <code>UFS</code>ï¼Œ<code>Solaris</code> çš„ <code>ZFS</code>ï¼Œ<code>GNU/Linux</code> çš„é€»è¾‘ç®¡ç†å™¨ï¼ˆ<code>Logical Volume Manager, LVM</code>ï¼‰ç­‰ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL äº‹åŠ¡</title>
    <link href="/2020/08/17/MySQL-transaction/"/>
    <url>/2020/08/17/MySQL-transaction/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a class="markdownIt-Anchor" href="#ä»‹ç»"></a> ä»‹ç»</h1><h2 id="å®šä¹‰"><a class="markdownIt-Anchor" href="#å®šä¹‰"></a> å®šä¹‰</h2><blockquote><p>äº‹åŠ¡æ˜¯è®¿é—®å¹¶æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒã€‚<br />åœ¨äº‹åŠ¡ä¸­çš„æ“ä½œï¼Œè¦ä¹ˆéƒ½ä¸åšï¼Œè¦ä¹ˆéƒ½åšä¿®æ”¹ï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„ç›®çš„ï¼Œä¹Ÿæ˜¯äº‹åŠ¡æ¨¡å‹åŒºåˆ«äºæ–‡ä»¶ç³»ç»Ÿçš„é‡è¦ç‰¹å¾ä¹‹ä¸€ã€‚</p></blockquote><ul><li>äº‹åŠ¡å°±æ˜¯ä¸€ç»„åŸå­æ€§çš„ <code>SQL</code> è¯­å¥ã€‚å…·ä½“æ¥è¯´ï¼Œäº‹åŠ¡æŒ‡çš„æ˜¯æ»¡è¶³ <code>ACID</code> ç‰¹æ€§çš„ä¸€ç»„æ“ä½œã€‚</li><li>é€šè¿‡ <code>COMMIT</code> æäº¤ä¸€ä¸ªäº‹åŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>ROLLBACK</code> è¿›è¡Œå›æ»šã€‚</li><li>äº‹åŠ¡å†…çš„ <code>SQL</code> è¯­å¥ï¼Œè¦ä¹ˆå…¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨æ‰§è¡Œå¤±è´¥ã€‚</li><li>é€šè¿‡åŠ é”çš„æ–¹å¼ï¼Œå¯ä»¥å®ç°ä¸åŒçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶ã€‚</li></ul><h2 id="acid-ç‰¹æ€§"><a class="markdownIt-Anchor" href="#acid-ç‰¹æ€§"></a> <code>ACID</code> ç‰¹æ€§</h2><ul><li><p><strong>åŸå­æ€§ (<code>Atomicity</code>)</strong>ï¼šåŸå­æ€§æ˜¯æŒ‡æ•´ä¸ªæ•°æ®åº“äº‹åŠ¡æ˜¯ä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚<br />äº‹åŠ¡çš„æ‰€æœ‰æ“ä½œå¤Ÿæ‰§è¡ŒæˆåŠŸï¼Œæ•´ä¸ªäº‹åŠ¡æ‰ç®—æˆåŠŸã€‚<br />äº‹åŠ¡çš„ä»»ä½•ä¸€ä¸ª <code>SQL</code> è¯­å¥æ‰§è¡Œå¤±è´¥ï¼Œæ•°æ®åº“çŠ¶æ€åº”è¯¥é€€å›åˆ°æ‰§è¡Œäº‹åŠ¡å‰çš„çŠ¶æ€ã€‚</p></li><li><p><strong>ä¸€è‡´æ€§ (<code>Consistency</code>)</strong>ï¼šä¸€è‡´æ€§æŒ‡äº‹åŠ¡å°†æ•°æ®åº“ä»ä¸€ç§çŠ¶æ€è½¬å˜ä¸ºä¸‹ä¸€ç§ä¸€è‡´çš„çŠ¶æ€ã€‚åœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œç»“æŸä¹‹åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚</p></li><li><p><strong>éš”ç¦»æ€§ (<code>Isolation</code>)</strong>ï¼šæ¯ä¸ªè¯»å†™äº‹åŠ¡çš„å¯¹è±¡å¯¹å…¶ä»–äº‹åŠ¡çš„æ“ä½œå¯¹è±¡èƒ½ç›¸äº’åˆ†ç¦»ï¼Œå³è¯¥äº‹åŠ¡æäº¤å‰å¯¹å…¶ä»–äº‹åŠ¡éƒ½ä¸å¯è§ï¼Œé€šå¸¸ä½¿ç”¨é”æ¥å®ç°ã€‚</p></li><li><p><strong>æŒä¹…æ€§ (<code>Durability</code>)</strong>ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå…¶ç»“æœå°±æ˜¯æ°¸ä¹…æ€§çš„ã€‚å³ä½¿å‘ç”Ÿå®•æœºç­‰æ•…éšœï¼Œæ•°æ®åº“ä¹Ÿèƒ½å°†æ•°æ®æ¢å¤ã€‚</p></li></ul><h2 id="åˆ†ç±»"><a class="markdownIt-Anchor" href="#åˆ†ç±»"></a> åˆ†ç±»</h2><h3 id="æ‰å¹³äº‹åŠ¡"><a class="markdownIt-Anchor" href="#æ‰å¹³äº‹åŠ¡"></a> æ‰å¹³äº‹åŠ¡</h3><p>æ‰å¹³äº‹åŠ¡ä¸­ï¼Œæ‰€æœ‰æ“ä½œéƒ½å¤„äºåŒä¸€å±‚æ¬¡ï¼Œç”± <code>BEGIN WORK</code> å¼€å§‹ï¼Œç”± <code>COMMIT WORK</code> æˆ– <code>ROLLBACK WORK</code> ç»“æŸï¼Œå…¶é—´çš„æ“ä½œæ˜¯åŸå­çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200817194044.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰å¹³äº‹åŠ¡çš„ä¸»è¦é™åˆ¶æ˜¯<strong>ä¸èƒ½æäº¤æˆ–è€…å›æ»šäº‹åŠ¡çš„æŸä¸€éƒ¨åˆ†</strong>ã€‚</p><p><strong>å¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡</strong>ï¼š<br />å…è®¸åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å›æ»šåˆ°åŒä¸€äº‹åŠ¡ä¸­è¾ƒæ—©çš„ä¸€ä¸ªçŠ¶æ€ã€‚<br />ä¿å­˜ç‚¹ï¼ˆ<code>Savepoint</code>ï¼‰ç”¨æ¥é€šçŸ¥ç³»ç»Ÿåº”è¯¥è®°ä½äº‹åŠ¡å½“å‰çš„çŠ¶æ€ï¼Œä»¥ä¾¿å½“ä¹‹åå‘ç”Ÿé”™è¯¯æ—¶ï¼Œäº‹åŠ¡èƒ½å›åˆ°ä¿å­˜ç‚¹å½“æ—¶çš„çŠ¶æ€ã€‚</p><h3 id="é“¾äº‹åŠ¡"><a class="markdownIt-Anchor" href="#é“¾äº‹åŠ¡"></a> é“¾äº‹åŠ¡</h3><p>å¯è§†ä¸ºä¿å­˜ç‚¹æ¨¡å¼çš„ä¸€ç§å˜ç§ã€‚å¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡ï¼Œå½“å‘ç”Ÿç³»ç»Ÿå´©æºƒæ—¶ï¼Œæ‰€æœ‰çš„ä¿å­˜ç‚¹éƒ½å°†æ¶ˆå¤±ï¼Œå› ä¸ºå…¶ä¿å­˜ç‚¹æ˜¯æ˜“å¤±çš„ï¼ˆ<code>volatile</code>ï¼‰ï¼Œè€ŒéæŒä¹…çš„ï¼ˆ<code>persistent</code>ï¼‰ã€‚å½“æ¢å¤æ—¶ï¼Œäº‹åŠ¡è¦ä»å¼€å§‹å¤„é‡æ–°æ‰§è¡Œï¼Œè€Œä¸èƒ½ä»æœ€è¿‘çš„ä¸€ä¸ªä¿å­˜ç‚¹ç»§ç»­æ‰§è¡Œã€‚</p><p>é“¾äº‹åŠ¡ï¼šå½“æäº¤ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œé‡Šæ”¾ä¸éœ€è¦çš„æ•°æ®å¯¹è±¡ï¼Œå°†å¿…è¦çš„å¤„ç†ä¸Šä¸‹æ–‡éšå¼åœ°ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¦å¼€å§‹çš„äº‹åŠ¡ã€‚</p><ul><li>é“¾äº‹åŠ¡åªèƒ½æ¢å¤åˆ°<strong>æœ€è¿‘</strong>çš„ä¸€ä¸ªä¿å­˜ç‚¹ï¼Œè€Œå¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡èƒ½å›æ»šåˆ°<strong>ä»»æ„æ­£ç¡®çš„æ—¶é—´ç‚¹</strong>ã€‚</li><li>é“¾äº‹åŠ¡åœ¨æ‰§è¡Œ <code>COMMIT</code> åå³é‡Šæ”¾äº†å½“å‰äº‹åŠ¡æ‰€æŒæœ‰çš„é”ï¼Œè€Œå¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡ä¸å½±å“æ‰€æŒæœ‰çš„é”ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200817195151.png" srcset="/img/loading.gif" alt="" /></p><h3 id="åµŒå¥—äº‹åŠ¡"><a class="markdownIt-Anchor" href="#åµŒå¥—äº‹åŠ¡"></a> åµŒå¥—äº‹åŠ¡</h3><p>åµŒå¥—äº‹åŠ¡æ˜¯ä¸€ä¸ªå±‚æ¬¡ç»“æ„æ¡†æ¶ã€‚ç”±ä¸€ä¸ªé¡¶å±‚äº‹åŠ¡æ§åˆ¶ç€å„ä¸ªå±‚æ¬¡çš„äº‹åŠ¡ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200817195457.png" srcset="/img/loading.gif" alt="" /></p><h3 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼äº‹åŠ¡"></a> åˆ†å¸ƒå¼äº‹åŠ¡</h3><p>åˆ†å¸ƒå¼äº‹åŠ¡é€šå¸¸æ˜¯ä¸€ä¸ªåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¿è¡Œçš„æ‰å¹³äº‹åŠ¡ï¼Œéœ€è¦æ ¹æ®æ•°æ®æ‰€åœ¨ä½ç½®è®¿é—®ç½‘ç»œä¸­çš„ä¸åŒèŠ‚ç‚¹ï¼Œå®ƒä¹Ÿéœ€è¦æ»¡è¶³ <code>ACID</code> ç‰¹æ€§ã€‚</p><h1 id="acid-å®ç°"><a class="markdownIt-Anchor" href="#acid-å®ç°"></a> <code>ACID</code> å®ç°</h1><ul><li>äº‹åŠ¡çš„éš”ç¦»æ€§é€šè¿‡é”å®ç°ã€‚</li><li>åŸå­æ€§ã€ä¸€è‡´æ€§ã€æŒä¹…æ€§é€šè¿‡ <code>redo log</code> å’Œ <code>undo log</code> æ¥å®Œæˆã€‚<ul><li><code>redo log</code> ç”¨æ¥ä¿è¯åŸå­æ€§å’ŒæŒä¹…æ€§ï¼›</li><li><code>undo log</code> ç”¨æ¥ä¿è¯ä¸€è‡´æ€§ã€‚</li></ul></li></ul><p><code>redo</code> å’Œ <code>undo</code> çš„åŒºåˆ«ï¼š</p><ul><li><code>redo</code> æ¢å¤æäº¤äº‹åŠ¡ä¿®æ”¹çš„é¡µæ“ä½œï¼Œæ˜¯<strong>ç‰©ç†æ—¥å¿—</strong>ï¼Œè®°å½•çš„æ˜¯<strong>é¡µçš„ç‰©ç†ä¿®æ”¹</strong>æ“ä½œã€‚</li><li><code>undo</code> å›æ»šè¡Œè®°å½•åˆ°æŸä¸ªç‰¹å®šç‰ˆæœ¬ï¼Œæ˜¯<strong>é€»è¾‘æ—¥å¿—</strong>ï¼Œæ ¹æ®<strong>æ¯è¡Œè®°å½•</strong>è¿›è¡Œè®°å½•ã€‚</li></ul><h2 id="redo"><a class="markdownIt-Anchor" href="#redo"></a> <code>redo</code></h2><h3 id="æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ"></a> æ¦‚å¿µ</h3><p>é‡åšæ—¥å¿—ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p><ol><li>é‡åšæ—¥å¿—ç¼“å†²ï¼ˆ<code>redo log buffer</code>ï¼‰ï¼Œå…¶æ˜¯æ˜“å¤±çš„</li><li>é‡åšæ—¥å¿—æ–‡ä»¶ï¼ˆ<code>redo log file</code>ï¼‰ï¼Œå…¶æ˜¯æŒä¹…çš„</li></ol><p>å½“äº‹åŠ¡æäº¤æ—¶ï¼Œå¿…é¡»å…ˆå°†è¯¥äº‹åŠ¡çš„æ‰€æœ‰æ—¥å¿—å†™å…¥åˆ°é‡åšæ—¥å¿—æ–‡ä»¶è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¾…äº‹åŠ¡çš„ <code>COMMIT</code> æ“ä½œå®Œæˆæ‰ç®—å®Œæˆã€‚<br />ä¸ºäº†ç¡®ä¿æ¯æ¬¡æ—¥å¿—éƒ½å†™å…¥é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œåœ¨æ¯æ¬¡å°†é‡åšæ—¥å¿—ç¼“å†²å†™å…¥é‡åšæ—¥å¿—æ–‡ä»¶åï¼Œ<code>InnoDB</code> éƒ½éœ€è¦è°ƒç”¨ä¸€æ¬¡ <code>fsync</code> æ“ä½œã€‚</p><h3 id="log-block"><a class="markdownIt-Anchor" href="#log-block"></a> <code>log block</code></h3><p>é‡åšæ—¥å¿—éƒ½æ˜¯ä»¥ <code>512</code> å­—èŠ‚è¿›è¡Œå­˜å‚¨çš„ï¼Œè¿™æ„å‘³ç€é‡åšæ—¥å¿—ç¼“å­˜ã€é‡åšæ—¥å¿—æ–‡ä»¶éƒ½æ˜¯ä»¥å—ï¼ˆ<code>block</code>ï¼‰çš„æ–¹å¼ä¿å­˜çš„ï¼Œç§°ä¹‹ä¸ºé‡åšæ—¥å¿—å—ï¼ˆ<code>redo log block</code>ï¼‰ã€‚</p><p>ç”±äºé‡åšæ—¥å¿—å—çš„å¤§å°å’Œç£ç›˜æ‰‡åŒºå¤§å°ä¸€æ ·ï¼Œå› æ­¤é‡åšæ—¥å¿—çš„å†™å…¥å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œä¸éœ€è¦ <code>doublewrite</code> æŠ€æœ¯ã€‚</p><h3 id="log-group"><a class="markdownIt-Anchor" href="#log-group"></a> <code>log group</code></h3><p><code>log group</code> ä¸ºé‡åšæ—¥å¿—ç»„ï¼Œå…¶ä¸­æœ‰å¤šä¸ªé‡åšæ—¥å¿—æ–‡ä»¶ï¼Œ<code>InnoDB</code> å®é™…åªæœ‰ä¸€ä¸ª <code>log group</code>ã€‚<br /><code>log group</code> æ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„æ¦‚å¿µï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªå®é™…çš„ç‰©ç†æ–‡ä»¶æ¥è¡¨ç¤º <code>log group</code> ä¿¡æ¯ã€‚</p><h2 id="undo"><a class="markdownIt-Anchor" href="#undo"></a> <code>undo</code></h2><h3 id="æ¦‚å¿µ-2"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ-2"></a> æ¦‚å¿µ</h3><ul><li><code>undo</code> æ˜¯é€»è¾‘æ—¥å¿—ï¼Œåªæ˜¯é€šè¿‡<strong>å›æ»š</strong>æ“ä½œå°†æ•°æ®åº“é€»è¾‘åœ°æ¢å¤åˆ°åŸæ¥çš„æ ·å­ï¼Œæ•°æ®ç»“æ„å’Œé¡µæœ¬èº«åœ¨å›æ»šä¹‹åå¯èƒ½å¤§ä¸ç›¸åŒï¼Œè¿™æ˜¯å› ä¸ºåœ¨å¹¶å‘ç³»ç»Ÿä¸­ï¼Œä¸èƒ½å°†é¡µå›æ»šåˆ°äº‹åŠ¡å¼€å§‹æ—¶çš„æ ·å­ï¼Œå¦åˆ™ä¼šå½±å“å…¶ä»–äº‹åŠ¡æ­£åœ¨è¿›è¡Œçš„å·¥ä½œã€‚</li><li><code>undo</code> çš„å¦ä¸€ä¸ªä½œç”¨æ˜¯ <strong><code>MVCC</code></strong>ï¼Œ<code>MVCC</code> çš„å®ç°æ˜¯é€šè¿‡ <code>undo</code> æ¥å®Œæˆã€‚å½“ç”¨æˆ·è¯»å–ä¸€è¡Œæ—¶ï¼Œè‹¥è¯¥è¡Œå·²è¢«å…¶ä»–äº‹åŠ¡å ç”¨ï¼Œå½“å‰äº‹åŠ¡å¯ä»¥é€šè¿‡ <code>undo</code> è¯»å–ä¹‹å‰çš„è¡Œç‰ˆæœ¬ä¿¡æ¯ï¼Œå®ç°éé”å®šè¯»å–ã€‚</li><li><code>undo log</code> ä¼šäº§ç”Ÿ <code>redo log</code>ï¼Œè¿™æ˜¯å› ä¸º <code>undo log</code> ä¹Ÿéœ€è¦æŒä¹…æ€§çš„ä¿æŠ¤ã€‚</li></ul><h3 id="undo-log-æ ¼å¼"><a class="markdownIt-Anchor" href="#undo-log-æ ¼å¼"></a> <code>undo log</code> æ ¼å¼</h3><p><code>undo log</code> åˆ†ä¸ºï¼š</p><ol><li><code>insert undo log</code></li><li><code>update undo log</code></li></ol><ul><li><p><code>insert undo log</code> æ˜¯æŒ‡åœ¨ <code>insert</code> æ“ä½œä¸­äº§ç”Ÿçš„ <code>undo log</code>ï¼Œå› ä¸º insert æ“ä½œçš„è®°å½•ï¼Œåªå¯¹äº‹åŠ¡æœ¬èº«å¯è§ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¸å¯è§ï¼Œæ•…è¯¥ <code>undo log</code> å¯ä»¥åœ¨äº‹åŠ¡æäº¤ååˆ é™¤ã€‚</p></li><li><p><code>update undo log</code> è®°å½•çš„æ˜¯å¯¹ <code>delete</code> å’Œ <code>update</code> æ“ä½œäº§ç”Ÿçš„ <code>undo log</code>ï¼Œè¯¥ <code>undo log</code> å¯èƒ½éœ€è¦æä¾› <code>MVCC</code> æœºåˆ¶ï¼Œå› æ­¤ä¸èƒ½åœ¨äº‹åŠ¡æäº¤æ—¶å°±è¿›è¡Œåˆ é™¤ã€‚æäº¤æ—¶æ”¾å…¥ <code>undo log</code> é“¾è¡¨ï¼Œç­‰å¾… <code>purge</code> çº¿ç¨‹è¿›è¡Œæœ€åçš„åˆ é™¤ã€‚</p></li></ul><h1 id="äº‹åŠ¡æ§åˆ¶è¯­å¥"><a class="markdownIt-Anchor" href="#äº‹åŠ¡æ§åˆ¶è¯­å¥"></a> äº‹åŠ¡æ§åˆ¶è¯­å¥</h1><ul><li><code>START TRANSACTION | BEGIN</code>: æ˜¾å¼åœ°å¼€å¯ä¸€ä¸ªäº‹åŠ¡ã€‚</li><li><code>COMMIT</code>: æäº¤äº‹åŠ¡ã€‚</li><li><code>ROLLBACK</code>: ç»“æŸç”¨æˆ·çš„äº‹åŠ¡ï¼Œæ’¤é”€æ­£åœ¨è¿›è¡Œçš„æ‰€æœ‰æœªæäº¤çš„äº‹åŠ¡ã€‚</li><li><code>SAVEPOINT identifier</code>: åˆ›å»ºä¸€ä¸ªä¿å­˜ç‚¹ã€‚</li><li><code>RELEASE SAVEPOINT identifier</code>: åˆ é™¤ä¸€ä¸ªäº‹åŠ¡çš„ä¿å­˜ç‚¹ã€‚</li><li><code>ROLLBACK TO [SAVEPOINT] identifier</code>: æŠŠäº‹åŠ¡å›æ»šåˆ°æ ‡è®°ç‚¹ï¼Œè€Œä¸å›æ»šåœ¨æ­¤æ ‡è®°ç‚¹ä¹‹å‰çš„ä»»ä½•å·¥ä½œã€‚</li><li><code>SET TRANSACTION</code>: è®¾ç½®éš”ç¦»çº§åˆ«ã€‚</li></ul><h1 id="éšå¼æäº¤"><a class="markdownIt-Anchor" href="#éšå¼æäº¤"></a> éšå¼æäº¤</h1><p><code>MySQL</code> é»˜è®¤é‡‡ç”¨<strong>éšå¼æäº¤ç­–ç•¥</strong>ï¼ˆ<code>autocommit</code>ï¼‰ã€‚æ¯æ‰§è¡Œä¸€æ¡è¯­å¥å°±æŠŠè¿™æ¡è¯­å¥å½“æˆä¸€ä¸ªäº‹åŠ¡ç„¶åè¿›è¡Œæäº¤ã€‚</p><ul><li>å½“å‡ºç° <code>START TRANSACTION</code> è¯­å¥æ—¶ï¼Œä¼šå…³é—­éšå¼æäº¤ï¼›</li><li>å½“ <code>COMMIT</code> æˆ– <code>ROLLBACK</code> è¯­å¥æ‰§è¡Œåï¼Œäº‹åŠ¡ä¼šè‡ªåŠ¨å…³é—­ï¼Œé‡æ–°æ¢å¤éšå¼æäº¤ã€‚</li></ul><p>é€šè¿‡ <code>set autocommit=0</code> å¯ä»¥å–æ¶ˆè‡ªåŠ¨æäº¤ï¼Œç›´åˆ° <code>set autocommit=1</code> æ‰ä¼šæäº¤ï¼›<code>autocommit</code> æ ‡è®°æ˜¯é’ˆå¯¹<strong>æ¯ä¸ªè¿æ¥</strong>è€Œä¸æ˜¯é’ˆå¯¹æœåŠ¡å™¨çš„ã€‚</p><h1 id="éš”ç¦»çº§åˆ«"><a class="markdownIt-Anchor" href="#éš”ç¦»çº§åˆ«"></a> éš”ç¦»çº§åˆ«</h1><h2 id="è¯»æœªæäº¤-è„è¯»"><a class="markdownIt-Anchor" href="#è¯»æœªæäº¤-è„è¯»"></a> è¯»æœªæäº¤ - è„è¯»</h2><p><strong>è„è¯»</strong>ï¼ˆ<code>Dirty Read</code>ï¼‰ï¼šäº‹åŠ¡å¯ä»¥è¯»å–æœªæäº¤çš„æ•°æ®ã€‚</p><p><code>T1</code> ä¿®æ”¹ä¸€ä¸ªæ•°æ®ï¼Œ<code>T2</code> éšåè¯»å–è¿™ä¸ªæ•°æ®ã€‚å¦‚æœ <code>T1</code> æ’¤é”€äº†è¿™æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆ <code>T2</code> è¯»å–çš„æ•°æ®æ˜¯è„æ•°æ®ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200818130050.png" srcset="/img/loading.gif" alt="" /></p><h2 id="è¯»å·²æäº¤-ä¸å¯é‡å¤è¯»"><a class="markdownIt-Anchor" href="#è¯»å·²æäº¤-ä¸å¯é‡å¤è¯»"></a> è¯»å·²æäº¤ - ä¸å¯é‡å¤è¯»</h2><p>è¯»å·²æäº¤è§£å†³äº†è„è¯»çš„é—®é¢˜ï¼šæ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ª <code>ReadView</code>ï¼Œæ¯æ¬¡éƒ½å¯åˆ¤æ–­äº‹åŠ¡æ˜¯å¦æäº¤ã€‚</p><p><strong>ä¸å¯é‡å¤è¯»</strong>ï¼šæ‰§è¡Œä¸¤æ¬¡ç›¸åŒçš„æŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœå¯èƒ½ä¸ä¸€è‡´ã€‚<br /><code>T2</code> è¯»å–ä¸€ä¸ªæ•°æ®ï¼Œ<code>T1</code> å¯¹è¯¥æ•°æ®åšäº†ä¿®æ”¹ã€‚å¦‚æœ <code>T2</code> å†æ¬¡è¯»å–è¿™ä¸ªæ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200818131135.png" srcset="/img/loading.gif" alt="" /></p><h2 id="å¯é‡å¤è¯»-å¹»è¯»"><a class="markdownIt-Anchor" href="#å¯é‡å¤è¯»-å¹»è¯»"></a> å¯é‡å¤è¯» - å¹»è¯»</h2><p>è§£å†³äº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼šåœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ª <code>ReadView</code>ï¼Œæ¯æ¬¡è®¿é—®æ—¶éƒ½è¯»å–æœ€åˆçš„ç‰ˆæœ¬ã€‚</p><p><strong>å¹»è¯»</strong>ï¼šå½“æŸä¸ªäº‹åŠ¡è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡åˆå†æ¬¡è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶ï¼Œå¾—åˆ°ç»“æœä¸ç¬¬ä¸€æ¬¡ä¸ä¸€è‡´ã€‚</p><p><code>T1</code> è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼Œ<code>T2</code> åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°çš„æ•°æ®ï¼Œ<code>T1</code> å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´çš„æ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚</p><blockquote><p>InnoDB ä½¿ç”¨ <code>Next-Key Lock</code>ï¼Œé¿å…äº†å¹»è¯»ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200818131209.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ä¸²è¡ŒåŒ–"><a class="markdownIt-Anchor" href="#ä¸²è¡ŒåŒ–"></a> ä¸²è¡ŒåŒ–</h2><p>å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œåˆ™é¿å…äº†æ‰€æœ‰çš„å¹¶å‘é—®é¢˜ã€‚</p><p>ä¸²è¡ŒåŒ–ç­–ç•¥ä¼šåœ¨è¯»å–çš„æ¯ä¸€è¡Œæ•°æ®ä¸Šéƒ½åŠ é”ï¼Œè¿™å¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶å’Œé”ç«äº‰ã€‚è¿™å¯¹äºé«˜å¹¶å‘åº”ç”¨åŸºæœ¬ä¸Šæ˜¯ä¸å¯æ¥å—çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šé‡‡ç”¨è¿™ä¸ªçº§åˆ«ã€‚</p><h2 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h2><ul><li><code>READ UNCOMMITTED</code> - äº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ã€‚</li><li><code>READ COMMITTED</code> - ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ï¼Œé¿å…<strong>è„è¯»</strong>ã€‚</li><li><code>REPEATABLE READ</code> - é»˜è®¤éš”ç¦»çº§åˆ«ï¼Œè§£å†³äº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œä½¿ç”¨ <code>Next-Key Lock</code>ï¼Œé¿å…<strong>å¹»è¯»</strong>ã€‚</li><li><code>SERIALIZABLE</code> - å¯¹æ¯ä¸ªè¯»å–æ“ä½œåŠ å…±äº«é”ï¼Œå¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œä¸æ”¯æŒä¸€è‡´æ€§çš„éé”å®šè¯»ã€‚</li></ul><table><thead><tr><th style="text-align:center">éš”ç¦»çº§åˆ«</th><th style="text-align:center">è„è¯»</th><th style="text-align:center">ä¸å¯é‡å¤è¯»</th><th style="text-align:center">å¹»è¯»</th></tr></thead><tbody><tr><td style="text-align:center">è¯»æœªæäº¤ï¼ˆ<code>READ UNCOMMITTED</code>ï¼‰</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td></tr><tr><td style="text-align:center">è¯»å·²æäº¤ï¼ˆ<code>READ COMMITTED</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td></tr><tr><td style="text-align:center">å¯é‡å¤è¯»ï¼ˆ<code>REPREATABLE READ</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âŒ (<code>InnoDB</code> - âœ”ï¸)</td></tr><tr><td style="text-align:center">ä¸²è¡ŒåŒ–ï¼ˆ<code>SERIALIZABLE</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 35. æœç´¢æ’å…¥ä½ç½®</title>
    <link href="/2020/08/17/LeetCode-35-search-insert-position/"/>
    <url>/2020/08/17/LeetCode-35-search-insert-position/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/search-insert-position/" target="_blank" rel="noopener">35. æœç´¢æ’å…¥ä½ç½®</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">searchInsert</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target)</span> </span>&#123;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;            right = mid - <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &lt; target) &#123;            left = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">return</span> mid;        &#125;     &#125;    <span class="hljs-comment">// å•ç‹¬å¤„ç† left == right çš„æƒ…å†µ</span>    <span class="hljs-keyword">return</span> nums[left] &gt;= target ? left : left + <span class="hljs-number">1</span>;&#125;</code></pre><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">searchInsert</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">if</span> (nums.length == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> right = nums.length;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = (left + right) &gt;&gt;&gt; <span class="hljs-number">1</span>;            <span class="hljs-keyword">if</span> (target == nums[mid]) &#123;                <span class="hljs-keyword">return</span> mid;            &#125;            <span class="hljs-keyword">if</span> (nums[mid] &gt; target) &#123;                right = mid;            &#125; <span class="hljs-keyword">else</span> &#123;                left = mid + <span class="hljs-number">1</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> left;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ II</title>
    <link href="/2020/08/17/LeetCode-154-find-minimum-in-rotated-sorted-array-ii/"/>
    <url>/2020/08/17/LeetCode-154-find-minimum-in-rotated-sorted-array-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-minimum-in-rotated-sorted-array-ii/" target="_blank" rel="noopener">154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ II</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMin</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">if</span> (nums.length == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">if</span> (nums[right] &lt; nums[mid]) &#123;                left = mid + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[right] &gt; nums[mid]) &#123;                right = mid;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// è‹¥ å³ == ä¸­ï¼Œå› ä¸ºæœ€å°å€¼ä¸€å®šé è¿‘å·¦è¾¹ï¼Œä¸¢å¼ƒå³è¾¹çš„é‡å¤å€¼ï¼Œç¼©å°å³è¾¹ç•Œ</span>                right--;            &#125;        &#125;        <span class="hljs-keyword">return</span> nums[left];    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 153. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</title>
    <link href="/2020/08/17/LeetCode-153-find-minimum-in-rotated-sorted-array/"/>
    <url>/2020/08/17/LeetCode-153-find-minimum-in-rotated-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-minimum-in-rotated-sorted-array/" target="_blank" rel="noopener">153. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼</a></p><p>ç¬¬ä¸€æ¬¡é€šè¿‡çš„ä»£ç ï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMin</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">if</span> (nums.length == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">int</span> min = Integer.MAX_VALUE;    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (nums[left] &gt; nums[mid]) &#123;            <span class="hljs-comment">// å·¦ &gt; ä¸­ï¼Œmin åœ¨ ä¸­ åé¢çš„éƒ¨åˆ†</span>            min = Math.min(nums[mid], min);            <span class="hljs-comment">// åˆ°å·¦è¾¹æŸ¥æ‰¾</span>            right = mid;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// ä¸­ &gt;= å·¦ï¼Œmin åœ¨æœ€å·¦è¾¹</span>            min = Math.min(nums[left], min);            <span class="hljs-comment">// åˆ°å³è¾¹æŸ¥æ‰¾</span>            left = mid + <span class="hljs-number">1</span>;        &#125;    &#125;    <span class="hljs-keyword">return</span> Math.min(min, nums[left]);&#125;</code></pre><p>è¯„è®ºåŒºï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findMin</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">if</span> (nums.length == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * [3,4,5,1,2]</span><span class="hljs-comment">     * [4,5,6,7,0,1,2]</span><span class="hljs-comment">     * [0,1,2,3,4]</span><span class="hljs-comment">     * [2,1]</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (nums[right] &lt; nums[mid]) &#123;            <span class="hljs-comment">// å³ &lt; ä¸­ï¼Œä¸€å®šåœ¨å³è¾¹ï¼Œåˆ™åˆ°å³è¾¹æŸ¥æ‰¾</span>            left = mid + <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// å³ &gt;= ä¸­ï¼Œä¸€å®šåœ¨å·¦è¾¹</span>            right = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> nums[left];&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 81. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ II</title>
    <link href="/2020/08/17/LeetCode-81-search-in-rotated-sorted-array-ii/"/>
    <url>/2020/08/17/LeetCode-81-search-in-rotated-sorted-array-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/search-in-rotated-sorted-array-ii/" target="_blank" rel="noopener">81. æœç´¢æ—‹è½¬æ’åºæ•°ç»„ II</a></p><p>æœ¬é¢˜åŠ å…¥é‡å¤æ•°å­—ï¼Œæ‰€ä»¥åœ¨åˆ¤æ–­å“ªä¸€éƒ¨åˆ†æœ‰åºæ—¶ï¼Œè‹¥ <code>nums[left] == nums[mid]</code> å¯èƒ½å‡ºç°åˆ¤æ–­ä¸å‡ºæ¥çš„æƒ…å†µï¼Œä¸€å¼€å§‹ä¸€ç›´å¡ç€ï¼Œåæ¥å‘ç°åªè¦ä¸¢å¼ƒä¸€ä¸ªé‡å¤æ•°å­—ï¼Œåˆ™ä¸‹ä¸€æ¬¡å°±å¯æˆåŠŸåˆ¤æ–­ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">if</span> (nums.length == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">if</span> (target == nums[mid]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            <span class="hljs-keyword">if</span> (nums[left] &lt; nums[mid]) &#123;                <span class="hljs-comment">// å·¦åŠéƒ¨åˆ†æœ‰åº</span>                <span class="hljs-keyword">if</span> (target &gt;= nums[left] &amp;&amp; target &lt;= nums[mid]) &#123;                    right = mid;                &#125; <span class="hljs-keyword">else</span> &#123;                    left = mid + <span class="hljs-number">1</span>;                &#125;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[left] &gt; nums[mid]) &#123;                <span class="hljs-comment">// å³åŠéƒ¨åˆ†æœ‰åº</span>                <span class="hljs-keyword">if</span> (target &gt; nums[mid] &amp;&amp; target &lt;= nums[right]) &#123;                    left = mid + <span class="hljs-number">1</span>;                &#125; <span class="hljs-keyword">else</span> &#123;                    right = mid;                &#125;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// nums[left] == nums[mid] æ—¶æ— æ³•åˆ¤æ–­å“ªéƒ¨åˆ†æœ‰åºï¼Œåˆ™ä¸¢å¼ƒä¸€ä¸ªé‡å¤æ•°å­—</span>                <span class="hljs-comment">// [1,3,1,1,1]</span>                <span class="hljs-comment">// [1,3,1,1]</span>                left++;            &#125;        &#125;        <span class="hljs-keyword">return</span> nums[left] == target;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 74. æœç´¢äºŒç»´çŸ©é˜µ</title>
    <link href="/2020/08/17/LeetCode-74-search-a-2d-matrix/"/>
    <url>/2020/08/17/LeetCode-74-search-a-2d-matrix/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/search-a-2d-matrix/" target="_blank" rel="noopener">74. æœç´¢äºŒç»´çŸ©é˜µ</a><br />ä¸€å¼€å§‹ç”¨ <code>i = mid / rows</code> è®¡ç®—è¡Œæ•°ï¼Œå¯¼è‡´ä½ç½®è®¡ç®—ä¸æ­£ç¡®ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">searchMatrix</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[][] matrix, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">int</span> rows = matrix.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        <span class="hljs-keyword">int</span> cols = matrix[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> right = rows * cols - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;            <span class="hljs-comment">// è¡Œæ•°æ˜¯å¯¹æ¯è¡Œå¤§å°è¿›è¡Œæ•´é™¤ï¼Œ</span>            <span class="hljs-comment">// åˆ—æ•°æ˜¯å¯¹æ¯è¡Œå¤§å°è¿›è¡Œå–ä½™</span>            <span class="hljs-keyword">int</span> i = mid / cols;            <span class="hljs-keyword">int</span> j = mid % cols;            <span class="hljs-keyword">if</span> (matrix[i][j] == target) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (matrix[i][j] &lt; target) &#123;                <span class="hljs-comment">// ä¸ä½¿ç”¨ left = mid</span>                <span class="hljs-comment">// åŸå› åœ¨äºå‘ä¸Šå–æ•´æ—¶ matrix å¯èƒ½ä¼šè¶Šç•Œï¼Œæ‰€ä»¥é‡‡ç”¨å‘ä¸‹å–æ•´</span>                left = mid + <span class="hljs-number">1</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                right = mid;            &#125;        &#125;        <span class="hljs-keyword">return</span> matrix[left / cols][left % cols] == target;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„</title>
    <link href="/2020/08/17/LeetCode-33-search-in-rotated-sorted-array/"/>
    <url>/2020/08/17/LeetCode-33-search-in-rotated-sorted-array/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/search-in-rotated-sorted-array/" target="_blank" rel="noopener">33. æœç´¢æ—‹è½¬æ’åºæ•°ç»„</a></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> target)</span> </span>&#123;        <span class="hljs-keyword">int</span> left = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> right = nums.length - <span class="hljs-number">1</span>;        <span class="hljs-keyword">while</span> (left &lt; right) &#123;            <span class="hljs-keyword">int</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;            <span class="hljs-keyword">if</span> (nums[mid] == target) &#123;                <span class="hljs-keyword">return</span> mid;            &#125;            <span class="hljs-keyword">if</span> (nums[left] &lt; nums[mid]) &#123;                <span class="hljs-comment">// 1. å·¦åŠéƒ¨åˆ† [left, mid] æœ‰åº</span>                <span class="hljs-keyword">if</span> (target &gt;= nums[left] &amp;&amp; target &lt; nums[mid]) &#123;                    <span class="hljs-comment">// 1.1 target in [left, mid]</span>                    <span class="hljs-comment">// left &lt;= target &lt; mid.....right</span>                    <span class="hljs-comment">// [left, mid - 1]</span>                    right = mid - <span class="hljs-number">1</span>;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// 1.2 target in [mid + 1, right]</span>                    <span class="hljs-comment">// [mid, right]</span>                    left = mid;                &#125;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// 2. å³åŠéƒ¨åˆ† [mid, right] æœ‰åº</span>                <span class="hljs-keyword">if</span> (target &gt; nums[mid] &amp;&amp; target &lt;= nums[right]) &#123;                    <span class="hljs-comment">// 2.1 target in [mid, right]</span>                    <span class="hljs-comment">// left.....mid &lt; target &lt;= right</span>                    <span class="hljs-comment">// [mid, right]</span>                    left = mid;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// 2.2 target in [left, mid - 1]</span>                    <span class="hljs-comment">// [left, mid - 1]</span>                    right = mid - <span class="hljs-number">1</span>;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> nums[left] == target ? left : -<span class="hljs-number">1</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 367. æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°</title>
    <link href="/2020/08/16/LeetCode-367.%20valid-perfect-square/"/>
    <url>/2020/08/16/LeetCode-367.%20valid-perfect-square/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/valid-perfect-square/" target="_blank" rel="noopener">367. æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°</a></p><p>ä¸¤ç§è§£æ³•éƒ½å‡»è´¥ <code>100%</code></p><h1 id="äºŒåˆ†æ³•"><a class="markdownIt-Anchor" href="#äºŒåˆ†æ³•"></a> äºŒåˆ†æ³•</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPerfectSquare</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span> </span>&#123;    <span class="hljs-keyword">if</span> (num == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-keyword">long</span> left = <span class="hljs-number">1</span>;    <span class="hljs-keyword">long</span> right = num / <span class="hljs-number">2</span>;    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-keyword">long</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">long</span> prod = mid * mid;        <span class="hljs-keyword">if</span> (prod == num) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (prod &gt; num) &#123;            right = mid - <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            left = mid;        &#125;    &#125;    <span class="hljs-keyword">return</span> left * left == num;&#125;</code></pre><h1 id="ç‰›é¡¿è¿­ä»£æ³•"><a class="markdownIt-Anchor" href="#ç‰›é¡¿è¿­ä»£æ³•"></a> ç‰›é¡¿è¿­ä»£æ³•</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isPerfectSquare</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span> </span>&#123;    <span class="hljs-keyword">if</span> (num == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;    <span class="hljs-keyword">if</span> (num == <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-keyword">long</span> x = num / <span class="hljs-number">2</span>;    <span class="hljs-keyword">while</span> (x * x &gt; num) &#123;        x = (x + num / x) / <span class="hljs-number">2</span>;    &#125;    <span class="hljs-keyword">return</span> x * x == num;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 69. x çš„å¹³æ–¹æ ¹</title>
    <link href="/2020/08/15/LeetCode-69-sqrtx/"/>
    <url>/2020/08/15/LeetCode-69-sqrtx/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/sqrtx/" target="_blank" rel="noopener">69. x çš„å¹³æ–¹æ ¹</a></p><h1 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h1><blockquote><p><code>sqrt(x) &lt;= x / 2</code><br />ä¸€ä¸ªæ•°çš„å¹³æ–¹æ ¹ <code>&lt;=</code> è¿™ä¸ªæ•°çš„ä¸€åŠï¼Œæ‰€ä»¥å³è¾¹ç•Œæœ€å¤§ <code>= x / 2</code></p></blockquote><ul><li>å…ˆå†™åˆ†æ”¯é€»è¾‘ï¼Œå†å†³å®šä¸­é—´æ•°æ˜¯å¦ä¸Šå–æ•´ï¼›</li><li>åªè¦çœ‹åˆ° <code>left = mid</code> ï¼Œå®ƒå¯¹åº”çš„å–ä¸­ä½æ•°çš„å–æ³•ä¸€å®šæ˜¯ <code>mid = left + (right - left + 1) / 2;</code>ã€‚</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">mySqrt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;    <span class="hljs-keyword">if</span> (x == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">long</span> left = <span class="hljs-number">1</span>;    <span class="hljs-keyword">long</span> right = x / <span class="hljs-number">2</span>;    <span class="hljs-comment">// æ’é™¤å…ƒç´ ï¼Œä½¿ç”¨ &lt;ï¼Œæ¯æ¬¡éƒ½ä½¿ç”¨ [left, right] æŸ¥æ‰¾</span>    <span class="hljs-comment">// æŸ¥æ‰¾å…ƒç´ ï¼Œä½¿ç”¨ &lt;=</span>    <span class="hljs-keyword">while</span> (left &lt; right) &#123;        <span class="hljs-comment">// +1 å‘ä¸Šå–æ•´ï¼Œé¿å…æ­»å¾ªç¯</span>        <span class="hljs-comment">// ä¸ä½¿ç”¨ (left + right) / 2 æ˜¯ä¸ºäº†é¿å… long æº¢å‡º</span>        <span class="hljs-keyword">long</span> mid = left + (right - left + <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;        <span class="hljs-keyword">if</span> (mid * mid &gt; x) &#123;            <span class="hljs-comment">// [left, mid - 1]</span>            right = mid - <span class="hljs-number">1</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// [mid, right]</span>            left = mid;        &#125;    &#125;    <span class="hljs-comment">// é€€å‡ºå¾ªç¯æ—¶ left == right</span>    <span class="hljs-comment">// è¿˜å‰©ä¸€ä¸ªå…ƒç´ æ²¡æœ‰æŸ¥æ‰¾ï¼Œ</span>    <span class="hljs-comment">// å› ä¸ºç­”æ¡ˆä¸€å®šå­˜åœ¨ï¼Œå³ä¸€å®šåœ¨æœç´¢åŒºé—´ï¼Œå‰©ä¸‹çš„å…ƒç´ å°±æ˜¯é—®é¢˜ç­”æ¡ˆ</span>    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>)left;&#125;</code></pre><h1 id="ç‰›é¡¿è¿­ä»£æ³•"><a class="markdownIt-Anchor" href="#ç‰›é¡¿è¿­ä»£æ³•"></a> ç‰›é¡¿è¿­ä»£æ³•</h1><p>è¦ä½¿ç”¨ <code>double</code> ç±»å‹ï¼Œä¸€å¼€å§‹ä½¿ç”¨ <code>float</code> ç²¾åº¦ä¸å¤Ÿï¼Œæœ‰ä¸‰ä¸ªæµ‹è¯•ç”¨ä¾‹æ— æ³•é€šè¿‡ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mi>a</mi><mspace linebreak="newline"></mspace><mo>=</mo><mo>&gt;</mo><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msup><mi>f</mi><mo mathvariant="normal">â€²</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>x</mi><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>âˆ’</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msup><mi>f</mi><mo mathvariant="normal">â€²</mo></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace><mi>x</mi><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>âˆ’</mo><mfrac><mrow><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup><mo>âˆ’</mo><mi>a</mi></mrow><mrow><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac><mspace linebreak="newline"></mspace><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><mfrac><mi>a</mi><msub><mi>x</mi><mi>n</mi></msub></mfrac><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">f(x) = x^2 - a \\=&gt; y = f(x_n) + f&#x27;(x_n)(x - x_n) \\x = x_n - \frac{f(x_n)}{f&#x27;(x_n)}\\x = x_n - \frac{x_n^2 - a}{2x_n}\\x = \frac{1}{2}(x_n + \frac{a}{x_n})\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6778919999999999em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.327108em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.9435600000000002em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">mySqrt</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;    <span class="hljs-keyword">double</span> cur = <span class="hljs-number">1.0</span>;    <span class="hljs-keyword">double</span> pre = <span class="hljs-number">0</span>;    <span class="hljs-keyword">while</span> (Math.abs(cur - pre) &gt; <span class="hljs-number">1e-6</span>) &#123;        pre = cur;        cur = (cur + x / cur) / <span class="hljs-number">2</span>;    &#125;    System.out.println(cur);    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>)cur;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>äºŒåˆ†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 45. è·³è·ƒæ¸¸æˆ II</title>
    <link href="/2020/08/14/LeetCode-45-jump-game-ii/"/>
    <url>/2020/08/14/LeetCode-45-jump-game-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/jump-game-ii/" target="_blank" rel="noopener">45. è·³è·ƒæ¸¸æˆ II</a></p><p>æœ¬é¢˜åœ¨ <a href="https://leetcode-cn.com/problems/jump-game/" target="_blank" rel="noopener">55. è·³è·ƒæ¸¸æˆ</a> åŸºç¡€ä¸ŠåŠ äº†ä¸ªæœ€å°æ¬¡æ•°ï¼Œå…¶å®ä¹Ÿæ˜¯è®¡ç®—æ¯ä¸ªä½ç½®èƒ½è·³åˆ°çš„æœ€è¿œè·ç¦»ï¼Œå…³é”®åœ¨äºè¦ä¿å­˜ä¸Šä¸€æ¬¡çš„æœ€è¿œè¾¹ç•Œï¼Œç”¨æ¥åˆ¤æ–­è·³è·ƒçš„æ¬¡æ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">jump</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">int</span> pos = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> begin = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> end = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (pos &lt; nums.length - <span class="hljs-number">1</span>) &#123;            <span class="hljs-comment">// æœ¬æ¬¡èƒ½è·³åˆ°çš„æœ€è¿œä½ç½®</span>            <span class="hljs-keyword">int</span> max = pos;            <span class="hljs-comment">// æ¯æ¬¡éƒ½åœ¨ [begin, end] åŒºé—´é‡Œæ‰¾åˆ°èƒ½è·³åˆ°çš„æœ€è¿œä½ç½®</span>            <span class="hljs-comment">// ä¸€ä¸ªåŒºé—´è¡¨ç¤ºä¸€æ¬¡è·³è·ƒçš„æ‰€æœ‰å¯èƒ½èµ·ç‚¹ï¼Œé€‰å–èƒ½è·³åˆ°çš„æœ€è¿œä½ç½®</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = begin; i &lt;= end; i++) &#123;                max = Math.max(max, i + nums[i]);            &#125;            <span class="hljs-comment">// æ›´æ–°ä¸‹ä¸€æ¬¡è·³çš„åŒºé—´</span>            begin = end + <span class="hljs-number">1</span>;            end = max;            <span class="hljs-comment">// æ›´æ–°æœ€è¿œä½ç½®</span>            pos = max;            count++;        &#125;        <span class="hljs-keyword">return</span> count;    &#125;</code></pre><p>ä¼˜åŒ–ï¼šè®¡ç®—ä»æ¯ä¸ªä½ç½®èƒ½è·³åˆ°çš„æœ€è¿œè·ç¦»ã€‚æ¯æ¬¡æœ€è¿œï¼Œæœ€ç»ˆæœ€è¿œï¼Œåˆ™è·³è·ƒæ¬¡æ•°æœ€å°‘ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">jump</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-comment">// ä¸€æ¬¡è·³è·ƒå¯åˆ°è¾¾çš„æœ€è¿œä½ç½®</span>        <span class="hljs-keyword">int</span> end = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;            <span class="hljs-comment">// è‹¥ä¸Šä¸€æ¬¡å·²åˆ°è¾¾ç»ˆç‚¹ï¼Œåˆ™ç»“æŸ</span>            <span class="hljs-keyword">if</span> (end == nums.length - <span class="hljs-number">1</span>) &#123;                <span class="hljs-keyword">return</span> count;            &#125;            <span class="hljs-comment">// è®¡ç®—ä»ç¬¬ i ä¸ªä½ç½®èµ·è·³çš„æœ€è¿œä½ç½®</span>            max = Math.max(max, i + nums[i]);            <span class="hljs-comment">// ä¸€æ¬¡è·³è·ƒåˆ°è¾¾ç»ˆç‚¹ï¼Œæ›´æ–°è·³è·ƒæ¬¡æ•°å’Œä¸‹ä¸€æ¬¡çš„è·³è·ƒè¾¹ç•Œ</span>            <span class="hljs-keyword">if</span> (end == i) &#123;                count++;                end = max;            &#125;        &#125;        <span class="hljs-keyword">return</span> count;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 55. è·³è·ƒæ¸¸æˆ</title>
    <link href="/2020/08/14/LeetCode-55-jump-game/"/>
    <url>/2020/08/14/LeetCode-55-jump-game/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/jump-game/" target="_blank" rel="noopener">55. è·³è·ƒæ¸¸æˆ</a></p><p>(ğŸ™ƒä¸€å¼€å§‹è¿˜ç”¨çš„å›æº¯ã€‚ã€‚ã€‚)<br />å…³é”®åœ¨äºï¼šè‹¥èƒ½è·³åˆ°ç¬¬ <code>i</code> ä¸ªä½ç½®ï¼Œåˆ™åœ¨è¿™ä¹‹å‰çš„æ‰€æœ‰ä½ç½®éƒ½èƒ½åˆ°è¾¾ï¼Œæ‰€ä»¥åªè¦è®¡ç®—ä»ç¬¬ <code>i</code> ä¸ªä½ç½®èµ·è·³èƒ½è·³åˆ°çš„æœ€è¿œä½ç½®ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canJump</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        <span class="hljs-keyword">int</span> maxPos = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;            <span class="hljs-comment">// è‹¥èƒ½è·³åˆ°çš„æœ€è¿œä½ç½® &lt; å½“å‰ä½ç½®</span>            <span class="hljs-comment">// è¯´æ˜è¿å½“å‰ä½ç½®éƒ½è·³ä¸åˆ°ï¼Œä¹Ÿå°±è·³ä¸åˆ°ç»ˆç‚¹äº†</span>            <span class="hljs-keyword">if</span> (maxPos &lt; i) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-comment">// èƒ½è·³åˆ°ç¬¬ i ä¸ªä½ç½®çš„æƒ…å†µä¸‹ï¼Œ</span>            <span class="hljs-comment">// è®¡ç®—ä»ç¬¬ i ä¸ªä½ç½®èµ·è·³ï¼Œèƒ½è·³åˆ°çš„æœ€è¿œä½ç½®</span>            <span class="hljs-comment">// æœ€è¿œ = max(æœ¬æ¬¡èµ·è·³ï¼Œä¸Šæ¬¡æœ€è¿œä½ç½®)</span>            maxPos = Math.max(i + nums[i], maxPos);        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB é”</title>
    <link href="/2020/08/14/InnoDB-Lock/"/>
    <url>/2020/08/14/InnoDB-Lock/</url>
    
    <content type="html"><![CDATA[<h1 id="innodb-ä¸­çš„é”"><a class="markdownIt-Anchor" href="#innodb-ä¸­çš„é”"></a> <code>InnoDB</code> ä¸­çš„é”</h1><h2 id="è¡¨çº§é”å’Œè¡Œçº§é”"><a class="markdownIt-Anchor" href="#è¡¨çº§é”å’Œè¡Œçº§é”"></a> è¡¨çº§é”å’Œè¡Œçº§é”</h2><table><thead><tr><th style="text-align:center">é”ç±»å‹</th><th style="text-align:center">å¼€é”€</th><th style="text-align:center">åŠ é”é€Ÿåº¦</th><th style="text-align:center">æ­»é”</th><th style="text-align:center">ç²’åº¦</th><th style="text-align:center">é”å†²çª</th><th style="text-align:center">å¹¶å‘æ€§</th></tr></thead><tbody><tr><td style="text-align:center">è¡¨çº§é”ï¼ˆ<code>table lock</code>ï¼‰</td><td style="text-align:center">å°</td><td style="text-align:center">å¿«</td><td style="text-align:center">æ— </td><td style="text-align:center">å¤§</td><td style="text-align:center">é«˜</td><td style="text-align:center">ä½</td></tr><tr><td style="text-align:center">è¡Œçº§é”ï¼ˆ<code>row lock</code>ï¼‰</td><td style="text-align:center">å¤§</td><td style="text-align:center">æ…¢</td><td style="text-align:center">æœ‰</td><td style="text-align:center">å°</td><td style="text-align:center">å°</td><td style="text-align:center">é«˜</td></tr></tbody></table><p>åº”è¯¥å°½é‡åªé”å®šéœ€è¦ä¿®æ”¹çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸æ˜¯æ‰€æœ‰çš„èµ„æºã€‚é”å®šçš„æ•°æ®é‡è¶Šå°‘ï¼Œé”ç«äº‰çš„å‘ç”Ÿé¢‘ç‡å°±è¶Šå°ï¼Œç³»ç»Ÿçš„å¹¶å‘ç¨‹åº¦å°±è¶Šé«˜ã€‚ä½†æ˜¯åŠ é”éœ€è¦æ¶ˆè€—èµ„æºï¼Œé”çš„å„ç§æ“ä½œï¼ˆåŒ…æ‹¬è·å–é”ã€é‡Šæ”¾é”ã€ä»¥åŠæ£€æŸ¥é”çŠ¶æ€ï¼‰éƒ½ä¼šå¢åŠ ç³»ç»Ÿå¼€é”€ã€‚å› æ­¤é”ç²’åº¦è¶Šå°ï¼Œç³»ç»Ÿå¼€é”€å°±è¶Šå¤§ã€‚</p><p>ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒçš„é”ç²’åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼š</p><ul><li><code>InnoDB</code> è¡Œé”å’Œè¡¨é”éƒ½æ”¯æŒã€‚</li><li><code>MyISAM</code> åªæ”¯æŒè¡¨é”ã€‚</li></ul><p>åœ¨ <code>InnoDB</code> ä¸­ï¼Œè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ã€‚å¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œ<code>InnoDB</code> å°†ä¼šé€šè¿‡éšè—çš„èšç°‡ç´¢å¼•æ¥å¯¹è®°å½•åŠ é”ã€‚</p><h2 id="è¡Œçº§é”çš„ç±»å‹"><a class="markdownIt-Anchor" href="#è¡Œçº§é”çš„ç±»å‹"></a> è¡Œçº§é”çš„ç±»å‹</h2><p><code>InnoDB</code> å®ç°äº†å¦‚ä¸‹ä¸¤ç§æ ‡å‡†çš„è¡Œçº§é”ï¼š</p><ol><li>å…±äº«é”ï¼ˆè¯»é”ã€<code>S</code> é”ï¼‰ï¼šå…è®¸äº‹åŠ¡è¯»ä¸€è¡Œæ•°æ®ã€‚</li><li>æ’ä»–é”(å†™é”ã€<code>X</code> é”)ï¼šå…è®¸äº‹åŠ¡åˆ é™¤æˆ–æ›´æ–°ä¸€è¡Œæ•°æ®ã€‚</li></ol><p><code>InnoDB</code> æ”¯æŒåœ¨ä¸åŒç²’åº¦ä¸Šè¿›è¡ŒåŠ é”æ“ä½œï¼Œç§°ä¸ºæ„å‘é”ï¼Œå³ä¸º<strong>è¡¨çº§åˆ«çš„é”</strong>ï¼Œå¯¹ç¨‹åºå‘˜é€æ˜ã€‚è‹¥å¯¹ç»†ç²’åº¦çš„å¯¹è±¡è¿›è¡Œä¸Šé”ï¼Œé‚£ä¹ˆé¦–å…ˆéœ€è¦å¯¹ç²—ç²’åº¦çš„å¯¹è±¡ä¸Šé”ã€‚<br />ä¸¤ç§æ„å‘é”ï¼š</p><ol><li>æ„å‘å…±äº«é”ï¼šäº‹åŠ¡æƒ³è¦è·å¾—ä¸€å¼ è¡¨ä¸­æŸå‡ è¡Œçš„å…±äº«é”ã€‚</li><li>æ„å‘æ’ä»–é”ï¼šäº‹åŠ¡æƒ³è¦è·å¾—ä¸€å¼ è¡¨ä¸­æŸå‡ è¡Œçš„æ’ä»–é”ã€‚</li></ol><h2 id="ä¸€è‡´æ€§éé”å®šè¯»"><a class="markdownIt-Anchor" href="#ä¸€è‡´æ€§éé”å®šè¯»"></a> ä¸€è‡´æ€§éé”å®šè¯»</h2><p>æŒ‡çš„æ˜¯ <code>InnoDB</code> é€šè¿‡è¡Œå¤šç‰ˆæœ¬æ§åˆ¶çš„æ–¹å¼æ¥è¯»å–å½“å‰æ‰§è¡Œæ—¶é—´æ•°æ®åº“ä¸­è¡Œçš„æ•°æ®ã€‚<br />å¦‚æœè¯»å–çš„è¡Œæ­£åœ¨æ‰§è¡Œ <code>DELETE</code> æˆ– <code>UPDATE</code> æ“ä½œï¼Œè¿™æ—¶è¯»å–æ“ä½œä¸ä¼šç­‰å¾…è¡Œé”çš„é‡Šæ”¾ï¼Œè€Œæ˜¯å»è¯»å–è¡Œçš„ä¸€ä¸ªå¿«ç…§æ•°æ®ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200814141414.png" srcset="/img/loading.gif" alt="" /></p><p>é»˜è®¤é…ç½®ä¸‹ï¼Œäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ä¸º <code>REPREATABLE READ</code>ã€‚</p><ul><li>åœ¨ <code>READ COMMITTED</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œéä¸€è‡´æ€§è¯»æ€»æ˜¯è¯»å–è¢«é”å®šè¡Œçš„<strong>æœ€æ–°ä¸€ä»½</strong>å¿«ç…§æ•°æ®ã€‚</li><li>åœ¨ <code>REPREATABLE READ</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œéä¸€è‡´æ€§è¯»æ€»æ˜¯è¯»å–<strong>äº‹åŠ¡å¼€å§‹æ—¶</strong>çš„è¡Œæ•°æ®ç‰ˆæœ¬ã€‚</li></ul><h2 id="ä¸€è‡´æ€§é”å®šè¯»"><a class="markdownIt-Anchor" href="#ä¸€è‡´æ€§é”å®šè¯»"></a> ä¸€è‡´æ€§é”å®šè¯»</h2><p><code>InnoDB</code> å¯¹äº <code>SELECT</code> è¯­å¥æ”¯æŒä¸¤ç§ä¸€è‡´æ€§çš„é”å®šè¯»æ“ä½œï¼š</p><ol><li><code>SELECT Â·Â·Â· FOR UPDATE</code>: å¯¹è¯»å–çš„è¡ŒåŠ ä¸€ä¸ª <code>X</code> é”ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å¯¹å·²é”å®šçš„è¡ŒåŠ ä»»ä½•é”ã€‚</li><li><code>SELECT Â·Â·Â· LOCK IN SHARE MODE</code>: å¯¹è¯»å–çš„è¡ŒåŠ ä¸€ä¸ª <code>S</code> é”ï¼Œå…¶ä»–äº‹åŠ¡å¯ä»¥å‘è¢«é”å®šçš„è¡ŒåŠ  <code>S</code> é”ï¼Œå¦‚æœåŠ  <code>X</code> é”ï¼Œåˆ™ä¼šè¢«é˜»å¡ã€‚</li></ol><p>åœ¨ä½¿ç”¨ä¸Šè¿°ä¸¤å¥ <code>SELECT</code> è¯­å¥æ—¶ï¼ŒåŠ¡å¿…åŠ ä¸Š <code>BEGIN, START TRANSACTION</code> æˆ–è€… <code>SET AUTOCOMMIT = 0</code>ï¼Œå› ä¸ºä»–ä»¬å¿…é¡»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå½“äº‹åŠ¡æäº¤äº†ï¼Œé”ä¹Ÿå°±é‡Šæ”¾äº†ã€‚</p><h2 id="è‡ªå¢é•¿ä¸é”"><a class="markdownIt-Anchor" href="#è‡ªå¢é•¿ä¸é”"></a> è‡ªå¢é•¿ä¸é”</h2><p>æ¯ä¸ªå«æœ‰è‡ªå¢é•¿å€¼çš„è¡¨éƒ½æœ‰ä¸€ä¸ªè‡ªå¢é•¿è®¡æ•°å™¨ï¼ˆ<code>auto-increment counter</code>ï¼‰ï¼Œå½“è¡¨è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œè¿™ä¸ªè®¡æ•°å™¨ä¼šè¢«åˆå§‹åŒ–ï¼Œæ’å…¥æ“ä½œä¼šæ ¹æ®è¿™ä¸ªè‡ªå¢é•¿çš„è®¡æ•°å™¨åŠ  <code>1</code> èµ‹äºˆè‡ªå¢é•¿åˆ—ã€‚<br />è¿™ä¸ªå®ç°æ–¹å¼ç§°ä½œ <code>AUTO-INC Locking</code>ã€‚è¿™ç§é”å…¶å®æ˜¯é‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„è¡¨é”æœºåˆ¶ï¼Œä¸ºäº†æé«˜æ’å…¥çš„æ€§èƒ½ï¼Œ<strong>é”ä¸æ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡å®Œæˆåé‡Šæ”¾ï¼Œè€Œæ˜¯åœ¨å®Œæˆå¯¹è‡ªå¢é•¿å€¼æ’å…¥çš„ <code>SQL</code> è¯­å¥åé‡Šæ”¾</strong>ã€‚</p><p>åœ¨ <code>InnoDB</code> ä¸­ï¼Œè‡ªå¢é•¿å€¼çš„åˆ—å¿…é¡»æ˜¯ç´¢å¼•ï¼ŒåŒæ—¶å¿…é¡»æ˜¯ç´¢å¼•çš„ç¬¬ä¸€ä¸ªåˆ—ã€‚å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªåˆ—ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ <code>MyISAM</code> æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p><h1 id="è¡Œé”çš„ä¸‰ç§ç®—æ³•"><a class="markdownIt-Anchor" href="#è¡Œé”çš„ä¸‰ç§ç®—æ³•"></a> è¡Œé”çš„ä¸‰ç§ç®—æ³•</h1><ul><li><code>Record Lock</code>: å•ä¸ªè¡Œè®°å½•ä¸Šçš„é”ã€‚</li><li><code>Gap Lock</code>: é—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä½†ä¸åŒ…å«è®°å½•æœ¬èº«ã€‚</li><li><code>Next-Key Lock</code>: <code>Gap Lock + Record Lock</code>ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œå¹¶ä¸”é”å®šè®°å½•æœ¬èº«ã€‚</li></ul><p>åŠ é”è§„åˆ™ï¼š</p><p>åœ¨ <code>READ COMMITTED</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œé‡‡ç”¨ <code>Record Lock</code>ã€‚<br />åœ¨ <code>REPREATABLE READ</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œé‡‡ç”¨ <code>Next-Key Lock</code>ã€‚</p><ul><li><p>å½“æŸ¥è¯¢çš„ç´¢å¼•å«æœ‰å”¯ä¸€å±æ€§æ—¶ï¼Œ<code>Next-Key Lock</code> ä¼šé™çº§ä¸º <code>Record Lock</code>ï¼Œå³ä»…é”ä½ç´¢å¼•æœ¬èº«ï¼Œè€Œä¸æ˜¯èŒƒå›´ã€‚</p></li><li><p>è€Œå¯¹äºè¾…åŠ©ç´¢å¼•ï¼Œä¼šåŠ ä¸Š <code>Next-Key Lock</code>ï¼Œè¿˜ä¼šå¯¹è¾…åŠ©ç´¢å¼•çš„ä¸‹ä¸€ä¸ªé”®å€¼åŠ ä¸Š <code>Gap Lock</code>ã€‚</p></li></ul><h1 id="äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸é”é—®é¢˜"><a class="markdownIt-Anchor" href="#äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸é”é—®é¢˜"></a> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸é”é—®é¢˜</h1><h2 id="éš”ç¦»çº§åˆ«"><a class="markdownIt-Anchor" href="#éš”ç¦»çº§åˆ«"></a> éš”ç¦»çº§åˆ«</h2><table><thead><tr><th style="text-align:center">éš”ç¦»çº§åˆ«</th><th style="text-align:center">è„è¯»</th><th style="text-align:center">ä¸å¯é‡å¤è¯»</th><th style="text-align:center">å¹»è¯»</th></tr></thead><tbody><tr><td style="text-align:center">è¯»æœªæäº¤ï¼ˆ<code>READ UNCOMMITTED</code>ï¼‰</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td></tr><tr><td style="text-align:center">è¯»å·²æäº¤ï¼ˆ<code>READ COMMITTED</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âŒ</td><td style="text-align:center">âŒ</td></tr><tr><td style="text-align:center">å¯é‡å¤è¯»ï¼ˆ<code>REPREATABLE READ</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âŒ (<code>InnoDB</code> - âœ”ï¸)</td></tr><tr><td style="text-align:center">ä¸²è¡ŒåŒ–ï¼ˆ<code>SERIALIZABLE</code>ï¼‰</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td><td style="text-align:center">âœ”ï¸</td></tr></tbody></table><h2 id="è„è¯»"><a class="markdownIt-Anchor" href="#è„è¯»"></a> è„è¯»</h2><blockquote><p>é’ˆå¯¹æœªæäº¤æ•°æ®</p></blockquote><p>è„è¯»æŒ‡çš„æ˜¯åœ¨<strong>ä¸åŒçš„äº‹åŠ¡</strong>ä¸‹ï¼Œå½“å‰äº‹åŠ¡å¯ä»¥è¯»åˆ°å¦å¤–äº‹åŠ¡<strong>æœªæäº¤</strong>çš„æ•°æ®ã€‚</p><p>è„è¯»å‘ç”Ÿçš„æ¡ä»¶æ˜¯éœ€è¦äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ä¸º <code>READ UNCOMMITTED</code>ï¼Œè€Œç›®å‰ç»å¤§éƒ¨åˆ†çš„æ•°æ®åº“éƒ½è‡³å°‘è®¾ç½®æˆ <code>READ COMMITTED</code>ã€‚</p><h2 id="ä¸å¯é‡å¤è¯»"><a class="markdownIt-Anchor" href="#ä¸å¯é‡å¤è¯»"></a> ä¸å¯é‡å¤è¯»</h2><blockquote><p>é’ˆå¯¹å…¶ä»–äº‹åŠ¡æäº¤å‰åï¼Œè¯»å–<strong>æ•°æ®æœ¬èº«</strong>çš„å¯¹æ¯”<br />é‡ç‚¹åœ¨äºåŒä¸€æ¡æ•°æ®è¢«ä¿®æ”¹äº†</p></blockquote><p>ä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨<strong>åŒä¸€äº‹åŠ¡</strong>ä¸‹ï¼Œåœ¨ä¸¤æ¬¡è¯»åŒä¸€ä¸ªæ•°æ®ä¹‹é—´ï¼Œç”±äºç¬¬äºŒä¸ªäº‹åŠ¡çš„ä¿®æ”¹ï¼Œå¯¼è‡´ä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€æ ·ã€‚</p><p><code>InnoDB</code> åœ¨ <code>REPREATABLE READ</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œé‡‡ç”¨ <code>Next-Key Lock</code> è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ã€‚</p><h2 id="å¹»è¯»"><a class="markdownIt-Anchor" href="#å¹»è¯»"></a> å¹»è¯»</h2><blockquote><p>é’ˆå¯¹å…¶ä»–äº‹åŠ¡æäº¤å‰åï¼Œè¯»å–<strong>æ•°æ®æ¡æ•°</strong>çš„å¯¹æ¯”<br />é‡ç‚¹åœ¨äºè¡¨ä¸­æ•°æ®çš„<strong>æ–°å¢</strong>æˆ–è€…<strong>åˆ é™¤</strong></p></blockquote><p>å¹»è¯»æ˜¯æŒ‡åœ¨<strong>åŒä¸€äº‹åŠ¡</strong>ä¸‹ï¼Œ<strong>è¿ç»­æ‰§è¡Œä¸¤æ¬¡åŒæ ·çš„ <code>SQL</code> è¯­å¥å¯èƒ½å¯¼è‡´ä¸åŒçš„ç»“æœ</strong>ï¼Œç¬¬äºŒæ¬¡çš„ <code>SQL</code> è¯­å¥å¯èƒ½ä¼šè¿”å›ä¹‹å‰ä¸å­˜åœ¨çš„è¡Œã€‚</p><p><code>InnoDB</code> åœ¨ <code>REPREATABLE READ</code> äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œé‡‡ç”¨ <code>Next-Key Lock</code> å·²ç»èƒ½é¿å…å¹»è¯»çš„äº§ç”Ÿã€‚<br />è€Œå…¶ä»–æ•°æ®åº“ï¼Œå¦‚ <code>ORACLE</code> å¯èƒ½éœ€è¦åœ¨ <code>SERIALIZABLE</code> ä¸‹æ‰èƒ½è§£å†³å¹»è¯»ã€‚</p><h2 id="ç‰ˆæœ¬é“¾"><a class="markdownIt-Anchor" href="#ç‰ˆæœ¬é“¾"></a> ç‰ˆæœ¬é“¾</h2><p>æ¯æ¬¡å¯¹æŸæ¡èšç°‡ç´¢å¼•è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬ï¼Œéƒ½ä¼šè®°å½•ä¸€æ¡ <code>undo</code> æ—¥å¿—ï¼Œæ¯æ¡ <code>undo</code> æ—¥å¿—ä¹Ÿéƒ½æœ‰ä¸€ä¸ª <code>roll_pointer</code> å±æ€§ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200814164939.png" srcset="/img/loading.gif" alt="" /></p><p>å¯¹è¯¥è®°å½•æ¯æ¬¡æ›´æ–°åï¼Œéƒ½ä¼šå°†æ—§å€¼æ”¾åˆ°ä¸€æ¡ <code>undo</code> æ—¥å¿—ä¸­ï¼Œå°±ç®—æ˜¯è¯¥è®°å½•çš„ä¸€ä¸ªæ—§ç‰ˆæœ¬ï¼Œéšç€æ›´æ–°æ¬¡æ•°çš„å¢å¤šï¼Œæ‰€æœ‰çš„ç‰ˆæœ¬éƒ½ä¼šè¢« <code>roll_pointer</code> å±æ€§è¿æ¥æˆä¸€ä¸ªé“¾è¡¨ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªé“¾è¡¨ç§°ä¹‹ä¸ºç‰ˆæœ¬é“¾ï¼Œç‰ˆæœ¬é“¾çš„å¤´èŠ‚ç‚¹å°±æ˜¯å½“å‰è®°å½•æœ€æ–°çš„å€¼ã€‚å¦å¤–ï¼Œæ¯ä¸ªç‰ˆæœ¬ä¸­è¿˜åŒ…å«ç”Ÿæˆè¯¥ç‰ˆæœ¬æ—¶å¯¹åº”çš„äº‹åŠ¡ <code>id</code>ã€‚</p><h2 id="readview"><a class="markdownIt-Anchor" href="#readview"></a> <code>ReadView</code></h2><ul><li>å¯¹äºä½¿ç”¨ <code>READ UNCOMMITTED</code> éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œç›´æ¥è¯»å–è®°å½•çš„æœ€æ–°ç‰ˆæœ¬å°±å¥½äº†ã€‚</li><li>å¯¹äºä½¿ç”¨ <code>SERIALIZABLE</code> éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œä½¿ç”¨åŠ é”çš„æ–¹å¼æ¥è®¿é—®è®°å½•ã€‚</li><li>å¯¹äºä½¿ç”¨ <code>READ COMMITTED</code> å’Œ <code>REPEATABLE READ</code> éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œå°±éœ€è¦ç”¨åˆ°ç‰ˆæœ¬é“¾äº†ï¼Œæ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š<strong>éœ€è¦åˆ¤æ–­ä¸€ä¸‹ç‰ˆæœ¬é“¾ä¸­çš„å“ªä¸ªç‰ˆæœ¬æ˜¯å½“å‰äº‹åŠ¡å¯è§çš„</strong>ã€‚</li></ul><p><code>ReadView</code> ä¸­ä¸»è¦åŒ…å«å½“å‰ç³»ç»Ÿä¸­è¿˜æœ‰å“ªäº›æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ï¼ŒæŠŠå®ƒä»¬çš„äº‹åŠ¡ <code>id</code> æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚è¿™æ ·åœ¨è®¿é—®æŸæ¡è®°å½•æ—¶ï¼Œå°±å¯åˆ¤æ–­è®°å½•çš„æŸä¸ªç‰ˆæœ¬æ˜¯å¦å¯è§ã€‚</p><ul><li><p><code>READ COMMITTED</code>ï¼šæ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ª <code>ReadView</code>ï¼Œæ¯æ¬¡éƒ½å¯åˆ¤æ–­äº‹åŠ¡æ˜¯å¦æäº¤ã€‚</p></li><li><p><code>REPEATABLE READ</code>ï¼šåœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ª <code>ReadView</code>ï¼Œæ¯æ¬¡è®¿é—®æ—¶éƒ½è¯»å–æœ€åˆçš„ç‰ˆæœ¬ã€‚</p></li></ul><h1 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h1><ul><li><a href="https://juejin.im/post/6844903808376504327" target="_blank" rel="noopener">MySQLäº‹åŠ¡éš”ç¦»çº§åˆ«å’ŒMVCC</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
      <tag>é”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 874. æ¨¡æ‹Ÿè¡Œèµ°æœºå™¨äºº</title>
    <link href="/2020/08/13/LeetCode-874-walking-robot-simulation/"/>
    <url>/2020/08/13/LeetCode-874-walking-robot-simulation/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/walking-robot-simulation/" target="_blank" rel="noopener">874. æ¨¡æ‹Ÿè¡Œèµ°æœºå™¨äºº</a></p><p>ä¸€å¼€å§‹ç”¨çš„ <code>findObstacle()</code>ï¼Œæ¯èµ°ä¸€æ­¥éƒ½è¦éå† <code>obstacles</code>ï¼Œæ•ˆç‡å¾ˆæ…¢ï¼Œå®˜æ–¹é¢˜è§£é‡‡å–<strong>å°†éšœç¢ç¼–ç </strong>çš„æ–¹å¼ï¼Œè¿™æ ·åªè¦ <code>O(1)</code> å°±å¯ä»¥å®Œæˆåˆ¤æ–­ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">robotSim</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] commands, <span class="hljs-keyword">int</span>[][] obstacles)</span> </span>&#123;        <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>, y = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span>[][] dirs = &#123;                <span class="hljs-comment">// åŒ—ï¼š0</span>                &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;,                <span class="hljs-comment">// ä¸œï¼š1</span>                &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,                <span class="hljs-comment">// å—ï¼š2</span>                &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;,                <span class="hljs-comment">// è¥¿ï¼š3</span>                &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,        &#125;;        <span class="hljs-keyword">int</span> dir = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> max = <span class="hljs-number">0</span>;        <span class="hljs-comment">// å°†éšœç¢ç¼–ç ï¼ŒåŠ å¿«åˆ¤æ–­æ•ˆç‡</span>        Set&lt;Long&gt; obstacleSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] ob : obstacles) &#123;            <span class="hljs-keyword">long</span> ox = ob[<span class="hljs-number">0</span>] + <span class="hljs-number">30000</span>;            <span class="hljs-keyword">long</span> oy = ob[<span class="hljs-number">1</span>] + <span class="hljs-number">30000</span>;            obstacleSet.add((ox &lt;&lt; <span class="hljs-number">16</span>) + oy);        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> step : commands) &#123;            <span class="hljs-keyword">if</span> (step == -<span class="hljs-number">1</span>) &#123;                <span class="hljs-comment">// å³è½¬</span>                dir = (dir + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>;            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (step == -<span class="hljs-number">2</span>) &#123;                <span class="hljs-comment">// å·¦è½¬</span>                dir = (dir + <span class="hljs-number">3</span>) % <span class="hljs-number">4</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                <span class="hljs-comment">// å‘å‰èµ° step æ­¥ï¼Œç›´åˆ°é‡ä¸Šéšœç¢ç‰©</span>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; step; i++) &#123;                    <span class="hljs-keyword">long</span> nx = x + dirs[dir][<span class="hljs-number">0</span>] + <span class="hljs-number">30000</span>;                    <span class="hljs-keyword">long</span> ny = y + dirs[dir][<span class="hljs-number">1</span>] + <span class="hljs-number">30000</span>;                    <span class="hljs-keyword">if</span> (!obstacleSet.contains((nx &lt;&lt; <span class="hljs-number">16</span>) + ny)) &#123;                        x = x + dirs[dir][<span class="hljs-number">0</span>];                        y = y + dirs[dir][<span class="hljs-number">1</span>];                        max = Math.max(max, x * x + y * y);                    &#125;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> max;    &#125;<span class="hljs-comment">//////////////////////// obsolete ////////////////////////////////</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">findObstacle</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span>[][] obstacles)</span> </span>&#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] ob : obstacles) &#123;            <span class="hljs-keyword">if</span> (ob[<span class="hljs-number">0</span>] == x &amp;&amp; ob[<span class="hljs-number">1</span>] == y) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 455. åˆ†å‘é¥¼å¹²</title>
    <link href="/2020/08/13/LeetCode-455-assign-cookies/"/>
    <url>/2020/08/13/LeetCode-455-assign-cookies/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/assign-cookies/" target="_blank" rel="noopener">455. åˆ†å‘é¥¼å¹²</a></p><p>ä¼˜å…ˆç”¨å°é¥¼å¹²æ»¡è¶³èƒƒå£å°çš„å­©å­</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findContentChildren</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] g, <span class="hljs-keyword">int</span>[] s)</span> </span>&#123;        Arrays.sort(g);        Arrays.sort(s);        <span class="hljs-keyword">int</span> child = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> cookie = <span class="hljs-number">0</span>;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (child &lt; g.length &amp;&amp; cookie &lt; s.length) &#123;            <span class="hljs-comment">// æ»¡è¶³è¦æ±‚ï¼Œæ¢ä¸‹ä¸€ä¸ªå°å­©</span>            <span class="hljs-keyword">if</span> (s[cookie] &gt;= g[child]) &#123;                count++;                child++;            &#125;            <span class="hljs-comment">// ä¸‹ä¸€ä¸ªé¥¼å¹²</span>            cookie++;        &#125;        <span class="hljs-keyword">return</span> count;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II</title>
    <link href="/2020/08/12/LeetCode-122-best-time-to-buy-and-sell-stock-ii/"/>
    <url>/2020/08/12/LeetCode-122-best-time-to-buy-and-sell-stock-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/" target="_blank" rel="noopener">122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II</a></p><h1 id="è´ªå¿ƒ"><a class="markdownIt-Anchor" href="#è´ªå¿ƒ"></a> è´ªå¿ƒ</h1><blockquote><p>è´ªå¿ƒçš„æ€æƒ³åœ¨äºæ¯ä¸€æ­¥ä½œå‡ºçš„å†³ç­–åœ¨ç°åœ¨çœ‹æ¥æ€»æ˜¯æœ€å¥½çš„ï¼Œå®ƒä¸å…³å¿ƒè¿‡å»æˆ–è€…æœªæ¥çš„çŠ¶æ€ã€‚</p></blockquote><p>åªè¦ä»Šå¤©çš„ä»·æ ¼é«˜äºæ˜å¤©å°±è®¡ç®—æ”¶ç›Šï¼šç›¸å½“äºåœ¨ä»Šå¤©åˆ¤æ–­ï¼šæ˜¯å¦ä¹°å…¥æ˜¨å¤©ï¼Œå–å‡ºä»Šå¤©ã€‚è¿™æ ·æ¯ä¸€å¤©éƒ½æœ‰æ”¶ç›Šï¼Œæœ€ç»ˆçš„æ”¶ç›Šå°±æ˜¯æœ€å¤§çš„ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;        <span class="hljs-keyword">int</span> profit = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; prices.length; i++) &#123;            <span class="hljs-keyword">int</span> cur = prices[i] - prices[i - <span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (cur &gt; <span class="hljs-number">0</span>)&#123;                profit += cur;            &#125;        &#125;        <span class="hljs-keyword">return</span> profit;    &#125;</code></pre><h1 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h1><p><strong>1. çŠ¶æ€ <code>dp[i][j]</code></strong>:</p><p>ç¬¬ <code>i</code> å¤©æ‰€èƒ½è·å¾—çš„æœ€å¤§åˆ©æ¶¦ï¼Œ<code>j = 0</code>: ç¬¬ <code>i</code> å¤©æŒæœ‰ç°é‡‘ï¼Œ<code>j = 1</code>: ç¬¬ <code>i</code> å¤©æŒæœ‰è‚¡ç¥¨ã€‚</p><p><strong>2. çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</strong></p><p>æ¯ä¸€å¤©å¯èƒ½æŒæœ‰è‚¡ç¥¨æˆ–ç°é‡‘ã€‚</p><ul><li>è‹¥ç¬¬ <code>i</code> å¤©æŒæœ‰è‚¡ç¥¨ (<code>dp[i][0]</code>)ï¼š<ul><li>ç¬¬ <code>i - 1</code> å¤©æŒæœ‰è‚¡ç¥¨ï¼Œåˆ™ç¬¬ <code>i</code> å¤©æ— æ“ä½œã€‚</li><li>ç¬¬ <code>i - 1</code> å¤©æŒæœ‰ç°é‡‘ï¼Œåˆ™ç¬¬ <code>i</code> å¤©ä¹°å…¥æ–°è‚¡ç¥¨  (<code>+prices[i]</code>)ã€‚</li></ul></li><li>è‹¥ç¬¬ <code>i</code> å¤©æŒæœ‰ç°é‡‘ (<code>dp[i][1]</code>)ï¼š<ul><li>ç¬¬ <code>i - 1</code> å¤©æŒæœ‰è‚¡ç¥¨ï¼Œåˆ™ç¬¬ <code>i</code> å¤©å–å‡º (<code>-prices[i]</code>)ã€‚</li><li>ç¬¬ <code>i - 1</code> å¤©æŒæœ‰ç°é‡‘ï¼Œåˆ™ç¬¬ <code>i</code> å¤©æ— æ“ä½œã€‚</li></ul></li></ul><p><strong>3. ç»“æŸ</strong></p><p>è¾“å‡ºæœ€åä¸€å¤©æŒæœ‰ç°é‡‘ (<code>dp[len - 1][0]</code>)ï¼ŒæŒæœ‰ç°é‡‘çš„æƒ…å†µä¸‹æ‰ä¼šæŠŠä¹‹å‰çš„è‚¡ç¥¨å–å‡ºï¼Œè‹¥æœ€åä¸€å¤©æŒæœ‰è‚¡ç¥¨ï¼Œé‡‘é¢è¿˜ä¼šæ›´å°‘ <code>dp[len - 1][0] &gt; dp[len - 1][1]</code>ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;        <span class="hljs-keyword">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[prices.length][<span class="hljs-number">2</span>];        dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;        dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = -prices[<span class="hljs-number">0</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; prices.length; i++) &#123;            <span class="hljs-comment">// ç¬¬ i å¤©æŒæœ‰ç°é‡‘</span>            dp[i][<span class="hljs-number">0</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] + prices[i]);            <span class="hljs-comment">// ç¬¬ i å¤©æŒæœ‰è‚¡ç¥¨</span>            dp[i][<span class="hljs-number">1</span>] = Math.max(dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - prices[i], dp[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);        &#125;        <span class="hljs-keyword">return</span> dp[prices.length - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>];    &#125;</code></pre><p><strong>çŠ¶æ€å‹ç¼©</strong></p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">maxProfit</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] prices)</span> </span>&#123;        <span class="hljs-comment">// ä»Šå¤©æŒæœ‰ç°é‡‘</span>        <span class="hljs-keyword">int</span> cash = <span class="hljs-number">0</span>;        <span class="hljs-comment">// ä»Šå¤©æŒæœ‰è‚¡ç¥¨</span>        <span class="hljs-keyword">int</span> hold = <span class="hljs-number">0</span>;                <span class="hljs-comment">// æ˜¨å¤©æŒæœ‰ç°é‡‘</span>        <span class="hljs-keyword">int</span> preCash = <span class="hljs-number">0</span>;        <span class="hljs-comment">// æ˜¨å¤©æŒæœ‰è‚¡ç¥¨</span>        <span class="hljs-keyword">int</span> preHold = -prices[<span class="hljs-number">0</span>];                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> price : prices) &#123;            cash = Math.max(preCash, preHold + price);            hold = Math.max(preHold, preCash - price);                        preCash = cash;            preHold = hold;        &#125;        <span class="hljs-keyword">return</span> cash;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 860. æŸ æª¬æ°´æ‰¾é›¶</title>
    <link href="/2020/08/11/LeetCode-860-lemonade-change/"/>
    <url>/2020/08/11/LeetCode-860-lemonade-change/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/lemonade-change/" target="_blank" rel="noopener">860. æŸ æª¬æ°´æ‰¾é›¶</a></p><blockquote><p>ä¸å¸¦é›¶é’±ä½ ä¹°ä»€ä¹ˆæŸ æª¬æ°´ï¼ï¼ï¼</p></blockquote><p>è™½ç„¶æœ‰ç‚¹è´ªå¿ƒçš„æ€æƒ³ï¼Œæˆ‘æ„Ÿè§‰è¿™é¢˜åœ¨æç¬‘ã€‚ã€‚ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">lemonadeChange</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] bills)</span> </span>&#123;        <span class="hljs-keyword">if</span> (bills.length == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-keyword">int</span> five = <span class="hljs-number">0</span>, ten = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> money : bills) &#123;            <span class="hljs-keyword">switch</span> (money) &#123;                <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:                    five++;                    <span class="hljs-keyword">break</span>;                <span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:                    five--;                    ten++;                    <span class="hljs-keyword">break</span>;                <span class="hljs-keyword">case</span> <span class="hljs-number">20</span>:                    <span class="hljs-keyword">if</span> (ten &gt; <span class="hljs-number">0</span>) &#123;                        five--;                        ten--;                    &#125; <span class="hljs-keyword">else</span> &#123;                        five -= <span class="hljs-number">3</span>;                    &#125;                    <span class="hljs-keyword">break</span>;                <span class="hljs-keyword">default</span>:                    <span class="hljs-keyword">break</span>;            &#125;            <span class="hljs-keyword">if</span> (five &lt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>è´ªå¿ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 529. æ‰«é›·æ¸¸æˆ</title>
    <link href="/2020/08/11/LeetCode-529-minesweeper/"/>
    <url>/2020/08/11/LeetCode-529-minesweeper/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minesweeper/" target="_blank" rel="noopener">529. æ‰«é›·æ¸¸æˆ</a></p><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><blockquote><p>æ‰¾å‘¨å›´çš„é›·å’Œè¿›å…¥ä¸‹ä¸€å±‚é€’å½’éƒ½æ˜¯åœ¨ <strong>å…«ä¸ªæ–¹å‘</strong> æ¸¸èµ°ã€‚</p></blockquote><p>å…¸å‹çš„ <code>DFS</code>ã€‚</p><p>è‹¥ <code>click</code> ä½ç½®ä¸º <code>M</code>ï¼Œæ ‡è®°è¿”å›ï¼Œå¦åˆ™è¿›å…¥é€’å½’ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯æ–°çš„ä½ç½®ä¸èƒ½è¶Šç•Œï¼Œä¸”æœªè¢«æ ‡è®°è¿‡ã€‚</p><ol><li>è‹¥å‘¨å›´æœ‰é›·ï¼Œéå†å‘¨å›´çš„å…«ä¸ªä½ç½®ï¼Œæ‰¾åˆ°é›·çš„æ•°é‡ï¼Œæ ‡è®°åè¿”å›</li><li>è‹¥å‘¨å›´æ²¡æœ‰é›·ï¼Œæ ‡è®°ä¸º <code>B</code>ï¼Œéå†å‘¨å›´å…«ä¸ªä½ç½®ï¼Œè¿›å…¥é€’å½’ã€‚</li></ol><pre><code class="hljs java"><span class="hljs-keyword">int</span>[][] dirs = &#123;            <span class="hljs-comment">// ä¸Šï¼š(x - 1, y)</span>            &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,            <span class="hljs-comment">// ä¸‹ï¼š(x + 1, y)</span>            &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,            <span class="hljs-comment">// å·¦ï¼š(x, y - 1)</span>            &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// å³ï¼š(x, y + 1)</span>            &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// å·¦ä¸Šï¼š(x - 1, y - 1)</span>            &#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// å³ä¸Šï¼Œ(x - 1, y + 1)</span>            &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// å·¦ä¸‹ï¼š(x + 1, y - 1)</span>            &#123;<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// å³ä¸‹ï¼š(x + 1, y + 1)</span>            &#123;<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;    &#125;;    <span class="hljs-keyword">boolean</span>[][] used;        <span class="hljs-keyword">public</span> <span class="hljs-keyword">char</span>[][] updateBoard(<span class="hljs-keyword">char</span>[][] board, <span class="hljs-keyword">int</span>[] click) &#123;        <span class="hljs-keyword">if</span> (notInArea(click[<span class="hljs-number">0</span>], click[<span class="hljs-number">1</span>], board)) &#123;            <span class="hljs-keyword">return</span> board;        &#125;        <span class="hljs-keyword">if</span> (board[click[<span class="hljs-number">0</span>]][click[<span class="hljs-number">1</span>]] == <span class="hljs-string">'M'</span>) &#123;            board[click[<span class="hljs-number">0</span>]][click[<span class="hljs-number">1</span>]] = <span class="hljs-string">'X'</span>;            <span class="hljs-keyword">return</span> board;        &#125; <span class="hljs-keyword">else</span> &#123;            used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[board.length][board[<span class="hljs-number">0</span>].length];            dfs(click[<span class="hljs-number">0</span>], click[<span class="hljs-number">1</span>], board);        &#125;        <span class="hljs-keyword">return</span> board;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        used[x][y] = <span class="hljs-keyword">true</span>;        <span class="hljs-keyword">int</span> mineCount = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;            <span class="hljs-keyword">int</span> newX = x + dir[<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> newY = y + dir[<span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (notInArea(newX, newY, board)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">if</span> (board[newX][newY] == <span class="hljs-string">'M'</span>) &#123;                mineCount++;            &#125;        &#125;        <span class="hljs-comment">// æ‰¾åˆ°åœ°é›·è¿”å›ä¸Šä¸€å±‚</span>        <span class="hljs-keyword">if</span> (mineCount &gt; <span class="hljs-number">0</span>) &#123;            board[x][y] = (<span class="hljs-keyword">char</span>) (mineCount + <span class="hljs-string">'0'</span>);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// æœªæ‰¾åˆ°é›·ï¼Œè¿›è¡Œæ ‡è®°ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªä½ç½®</span>        board[x][y] = <span class="hljs-string">'B'</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;            <span class="hljs-keyword">int</span> newX = x + dir[<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> newY = y + dir[<span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (notInArea(newX, newY, board) || used[newX][newY]) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            dfs(newX, newY, board);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">notInArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &lt; <span class="hljs-number">0</span> || x &gt;= board.length                || y &lt; <span class="hljs-number">0</span> || y &gt;= board[<span class="hljs-number">0</span>].length;    &#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-keyword">int</span>[][] dirs = &#123;        <span class="hljs-comment">// ä¸Šï¼š(x - 1, y)</span>        &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,        <span class="hljs-comment">// ä¸‹ï¼š(x + 1, y)</span>        &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,        <span class="hljs-comment">// å·¦ï¼š(x, y - 1)</span>        &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// å³ï¼š(x, y + 1)</span>        &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// å·¦ä¸Šï¼š(x - 1, y - 1)</span>        &#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// å³ä¸Šï¼Œ(x - 1, y + 1)</span>        &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// å·¦ä¸‹ï¼š(x + 1, y - 1)</span>        &#123;<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// å³ä¸‹ï¼š(x + 1, y + 1)</span>        &#123;<span class="hljs-number">1</span>, <span class="hljs-number">1</span>&#125;&#125;;<span class="hljs-keyword">boolean</span>[][] used;<span class="hljs-keyword">public</span> <span class="hljs-keyword">char</span>[][] updateBoard(<span class="hljs-keyword">char</span>[][] board, <span class="hljs-keyword">int</span>[] click) &#123;    <span class="hljs-keyword">if</span> (notInArea(click[<span class="hljs-number">0</span>], click[<span class="hljs-number">1</span>], board)) &#123;        <span class="hljs-keyword">return</span> board;    &#125;    <span class="hljs-keyword">if</span> (board[click[<span class="hljs-number">0</span>]][click[<span class="hljs-number">1</span>]] == <span class="hljs-string">'M'</span>) &#123;        board[click[<span class="hljs-number">0</span>]][click[<span class="hljs-number">1</span>]] = <span class="hljs-string">'X'</span>;        <span class="hljs-keyword">return</span> board;    &#125;    used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[board.length][board[<span class="hljs-number">0</span>].length];    Queue&lt;<span class="hljs-keyword">int</span>[]&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();    queue.add(click);    <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;        <span class="hljs-keyword">int</span>[] cur = queue.poll();        used[cur[<span class="hljs-number">0</span>]][cur[<span class="hljs-number">1</span>]] = <span class="hljs-keyword">true</span>;        <span class="hljs-keyword">int</span> mineCount = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;            <span class="hljs-keyword">int</span> newX = cur[<span class="hljs-number">0</span>] + dir[<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> newY = cur[<span class="hljs-number">1</span>] + dir[<span class="hljs-number">1</span>];            <span class="hljs-keyword">if</span> (notInArea(newX, newY, board)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-keyword">if</span> (board[newX][newY] == <span class="hljs-string">'M'</span>) &#123;                mineCount++;            &#125;        &#125;        <span class="hljs-keyword">if</span> (mineCount &gt; <span class="hljs-number">0</span>) &#123;            board[cur[<span class="hljs-number">0</span>]][cur[<span class="hljs-number">1</span>]] = (<span class="hljs-keyword">char</span>) (mineCount + <span class="hljs-string">'0'</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            board[cur[<span class="hljs-number">0</span>]][cur[<span class="hljs-number">1</span>]] = <span class="hljs-string">'B'</span>;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                <span class="hljs-keyword">int</span> newX = cur[<span class="hljs-number">0</span>] + dir[<span class="hljs-number">0</span>];                <span class="hljs-keyword">int</span> newY = cur[<span class="hljs-number">1</span>] + dir[<span class="hljs-number">1</span>];                <span class="hljs-keyword">if</span> (notInArea(newX, newY, board) || used[newX][newY]) &#123;                    <span class="hljs-keyword">continue</span>;                &#125;                queue.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[]&#123;newX, newY&#125;);                <span class="hljs-comment">// é¿å…è¶…æ—¶</span>                used[newX][newY] = <span class="hljs-keyword">true</span>;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> board;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">notInArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;    <span class="hljs-keyword">return</span> x &lt; <span class="hljs-number">0</span> || x &gt;= board.length            || y &lt; <span class="hljs-number">0</span> || y &gt;= board[<span class="hljs-number">0</span>].length;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 200. å²›å±¿æ•°é‡</title>
    <link href="/2020/08/10/LeetCode-200-number-of-islands/"/>
    <url>/2020/08/10/LeetCode-200-number-of-islands/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/number-of-islands/" target="_blank" rel="noopener">200. å²›å±¿æ•°é‡</a></p><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java"><span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å·²è¢«è®¿é—®çš„æ•°ç»„</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">boolean</span>[][] visited;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * ç§»åŠ¨æ–¹å‘</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">int</span>[][] dir = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[][]&#123;            <span class="hljs-comment">// ä¸Š: (x - 1, y)</span>            &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,            <span class="hljs-comment">// å³: (x, y + 1)</span>            &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;,            <span class="hljs-comment">// ä¸‹: (x + 1, y)</span>            &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,            <span class="hljs-comment">// å·¦: (x, y - 1)</span>            &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;    &#125;;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numIslands</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] grid)</span> </span>&#123;        rows = grid.length;        <span class="hljs-keyword">if</span> (rows &lt; <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        cols = grid[<span class="hljs-number">0</span>].length;        visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows][cols];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-comment">// å½“å‰ä½ç½®æœªè®¿é—®è¿‡ &amp;&amp; æ˜¯é™†åœ°</span>                <span class="hljs-keyword">if</span> (!visited[i][j] &amp;&amp; grid[i][j] == <span class="hljs-string">'1'</span>) &#123;                    <span class="hljs-comment">// åªè¦æœªè®¿é—®è¿‡ä¸”ä¸º 1 è‚¯å®šå­˜åœ¨ä¸€ä¸ªå²›å±¿</span>                    <span class="hljs-comment">// éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªå²›å±¿è¿é€šçš„æ‰€æœ‰ä½ç½®</span>                    count++;                    dfs(grid, i, j);                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> count;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] grid, <span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        visited[x][y] = <span class="hljs-keyword">true</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; dir.length; i++) &#123;            <span class="hljs-keyword">int</span> nextX = x + dir[i][<span class="hljs-number">0</span>];            <span class="hljs-keyword">int</span> nextY = y + dir[i][<span class="hljs-number">1</span>];            <span class="hljs-comment">// æ–°ä½ç½® æœªè¶Šç•Œ &amp;&amp; æœªè®¿é—®è¿‡ &amp;&amp; æ˜¯é™†åœ°</span>            <span class="hljs-keyword">if</span> (inArea(nextX, nextY) &amp;&amp; !visited[nextX][nextY] &amp;&amp; grid[nextX][nextY] == <span class="hljs-string">'1'</span>) &#123;                dfs(grid, nextX, nextY);            &#125;        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;    &#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-keyword">int</span> rows;<span class="hljs-keyword">int</span> cols;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å·²è¢«è®¿é—®çš„æ•°ç»„</span><span class="hljs-comment"> */</span><span class="hljs-keyword">boolean</span>[][] visited;<span class="hljs-comment">/**</span><span class="hljs-comment"> * ç§»åŠ¨æ–¹å‘</span><span class="hljs-comment"> */</span><span class="hljs-keyword">int</span>[][] dir = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[][]&#123;        <span class="hljs-comment">// ä¸Š: (x - 1, y)</span>        &#123;-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,        <span class="hljs-comment">// å³: (x, y + 1)</span>        &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;,        <span class="hljs-comment">// ä¸‹: (x + 1, y)</span>        &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;,        <span class="hljs-comment">// å·¦: (x, y - 1)</span>        &#123;<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>&#125;&#125;;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    <span class="hljs-keyword">int</span> x;    <span class="hljs-keyword">int</span> y;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">this</span>.x = x;        <span class="hljs-keyword">this</span>.y = y;    &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numIslands</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] grid)</span> </span>&#123;    rows = grid.length;    <span class="hljs-keyword">if</span> (rows &lt; <span class="hljs-number">1</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    cols = grid[<span class="hljs-number">0</span>].length;    visited = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[rows][cols];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;            <span class="hljs-comment">// å½“å‰ä½ç½®æœªè®¿é—®è¿‡ &amp;&amp; æ˜¯é™†åœ°</span>            <span class="hljs-keyword">if</span> (!visited[i][j] &amp;&amp; grid[i][j] == <span class="hljs-string">'1'</span>) &#123;                <span class="hljs-comment">// åªè¦æœªè®¿é—®è¿‡ä¸”ä¸º 1 è‚¯å®šå­˜åœ¨ä¸€ä¸ªå²›å±¿</span>                <span class="hljs-comment">// éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªå²›å±¿è¿é€šçš„æ‰€æœ‰ä½ç½®</span>                count++;                Queue&lt;Node&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();                visited[i][j] = <span class="hljs-keyword">true</span>;                queue.offer(<span class="hljs-keyword">new</span> Node(i, j));                <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;                    Node cur = queue.poll();                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; dir.length; k++) &#123;                        <span class="hljs-keyword">int</span> nextX = cur.x + dir[k][<span class="hljs-number">0</span>];                        <span class="hljs-keyword">int</span> nextY = cur.y + dir[k][<span class="hljs-number">1</span>];                        <span class="hljs-comment">// æ–°ä½ç½® æœªè¶Šç•Œ &amp;&amp; æœªè®¿é—®è¿‡ &amp;&amp; æ˜¯é™†åœ°</span>                        <span class="hljs-keyword">if</span> (inArea(nextX, nextY) &amp;&amp; !visited[nextX][nextY] &amp;&amp; grid[nextX][nextY] == <span class="hljs-string">'1'</span>) &#123;                            queue.offer(<span class="hljs-keyword">new</span> Node(nextX, nextY));                            <span class="hljs-comment">// åŠæ—¶æ ‡è®°ï¼Œé¿å…è¶…æ—¶</span>                            visited[nextX][nextY] = <span class="hljs-keyword">true</span>;                        &#125;                    &#125;                &#125;            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;    <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols;&#125;</code></pre><h1 id="å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#å¹¶æŸ¥é›†"></a> å¹¶æŸ¥é›†</h1><p>æŠŠæ‰€æœ‰çš„æ°´è¿æ¥åˆ°æ°´åŸŸç»“ç‚¹ï¼Œè‹¥æ˜¯é™†åœ°å°è¯•ä¸å‘¨å›´ç»“ç‚¹é“¾æ¥ã€‚</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-keyword">int</span> rows;    <span class="hljs-keyword">int</span> cols;    <span class="hljs-keyword">int</span>[][] dirs = &#123;&#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;&#125;;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">numIslands</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] grid)</span> </span>&#123;        rows = grid.length;        <span class="hljs-keyword">if</span> (rows == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        cols = grid[<span class="hljs-number">0</span>].length;        <span class="hljs-keyword">if</span> (cols == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">int</span> len = rows * cols;        UnionFind uf = <span class="hljs-keyword">new</span> UnionFind(len + <span class="hljs-number">1</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) &#123;                <span class="hljs-comment">// å¦‚æœæ˜¯ æ°´ï¼Œè¿æ¥åˆ° dummy ç»“ç‚¹</span>                <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-string">'0'</span>) &#123;                    uf.union(len, getIndex(i, j));                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// å¦‚æœæ˜¯ é™†åœ°ï¼Œå°è¯•è¿æ¥åˆ°å‘¨å›´çš„é™†åœ°</span>                    <span class="hljs-comment">// è¿™é‡Œ dirs åªè¦ å³å’Œä¸‹ä¸¤ä¸ªæ–¹å‘å°±èƒ½éå†åˆ°å‘¨å›´çš„ç»“ç‚¹</span>                    <span class="hljs-comment">// å› ä¸ºåœ¨ä¸Šä¸€æ¬¡éå†æ—¶å·²ç»è®¿é—®è¿‡å·¦å’Œä¸Šæ–¹çš„ç»“ç‚¹</span>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span>[] dir : dirs) &#123;                        <span class="hljs-keyword">int</span> newX = i + dir[<span class="hljs-number">0</span>];                        <span class="hljs-keyword">int</span> newY = j + dir[<span class="hljs-number">1</span>];                        <span class="hljs-keyword">if</span> (inArea(newX, newY) &amp;&amp; grid[newX][newY] == <span class="hljs-string">'1'</span>) &#123;                            uf.union(getIndex(i, j), getIndex(newX, newY));                        &#125;                    &#125;                &#125;            &#125;        &#125;        <span class="hljs-comment">// å‡å»æ°´åŸŸçš„ç»“ç‚¹æ‰æ˜¯æ‰€æœ‰çš„é™†åœ°ç»“ç‚¹</span>        <span class="hljs-keyword">return</span> uf.getCount() - <span class="hljs-number">1</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j)</span> </span>&#123;        <span class="hljs-keyword">return</span> i * cols + j;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">inArea</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;        <span class="hljs-keyword">return</span> x &lt; rows &amp;&amp; y &lt; cols;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
      <tag>å¹¶æŸ¥é›†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 126. å•è¯æ¥é¾™ II</title>
    <link href="/2020/08/09/LeetCode-126-word-ladder-ii/"/>
    <url>/2020/08/09/LeetCode-126-word-ladder-ii/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-ladder-ii/" target="_blank" rel="noopener">126. å•è¯æ¥é¾™ II</a></p><ul><li>æ‰¾çš„æ˜¯æœ€çŸ­è·¯å¾„ï¼Œä¸”å¯èƒ½æœ‰å¤šä¸ª</li><li>ä¸€å¼€å§‹ç”¨çš„ <code>List</code> å­˜æ”¾æ¯å±‚å…ƒç´ ï¼Œç»“æœ å›æº¯çš„æ—¶å€™éš¾ä»¥è®¿é—®ä¸‹ä¸€å±‚ï¼Œæœ€å¥½ç”¨ <code>Map</code> å­˜æ”¾</li><li>ï¼ï¼æœ€çŸ­è·¯å¾„è¦åŠæ—¶å‰ªæ</li><li>ï¼ï¼ä¸èƒ½ç”¨ <code>used</code> æ•°ç»„æ ‡è®°è®¿é—®è¿‡çš„å…ƒç´ ï¼Œè€Œæ˜¯æ ‡è®°å½“å‰å±‚å’Œä»¥ä¸Šå±‚å·²ç»è®¿é—®è¿‡çš„æ•°ç»„ï¼Œå› ä¸ºè‹¥å­˜åœ¨å¤šä¸ªæœ€çŸ­è·¯å¾„ï¼Œå…ƒç´ å¯èƒ½é‡å¤ä½¿ç”¨ï¼Œ<code>used</code> æ•°ç»„æ ‡è®°åä¼šæŠŠä¸‹å±‚çš„å…ƒç´ ä¹Ÿæ ‡è®°ï¼Œä¼šå¯¼è‡´æ¼è§£ã€‚</li></ul><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;String&gt;&gt; findLadders(String beginWord, String endWord, List&lt;String&gt; wordList) &#123;        List&lt;List&lt;String&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">if</span> (!wordList.contains(endWord)) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        <span class="hljs-comment">// boolean[] used = new boolean[wordList.size()];</span>        Queue&lt;String&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.offer(beginWord);        <span class="hljs-comment">// int start = wordList.indexOf(beginWord);</span>        <span class="hljs-comment">// if (start != -1) &#123;</span>        <span class="hljs-comment">//     used[start] = true;</span>        <span class="hljs-comment">// &#125;</span>        <span class="hljs-keyword">boolean</span> found = <span class="hljs-keyword">false</span>;        <span class="hljs-comment">// key: å½“å‰å±‚æ¯ä¸€ä¸ªå•è¯ value: æ¯ä¸ªå•è¯å¯¹åº”çš„ä¸‹ä¸€å±‚æ‰€æœ‰å•è¯</span>        Map&lt;String, HashSet&lt;String&gt;&gt; successors = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();        Set&lt;String&gt; level = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        Set&lt;String&gt; visited = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                String word = queue.poll();                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; wordList.size(); i++) &#123;                    String candidate = wordList.get(i);                    <span class="hljs-comment">// ä¸‹ä¸€å±‚ candidate æœªè¢«ä½¿ç”¨ &amp;&amp; å¯ä»¥æ¥é¾™</span>                    <span class="hljs-keyword">if</span> (!visited.contains(candidate) &amp;&amp; canLadder(word, candidate)) &#123;                        <span class="hljs-comment">// System.out.println(word + " -&gt; " + candidate);</span>                        <span class="hljs-keyword">if</span> (endWord.equals(candidate)) &#123;                            found = <span class="hljs-keyword">true</span>;                        &#125;                        <span class="hljs-keyword">if</span> (!level.contains(candidate))&#123;                            <span class="hljs-comment">// used[i] = true;</span>                            queue.offer(candidate);                            level.add(candidate);                        &#125;                        successors.computeIfAbsent(word, e -&gt; <span class="hljs-keyword">new</span> HashSet&lt;&gt;());                        successors.get(word).add(candidate);                    &#125;                &#125;            &#125;            <span class="hljs-comment">// è‹¥ found ä¸º trueï¼Œè¯´æ˜å·²æ‰¾åˆ° end çš„è·¯å¾„</span>            <span class="hljs-comment">// å¯ä¿è¯ä¸ºæœ€çŸ­è·¯å¾„</span>            <span class="hljs-comment">// ! ç¬¬ä¸€æ¬¡æäº¤æ²¡ AC çš„åŸå› ï¼šå¿˜äº†æ‰¾æœ€çŸ­è·¯å¾„ï¼ŒæŠŠæ‰€æœ‰è·¯å¾„éƒ½æ‰¾å‡ºæ¥äº†</span>            <span class="hljs-keyword">if</span> (found) &#123;                <span class="hljs-keyword">break</span>;            &#125;            System.out.println(level.toString());            visited.addAll(level);            level.clear();        &#125;        System.out.println(successors.toString());        <span class="hljs-comment">// æœªæ‰¾åˆ°ï¼Œè¿”å›ç©ºé›†</span>        <span class="hljs-keyword">if</span> (!found) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        List&lt;String&gt; path = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        path.add(beginWord);        dfs(beginWord, endWord, path, successors, res);        System.out.println(res);        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(String beginWord, String endWord, List&lt;String&gt; path, Map&lt;String, HashSet&lt;String&gt;&gt; successors, List&lt;List&lt;String&gt;&gt; res)</span> </span>&#123;        <span class="hljs-keyword">if</span> (endWord.equals(beginWord)) &#123;            res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(path));            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// ï¼åŠæ—¶å‰ªæï¼Œå¦åˆ™ NPE</span>        <span class="hljs-keyword">if</span> (!successors.containsKey(beginWord)) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// é€‰æ‹©é˜Ÿåˆ—ï¼šæ˜¯å½“å‰ å•è¯ çš„ä¸‹ä¸€å±‚ï¼Œ</span>        <span class="hljs-comment">// æ‰€ä»¥å¦‚æœç”¨ List æ¥ä¿å­˜æ¯ä¸€å±‚çš„è¯ï¼Œè·å–ä¸‹ä¸€å±‚å°±ä¼šæ¯”è¾ƒéº»çƒ¦</span>        HashSet&lt;String&gt; successor = successors.get(beginWord);        <span class="hljs-keyword">for</span> (String word : successor) &#123;            <span class="hljs-keyword">if</span> (path.contains(word)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            path.add(word);            dfs(word, endWord, path, successors, res);            path.remove(word);        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canLadder</span><span class="hljs-params">(String word, String candidate)</span> </span>&#123;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; word.length(); i++) &#123;            <span class="hljs-keyword">if</span> (word.charAt(i) != candidate.charAt(i)) &#123;                <span class="hljs-keyword">if</span> (++count &gt; <span class="hljs-number">1</span>) &#123;                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 127. å•è¯æ¥é¾™</title>
    <link href="/2020/08/08/LeetCode-127-word-ladder/"/>
    <url>/2020/08/08/LeetCode-127-word-ladder/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/word-ladder/" target="_blank" rel="noopener">127. å•è¯æ¥é¾™</a></p><p>å’Œ 433.æœ€å°åŸºå› é‚£é¢˜å¾ˆåƒï¼Œä¸è¿‡æœ¬é¢˜å˜å¼‚çš„å­—æ¯æ˜¯ä¸ç¡®å®šçš„ï¼Œä¸å†æ˜¯ <code>ACGT</code>ï¼Œè‹¥ç”¨å›æº¯ä¼šè¶…æ—¶ã€‚</p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">ladderLength</span><span class="hljs-params">(String beginWord, String endWord, List&lt;String&gt; wordList)</span> </span>&#123;        <span class="hljs-comment">// ! endWord ä¸åœ¨ wordList ä¸­ç›´æ¥è¿”å›</span>        <span class="hljs-keyword">if</span> (!wordList.contains(endWord)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-keyword">boolean</span>[] used = <span class="hljs-keyword">new</span> <span class="hljs-keyword">boolean</span>[wordList.size()];        LinkedList&lt;String&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        <span class="hljs-comment">// å°† beginWord åŠ å…¥é˜Ÿåˆ—ï¼Œæ ‡è®°è®¿é—®æ•°ç»„</span>        queue.offer(beginWord);        <span class="hljs-keyword">int</span> start = wordList.indexOf(beginWord);        <span class="hljs-keyword">if</span> (start != -<span class="hljs-number">1</span>) &#123;            used[start] = <span class="hljs-keyword">true</span>;        &#125;        <span class="hljs-keyword">int</span> step = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            step++;            <span class="hljs-comment">// æ­¤æ—¶é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ ç›¸å½“äºä¸Šä¸€ä¸ª word å¯å‘ä¸‹æ¥é¾™çš„æ‰€æœ‰é€‰æ‹©</span>            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                String word = queue.poll();                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; wordList.size(); i++) &#123;                    String candidate = wordList.get(i);                    <span class="hljs-comment">// è‹¥å·²ç»è®¿é—®è¿‡ || word æ— æ³•æ¥é¾™åˆ° candidateï¼Œåˆ™è·³è¿‡ </span>                    <span class="hljs-keyword">if</span> (used[i] || !canLadder(word, candidate)) &#123;                        <span class="hljs-keyword">continue</span>;                    &#125;                    <span class="hljs-comment">// candidate åˆ°è¾¾ endï¼Œè¿”å›</span>                    <span class="hljs-keyword">if</span> (endWord.equals(candidate)) &#123;                        <span class="hljs-keyword">return</span> step + <span class="hljs-number">1</span>;                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-comment">// æ ‡è®°è®¿é—®æ•°ç»„ï¼Œå°† candidate åŠ å…¥é˜Ÿåˆ—</span>                        used[i] = <span class="hljs-keyword">true</span>;                        queue.offer(candidate);                    &#125;                &#125;            &#125;        &#125;        <span class="hljs-comment">// ï¼ï¼ï¼è¿”å› 0ï¼Œä¸æ˜¯ step</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canLadder</span><span class="hljs-params">(String word, String candidate)</span> </span>&#123;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; candidate.length(); i++) &#123;            <span class="hljs-keyword">if</span> (word.charAt(i) != candidate.charAt(i)) &#123;                <span class="hljs-keyword">if</span> (++count &gt; <span class="hljs-number">1</span>) &#123;                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;</code></pre><h1 id="åŒå‘-bfs"><a class="markdownIt-Anchor" href="#åŒå‘-bfs"></a> åŒå‘ BFS</h1><p>é‡‡ç”¨å·¦å³ä¸¤ä¸ªæ‰©æ•£é›†åˆï¼Œå½“é›†åˆé‡å¤å³è¡¨ç¤ºæ‰©æ•£ç»“æŸã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">ladderLength</span><span class="hljs-params">(String beginWord, String endWord, List&lt;String&gt; wordList)</span> </span>&#123;        <span class="hljs-comment">// ä¸ç”¨ set ç«Ÿç„¶è¶…æ—¶äº†ï¼</span>        Set&lt;String&gt; wordSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(wordList);        <span class="hljs-keyword">if</span> (!wordSet.contains(endWord)) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        &#125;        <span class="hljs-comment">// æ ‡è®°å·²è®¿é—®è¿‡çš„å…ƒç´ </span>        Set&lt;String&gt; used = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        <span class="hljs-comment">// å·¦è¾¹æ‰©æ•£é›†åˆï¼Œæ¯æ¬¡éƒ½å‡è®¾è¯¥é›†åˆå…ƒç´ æœ€å°‘ï¼Œåˆ™æ‰©æ•£é€Ÿåº¦æ›´å¿«</span>        Set&lt;String&gt; beginSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        beginSet.add(beginWord);        <span class="hljs-comment">// å³è¾¹æ‰©æ•£é›†åˆ</span>        Set&lt;String&gt; endSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        endSet.add(endWord);        <span class="hljs-keyword">int</span> step = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (!beginSet.isEmpty() &amp;&amp; !endSet.isEmpty()) &#123;            step++;            <span class="hljs-comment">// ä½¿ beginSet çš„å…ƒç´ æœ€å°‘</span>            <span class="hljs-keyword">if</span> (beginSet.size() &gt; endSet.size()) &#123;                Set&lt;String&gt; tmp = beginSet;                beginSet = endSet;                endSet = tmp;            &#125;            <span class="hljs-comment">// ä¸‹ä¸€å±‚æ‰©æ•£çš„é›†åˆ</span>            Set&lt;String&gt; nextLevel = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();            <span class="hljs-keyword">for</span> (String word : beginSet) &#123;                <span class="hljs-keyword">char</span>[] words = word.toCharArray();                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; words.length; i++) &#123;                    <span class="hljs-keyword">char</span> old = words[i];                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c = <span class="hljs-string">'a'</span>; c &lt;= <span class="hljs-string">'z'</span>; c++) &#123;                        <span class="hljs-keyword">if</span> (old == c) &#123;                            <span class="hljs-keyword">continue</span>;                        &#125;                        words[i] = c;                        String nextWord = String.valueOf(words);                        <span class="hljs-comment">// æ–°å…ƒç´ å¿…é¡»å­˜åœ¨äºæä¾›çš„ list ä¸­</span>                        <span class="hljs-keyword">if</span> (wordSet.contains(nextWord)) &#123;                            <span class="hljs-comment">// å³è¾¹é›†åˆåŒ…å«è¯¥å…ƒç´ ï¼Œè¯´æ˜æ‰©æ•£é‡å¤ï¼Œç›´æ¥è¿”å›</span>                            <span class="hljs-keyword">if</span> (endSet.contains(nextWord)) &#123;                                <span class="hljs-keyword">return</span> step + <span class="hljs-number">1</span>;                            &#125;                            <span class="hljs-comment">// åŠ å…¥ä¸‹ä¸€å±‚æ‰©æ•£é›†åˆ</span>                            <span class="hljs-keyword">if</span> (!used.contains(nextWord)) &#123;                                nextLevel.add(nextWord);                                <span class="hljs-comment">// æ ‡è®°å·²è®¿é—®</span>                                used.add(nextWord);                            &#125;                        &#125;                    &#125;                    words[i] = old;                &#125;            &#125;            <span class="hljs-comment">// è®¾ç½®ä¸‹ä¸€å±‚çš„æ‰©æ•£é›†åˆ</span>            beginSet = nextLevel;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 515. åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼</title>
    <link href="/2020/08/07/LeetCode-515-find-largest-value-in-each-tree-row/"/>
    <url>/2020/08/07/LeetCode-515-find-largest-value-in-each-tree-row/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/find-largest-value-in-each-tree-row/" target="_blank" rel="noopener">515. åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼</a></p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><p>å±‚æ¬¡éå†</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">largestValues</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;        List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        LinkedList&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.add(root);        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            <span class="hljs-keyword">int</span> max = Integer.MIN_VALUE;            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                TreeNode p = queue.poll();                max = Math.max(p.val, max);                <span class="hljs-keyword">if</span> (p.left != <span class="hljs-keyword">null</span>) &#123;                    queue.offer(p.left);                &#125;                <span class="hljs-keyword">if</span> (p.right != <span class="hljs-keyword">null</span>) &#123;                    queue.offer(p.right);                &#125;            &#125;            res.add(max);        &#125;        <span class="hljs-keyword">return</span> res;    &#125;</code></pre><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><p>åˆ¤æ–­æ˜¯å¦åˆ°äº†æ–°çš„ä¸€å±‚ï¼š<code>res</code> ä¸­ä¿å­˜çš„æ˜¯æ¯ä¸€å±‚çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥ <code>res.size()</code> ç­‰äºéå†è¿‡çš„å±‚æ•°ï¼Œè‹¥ <code>res.size() &lt; level</code> è¡¨ç¤ºåˆ°äº†æ–°å±‚ã€‚</p><pre><code class="hljs java">List&lt;Integer&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title">largestValues</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;        <span class="hljs-keyword">if</span> (root != <span class="hljs-keyword">null</span>) &#123;            dfs(root, <span class="hljs-number">1</span>);        &#125;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> level)</span> </span>&#123;        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// éå†åˆ°äº†ä¸‹ä¸€å±‚ï¼Œæ·»åŠ æ–°å…ƒç´ </span>        <span class="hljs-keyword">if</span> (res.size() &lt; level) &#123;            res.add(root.val);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// è®¡ç®—å½“å‰å±‚çš„æœ€å¤§å€¼</span>            <span class="hljs-keyword">int</span> levelMax = Math.max(root.val, res.get(level - <span class="hljs-number">1</span>));            res.set(level - <span class="hljs-number">1</span>, levelMax);        &#125;        dfs(root.left, level + <span class="hljs-number">1</span>);        dfs(root.right, level + <span class="hljs-number">1</span>);    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 22. æ‹¬å·ç”Ÿæˆ</title>
    <link href="/2020/08/07/LeetCode-22-generate-parentheses/"/>
    <url>/2020/08/07/LeetCode-22-generate-parentheses/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/generate-parentheses/submissions/" target="_blank" rel="noopener">22. æ‹¬å·ç”Ÿæˆ</a></p><h1 id="å›æº¯"><a class="markdownIt-Anchor" href="#å›æº¯"></a> å›æº¯</h1><pre><code class="hljs java">List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">generateParenthesis</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        backtrack(n, n, <span class="hljs-string">""</span>);        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * è·¯å¾„ï¼šç”Ÿæˆçš„æ‹¬å·å­—ç¬¦ä¸²</span><span class="hljs-comment">     * é€‰æ‹©åˆ—è¡¨ï¼šè·¯å¾„ä¸­å¯æ”¾ç½®çš„å·¦å³æ‹¬å·æ•°é‡</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> left  å·¦æ‹¬å·å‰©ä½™æ•°é‡</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> right å³æ‹¬å·å‰©ä½™æ•°é‡</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> path  è·¯å¾„</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right, String path)</span> </span>&#123;        <span class="hljs-comment">// å·¦æ‹¬å·å‰©ä½™ &gt; å³æ‹¬å·å‰©ä½™ï¼šå‰ªæ</span>        <span class="hljs-comment">// e.g. )</span>        <span class="hljs-keyword">if</span> (left &gt; right) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">if</span> (left == <span class="hljs-number">0</span> &amp;&amp; right == <span class="hljs-number">0</span>) &#123;            res.add(path);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// å·¦è¾¹å¯æ”¾ç½®å·¦æ‹¬å·</span>        <span class="hljs-comment">// e.g. ()</span>        <span class="hljs-keyword">if</span> (left &gt; <span class="hljs-number">0</span>) &#123;            backtrack(left - <span class="hljs-number">1</span>, right, path + <span class="hljs-string">"("</span>);        &#125;        <span class="hljs-comment">// å·¦æ‹¬å·å‰©ä½™ &lt; å³æ‹¬å·å‰©ä½™ï¼šå³è¾¹å¯æ”¾ç½®å³æ‹¬å·</span>        <span class="hljs-comment">// e.g. ((, (</span>        <span class="hljs-keyword">if</span> (left &lt; right) &#123;            backtrack(left, right - <span class="hljs-number">1</span>, path + <span class="hljs-string">")"</span>);        &#125;    &#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    String path;    <span class="hljs-keyword">int</span> left;    <span class="hljs-keyword">int</span> right;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> path  å½“å‰ç»“ç‚¹äº§ç”Ÿçš„è·¯å¾„</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> left  å·¦è¾¹å‰©ä½™æ‹¬å·</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> right å³è¾¹å‰©ä½™æ‹¬å·</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(String path, <span class="hljs-keyword">int</span> left, <span class="hljs-keyword">int</span> right)</span> </span>&#123;        <span class="hljs-keyword">this</span>.path = path;        <span class="hljs-keyword">this</span>.left = left;        <span class="hljs-keyword">this</span>.right = right;    &#125;&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">generateParenthesis</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;        List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">1</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        LinkedList&lt;Node&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.offer(<span class="hljs-keyword">new</span> Node(<span class="hljs-string">""</span>, n, n));        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            Node q = queue.poll();            <span class="hljs-comment">// å·¦å³æ‹¬å·å‡å·²ç”¨å®Œ</span>            <span class="hljs-keyword">if</span> (q.left == <span class="hljs-number">0</span> &amp;&amp; q.right == <span class="hljs-number">0</span>) &#123;                res.add(q.path);            &#125;            <span class="hljs-comment">// å·¦æ‹¬å·å‰©ä½™</span>            <span class="hljs-keyword">if</span> (q.left &gt; <span class="hljs-number">0</span>) &#123;                queue.offer(<span class="hljs-keyword">new</span> Node(q.path + <span class="hljs-string">"("</span>, q.left - <span class="hljs-number">1</span>, q.right));            &#125;            <span class="hljs-comment">// å³æ‹¬å·å‰©ä½™</span>            <span class="hljs-keyword">if</span> (q.right &gt; <span class="hljs-number">0</span> &amp;&amp; q.right &gt; q.left) &#123;                queue.offer(<span class="hljs-keyword">new</span> Node(q.path + <span class="hljs-string">")"</span>, q.left, q.right - <span class="hljs-number">1</span>));            &#125;        &#125;        <span class="hljs-keyword">return</span> res;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>DFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB ç´¢å¼•</title>
    <link href="/2020/08/07/InnoDB-index/"/>
    <url>/2020/08/07/InnoDB-index/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a class="markdownIt-Anchor" href="#ä»‹ç»"></a> ä»‹ç»</h1><h2 id="b-æ ‘"><a class="markdownIt-Anchor" href="#b-æ ‘"></a> <code>B+</code> æ ‘</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200807153046.png" srcset="/img/loading.gif" alt="" /></p><blockquote><p>ğŸ™ƒåˆæ˜¯è€ƒç ”å†…å®¹ã€‚</p></blockquote><p>ä¸€æ£µ <code>m</code> é˜¶ <code>B+</code> æ ‘éœ€æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š</p><ul><li>æ¯ä¸ªåˆ†æ”¯ç»“ç‚¹æœ€å¤šæœ‰ <code>m</code> æ£µå­æ ‘ï¼ˆå­ç»“ç‚¹ï¼‰ã€‚</li><li>éå¶æ ¹ç»“ç‚¹è‡³å°‘æœ‰ä¸¤æ£µå­æ ‘ï¼Œå…¶ä»–æ¯ä¸ªåˆ†æ”¯ç»“ç‚¹è‡³å°‘æœ‰ <code>âŒˆm / 2âŒ‰</code> æ£µå­æ ‘ã€‚</li><li><strong>ç»“ç‚¹çš„å­æ ‘ä¸ªæ•°ä¸å…³é”®å­—ä¸ªæ•°ç›¸ç­‰</strong>ã€‚</li><li>æ‰€æœ‰å¶å­ç»“ç‚¹åŒ…å«<strong>å…¨éƒ¨å…³é”®å­—</strong>åŠæŒ‡å‘ç›¸åº”è®°å½•çš„<strong>æŒ‡é’ˆ</strong>ï¼Œå¶å­ç»“ç‚¹ä¸­å…³é”®å­—æŒ‰å¤§å°æ’åºï¼Œç›¸é‚»å¶ç»“ç‚¹æŒ‰å¤§å°é¡ºåº<strong>ç›¸äº’é“¾æ¥</strong>èµ·æ¥ã€‚</li><li>æ‰€æœ‰åˆ†æ”¯ç»“ç‚¹ä¸­ä»…åŒ…å«å®ƒçš„å„ä¸ªå­ç»“ç‚¹ä¸­<strong>å…³é”®å­—çš„æœ€å¤§å€¼</strong>åŠæŒ‡å‘å…¶å­ç»“ç‚¹çš„<strong>æŒ‡é’ˆ</strong>ã€‚</li></ul><p><code>m</code> é˜¶ <code>B+</code> æ ‘ä¸ <code>m</code> é˜¶ <code>B</code> æ ‘çš„åŒºåˆ«ï¼š</p><ol><li><strong>å­æ ‘å’Œç»“ç‚¹çš„å…³ç³»ï¼š</strong><br /><code>B+</code> æ ‘ <code>n</code> ä¸ªå…³é”®å­—çš„ç»“ç‚¹åªå«æœ‰ <code>n</code> æ£µå­æ ‘ï¼Œ<strong>å³æ¯ä¸ªå…³é”®å­—å¯¹åº”ä¸€æ£µå­æ ‘</strong>ï¼›<br /><code>B</code> æ ‘ <code>n</code> ä¸ªå…³é”®å­—çš„ç»“ç‚¹å«æœ‰ <code>n + 1</code> æ£µå­æ ‘ã€‚</li><li><strong>ç»“ç‚¹å…³é”®å­—ä¸ªæ•°</strong><br /><code>B+</code> æ ‘éæ ¹ç»“ç‚¹å…³é”®å­—ä¸ªæ•°ï¼š<code>âŒˆm / 2âŒ‰ &lt;= n &lt;= m</code>ï¼Œæ ¹ç»“ç‚¹ï¼š<code>1 &lt;= n &lt;= m</code>ï¼›<br /><code>B</code> æ ‘éæ ¹ç»“ç‚¹å…³é”®å­—ä¸ªæ•°ï¼š<code>âŒˆm / 2âŒ‰ - 1 &lt;= n &lt;= m - 1</code>ï¼Œæ ¹ç»“ç‚¹ï¼š<code>1 &lt;= n &lt;= m - 1</code></li><li><strong>å¶å­ç»“ç‚¹å’Œéå¶ç»“ç‚¹</strong><br /><code>B+</code> æ ‘å¶ç»“ç‚¹åŒ…å«ä¿¡æ¯ï¼Œæ‰€æœ‰<strong>éå¶ç»“ç‚¹ä»…èµ·åˆ°ç´¢å¼•ä½œç”¨</strong>ï¼Œéå¶ç»“ç‚¹ä¸­çš„æ¯ä¸ªç´¢å¼•é¡¹å€¼å«æœ‰å­æ ‘æœ€å¤§å…³é”®å­—å’ŒæŒ‡å‘å­æ ‘çš„æŒ‡é’ˆï¼Œ<strong>ä¸å«è¯¥å…³é”®å­—çš„å­˜å‚¨åœ°å€</strong>ã€‚</li><li><strong>å…³é”®å­—é‡å¤æ€§</strong><br /><code>B+</code> æ ‘ä¸­å¶ç»“ç‚¹åŒ…å«å…¨éƒ¨å…³é”®å­—ï¼Œ<strong>å³å…³é”®å­—ä¼šå’Œéå¶ç»“ç‚¹é‡å¤</strong>ï¼›<br /><code>B</code> æ ‘ä¸­å¶ç»“ç‚¹åŒ…å«çš„å…³é”®å­—å’Œå…¶ä»–ç»“ç‚¹åŒ…å«çš„å…³é”®å­—æ˜¯<strong>ä¸é‡å¤</strong>çš„ã€‚</li><li><strong>æŸ¥æ‰¾è¿‡ç¨‹</strong><br /><code>B+</code> æ ‘æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œå¦‚æœéå¶ç»“ç‚¹ä¸Šçš„å…³é”®å­—ç­‰äºç»™å®šå€¼æ—¶å¹¶ä¸ç»ˆæ­¢ï¼Œè€Œæ˜¯ç»§ç»­å‘ä¸‹æŸ¥æ‰¾ç›´åˆ°å¶ç»“ç‚¹ä¸ºæ­¢ã€‚æ¯æ¬¡æŸ¥æ‰¾éƒ½æ˜¯ä¸€æ¡ä»æ ¹èŠ‚ç‚¹åˆ°å¶ç»“ç‚¹çš„è·¯å¾„ã€‚</li></ol><h2 id="ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#ä¼˜ç‚¹"></a> ä¼˜ç‚¹</h2><p><code>B+</code> æ ‘ç´¢å¼•æŒ‰ç…§é¡ºåºå­˜å‚¨ï¼Œå¯ä»¥ç”¨æ¥åš <code>ORDER BY</code> å’Œ <code>GROUP</code> æ“ä½œã€‚<br />å› ä¸ºç´¢å¼•ä¸­å­˜å‚¨äº†å®é™…çš„åˆ—å€¼ï¼Œè¦†ç›–ç´¢å¼•åªéœ€è¦ä½¿ç”¨ç´¢å¼•å°±èƒ½å®ŒæˆæŸ¥è¯¢ã€‚</p><ul><li>ç´¢å¼•å¤§å¤§å‡å°‘äº†æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®é‡ã€‚</li><li>ç´¢å¼•å¯ä»¥å¸®åŠ©æœåŠ¡å™¨é¿å…æ’åºå’Œä¸´æ—¶è¡¨ã€‚</li><li>ç´¢å¼•å¯ä»¥å°†éšæœº <code>IO</code> å˜ä¸ºé¡ºåº <code>IO</code>ã€‚</li></ul><h2 id="ä¸ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µ"><a class="markdownIt-Anchor" href="#ä¸ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µ"></a> ä¸ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µ</h2><p>åœ¨èŒƒå›´æŸ¥æ‰¾ã€<code>JOIN</code> é“¾æ¥æ“ä½œç­‰æƒ…å†µä¸‹ï¼Œä¼˜åŒ–å™¨ç›´æ¥è¿›è¡Œå…¨è¡¨çš„æ‰«ææ¥å¾—åˆ°æ•°æ®ã€‚<br />å½“ç”¨æˆ·è¦é€‰å–çš„æ•°æ®æ˜¯æ•´è¡Œä¿¡æ¯ï¼Œè€Œç´¢å¼•ä¸èƒ½è¦†ç›–åˆ°è¦æŸ¥è¯¢çš„ä¿¡æ¯ï¼Œåœ¨é€šè¿‡ç´¢å¼•æŸ¥åˆ°æŒ‡å®šæ•°æ®åï¼Œè¿˜è¦ä¸€æ¬¡ä¹¦ç­¾è®¿é—®æ¥æŸ¥æ‰¾æ•´è¡Œçš„ä¿¡æ¯ã€‚</p><p>å¯ä½¿ç”¨å…³é”®å­— <code>FORCE INDEX</code> æ¥å¼ºåˆ¶ä½¿ç”¨æŸä¸ªç´¢å¼•ã€‚</p><ul><li>è¡¨è®°å½•å¤ªå°‘</li><li>ç»å¸¸å¢åˆ æ”¹çš„è¡¨</li><li>æ•°æ®é‡å¤ä¸”åˆ†å¸ƒå‡åŒ€çš„è¡¨å­—æ®µï¼Œåªåº”è¯¥ä¸ºæœ€ç»å¸¸æŸ¥è¯¢å’Œæœ€ç»å¸¸æ’åºçš„æ•°æ®åˆ—å»ºç«‹ç´¢å¼•ï¼ˆå¦‚æœæŸä¸ªæ•°æ®ç±»åŒ…å«å¤ªå¤šçš„é‡å¤æ•°æ®ï¼Œå»ºç«‹ç´¢å¼•æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼‰</li><li><strong>é¢‘ç¹æ›´æ–°</strong>çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼ˆä¼šåŠ é‡ <code>IO</code> è´Ÿæ‹…ï¼‰</li><li><code>where</code> æ¡ä»¶é‡Œç”¨ä¸åˆ°çš„å­—æ®µä¸åˆ›å»ºç´¢å¼•</li></ul><h2 id="éœ€è¦åˆ›å»ºç´¢å¼•çš„æƒ…å†µ"><a class="markdownIt-Anchor" href="#éœ€è¦åˆ›å»ºç´¢å¼•çš„æƒ…å†µ"></a> éœ€è¦åˆ›å»ºç´¢å¼•çš„æƒ…å†µ</h2><ul><li>ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•</li><li>é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µ</li><li>æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»å»ºç«‹ç´¢å¼•</li><li>å•é”®/ç»„åˆç´¢å¼•çš„é€‰æ‹©é—®é¢˜ï¼Œé«˜å¹¶å‘ä¸‹å€¾å‘åˆ›å»ºç»„åˆç´¢å¼•</li><li>æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºå­—æ®µé€šè¿‡ç´¢å¼•è®¿é—®å¤§å¹…æé«˜æ’åºé€Ÿåº¦</li><li>æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–åˆ†ç»„å­—æ®µ</li></ul><h1 id="ç´¢å¼•ç±»å‹"><a class="markdownIt-Anchor" href="#ç´¢å¼•ç±»å‹"></a> ç´¢å¼•ç±»å‹</h1><blockquote><p><code>InnoDB</code> çš„ç´¢å¼•æ˜¯è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œä½¿ç”¨ <code>B+</code> æ ‘ç´¢å¼•ã€‚<br /><code>B+</code> æ ‘ç´¢å¼•å¹¶ä¸èƒ½æ‰¾åˆ°ä¸€ä¸ªç»™å®šé”®å€¼çš„å…·ä½“è¡Œï¼Œå®ƒåªèƒ½æ‰¾åˆ°è¢«æŸ¥æ‰¾æ•°æ®è¡Œæ‰€åœ¨çš„é¡µï¼Œç„¶åé€šè¿‡æŠŠé¡µè¯»å…¥å†…å­˜ï¼Œåœ¨å†…å­˜ä¸­æŸ¥æ‰¾æƒ³è¦çš„æ•°æ®ã€‚</p></blockquote><h2 id="1-b-æ ‘ç´¢å¼•"><a class="markdownIt-Anchor" href="#1-b-æ ‘ç´¢å¼•"></a> 1. <code>B+</code> æ ‘ç´¢å¼•</h2><p><code>B+</code> æ ‘ç´¢å¼•èƒ½å¤ŸåŠ å¿«è®¿é—®æ•°æ®çš„é€Ÿåº¦ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“<strong>ä¸å†éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æ</strong>æ¥è·å–æ•°æ®ï¼Œè€Œæ˜¯ä»ç´¢å¼•çš„æ ¹èŠ‚ç‚¹å¼€å§‹è¿›è¡Œæœç´¢ã€‚</p><ul><li>æ ¹èŠ‚ç‚¹å­˜æ”¾äº†<strong>æŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆ</strong>ï¼Œå­˜å‚¨å¼•æ“æ ¹æ®è¿™äº›æŒ‡é’ˆå‘ä¸‹å±‚æŸ¥æ‰¾ï¼Œé€šè¿‡æ¯”è¾ƒèŠ‚ç‚¹é¡µçš„å€¼å’Œè¦æŸ¥æ‰¾çš„å€¼å¯ä»¥æ‰¾åˆ°åˆé€‚çš„æŒ‡é’ˆè¿›å…¥ä¸‹å±‚å­èŠ‚ç‚¹ã€‚</li><li>å¶å­èŠ‚ç‚¹æŒ‡å‘çš„æ˜¯<strong>è¢«ç´¢å¼•çš„æ•°æ®</strong>ï¼Œè€Œä¸æ˜¯å…¶ä»–çš„èŠ‚ç‚¹é¡µã€‚</li></ul><p>ç´¢å¼•åˆ—æ˜¯æŒ‰<strong>é¡ºåºç»„ç»‡</strong>å­˜å‚¨çš„ï¼Œæ‰€ä»¥å¾ˆé€‚åˆæŸ¥æ‰¾èŒƒå›´æ•°æ®ï¼Œå¤šä¸ªå€¼è¿›è¡Œæ’åºçš„ä¾æ®æ˜¯ <code>CREATE TABLE</code> è¯­å¥ä¸­å®šä¹‰ç´¢å¼•æ—¶åˆ—çš„é¡ºåºã€‚</p><h3 id="é™åˆ¶"><a class="markdownIt-Anchor" href="#é™åˆ¶"></a> é™åˆ¶</h3><ul><li><strong>å¦‚æœä¸æ˜¯æŒ‰ç…§ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹æŸ¥æ‰¾ï¼Œåˆ™æ— æ³•ä½¿ç”¨ç´¢å¼•</strong>ã€‚å¦‚ <code>key(last_name,first_name, dob)</code> æ— æ³•ç”¨äºæŸ¥æ‰¾ç‰¹å®šçš„ <code>first_name</code> å’Œ <code>dob</code>ã€‚</li><li><strong>ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—</strong>ã€‚å¦‚ä¸èƒ½æŸ¥æ‰¾ <code>last_name</code> å’Œ <code>dob</code> ä¸ºç‰¹å®šå€¼çš„è®°å½•ã€‚å¦‚æœä¸æŒ‡å®š <code>first_name</code>ï¼Œåˆ™åªèƒ½ä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚</li><li>å¦‚æœæŸ¥è¯¢ä¸­æœ‰æŸä¸ªåˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™å…¶å³è¾¹æ‰€æœ‰åˆ—éƒ½æ— æ³•ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥æ‰¾ã€‚</li></ul><h3 id="èšé›†ç´¢å¼•"><a class="markdownIt-Anchor" href="#èšé›†ç´¢å¼•"></a> èšé›†ç´¢å¼•</h3><p>èšé›†ç´¢å¼•æŒ‰ç…§æ¯å¼ è¡¨çš„ä¸»é”®æ„é€ ä¸€æ£µ <code>B+</code> æ ‘ï¼Œå¶å­ç»“ç‚¹ä¸­å­˜æ”¾çš„ä¸ºæ•´å¼ è¡¨çš„è¡Œè®°å½•æ•°æ®ï¼Œå¶å­ç»“ç‚¹ä¹Ÿç§°ä¸ºæ•°æ®é¡µã€‚<strong>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚</strong> å®ƒå¯¹äºä¸»é”®çš„æ’åºæŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥æ‰¾éå¸¸å¿«ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200811143800.png" srcset="/img/loading.gif" alt="" /><br />èšé›†ç´¢å¼•çš„å­˜å‚¨å¹¶ä¸æ˜¯ç‰©ç†ä¸Šè¿ç»­çš„ï¼ˆç»´æŠ¤æˆæœ¬é«˜ï¼‰ï¼Œè€Œæ˜¯<strong>é€»è¾‘ä¸Šè¿ç»­</strong>çš„ã€‚</p><ul><li>é¡µé€šè¿‡åŒå‘é“¾è¡¨é“¾æ¥ï¼Œé¡µæŒ‰ç…§ä¸»é”®çš„é¡ºåºæ’åºã€‚<br />å¦‚æœæ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œ<code>InnoDB</code> ä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä»£æ›¿ã€‚<br />å¦‚æœæ²¡æœ‰è¿™æ ·çš„ä¸»é”®ï¼Œ<code>InnoDB</code> ä¼šéšå¼å®šä¹‰ä¸€ä¸ªä¸»é”®æ¥ä½œä¸ºèšé›†ç´¢å¼•ã€‚</li><li>é¡µä¸­çš„è®°å½•é€šè¿‡åŒå‘é“¾è¡¨é“¾æ¥ï¼Œç‰©ç†å­˜å‚¨ä¸Šä¹Ÿå¯ä»¥ä¸æŒ‰ç…§ä¸»é”®å­˜å‚¨ã€‚</li></ul><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¯ä»¥æŠŠç›¸å…³æ•°æ®ä¿å­˜åœ¨ä¸€èµ·ï¼Œå‡å°‘ç£ç›˜ <code>IO</code>ã€‚</li><li>æ•°æ®è®¿é—®æ›´å¿«ã€‚ç´¢å¼•å’Œæ•°æ®éƒ½åœ¨åŒä¸€ä¸ª <code>B+</code> æ ‘ä¸­ã€‚</li><li>ä½¿ç”¨è¦†ç›–ç´¢å¼•æ‰«æçš„æŸ¥è¯¢å¯ä»¥ç›´æ¥ä½¿ç”¨é¡µèŠ‚ç‚¹ä¸­çš„ä¸»é”®å€¼ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ’å…¥é€Ÿåº¦ä¸¥é‡ä¾èµ–äºæ’å…¥é¡ºåºã€‚æŒ‰ç…§ä¸»é”®çš„é¡ºåºæ’å…¥æ˜¯åŠ è½½æ•°æ®åˆ° <code>InnoDB</code> è¡¨ä¸­é€Ÿåº¦æœ€å¿«çš„æ–¹å¼ã€‚</li><li>æ›´æ–°èšé›†ç´¢å¼•åˆ—çš„ä»£ä»·å¾ˆé«˜ï¼Œå› ä¸ºä¼šå¼ºåˆ¶ <code>InnoDB</code> å°†æ¯ä¸ªè¢«æ›´æ–°çš„è¡Œç§»åŠ¨åˆ°æ–°çš„ä½ç½®ã€‚</li><li>å¯èƒ½å¯¼è‡´å…¨è¡¨æ‰«æå˜æ…¢ï¼Œå°¤å…¶æ˜¯è¡Œæ¯”è¾ƒç¨€ç–ï¼Œæˆ–è€…ç”±äºé¡µåˆ†è£‚å¯¼è‡´æ•°æ®å­˜å‚¨ä¸è¿ç»­çš„æ—¶å€™ã€‚</li><li>äºŒçº§ç´¢å¼•ï¼ˆéèšé›†ç´¢å¼•ï¼‰å¯èƒ½å¾ˆå¤§ï¼Œå› ä¸ºäºŒçº§ç´¢å¼•çš„å¶å­ç»“ç‚¹åŒ…å«äº†å¼•ç”¨è¡Œçš„ä¸»é”®åˆ—ã€‚</li><li>äºŒçº§ç´¢å¼•éœ€è¦ä¸¤æ¬¡ç´¢å¼•æŸ¥æ‰¾ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡ã€‚</li></ul><h3 id="è¾…åŠ©ç´¢å¼•éèšé›†ç´¢å¼•"><a class="markdownIt-Anchor" href="#è¾…åŠ©ç´¢å¼•éèšé›†ç´¢å¼•"></a> è¾…åŠ©ç´¢å¼•ï¼ˆéèšé›†ç´¢å¼•ï¼‰</h3><p>è¾…åŠ©ç´¢å¼•ä¸­ï¼Œå¶å­ç»“ç‚¹å¹¶ä¸åŒ…å«è¡Œè®°å½•çš„å…¨éƒ¨æ•°æ®ã€‚å¶å­ç»“ç‚¹é™¤äº†åŒ…å«é”®å€¼ä»¥å¤–ï¼Œæ¯ä¸ªå¶å­ç»“ç‚¹ä¸­çš„ç´¢å¼•è¡Œè¿˜åŒ…å«äº†ä¸€ä¸ªä¹¦ç­¾ï¼Œè¯¥ä¹¦ç­¾ç”¨æ¥å‘Šè¯‰ <code>InnoDB</code> å“ªé‡Œå¯ä»¥æ‰¾åˆ°ä¸ç´¢å¼•ç›¸å¯¹åº”çš„è¡Œæ•°æ®ã€‚</p><p>è¾…åŠ©ç´¢å¼•çš„å­˜åœ¨å¹¶ä¸å½±å“æ•°æ®åœ¨èšé›†ç´¢å¼•ä¸­çš„ç»„ç»‡ï¼Œå› æ­¤<strong>ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªè¾…åŠ©ç´¢å¼•ã€‚</strong></p><h3 id="è¦†ç›–ç´¢å¼•"><a class="markdownIt-Anchor" href="#è¦†ç›–ç´¢å¼•"></a> è¦†ç›–ç´¢å¼•</h3><blockquote><p>æŸ¥è¯¢åªè¦è®¿é—®ç´¢å¼•ï¼Œè€Œæ— é¡»è®¿é—®æ•°æ®è¡Œã€‚</p></blockquote><p>è¦†ç›–ç´¢å¼•ä»è¾…åŠ©ç´¢å¼•ä¸­å°±å¯ä»¥å¾—åˆ°æŸ¥è¯¢çš„è®°å½•ï¼Œè€Œä¸éœ€è¦æŸ¥è¯¢èšé›†ç´¢å¼•ä¸­çš„è®°å½•ã€‚å¥½å¤„æ˜¯è¾…åŠ©ç´¢å¼•ä¸åŒ…å«æ•´è¡Œè®°å½•çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ•…å…¶å¤§å°è¦è¿œå°äºèšé›†ç´¢å¼•ï¼Œå› æ­¤å¯ä»¥å‡å°‘å¤§é‡ <code>IO</code>ã€‚</p><p>ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„ç´¢å¼•éƒ½å¯ä»¥æˆä¸ºè¦†ç›–ç´¢å¼•ã€‚<strong>è¦†ç›–ç´¢å¼•å¿…é¡»è¦å­˜å‚¨ç´¢å¼•åˆ—çš„å€¼</strong>ï¼Œè€Œå“ˆå¸Œç´¢å¼•å’Œå…¨æ–‡ç´¢å¼•ç­‰éƒ½ä¸å­˜å‚¨ç´¢å¼•åˆ—çš„å€¼ï¼Œæ‰€ä»¥ <code>MySQL</code> åªèƒ½ä½¿ç”¨ <code>B+</code> æ ‘ç´¢å¼•åšè¦†ç›–ç´¢å¼•ã€‚</p><h3 id="è”åˆç´¢å¼•"><a class="markdownIt-Anchor" href="#è”åˆç´¢å¼•"></a> è”åˆç´¢å¼•</h3><p>è”åˆç´¢å¼•æ˜¯æŒ‡å¯¹è¡¨ä¸Šçš„å¤šä¸ªåˆ—è¿›è¡Œç´¢å¼•ã€‚å…¶é”®å€¼çš„æ•°é‡ä¸æ˜¯ <code>1</code>ï¼Œè€Œæ˜¯å¤§äºç­‰äº <code>2</code>ã€‚</p><h2 id="2-å“ˆå¸Œç´¢å¼•"><a class="markdownIt-Anchor" href="#2-å“ˆå¸Œç´¢å¼•"></a> 2. å“ˆå¸Œç´¢å¼•</h2><blockquote><p>åœ¨ <code>MySQL</code> ä¸­ï¼Œåªæœ‰ <code>Memory</code> å¼•æ“æ˜¾å¼æ”¯æŒå“ˆå¸Œç´¢å¼•ï¼Œå®ƒè¿˜æ”¯æŒéå”¯ä¸€å“ˆå¸Œç´¢å¼•ï¼Œå¦‚æœå¤šä¸ªåˆ—çš„å“ˆå¸Œå€¼ç›¸åŒï¼Œä½¿ç”¨é“¾è¡¨å­˜æ”¾è®°å½•æŒ‡é’ˆã€‚</p></blockquote><p>å“ˆå¸Œç´¢å¼•ï¼ˆ<code>hash index</code>ï¼‰åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œåªæœ‰<strong>ç²¾ç¡®åŒ¹é…</strong>ç´¢å¼•æ‰€æœ‰åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆã€‚</p><p>å¯¹äºæ¯ä¸€è¡Œæ•°æ®ï¼Œå­˜å‚¨å¼•æ“ä¼šå¯¹<strong>æ‰€æœ‰çš„ç´¢å¼•åˆ—</strong>è®¡ç®—ä¸€ä¸ªå“ˆå¸Œç ï¼ˆ<code>hash code</code>ï¼‰ï¼Œå“ˆå¸Œç´¢å¼•å°†æ‰€æœ‰çš„å“ˆå¸Œç å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼ŒåŒæ—¶åœ¨å“ˆå¸Œè¡¨ä¸­ä¿å­˜æŒ‡å‘æ¯ä¸ªæ•°æ®è¡Œçš„æŒ‡é’ˆã€‚</p><h3 id="é™åˆ¶-2"><a class="markdownIt-Anchor" href="#é™åˆ¶-2"></a> é™åˆ¶</h3><ul><li>åªåŒ…å«<strong>å“ˆå¸Œå€¼</strong>å’Œ<strong>æŒ‡é’ˆ</strong>ï¼Œä¸å­˜å‚¨å­—æ®µå€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­çš„å€¼æ¥é¿å…è¯»å–è¡Œã€‚</li><li><strong>ä¸æ”¯æŒé¡ºåºå’ŒèŒƒå›´æŸ¥è¯¢</strong>ã€‚</li><li>å“ˆå¸Œç´¢å¼•æ•°æ®å¹¶ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ï¼Œæ‰€ä»¥æ— æ³•ç”¨äºæ’åºã€‚</li><li>ä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åˆ—åŒ¹é…æŸ¥æ‰¾ï¼Œå› ä¸ºå“ˆå¸Œç´¢å¼•å§‹ç»ˆä½¿ç”¨ç´¢å¼•åˆ—çš„å…¨éƒ¨å†…å®¹æ¥è®¡ç®—å“ˆå¸Œå€¼ã€‚</li><li>å‡ºç°å“ˆå¸Œå†²çªï¼Œå¿…é¡»éå†é“¾è¡¨ä¸­æ‰€æœ‰æŒ‡é’ˆã€‚</li><li>å¦‚æœå“ˆå¸Œå†²çªå¾ˆå¤šï¼Œç´¢å¼•ç»´æŠ¤æ“ä½œçš„ä»£ä»·å¾ˆé«˜ã€‚</li></ul><h3 id="è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•"><a class="markdownIt-Anchor" href="#è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•"></a> è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•</h3><p>å½“ <code>InnoDB</code> æ³¨æ„åˆ°æŸäº›ç´¢å¼•å€¼è¢«ä½¿ç”¨å¾—å¾ˆé¢‘ç¹æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨å†…å­˜ä¸­åŸºäº <code>B+</code> æ ‘ç´¢å¼•ä¹‹ä¸Šå†åˆ›å»ºä¸€ä¸ªå“ˆå¸Œç´¢å¼•ï¼Œè¿™æ ·å°±è®© <code>B+</code> æ ‘ç´¢å¼•ä¹Ÿå…·æœ‰å“ˆå¸Œç´¢å¼•çš„ä¸€äº›ä¼˜ç‚¹ï¼Œå¦‚å¿«é€Ÿå“ˆå¸ŒæŸ¥æ‰¾ã€‚</p><h2 id="3-å…¨æ–‡ç´¢å¼•"><a class="markdownIt-Anchor" href="#3-å…¨æ–‡ç´¢å¼•"></a> 3. å…¨æ–‡ç´¢å¼•</h2><p>å…¨æ–‡ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ç´¢å¼•ï¼Œå®ƒæŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ã€‚å…¨æ–‡ç´¢å¼•ç±»ä¼¼äºæœç´¢å¼•æ“ï¼Œé€‚ç”¨äº <code>MATCH AGAINST</code> è€Œä¸æ˜¯ç®€å•çš„ <code>WHERE</code> æ¡ä»¶åŒ¹é…ã€‚</p><h1 id="é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥"><a class="markdownIt-Anchor" href="#é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥"></a> é«˜æ€§èƒ½çš„ç´¢å¼•ç­–ç•¥</h1><h2 id="ç‹¬ç«‹çš„åˆ—"><a class="markdownIt-Anchor" href="#ç‹¬ç«‹çš„åˆ—"></a> ç‹¬ç«‹çš„åˆ—</h2><blockquote><p>å¦‚æœæŸ¥è¯¢çš„åˆ—ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œ<code>MySQL</code> å°±ä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚</p></blockquote><p>ç‹¬ç«‹çš„åˆ—ï¼šç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•°ã€‚</p><h2 id="å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§"><a class="markdownIt-Anchor" href="#å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§"></a> å‰ç¼€ç´¢å¼•å’Œç´¢å¼•é€‰æ‹©æ€§</h2><blockquote><p>ç´¢å¼•é€‰æ‹©æ€§ = ä¸é‡å¤çš„ç´¢å¼•å€¼ / è®°å½•æ€»æ•°( <code>#T</code>)ï¼ŒèŒƒå›´ä» <code>1 / #T</code> åˆ° <code>1</code> ä¹‹é—´ï¼Œé€‰æ‹©æ€§è¶Šé«˜åˆ™æŸ¥è¯¢æ•ˆç‡è¶Šé«˜ï¼Œå› ä¸ºé€‰æ‹©æ€§é«˜çš„ç´¢å¼•å¯ä»¥åœ¨æŸ¥æ‰¾æ—¶è¿‡æ»¤æ›´å¤šçš„è¡Œã€‚</p></blockquote><p>é€‰æ‹©æŸä¸ªåˆ—é€‰æ‹©æ€§é«˜çš„å‰ç¼€è¿›è¡ŒæŸ¥è¯¢ã€‚ä½†å‰ç¼€ç´¢å¼•æ— æ³•è¿›è¡Œ <code>ORDER BY</code> å’Œ <code>GROUP</code> æ“ä½œã€‚</p><h2 id="é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—"><a class="markdownIt-Anchor" href="#é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—"></a> é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—</h2><p>ç»éªŒæ³•åˆ™ï¼šå°†é€‰æ‹©æ€§é«˜çš„ç´¢å¼•åˆšåˆ°ç´¢å¼•æœ€å‰åˆ—ã€‚ï¼ˆå¹¶ä¸é€‚ç”¨æ‰€æœ‰æƒ…å†µï¼Œä¹Ÿè¦è€ƒè™‘ <code>WHERE</code> å­å¥ä¸­çš„æ’åºï¼Œåˆ†ç»„å’ŒèŒƒå›´æ¡ä»¶ç­‰å…¶ä»–å› ç´ ï¼‰</p><h2 id="èšé›†ç´¢å¼•å’Œè¦†ç›–ç´¢å¼•"><a class="markdownIt-Anchor" href="#èšé›†ç´¢å¼•å’Œè¦†ç›–ç´¢å¼•"></a> èšé›†ç´¢å¼•å’Œè¦†ç›–ç´¢å¼•</h2><h2 id="ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº"><a class="markdownIt-Anchor" href="#ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº"></a> ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº</h2><p><code>MySQL</code> å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªç´¢å¼•æ—¢æ»¡è¶³æ’åºï¼Œåˆç”¨äºæŸ¥æ‰¾è¡Œã€‚å› æ­¤ï¼Œå¦‚æœå¯èƒ½ï¼Œè®¾è®¡ç´¢å¼•æ—¶åº”è¯¥å°½å¯èƒ½åœ°åŒæ—¶æ»¡è¶³è¿™ä¸¤ç§ä»»åŠ¡ã€‚<br />åªæœ‰å½“ç´¢å¼•çš„åˆ—é¡ºåºå’Œ <code>ORDER BY</code> å­å¥çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œå¹¶ä¸”æ‰€æœ‰åˆ—çš„æ’åºæ–¹å‘ï¼ˆå€’åºæˆ–æ­£åºï¼‰éƒ½ä¸€æ ·æ—¶ï¼Œ<code>MySQL</code> æ‰èƒ½ä½¿ç”¨ç´¢å¼•æ¥å¯¹ç»“æœåšæ’åºã€‚</p><h2 id="å†—ä½™å’Œé‡å¤ç´¢å¼•"><a class="markdownIt-Anchor" href="#å†—ä½™å’Œé‡å¤ç´¢å¼•"></a> å†—ä½™å’Œé‡å¤ç´¢å¼•</h2><ul><li>é‡å¤ç´¢å¼•æ˜¯æŒ‡åœ¨ç›¸åŒçš„åˆ—ä¸ŠæŒ‰ç…§ç›¸åŒçš„é¡ºåºåˆ›å»ºç›¸åŒç±»å‹çš„ç´¢å¼•ã€‚åº”è¯¥é¿å…åˆ›å»ºé‡å¤ç´¢å¼•ã€‚</li><li>å¦‚æœåˆ›å»ºäº†ç´¢å¼• <code>(A, B)</code>ï¼Œå†åˆ›å»ºç´¢å¼• <code>(A)</code> å°±æ˜¯å†—ä½™ç´¢å¼•ï¼Œå› ä¸ºè¿™åªæ˜¯å‰ä¸€ä¸ªç´¢å¼•çš„å‰ç¼€ç´¢å¼•ã€‚<br />ä½†æ˜¯å¦‚æœåˆ›å»º <code>(B, A), (B)</code>ï¼Œåˆ™ä¸æ˜¯å†—ä½™ç´¢å¼•ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯ <code>(A, B)</code> çš„æœ€å·¦å‰ç¼€åˆ—ã€‚<br />å…¶ä»–ä¸åŒç±»å‹çš„ç´¢å¼•ï¼ˆå“ˆå¸Œç´¢å¼•ã€å…¨æ–‡ç´¢å¼•ï¼‰ä¹Ÿä¸æ˜¯ <code>B+</code> æ ‘ç´¢å¼•çš„å†—ä½™ç´¢å¼•ï¼Œæ— è®ºå®ƒä»¬è¦†ç›–çš„ç´¢å¼•åˆ—æ˜¯ä»€ä¹ˆã€‚</li></ul><h2 id="æœªä½¿ç”¨çš„ç´¢å¼•åˆ—"><a class="markdownIt-Anchor" href="#æœªä½¿ç”¨çš„ç´¢å¼•åˆ—"></a> æœªä½¿ç”¨çš„ç´¢å¼•åˆ—</h2><p>å»ºè®®åˆ é™¤æœªä½¿ç”¨çš„ç´¢å¼•åˆ—ã€‚</p><h2 id="ç´¢å¼•å’Œé”"><a class="markdownIt-Anchor" href="#ç´¢å¼•å’Œé”"></a> ç´¢å¼•å’Œé”</h2><ul><li><strong>ç´¢å¼•å¯ä»¥è®©æŸ¥è¯¢é”å®šæ›´å°‘çš„è¡Œ</strong>ã€‚å¦‚æœæŸ¥è¯¢ä»ä¸è®¿é—®é‚£äº›ä¸éœ€è¦çš„è¡Œï¼Œé‚£ä¹ˆä¼šé”å®šæ›´å°‘çš„è¡Œã€‚</li><li><code>InnoDB</code> åªæœ‰åœ¨è®¿é—®è¡Œçš„æ—¶å€™æ‰ä¼šå¯¹å…¶åŠ é”ï¼Œè€Œç´¢å¼•èƒ½å‡å°‘è®¿é—®è¡Œçš„æ¬¡æ•°ï¼Œä»è€Œ<strong>å‡å°‘é”çš„æ•°é‡</strong>ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 433. æœ€å°åŸºå› å˜åŒ–</title>
    <link href="/2020/08/06/LeetCode-433-minimum-genetic-mutation/"/>
    <url>/2020/08/06/LeetCode-433-minimum-genetic-mutation/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-genetic-mutation/" target="_blank" rel="noopener">433. æœ€å°åŸºå› å˜åŒ–</a></p><h1 id="å›æº¯"><a class="markdownIt-Anchor" href="#å›æº¯"></a> å›æº¯</h1><p>ç¬¬ä¸€æ¬¡è§£æ³•å‡»è´¥ <code>100%</code> ç”¨æˆ·ã€‚</p><p>æ¯ä¸€æ¬¡çš„å˜å¼‚éƒ½å¯åœ¨åŸºå› åº“ä¸­æ‰¾åˆ°ï¼Œå› æ­¤ä»åŸºå› åº“ä¸­æ„å»ºå†³ç­–æ ‘ï¼Œä¸å½“å‰åŸºå› ç›¸å·®ä¸€ä¸ªç¢±åŸºä¸”åœ¨ä¹‹å‰çš„é€‰æ‹©è·¯å¾„ä¸­æœªå‡ºç°çš„åŸºå› å³ä¸ºä¸‹ä¸€æ­¥å˜å¼‚çš„åŸºå› ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">int</span> minStep = Integer.MAX_VALUE;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minMutation</span><span class="hljs-params">(String start, String end, String[] bank)</span> </span>&#123;        dfs(start, end, <span class="hljs-number">0</span>, bank);        <span class="hljs-keyword">return</span> minStep == Integer.MAX_VALUE ? -<span class="hljs-number">1</span> : minStep;    &#125;    List&lt;String&gt; selectedList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-comment">/**</span><span class="hljs-comment">     * é€‰æ‹©é˜Ÿåˆ—ï¼šbank ä¸­åœ¨å†³ç­–æ ‘ä¸­æœªé€‰æ‹©çš„å…ƒç´ </span><span class="hljs-comment">     * è·¯å¾„ï¼šselectedList</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> start å½“å‰å˜å¼‚åˆ°çš„åŸºå› </span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> end   æœ€ç»ˆçš„åŸºå› </span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> count éœ€è¦å˜ä¸ºæœ€ç»ˆåŸºå› çš„æ¬¡æ•°</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> bank  é€‰æ‹©é˜Ÿåˆ—</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(String start, String end, <span class="hljs-keyword">int</span> count, String[] bank)</span> </span>&#123;        <span class="hljs-comment">// å½“å‰æ­¥æ•° &gt; æœ€å°æ­¥æ•°ï¼šå‰ªæ</span>        <span class="hljs-keyword">if</span> (count &gt; minStep) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// è‹¥ å½“å‰åŸºå›  å¯ä»¥å˜ä¸º æœ€ç»ˆåŸºå› </span>        <span class="hljs-comment">// åˆ™è®¡ç®—æœ€å°æ­¥æ•°ï¼Œç»“æŸé€’å½’</span>        <span class="hljs-keyword">if</span> (start.equals(end)) &#123;            minStep = Math.min(minStep, count);            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">for</span> (String candidate : bank) &#123;            <span class="hljs-comment">// è‹¥ candidate ä¸åœ¨å†³ç­–æ ‘ä¸­ &amp;&amp; start å¯å˜å¼‚ä¸º candidate</span>            <span class="hljs-comment">// åˆ™è¿›å…¥å†³ç­–</span>            <span class="hljs-keyword">if</span> (notSelected(candidate) &amp;&amp; canMutate(start, candidate)) &#123;                selectedList.add(candidate);                dfs(candidate, end, count + <span class="hljs-number">1</span>, bank);                selectedList.remove(candidate);            &#125;        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ¤æ–­ start åŸºå› æ˜¯å¦å¯ä»¥å˜ä¸º candidate åŸºå› </span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> start</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> candidate</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">canMutate</span><span class="hljs-params">(String start, String candidate)</span> </span>&#123;        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; start.length(); i++) &#123;            <span class="hljs-keyword">if</span> (start.charAt(i) != candidate.charAt(i)) &#123;                <span class="hljs-keyword">if</span> (++count &gt; <span class="hljs-number">1</span>) &#123;                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * åˆ¤æ–­åœ¨ä¹‹å‰çš„è·¯å¾„ä¸­æ˜¯å¦æœªé€‰æ‹© candidate</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> candidate</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">notSelected</span><span class="hljs-params">(String candidate)</span> </span>&#123;        <span class="hljs-keyword">return</span> !selectedList.contains(candidate);    &#125;</code></pre><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><p>æ¯æ¬¡å˜å¼‚ä¸€ä¸ªç¢±åŸºï¼Œé˜Ÿåˆ—ä¸­ä¿å­˜çš„å³ä¸ºå½“å‰å¯å˜å¼‚çš„æ‰€æœ‰åŸºå› ï¼Œä¸”è¿™äº›åŸºå› éƒ½åœ¨åŸºå› åº“ä¸­æœªè¢«å˜å¼‚è¿‡ã€‚<br />ç›¸å½“äºæ„å»ºä¸€æ£µæ ‘ï¼Œè¿›è¡Œæ ‘çš„å±‚æ¬¡éå†ã€‚<br />éœ€è¦æ³¨æ„çš„æ˜¯å˜å¼‚å®Œåçš„ç¢±åŸºéœ€è¦æ¢å¤åŸæ ·ï¼Œå¦åˆ™åœ¨ä¸‹ä¸€æ¬¡è·å–æ–°åŸºå› æ—¶å¯èƒ½å¯¼è‡´å¤šä¸ªç¢±åŸºéƒ½å‘ç”Ÿäº†å˜å¼‚ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minMutation</span><span class="hljs-params">(String start, String end, String[] bank)</span> </span>&#123;        Set&lt;String&gt; unSelectedSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(Arrays.asList(bank));        <span class="hljs-keyword">if</span> (!unSelectedSet.contains(end)) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">char</span>[] mutGenes = &#123;<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'G'</span>, <span class="hljs-string">'T'</span>&#125;;        LinkedList&lt;String&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.add(start);        unSelectedSet.remove(start);        <span class="hljs-keyword">int</span> step = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            step++;            <span class="hljs-comment">// é˜Ÿåˆ—ä¸­ä¿å­˜çš„æ˜¯ä¸€ä¸ªåŸºå› ä¸€æ¬¡å˜å¼‚å¯ä»¥äº§ç”Ÿçš„æ–°åŸºå› åºåˆ—</span>            <span class="hljs-comment">// é˜Ÿåˆ—ä¸ºç©ºåˆ™è¡¨ç¤ºè¿™æ¬¡çš„åºåˆ—å˜å¼‚ç»“æŸï¼Œè¿›å…¥ä¸‹ä¸€æ¬¡éå†</span>            <span class="hljs-keyword">int</span> size = queue.size();            <span class="hljs-keyword">while</span> (size-- &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-comment">// åŸºå› </span>                <span class="hljs-keyword">char</span>[] genes = queue.poll().toCharArray();                <span class="hljs-comment">// 1. å¯¹æ¯ä¸ªåŸºå› ä½å˜å¼‚</span>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; genes.length; i++) &#123;                    <span class="hljs-comment">// ä¿å­˜æ—§çš„ç¢±åŸº</span>                    <span class="hljs-keyword">char</span> oldGene = genes[i];                    <span class="hljs-comment">// 2. åŸºå› çš„æ¯ä¸€ä½ä¾æ¬¡è¿›è¡Œ ACGT å˜å¼‚</span>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> mutGene : mutGenes) &#123;                        genes[i] = mutGene;                        <span class="hljs-comment">// 3. è·å–ç¢±åŸºå˜å¼‚åçš„æ–°åŸºå› </span>                        String newGene = String.valueOf(genes);                        <span class="hljs-comment">// 4. å˜åˆ° endï¼Œç›´æ¥è¿”å›</span>                        <span class="hljs-keyword">if</span> (end.equals(newGene)) &#123;                            <span class="hljs-keyword">return</span> step;                            <span class="hljs-comment">// 5. åœ¨æœªå˜å¼‚çš„åŸºå› åº“ä¸­æ‰¾åˆ°æ–°åŸºå› </span>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (unSelectedSet.contains(newGene)) &#123;                            unSelectedSet.remove(newGene);                            queue.offer(newGene);                        &#125;                    &#125;                    <span class="hljs-comment">// å˜å¼‚çš„åŸºå› ä½è¦æ¢å¤åŸæ¥çš„ç¢±åŸº</span>                    <span class="hljs-comment">// å¦åˆ™åœ¨ 3 ä¸­è·å–çš„æ–°åŸºå› ä¼šå˜æˆ TTTT*ï¼Œè¿›è€Œå½±å“ 4, 5</span>                    genes[i] = oldGene;                &#125;            &#125;        &#125;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;</code></pre><h1 id="åŒå‘-bfs"><a class="markdownIt-Anchor" href="#åŒå‘-bfs"></a> åŒå‘ BFS</h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">minMutation</span><span class="hljs-params">(String start, String end, String[] bank)</span> </span>&#123;        <span class="hljs-keyword">if</span> (start.length() == <span class="hljs-number">0</span> || end.length() == <span class="hljs-number">0</span>) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        Set&lt;String&gt; list = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(Arrays.asList(bank));        <span class="hljs-keyword">if</span> (!list.contains(end)) &#123;            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">char</span>[] muteList = &#123;<span class="hljs-string">'A'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'G'</span>, <span class="hljs-string">'T'</span>&#125;;        Set&lt;String&gt; beginSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        beginSet.add(start);        Set&lt;String&gt; endSet = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();        endSet.add(end);        <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;        <span class="hljs-keyword">while</span> (!beginSet.isEmpty() &amp;&amp; !endSet.isEmpty()) &#123;            count++;            <span class="hljs-comment">// æ¯æ¬¡éƒ½å‡è®¾ä»æ•°ç›®å°çš„é›†åˆéå†</span>            <span class="hljs-keyword">if</span> (beginSet.size() &gt; endSet.size()) &#123;                Set&lt;String&gt; tmp = beginSet;                beginSet = endSet;                endSet = tmp;            &#125;            <span class="hljs-comment">// ä¸‹ä¸€æ¬¡å˜å¼‚çš„åˆ—è¡¨</span>            Set&lt;String&gt; nextLevel = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();            <span class="hljs-keyword">for</span> (String word : beginSet) &#123;                <span class="hljs-keyword">char</span>[] words = word.toCharArray();                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; words.length; i++) &#123;                    <span class="hljs-keyword">char</span> old = words[i];                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : muteList) &#123;                        <span class="hljs-keyword">if</span> (old == c) &#123;                            <span class="hljs-keyword">continue</span>;                        &#125;                        words[i] = c;                        String candidate = String.valueOf(words);                        <span class="hljs-keyword">if</span> (endSet.contains(candidate)) &#123;                            <span class="hljs-keyword">return</span> count;                        &#125;                        <span class="hljs-comment">// è¿™é‡Œä¸€å®šæ³¨æ„åªèƒ½å˜å¼‚åˆ° bank ä¸­çš„å•è¯</span>                        <span class="hljs-comment">// å¦‚æœä½¿ç”¨ used åˆ¤æ–­ï¼Œä¼šåŠ å…¥ä¸åœ¨ bank ä¸­çš„å•è¯ï¼Œå¯¼è‡´å‡ºé”™</span>                        <span class="hljs-keyword">if</span> (list.contains(candidate)) &#123;                            nextLevel.add(candidate);                            list.remove(candidate);                        &#125;                    &#125;                    words[i] = old;                &#125;            &#125;            beginSet = nextLevel;        &#125;        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 102. äºŒå‰æ ‘çš„å±‚åºéå†</title>
    <link href="/2020/08/06/LeetCode-102-binary-tree-level-order-traversal/"/>
    <url>/2020/08/06/LeetCode-102-binary-tree-level-order-traversal/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal/" target="_blank" rel="noopener">äºŒå‰æ ‘çš„å±‚åºéå†</a></p><p>ä¸»è¦åœ¨äºåˆ¤æ–­æ¯ä¸€å±‚æœ‰å“ªäº›ç»“ç‚¹ï¼šéå†ä¹‹å‰å…ˆä¿å­˜æ¯å±‚ç»“ç‚¹æ•°ï¼Œç„¶åæŒ‰å±‚å¤„ç†ç»“ç‚¹ã€‚</p><h1 id="bfs"><a class="markdownIt-Anchor" href="#bfs"></a> BFS</h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;        List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span> res;        &#125;        LinkedList&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();        queue.add(root);        <span class="hljs-keyword">while</span> (!queue.isEmpty()) &#123;            <span class="hljs-comment">// ä¿å­˜å½“å‰å±‚çš„ç»“ç‚¹æ•°</span>            <span class="hljs-keyword">int</span> n = queue.size();            List&lt;Integer&gt; level = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();            <span class="hljs-comment">// éå†å½“å‰å±‚çš„ç»“ç‚¹</span>            <span class="hljs-keyword">while</span> (n-- &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-comment">// å¯¹å¤´å‡ºé˜Ÿï¼Œå¹¶å°†å·¦å³ç»“ç‚¹å…¥é˜Ÿ</span>                <span class="hljs-comment">// å½“æœ¬è½®å¾ªç¯ç»“æŸåï¼Œé˜Ÿåˆ—é‡Œéƒ½æ˜¯åŒä¸€å±‚çš„ç»“ç‚¹</span>                TreeNode p = queue.poll();                level.add(p.val);                <span class="hljs-keyword">if</span> (p.left != <span class="hljs-keyword">null</span>) &#123;                    queue.add(p.left);                &#125;                <span class="hljs-keyword">if</span> (p.right != <span class="hljs-keyword">null</span>) &#123;                    queue.add(p.right);                &#125;            &#125;            <span class="hljs-comment">// å°†å½“å‰å±‚åŠ å…¥ç»“æœ</span>            res.add(level);        &#125;        <span class="hljs-keyword">return</span> res;    &#125;</code></pre><h1 id="dfs"><a class="markdownIt-Anchor" href="#dfs"></a> DFS</h1><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; levelOrder(TreeNode root) &#123;        dfs(root, <span class="hljs-number">1</span>);        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(TreeNode root, <span class="hljs-keyword">int</span> level)</span> </span>&#123;        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-keyword">if</span> (res.size() &lt; level) &#123;            res.add(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(root.val)));        &#125; <span class="hljs-keyword">else</span> &#123;            res.get(level - <span class="hljs-number">1</span>).add(root.val);        &#125;        dfs(root.left, level + <span class="hljs-number">1</span>);        dfs(root.right, level + <span class="hljs-number">1</span>);    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>DFS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB è¡¨</title>
    <link href="/2020/08/06/InnoDB-table/"/>
    <url>/2020/08/06/InnoDB-table/</url>
    
    <content type="html"><![CDATA[<h1 id="ç´¢å¼•ç»„ç»‡è¡¨"><a class="markdownIt-Anchor" href="#ç´¢å¼•ç»„ç»‡è¡¨"></a> ç´¢å¼•ç»„ç»‡è¡¨</h1><p>åœ¨ <code>InnoDB</code> ä¸­ï¼Œè¡¨éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºç»„ç»‡å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ï¼ˆ<code>index organized table</code>ï¼‰ã€‚å¦‚æœåœ¨åˆ›å»ºè¡¨æ—¶æ²¡æœ‰æ˜¾å¼åœ°å®šä¹‰ä¸»é”®ï¼Œåˆ™ä¼šæŒ‰ä»¥ä¸‹æ–¹å¼é€‰æ‹©æˆ–åˆ›å»ºä¸»é”®ï¼š</p><ul><li>é¦–å…ˆåˆ¤æ–­è¡¨ä¸­æ˜¯å¦æœ‰<strong>éç©ºçš„å”¯ä¸€ç´¢å¼•</strong>ï¼ˆ<code>Unique NOT NULL</code>ï¼‰ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¯¥åˆ—ä¸ºä¸»é”®ï¼›</li><li>å¦åˆ™ï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª <code>6</code> å­—èŠ‚å¤§å°çš„æŒ‡é’ˆã€‚</li></ul><p>å½“è¡¨ä¸­æœ‰å¤šä¸ªéç©ºå”¯ä¸€ç´¢å¼•æ—¶ï¼Œ<code>InnoDB</code> å­˜å‚¨å¼•æ“å°†é€‰æ‹©å»ºè¡¨æ—¶ç¬¬ä¸€ä¸ªå®šä¹‰çš„éç©ºå”¯ä¸€ç´¢å¼•ï¼ˆ<strong>ç´¢å¼•çš„é¡ºåº</strong>ï¼‰ä¸ºä¸»é”®ã€‚</p><h1 id="innodb-é€»è¾‘å­˜å‚¨ç»“æ„"><a class="markdownIt-Anchor" href="#innodb-é€»è¾‘å­˜å‚¨ç»“æ„"></a> <code>InnoDB</code> é€»è¾‘å­˜å‚¨ç»“æ„</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805154705.png" srcset="/img/loading.gif" alt="" /></p><p>æ‰€æœ‰æ•°æ®éƒ½å­˜æ”¾åœ¨è¡¨ç©ºé—´ï¼Œè¡¨ç©ºé—´ç”±æ®µï¼ˆ<code>segment</code>ï¼‰ã€åŒºï¼ˆ<code>extent</code>ï¼‰ã€é¡µï¼ˆ<code>page</code>ï¼‰ç»„æˆã€‚</p><h2 id="æ®µ"><a class="markdownIt-Anchor" href="#æ®µ"></a> æ®µ</h2><ul><li>æ•°æ®æ®µï¼š<code>B+</code> æ ‘çš„å¶å­èŠ‚ç‚¹ï¼ˆ<code>Leaf node segment</code>ï¼‰</li><li>ç´¢å¼•æ®µï¼š<code>B+</code> æ ‘çš„éå¶å­èŠ‚ç‚¹ï¼ˆ<code>Non-Leaf node segment</code>ï¼‰</li><li>å›æ»šæ®µï¼š<code>Rollback segment</code></li></ul><h2 id="åŒº"><a class="markdownIt-Anchor" href="#åŒº"></a> åŒº</h2><p>åŒºæ˜¯ç”±è¿ç»­é¡µç»„æˆçš„ç©ºé—´ï¼Œ<strong>åœ¨ä»»ä½•æƒ…å†µä¸‹æ¯ä¸ªåŒºçš„å¤§å°éƒ½ä¸º <code>1MB</code>ã€‚</strong> ä¸ºäº†ä¿è¯åŒºä¸­é¡µçš„è¿ç»­æ€§ï¼Œ<code>InnoDB</code> ä¸€æ¬¡ä»ç£ç›˜ç”³è¯· <code>4 ~ 5</code> ä¸ªåŒºï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡µçš„å¤§å°ä¸º <code>16KB</code>ï¼Œå³ä¸€ä¸ªåŒºä¸­ä¸€å…±æœ‰ <code>64</code> ä¸ªè¿ç»­çš„é¡µã€‚</p><h2 id="é¡µ"><a class="markdownIt-Anchor" href="#é¡µ"></a> é¡µ</h2><p>é¡µæ˜¯ <code>InnoDB</code> ç£ç›˜ç®¡ç†çš„æœ€å°å•ä½ã€‚å¯é€šè¿‡ <code>innodb_page_size</code> å°†é¡µçš„å¤§å°è®¾ç½®ä¸º <code>4K</code>ã€<code>8K</code>ã€<code>16K</code>ã€‚</p><h2 id="è¡Œ"><a class="markdownIt-Anchor" href="#è¡Œ"></a> è¡Œ</h2><p>æ•°æ®æŒ‰è¡Œå­˜æ”¾ï¼Œæ¯é¡µæœ€å¤šå­˜æ”¾ <code>16KB / 2 - 200 = 7992</code> è¡Œçš„è®°å½•ã€‚</p><h1 id="innodb-è¡Œè®°å½•æ ¼å¼"><a class="markdownIt-Anchor" href="#innodb-è¡Œè®°å½•æ ¼å¼"></a> <code>InnoDB</code> è¡Œè®°å½•æ ¼å¼</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805164415.png" srcset="/img/loading.gif" alt="" /></p><h2 id="compact-è¡Œè®°å½•æ ¼å¼"><a class="markdownIt-Anchor" href="#compact-è¡Œè®°å½•æ ¼å¼"></a> <code>Compact</code> è¡Œè®°å½•æ ¼å¼</h2><p>å…¶ç›®çš„æ˜¯é«˜æ•ˆåœ°å­˜å‚¨æ•°æ®ï¼Œä¸€ä¸ªé¡µä¸­å­˜æ”¾çš„æ•°æ®è¶Šå¤šï¼Œå…¶æ€§èƒ½å°±è¶Šé«˜ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805162732.png" srcset="/img/loading.gif" alt="" /></p><h2 id="redundant-è¡Œè®°å½•æ ¼å¼"><a class="markdownIt-Anchor" href="#redundant-è¡Œè®°å½•æ ¼å¼"></a> <code>Redundant</code> è¡Œè®°å½•æ ¼å¼</h2><p><code>Redundant</code> æ˜¯ <code>MySQL 5.0</code> ä¹‹å‰çš„è¡Œè®°å½•å­˜å‚¨æ–¹å¼ï¼Œå®ƒæ˜¯ä¸ºäº†å…¼å®¹ä¹‹å‰ç‰ˆæœ¬çš„é¡µæ ¼å¼ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805162855.png" srcset="/img/loading.gif" alt="" /></p><h2 id="è¡Œæº¢å‡ºæ•°æ®"><a class="markdownIt-Anchor" href="#è¡Œæº¢å‡ºæ•°æ®"></a> è¡Œæº¢å‡ºæ•°æ®</h2><p>å¦‚æœé¡µä¸­åªèƒ½å­˜æ”¾ä¸‹ä¸€æ¡è®°å½•ï¼Œé‚£ä¹ˆ <code>InnoDB</code> ä¼šè‡ªåŠ¨å°†è¡Œæ•°æ®å­˜æ”¾åˆ°æº¢å‡ºé¡µä¸­ã€‚</p><h2 id="compressed-å’Œ-dynamic-è¡Œè®°å½•æ ¼å¼"><a class="markdownIt-Anchor" href="#compressed-å’Œ-dynamic-è¡Œè®°å½•æ ¼å¼"></a> <code>Compressed</code> å’Œ <code>Dynamic</code> è¡Œè®°å½•æ ¼å¼</h2><p>è¿™ä¸¤ç§è®°å½•æ ¼å¼å¯¹äºå­˜æ”¾åœ¨ <code>BLOB</code> ä¸­çš„æ•°æ®é‡‡ç”¨äº†å®Œå…¨çš„è¡Œæº¢å‡ºçš„æ–¹å¼ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805163825.png" srcset="/img/loading.gif" alt="" /><br />æ•°æ®é¡µä¸­åªå­˜æ”¾ <code>20</code> ä¸ªå­—èŠ‚çš„æŒ‡é’ˆï¼Œå®é™…æ•°æ®éƒ½å­˜æ”¾åœ¨ <code>Off Page</code> ä¸­ã€‚</p><h1 id="çº¦æŸ"><a class="markdownIt-Anchor" href="#çº¦æŸ"></a> çº¦æŸ</h1><h2 id="æ•°æ®å®Œæ•´æ€§"><a class="markdownIt-Anchor" href="#æ•°æ®å®Œæ•´æ€§"></a> æ•°æ®å®Œæ•´æ€§</h2><ul><li><strong>å®ä½“å®Œæ•´æ€§</strong>ï¼šä¿è¯è¡¨ä¸­æœ‰ä¸€ä¸ªä¸»é”®ã€‚</li><li><strong>åŸŸå®Œæ•´æ€§</strong>ï¼šä¿è¯æ•°æ®<strong>æ¯åˆ—çš„å€¼</strong>æ»¡è¶³ç‰¹å®šçš„æ¡ä»¶ã€‚<ul><li>é€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹ç¡®ä¿ä¸€ä¸ªæ•°æ®å€¼æ»¡è¶³ç‰¹å®šæ¡ä»¶</li><li>å¤–é”®çº¦æŸ</li><li>è§¦å‘å™¨</li><li><code>DEFAULT</code> çº¦æŸ</li></ul></li><li><strong>å‚ç…§å®Œæ•´æ€§</strong>ï¼šä¿è¯<strong>ä¸¤å¼ è¡¨</strong>ä¹‹é—´çš„å…³ç³»ã€‚<ul><li><code>Primary Key</code></li><li><code>Unique Key</code></li><li><code>Foreigh Key</code></li><li><code>Default</code></li><li><code>NOT NULL</code></li></ul></li></ul><h2 id="çº¦æŸçš„åˆ›å»º"><a class="markdownIt-Anchor" href="#çº¦æŸçš„åˆ›å»º"></a> çº¦æŸçš„åˆ›å»º</h2><ol><li>è¡¨å»ºç«‹æ—¶è¿›è¡Œçº¦æŸå®šä¹‰</li><li>åˆ©ç”¨ <code>ALTER TABLE</code> å‘½ä»¤è¿›è¡Œåˆ›å»ºçº¦æŸ</li></ol><h2 id="çº¦æŸå’Œç´¢å¼•çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#çº¦æŸå’Œç´¢å¼•çš„åŒºåˆ«"></a> çº¦æŸå’Œç´¢å¼•çš„åŒºåˆ«</h2><ul><li>çº¦æŸæ˜¯ä¸€ä¸ª<strong>é€»è¾‘æ¦‚å¿µ</strong>ï¼Œç”¨æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼›</li><li>ç´¢å¼•æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ—¢æœ‰<strong>é€»è¾‘æ¦‚å¿µ</strong>ï¼Œåœ¨æ•°æ®åº“ä¸­è¿˜ä»£è¡¨ç€<strong>ç‰©ç†å­˜å‚¨</strong>çš„æ–¹å¼ã€‚</li></ul><h1 id="è§†å›¾"><a class="markdownIt-Anchor" href="#è§†å›¾"></a> è§†å›¾</h1><blockquote><p>è§†å›¾æ˜¯ä¸€ä¸ªå‘½åçš„è™šè¡¨ï¼Œç”±ä¸€ä¸ª <code>SQL</code> æŸ¥è¯¢å®šä¹‰ï¼Œè§†å›¾ä¸­çš„æ•°æ®æ²¡æœ‰å®é™…çš„ç‰©ç†å­˜å‚¨ã€‚</p></blockquote><p>è§†å›¾çš„ä¸»è¦ç”¨é€”æ˜¯è¢«ç”¨åšä¸€ä¸ªæŠ½è±¡è£…ç½®ï¼Œç¨‹åºæœ¬èº«ä¸éœ€è¦å…³å¿ƒåŸºè¡¨ï¼ˆ<code>base table</code>ï¼‰çš„ç»“æ„ï¼Œåªéœ€è¦æŒ‰ç…§è§†å›¾å®šä¹‰æ¥<strong>è·å–æ•°æ®æˆ–æ›´æ–°æ•°æ®</strong>ã€‚</p><ul><li>é€šè¿‡å®šä¹‰è§†å›¾ <code>WITH CHECK OPTION</code> å¯å¯¹åŸºæœ¬è¡¨è¿›è¡Œæ›´æ–°ã€‚</li><li><code>SHOW TABLES</code> å‘½ä»¤ä¹Ÿä¼šæŠŠè§†å›¾ä½œä¸ºè¡¨æ˜¾ç¤ºå‡ºæ¥ã€‚</li></ul><h1 id="åˆ†åŒºè¡¨"><a class="markdownIt-Anchor" href="#åˆ†åŒºè¡¨"></a> åˆ†åŒºè¡¨</h1><blockquote><p>åˆ†åŒºçš„è¿‡ç¨‹æ˜¯å°†ä¸€ä¸ªè¡¨æˆ–ç´¢å¼•åˆ†è§£ä¸ºå¤šä¸ªæ›´å°ã€æ›´å¯ç®¡ç†çš„éƒ¨åˆ†ã€‚æ¯ä¸ªåˆ†åŒºéƒ½æ˜¯ç‹¬ç«‹çš„å¯¹è±¡ï¼Œå¯ä»¥ç‹¬è‡ªå¤„ç†ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªæ›´å¤§å¯¹è±¡çš„ä¸€éƒ¨åˆ†è¿›è¡Œå¤„ç†ã€‚<br />ä»é€»è¾‘ä¸Šè®²ï¼Œåªæœ‰ä¸€ä¸ªè¡¨æˆ–ä¸€ä¸ªç´¢å¼•ï¼Œä½†æ˜¯åœ¨ç‰©ç†ä¸Šè¿™ä¸ªè¡¨æˆ–ç´¢å¼•å¯èƒ½ç”±æ•°åä¸ªç‰©ç†åˆ†åŒºç»„æˆã€‚</p></blockquote><ul><li><code>MySQL</code> æ”¯æŒ<strong>æ°´å¹³åˆ†åŒº</strong>ï¼Œå¹¶ä¸æ”¯æŒå‚ç›´åˆ†åŒºï¼›</li><li><code>MySQL</code> çš„åˆ†åŒºæ˜¯<strong>å±€éƒ¨åˆ†åŒºç´¢å¼•</strong>ï¼Œä¸€ä¸ªåˆ†åŒºä¸­æ—¢å­˜æ”¾äº†æ•°æ®åˆå­˜æ”¾äº†ç´¢å¼•ã€‚</li></ul><h2 id="åˆ†åŒºç±»å‹"><a class="markdownIt-Anchor" href="#åˆ†åŒºç±»å‹"></a> åˆ†åŒºç±»å‹</h2><ul><li><code>RANGE</code> åˆ†åŒºï¼šè¡Œæ•°æ®åŸºäºå±äºä¸€ä¸ªç»™å®šè¿ç»­åŒºé—´çš„åˆ—å€¼è¢«æ”¾å…¥åˆ†åŒºã€‚</li><li><code>LIST</code> åˆ†åŒºï¼šå’Œ <code>RANGE</code> åˆ†åŒºç±»ä¼¼ï¼Œåªæ˜¯ <code>LIST</code> åˆ†åŒºé¢å‘çš„æ˜¯ç¦»æ•£çš„å€¼ã€‚</li><li><code>HASH</code> åˆ†åŒºï¼šæ ¹æ®ç”¨æˆ·è‡ªå®šä¹‰çš„è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œåˆ†åŒºã€‚</li><li><code>KEY</code> åˆ†åŒºï¼šæ ¹æ® <code>MySQL</code> æä¾›çš„å“ˆå¸Œå‡½æ•°æ¥è¿›è¡Œåˆ†åŒºã€‚</li><li><code>COLUMNS</code> åˆ†åŒºï¼šä¸åŒäºä»¥ä¸Šå››ç§ï¼Œè¯¥åˆ†åŒºå¯ä»¥ç›´æ¥ä½¿ç”¨éæ•´å½¢çš„æ•°æ®è¿›è¡Œåˆ†åŒºï¼Œåˆ†åŒºæ ¹æ®ç±»å‹æ¯”è¾ƒè€Œå¾—ï¼Œä¸éœ€è¦è½¬åŒ–ä¸ºæ•´å½¢ã€‚</li></ul><h2 id="å­åˆ†åŒº"><a class="markdownIt-Anchor" href="#å­åˆ†åŒº"></a> å­åˆ†åŒº</h2><p>å­åˆ†åŒºæ˜¯åœ¨åˆ†åŒºçš„åŸºç¡€ä¸Šå†è¿›è¡Œåˆ†åŒºã€‚<code>MySQL</code> å…è®¸åœ¨ <code>RANGE</code> å’Œ <code>LIST</code> çš„åˆ†åŒºä¸Šå†è¿›è¡Œ <code>HASH</code> æˆ– <code>KEY</code> çš„å­åˆ†åŒºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 51. Nçš‡å</title>
    <link href="/2020/08/05/LeetCode-51-n-queens/"/>
    <url>/2020/08/05/LeetCode-51-n-queens/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/n-queens/" target="_blank" rel="noopener">51. Nçš‡å</a></p><p>æ£‹ç›˜æ¯ä¸€è¡Œç›¸å½“äºå†³ç­–æ ‘çš„æ¯ä¸€å±‚ï¼Œæ¯è¡Œçš„ä»»æ„ä¸€åˆ—éƒ½å¯æ”¾ç½®çš‡åã€‚å› æ­¤ï¼Œä» <strong>æ¯ä¸€è¡Œ</strong> å¼€å§‹ï¼Œé€‰æ‹©è¯¥è¡Œçš„ <strong>æ¯ä¸€åˆ—</strong> ä½œä¸ºé€‰æ‹©åˆ—è¡¨è¿›è¡Œé€’å½’ï¼Œè¯¥è¡Œä»¥ä¸Šçš„æ‰€æœ‰è¡Œæ­¤æ—¶éƒ½æ­£ç¡®æ”¾ç½®äº†çš‡åï¼Œå½“è¡Œæ•°è¾¾åˆ°æ£‹ç›˜æ·±åº¦æ—¶ç»“æŸé€’å½’ï¼Œè¿”å›æœ¬æ¬¡é€’å½’çš„ç»“æœã€‚</p><pre><code class="hljs java">List&lt;List&lt;String&gt;&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">public</span> List&lt;List&lt;String&gt;&gt; solveNQueens(<span class="hljs-keyword">int</span> n) &#123;        <span class="hljs-keyword">char</span>[][] board = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[n][n];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span>[] row : board) &#123;            Arrays.fill(row, <span class="hljs-string">'.'</span>);        &#125;        backtrack(board, <span class="hljs-number">0</span>);        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> board æ£‹ç›˜</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> row   è¡Œå·</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, <span class="hljs-keyword">int</span> row)</span> </span>&#123;        <span class="hljs-comment">// è¡Œæ•°è¾¾åˆ°æ£‹ç›˜æœ€åä¸€è¡Œç»“æŸ</span>        <span class="hljs-comment">// æ­¤æ—¶æ£‹ç›˜å·²æ­£ç¡®æ”¾ç½®çš‡åï¼Œè¿”å›æœ¬è½®ç»“æœ</span>        <span class="hljs-keyword">if</span> (row == board.length) &#123;            res.add(genBoard(board));            <span class="hljs-keyword">return</span>;        &#125;        <span class="hljs-comment">// è·¯å¾„ï¼šrow è¡Œä¸Šé¢çš„é‚£äº›è¡Œéƒ½æˆåŠŸæ”¾ç½®äº† Q</span>        <span class="hljs-keyword">char</span>[] line = board[row];        <span class="hljs-comment">// é€‰æ‹©åˆ—è¡¨ï¼šç¬¬ row è¡Œçš„æ¯ä¸€åˆ—éƒ½æ˜¯ Q çš„å¯é€‰ä½ç½®</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> col = <span class="hljs-number">0</span>; col &lt; line.length; col++) &#123;            <span class="hljs-comment">// æ’é™¤ä¸åˆæ³•é€‰æ‹©</span>            <span class="hljs-comment">// è‹¥å½“å‰ (row, col) ä½ç½®ä¸æ»¡è¶³ï¼Œåˆ™è¿›å…¥è¯¥è¡Œçš„ä¸‹ä¸€åˆ—</span>            <span class="hljs-keyword">if</span> (!isValid(board, row, col)) &#123;                <span class="hljs-keyword">continue</span>;            &#125;            <span class="hljs-comment">// åšé€‰æ‹©</span>            board[row][col] = <span class="hljs-string">'Q'</span>;            <span class="hljs-comment">// è¿›å…¥ä¸‹ä¸€è¡Œå†³ç­–</span>            backtrack(board, row + <span class="hljs-number">1</span>);            <span class="hljs-comment">// æ’¤é”€é€‰æ‹©</span>            board[row][col] = <span class="hljs-string">'.'</span>;        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * å› ä¸ºå…¶å®ƒä½ç½®è¿˜å¤„äºåˆå§‹çŠ¶æ€</span><span class="hljs-comment">     * åªéœ€è¦éªŒè¯æ¯ä¸€åˆ—ï¼Œå·¦ä¸Šå’Œå³ä¸Šä½ç½®æ˜¯å¦æœ‰çš‡å</span><span class="hljs-comment">     *</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> board æ£‹ç›˜</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> row   å½“å‰è¡Œ</span><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> col   å½“å‰åˆ—</span><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å½“å‰ä½ç½®æ˜¯å¦å¯ä»¥æ”¾ç½® çš‡å</span><span class="hljs-comment">     */</span>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> col)</span> </span>&#123;        <span class="hljs-comment">// éªŒè¯ col æ‰€åœ¨åˆ—æ˜¯å¦æœ‰çš‡å</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span>[] line : board) &#123;            <span class="hljs-keyword">if</span> (<span class="hljs-string">'Q'</span> == line[col]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// éªŒè¯å½“å‰ä½ç½®å·¦ä¸Šè§’æ˜¯å¦æœ‰çš‡å</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = row - <span class="hljs-number">1</span>, j = col - <span class="hljs-number">1</span>;             i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &gt;= <span class="hljs-number">0</span>;             i--, j--) &#123;            <span class="hljs-keyword">if</span> (<span class="hljs-string">'Q'</span> == board[i][j]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-comment">// éªŒè¯å½“å‰ä½ç½®å³ä¸Šè§’æ˜¯å¦æœ‰çš‡å</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = row - <span class="hljs-number">1</span>, j = col + <span class="hljs-number">1</span>;             i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &lt; board.length;             i--, j++) &#123;            <span class="hljs-keyword">if</span> (<span class="hljs-string">'Q'</span> == board[i][j]) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;        &#125;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title">genBoard</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[][] board)</span> </span>&#123;        List&lt;String&gt; bd = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span>[] line : board) &#123;            bd.add(String.valueOf(line));        &#125;        <span class="hljs-keyword">return</span> bd;    &#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB æ–‡ä»¶</title>
    <link href="/2020/08/05/InnoDB-file/"/>
    <url>/2020/08/05/InnoDB-file/</url>
    
    <content type="html"><![CDATA[<h1 id="å‚æ•°æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å‚æ•°æ–‡ä»¶"></a> å‚æ•°æ–‡ä»¶</h1><blockquote><p>å‘Šè¯‰ <code>MySQL</code> å®ä¾‹å¯åŠ¨æ—¶åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æ•°æ®åº“æ–‡ä»¶ï¼Œå¹¶ä¸”æŒ‡å®šæŸäº›åˆå§‹åŒ–å‚æ•°ï¼Œè¿™äº›å‚æ•°å®šä¹‰äº†æŸç§å†…å­˜ç»“æ„çš„å¤§å°ç­‰è®¾ç½®ã€‚</p></blockquote><p><code>MySQL</code> å®ä¾‹å¯ä»¥ä¸éœ€è¦å‚æ•°æ–‡ä»¶ï¼Œè¿™æ—¶æ‰€æœ‰çš„å‚æ•°å€¼å–å†³äºç¼–è¯‘ <code>MySQL</code> æ—¶æŒ‡å®šçš„é»˜è®¤å€¼å’Œæºä»£ç ä¸­æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ã€‚</p><p>å‚æ•°ç±»å‹ï¼š</p><ul><li><strong>åŠ¨æ€å‚æ•°</strong> - å¯ä»¥åœ¨ <code>MySQL</code> å®ä¾‹è¿è¡Œä¸­è¿›è¡Œæ›´æ”¹</li><li><strong>é™æ€å‚æ•°</strong> - åœ¨æ•´ä¸ªå®ä¾‹ç”Ÿå‘½å‘¨æœŸå†…éƒ½ä¸å¾—è¿›è¡Œä¿®æ”¹</li></ul><h1 id="æ—¥å¿—æ–‡ä»¶"><a class="markdownIt-Anchor" href="#æ—¥å¿—æ–‡ä»¶"></a> æ—¥å¿—æ–‡ä»¶</h1><blockquote><p>æ—¥å¿—æ–‡ä»¶è®°å½•äº†å½±å“ <code>MySQL</code> æ•°æ®åº“çš„å„ç§ç±»å‹æ´»åŠ¨ã€‚</p></blockquote><ul><li><p><strong>é”™è¯¯æ—¥å¿—ï¼ˆ<code>error log</code>ï¼‰</strong><br />è®°å½• MySQL çš„å¯åŠ¨ã€è¿è¡Œã€å…³é—­è¿‡ç¨‹ã€‚ä¸ä»…è®°å½•æ‰€æœ‰é”™è¯¯ä¿¡æ¯ï¼Œä¹Ÿè®°å½•ä¸€äº›è­¦å‘Šæˆ–æ­£ç¡®çš„ä¿¡æ¯ã€‚<br />å¯é€šè¿‡å‘½ä»¤ <code>SHOW VARIABLES LIKE 'log_error'</code> æ¥å®šä½è¯¥æ–‡ä»¶</p></li><li><p><strong>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆ<code>slow log</code>ï¼‰</strong><br />å®šä½å¯èƒ½å­˜åœ¨é—®é¢˜çš„ <code>SQL</code> è¯­å¥ï¼Œä»è€Œè¿›è¡Œ <code>SQL</code> è¯­å¥å±‚é¢çš„ä¼˜åŒ–ã€‚<br />å¯é€šè¿‡è®¾ç½®å‚æ•° <code>long_query_time</code> æ¥è®¾ç½®é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º <code>10</code>ï¼‰ï¼Œå°†è¿è¡Œæ—¶é—´è¶…è¿‡è¯¥å€¼çš„æ‰€æœ‰ <code>SQL</code> è¯­å¥éƒ½è®°å½•åˆ°è¯¥æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p></li><li><p><strong>æŸ¥è¯¢æ—¥å¿—ï¼ˆ<code>log</code>ï¼‰</strong><br />è®°å½•æ‰€æœ‰å¯¹ <code>MySQL</code> æ•°æ®åº“è¯·æ±‚çš„ä¿¡æ¯ï¼Œæ— è®ºè¿™äº›è¯·æ±‚æ˜¯å¦å¾—åˆ°äº†æ­£ç¡®çš„æ‰§è¡Œã€‚<br />é»˜è®¤æ–‡ä»¶åä¸ºï¼š<code>ä¸»æœºå.log</code></p></li><li><p><strong>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆ<code>binlog</code>ï¼‰</strong><br />è®°å½•å¯¹ <code>MySQL</code> æ•°æ®åº“æ‰§è¡Œæ›´æ”¹çš„æ‰€æœ‰æ“ä½œï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ <code>SELECT</code> å’Œ <code>SHOW</code> è¿™ç±»æ“ä½œã€‚<br />ä½œç”¨ï¼š</p><ul><li>æ¢å¤ï¼ˆ<code>recovery</code>ï¼‰ï¼šæ•°æ®æ¢å¤</li><li>å¤åˆ¶ï¼ˆ<code>replication</code>ï¼‰ï¼šä¸»ä»åŒæ­¥</li><li>å®¡è®¡ï¼ˆ<code>audit</code>ï¼‰ï¼šåˆ¤æ–­æ˜¯å¦æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥æ”»å‡»</li></ul></li></ul><h1 id="å¥—æ¥å­—æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å¥—æ¥å­—æ–‡ä»¶"></a> å¥—æ¥å­—æ–‡ä»¶</h1><p>åœ¨ <code>UNIX</code> ç³»ç»Ÿä¸‹æœ¬åœ°è¿æ¥ <code>MySQL</code> å¯ä»¥é‡‡ç”¨ <code>UNIX</code> åŸŸå¥—æ¥å­—æ–¹å¼ï¼Œé€šè¿‡å¥—æ¥å­—ï¼ˆ<code>socket</code>ï¼‰æ–‡ä»¶è¿æ¥ã€‚</p><h1 id="pid-æ–‡ä»¶"><a class="markdownIt-Anchor" href="#pid-æ–‡ä»¶"></a> <code>pid</code> æ–‡ä»¶</h1><p>å½“ <code>MySQL</code> å®ä¾‹å¯åŠ¨æ—¶ï¼Œä¼šå°†è‡ªå·±çš„è¿›ç¨‹ <code>ID</code> å†™å…¥ä¸€ä¸ª <code>pid</code> æ–‡ä»¶ä¸­ã€‚<br />é»˜è®¤ä½äºæ•°æ®åº“ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åä¸ºï¼š<code>ä¸»æœºå.pid</code>ã€‚</p><h1 id="è¡¨ç»“æ„å®šä¹‰æ–‡ä»¶"><a class="markdownIt-Anchor" href="#è¡¨ç»“æ„å®šä¹‰æ–‡ä»¶"></a> è¡¨ç»“æ„å®šä¹‰æ–‡ä»¶</h1><p><code>MySQL</code> çš„æ•°æ®å­˜å‚¨æ˜¯æ ¹æ®è¡¨è¿›è¡Œçš„ï¼Œæ¯ä¸ªè¡¨/è§†å›¾éƒ½æœ‰ä¸€ä¸ªä»¥ <code>frm</code> ä¸ºåç¼€åçš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶è®°å½•äº†è¯¥è¡¨çš„è¡¨ç»“æ„å®šä¹‰ã€‚</p><h1 id="innodb-å­˜å‚¨å¼•æ“æ–‡ä»¶"><a class="markdownIt-Anchor" href="#innodb-å­˜å‚¨å¼•æ“æ–‡ä»¶"></a> <code>InnoDB</code> å­˜å‚¨å¼•æ“æ–‡ä»¶</h1><p>ä»¥ä¸Šæ–‡ä»¶éƒ½æ˜¯ <code>MySQL</code> æ•°æ®åº“æœ¬èº«çš„æ–‡ä»¶ï¼Œè€Œ <code>InnoDB</code> å­˜å‚¨å¼•æ“è¿˜æœ‰å…¶è‡ªå·±ç‹¬æœ‰çš„æ–‡ä»¶ã€‚</p><h2 id="è¡¨ç©ºé—´æ–‡ä»¶"><a class="markdownIt-Anchor" href="#è¡¨ç©ºé—´æ–‡ä»¶"></a> è¡¨ç©ºé—´æ–‡ä»¶</h2><p><code>InnoDB</code> é‡‡ç”¨å°†å­˜å‚¨çš„è¡¨ç©ºé—´ï¼ˆ<code>tablespace</code>ï¼‰è¿›è¡Œå­˜æ”¾çš„è®¾è®¡ï¼Œé»˜è®¤é…ç½®ä¸‹åˆå§‹å¤§å°ä¸º <code>10MB</code>ï¼Œæ–‡ä»¶åä¸º <code>ibdata1</code>ã€‚<br />è¡¨ç©ºé—´åˆ†ä¸ºå…±äº«è¡¨ç©ºé—´ä¸ç‹¬ç«‹è¡¨ç©ºé—´ï¼Œç”¨æˆ·å¯ä»¥å°†æ¯ä¸ªåŸºäº <code>InnoDB</code> å­˜å‚¨å¼•æ“çš„è¡¨äº§ç”Ÿä¸€ä¸ªç‹¬ç«‹è¡¨ç©ºé—´ï¼Œå•ç‹¬çš„è¡¨ç©ºé—´æ–‡ä»¶ä»…å­˜å‚¨è¯¥è¡¨çš„æ•°æ®ã€ç´¢å¼•å’Œæ’å…¥ç¼“å†² <code>BITMAP</code> ç­‰ä¿¡æ¯ï¼Œå…¶ä½™ä¿¡æ¯è¿˜æ˜¯å­˜æ”¾åœ¨é»˜è®¤çš„è¡¨ç©ºé—´ä¸­ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805144502.png" srcset="/img/loading.gif" alt="" /></p><h2 id="é‡åšæ—¥å¿—æ–‡ä»¶"><a class="markdownIt-Anchor" href="#é‡åšæ—¥å¿—æ–‡ä»¶"></a> é‡åšæ—¥å¿—æ–‡ä»¶</h2><p>å½“å®ä¾‹æˆ–ä»‹è´¨å¤±è´¥ï¼ˆ<code>media failure</code>ï¼‰æ—¶ï¼Œ<code>InnoDB</code> å­˜å‚¨å¼•æ“ä¼šä½¿ç”¨é‡åšæ—¥å¿—æ¢å¤åˆ°å®ä¾‹æ­£å¸¸çš„æ—¶åˆ»ï¼Œä»¥æ­¤æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><p>æ¯ä¸ª <code>InnoDB</code> å­˜å‚¨å¼•æ“è‡³å°‘æœ‰ <code>1</code> ä¸ªé‡åšæ—¥å¿—æ–‡ä»¶ç»„ï¼Œæ¯ä¸ªæ–‡ä»¶ç»„ä¸‹è‡³å°‘æœ‰ <code>2</code> ä¸ªé‡åšæ—¥å¿—æ–‡ä»¶ã€‚</p><p>é‡åšæ—¥å¿—æ–‡ä»¶çš„å¤§å°å¯¹å­˜å‚¨å¼•æ“çš„æ€§èƒ½æœ‰éå¸¸å¤§çš„å½±å“ã€‚</p><ul><li>å¦‚æœå¤ªå¤§ï¼Œåœ¨æ¢å¤æ—¶å¯èƒ½éœ€è¦å¾ˆé•¿çš„æ—¶é—´ï¼›</li><li>å¦‚æœå¤ªå°ï¼Œå¯èƒ½å¯¼è‡´ä¸€ä¸ªäº‹åŠ¡çš„æ—¥å¿—éœ€è¦å¤šæ¬¡åˆ‡æ¢é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œè¿˜ä¼šå‘†æ»é¢‘ç¹åœ°å‘ç”Ÿ <code>async checkpoint</code>ï¼Œå¯¼è‡´æ€§èƒ½çš„æŠ–åŠ¨ã€‚</li></ul><p><strong>ä¸äºŒè¿›åˆ¶æ—¥å¿—çš„åŒºåˆ«</strong>ï¼š</p><ul><li>äºŒè¿›åˆ¶æ—¥å¿—è®°å½•ä¸ <code>MySQL</code> æ•°æ®åº“æœ‰å…³çš„æ—¥å¿—è®°å½•ï¼ŒåŒ…æ‹¬<strong>æ‰€æœ‰å­˜å‚¨å¼•æ“</strong>çš„æ—¥å¿—ã€‚<br /><code>InnoDB</code> çš„é‡åšæ—¥å¿—åªè®°å½•<strong>è¯¥å­˜å‚¨å¼•æ“æœ¬èº«</strong>çš„äº‹åŠ¡æ—¥å¿—ã€‚</li><li>äºŒè¿›åˆ¶æ—¥å¿—è®°å½•å…³äºä¸€ä¸ªäº‹åŠ¡çš„<strong>å…·ä½“æ“ä½œå†…å®¹</strong>ã€‚<br />é‡åšæ—¥å¿—è®°å½•çš„æ˜¯æ¯ä¸ªé¡µçš„<strong>ç‰©ç†æ›´æ”¹</strong>æƒ…å†µã€‚</li><li>äºŒè¿›åˆ¶æ—¥å¿—ä»…åœ¨äº‹åŠ¡æäº¤å‰è¿›è¡Œæäº¤ï¼Œ<strong>åªå†™ç£ç›˜ä¸€æ¬¡</strong>ã€‚<br />è€Œäº‹åŠ¡è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­æœ‰é‡åšæ—¥å¿—æ¡ç›®è¢«å†™å…¥åˆ°é‡åšæ—¥å¿—æ–‡ä»¶ä¸­ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200805150220.png" srcset="/img/loading.gif" alt="" /><br /><strong>å†™å…¥æµç¨‹</strong>ï¼šå…ˆå†™å…¥ä¸€ä¸ªé‡åšæ—¥å¿—ç¼“å†²ï¼ˆ<code>redo log buffer</code>ï¼‰ä¸­ï¼Œç„¶åæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶é¡ºåºåœ°å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚<br /><strong>å†™å…¥æ¡ä»¶</strong>ï¼š</p><ul><li>ä¸»çº¿ç¨‹æ¯ç§’å†™å…¥é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œä¸è®ºäº‹åŠ¡æ˜¯å¦å·²ç»æäº¤ã€‚</li><li>åœ¨æäº¤ï¼ˆ<code>commit</code>ï¼‰æ“ä½œæ—¶ï¼Œè®¾ç½® <code>innodb_flush_log_at_trx_commit = 1</code>ï¼Œåœ¨ <code>commit</code> æäº¤æ—¶å°†é‡åšæ—¥å¿—ç¼“å†²åŒæ­¥å†™åˆ°ç£ç›˜ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</title>
    <link href="/2020/08/04/LeetCode-17-letter-combinations-of-a-phone-number/"/>
    <url>/2020/08/04/LeetCode-17-letter-combinations-of-a-phone-number/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/letter-combinations-of-a-phone-number/" target="_blank" rel="noopener">17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</a></p><h1 id="å›æº¯"><a class="markdownIt-Anchor" href="#å›æº¯"></a> å›æº¯</h1><p>é€‰æ‹©åˆ—è¡¨ï¼šæ¯ä¸ª <code>digit</code> å¯¹åº”çš„å­—æ¯åˆ—è¡¨<br />è·¯å¾„ï¼šå·²é€‰å­—æ¯ç»„åˆ + é€‰æ‹©åˆ—è¡¨çš„å­—æ¯<br />ç»ˆæ­¢æ¡ä»¶ï¼šé€’å½’æ·±åº¦è¾¾åˆ° <code>digits</code> çš„é•¿åº¦</p><pre><code class="hljs java"><span class="hljs-comment">// 2 ~ 9 æ¯ä¸ªä½ç½®æ‰€å¯¹åº”çš„é€‰æ‹©åˆ—è¡¨</span>String[] map = &#123;<span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"abc"</span>, <span class="hljs-string">"def"</span>, <span class="hljs-string">"ghi"</span>, <span class="hljs-string">"jkl"</span>, <span class="hljs-string">"mno"</span>, <span class="hljs-string">"pqrs"</span>, <span class="hljs-string">"tuv"</span>, <span class="hljs-string">"wxyz"</span>&#125;;List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">letterCombinations</span><span class="hljs-params">(String digits)</span> </span>&#123;    <span class="hljs-keyword">if</span> (digits.length() == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    combine(digits, <span class="hljs-string">""</span>, <span class="hljs-number">0</span>);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> digits</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> path   å½“å‰å·²é€‰æ‹©çš„ç»„åˆè·¯å¾„</span><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> len    å½“å‰é€’å½’åˆ°çš„ digits ä½ç½®</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">combine</span><span class="hljs-params">(String digits, String path, <span class="hljs-keyword">int</span> len)</span> </span>&#123;    <span class="hljs-comment">// é€’å½’æ·±åº¦ä¸º digits çš„é•¿åº¦</span>    <span class="hljs-keyword">if</span> (len == digits.length()) &#123;        res.add(path);        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-comment">// æ‰¾åˆ°å½“å‰ digit æ‰€å¯¹åº”çš„å­—æ¯ç»„åˆ</span>    <span class="hljs-keyword">char</span> c = digits.charAt(len);    <span class="hljs-keyword">int</span> pos = c - <span class="hljs-string">'0'</span>;    <span class="hljs-comment">// æ‰€éœ€è¦çš„é€‰æ‹©åˆ—è¡¨</span>    String candidateString = map[pos];    <span class="hljs-comment">// æšä¸¾æ¯ä¸ªå­—æ¯ç»„åˆ</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; candidateString.length(); i++) &#123;        <span class="hljs-comment">// è·¯å¾„ä¸ºï¼šä¸Šä¸€è½®çš„è·¯å¾„ + é€‰æ‹©åˆ—è¡¨ä¸­çš„æ¯ä¸ªå­—æ¯</span>        <span class="hljs-comment">// é€’å½’æ·±åº¦/è·¯å¾„é•¿åº¦ + 1</span>        combine(digits, path + candidateString.charAt(i), len + <span class="hljs-number">1</span>);    &#125;&#125;</code></pre><p><code>8.16</code> æŒ‰ç…§æ¨¡æ¿çš„å›æº¯è§£æ³•ï¼šæ·»åŠ  <code>add</code>ï¼Œ<code>remove</code> æ“ä½œã€‚<br />ä¸€å¼€å§‹ <code>path</code> ä½¿ç”¨çš„æ˜¯ <code>List</code>ï¼Œæ€»æ˜¯æ— æ³•é€šè¿‡ï¼Œåæ¥å‘ç°è‹¥æ˜¯ <code>digits</code> ç”±åŒä¸€ä¸ªæ•°å­—ç»„æˆçš„æƒ…å†µä¸‹ï¼Œè·¯å¾„ä¸­çš„å…ƒç´ å¯èƒ½æ˜¯é‡å¤çš„ï¼Œæ­¤æ—¶ä½¿ç”¨ <code>list.remove()</code> æ“ä½œä¼šåˆ é™¤é”™è¯¯ä½ç½®çš„å…ƒç´ ï¼Œä½¿ç”¨æ ˆçš„æ€æƒ³å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre><code class="hljs java">List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();String[] num2Str = &#123;<span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"abc"</span>, <span class="hljs-string">"def"</span>, <span class="hljs-string">"ghi"</span>, <span class="hljs-string">"jkl"</span>, <span class="hljs-string">"mno"</span>, <span class="hljs-string">"pqrs"</span>, <span class="hljs-string">"tuv"</span>, <span class="hljs-string">"wxyz"</span>&#125;;<span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">letterCombinations</span><span class="hljs-params">(String digits)</span> </span>&#123;    <span class="hljs-keyword">if</span> (digits.length() == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-comment">// ä½¿ç”¨ StringBuilder</span>    <span class="hljs-comment">// å¦‚æœä½¿ç”¨ Listï¼Œå½“ä¾‹å­ä¸º "999" ç­‰ç›¸åŒæ•°å­—æ—¶ï¼Œåœ¨å›æº¯æ—¶ remove ä¼šå‡ºé”™</span>    StringBuilder path = <span class="hljs-keyword">new</span> StringBuilder();    backtrack(<span class="hljs-number">0</span>, path, digits);    <span class="hljs-keyword">return</span> res;&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">backtrack</span><span class="hljs-params">(<span class="hljs-keyword">int</span> len, StringBuilder path, String digits)</span> </span>&#123;    <span class="hljs-keyword">if</span> (len == digits.length()) &#123;        res.add(path.toString());        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">int</span> pos = digits.charAt(len) - <span class="hljs-string">'0'</span>;    String str = num2Str[pos];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; str.length(); j++) &#123;        String candidate = String.valueOf(str.charAt(j));        <span class="hljs-comment">// æœ«å°¾æ·»åŠ </span>        path.append(candidate);        backtrack(len + <span class="hljs-number">1</span>, path, digits);        <span class="hljs-comment">// æœ«å°¾åˆ é™¤</span>        path.deleteCharAt(path.length() - <span class="hljs-number">1</span>);    &#125;&#125;</code></pre><h1 id="é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#é˜Ÿåˆ—"></a> é˜Ÿåˆ—</h1><blockquote><p>â€˜â€™<br />a, b, c<br />b, c, ad, ae, af<br />â€¦</p></blockquote><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">letterCombinations</span><span class="hljs-params">(String digits)</span> </span>&#123;    List&lt;String&gt; res = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();    <span class="hljs-keyword">if</span> (digits.length() == <span class="hljs-number">0</span>) &#123;        <span class="hljs-keyword">return</span> res;    &#125;    <span class="hljs-comment">// 2 ~ 9 æ¯ä¸ªä½ç½®æ‰€å¯¹åº”çš„é€‰æ‹©åˆ—è¡¨</span>    String[] map = &#123;<span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"abc"</span>, <span class="hljs-string">"def"</span>, <span class="hljs-string">"ghi"</span>, <span class="hljs-string">"jkl"</span>, <span class="hljs-string">"mno"</span>, <span class="hljs-string">"pqrs"</span>, <span class="hljs-string">"tuv"</span>, <span class="hljs-string">"wxyz"</span>&#125;;    <span class="hljs-comment">// æ·»åŠ ç©ºå…ƒç´ ï¼Œåˆå§‹åŒ–æ—¶ä½¿ç¬¬ä¸€ä¸ªä½ç½®çš„å­—æ¯å…¥é˜Ÿ</span>    res.add(<span class="hljs-string">""</span>);    <span class="hljs-comment">// 1. éå† digits e.g. "23"</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; digits.length(); i++) &#123;        <span class="hljs-keyword">int</span> pos = digits.charAt(i) - <span class="hljs-string">'0'</span>;        <span class="hljs-comment">// é€‰æ‹©åˆ—è¡¨ e.g. "def"</span>        String candidateStr = map[pos];        <span class="hljs-comment">// 2. éå†é˜Ÿåˆ—ï¼Œç»„åˆå­—æ¯ res: a, b, c</span>        <span class="hljs-comment">// !! å…ˆç¼“å­˜å½“å‰çš„é˜Ÿåˆ—é•¿åº¦ï¼Œå¦åˆ™åŠ¨æ€ add path æ—¶ï¼Œé˜Ÿåˆ—é•¿åº¦åœ¨å˜åŒ–</span>        <span class="hljs-keyword">int</span> size = res.size();        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; size; j++) &#123;            <span class="hljs-comment">// é˜Ÿå¤´å‡ºé˜Ÿ e.g. a</span>            String path = res.remove(<span class="hljs-number">0</span>);            <span class="hljs-comment">// 3. ç»„åˆé˜Ÿå¤´å’Œé€‰æ‹©åˆ—è¡¨</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; candidateStr.length(); k++) &#123;                <span class="hljs-comment">// b, c, ad, ae, af</span>                res.add(path + candidateStr.charAt(k));            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> res;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>BFS</tag>
      
      <tag>å›æº¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB å­˜å‚¨å¼•æ“</title>
    <link href="/2020/08/04/InnoDB-engine/"/>
    <url>/2020/08/04/InnoDB-engine/</url>
    
    <content type="html"><![CDATA[<h1 id="mysql-ä½“ç³»ç»“æ„"><a class="markdownIt-Anchor" href="#mysql-ä½“ç³»ç»“æ„"></a> MySQL ä½“ç³»ç»“æ„</h1><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200804132116.png" srcset="/img/loading.gif" alt="" /></p><ul><li>è¿æ¥æ± ç»„ä»¶</li><li>ç®¡ç†æœåŠ¡å’Œå·¥å…·ç±»</li><li><code>SQL</code> æ¥å£ç»„ä»¶</li><li>æŸ¥è¯¢åˆ†æå™¨ç»„ä»¶</li><li>ä¼˜åŒ–å™¨ç»„ä»¶</li><li>ç¼“å†²ç»„ä»¶</li><li>æ’ä»¶å¼å­˜å‚¨å¼•æ“</li><li>ç‰©ç†æ–‡ä»¶</li></ul><blockquote><p>å­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œè€Œä¸æ˜¯æ•°æ®åº“ã€‚</p></blockquote><h1 id="innodb-ä½“ç³»æ¶æ„"><a class="markdownIt-Anchor" href="#innodb-ä½“ç³»æ¶æ„"></a> <code>InnoDB</code> ä½“ç³»æ¶æ„</h1><p><code>InnoDB</code> å­˜å‚¨å¼•æ“æœ‰å¤šä¸ªå†…å­˜å—ï¼Œå¯ä»¥è®¤ä¸ºè¿™äº›å†…å­˜å—ç»„æˆäº†ä¸€ä¸ªå¤§çš„å†…å­˜æ± ï¼šè´Ÿè´£ä»¥ä¸‹å·¥ä½œï¼š</p><ul><li>ç»´æŠ¤æ‰€æœ‰è¿›ç¨‹ã€çº¿ç¨‹éœ€è¦è®¿é—®çš„å¤šä¸ªå†…éƒ¨æ•°æ®ç»“æ„</li><li>ç¼“å­˜ç£ç›˜æ•°æ®</li><li>é‡åšæ—¥å¿—ç¼“å†²</li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200804133649.png" srcset="/img/loading.gif" alt="" /></p><p>åå°çº¿ç¨‹çš„ä¸»è¦ä½œç”¨æ˜¯<strong>è´Ÿè´£åˆ·æ–°å†…å­˜æ± ä¸­çš„æ•°æ®</strong>ï¼Œä¿è¯ç¼“å†²æ± ä¸­çš„å†…å­˜ç¼“å­˜çš„æ˜¯æœ€è¿‘çš„æ•°æ®ã€‚æ­¤å¤–å°†å·²ä¿®æ”¹çš„æ•°æ®æ–‡ä»¶åˆ·æ–°åˆ°ç£ç›˜æ–‡ä»¶ï¼ŒåŒæ—¶ä¿è¯åœ¨æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹ <code>InnoDB</code> èƒ½æ¢å¤åˆ°æ­£å¸¸è¿è¡ŒçŠ¶æ€ã€‚</p><h2 id="åå°çº¿ç¨‹"><a class="markdownIt-Anchor" href="#åå°çº¿ç¨‹"></a> åå°çº¿ç¨‹</h2><ul><li><p><code>Master Thread</code><br /><code>Master Thread</code> æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒçš„åå°çº¿ç¨‹ï¼Œä¸»è¦è´Ÿè´£å°†ç¼“å†²æ± ä¸­çš„<strong>æ•°æ®å¼‚æ­¥åˆ·æ–°</strong>åˆ°ç£ç›˜ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚åŒ…æ‹¬è„é¡µçš„åˆ·æ–°ã€åˆå¹¶æ’å…¥ç¼“å†²ã€<code>UNDO</code> é¡µçš„å›æ”¶ç­‰ã€‚</p></li><li><p><code>IO Thread</code><br /><code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸­å¤§é‡ä½¿ç”¨äº† <code>AIO</code> æ¥å¤„ç†å†™è¯·æ±‚ï¼Œ<code>IO Thread</code> çš„å·¥ä½œä¸»è¦æ˜¯è´Ÿè´£è¿™äº› <strong><code>IO</code> è¯·æ±‚çš„å›è°ƒå¤„ç†</strong>ã€‚</p></li><li><p><code>Purge Thread</code><br />äº‹åŠ¡è¢«æäº¤åï¼Œå…¶æ‰€ä½¿ç”¨çš„ <code>undolog</code> å¯èƒ½ä¸å†éœ€è¦ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ <code>Purge Thread</code> æ¥<strong>å›æ”¶</strong>å·²ç»ä½¿ç”¨å¹¶åˆ†é…çš„ <code>undo</code> é¡µã€‚</p></li><li><p><code>Page Cleaner Thread</code><br />å…¶ä½œç”¨æ˜¯å°†<strong>è„é¡µçš„åˆ·æ–°æ“ä½œ</strong>éƒ½æ”¾å…¥åˆ°å•ç‹¬çš„çº¿ç¨‹ä¸­æ¥å®Œæˆï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†å‡è½» <code>Master Thread</code> çš„å·¥ä½œåŠå¯¹äºç”¨æˆ·æŸ¥è¯¢çº¿ç¨‹çš„é˜»å¡ï¼Œè¿›ä¸€æ­¥æé«˜ <code>InnoDB</code> çš„æ€§èƒ½ã€‚</p></li></ul><h2 id="å†…å­˜"><a class="markdownIt-Anchor" href="#å†…å­˜"></a> å†…å­˜</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200804135715.png" srcset="/img/loading.gif" alt="" /></p><h3 id="ç¼“å†²æ± "><a class="markdownIt-Anchor" href="#ç¼“å†²æ± "></a> ç¼“å†²æ± </h3><p><code>InnoDB</code> å­˜å‚¨å¼•æ“æ˜¯åŸºäºç£ç›˜å­˜å‚¨çš„ï¼Œå¹¶å°†å…¶ä¸­çš„è®°å½•æŒ‰ç…§é¡µçš„æ–¹å¼è¿›è¡Œç®¡ç†ã€‚<br />å¯¹äºæ•°æ®åº“ä¸­é¡µçš„ä¿®æ”¹æ“ä½œï¼Œé¦–å…ˆä¿®æ”¹åœ¨ç¼“å†²æ± ä¸­çš„é¡µï¼Œç„¶åå†é€šè¿‡ <code>Checkpoint</code> æœºåˆ¶åˆ·æ–°åˆ°ç£ç›˜ä¸Šã€‚</p><h3 id="lru-list-free-list-flush-list"><a class="markdownIt-Anchor" href="#lru-list-free-list-flush-list"></a> <code>LRU List</code>, <code>Free List</code>, <code>Flush List</code></h3><p><code>InnoDB</code> å­˜å‚¨å¼•æ“ä¸­ï¼Œ<code>LRU List</code> ä¸­è¿˜åŠ å…¥äº† <code>midpoint</code> ä½ç½®ï¼Œ<code>midpoint</code> ä¹‹åçš„åˆ—è¡¨ç§°ä¸º <code>old</code> åˆ—è¡¨ï¼Œ ä¹‹å‰çš„åˆ—è¡¨ç§°ä¸º <code>new</code> åˆ—è¡¨ï¼Œ<code>new</code> åˆ—è¡¨ä¸­çš„é¡µéƒ½æ˜¯æœ€ä¸ºæ´»è·ƒçš„çƒ­ç‚¹æ•°æ®ã€‚æ–°è¯»å–åˆ°çš„é¡µï¼Œå¹¶ä¸æ˜¯ç›´æ¥æ”¾å…¥ <code>LRU</code> åˆ—è¡¨çš„é¦–éƒ¨ï¼Œè€Œæ˜¯æ”¾å…¥ <code>LRU</code> åˆ—è¡¨çš„ <code>midpoint</code> ä½ç½®ã€‚åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œè¿™ä¸ªä½ç½®åœ¨ <code>LRU</code> åˆ—è¡¨é•¿åº¦çš„ <code>5/8</code> å¤„ã€‚</p><blockquote><p>é‚£ä¸ºä»€ä¹ˆä¸é‡‡ç”¨æœ´ç´ çš„ <code>LRU</code> ç®—æ³•ï¼Œç›´æ¥å°†è¯»å–çš„é¡µæ”¾å…¥åˆ° <code>LRU List</code> çš„é¦–éƒ¨å‘¢ï¼Ÿ<br />è‹¥ç›´æ¥å°†è¯»å–åˆ°çš„é¡µæ”¾äººåˆ° <code>LRU</code> çš„é¦–éƒ¨ï¼Œé‚£ä¹ˆæŸäº› <code>SQL</code> æ“ä½œå¯èƒ½ä¼šä½¿ç¼“å†²æ± ä¸­çš„çƒ­ç‚¹æ•°æ®è¢«åˆ·æ–°ï¼Œè€Œåœ¨ä¸‹ä¸€æ¬¡éœ€è¦è¯»å–è¯¥é¡µæ—¶ï¼Œéœ€è¦å†æ¬¡è®¿é—®ç£ç›˜ã€‚<br />å¸¸è§çš„è¿™ç±»æ“ä½œä¸º<strong>ç´¢å¼•</strong>æˆ–<strong>æ•°æ®çš„æ‰«æ</strong>æ“ä½œã€‚è¿™ç±»æ“ä½œéœ€è¦è®¿é—®è¡¨ä¸­çš„è®¸å¤šé¡µï¼Œç”šè‡³æ˜¯å…¨éƒ¨çš„é¡µï¼Œè€Œè¿™äº›é¡µé€šå¸¸æ¥è¯´åˆä»…åœ¨è¿™æ¬¡æŸ¥è¯¢æ“ä½œä¸­éœ€è¦ï¼Œå¹¶ä¸æ˜¯æ´»è·ƒçš„çƒ­ç‚¹æ•°æ®ã€‚</p></blockquote><p><code>LRU List</code> ç”¨æ¥ç®¡ç†å·²ç»è¯»å–çš„é¡µï¼Œä½†å½“æ•°æ®åº“åˆšå¯åŠ¨æ—¶ï¼Œ<code>LRU List</code> æ˜¯ç©ºçš„ï¼Œå³æ²¡æœ‰ä»»ä½•çš„é¡µã€‚è¿™æ—¶é¡µéƒ½å­˜æ”¾åœ¨ <code>Free List</code> ä¸­ã€‚å½“éœ€è¦ä»ç¼“å†²æ± ä¸­åˆ†é¡µæ—¶ï¼Œé¦–å…ˆä» <code>Free List</code> ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰å¯ç”¨çš„ç©ºé—²é¡µ</p><ul><li>è‹¥æœ‰åˆ™å°†è¯¥é¡µä» <code>Free List</code> ä¸­åˆ é™¤ï¼Œæ”¾å…¥åˆ° <code>LRU List</code> ä¸­ã€‚</li><li>å¦åˆ™ï¼Œæ ¹æ® <code>LRU</code> ç®—æ³•ï¼Œæ·˜æ±° <code>LRU List</code> æœ«å°¾çš„é¡µï¼Œå°†è¯¥å†…å­˜ç©ºé—´åˆ†é…ç»™æ–°çš„é¡µã€‚</li></ul><ul><li><code>page made young</code>: é¡µä» <code>LRU List</code> çš„ <code>old</code> éƒ¨åˆ†åŠ å…¥åˆ° <code>new</code> éƒ¨åˆ†ã€‚</li><li><code>page not made young</code>: å› ä¸º <code>innodb-old_blocks-time</code> çš„è®¾ç½®è€Œå¯¼è‡´é¡µæ²¡æœ‰ä» <code>old</code> éƒ¨åˆ†ç§»åŠ¨åˆ° <code>new</code> éƒ¨åˆ†ã€‚</li></ul><p>å½“ <code>LRU List</code> ä¸­çš„é¡µè¢«ä¿®æ”¹åï¼Œç§°è¯¥é¡µä¸ºè„é¡µï¼ˆ<code>dirty page</code>ï¼‰ï¼Œå³ç¼“å†²æ± ä¸­çš„é¡µå’Œç£ç›˜ä¸Šçš„é¡µæ•°æ®äº§ç”Ÿäº†ä¸ä¸€è‡´ã€‚è¿™æ—¶å€™æ•°æ®åº“ä¼šé€šè¿‡ <code>checkpoint</code> æœºåˆ¶å°†è„é¡µåˆ·æ–°å›ç£ç›˜ï¼Œè€Œ <code>Flush List</code> ä¸­çš„é¡µå³ä¸ºè„é¡µåˆ—è¡¨ã€‚æ³¨æ„è„é¡µä¹Ÿå­˜åœ¨äº <code>LRU List</code> ä¸­ã€‚</p><h3 id="é‡åšæ—¥å¿—ç¼“å†²"><a class="markdownIt-Anchor" href="#é‡åšæ—¥å¿—ç¼“å†²"></a> é‡åšæ—¥å¿—ç¼“å†²</h3><p><code>InnoDB</code> å¼•æ“é¦–å…ˆå°†é‡åšæ—¥å¿—ä¿¡æ¯å…ˆæ”¾åˆ°é‡åšæ—¥å¿—ç¼“å†²åŒº(<code>redo log buffer</code>)ï¼Œç„¶åæŒ‰ä¸€å®šé¢‘ç‡åˆ·æ–°åˆ°é‡åšæ—¥å¿—æ–‡ä»¶ã€‚é‡åšæ—¥å¿—ç¼“å†²ä¸éœ€è¦è®¾ç½®å¾ˆå¤§ï¼Œä¸€èˆ¬æ¯ä¸€ç§’éƒ½ä¼šåˆ·æ–° <code>redo log buffer</code>ï¼Œé…ç½®çš„å¤§å°åªéœ€è¦ä¿è¯æ¯ç§’äº§ç”Ÿçš„äº‹åŠ¡åœ¨è¿™ä¸ªç¼“å†²åŒºå¤§å°ä¹‹å†…å³å¯ã€‚é€šè¿‡å‚æ•° <code>innodb_log_buffer_size</code> è®¾ç½®ã€‚<br />åœ¨ä¸‹åˆ—æƒ…å†µä¸‹ä¼šå°†é‡åšæ—¥å¿—ç¼“å†²ä¸­çš„å†…å®¹åˆ·æ–°åˆ°ç£ç›˜é‡åšæ—¥å¿—æ–‡ä»¶ä¸­ï¼š</p><ul><li><code>Master Thread</code> æ¯ä¸€ç§’ä¸­åˆ·æ–°ä¸€æ¬¡ï¼›</li><li>æ¯ä¸ªäº‹åŠ¡æäº¤æ—¶ä¼šåˆ·æ–°ï¼›</li><li>å½“é‡åšæ—¥å¿—ç¼“å†²åŒºç©ºé—´å°äº <code>1/2</code> æ—¶ä¼šåˆ·æ–°ã€‚</li></ul><h3 id="é¢å¤–çš„å†…å­˜æ± "><a class="markdownIt-Anchor" href="#é¢å¤–çš„å†…å­˜æ± "></a> é¢å¤–çš„å†…å­˜æ± </h3><p>é¢å¤–çš„å†…å­˜æ± ç”¨æ¥å¯¹ä¸€äº›æ•°æ®ç»“æ„æœ¬èº«çš„å†…å­˜è¿›è¡Œåˆ†é…ï¼Œä¾‹å¦‚ç¼“å†²æ§åˆ¶å¯¹è±¡(<code>buffer control block</code>)è®°å½•çš„ <code>LRU</code>ï¼Œé”ï¼Œç­‰å¾…ç­‰ä¿¡æ¯ã€‚é¢å¤–çš„å†…å­˜æ± ä¸å¤Ÿæ—¶ä¼šä»ç¼“å†²æ± ä¸­è¿›è¡Œç”³è¯·ã€‚å› æ­¤ï¼Œåœ¨ç”³è¯·äº†å¾ˆå¤§çš„ <code>InnoDB</code> ç¼“å†²æ± æ—¶ï¼Œé¢å¤–çš„å†…å­˜æ± ä¹Ÿè¦é€‚å½“çš„è°ƒå¤§ã€‚é€šè¿‡å‚æ•° <code>innodb_additional_mem_pool_size</code> æ¥è®¾ç½®å¤§å°ã€‚</p><h1 id="checkpoint-æŠ€æœ¯"><a class="markdownIt-Anchor" href="#checkpoint-æŠ€æœ¯"></a> <code>Checkpoint</code> æŠ€æœ¯</h1><p>ä½œç”¨ï¼šå°†è„é¡µåˆ·æ–°åˆ°ç£ç›˜ã€‚<br />ç›®çš„ï¼š</p><ul><li>ç¼©çŸ­æ•°æ®åº“çš„æ¢å¤æ—¶é—´</li><li>ç¼“å†²æ± ä¸å¤Ÿç”¨æ—¶ï¼Œå°†è„é¡µåˆ·æ–°åˆ°ç£ç›˜</li><li>é‡åšæ—¥å¿—ä¸å¯ç”¨æ—¶ï¼Œåˆ·æ–°è„é¡µ</li></ul><p>ç±»å‹ï¼š</p><ul><li><code>Sharp Checkpoint</code> - æ•°æ®åº“å…³é—­æ—¶å°†æ‰€æœ‰çš„è„é¡µéƒ½åˆ·æ–°å›ç£ç›˜ã€‚</li><li><code>Fuzzy Checkpoint</code>:<ul><li><code>Master THread Checkpoint</code> - æ¯ç§’æˆ–æ¯åç§’åˆ·æ–°</li><li><code>FLUSH_LRU_LIST Checkpoint</code> - è„é¡µæ¥è‡ªäº <code>LRU List</code></li><li><code>Async/Sync Flush Checkpoint</code> - é‡åšæ—¥å¿—ä¸å¯ç”¨ï¼Œå¼ºåˆ¶åˆ·æ–°è„é¡µ</li><li><code>Dirty Page too mush Checkpoint</code> - è„é¡µå¤ªå¤šå¼ºåˆ¶åˆ·æ–°</li></ul></li></ul><h1 id="master-thread-å·¥ä½œæ–¹å¼"><a class="markdownIt-Anchor" href="#master-thread-å·¥ä½œæ–¹å¼"></a> <code>Master Thread</code> å·¥ä½œæ–¹å¼</h1><p><code>Master Thread</code> å…·æœ‰<strong>æœ€é«˜çš„çº¿ç¨‹ä¼˜å…ˆçº§åˆ«</strong>ï¼Œå…¶å†…éƒ¨ç”±å¤šä¸ªå¾ªç¯ç»„æˆ</p><ul><li>ä¸»å¾ªç¯ï¼ˆ<code>loop</code>ï¼‰</li><li>åå°å¾ªç¯ï¼ˆ<code>background loop</code>ï¼‰</li><li>åˆ·æ–°å¾ªç¯ï¼ˆ<code>lush loop</code>ï¼‰</li><li>æš‚åœå¾ªç¯ï¼ˆ<code>suspend loop</code>ï¼‰</li></ul><h2 id="ä¸»å¾ªç¯"><a class="markdownIt-Anchor" href="#ä¸»å¾ªç¯"></a> ä¸»å¾ªç¯</h2><p>å¤§å¤šæ•°çš„æ“ä½œéƒ½æ˜¯åœ¨<strong>ä¸»å¾ªç¯</strong>ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬æ¯ç§’çš„æ“ä½œå’Œæ¯ <code>10</code> ç§’çš„æ“ä½œã€‚</p><p>æ¯ç§’çš„æ“ä½œï¼š</p><ul><li>æ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ï¼Œå³ä½¿è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤ï¼ˆæ€»æ˜¯ï¼‰</li><li>åˆå¹¶æ’å…¥ç¼“å†²ï¼ˆå‰ä¸€ç§’ <code>IO</code> å°äº <code>5</code> æ¬¡ï¼‰</li><li>è‡³å¤šåˆ·æ–° <code>100</code> ä¸ª è„é¡µåˆ°ç£ç›˜ï¼ˆè„é¡µæ¯”ä¾‹è¶…è¿‡é˜ˆå€¼ï¼‰</li><li>å¦‚æœæ²¡æœ‰ç”¨æˆ·æ´»åŠ¨ï¼Œåˆ‡æ¢åˆ°åå°å¾ªç¯</li></ul><p>æ¯ <code>10</code> ç§’çš„æ“ä½œï¼š</p><ul><li>åˆ·æ–° <code>100</code> ä¸ªè„é¡µåˆ°ç£ç›˜ï¼ˆè¿‡å» <code>10</code> ç§’ <code>IO</code> å°äº <code>200</code> æ¬¡ï¼‰</li><li>åˆå¹¶è‡³å¤š <code>5</code> ä¸ªæ’å…¥ç¼“å†²ï¼ˆæ€»æ˜¯ï¼‰</li><li>å°†æ—¥å¿—ç¼“å†²åˆ·æ–°åˆ°ç£ç›˜ ï¼ˆæ€»æ˜¯ï¼‰</li><li>åˆ é™¤æ— ç”¨çš„ <code>undo</code> é¡µï¼ˆæ€»æ˜¯ï¼‰</li><li>åˆ·æ–° <code>100</code> ä¸ªæˆ–è€… <code>10</code> ä¸ªè„é¡µåˆ°ç£ç›˜ï¼ˆæ€»æ˜¯ï¼‰</li></ul><h2 id="åå°å¾ªç¯"><a class="markdownIt-Anchor" href="#åå°å¾ªç¯"></a> åå°å¾ªç¯</h2><blockquote><p>å½“å‰æ²¡æœ‰ç”¨æˆ·æ´»åŠ¨ï¼ˆæ•°æ®åº“ç©ºé—²æ—¶ï¼‰æˆ–æ•°æ®åº“å…³é—­æ—¶ï¼Œåˆ‡æ¢åˆ°åå°å¾ªç¯ã€‚<br />æ“ä½œï¼š</p></blockquote><ul><li>åˆ é™¤æ— ç”¨çš„ <code>undo</code> é¡µï¼ˆæ€»æ˜¯ï¼‰</li><li>åˆå¹¶ <code>20</code> ä¸ªæ’å…¥ç¼“å†²ï¼ˆæ€»æ˜¯ï¼‰</li><li>è°ƒå›åˆ°ä¸»å¾ªç¯ï¼ˆæ€»æ˜¯ï¼‰</li><li>ä¸æ–­åˆ·æ–° <code>100</code> ä¸ªé¡µç›´åˆ°ç¬¦åˆæ¡ä»¶ï¼ˆå¯èƒ½ï¼Œè·³è½¬åˆ° <code>flush loop</code> ä¸­å®Œæˆï¼‰</li></ul><h1 id="innodb-å…³é”®ç‰¹æ€§"><a class="markdownIt-Anchor" href="#innodb-å…³é”®ç‰¹æ€§"></a> <code>InnoDB</code> å…³é”®ç‰¹æ€§</h1><h2 id="æ’å…¥ç¼“å†²"><a class="markdownIt-Anchor" href="#æ’å…¥ç¼“å†²"></a> æ’å…¥ç¼“å†²</h2><h3 id="insert-buffer"><a class="markdownIt-Anchor" href="#insert-buffer"></a> <code>Insert Buffer</code></h3><p>å¯¹äº<strong>éèšé›†ç´¢å¼•</strong>çš„æ’å…¥æˆ–æ›´æ–°æ“ä½œï¼Œä¸æ˜¯æ¯ä¸€æ¬¡ç›´æ¥æ’å…¥åˆ°ç´¢å¼•é¡µä¸­ï¼Œè€Œæ˜¯å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œè‹¥åœ¨åˆ™ç›´æ¥æ’å…¥ï¼›è‹¥ä¸åœ¨ï¼Œåˆ™å…ˆæ”¾å…¥åˆ°ä¸€ä¸ª <code>Insert Buffr</code> å¯¹è±¡ä¸­ã€‚<br />ç„¶åå†ä»¥ä¸€å®šé¢‘ç‡å’Œæƒ…å†µè¿›è¡Œæ’å…¥ç¼“å†²çš„åˆå¹¶æ“ä½œï¼Œå°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ã€‚</p><p>ä½¿ç”¨æ¡ä»¶ï¼š</p><ol><li>ç´¢å¼•æ˜¯è¾…åŠ©ç´¢å¼•</li><li>ç´¢å¼•ä¸æ˜¯å”¯ä¸€çš„</li></ol><h3 id="change-buffer"><a class="markdownIt-Anchor" href="#change-buffer"></a> <code>Change Buffer</code></h3><p><code>Change Buffer</code> å¯è§†ä¸º <code>Insert Buffer</code> çš„å‡çº§ï¼Œå¯ä»¥å¯¹ <code>DML</code> æ“ä½œï¼š<code>INSERT</code>, <code>DELETE</code>, <code>UPDATE</code> éƒ½è¿›è¡Œç¼“å†²ï¼Œåˆ†åˆ«æ˜¯ï¼š<code>Insert Buffer</code>, <code>Delete Buffer</code>, <code>Purge Buffer</code>ã€‚</p><p>é€‚ç”¨å¯¹è±¡ä¾ç„¶æ˜¯<strong>éå”¯ä¸€çš„è¾…åŠ©ç´¢å¼•</strong>ã€‚<br /><code>Insert/Change Buffer</code> æ˜¯ä¸€æ£µ <code>B+</code> æ ‘ã€‚</p><p>æ“ä½œè¿‡ç¨‹ï¼š</p><ol><li>å°†è®°å½•æ ‡è®°ä¸ºå·²åˆ é™¤ï¼ˆ<code>Delete Buffer</code>ï¼‰ï¼›</li><li>çœŸæ­£å°†è®°å½•åˆ é™¤ï¼ˆ<code>Purge Buffer</code>ï¼‰ã€‚</li></ol><h3 id="merge-insert-buffer"><a class="markdownIt-Anchor" href="#merge-insert-buffer"></a> <code>Merge Insert Buffer</code></h3><p><code>Merge Insert Buffer</code> çš„æ“ä½œå¯èƒ½å‘ç”Ÿåœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹ï¼š</p><ul><li>è¾…åŠ©ç´¢å¼•é¡µè¢«è¯»å–åˆ°ç¼“å†²æ± æ—¶ï¼›</li><li><code>Insert Buffer Bitmap</code> é¡µè¿½è¸ªåˆ°è¯¥è¾…åŠ©ç´¢å¼•é¡µå·²æ— å¯ç”¨ç©ºé—´æ—¶ï¼›</li><li><code>Master Thread</code>ï¼šæ¯ç§’æˆ–æ¯ <code>10</code> ç§’ã€‚</li></ul><h2 id="ä¸¤æ¬¡å†™"><a class="markdownIt-Anchor" href="#ä¸¤æ¬¡å†™"></a> ä¸¤æ¬¡å†™</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200804162449.png" srcset="/img/loading.gif" alt="" /></p><ol><li>å½“åˆ·æ–°ç¼“å†²æ± è„é¡µæ—¶ï¼Œå¹¶ä¸ç›´æ¥å†™åˆ°æ•°æ®æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯å…ˆæ‹·è´è‡³å†…å­˜ä¸­çš„ä¸¤æ¬¡å†™ç¼“å†²åŒºï¼›</li><li>æ¥ç€ä»ä¸¤æ¬¡å†™ç¼“å†²åŒºåˆ†ä¸¤æ¬¡å†™å…¥ç£ç›˜å…±äº«è¡¨ç©ºé—´ä¸­ï¼Œæ¯æ¬¡å†™å…¥ <code>1MB</code>ï¼›</li><li>å¾…ç¬¬2æ­¥å®Œæˆåï¼Œå†å°†ä¸¤æ¬¡å†™ç¼“å†²åŒºå†™å…¥æ•°æ®æ–‡ä»¶ã€‚</li></ol><p>è¿™æ ·å°±å¯ä»¥è§£å†³<strong>éƒ¨åˆ†å†™å¤±æ•ˆ</strong>çš„é—®é¢˜ï¼Œå› ä¸ºåœ¨ç£ç›˜å…±äº«è¡¨ç©ºé—´ä¸­å·²æœ‰æ•°æ®é¡µå‰¯æœ¬æ‹·è´ï¼Œå¦‚æœæ•°æ®åº“åœ¨é¡µå†™å…¥æ•°æ®æ–‡ä»¶çš„è¿‡ç¨‹ä¸­å®•æœºï¼Œåœ¨å®ä¾‹æ¢å¤æ—¶ï¼Œå¯ä»¥ä»å…±äº«è¡¨ç©ºé—´ä¸­æ‰¾åˆ°è¯¥é¡µå‰¯æœ¬ï¼Œå°†å…¶æ‹·è´è¦†ç›–åŸæœ‰çš„æ•°æ®é¡µï¼Œå†åº”ç”¨é‡åšæ—¥å¿—å³å¯ã€‚</p><h2 id="è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•"><a class="markdownIt-Anchor" href="#è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•"></a> è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•</h2><blockquote><p><code>InnoDB</code> ä¼šè‡ªåŠ¨æ ¹æ®è®¿é—®çš„é¢‘ç‡å’Œæ¨¡å¼æ¥è‡ªåŠ¨åœ°ä¸ºæŸäº›çƒ­ç‚¹é¡µå»ºç«‹å“ˆå¸Œç´¢å¼•ã€‚å®ƒæ˜¯é€šè¿‡ç¼“å†²æ± ä¸­çš„ <code>B+</code> æ ‘æ„é€ è€Œæ¥ï¼Œä¸”ä¸éœ€è¦å¯¹æ•´ä¸ªè¡¨å»ºç«‹å“ˆå¸Œç´¢å¼•ï¼Œå› æ­¤å®ƒçš„é€Ÿåº¦éå¸¸å¿«ã€‚</p></blockquote><p><code>InnoDB</code> é‡‡ç”¨è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œå®ƒä¼šå®æ—¶ç›‘æ§è¡¨ä¸Šç´¢å¼•çš„ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœè®¤ä¸ºå»ºç«‹å“ˆå¸Œç´¢å¼•å¯ä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œåˆ™è‡ªåŠ¨åœ¨å†…å­˜ä¸­çš„â€œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ç¼“å†²åŒºâ€å»ºç«‹å“ˆå¸Œç´¢å¼•ã€‚</p><h2 id="å¼‚æ­¥-io"><a class="markdownIt-Anchor" href="#å¼‚æ­¥-io"></a> å¼‚æ­¥ IO</h2><ul><li><code>AIO</code> å¯ä»¥ä½¿ç”¨æˆ·åœ¨å‘å‡ºä¸€ä¸ª <code>IO</code> è¯·æ±‚åç«‹å³å†å‘å‡ºå¦ä¸€ä¸ª <code>IO</code> è¯·æ±‚ï¼Œå½“å…¨éƒ¨è¯·æ±‚å‘é€å®Œæ¯•åï¼Œç­‰å¾…æ‰€æœ‰ <code>IO</code> æ“ä½œçš„å®Œæˆã€‚</li><li>å¯ä»¥è¿›è¡Œ <code>IO Merge</code> æ“ä½œï¼Œå°†å¤šä¸ª <code>IO</code> åˆå¹¶ä¸º <code>1</code> ä¸ª <code>IO</code>ã€‚</li></ul><h2 id="åˆ·æ–°é‚»æ¥é¡µ"><a class="markdownIt-Anchor" href="#åˆ·æ–°é‚»æ¥é¡µ"></a> åˆ·æ–°é‚»æ¥é¡µ</h2><p>å½“åˆ·æ–°ä¸€ä¸ªè„é¡µæ—¶ï¼Œ<code>InnoDB</code> ä¼šæ£€æµ‹è¯¥é¡µæ‰€åœ¨åŒºçš„æ‰€æœ‰é¡µï¼Œå¦‚æœæ˜¯è„é¡µï¼Œé‚£ä¹ˆä¸€èµ·è¿›è¡Œåˆ·æ–°ã€‚<br />å¥½å¤„æ˜¯é€šè¿‡ <code>AIO</code> å°†å¤šä¸ª <code>IO</code> å†™å…¥æ“ä½œåˆå¹¶æˆä¸€ä¸ª <code>IO</code> æ“ä½œï¼Œåœ¨ä¼ ç»Ÿæœºæ¢°ç¡¬ç›˜ä¸‹æœ‰ç€æ˜¾è‘—ä¼˜åŠ¿ã€‚è€Œå¯¹äºå›ºæ€ç¡¬ç›˜å»ºè®®å…³é—­æ­¤ç‰¹æ€§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode 169. å¤šæ•°å…ƒç´ </title>
    <link href="/2020/08/03/LeetCode-169-majority-element/"/>
    <url>/2020/08/03/LeetCode-169-majority-element/</url>
    
    <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/majority-element/" target="_blank" rel="noopener">å¤šæ•°å…ƒç´ </a></p><h1 id="è§£æ³•ä¸€hashmap"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸€hashmap"></a> è§£æ³•ä¸€ï¼š<code>HashMap</code></h1><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majorityElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> n = nums.length;    <span class="hljs-keyword">int</span> maj = n / <span class="hljs-number">2</span>;    Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(n);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-keyword">if</span> (map.get(num) != <span class="hljs-keyword">null</span>) &#123;            map.put(num, map.get(num) + <span class="hljs-number">1</span>);        &#125; <span class="hljs-keyword">else</span> &#123;            map.put(num, <span class="hljs-number">1</span>);        &#125;    &#125;    <span class="hljs-keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;        <span class="hljs-keyword">if</span> (entry.getValue() &gt; maj) &#123;            <span class="hljs-keyword">return</span> entry.getKey();        &#125;    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(n)</code></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(n)</code></li></ul><h1 id="è§£æ³•äºŒæ’åº"><a class="markdownIt-Anchor" href="#è§£æ³•äºŒæ’åº"></a> è§£æ³•äºŒï¼šæ’åº</h1><blockquote><p>ç»™å®šçš„æ•°ç»„æ€»æ˜¯å­˜åœ¨å¤šæ•°å…ƒç´ ã€‚</p></blockquote><p>æ’åºåä¸­é—´ä½ç½®çš„å…ƒç´ ä¸€å®šæ˜¯ä¼—æ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majorityElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;        Arrays.sort(nums);        <span class="hljs-keyword">return</span> nums[nums.length / <span class="hljs-number">2</span>];&#125;</code></pre><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(nlogn)</code></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(logn)</code></li></ul><h1 id="è§£æ³•ä¸‰éšæœºåŒ–"><a class="markdownIt-Anchor" href="#è§£æ³•ä¸‰éšæœºåŒ–"></a> è§£æ³•ä¸‰ï¼šéšæœºåŒ–</h1><p>å› ä¸ºè¶…è¿‡ <code>n/2</code> çš„æ•°ç»„ä¸‹æ ‡è¢«ä¼—æ•°å æ®äº†ï¼Œè¿™æ ·æˆ‘ä»¬éšæœºæŒ‘é€‰ä¸€ä¸ªä¸‹æ ‡å¯¹åº”çš„å…ƒç´ å¹¶éªŒè¯ï¼Œæœ‰å¾ˆå¤§çš„æ¦‚ç‡èƒ½æ‰¾åˆ°ä¼—æ•°ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majorityElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;       <span class="hljs-keyword">int</span> maj = nums.length / <span class="hljs-number">2</span>;       Random random = <span class="hljs-keyword">new</span> Random();       <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;           <span class="hljs-keyword">int</span> candidate = nums[getRandIdx(random, <span class="hljs-number">0</span>, nums.length)];           <span class="hljs-keyword">if</span> (count(nums, candidate) &gt; maj) &#123;               <span class="hljs-keyword">return</span> candidate;           &#125;       &#125;   &#125;   <span class="hljs-comment">// 1. è·å–éšæœºä½ç½®</span>   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getRandIdx</span><span class="hljs-params">(Random random, <span class="hljs-keyword">int</span> min, <span class="hljs-keyword">int</span> max)</span> </span>&#123;       <span class="hljs-keyword">return</span> random.nextInt(max - min) + min;   &#125;   <span class="hljs-comment">// 2. è®¡ç®— candidate å‡ºç°æ¬¡æ•°</span>   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">count</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> candidate)</span> </span>&#123;       <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;       <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.length; i++) &#123;           <span class="hljs-keyword">if</span> (nums[i] == candidate) &#123;               count++;           &#125;       &#125;       <span class="hljs-keyword">return</span> count;   &#125;</code></pre><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šç†è®ºä¸Šæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸º <code>O(âˆ)</code>ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º <code>O(n)</code></li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(1)</code></li></ul><h1 id="æ–¹æ³•å››åˆ†æ²»"><a class="markdownIt-Anchor" href="#æ–¹æ³•å››åˆ†æ²»"></a> æ–¹æ³•å››ï¼šåˆ†æ²»</h1><p>å°†æ•°ç»„åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç›´åˆ°æ‰€æœ‰çš„å­é—®é¢˜éƒ½æ˜¯é•¿åº¦ä¸º <code>1</code> çš„æ•°ç»„ï¼Œåˆ†åˆ«æ±‚å‡ºå·¦åŠéƒ¨åˆ†çš„ä¼—æ•° <code>leftEle</code> ä»¥åŠå³åŠéƒ¨åˆ†çš„ä¼—æ•° <code>rightEle</code>ï¼Œéšååœ¨ <code>leftEle</code> å’Œ <code>rightEle</code> ä¸­é€‰å‡ºæ­£ç¡®çš„ä¼—æ•°ã€‚</p><ul><li>å¦‚æœå›æº¯åæŸåŒºé—´çš„é•¿åº¦ä¸º <code>1</code>ï¼Œåˆ™å­æ•°ç»„ä¸­å”¯ä¸€çš„æ•°æ˜¾ç„¶æ˜¯ä¼—æ•°ï¼Œç›´æ¥è¿”å›å³å¯ã€‚</li><li>å¦‚æœå›æº¯åæŸåŒºé—´çš„é•¿åº¦å¤§äº <code>1</code>ï¼Œæˆ‘ä»¬å¿…é¡»å°†å·¦å³å­åŒºé—´çš„å€¼åˆå¹¶ã€‚<ul><li>å¦‚æœå®ƒä»¬çš„ä¼—æ•°ç›¸åŒï¼Œé‚£ä¹ˆæ˜¾ç„¶è¿™ä¸€æ®µåŒºé—´çš„ä¼—æ•°æ˜¯å®ƒä»¬ç›¸åŒçš„å€¼ã€‚</li><li>å¦‚æœå®ƒä»¬çš„ä¼—æ•°ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸¤ä¸ªä¼—æ•°åœ¨æ•´ä¸ªåŒºé—´å†…å‡ºç°çš„æ¬¡æ•°æ¥å†³å®šè¯¥åŒºé—´çš„ä¼—æ•°ã€‚</li></ul></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majorityElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">return</span> majEle(nums, <span class="hljs-number">0</span>, nums.length - <span class="hljs-number">1</span>);&#125;<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majEle</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-comment">// 1. æ•°ç»„åŒºé—´ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ç›´æ¥è¿”å›</span>    <span class="hljs-keyword">if</span> (low == high) &#123;        <span class="hljs-keyword">return</span> nums[low];    &#125;    <span class="hljs-comment">// 2. åŒºé—´ä¸­å­˜åœ¨å¤šä¸ªå…ƒç´ ï¼Œè®¡ç®—å·¦å³éƒ¨åˆ†çš„ä¼—æ•°</span>    <span class="hljs-keyword">int</span> mid = (high - low) / <span class="hljs-number">2</span> + low;    <span class="hljs-keyword">int</span> leftEle = majEle(nums, low, mid);    <span class="hljs-keyword">int</span> rightEle = majEle(nums, mid + <span class="hljs-number">1</span>, high);    <span class="hljs-comment">//  2.1 å·¦å³éƒ¨åˆ†çš„ä¼—æ•°ç›¸ç­‰</span>    <span class="hljs-keyword">if</span> (leftEle == rightEle) &#123;        <span class="hljs-keyword">return</span> leftEle;    &#125;    <span class="hljs-comment">// 2.2 å·¦å³éƒ¨åˆ†ä¼—æ•°ä¸ç­‰ï¼Œåˆ™è®¡ç®—ä»–ä»¬åœ¨æ•´ä¸ªåŒºé—´çš„å‡ºç°æ¬¡æ•°</span>    <span class="hljs-keyword">int</span> lCount = count(nums, leftEle, low, high);    <span class="hljs-keyword">int</span> rCount = count(nums, rightEle, low, high);    <span class="hljs-keyword">return</span> lCount &gt; rCount ? leftEle : rightEle;&#125;<span class="hljs-comment">// è®¡ç®— candidate å‡ºç°æ¬¡æ•°</span><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">count</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums, <span class="hljs-keyword">int</span> candidate, <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = low; i &lt;= high; i++) &#123;        <span class="hljs-keyword">if</span> (nums[i] == candidate) &#123;            count++;        &#125;    &#125;    <span class="hljs-keyword">return</span> count;&#125;</code></pre><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(nlogn)</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(logn)</code>ã€‚å°½ç®¡åˆ†æ²»ç®—æ³•æ²¡æœ‰ç›´æ¥åˆ†é…é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½†åœ¨é€’å½’çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†é¢å¤–çš„æ ˆç©ºé—´ã€‚ç®—æ³•æ¯æ¬¡å°†æ•°ç»„ä»ä¸­é—´åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæ‰€ä»¥æ•°ç»„é•¿åº¦å˜ä¸º <code>1</code> ä¹‹å‰éœ€è¦è¿›è¡Œ <code>O(logn)</code> æ¬¡é€’å½’ï¼Œå³ç©ºé—´å¤æ‚åº¦ä¸º <code>O(logn)</code>ã€‚</li></ul><h1 id="æ–¹æ³•äº”boyer-moore-æŠ•ç¥¨ç®—æ³•"><a class="markdownIt-Anchor" href="#æ–¹æ³•äº”boyer-moore-æŠ•ç¥¨ç®—æ³•"></a> æ–¹æ³•äº”ï¼š<code>Boyer-Moore</code> æŠ•ç¥¨ç®—æ³•</h1><ul><li><p>æˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå€™é€‰ä¼—æ•° <code>candidate</code> å’Œå®ƒå‡ºç°çš„æ¬¡æ•° <code>count</code>ã€‚åˆå§‹æ—¶ <code>candidate</code> å¯ä»¥ä¸ºä»»æ„å€¼ï¼Œ<code>count</code> ä¸º 0ï¼›</p></li><li><p>æˆ‘ä»¬éå†æ•°ç»„ <code>nums</code> ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´  <code>x</code>ï¼Œåœ¨åˆ¤æ–­ <code>x</code> ä¹‹å‰ï¼Œå¦‚æœ <code>count</code> çš„å€¼ä¸º 0ï¼Œæˆ‘ä»¬å…ˆå°† <code>x</code> çš„å€¼èµ‹äºˆ <code>candidate</code>ï¼Œéšåæˆ‘ä»¬åˆ¤æ–­ xï¼š</p><ul><li><p>å¦‚æœ <code>x</code> ä¸ <code>candidate</code> ç›¸ç­‰ï¼Œé‚£ä¹ˆè®¡æ•°å™¨ <code>count + 1</code>ï¼›</p></li><li><p>å¦‚æœ <code>x</code> ä¸ <code>candidate</code> ä¸ç­‰ï¼Œé‚£ä¹ˆè®¡æ•°å™¨ <code>count - 1</code>ã€‚</p></li></ul></li><li><p>åœ¨éå†å®Œæˆåï¼Œ<code>candidate</code> å³ä¸ºæ•´ä¸ªæ•°ç»„çš„ä¼—æ•°ã€‚</p></li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çš„è¾“å…¥æ•°ç»„ä¸º <code>[1, 1, 0, 0, 0, 1, 0]</code>ï¼Œé‚£ä¹ˆ <code>0</code> å°±æ˜¯å¤šæ•°å…ƒç´ ã€‚<br />é¦–å…ˆï¼Œ<code>candidate</code> è¢«è®¾ç½®ä¸ºç¬¬ä¸€ä¸ªå…ƒç´  <code>1</code>ï¼Œ<code>count</code> ä¹Ÿå˜æˆ <code>1</code>ï¼Œç”±äº <code>1</code> ä¸æ˜¯å¤šæ•°å…ƒç´ ï¼Œæ‰€ä»¥å½“æ‰«æåˆ°æ•°ç»„æŸä¸ªä½ç½®æ—¶ï¼Œ<code>count</code> ä¸€å®šä¼šå‡ä¸º <code>0</code> ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå½“æ‰«æåˆ°ç¬¬å››ä¸ªä½ç½®æ—¶ï¼Œ<code>count</code> å˜æˆ <code>0</code>.</p><p><code>count</code> å€¼å˜åŒ–è¿‡ç¨‹ï¼š<br /><code>[1, 2, 1, 0 â€¦â€¦]</code></p><p>å½“ <code>count</code> å˜æˆ <code>0</code> æ—¶ï¼Œå¯¹äºæ¯ä¸€ä¸ªå‡ºç°çš„ <code>1</code>ï¼Œæˆ‘ä»¬éƒ½ç”¨ä¸€ä¸ª <code>0</code> ä¸å…¶è¿›è¡ŒæŠµæ¶ˆï¼Œæ‰€ä»¥æˆ‘ä»¬æ¶ˆè€—æ‰äº†ä¸å…¶ä¸€æ ·å¤šçš„<code>0</code>ï¼Œè€Œ <code>0</code> æ˜¯å¤šæ•°å…ƒç´ ï¼Œè¿™æ„å‘³ç€å½“æ‰«æåˆ°ç¬¬å››ä¸ªä½ç½®æ—¶ï¼Œæˆ‘ä»¬å·²ç»æœ€å¤§ç¨‹åº¦çš„æ¶ˆè€—æ‰äº†å¤šæ•°å…ƒç´ ã€‚ç„¶è€Œï¼Œå¯¹äºæ•°ç»„ä»ç¬¬äº”ä¸ªä½ç½®å¼€å§‹çš„å‰©ä½™éƒ¨åˆ†ï¼Œ<code>0</code> ä¾ç„¶æ˜¯å…¶ä¸­çš„å¤šæ•°å…ƒç´ (æ³¨æ„ï¼Œå¤šæ•°å…ƒç´ å‡ºç°æ¬¡æ•°å¤§äº <code>âŒŠ n/2 âŒ‹</code>ï¼Œè€Œæˆ‘ä»¬æ‰«æè¿‡çš„éƒ¨åˆ†ä¸­å¤šæ•°å…ƒç´ åªå ä¸€åŠï¼Œé‚£å‰©ä½™éƒ¨åˆ†ä¸­å¤šæ•°å…ƒç´ è¿˜æœ‰ä¸€åŠ)ã€‚å¦‚æœä¹‹å‰ç”¨äºæŠµæ¶ˆçš„å…ƒç´ ä¸­å­˜åœ¨éå¤šæ•°å…ƒç´ ï¼Œé‚£ä¹ˆæ•°ç»„å‰©ä½™éƒ¨åˆ†åŒ…å«çš„å¤šæ•°å…ƒç´ å°±æ›´å¤šäº†ã€‚</p><blockquote><p>æ•°ç»„ä¸­ä» <code>candidate</code> è¢«èµ‹å€¼åˆ° <code>count</code> å‡åˆ° <code>0</code> çš„é‚£ä¸€æ®µå¯ä»¥è¢«å»é™¤ï¼Œä½™ä¸‹éƒ¨åˆ†çš„å¤šæ•°å…ƒç´ ä¾ç„¶æ˜¯åŸæ•°ç»„çš„å¤šæ•°å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ä¸æ–­é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ‰«æåˆ°æ•°ç»„å°¾éƒ¨ï¼Œé‚£ä¹ˆ <code>count</code> å¿…ç„¶ä¼šå¤§äº <code>0</code>ï¼Œè€Œä¸”è¿™ä¸ª <code>count</code> å¯¹åº”çš„ <code>candinate</code> å°±æ˜¯åŸæ•°ç»„çš„å¤šæ•°å…ƒç´ ã€‚</p></blockquote><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">majorityElement</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] nums)</span> </span>&#123;    <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;    <span class="hljs-keyword">int</span> candidate = <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> num : nums) &#123;        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">0</span>) &#123;            candidate = num;        &#125;        count += (candidate == num) ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">return</span> candidate;&#125;</code></pre><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(n)</code>ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(1)</code>ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LeetCode</tag>
      
      <tag>åˆ†æ²»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VIM æŒ‡ä»¤è®°å½•</title>
    <link href="/2020/08/01/vim-command/"/>
    <url>/2020/08/01/vim-command/</url>
    
    <content type="html"><![CDATA[<p><code>vim</code> å¸¸ç”¨æŒ‡ä»¤è®°å½•</p><h1 id="å‘½ä»¤æ¨¡å¼"><a class="markdownIt-Anchor" href="#å‘½ä»¤æ¨¡å¼"></a> å‘½ä»¤æ¨¡å¼</h1><h2 id="å…‰æ ‡ç§»åŠ¨"><a class="markdownIt-Anchor" href="#å…‰æ ‡ç§»åŠ¨"></a> å…‰æ ‡ç§»åŠ¨</h2><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>h</code></td><td style="text-align:center">å·¦ç§»ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>l</code></td><td style="text-align:center">å³ç§»</td></tr><tr><td style="text-align:center"><code>k</code></td><td style="text-align:center">ä¸Šç§»</td></tr><tr><td style="text-align:center"><code>j</code></td><td style="text-align:center">ä¸‹ç§»</td></tr><tr><td style="text-align:center"><code>{n}{op}</code></td><td style="text-align:center"><code>10j</code> è¡¨ç¤ºä¸‹ç§» <code>10</code> è¡Œ</td></tr><tr><td style="text-align:center"><code>{n}&lt;Space&gt;</code></td><td style="text-align:center">å‘åç§»åŠ¨ <code>n</code> ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>{n}&lt;Enter&gt;</code></td><td style="text-align:center"><strong>å‘ä¸‹ç§»åŠ¨ <code>n</code> è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>$</code></td><td style="text-align:center"><strong>ç§»åŠ¨åˆ°è¡Œé¦–</strong></td></tr><tr><td style="text-align:center"><code>0</code></td><td style="text-align:center"><strong>ç§»åŠ¨åˆ°è¡Œå°¾</strong></td></tr><tr><td style="text-align:center"><code>ctrl + f</code></td><td style="text-align:center"><strong>Page Down</strong></td></tr><tr><td style="text-align:center"><code>ctrl + b</code></td><td style="text-align:center"><strong>Page Up</strong></td></tr><tr><td style="text-align:center"><code>ctrl + d</code></td><td style="text-align:center">ä¸‹ç§»åŠé¡µ</td></tr><tr><td style="text-align:center"><code>ctrl + u</code></td><td style="text-align:center">ä¸Šç§»åŠé¡µ</td></tr><tr><td style="text-align:center"><code>H</code></td><td style="text-align:center">ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>M</code></td><td style="text-align:center">ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ä¸­å¤®é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>L</code></td><td style="text-align:center">ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€åä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>gg</code></td><td style="text-align:center"><strong>ç§»åŠ¨åˆ°æ–‡ä»¶ç¬¬ä¸€è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>G</code></td><td style="text-align:center"><strong>ç§»åŠ¨åˆ°æ–‡ä»¶æœ€åä¸€è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>{n}G</code></td><td style="text-align:center">ç§»åŠ¨åˆ°ç¬¬ <code>n</code> è¡Œ</td></tr></tbody></table><h2 id="å‰ªåˆ‡åˆ é™¤"><a class="markdownIt-Anchor" href="#å‰ªåˆ‡åˆ é™¤"></a> å‰ªåˆ‡/åˆ é™¤</h2><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>x</code>, <code>X</code></td><td style="text-align:center">delete, backspace</td></tr><tr><td style="text-align:center"><code>{n}x</code></td><td style="text-align:center">å‘ååˆ é™¤ <code>n</code> ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:center"><code>dd</code></td><td style="text-align:center"><strong>åˆ é™¤ä¸€è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>{n}dd</code></td><td style="text-align:center"><strong>åˆ é™¤ <code>n</code> è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>d1G</code></td><td style="text-align:center">åˆ é™¤ç¬¬ä¸€è¡Œåˆ°å…‰æ ‡æ‰€åœ¨è¡Œ</td></tr><tr><td style="text-align:center"><code>dG</code></td><td style="text-align:center">åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åä¸€è¡Œ</td></tr><tr><td style="text-align:center"><code>d0</code></td><td style="text-align:center"><strong>åˆ é™¤å…‰æ ‡åˆ°è¯¥è¡Œé¦–éƒ¨</strong></td></tr><tr><td style="text-align:center"><code>d$</code></td><td style="text-align:center"><strong>åˆ é™¤å…‰æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œå°¾éƒ¨(åŒ…æ‹¬å…‰æ ‡é€‰ä¸­çš„å­—ç¬¦)</strong></td></tr></tbody></table><h2 id="å¤åˆ¶"><a class="markdownIt-Anchor" href="#å¤åˆ¶"></a> å¤åˆ¶</h2><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>y</code></td><td style="text-align:center"><code>v</code> é€‰ä¸­</td></tr><tr><td style="text-align:center"><code>yy</code></td><td style="text-align:center"><strong>å¤åˆ¶ä¸€è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>{n}yy</code></td><td style="text-align:center"><strong>å¤åˆ¶ <code>n</code> è¡Œ</strong></td></tr><tr><td style="text-align:center"><code>y1G</code></td><td style="text-align:center">å¤åˆ¶ç¬¬ä¸€è¡Œåˆ°å…‰æ ‡æ‰€åœ¨è¡Œ</td></tr><tr><td style="text-align:center"><code>yG</code></td><td style="text-align:center">å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åä¸€è¡Œ</td></tr><tr><td style="text-align:center"><code>y0</code></td><td style="text-align:center"><strong>å¤åˆ¶å…‰æ ‡åˆ°è¯¥è¡Œé¦–éƒ¨</strong></td></tr><tr><td style="text-align:center"><code>y$</code></td><td style="text-align:center"><strong>å¤åˆ¶å…‰æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œå°¾éƒ¨(åŒ…æ‹¬å…‰æ ‡é€‰ä¸­çš„å­—ç¬¦)</strong></td></tr></tbody></table><h2 id="ç²˜è´´"><a class="markdownIt-Anchor" href="#ç²˜è´´"></a> ç²˜è´´</h2><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>p</code>, <code>P</code></td><td style="text-align:center">ç²˜è´´åœ¨ä¸Š/ä¸‹ä¸€è¡Œ</td></tr><tr><td style="text-align:center"><code>J</code></td><td style="text-align:center">åˆå¹¶å…‰æ ‡æ‰€åœ¨è¡Œå’Œä¸‹ä¸€è¡Œ</td></tr></tbody></table><h2 id="æ’¤é”€-é‡åš-é‡å¤"><a class="markdownIt-Anchor" href="#æ’¤é”€-é‡åš-é‡å¤"></a> æ’¤é”€ã€é‡åšã€é‡å¤</h2><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>u</code></td><td style="text-align:center"><strong>æ’¤é”€</strong></td></tr><tr><td style="text-align:center"><code>ctrl + r</code></td><td style="text-align:center"><strong>é‡åš</strong></td></tr><tr><td style="text-align:center"><code>.</code></td><td style="text-align:center"><strong>é‡å¤ä¸Šä¸€ä¸ªåŠ¨ä½œ</strong></td></tr></tbody></table><h1 id="æœ«è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#æœ«è¡Œæ¨¡å¼"></a> æœ«è¡Œæ¨¡å¼</h1><p>åªè®°å½•ä¸ç†Ÿæ‚‰çš„</p><table><thead><tr><th style="text-align:center">cmd</th><th style="text-align:center">description</th></tr></thead><tbody><tr><td style="text-align:center"><code>ZZ</code></td><td style="text-align:center">ç›¸å½“äº <code>wq</code></td></tr><tr><td style="text-align:center"><code>ZQ</code></td><td style="text-align:center">ç›¸å½“äº <code>q!</code></td></tr><tr><td style="text-align:center"><code>:w {filename}</code></td><td style="text-align:center">save as</td></tr><tr><td style="text-align:center"><code>:r {filename}</code></td><td style="text-align:center">å°† <code>filename</code> æ–‡ä»¶è¿½åŠ åˆ°å…‰æ ‡å</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Java å†…å­˜æ¨¡å‹</title>
    <link href="/2020/07/29/java-memory-model/"/>
    <url>/2020/07/29/java-memory-model/</url>
    
    <content type="html"><![CDATA[<blockquote><p><code>Java</code> å†…å­˜æ¨¡å‹ï¼ˆ<code>Java Memory Model</code>ï¼‰ï¼Œç®€ç§° <code>JMM</code>ã€‚</p><p><code>JVM</code> ä¸­è¯•å›¾å®šä¹‰ä¸€ç§ <code>JMM</code> æ¥å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®© <code>Java</code> ç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚</p></blockquote><h1 id="ç‰©ç†å†…å­˜æ¨¡å‹"><a class="markdownIt-Anchor" href="#ç‰©ç†å†…å­˜æ¨¡å‹"></a> ç‰©ç†å†…å­˜æ¨¡å‹</h1><p>ç‰©ç†æœºé‡åˆ°çš„å¹¶å‘é—®é¢˜ä¸è™šæ‹Ÿæœºä¸­çš„æƒ…å†µæœ‰ä¸å°‘ç›¸ä¼¼ä¹‹å¤„ï¼Œç‰©ç†æœºå¯¹å¹¶å‘çš„å¤„ç†æ–¹æ¡ˆå¯¹äºè™šæ‹Ÿæœºçš„å®ç°ä¹Ÿæœ‰ç›¸å½“å¤§çš„å‚è€ƒæ„ä¹‰ã€‚</p><h2 id="ç¡¬ä»¶å¤„ç†æ•ˆç‡"><a class="markdownIt-Anchor" href="#ç¡¬ä»¶å¤„ç†æ•ˆç‡"></a> ç¡¬ä»¶å¤„ç†æ•ˆç‡</h2><p>ç‰©ç†å†…å­˜çš„ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šç¡¬ä»¶å¤„ç†æ•ˆç‡ã€‚</p><ul><li><p>ç»å¤§å¤šæ•°çš„è¿ç®—ä»»åŠ¡éƒ½ä¸å¯èƒ½åªé å¤„ç†å™¨â€œè®¡ç®—â€å°±èƒ½å®Œæˆï¼Œå¤„ç†å™¨è‡³å°‘éœ€è¦ä¸<strong>å†…å­˜äº¤äº’</strong>ï¼Œå¦‚è¯»å–è¿ç®—æ•°æ®ã€å­˜å‚¨è¿ç®—ç»“æœï¼Œè¿™ä¸ª <code>I/O</code> æ“ä½œæ˜¯å¾ˆéš¾æ¶ˆé™¤çš„ï¼ˆæ— æ³•ä»…é å¯„å­˜å™¨å®Œæˆæ‰€æœ‰è¿ç®—ä»»åŠ¡ï¼‰ã€‚</p></li><li><p><strong>ç”±äºè®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡ä¸å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦æœ‰å‡ ä¸ªæ•°é‡çº§çš„å·®è·</strong> ï¼Œè¿™ç§é€Ÿåº¦ä¸Šçš„çŸ›ç›¾ï¼Œä¼šé™ä½ç¡¬ä»¶çš„å¤„ç†æ•ˆç‡ã€‚æ‰€ä»¥ï¼Œç°ä»£è®¡ç®—æœºéƒ½ä¸å¾—ä¸ <strong>åŠ å…¥é«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰</strong> æ¥ä½œä¸ºå†…å­˜å’Œå¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²ã€‚å°†éœ€è¦ç”¨åˆ°çš„æ•°æ®å¤åˆ¶åˆ°ç¼“å­˜ä¸­ï¼Œè®©è¿ç®—èƒ½å¿«é€Ÿè¿›è¡Œï¼Œå½“è¿ç®—ç»“æŸåå†ä»ç¼“å­˜åŒæ­¥ä¼šå†…å­˜ä¸­ï¼Œè¿™æ ·å¤„ç†å™¨å°±æ— éœ€ç­‰å¾…ç¼“æ…¢çš„å†…å­˜è¯»å†™äº†ã€‚</p></li></ul><h2 id="ç¼“å­˜ä¸€è‡´æ€§"><a class="markdownIt-Anchor" href="#ç¼“å­˜ä¸€è‡´æ€§"></a> ç¼“å­˜ä¸€è‡´æ€§</h2><p>é«˜é€Ÿç¼“å­˜è§£å†³äº† ç¡¬ä»¶æ•ˆç‡é—®é¢˜ï¼Œä½†æ˜¯å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ï¼ˆ<code>Cache Coherence</code>ï¼‰ã€‚</p><p>åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„é«˜é€Ÿç¼“å­˜ï¼Œè€Œå®ƒä»¬åˆå…±äº«åŒä¸€ä¸»å†…å­˜ã€‚å½“å¤šä¸ªå¤„ç†å™¨çš„è¿ç®—ä»»åŠ¡éƒ½æ¶‰åŠåŒä¸€å—ä¸»å†…å­˜åŒºåŸŸæ—¶ï¼Œå°†å¯èƒ½å¯¼è‡´å„è‡ªçš„ç¼“å­˜æ•°æ®ä¸ä¸€è‡´ã€‚</p><p>ä¸ºäº†è§£å†³ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Œéœ€è¦å„ä¸ªå¤„ç†å™¨è®¿é—®ç¼“å­˜æ—¶éƒ½éµå¾ªä¸€äº›åè®®ï¼Œåœ¨è¯»å†™æ—¶è¦æ ¹æ®åè®®æ¥è¿›è¡Œæ“ä½œã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200729160602.png" srcset="/img/loading.gif" alt="" /></p><h2 id="ä»£ç ä¹±åºæ‰§è¡Œä¼˜åŒ–"><a class="markdownIt-Anchor" href="#ä»£ç ä¹±åºæ‰§è¡Œä¼˜åŒ–"></a> ä»£ç ä¹±åºæ‰§è¡Œä¼˜åŒ–</h2><p>é™¤äº†é«˜é€Ÿç¼“å­˜ä»¥å¤–ï¼Œä¸ºäº†ä½¿å¾—å¤„ç†å™¨å†…éƒ¨çš„è¿ç®—å•å…ƒå°½é‡è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹è¾“å…¥ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œï¼ˆ<code>Out-Of-Order Execution</code>ï¼‰ä¼˜åŒ–ã€‚å¤„ç†å™¨ä¼šåœ¨è®¡ç®—ä¹‹åå°†ä¹±åºæ‰§è¡Œçš„ç»“æœé‡ç»„ï¼Œ<strong>ä¿è¯è¯¥ç»“æœä¸é¡ºåºæ‰§è¡Œçš„ç»“æœæ˜¯ä¸€è‡´çš„</strong>ï¼Œä½†ä¸ä¿è¯ç¨‹åºä¸­å„ä¸ªè¯­å¥è®¡ç®—çš„å…ˆåé¡ºåºä¸è¾“å…¥ä»£ç ä¸­çš„é¡ºåºä¸€è‡´ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200729160655.png" srcset="/img/loading.gif" alt="" /></p><p>ä¹±åºæ‰§è¡ŒæŠ€æœ¯æ˜¯å¤„ç†å™¨ä¸ºæé«˜è¿ç®—é€Ÿåº¦è€Œåšå‡ºè¿èƒŒä»£ç åŸæœ‰é¡ºåºçš„ä¼˜åŒ–ã€‚</p><ul><li><p>å•æ ¸ç¯å¢ƒä¸‹ï¼Œå¤„ç†å™¨ä¿è¯åšå‡ºçš„ä¼˜åŒ–ä¸ä¼šå¯¼è‡´æ‰§è¡Œç»“æœè¿œç¦»é¢„æœŸç›®æ ‡ï¼Œä½†åœ¨å¤šæ ¸ç¯å¢ƒä¸‹å´å¹¶éå¦‚æ­¤ã€‚</p></li><li><p>å¤šæ ¸ç¯å¢ƒä¸‹ï¼Œ å¦‚æœå­˜åœ¨ä¸€ä¸ªæ ¸çš„è®¡ç®—ä»»åŠ¡ä¾èµ–å¦ä¸€ä¸ªæ ¸çš„è®¡ç®—ä»»åŠ¡çš„ä¸­é—´ç»“æœï¼Œè€Œä¸”å¯¹ç›¸å…³æ•°æ®è¯»å†™æ²¡åšä»»ä½•é˜²æŠ¤æªæ–½ï¼Œé‚£ä¹ˆå…¶é¡ºåºæ€§å¹¶ä¸èƒ½é ä»£ç çš„å…ˆåé¡ºåºæ¥ä¿è¯ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200729160753.png" srcset="/img/loading.gif" alt="" /></p><h1 id="java-å†…å­˜æ¨¡å‹"><a class="markdownIt-Anchor" href="#java-å†…å­˜æ¨¡å‹"></a> Java å†…å­˜æ¨¡å‹</h1><p><strong>å†…å­˜æ¨¡å‹</strong> è¿™ä¸ªæ¦‚å¿µã€‚æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šåœ¨ç‰¹å®šçš„æ“ä½œåè®®ä¸‹ï¼Œå¯¹ç‰¹å®šçš„å†…å­˜æˆ–é«˜é€Ÿç¼“å­˜è¿›è¡Œè¯»å†™è®¿é—®çš„è¿‡ç¨‹æŠ½è±¡ã€‚ä¸åŒæ¶æ„çš„ç‰©ç†è®¡ç®—æœºå¯ä»¥æœ‰ä¸ä¸€æ ·çš„å†…å­˜æ¨¡å‹ï¼Œ<code>JVM</code> ä¹Ÿæœ‰è‡ªå·±çš„å†…å­˜æ¨¡å‹ã€‚</p><p><code>JVM</code> ä¸­è¯•å›¾å®šä¹‰ä¸€ç§ <code>Java</code> å†…å­˜æ¨¡å‹ï¼ˆ<code>Java Memory Model</code>, <code>JMM</code>ï¼‰æ¥<strong>å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚</strong>ï¼Œä»¥å®ç°è®© <code>Java</code> ç¨‹åº <strong>åœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœ</strong>ã€‚<code>JMM</code> å†³å®šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„å†™å…¥ä½•æ—¶å¯¹å¦ä¸€ä¸ªçº¿ç¨‹å¯è§ã€‚</p><h2 id="jvm-å†…å­˜ç»“æ„-vs-java-å†…å­˜æ¨¡å‹"><a class="markdownIt-Anchor" href="#jvm-å†…å­˜ç»“æ„-vs-java-å†…å­˜æ¨¡å‹"></a> JVM å†…å­˜ç»“æ„ vs Java å†…å­˜æ¨¡å‹</h2><ul><li><p><code>JVM</code> å†…å­˜ç»“æ„ï¼Œç”± <code>Java</code> è™šæ‹Ÿæœºè§„èŒƒå®šä¹‰ã€‚æè¿°çš„æ˜¯ <code>Java</code> ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”± <code>JVM</code> ç®¡ç†çš„ä¸åŒæ•°æ®åŒºåŸŸã€‚å„ä¸ªåŒºåŸŸæœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½ã€‚</p></li><li><p><code>Java</code> çš„å¤šçº¿ç¨‹ä¹‹é—´æ˜¯é€šè¿‡<strong>å…±äº«å†…å­˜</strong>è¿›è¡Œé€šä¿¡çš„ï¼Œè€Œç”±äºé‡‡ç”¨å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡ï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨ä¸€ç³»åˆ—å¦‚å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ç­‰é—®é¢˜ï¼Œè€Œ <code>JMM</code> å°±æ˜¯å›´ç»•ç€<strong>å¤šçº¿ç¨‹é€šä¿¡</strong>ä»¥åŠä¸å…¶ç›¸å…³çš„ä¸€ç³»åˆ—ç‰¹æ€§è€Œå»ºç«‹çš„æ¨¡å‹ã€‚</p></li><li><p><code>JMM</code> å¹¶ä¸åƒ <code>JVM</code> å†…å­˜ç»“æ„ä¸€æ ·æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µã€‚</p></li></ul><h2 id="ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜"><a class="markdownIt-Anchor" href="#ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜"></a> ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜</h2><p><code>JMM</code> è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆ<code>Main Memory</code>ï¼‰ä¸­ã€‚</p><p>æ¯æ¡çº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„<strong>å·¥ä½œå†…å­˜</strong>ï¼ˆ<code>Working Memory</code>ï¼‰ï¼Œå·¥ä½œå†…å­˜ä¸­ä¿ç•™äº†è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„<strong>ä¸»å†…å­˜çš„å‰¯æœ¬</strong>ã€‚å·¥ä½œå†…å­˜æ˜¯ <code>JMM</code> çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå¹¶ä¸çœŸå®å­˜åœ¨ï¼Œå®ƒæ¶µç›–äº†ç¼“å­˜ï¼Œå†™ç¼“å†²åŒºï¼Œå¯„å­˜å™¨ä»¥åŠå…¶ä»–çš„ç¡¬ä»¶å’Œç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</p><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200729161040.png" srcset="/img/loading.gif" alt="" /></p><p>çº¿ç¨‹å¯¹å˜é‡çš„<strong>æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œ</strong>ï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçš„çº¿ç¨‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œ<strong>çº¿ç¨‹é—´å˜é‡å€¼çš„ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆ</strong>ã€‚</p><h2 id="jmm-å†…å­˜æ“ä½œçš„é—®é¢˜"><a class="markdownIt-Anchor" href="#jmm-å†…å­˜æ“ä½œçš„é—®é¢˜"></a> JMM å†…å­˜æ“ä½œçš„é—®é¢˜</h2><ul><li><strong>å·¥ä½œå†…å­˜æ•°æ®ä¸€è‡´æ€§</strong> - å„ä¸ªçº¿ç¨‹æ“ä½œæ•°æ®æ—¶ä¼šä¿å­˜ä½¿ç”¨åˆ°çš„ä¸»å†…å­˜ä¸­çš„å…±äº«å˜é‡å‰¯æœ¬ï¼Œå½“å¤šä¸ªçº¿ç¨‹çš„è¿ç®—ä»»åŠ¡éƒ½æ¶‰åŠåŒä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œå°†å¯¼è‡´å„è‡ªçš„çš„å…±äº«å˜é‡å‰¯æœ¬ä¸ä¸€è‡´ã€‚å¦‚æœçœŸçš„å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ•°æ®åŒæ­¥å›ä¸»å†…å­˜ä»¥è°çš„å‰¯æœ¬æ•°æ®ä¸ºå‡†ï¼Ÿ <code>Java</code> å†…å­˜æ¨¡å‹ä¸»è¦é€šè¿‡ä¸€ç³»åˆ—çš„æ•°æ®åŒæ­¥åè®®ã€è§„åˆ™æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li><strong>æŒ‡ä»¤é‡æ’åºä¼˜åŒ–</strong> - <code>Java</code> ä¸­é‡æ’åºé€šå¸¸æ˜¯ç¼–è¯‘å™¨æˆ–è¿è¡Œæ—¶ç¯å¢ƒä¸ºäº†ä¼˜åŒ–ç¨‹åºæ€§èƒ½è€Œé‡‡å–çš„å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ–°æ’åºæ‰§è¡Œçš„ä¸€ç§æ‰‹æ®µã€‚é‡æ’åºåˆ†ä¸ºä¸¤ç±»ï¼š<strong>ç¼–è¯‘æœŸé‡æ’åº</strong>å’Œ<strong>è¿è¡ŒæœŸé‡æ’åº</strong>ï¼Œåˆ†åˆ«å¯¹åº”ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶ç¯å¢ƒã€‚ åŒæ ·çš„ï¼ŒæŒ‡ä»¤é‡æ’åºä¸æ˜¯éšæ„é‡æ’åºï¼Œå®ƒéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š<ul><li>åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœã€‚å³æ—¶ç¼–è¯‘å™¨ï¼ˆå’Œå¤„ç†å™¨ï¼‰éœ€è¦ä¿è¯ç¨‹åºèƒ½å¤Ÿéµå®ˆ <code>as-if-serial</code> å±æ€§ã€‚é€šä¿—åœ°è¯´ï¼Œå°±æ˜¯åœ¨å•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œè¦ç»™ç¨‹åºä¸€ä¸ªé¡ºåºæ‰§è¡Œçš„å‡è±¡ã€‚å³ç»è¿‡é‡æ’åºçš„æ‰§è¡Œç»“æœè¦ä¸é¡ºåºæ‰§è¡Œçš„ç»“æœä¿æŒä¸€è‡´ã€‚</li><li>å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åºã€‚</li><li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚æœçº¿ç¨‹å¤„ç†é€»è¾‘ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œæœ‰å¯èƒ½å› ä¸ºæŒ‡ä»¤é‡æ’åºå¯¼è‡´è¿è¡Œç»“æœä¸é¢„æœŸä¸åŒã€‚</li></ul></li></ul><h1 id="java-å†…å­˜æ¨¡å‹è§„åˆ™"><a class="markdownIt-Anchor" href="#java-å†…å­˜æ¨¡å‹è§„åˆ™"></a> Java å†…å­˜æ¨¡å‹è§„åˆ™</h1><h2 id="å†…å­˜äº¤äº’æ“ä½œçš„ä¸‰å¤§ç‰¹æ€§"><a class="markdownIt-Anchor" href="#å†…å­˜äº¤äº’æ“ä½œçš„ä¸‰å¤§ç‰¹æ€§"></a> å†…å­˜äº¤äº’æ“ä½œçš„ä¸‰å¤§ç‰¹æ€§</h2><p>Java å†…å­˜ä¸‰å¤§ç‰¹æ€§ï¼šåŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ã€‚</p><p>è€Œè¿™ä¸‰å¤§ç‰¹æ€§ï¼Œå½’æ ¹ç»“åº•ï¼Œæ˜¯ä¸ºäº†å®ç°å¤šçº¿ç¨‹çš„ <strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼Œä½¿å¾—ç¨‹åºåœ¨å¤šçº¿ç¨‹å¹¶å‘ï¼ŒæŒ‡ä»¤é‡æ’åºä¼˜åŒ–çš„ç¯å¢ƒä¸­èƒ½å¦‚é¢„æœŸè¿è¡Œã€‚</p><h3 id="åŸå­æ€§"><a class="markdownIt-Anchor" href="#åŸå­æ€§"></a> åŸå­æ€§</h3><blockquote><p>åŸå­æ€§å³ä¸€ä¸ªæ“ä½œæˆ–è€…å¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼ˆæ‰§è¡Œçš„è¿‡ç¨‹ä¸ä¼šè¢«ä»»ä½•å› ç´ æ‰“æ–­ï¼‰ï¼Œè¦ä¹ˆå°±éƒ½ä¸æ‰§è¡Œã€‚å³ä½¿åœ¨å¤šä¸ªçº¿ç¨‹ä¸€èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰€å¹²æ‰°ã€‚</p></blockquote><p>åœ¨ <code>Java</code> ä¸­ï¼Œä¸ºäº†ä¿è¯åŸå­æ€§ï¼Œæä¾›äº†ä¸¤ä¸ªé«˜çº§çš„å­—èŠ‚ç æŒ‡ä»¤ <code>monitorenter</code> å’Œ <code>monitorexit</code>ã€‚è¿™ä¸¤ä¸ªå­—èŠ‚ç ï¼Œåœ¨ <code>Java</code> ä¸­å¯¹åº”çš„å…³é”®å­—å°±æ˜¯ <code>synchronized</code>ã€‚</p><p>å› æ­¤ï¼Œåœ¨ <code>Java</code> ä¸­å¯ä»¥ä½¿ç”¨ <code>synchronized</code> æ¥ä¿è¯æ–¹æ³•å’Œä»£ç å—å†…çš„æ“ä½œæ˜¯åŸå­æ€§çš„ã€‚</p><h3 id="å¯è§æ€§"><a class="markdownIt-Anchor" href="#å¯è§æ€§"></a> å¯è§æ€§</h3><blockquote><p>å¯è§æ€§æ˜¯æŒ‡å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹å¾—åˆ°ä¿®æ”¹çš„å€¼ã€‚</p></blockquote><p>JMM æ˜¯é€šè¿‡ â€œ<strong>å˜é‡ä¿®æ”¹åå°†æ–°å€¼åŒæ­¥å›ä¸»å†…å­˜ï¼Œ å˜é‡è¯»å–å‰ä»ä¸»å†…å­˜åˆ·æ–°å˜é‡å€¼</strong>â€ è¿™ç§ä¾èµ–ä¸»å†…å­˜ä½œä¸ºä¼ é€’åª’ä»‹çš„æ–¹å¼æ¥å®ç°çš„ã€‚</p><p><code>Java</code> å®ç°å¤šçº¿ç¨‹å¯è§æ€§çš„æ–¹å¼æœ‰ï¼š</p><ul><li><p><code>volatile</code></p></li><li><p><code>synchronized</code></p></li><li><p><code>final</code></p></li></ul><h3 id="æœ‰åºæ€§"><a class="markdownIt-Anchor" href="#æœ‰åºæ€§"></a> æœ‰åºæ€§</h3><p>æœ‰åºæ€§è§„åˆ™è¡¨ç°åœ¨ä»¥ä¸‹ä¸¤ç§åœºæ™¯: çº¿ç¨‹å†…å’Œçº¿ç¨‹é—´</p><ul><li><p><strong>çº¿ç¨‹å†…</strong> - ä»æŸä¸ªçº¿ç¨‹çš„è§’åº¦çœ‹æ–¹æ³•çš„æ‰§è¡Œï¼ŒæŒ‡ä»¤ä¼šæŒ‰ç…§ä¸€ç§å«â€œä¸²è¡Œâ€ï¼ˆ<code>as-if-serial</code>ï¼‰çš„æ–¹å¼æ‰§è¡Œï¼Œæ­¤ç§æ–¹å¼å·²ç»åº”ç”¨äºé¡ºåºç¼–ç¨‹è¯­è¨€ã€‚</p></li><li><p><strong>çº¿ç¨‹é—´</strong> - è¿™ä¸ªçº¿ç¨‹â€œè§‚å¯Ÿâ€åˆ°å…¶ä»–çº¿ç¨‹å¹¶å‘åœ°æ‰§è¡ŒéåŒæ­¥çš„ä»£ç æ—¶ï¼Œç”±äºæŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œä»»ä½•ä»£ç éƒ½æœ‰å¯èƒ½äº¤å‰æ‰§è¡Œã€‚å”¯ä¸€èµ·ä½œç”¨çš„çº¦æŸæ˜¯ï¼šå¯¹äºåŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥å—ï¼ˆ<code>synchronized</code> å…³é”®å­—ä¿®é¥°ï¼‰ä»¥åŠ <code>volatile</code> å­—æ®µçš„æ“ä½œä»ç»´æŒç›¸å¯¹æœ‰åºã€‚</p></li></ul><p>åœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>synchronized</code> å’Œ <code>volatile</code> æ¥ä¿è¯å¤šçº¿ç¨‹ä¹‹é—´æ“ä½œçš„æœ‰åºæ€§ã€‚å®ç°æ–¹å¼æœ‰æ‰€åŒºåˆ«ï¼š</p><ul><li><p><code>volatile</code> å…³é”®å­—ä¼šç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚</p></li><li><p><code>synchronized</code> å…³é”®å­—é€šè¿‡äº’æ–¥ä¿è¯åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹æ“ä½œã€‚</p></li></ul><h2 id="happens-before-åŸåˆ™"><a class="markdownIt-Anchor" href="#happens-before-åŸåˆ™"></a> Happens-Before åŸåˆ™</h2><blockquote><p>åœ¨ <code>JMM</code> ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ‰§è¡Œçš„ç»“æœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»å­˜åœ¨ <code>happens-before</code> å…³ç³»ã€‚</p></blockquote><ul><li><p><strong>ç¨‹åºæ¬¡åºè§„åˆ™</strong> - ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ä»£ç é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºä¹¦å†™åœ¨åé¢çš„æ“ä½œã€‚</p></li><li><p><strong>ç®¡ç¨‹é”å®šè§„åˆ™</strong> - ä¸€ä¸ª <code>unLock</code> æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ <code>lock</code> æ“ä½œã€‚</p></li><li><p><strong><code>volatile</code> å˜é‡è§„åˆ™</strong> - å¯¹ä¸€ä¸ª <code>volatile</code> å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚</p></li><li><p><strong>çº¿ç¨‹å¯åŠ¨è§„åˆ™</strong> - <code>Thread</code> å¯¹è±¡çš„ <code>start()</code> æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸ªä¸€ä¸ªåŠ¨ä½œã€‚</p></li><li><p><strong>çº¿ç¨‹ç»ˆæ­¢è§„åˆ™</strong> - çº¿ç¨‹ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿäºçº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Thread.join()</code> æ–¹æ³•ç»“æŸã€<code>Thread.isAlive()</code> çš„è¿”å›å€¼æ‰‹æ®µæ£€æµ‹åˆ°çº¿ç¨‹å·²ç»ç»ˆæ­¢æ‰§è¡Œã€‚</p></li><li><p><strong>çº¿ç¨‹ä¸­æ–­è§„åˆ™</strong> - å¯¹çº¿ç¨‹ <code>interrupt()</code> æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ <code>Thread.interrupted()</code>æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚</p></li><li><p><strong>å¯¹è±¡ç»ˆç»“è§„åˆ™</strong> - ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆå…ˆè¡Œå‘ç”Ÿäºå®ƒçš„ <code>finalize()</code> æ–¹æ³•çš„å¼€å§‹ã€‚</p></li><li><p><strong>ä¼ é€’æ€§</strong> - å¦‚æœæ“ä½œ <code>A</code> å…ˆè¡Œå‘ç”Ÿäº æ“ä½œ <code>B</code>ï¼Œè€Œæ“ä½œ <code>B</code> åˆ å…ˆè¡Œå‘ç”Ÿäº æ“ä½œ <code>C</code>ï¼Œåˆ™å¯ä»¥å¾—å‡ºæ“ä½œ <code>A</code> å…ˆè¡Œå‘ç”Ÿäº æ“ä½œ <code>C</code>ã€‚</p></li></ul><h2 id="å†…å­˜å±éšœ"><a class="markdownIt-Anchor" href="#å†…å­˜å±éšœ"></a> å†…å­˜å±éšœ</h2><p><code>Java</code> ä¸­å¦‚ä½•ä¿è¯åº•å±‚æ“ä½œçš„<strong>æœ‰åºæ€§</strong>å’Œ<strong>å¯è§æ€§</strong>ï¼Ÿå¯ä»¥é€šè¿‡å†…å­˜å±éšœã€‚</p><p>å†…å­˜å±éšœæ˜¯è¢«æ’å…¥ä¸¤ä¸ª <code>CPU</code> æŒ‡ä»¤ä¹‹é—´çš„ä¸€ç§æŒ‡ä»¤ï¼Œ<strong>ç”¨æ¥ç¦æ­¢å¤„ç†å™¨æŒ‡ä»¤å‘ç”Ÿé‡æ’åº</strong>ï¼ˆåƒå±éšœä¸€æ ·ï¼‰ï¼Œä»è€Œä¿éšœæœ‰åºæ€§çš„ã€‚å¦å¤–ï¼Œä¸ºäº†è¾¾åˆ°å±éšœçš„æ•ˆæœï¼Œå®ƒä¹Ÿä¼š<strong>ä½¿å¤„ç†å™¨å†™å…¥ã€è¯»å–å€¼ä¹‹å‰ï¼Œå°†ä¸»å†…å­˜çš„å€¼å†™å…¥é«˜é€Ÿç¼“å­˜ï¼Œæ¸…ç©ºæ— æ•ˆé˜Ÿåˆ—</strong>ï¼Œä»è€Œä¿éšœå¯è§æ€§ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><pre><code class="hljs bash">Store1;Store2;Load1;StoreLoad;  // å†…å­˜å±éšœStore3;Load2;Load3;</code></pre><p>å¯¹äºä¸Šé¢çš„ä¸€ç»„ <code>CPU</code> æŒ‡ä»¤ï¼Œ<code>StoreLoad</code> å±éšœä¹‹å‰çš„ <code>Store</code> æŒ‡ä»¤æ— æ³•ä¸ <code>StoreLoad</code> å±éšœä¹‹åçš„ <code>Load</code> æŒ‡ä»¤è¿›è¡Œäº¤æ¢ä½ç½®ï¼Œå³<strong>é‡æ’åº</strong>ã€‚ä½†æ˜¯ <code>StoreLoad</code> å±éšœä¹‹å‰å’Œä¹‹åçš„æŒ‡ä»¤æ˜¯å¯ä»¥äº’æ¢ä½ç½®çš„ï¼Œå³ <code>Store1</code> å¯ä»¥å’Œ <code>Store2</code> äº’æ¢ï¼Œ<code>Load2</code> å¯ä»¥å’Œ <code>Load3</code> äº’æ¢ã€‚</p><p>å¸¸è§æœ‰ 4 ç§å±éšœ</p><ul><li><p><strong><code>LoadLoad</code> å±éšœ</strong> - å¯¹äºè¿™æ ·çš„è¯­å¥ <code>Load1; LoadLoad; Load2</code>ï¼Œåœ¨ <code>Load2</code> åŠåç»­è¯»å–æ“ä½œè¦è¯»å–çš„æ•°æ®è¢«è®¿é—®å‰ï¼Œä¿è¯ <code>Load1</code> è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚</p></li><li><p><strong><code>StoreStore</code> å±éšœ</strong> - å¯¹äºè¿™æ ·çš„è¯­å¥ <code>Store1; StoreStore; Store2</code>ï¼Œåœ¨ <code>Store2</code> åŠåç»­å†™å…¥æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯ <code>Store1</code> çš„å†™å…¥æ“ä½œå¯¹å…¶å®ƒå¤„ç†å™¨å¯è§ã€‚</p></li><li><p><strong><code>LoadStore</code> å±éšœ</strong> - å¯¹äºè¿™æ ·çš„è¯­å¥ <code>Load1; LoadStore; Store2</code>ï¼Œåœ¨ <code>Store2</code> åŠåç»­å†™å…¥æ“ä½œè¢«æ‰§è¡Œå‰ï¼Œä¿è¯ <code>Load1</code> è¦è¯»å–çš„æ•°æ®è¢«è¯»å–å®Œæ¯•ã€‚</p></li><li><p><strong><code>StoreLoad</code> å±éšœ</strong> - å¯¹äºè¿™æ ·çš„è¯­å¥ <code>Store1; StoreLoad; Load2</code>ï¼Œåœ¨ <code>Load2</code> åŠåç»­æ‰€æœ‰è¯»å–æ“ä½œæ‰§è¡Œå‰ï¼Œä¿è¯ <code>Store1</code> çš„å†™å…¥å¯¹æ‰€æœ‰å¤„ç†å™¨å¯è§ã€‚å®ƒçš„å¼€é”€æ˜¯å››ç§å±éšœä¸­æœ€å¤§çš„ï¼ˆå†²åˆ·å†™ç¼“å†²å™¨ï¼Œæ¸…ç©ºæ— æ•ˆåŒ–é˜Ÿåˆ—ï¼‰ã€‚åœ¨å¤§å¤šæ•°å¤„ç†å™¨çš„å®ç°ä¸­ï¼Œè¿™ä¸ªå±éšœæ˜¯ä¸ªä¸‡èƒ½å±éšœï¼Œå…¼å…·å…¶å®ƒä¸‰ç§å†…å­˜å±éšœçš„åŠŸèƒ½ã€‚</p></li></ul><p><code>Java</code> ä¸­å¯¹å†…å­˜å±éšœçš„ä½¿ç”¨åœ¨ä¸€èˆ¬çš„ä»£ç ä¸­ä¸å¤ªå®¹æ˜“è§åˆ°ï¼Œå¸¸è§çš„æœ‰ <code>volatile</code> å’Œ <code>synchronized</code> å…³é”®å­—ä¿®é¥°çš„ä»£ç å—ï¼Œè¿˜å¯ä»¥é€šè¿‡ <code>Unsafe</code> è¿™ä¸ªç±»æ¥ä½¿ç”¨å†…å­˜å±éšœã€‚</p><h2 id="volatile-å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a class="markdownIt-Anchor" href="#volatile-å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a> volatile å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h2><p><code>volatile</code> æ˜¯ <code>JVM</code> æä¾›çš„ <strong>æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶</strong>ã€‚</p><p>ç‰¹æ€§ï¼š</p><ul><li>ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ã€‚</li><li>ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº</li></ul><h3 id="ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§"><a class="markdownIt-Anchor" href="#ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§"></a> ä¿è¯å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§</h3><p>è¿™é‡Œçš„å¯è§æ€§æ˜¯æŒ‡å½“ä¸€æ¡çº¿ç¨‹ä¿®æ”¹äº† <code>volatile</code> å˜é‡çš„å€¼ï¼Œæ–°å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ã€‚è€Œæ™®é€šå˜é‡ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ™®é€šå˜é‡çš„å€¼åœ¨çº¿ç¨‹é—´ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚</p><p>çº¿ç¨‹å†™ <code>volatile</code> å˜é‡çš„è¿‡ç¨‹ï¼š</p><ol><li>æ”¹å˜çº¿ç¨‹å·¥ä½œå†…å­˜ä¸­ <code>volatile</code> å˜é‡å‰¯æœ¬çš„å€¼</li><li>å°†æ”¹å˜åçš„å‰¯æœ¬çš„å€¼ä»å·¥ä½œå†…å­˜åˆ·æ–°åˆ°ä¸»å†…å­˜</li></ol><p>çº¿ç¨‹è¯» <code>volatile</code> å˜é‡çš„è¿‡ç¨‹ï¼š</p><ul><li>ä»ä¸»å†…å­˜ä¸­è¯»å– <code>volatile</code> å˜é‡çš„æœ€æ–°å€¼åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­</li><li>ä»å·¥ä½œå†…å­˜ä¸­è¯»å– <code>volatile</code> å˜é‡çš„å‰¯æœ¬</li></ul><p>ä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æŠŠæ›´æ–°åçš„å˜é‡å€¼åŒæ—¶åˆ·æ–°å›ä¸»å†…å­˜ï¼Œå¯èƒ½å¯¼è‡´å¾—åˆ°çš„å€¼ä¸æ˜¯é¢„æœŸç»“æœï¼š</p><h3 id="ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº"><a class="markdownIt-Anchor" href="#ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº"></a> ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº</h3><ul><li><p>å½“ç¨‹åºæ‰§è¡Œåˆ° <code>volatile</code> å˜é‡çš„è¯»æ“ä½œæˆ–è€…å†™æ“ä½œæ—¶ï¼Œåœ¨å…¶å‰é¢çš„æ“ä½œçš„æ›´æ”¹è‚¯å®šå…¨éƒ¨å·²ç»è¿›è¡Œï¼Œä¸”ç»“æœå·²ç»å¯¹åé¢çš„æ“ä½œå¯è§ï¼›åœ¨å…¶åé¢çš„æ“ä½œè‚¯å®šè¿˜æ²¡æœ‰è¿›è¡Œï¼›</p></li><li><p>åœ¨è¿›è¡ŒæŒ‡ä»¤ä¼˜åŒ–æ—¶ï¼Œä¸èƒ½å°†åœ¨å¯¹ <code>volatile</code> å˜é‡è®¿é—®çš„è¯­å¥æ”¾åœ¨å…¶åé¢æ‰§è¡Œï¼Œä¹Ÿä¸èƒ½æŠŠ volatile å˜é‡åé¢çš„è¯­å¥æ”¾åˆ°å…¶å‰é¢æ‰§è¡Œã€‚</p></li></ul><h3 id="volatile-çš„åŸç†"><a class="markdownIt-Anchor" href="#volatile-çš„åŸç†"></a> volatile çš„åŸç†</h3><p>å…·ä½“å®ç°æ–¹å¼æ˜¯åœ¨ç¼–è¯‘æœŸç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼š<strong>åœ¨æŒ‡ä»¤åºåˆ—ä¸­å¢åŠ å†…å­˜å±éšœ</strong>æ¥ä¿è¯ï¼Œä¸‹é¢æ˜¯åŸºäºä¿å®ˆç­–ç•¥çš„ <code>JMM</code> å†…å­˜å±éšœæ’å…¥ç­–ç•¥ï¼š</p><ul><li><p>åœ¨æ¯ä¸ª <code>volatile</code> å†™æ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ª <code>StoreStore</code> å±éšœã€‚ è¯¥å±éšœé™¤äº†ä¿è¯äº†å±éšœä¹‹å‰çš„å†™æ“ä½œå’Œè¯¥å±éšœä¹‹åçš„å†™æ“ä½œä¸èƒ½é‡æ’åºï¼Œè¿˜ä¼šä¿è¯äº† <code>volatile</code> å†™æ“ä½œä¹‹å‰ï¼Œä»»ä½•çš„è¯»å†™æ“ä½œéƒ½ä¼šå…ˆäº <code>volatile</code> è¢«æäº¤ã€‚</p></li><li><p>åœ¨æ¯ä¸ª <code>volatile</code> å†™æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª <code>StoreLoad</code> å±éšœã€‚ è¯¥å±éšœé™¤äº†ä½¿ <code>volatile</code> å†™æ“ä½œä¸ä¼šä¸ä¹‹åçš„è¯»æ“ä½œé‡æ’åºå¤–ï¼Œè¿˜ä¼šåˆ·æ–°å¤„ç†å™¨ç¼“å­˜ï¼Œä½¿ <code>volatile</code> å˜é‡çš„å†™æ›´æ–°å¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚</p></li><li><p>åœ¨æ¯ä¸ª <code>volatile</code> è¯»æ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ª <code>LoadLoad</code> å±éšœã€‚ è¯¥å±éšœé™¤äº†ä½¿ <code>volatile</code> è¯»æ“ä½œä¸ä¼šä¸ä¹‹å‰çš„å†™æ“ä½œå‘ç”Ÿé‡æ’åºå¤–ï¼Œè¿˜ä¼šåˆ·æ–°å¤„ç†å™¨ç¼“å­˜ï¼Œä½¿ <code>volatile</code> å˜é‡è¯»å–çš„ä¸ºæœ€æ–°å€¼ã€‚</p></li><li><p>åœ¨æ¯ä¸ª <code>volatile</code> è¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª <code>LoadStore</code> å±éšœã€‚ è¯¥å±éšœé™¤äº†ç¦æ­¢äº† <code>volatile</code> è¯»æ“ä½œä¸å…¶ä¹‹åçš„ä»»ä½•å†™æ“ä½œè¿›è¡Œé‡æ’åºï¼Œè¿˜ä¼šåˆ·æ–°å¤„ç†å™¨ç¼“å­˜ï¼Œä½¿å…¶ä»–çº¿ç¨‹ <code>volatile</code> å˜é‡çš„å†™æ›´æ–°å¯¹ <code>volatile</code> è¯»æ“ä½œçš„çº¿ç¨‹å¯è§ã€‚</p></li></ul><h3 id="volatile-çš„ä½¿ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#volatile-çš„ä½¿ç”¨åœºæ™¯"></a> volatile çš„ä½¿ç”¨åœºæ™¯</h3><p>æ€»ç»“èµ·æ¥ï¼Œå°±æ˜¯â€œä¸€æ¬¡å†™å…¥ï¼Œåˆ°å¤„è¯»å–â€ï¼ŒæŸä¸€çº¿ç¨‹è´Ÿè´£æ›´æ–°å˜é‡ï¼Œå…¶ä»–çº¿ç¨‹åªè¯»å–å˜é‡(ä¸æ›´æ–°å˜é‡)ï¼Œå¹¶æ ¹æ®å˜é‡çš„æ–°å€¼æ‰§è¡Œç›¸åº”é€»è¾‘ã€‚ä¾‹å¦‚çŠ¶æ€æ ‡å¿—ä½æ›´æ–°ï¼Œè§‚å¯Ÿè€…æ¨¡å‹å˜é‡å€¼å‘å¸ƒã€‚</p><h2 id="long-å’Œ-double-å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a class="markdownIt-Anchor" href="#long-å’Œ-double-å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a> long å’Œ double å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h2><p><code>JMM</code> è¦æ±‚ <code>lock</code>ã€<code>unlock</code>ã€<code>read</code>ã€<code>load</code>ã€<code>assign</code>ã€<code>use</code>ã€<code>store</code>ã€<code>write</code> è¿™ 8 ç§æ“ä½œéƒ½å…·æœ‰åŸå­æ€§ï¼Œä½†æ˜¯å¯¹äº 64 ä½çš„æ•°æ®ç±»å‹ï¼ˆ<code>long</code> å’Œ <code>double</code>ï¼‰ï¼Œåœ¨æ¨¡å‹ä¸­ç‰¹åˆ«å®šä¹‰ç›¸å¯¹å®½æ¾çš„è§„å®šï¼šå…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢« <code>volatile</code> ä¿®é¥°çš„ 64 ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ†ä¸º 2 æ¬¡ 32 ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³å…è®¸è™šæ‹Ÿæœºå¯é€‰æ‹©ä¸ä¿è¯ 64 ä½æ•°æ®ç±»å‹çš„ <code>load</code>ã€<code>store</code>ã€<code>read</code> å’Œ <code>write</code> è¿™ 4 ä¸ªæ“ä½œçš„åŸå­æ€§ã€‚ç”±äºè¿™ç§éåŸå­æ€§ï¼Œæœ‰å¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹è¯»åˆ°åŒæ­¥æœªå®Œæˆçš„â€œ32 ä½çš„åŠä¸ªå˜é‡â€çš„å€¼ã€‚</p><p>ä¸è¿‡å®é™…å¼€å‘ä¸­ï¼Œ<code>Java</code> å†…å­˜æ¨¡å‹å¼ºçƒˆå»ºè®®è™šæ‹ŸæœºæŠŠ 64 ä½æ•°æ®çš„è¯»å†™å®ç°ä¸ºå…·æœ‰åŸå­æ€§ï¼Œç›®å‰å„ç§å¹³å°ä¸‹çš„å•†ç”¨è™šæ‹Ÿæœºéƒ½é€‰æ‹©æŠŠ 64 ä½æ•°æ®çš„è¯»å†™æ“ä½œä½œä¸ºåŸå­æ“ä½œæ¥å¯¹å¾…ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ä¸€èˆ¬ä¸éœ€è¦æŠŠç”¨åˆ°çš„ <code>long</code> å’Œ <code>double</code> å˜é‡ä¸“é—¨å£°æ˜ä¸º <code>volatile</code>ã€‚</p><h2 id="final-å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a class="markdownIt-Anchor" href="#final-å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a> final å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>final</code> æˆå‘˜å˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–æˆ–è€…åœ¨æ„é€ å™¨ä¸­åˆå§‹åŒ–ï¼Œå¦åˆ™å°±ä¼šæŠ¥ç¼–è¯‘é”™è¯¯ã€‚ <code>fina</code> å…³é”®å­—çš„å¯è§æ€§æ˜¯æŒ‡ï¼šè¢« <code>final</code> ä¿®é¥°çš„å­—æ®µåœ¨å£°æ˜æ—¶æˆ–è€…æ„é€ å™¨ä¸­ï¼Œä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œé‚£ä¹ˆåœ¨å…¶ä»–çº¿ç¨‹æ— é¡»åŒæ­¥å°±èƒ½æ­£ç¡®çœ‹è§ <code>final</code> å­—æ®µçš„å€¼ã€‚è¿™æ˜¯å› ä¸ºä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œ<code>final</code> å˜é‡çš„å€¼ç«‹åˆ»å›å†™åˆ°ä¸»å†…å­˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¹¶å‘</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶å‘-å·¥å…·ç±»</title>
    <link href="/2020/07/28/concurrent-utils/"/>
    <url>/2020/07/28/concurrent-utils/</url>
    
    <content type="html"><![CDATA[<h1 id="countdownlatch"><a class="markdownIt-Anchor" href="#countdownlatch"></a> CountDownLatch</h1><blockquote><p><code>CountDownLatch</code> ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ <code>count</code>ï¼Œè¡¨ç¤ºéœ€è¦ç­‰å¾…çš„äº‹ä»¶æ•°é‡ã€‚<code>countDown()</code> æ–¹æ³•é€’å‡è®¡æ•°å™¨ï¼Œè¡¨ç¤ºæœ‰ä¸€ä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿã€‚è°ƒç”¨ <code>await()</code> æ–¹æ³•çš„çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ç›´åˆ°<strong>è®¡æ•°å™¨ä¸ºé›¶</strong>ï¼Œæˆ–è€…ç­‰å¾…ä¸­çš„<strong>çº¿ç¨‹ä¸­æ–­</strong>ï¼Œæˆ–è€…<strong>ç­‰å¾…è¶…æ—¶</strong>ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200728155654.png" srcset="/img/loading.gif" alt="" /></p><p><code>CountDownLatch</code> æ˜¯åŸºäº <code>AQS</code> å®ç°çš„ã€‚</p><p><code>CountDownLatch</code> å”¯ä¸€çš„æ„é€ æ–¹æ³•ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">// count è®¡æ•°å™¨</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CountDownLatch</span><span class="hljs-params">(<span class="hljs-keyword">int</span> count)</span> </span>&#123;        <span class="hljs-keyword">if</span> (count &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"count &lt; 0"</span>);        <span class="hljs-keyword">this</span>.sync = <span class="hljs-keyword">new</span> Sync(count);&#125;</code></pre><p><code>CountDownLatch</code> çš„é‡è¦æ–¹æ³•ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">// ç­‰å¾…ç›´åˆ° count å€¼ä¸º 0  æ‰ç»§ç»­æ‰§è¡Œæˆ–å½“å‰çº¿ç¨‹è¢«ä¸­æ–­</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123; &#125;;<span class="hljs-comment">// å’Œ await() ç±»ä¼¼ï¼Œåªä¸è¿‡ç­‰å¾…ä¸€å®šçš„æ—¶é—´å count å€¼è¿˜æ²¡å˜ä¸º 0 çš„è¯å°±ä¼šç»§ç»­æ‰§è¡Œ</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">await</span><span class="hljs-params">(<span class="hljs-keyword">long</span> timeout, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123; &#125;;<span class="hljs-comment">// å°†ç»Ÿè®¡å€¼ count å‡ 1</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">countDown</span><span class="hljs-params">()</span> </span>&#123; &#125;;</code></pre><h1 id="cyclicbarrier"><a class="markdownIt-Anchor" href="#cyclicbarrier"></a> CyclicBarrier</h1><blockquote><p>å­—é¢æ„æ€æ˜¯ å¾ªç¯æ …æ ã€‚<code>CyclicBarrier</code> å¯ä»¥è®©<strong>ä¸€ç»„çº¿ç¨‹</strong>ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼ˆéµå¾ªå­—é¢æ„æ€ï¼Œä¸å¦¨ç§°è¿™ä¸ªçŠ¶æ€ä¸ºæ …æ ï¼‰ä¹‹åå†å…¨éƒ¨åŒæ—¶æ‰§è¡Œã€‚ä¹‹æ‰€ä»¥å«å¾ªç¯æ …æ æ˜¯å› ä¸ºï¼šå½“æ‰€æœ‰ç­‰å¾…çº¿ç¨‹éƒ½è¢«é‡Šæ”¾ä»¥åï¼Œ<code>CyclicBarrier</code> å¯ä»¥è¢«é‡ç”¨ã€‚</p><p><code>CyclicBarrier</code> ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ <code>count</code>ã€‚æ¯æ¬¡æ‰§è¡Œ <code>await</code> æ–¹æ³•ä¹‹åï¼Œ<code>count</code> åŠ  1ï¼Œç›´åˆ°è®¡æ•°å™¨çš„å€¼å’Œè®¾ç½®çš„å€¼ç›¸ç­‰ï¼Œç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚</p></blockquote><ul><li><p><code>CyclicBarrier</code> æ˜¯åŸºäº <code>ReentrantLock</code> å’Œ <code>Condition</code> å®ç°çš„ã€‚</p></li><li><p><code>CyclicBarrier</code> åº”ç”¨åœºæ™¯ï¼š<code>CyclicBarrier</code> åœ¨å¹¶è¡Œè¿­ä»£ç®—æ³•ä¸­éå¸¸æœ‰ç”¨ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200728160917.png" srcset="/img/loading.gif" alt="" /></p><p><code>CyclicBarrier</code> æä¾›äº† 2 ä¸ªæ„é€ æ–¹æ³•</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CyclicBarrier</span><span class="hljs-params">(<span class="hljs-keyword">int</span> parties)</span> </span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CyclicBarrier</span><span class="hljs-params">(<span class="hljs-keyword">int</span> parties, Runnable barrierAction)</span> </span>&#123;&#125;</code></pre><ul><li><p><code>parties</code> - <code>parties</code> æ•°ç›¸å½“äºä¸€ä¸ªé˜ˆå€¼ï¼Œå½“æœ‰ <code>parties</code> æ•°é‡çš„çº¿ç¨‹åœ¨ç­‰å¾…æ—¶ï¼Œ <code>CyclicBarrier</code> å¤„äºæ …æ çŠ¶æ€ã€‚</p></li><li><p><code>barrierAction</code> - å½“ <code>CyclicBarrier</code> å¤„äºæ …æ çŠ¶æ€æ—¶æ‰§è¡Œçš„åŠ¨ä½œã€‚</p></li></ul><p>é‡è¦æ–¹æ³•ï¼š</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, BrokenBarrierException </span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">await</span><span class="hljs-params">(<span class="hljs-keyword">long</span> timeout, TimeUnit unit)</span></span><span class="hljs-function">        <span class="hljs-keyword">throws</span> InterruptedException,</span><span class="hljs-function">               BrokenBarrierException,</span><span class="hljs-function">               TimeoutException </span>&#123;&#125;<span class="hljs-comment">// å°†å±éšœé‡ç½®ä¸ºåˆå§‹çŠ¶æ€</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reset</span><span class="hljs-params">()</span> </span>&#123;&#125;</code></pre><ul><li><p><code>await()</code> - ç­‰å¾…è°ƒç”¨ <code>await()</code> çš„çº¿ç¨‹æ•°è¾¾åˆ°å±éšœæ•°ã€‚å¦‚æœå½“å‰çº¿ç¨‹æ˜¯æœ€åä¸€ä¸ªåˆ°è¾¾çš„çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨æ„é€ å‡½æ•°ä¸­æä¾›äº†éç©ºå±éšœæ“ä½œï¼Œåˆ™å½“å‰çº¿ç¨‹åœ¨å…è®¸å…¶ä»–çº¿ç¨‹ç»§ç»­ä¹‹å‰è¿è¡Œè¯¥æ“ä½œã€‚å¦‚æœåœ¨å±éšœåŠ¨ä½œæœŸé—´å‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆè¯¥å¼‚å¸¸å°†åœ¨å½“å‰çº¿ç¨‹ä¸­ä¼ æ’­å¹¶ä¸”å±éšœè¢«ç½®äºæ–­å¼€çŠ¶æ€ã€‚</p></li><li><p><code>await(long timeout, TimeUnit unit)</code> - ç›¸æ¯”äº <code>await()</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è®©è¿™äº›çº¿ç¨‹ç­‰å¾…è‡³ä¸€å®šçš„æ—¶é—´ï¼Œå¦‚æœè¿˜æœ‰çº¿ç¨‹æ²¡æœ‰åˆ°è¾¾æ …æ çŠ¶æ€å°±ç›´æ¥è®©åˆ°è¾¾æ …æ çŠ¶æ€çš„çº¿ç¨‹æ‰§è¡Œåç»­ä»»åŠ¡ã€‚</p></li><li><p><code>reset()</code> - å°†å±éšœé‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚</p></li></ul><h1 id="semaphore"><a class="markdownIt-Anchor" href="#semaphore"></a> Semaphore</h1><blockquote><p>å­—é¢æ„æ€ä¸º <strong>ä¿¡å·é‡</strong>ã€‚<code>Semaphore</code> ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®æŸä¸ªç‰¹å®šèµ„æºçš„æ“ä½œæ•°é‡ï¼Œæˆ–è€…åŒæ—¶æ‰§è¡ŒæŸä¸ªæŒ‡å®šæ“ä½œçš„æ•°é‡ã€‚</p></blockquote><p><code>Semaphore</code> ç®¡ç†ç€ä¸€ç»„è™šæ‹Ÿçš„è®¸å¯ï¼ˆ<code>permit</code>ï¼‰ï¼Œ<code>permit</code> çš„åˆå§‹æ•°é‡å¯é€šè¿‡æ„é€ æ–¹æ³•æ¥æŒ‡å®šã€‚æ¯æ¬¡æ‰§è¡Œ <code>acquire</code> æ–¹æ³•å¯ä»¥è·å–ä¸€ä¸ª <code>permit</code>ï¼Œå¦‚æœæ²¡æœ‰å°±ç­‰å¾…ï¼›è€Œ <code>release</code> æ–¹æ³•å¯ä»¥é‡Šæ”¾ä¸€ä¸ª <code>permit</code>ã€‚</p><p><code>Semaphore</code> åº”ç”¨åœºæ™¯ï¼š</p><ul><li><p><code>Semaphore</code> å¯ä»¥ç”¨äºå®ç°èµ„æºæ± ï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± ã€‚</p></li><li><p><code>Semaphore</code> å¯ä»¥ç”¨äºå°†ä»»ä½•ä¸€ç§å®¹å™¨å˜æˆæœ‰ç•Œé˜»å¡å®¹å™¨ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200728162824.png" srcset="/img/loading.gif" alt="" /></p><p><code>Semaphore</code> æä¾›äº† 2 ä¸ªæ„é€ æ–¹æ³•ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">// åˆå§‹åŒ–å›ºå®šæ•°é‡çš„ permitï¼Œå¹¶ä¸”é»˜è®¤ä¸ºéå…¬å¹³æ¨¡å¼ã€‚</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Semaphore</span><span class="hljs-params">(<span class="hljs-keyword">int</span> permits)</span> </span>&#123;&#125;<span class="hljs-comment">// è®¾ç½®æ˜¯å¦ä¸ºå…¬å¹³æ¨¡å¼ã€‚æ‰€è°“å…¬å¹³ï¼Œæ˜¯æŒ‡ç­‰å¾…ä¹…çš„ä¼˜å…ˆè·å– permitã€‚</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Semaphore</span><span class="hljs-params">(<span class="hljs-keyword">int</span> permits, <span class="hljs-keyword">boolean</span> fair)</span> </span>&#123;&#125;</code></pre><p>é‡è¦æ–¹æ³•ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">// è·å– 1 ä¸ªè®¸å¯</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquire</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;&#125;<span class="hljs-comment">//è·å– permits ä¸ªè®¸å¯</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquire</span><span class="hljs-params">(<span class="hljs-keyword">int</span> permits)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;&#125;<span class="hljs-comment">// é‡Šæ”¾ 1 ä¸ªè®¸å¯</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release</span><span class="hljs-params">()</span> </span>&#123;&#125;<span class="hljs-comment">//é‡Šæ”¾ permits ä¸ªè®¸å¯</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release</span><span class="hljs-params">(<span class="hljs-keyword">int</span> permits)</span> </span>&#123;&#125;</code></pre><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><ul><li><p><code>CountDownLatch</code> å’Œ <code>CyclicBarrier</code> éƒ½èƒ½å¤Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„ç­‰å¾…ï¼Œåªä¸è¿‡å®ƒä»¬ä¾§é‡ç‚¹ä¸åŒï¼š</p><ul><li><p><code>CountDownLatch</code> ä¸€èˆ¬ç”¨äºæŸä¸ªçº¿ç¨‹ A ç­‰å¾…è‹¥å¹²ä¸ªå…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œå®ƒæ‰æ‰§è¡Œï¼›</p></li><li><p><code>CyclicBarrier</code> ä¸€èˆ¬ç”¨äºä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼›</p></li><li><p>å¦å¤–ï¼Œ<code>CountDownLatch</code> æ˜¯ä¸å¯ä»¥é‡ç”¨çš„ï¼Œè€Œ <code>CyclicBarrier</code> æ˜¯å¯ä»¥é‡ç”¨çš„ã€‚</p></li></ul></li><li><p><code>Semaphore</code> å…¶å®å’Œé”æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒä¸€èˆ¬ç”¨äºæ§åˆ¶å¯¹æŸç»„èµ„æºçš„è®¿é—®æƒé™ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¹¶å‘</tag>
      
      <tag>å·¥å…·ç±»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶å‘-çº¿ç¨‹æ± </title>
    <link href="/2020/07/27/concurrent-threadpool/"/>
    <url>/2020/07/27/concurrent-threadpool/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h1><blockquote><p>çº¿ç¨‹æ± æ˜¯ä¸€ç§å¤šçº¿ç¨‹å¤„ç†å½¢å¼ï¼Œå¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œç„¶ååœ¨åˆ›å»ºçº¿ç¨‹åè‡ªåŠ¨å¯åŠ¨è¿™äº›ä»»åŠ¡ã€‚</p></blockquote><p>å¦‚æœå¹¶å‘è¯·æ±‚æ•°é‡å¾ˆå¤šï¼Œä½†æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´å¾ˆçŸ­ï¼Œå°±ä¼šå‡ºç°é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå¯èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„æ—¶é—´ã€èµ„æºå¼€é”€è¦å¤§äºå®é™…å·¥ä½œçš„æ‰€éœ€ã€‚</p><p>æ­£æ˜¯ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æœ‰å¿…è¦å¼•å…¥çº¿ç¨‹æ± ã€‚ä½¿ç”¨ <strong>çº¿ç¨‹æ± çš„å¥½å¤„</strong> æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><p><strong>é™ä½èµ„æºæ¶ˆè€—</strong> - é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</p></li><li><p><strong>æé«˜å“åº”é€Ÿåº¦</strong> - å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</p></li><li><p><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong> - çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯è¦åšåˆ°åˆç†çš„åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶åŸç†äº†å¦‚æŒ‡æŒã€‚</p></li></ul><h1 id="executor-æ¡†æ¶"><a class="markdownIt-Anchor" href="#executor-æ¡†æ¶"></a> <code>Executor</code> æ¡†æ¶</h1><h2 id="ç®€ä»‹-2"><a class="markdownIt-Anchor" href="#ç®€ä»‹-2"></a> ç®€ä»‹</h2><p><code>Executor</code> æ¡†æ¶æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€ç»„æ‰§è¡Œç­–ç•¥è°ƒç”¨ï¼Œè°ƒåº¦ï¼Œæ‰§è¡Œå’Œæ§åˆ¶çš„å¼‚æ­¥ä»»åŠ¡çš„æ¡†æ¶ï¼Œç›®çš„æ˜¯æä¾›ä¸€ç§å°†â€ä»»åŠ¡æäº¤â€ä¸â€ä»»åŠ¡å¦‚ä½•è¿è¡Œâ€åˆ†ç¦»å¼€æ¥çš„æœºåˆ¶ã€‚</p><p>è¿˜æœ‰å…³é”®çš„ä¸€ç‚¹ï¼šæœ‰åŠ©äºé¿å… <code>this</code> é€ƒé€¸é—®é¢˜ã€‚</p><blockquote><p><code>this</code> é€ƒé€¸æ˜¯æŒ‡åœ¨æ„é€ å‡½æ•°è¿”å›ä¹‹å‰å…¶ä»–çº¿ç¨‹å°±æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨. è°ƒç”¨å°šæœªæ„é€ å®Œå…¨çš„å¯¹è±¡çš„æ–¹æ³•å¯èƒ½å¼•å‘ä»¤äººç–‘æƒ‘çš„é”™è¯¯ã€‚</p></blockquote><h2 id="æ¡†æ¶ç»“æ„"><a class="markdownIt-Anchor" href="#æ¡†æ¶ç»“æ„"></a> æ¡†æ¶ç»“æ„</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727102933.png" srcset="/img/loading.gif" alt="" /></p><h3 id="1-ä»»åŠ¡runnable-callable"><a class="markdownIt-Anchor" href="#1-ä»»åŠ¡runnable-callable"></a> 1. ä»»åŠ¡(<code>Runnable</code> / <code>Callable</code>)</h3><p>æ‰§è¡Œä»»åŠ¡éœ€è¦å®ç°çš„ <code>Runnable</code> æ¥å£ æˆ– <code>Callable</code> æ¥å£ã€‚ä»–ä»¬çš„å®ç°ç±»éƒ½å¯ä»¥è¢« <code>ThreadPoolExecutor</code> æˆ– <code>ScheduledThreadPoolExecutor</code> æ‰§è¡Œã€‚</p><h3 id="2-ä»»åŠ¡çš„æ‰§è¡Œexecutor"><a class="markdownIt-Anchor" href="#2-ä»»åŠ¡çš„æ‰§è¡Œexecutor"></a> 2. ä»»åŠ¡çš„æ‰§è¡Œ(<code>Executor</code>)</h3><p>ä»»åŠ¡æ‰§è¡Œæœºåˆ¶çš„æ ¸å¿ƒæ¥å£ <code>Executor</code> ï¼Œä»¥åŠç»§æ‰¿è‡ª <code>Executor</code> æ¥å£çš„ <code>ExecutorService</code> æ¥å£ã€‚<br /><code>ThreadPoolExecutor</code> å’Œ <code>ScheduledThreadPoolExecutor</code> è¿™ä¸¤ä¸ªå…³é”®ç±»å®ç°äº† <code>ExecutorService</code> æ¥å£ã€‚</p><h4 id="21-executor"><a class="markdownIt-Anchor" href="#21-executor"></a> 2.1 <code>Executor</code></h4><p><code>Executor</code> æ¥å£ä¸­åªå®šä¹‰äº†ä¸€ä¸ª <code>execute</code> æ–¹æ³•ï¼Œç”¨äºæ¥æ”¶ä¸€ä¸ª <code>Runnable</code> å¯¹è±¡ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Executor</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">(Runnable command)</span></span>;&#125;</code></pre><h4 id="22-executorservice"><a class="markdownIt-Anchor" href="#22-executorservice"></a> 2.2 <code>ExecutorService</code></h4><p><code>ExecutorService</code> æ¥å£ç»§æ‰¿äº† <code>Executor</code> æ¥å£ï¼Œå®ƒè¿˜æä¾›äº† <code>invokeAll</code>ã€<code>invokeAny</code>ã€<code>shutdown</code>ã€<code>submit</code> ç­‰æ–¹æ³•ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ExecutorService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Executor</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">shutdown</span><span class="hljs-params">()</span></span>;    <span class="hljs-function">List&lt;Runnable&gt; <span class="hljs-title">shutdownNow</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isShutdown</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isTerminated</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">awaitTermination</span><span class="hljs-params">(<span class="hljs-keyword">long</span> timeout, TimeUnit unit)</span></span><span class="hljs-function">        <span class="hljs-keyword">throws</span> InterruptedException</span>;    &lt;T&gt; <span class="hljs-function">Future&lt;T&gt; <span class="hljs-title">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span></span>;    &lt;T&gt; <span class="hljs-function">Future&lt;T&gt; <span class="hljs-title">submit</span><span class="hljs-params">(Runnable task, T result)</span></span>;    Future&lt;?&gt; submit(Runnable task);    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)        <span class="hljs-keyword">throws</span> InterruptedException;    &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,                                  <span class="hljs-keyword">long</span> timeout, TimeUnit unit)        <span class="hljs-keyword">throws</span> InterruptedException;    &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">invokeAny</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span></span><span class="hljs-function">        <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException</span>;    &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">invokeAny</span><span class="hljs-params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span></span><span class="hljs-function"><span class="hljs-params">                    <span class="hljs-keyword">long</span> timeout, TimeUnit unit)</span></span><span class="hljs-function">        <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException, TimeoutException</span>;&#125;</code></pre><p>æ¯”äº <code>Executor</code> æ¥å£ï¼Œ<code>ExecutorService</code> æ¥å£ä¸»è¦çš„æ‰©å±•æ˜¯ï¼š</p><ul><li>æ”¯æŒæœ‰è¿”å›å€¼çš„çº¿ç¨‹ - <code>sumbit</code>ã€<code>invokeAll</code>ã€<code>invokeAny</code> æ–¹æ³•ä¸­éƒ½æ”¯æŒä¼ å…¥ <code>Callable</code> å¯¹è±¡ã€‚</li><li>æ”¯æŒç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ - <code>shutdown</code>ã€<code>shutdownNow</code>ã€<code>isShutdown</code> ç­‰æ–¹æ³•ã€‚</li></ul><h4 id="23-scheduledexecutorservice"><a class="markdownIt-Anchor" href="#23-scheduledexecutorservice"></a> 2.3 <code>ScheduledExecutorService</code></h4><p><code>ScheduledExecutorService</code> æ¥å£æ‰©å±•äº† <code>ExecutorService</code> æ¥å£ã€‚</p><p>å®ƒé™¤äº†æ”¯æŒå‰é¢ä¸¤ä¸ªæ¥å£çš„æ‰€æœ‰èƒ½åŠ›ä»¥å¤–ï¼Œè¿˜æ”¯æŒå®šæ—¶è°ƒåº¦çº¿ç¨‹ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ScheduledExecutorService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ExecutorService</span> </span>&#123;    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable command, <span class="hljs-keyword">long</span> delay, TimeUnit unit);    <span class="hljs-keyword">public</span> &lt;V&gt; <span class="hljs-function">ScheduledFuture&lt;V&gt; <span class="hljs-title">schedule</span><span class="hljs-params">(Callable&lt;V&gt; callable, <span class="hljs-keyword">long</span> delay, TimeUnit unit)</span></span>;    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,                                                  <span class="hljs-keyword">long</span> initialDelay,                                                  <span class="hljs-keyword">long</span> period,                                                  TimeUnit unit);    <span class="hljs-keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,                                                     <span class="hljs-keyword">long</span> initialDelay,                                                     <span class="hljs-keyword">long</span> delay,                                                     TimeUnit unit);&#125;</code></pre><p>å…¶æ‰©å±•çš„æ¥å£æä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š</p><ul><li><p><code>schedule</code> æ–¹æ³•å¯ä»¥åœ¨æŒ‡å®šçš„å»¶æ—¶åæ‰§è¡Œä¸€ä¸ª <code>Runnable</code> æˆ–è€… <code>Callable</code> ä»»åŠ¡ã€‚</p></li><li><p><code>scheduleAtFixedRate</code> æ–¹æ³•å’Œ <code>scheduleWithFixedDelay</code> æ–¹æ³•å¯ä»¥æŒ‰ç…§æŒ‡å®šæ—¶é—´é—´éš”ï¼Œå®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚</p></li></ul><h3 id="3-å¼‚æ­¥è®¡ç®—çš„ç»“æœfuture"><a class="markdownIt-Anchor" href="#3-å¼‚æ­¥è®¡ç®—çš„ç»“æœfuture"></a> 3. å¼‚æ­¥è®¡ç®—çš„ç»“æœ(<code>Future</code>)</h3><blockquote><p><code>Future</code> æ¥å£ä»¥åŠ <code>Future</code> æ¥å£çš„å®ç°ç±» <code>FutureTask</code> ç±»éƒ½å¯ä»¥ä»£è¡¨å¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚</p></blockquote><p>å½“æˆ‘ä»¬æŠŠ <code>Runnable</code> æ¥å£æˆ– <code>Callable</code> æ¥å£çš„å®ç°ç±»æäº¤ç»™ <code>ThreadPoolExecutor</code> æˆ– <code>ScheduledThreadPoolExecutor</code> æ‰§è¡Œï¼Œè°ƒç”¨ <code>submit()</code> æ–¹æ³•æ—¶ä¼šè¿”å›ä¸€ä¸ª <code>FutureTask</code> å¯¹è±¡ï¼Œå¯é€šè¿‡ <code>FutureTask.get()</code> æ•è·æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><h2 id="executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾"><a class="markdownIt-Anchor" href="#executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾"></a> <code>Executor</code> æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727105429.png" srcset="/img/loading.gif" alt="" /></p><ul><li><p>ä¸»çº¿ç¨‹é¦–å…ˆè¦åˆ›å»ºå®ç° <code>Runnable</code> æˆ–è€… <code>Callable</code> æ¥å£çš„ä»»åŠ¡å¯¹è±¡ã€‚</p></li><li><p>æŠŠåˆ›å»ºå®Œæˆçš„å®ç° <code>Runnable</code> / <code>Callable</code> æ¥å£çš„å¯¹è±¡æäº¤ç»™ <code>ExecutorService</code> æ‰§è¡Œï¼ˆ<code>ExecutorService.submit(Runnable task)</code>æˆ– <code>ExecutorService.submit(Callable &lt;T&gt; task)</code>ï¼‰ã€‚</p></li><li><p>å¦‚æœæ‰§è¡Œ <code>ExecutorService.submit(...)</code>ï¼Œ<code>ExecutorService</code> å°†è¿”å›ä¸€ä¸ªå®ç° <code>Future</code> æ¥å£çš„å¯¹è±¡ã€‚ç”±äº <code>FutureTask</code> å®ç°äº† <code>Runnable</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»º <code>FutureTask</code>ï¼Œç„¶åç›´æ¥äº¤ç»™ <code>ExecutorService</code> æ‰§è¡Œã€‚</p></li><li><p>æœ€åï¼Œä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œ <code>FutureTask.get()</code> æ–¹æ³•æ¥ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚ä¸»çº¿ç¨‹ä¹Ÿå¯ä»¥æ‰§è¡Œ <code>FutureTask.cancel(boolean mayInterruptIfRunning)</code>æ¥å–æ¶ˆæ­¤ä»»åŠ¡çš„æ‰§è¡Œã€‚</p></li></ul><h1 id="threadpoolexecutor"><a class="markdownIt-Anchor" href="#threadpoolexecutor"></a> <code>ThreadPoolExecutor</code></h1><h2 id="ä½¿ç”¨ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ä½¿ç”¨ç¤ºä¾‹"></a> ä½¿ç”¨ç¤ºä¾‹</h2><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : ThreadPoolTest.java 2020/07/27 Mon 3:29 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadPoolTest</span> </span>&#123;    <span class="hljs-comment">// æ ¸å¿ƒçº¿ç¨‹æ•°</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CORE_POOL_SIZE = <span class="hljs-number">5</span>;    <span class="hljs-comment">// æœ€å¤§çº¿ç¨‹æ•°</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAX_POOL_SIZE = <span class="hljs-number">10</span>;    <span class="hljs-comment">// ä»»åŠ¡é˜Ÿåˆ—å®¹é‡</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> QUEUE_CAPACITY = <span class="hljs-number">100</span>;    <span class="hljs-comment">// ç­‰å¾…æ—¶é—´</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> KEEP_ALIVE_TIME = <span class="hljs-number">1L</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹æ± </span>        ThreadPoolExecutor executor = <span class="hljs-keyword">new</span> ThreadPoolExecutor(                CORE_POOL_SIZE,                MAX_POOL_SIZE,                KEEP_ALIVE_TIME,                TimeUnit.SECONDS,                <span class="hljs-keyword">new</span> ArrayBlockingQueue&lt;&gt;(QUEUE_CAPACITY),                <span class="hljs-keyword">new</span> ThreadPoolExecutor.CallerRunsPolicy());        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;            <span class="hljs-comment">// æ‰§è¡Œå·¥ä½œçº¿ç¨‹</span>            Runnable worker = <span class="hljs-keyword">new</span> MyRunnable(<span class="hljs-string">""</span> + i);            executor.execute(worker);            String info = String.format(<span class="hljs-string">"çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°ç›®ï¼š%sï¼Œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡æ•°ç›®ï¼š%sï¼Œå·²æ‰§è¡Œå®Œçš„ä»»åŠ¡æ•°ç›®ï¼š%s"</span>,                    executor.getPoolSize(),                    executor.getQueue().size(),                    executor.getCompletedTaskCount());            System.out.println(info);        &#125;        <span class="hljs-comment">// ç»ˆæ­¢çº¿ç¨‹æ± </span>        executor.shutdown();        <span class="hljs-keyword">while</span> (!executor.isTerminated()) &#123;        &#125;        System.out.println(<span class="hljs-string">"Finish all threads"</span>);    &#125;&#125;<span class="hljs-comment">/**</span><span class="hljs-comment"> * å·¥ä½œçº¿ç¨‹ç±»</span><span class="hljs-comment"> */</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;    <span class="hljs-keyword">private</span> String cmd;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyRunnable</span><span class="hljs-params">(String cmd)</span> </span>&#123;        <span class="hljs-keyword">this</span>.cmd = cmd;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;        System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" Start time = "</span> + <span class="hljs-keyword">new</span> Date());        processCmd();        System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" End time = "</span> + <span class="hljs-keyword">new</span> Date());    &#125;    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processCmd</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">try</span> &#123;            Thread.sleep(<span class="hljs-number">2000</span>);        &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;            e.printStackTrace();        &#125;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-string">"MyRunnable&#123;"</span> +                <span class="hljs-string">"cmd='"</span> + cmd + <span class="hljs-string">'\''</span> +                <span class="hljs-string">'&#125;'</span>;    &#125;&#125;</code></pre><h2 id="æ„é€ æ–¹æ³•"><a class="markdownIt-Anchor" href="#æ„é€ æ–¹æ³•"></a> æ„é€ æ–¹æ³•</h2><p><code>ThreadPoolExecutor</code> æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯åŸºäºç¬¬å››ä¸ªå®ç°ã€‚ç¬¬å››ä¸ªæ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-keyword">int</span> corePoolSize, // çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></span><span class="hljs-function"><span class="hljs-params">                          <span class="hljs-keyword">int</span> maximumPoolSize, // çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span></span><span class="hljs-function"><span class="hljs-params">                          <span class="hljs-keyword">long</span> keepAliveTime, // å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´</span></span><span class="hljs-function"><span class="hljs-params">                          TimeUnit unit, // æ—¶é—´å•ä½</span></span><span class="hljs-function"><span class="hljs-params">                          BlockingQueue&lt;Runnable&gt; workQueue, // ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span></span><span class="hljs-function"><span class="hljs-params">                          ThreadFactory threadFactory, // çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯</span></span><span class="hljs-function"><span class="hljs-params">                          RejectedExecutionHandler handler // æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡</span></span><span class="hljs-function"><span class="hljs-params">                           )</span> </span>&#123;    <span class="hljs-keyword">if</span> (corePoolSize &lt; <span class="hljs-number">0</span> ||        maximumPoolSize &lt;= <span class="hljs-number">0</span> ||        maximumPoolSize &lt; corePoolSize ||        keepAliveTime &lt; <span class="hljs-number">0</span>)        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException();    <span class="hljs-keyword">if</span> (workQueue == <span class="hljs-keyword">null</span> || threadFactory == <span class="hljs-keyword">null</span> || handler == <span class="hljs-keyword">null</span>)        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();    <span class="hljs-keyword">this</span>.corePoolSize = corePoolSize;    <span class="hljs-keyword">this</span>.maximumPoolSize = maximumPoolSize;    <span class="hljs-keyword">this</span>.workQueue = workQueue;    <span class="hljs-keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);    <span class="hljs-keyword">this</span>.threadFactory = threadFactory;    <span class="hljs-keyword">this</span>.handler = handler;&#125;</code></pre><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727145107.png" srcset="/img/loading.gif" alt="" /></p><p>å‚æ•°è¯´æ˜ï¼š</p><ol><li><p><code>corePoolSize</code> - <strong>æ ¸å¿ƒçº¿ç¨‹æ•°é‡</strong>ã€‚å½“æœ‰æ–°ä»»åŠ¡é€šè¿‡ <code>execute</code> æ–¹æ³•æäº¤æ—¶ ï¼Œçº¿ç¨‹æ± ä¼šæ‰§è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š</p><ul><li>å¦‚æœè¿è¡Œçš„çº¿ç¨‹æ•°å°‘äº <code>corePoolSize</code>ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œå³ä½¿çº¿ç¨‹æ± ä¸­çš„å…¶ä»–çº¿ç¨‹æ˜¯ç©ºé—²çš„ã€‚</li><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äº <code>corePoolSize</code> ä¸”å°äº <code>maximumPoolSize</code>ï¼Œåˆ™åªæœ‰å½“ <code>workQueue</code> æ»¡æ—¶æ‰åˆ›å»ºæ–°çš„çº¿ç¨‹å»å¤„ç†ä»»åŠ¡ï¼Œå¦åˆ™å°†ä»»åŠ¡å­˜å‚¨åœ¨é˜Ÿåˆ—é‡Œï¼›</li><li>å¦‚æœè®¾ç½®çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> ç›¸åŒï¼Œåˆ™åˆ›å»ºçš„çº¿ç¨‹æ± çš„å¤§å°æ˜¯å›ºå®šçš„ã€‚è¿™æ—¶å¦‚æœæœ‰æ–°ä»»åŠ¡æäº¤ï¼Œè‹¥ <code>workQueue</code> æœªæ»¡ï¼Œåˆ™å°†è¯·æ±‚æ”¾å…¥ <code>workQueue</code> ä¸­ï¼Œç­‰å¾…æœ‰ç©ºé—²çš„çº¿ç¨‹å»ä» <code>workQueue</code> ä¸­å–ä»»åŠ¡å¹¶å¤„ç†ï¼›</li><li>å¦‚æœè¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äº <code>maximumPoolSize</code>ï¼Œè¿™æ—¶å¦‚æœ <code>workQueue</code> å·²ç»æ»¡äº†ï¼Œåˆ™ä½¿ç”¨ <code>handler</code> æ‰€æŒ‡å®šçš„ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡ï¼›</li><li>æ‰€ä»¥ï¼Œä»»åŠ¡æäº¤æ—¶ï¼Œåˆ¤æ–­çš„é¡ºåºä¸º <code>corePoolSize</code> =&gt; <code>workQueue</code> =&gt; <code>maximumPoolSize</code>ã€‚</li></ul></li><li><p><code>maximumPoolSize</code> - <strong>æœ€å¤§çº¿ç¨‹æ•°é‡</strong>ã€‚</p><ul><li>å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å·²åˆ›å»ºçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™çº¿ç¨‹æ± ä¼šå†åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚</li><li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½¿ç”¨äº†æ— ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—è¿™ä¸ªå‚æ•°å°±æ²¡ä»€ä¹ˆæ•ˆæœã€‚</li></ul></li><li><p><code>keepAliveTime</code> - <strong>çº¿ç¨‹ä¿æŒæ´»åŠ¨çš„æ—¶é—´</strong>ã€‚</p><ul><li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº <code>corePoolSize</code> çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† <code>keepAliveTime</code>ã€‚</li><li>æ‰€ä»¥ï¼Œå¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥è°ƒå¤§è¿™ä¸ªæ—¶é—´ï¼Œæé«˜çº¿ç¨‹çš„åˆ©ç”¨ç‡ã€‚</li></ul></li><li><p><code>unit</code> - <strong><code>keepAliveTime</code> çš„æ—¶é—´å•ä½</strong>ã€‚<br />æœ‰ 7 ç§å–å€¼ã€‚å¯é€‰çš„å•ä½æœ‰å¤©ï¼ˆ<code>DAYS</code>ï¼‰ï¼Œå°æ—¶ï¼ˆ<code>HOURS</code>ï¼‰ï¼Œåˆ†é’Ÿï¼ˆ<code>MINUTES</code>ï¼‰ï¼Œæ¯«ç§’(<code>MILLISECONDS</code>)ï¼Œå¾®ç§’(<code>MICROSECONDS</code>, åƒåˆ†ä¹‹ä¸€æ¯«ç§’)å’Œæ¯«å¾®ç§’(<code>NANOSECONDS</code>, åƒåˆ†ä¹‹ä¸€å¾®ç§’)ã€‚</p></li><li><p><code>workQueue</code> - <strong>ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—</strong>ã€‚ç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚ å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚</p><ul><li><p><code>ArrayBlockingQueue</code> - <strong>æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</p><ul><li>æ­¤é˜Ÿåˆ—æ˜¯åŸºäº<strong>æ•°ç»„</strong>çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆ<code>FIFO</code>ï¼‰ã€‚</li><li>åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå¤§å°ã€‚</li></ul></li><li><p><code>LinkedBlockingQueue</code> - <strong>æ— ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</p><ul><li>æ­¤é˜Ÿåˆ—æ˜¯åŸºäº<strong>é“¾è¡¨</strong>çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆ<code>FIFO</code>ï¼‰ã€‚</li><li>å¦‚æœåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæ­¤é˜Ÿåˆ—å¤§å°ï¼Œåˆ™é»˜è®¤ä¸º <code>Integer.MAX_VALUE</code>ã€‚</li><li>ååé‡é€šå¸¸è¦é«˜äº <code>ArrayBlockingQueue</code>ã€‚</li><li>ä½¿ç”¨ <code>LinkedBlockingQueue</code> æ„å‘³ç€ï¼š <code>maximumPoolSize</code> å°†ä¸èµ·ä½œç”¨ï¼Œçº¿ç¨‹æ± èƒ½åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ä¸º <code>corePoolSize</code>ï¼Œå› ä¸ºä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—æ˜¯æ— ç•Œé˜Ÿåˆ—ã€‚</li><li><code>Executors.newFixedThreadPool</code> ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚</li></ul></li><li><p><code>SynchronousQueue</code> - <strong>ä¸ä¼šä¿å­˜æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯å°†ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æ¥çš„ä»»åŠ¡ã€‚</strong></p><ul><li>æ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚</li><li>ååé‡é€šå¸¸è¦é«˜äº <code>LinkedBlockingQueue</code>ã€‚</li><li><code>Executors.newCachedThreadPool</code> ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚</li></ul></li></ul></li><li><p><code>threadFactory</code> - <strong>çº¿ç¨‹å·¥å‚</strong>ã€‚å¯ä»¥é€šè¿‡çº¿ç¨‹å·¥å‚ç»™æ¯ä¸ªåˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ã€‚</p></li><li><p><code>handler</code> - <strong>é¥±å’Œç­–ç•¥</strong>ã€‚å®ƒæ˜¯ <code>RejectedExecutionHandler</code> ç±»å‹çš„å˜é‡ã€‚å½“é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œè¯´æ˜çº¿ç¨‹æ± å¤„äºé¥±å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…é¡»é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†æäº¤çš„æ–°ä»»åŠ¡ã€‚çº¿ç¨‹æ± æ”¯æŒä»¥ä¸‹ç­–ç•¥ï¼š</p><ul><li><p><code>AbortPolicy</code> - æŠ›å‡º  <code>RejectedExecutionException</code> æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚è¿™ä¹Ÿæ˜¯é»˜è®¤ç­–ç•¥ã€‚</p></li><li><p><code>DiscardPolicy</code> - ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†ä¸æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>DiscardOldestPolicy</code> - ä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼ˆé‡å¤æ­¤è¿‡ç¨‹ï¼‰ã€‚</p></li><li><p><code>CallerRunsPolicy</code> - åªç”¨è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚</p></li><li><p>å¦‚æœä»¥ä¸Šç­–ç•¥éƒ½ä¸èƒ½æ»¡è¶³éœ€è¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç°           <code>RejectedExecutionHandler</code> æ¥å£æ¥å®šåˆ¶å¤„ç†ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚</p></li></ul></li></ol><p>å·¥ä½œæµç¨‹å¦‚ä¸‹å›¾ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727145919.png" srcset="/img/loading.gif" alt="" /></p><h2 id="execute-æ–¹æ³•"><a class="markdownIt-Anchor" href="#execute-æ–¹æ³•"></a> <code>execute</code> æ–¹æ³•</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçº¿ç¨‹æ± ä¹‹åï¼Œçº¿ç¨‹æ± ä¸­æ˜¯æ²¡æœ‰çº¿ç¨‹çš„ï¼Œéœ€è¦æäº¤ä»»åŠ¡ä¹‹åæ‰ä¼šåˆ›å»ºçº¿ç¨‹ã€‚</p><p>æäº¤ä»»åŠ¡å¯ä»¥ä½¿ç”¨ <code>execute</code> æ–¹æ³•ï¼Œå®ƒæ˜¯ <code>ThreadPoolExecutor</code> çš„æ ¸å¿ƒæ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œäº¤ç”±çº¿ç¨‹æ± å»æ‰§è¡Œã€‚</p><p><code>execute</code> æ–¹æ³•å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727162758.png" srcset="/img/loading.gif" alt="" /></p><pre><code class="hljs java"><span class="hljs-comment">// å­˜æ”¾çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (runState) å’Œçº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (workerCount)</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AtomicInteger ctl = <span class="hljs-keyword">new</span> AtomicInteger(ctlOf(RUNNING, <span class="hljs-number">0</span>)); <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">workerCountOf</span><span class="hljs-params">(<span class="hljs-keyword">int</span> c)</span> </span>&#123;     <span class="hljs-keyword">return</span> c &amp; CAPACITY; &#125; <span class="hljs-comment">// ä»»åŠ¡é˜Ÿåˆ—</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> BlockingQueue&lt;Runnable&gt; workQueue; <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span><span class="hljs-params">(Runnable command)</span> </span>&#123;     <span class="hljs-comment">// å¦‚æœä»»åŠ¡ä¸º nullï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</span>     <span class="hljs-keyword">if</span> (command == <span class="hljs-keyword">null</span>)         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();     <span class="hljs-comment">// ctl ä¸­ä¿å­˜çš„çº¿ç¨‹æ± å½“å‰çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯</span>     <span class="hljs-keyword">int</span> c = ctl.get();     <span class="hljs-comment">//  ä¸‹é¢ä¼šæ¶‰åŠåˆ° 3 æ­¥ æ“ä½œ</span>     <span class="hljs-comment">// 1.é¦–å…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ± ä¸­ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡æ˜¯å¦å°äº  corePoolSize</span>     <span class="hljs-comment">// å¦‚æœå°äºçš„è¯ï¼Œåˆ™åˆ›å»ºæ–°çš„æ ¸å¿ƒçº¿ç¨‹å¹¶ä¸”æ‰§è¡Œä¼ å…¥çš„ä»»åŠ¡</span>     <span class="hljs-keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;         <span class="hljs-keyword">if</span> (addWorker(command, <span class="hljs-keyword">true</span>))             <span class="hljs-comment">// å¦‚æœåˆ›å»ºæ–°çš„æ ¸å¿ƒçº¿ç¨‹æˆåŠŸåˆ™ç›´æ¥è¿”å›</span>             <span class="hljs-keyword">return</span>;         <span class="hljs-comment">// è¿™é‡Œè¯´æ˜åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œéœ€è¦æ›´æ–° ctl çš„ä¸´æ—¶å˜é‡ c</span>         c = ctl.get();     &#125;     <span class="hljs-comment">// 2.å¦‚æœå½“å‰ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡å¤§äºç­‰äº corePoolSize çš„æ—¶å€™å°±ä¼šèµ°åˆ°è¿™é‡Œ</span>     <span class="hljs-comment">// åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦å¤„äºè¿è¡Œä¸­çŠ¶æ€ï¼ŒåŒæ—¶å°è¯•ç”¨éé˜»å¡æ–¹æ³•å‘ä»»åŠ¡é˜Ÿåˆ—æ”¾å…¥ä»»åŠ¡</span>     <span class="hljs-keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;         <span class="hljs-keyword">int</span> recheck = ctl.get();         <span class="hljs-comment">// äºŒæ¬¡æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€ã€‚å¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯ RUNNING çŠ¶æ€å°±éœ€è¦ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡ï¼Œå¹¶å°è¯•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚åŒæ—¶æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</span>         <span class="hljs-keyword">if</span> (!isRunning(recheck) &amp;&amp; remove(command))             <span class="hljs-comment">// è°ƒç”¨æ‹’ç»ç­–ç•¥å¤„ç†ä»»åŠ¡ - è¿”å›</span>             reject(command);             <span class="hljs-comment">// å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸ºç©ºå°±æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶æ‰§è¡Œã€‚</span>         <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (workerCountOf(recheck) == <span class="hljs-number">0</span>)             addWorker(<span class="hljs-keyword">null</span>, <span class="hljs-keyword">false</span>);     &#125;     <span class="hljs-comment">// 3. å¦‚æœä»»åŠ¡ä¸èƒ½åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œåˆ™ä¼šå°è¯•åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ä¼ å…¥ä»»åŠ¡æ‰§è¡Œ</span>     <span class="hljs-comment">// åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œæ­¤æ—¶éœ€è¦æ‹’ç»æ‰§è¡Œä»»åŠ¡</span>     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!addWorker(command, <span class="hljs-keyword">false</span>))         <span class="hljs-comment">// è°ƒç”¨æ‹’ç»ç­–ç•¥å¤„ç†ä»»åŠ¡ - è¿”å›</span>         reject(command); &#125;</code></pre><p>å…³äºäºŒæ¬¡æ£€æŸ¥çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€ï¼š</p><blockquote><p>å¦‚æœä¸€ä¸ªä»»åŠ¡æˆåŠŸåŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦äºŒæ¬¡æ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼ˆå› ä¸ºæ‰€æœ‰å­˜æ´»çš„å·¥ä½œçº¿ç¨‹æœ‰å¯èƒ½åœ¨æœ€åä¸€æ¬¡æ£€æŸ¥ä¹‹åå·²ç»ç»ˆç»“ï¼‰æˆ–è€…æ‰§è¡Œå½“å‰æ–¹æ³•çš„æ—¶å€™çº¿ç¨‹æ± æ˜¯å¦å·²ç»ç»ˆç»“äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦äºŒæ¬¡æ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œå¿…é¡»æ—¶æŠŠä»»åŠ¡ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤æˆ–è€…åœ¨æ²¡æœ‰å¯ç”¨çš„å·¥ä½œçº¿ç¨‹çš„å‰æä¸‹æ–°å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚</p></blockquote><h2 id="å…¶ä»–é‡è¦æ–¹æ³•"><a class="markdownIt-Anchor" href="#å…¶ä»–é‡è¦æ–¹æ³•"></a> å…¶ä»–é‡è¦æ–¹æ³•</h2><ul><li><code>submit</code> ç±»ä¼¼äº <code>execute</code>ï¼Œä½†æ˜¯é’ˆå¯¹çš„æ˜¯æœ‰è¿”å›å€¼çš„çº¿ç¨‹ã€‚<code>submit</code> æ–¹æ³•æ˜¯åœ¨ <code>ExecutorService</code> ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œåœ¨ <code>AbstractExecutorService</code> å°±å·²ç»æœ‰äº†å…·ä½“çš„å®ç°ã€‚<code>ThreadPoolExecutor</code> ç›´æ¥å¤ç”¨ <code>AbstractExecutorService</code> çš„ <code>submit</code> æ–¹æ³•ã€‚</li><li><code>shutdown</code> - ä¸ä¼šç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œè€Œæ˜¯è¦ç­‰æ‰€æœ‰ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåæ‰ç»ˆæ­¢ï¼Œä½†å†ä¹Ÿä¸ä¼šæ¥å—æ–°çš„ä»»åŠ¡ã€‚</li><li><code>shutdownNow</code> - ç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œå¹¶å°è¯•æ‰“æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…ç©ºä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ï¼Œè¿”å›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚</li><li><code>isShutdown</code> - è°ƒç”¨äº† <code>shutdown</code> æˆ– <code>shutdownNow</code> æ–¹æ³•åï¼Œ<code>isShutdown</code> æ–¹æ³•å°±ä¼šè¿”å› <code>true</code>ã€‚</li><li><code>isTerminaed</code> - å½“æ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²å…³é—­åï¼Œæ‰è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œè¿™æ—¶è°ƒç”¨ <code>isTerminaed</code> æ–¹æ³•ä¼šè¿”å› <code>true</code>ã€‚</li></ul><h1 id="scheduledthreadpoolexecutor"><a class="markdownIt-Anchor" href="#scheduledthreadpoolexecutor"></a> <code>ScheduledThreadPoolExecutor</code></h1><p><code>ScheduledThreadPoolExecutor</code> ä¸»è¦ç”¨æ¥åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œä»»åŠ¡ï¼Œæˆ–è€…å®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚ è¿™ä¸ªåœ¨å®é™…é¡¹ç›®ä¸­åŸºæœ¬ä¸ä¼šè¢«ç”¨åˆ°ï¼Œå› ä¸ºæœ‰å…¶ä»–æ–¹æ¡ˆé€‰æ‹©æ¯”å¦‚ <code>quartz</code>ã€‚</p><h2 id="ç®€ä»‹-3"><a class="markdownIt-Anchor" href="#ç®€ä»‹-3"></a> ç®€ä»‹</h2><p><code>ScheduledThreadPoolExecutor</code> ä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ— <code>DelayQueue</code> å°è£…äº†ä¸€ä¸ª <code>PriorityQueue</code>ï¼Œ<code>PriorityQueue</code> ä¼šå¯¹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿›è¡Œæ’åºï¼Œæ‰§è¡Œæ‰€éœ€æ—¶é—´çŸ­çš„æ”¾åœ¨å‰é¢å…ˆè¢«æ‰§è¡Œ(<code>ScheduledFutureTask</code> çš„ <code>time</code> å˜é‡å°çš„å…ˆæ‰§è¡Œ)ï¼Œå¦‚æœæ‰§è¡Œæ‰€éœ€æ—¶é—´ç›¸åŒåˆ™å…ˆæäº¤çš„ä»»åŠ¡å°†è¢«å…ˆæ‰§è¡Œ(<code>ScheduledFutureTask</code> çš„ <code>squenceNumber</code> å˜é‡å°çš„å…ˆæ‰§è¡Œ)ã€‚</p><h2 id="è¿è¡Œæœºåˆ¶"><a class="markdownIt-Anchor" href="#è¿è¡Œæœºåˆ¶"></a> è¿è¡Œæœºåˆ¶</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727200044.png" srcset="/img/loading.gif" alt="" /></p><p><code>ScheduledThreadPoolExecutor</code> çš„æ‰§è¡Œä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</p><ul><li><p>å½“è°ƒç”¨ <code>ScheduledThreadPoolExecutor</code> çš„ <code>scheduleAtFixedRate()</code> æ–¹æ³•æˆ–è€… <code>scheduleWirhFixedDelay()</code> æ–¹æ³•æ—¶ï¼Œä¼šå‘ <code>ScheduledThreadPoolExecutor</code> çš„ <code>DelayQueue</code> æ·»åŠ ä¸€ä¸ªå®ç°äº† <code>RunnableScheduledFuture</code> æ¥å£çš„ <code>ScheduledFutureTask</code> ã€‚</p></li><li><p>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä» <code>DelayQueue</code> ä¸­è·å– <code>ScheduledFutureTask</code>ï¼Œç„¶åæ‰§è¡Œä»»åŠ¡ã€‚</p></li></ul><p><code>ScheduledThreadPoolExecutor</code> ä¸ºäº†å®ç°å‘¨æœŸæ€§çš„æ‰§è¡Œä»»åŠ¡ï¼Œå¯¹ <code>ThreadPoolExecutor</code> åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</p><ul><li><p>ä½¿ç”¨ <code>DelayQueue</code> ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—ï¼›</p></li><li><p>è·å–ä»»åŠ¡çš„æ–¹ä¸åŒ</p></li><li><p>æ‰§è¡Œå‘¨æœŸä»»åŠ¡åï¼Œå¢åŠ äº†é¢å¤–çš„å¤„ç†</p></li></ul><h2 id="æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤"><a class="markdownIt-Anchor" href="#æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤"></a> æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤</h2><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727200325.png" srcset="/img/loading.gif" alt="" /></p><ul><li><p>çº¿ç¨‹ 1 ä» <code>DelayQueue</code> ä¸­è·å–å·²åˆ°æœŸçš„ <code>ScheduledFutureTask</code>ï¼ˆ<code>DelayQueue.take()</code>ï¼‰ã€‚åˆ°æœŸä»»åŠ¡æ˜¯æŒ‡ <code>ScheduledFutureTask</code> çš„ <code>time</code> å¤§äºç­‰äºå½“å‰ç³»ç»Ÿçš„æ—¶é—´ï¼›</p></li><li><p>çº¿ç¨‹ 1 æ‰§è¡Œè¿™ä¸ª <code>ScheduledFutureTask</code>ï¼›</p></li><li><p>çº¿ç¨‹ 1 ä¿®æ”¹ <code>ScheduledFutureTask</code> çš„ <code>time</code> å˜é‡ä¸ºä¸‹æ¬¡å°†è¦è¢«æ‰§è¡Œçš„æ—¶é—´ï¼›</p></li><li><p>çº¿ç¨‹ 1 æŠŠè¿™ä¸ªä¿®æ”¹ <code>time</code> ä¹‹åçš„ <code>ScheduledFutureTask</code> æ”¾å› <code>DelayQueue</code> ä¸­ (<code>DelayQueue.add()</code>)ã€‚</p></li></ul><h1 id="å¸¸è§çº¿ç¨‹æ± "><a class="markdownIt-Anchor" href="#å¸¸è§çº¿ç¨‹æ± "></a> å¸¸è§çº¿ç¨‹æ± </h1><p><code>JDK</code> çš„ <code>Executors</code> ç±»ä¸­æä¾›äº†å‡ ç§å…·æœ‰ä»£è¡¨æ€§çš„çº¿ç¨‹æ± ï¼Œè¿™äº›çº¿ç¨‹æ±  éƒ½æ˜¯åŸºäº <code>ThreadPoolExecutor</code> çš„å®šåˆ¶åŒ–å®ç°ã€‚</p><blockquote><p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ <code>Executors</code> å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚</p></blockquote><h2 id="åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼"><a class="markdownIt-Anchor" href="#åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼"></a> åˆ›å»ºçº¿ç¨‹æ± æ–¹å¼</h2><ol><li>é€šè¿‡ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°å®ç°ï¼ˆæ¨èï¼‰</li><li>é€šè¿‡ <code>Executor</code> æ¡†æ¶çš„å·¥å…·ç±» <code>Executors</code> æ¥å®ç° æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸‰ç§ç±»å‹çš„ <code>ThreadPoolExecutor</code><ul><li><code>FixedThreadPool</code></li><li><code>SingleThreadExecutor</code></li><li><code>CachedThreadPool</code></li></ul></li></ol><p><code>Executors</code> è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p><ul><li><code>FixedThreadPool</code> å’Œ <code>SingleThreadExecutor</code> ï¼š å…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ <code>OOM</code>ã€‚</li><li><code>CachedThreadPool</code> å’Œ <code>ScheduledThreadPool</code> ï¼š å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code> ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ <code>OOM</code>ã€‚</li></ul><h2 id="fixedthreadpool"><a class="markdownIt-Anchor" href="#fixedthreadpool"></a> <code>FixedThreadPool</code></h2><p>åˆ›å»ºä¸€ä¸ª<strong>å›ºå®šå¤§å°</strong>çš„çº¿ç¨‹æ± ã€‚</p><p>æ¯æ¬¡æäº¤ä¸€ä¸ªä»»åŠ¡å°±ä¼šæ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œå¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡è¾¾åˆ°çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™å°†æäº¤çš„ä»»åŠ¡å­˜å…¥åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ã€‚</p><p><code>FixedThreadPool</code> æ˜¯ä¸€ä¸ªå…¸å‹ä¸”ä¼˜ç§€çš„çº¿ç¨‹æ± ï¼Œå®ƒå…·æœ‰çº¿ç¨‹æ± <strong>æé«˜ç¨‹åºæ•ˆç‡</strong>å’Œ<strong>èŠ‚çœåˆ›å»ºçº¿ç¨‹æ—¶æ‰€è€—çš„å¼€é”€</strong>çš„ä¼˜ç‚¹ã€‚ä½†æ˜¯ï¼Œåœ¨çº¿ç¨‹æ± ç©ºé—²æ—¶ï¼Œå³çº¿ç¨‹æ± ä¸­æ²¡æœ‰å¯è¿è¡Œä»»åŠ¡æ—¶ï¼Œå®ƒä¸ä¼šé‡Šæ”¾å·¥ä½œçº¿ç¨‹ï¼Œè¿˜ä¼šå ç”¨ä¸€å®šçš„ç³»ç»Ÿèµ„æºã€‚</p><pre><code class="hljs java"> <span class="hljs-comment">/**</span><span class="hljs-comment">  * åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± </span><span class="hljs-comment">  */</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title">newFixedThreadPool</span><span class="hljs-params">(<span class="hljs-keyword">int</span> nThreads, ThreadFactory threadFactory)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ThreadPoolExecutor(        nThreads,        nThreads,        <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,        <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),        threadFactory);    &#125;</code></pre><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727191728.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾è¯´æ˜ï¼š</p><ul><li><p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äº <code>corePoolSize</code>ï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œå°±åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›</p></li><li><p>å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äº <code>corePoolSize</code> åï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œä¼šå°†ä»»åŠ¡åŠ å…¥ <code>LinkedBlockingQueue</code>ï¼›</p></li><li><p>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œå®Œ æ‰‹å¤´çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä» <code>LinkedBlockingQueue</code> ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</p></li></ul><p><code>FixedThreadPool</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— <code>LinkedBlockingQueue</code>ï¼ˆé˜Ÿåˆ—çš„å®¹é‡ä¸º <code>Intger.MAX_VALUE</code>ï¼‰ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥å¦‚ä¸‹å½±å“ ï¼š</p><ul><li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ° <code>corePoolSize</code> åï¼Œæ–°ä»»åŠ¡å°†åœ¨æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œå› æ­¤çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ <code>corePoolSize</code></li><li>ç”±äºä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>maximumPoolSize</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æƒ…å†µ</li><li>ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>keepAliveTime</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°</li><li>è¿è¡Œä¸­çš„ <code>FixedThreadPool</code>ï¼ˆæœªæ‰§è¡Œ <code>shutdown()</code> æˆ– <code>shutdownNow()</code>ï¼‰ä¸ä¼šæ‹’ç»ä»»åŠ¡ï¼Œåœ¨ä»»åŠ¡æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šå¯¼è‡´ <code>OOM</code></li></ul><h2 id="singlethreadexecutor"><a class="markdownIt-Anchor" href="#singlethreadexecutor"></a> <code>SingleThreadExecutor</code></h2><p>åˆ›å»ºä¸€ä¸ª<strong>å•çº¿ç¨‹</strong>çš„çº¿ç¨‹æ± ã€‚</p><p>åªä¼šåˆ›å»ºå”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(<code>FIFO</code>, <code>LIFO</code>, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒ ã€‚</p><p>å•å·¥ä½œçº¿ç¨‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼š<strong>å¯ä¿è¯é¡ºåºåœ°æ‰§è¡Œå„ä¸ªä»»åŠ¡</strong>ã€‚</p><pre><code class="hljs java">  <span class="hljs-comment">/**</span><span class="hljs-comment">   * è¿”å›åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </span><span class="hljs-comment">   */</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title">newSingleThreadExecutor</span><span class="hljs-params">(ThreadFactory threadFactory)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FinalizableDelegatedExecutorService            (<span class="hljs-keyword">new</span> ThreadPoolExecutor(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>,                                    <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,                                    <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),                                    threadFactory));    &#125;</code></pre><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727192058.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾è¯´æ˜ï¼š</p><ul><li><p>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°‘äº <code>corePoolSize</code>ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›</p></li><li><p>å½“å‰çº¿ç¨‹æ± ä¸­æœ‰ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹åï¼Œå°†ä»»åŠ¡åŠ å…¥ <code>LinkedBlockingQueue</code></p></li><li><p>çº¿ç¨‹æ‰§è¡Œå®Œå½“å‰çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä» <code>LinkedBlockingQueue</code> ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</p></li></ul><p>å½±å“ï¼š <code>SingleThreadExecutor</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— <code>LinkedBlockingQueue</code> ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ï¼ˆé˜Ÿåˆ—çš„å®¹é‡ä¸º <code>Intger.MAX_VALUE</code>ï¼‰ã€‚<code>SingleThreadExecutor</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥çš„å½±å“ä¸ <code>FixedThreadPool</code> ç›¸åŒï¼Œä¹Ÿå¯èƒ½å¯¼è‡´ <code>OOM</code>ã€‚</p><h2 id="cachedthreadpool"><a class="markdownIt-Anchor" href="#cachedthreadpool"></a> <code>CachedThreadPool</code></h2><p>åˆ›å»ºä¸€ä¸ª<strong>å¯ç¼“å­˜</strong>çš„çº¿ç¨‹æ± ã€‚</p><ul><li><p>å¦‚æœçº¿ç¨‹æ± å¤§å°è¶…è¿‡å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹æ•°ï¼Œå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²çš„çº¿ç¨‹ï¼›</p></li><li><p>å¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¾€çº¿ç¨‹æ± ä¸­æäº¤ä»»åŠ¡ï¼Œå³å¦‚æœå·¥ä½œçº¿ç¨‹ç©ºé—²äº†æŒ‡å®šçš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º 1 åˆ†é’Ÿï¼‰ï¼Œåˆ™è¯¥å·¥ä½œçº¿ç¨‹å°†è‡ªåŠ¨ç»ˆæ­¢ã€‚ç»ˆæ­¢åï¼Œå¦‚æœä½ åˆæäº¤äº†æ–°çš„ä»»åŠ¡ï¼Œåˆ™çº¿ç¨‹æ± é‡æ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚</p></li><li><p>æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´ <code>JVM</code>ï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚å› æ­¤ï¼Œä½¿ç”¨ <code>CachedThreadPool</code> æ—¶ï¼Œä¸€å®šè¦æ³¨æ„<strong>æ§åˆ¶ä»»åŠ¡çš„æ•°é‡</strong>ï¼Œå¦åˆ™ï¼Œç”±äºå¤§é‡çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¾ˆæœ‰ä¼šé€ æˆç³»ç»Ÿç˜«ç—ªã€‚</p></li></ul><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹ï¼Œä½†ä¼šåœ¨å…ˆå‰æ„å»ºçš„çº¿ç¨‹å¯ç”¨æ—¶é‡ç”¨å®ƒã€‚</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title">newCachedThreadPool</span><span class="hljs-params">(ThreadFactory threadFactory)</span> </span>&#123;        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ThreadPoolExecutor(<span class="hljs-number">0</span>, Integer.MAX_VALUE,                                      <span class="hljs-number">60L</span>, TimeUnit.SECONDS,                                      <span class="hljs-keyword">new</span> SynchronousQueue&lt;Runnable&gt;(),                                      threadFactory);    &#125;</code></pre><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200727192747.png" srcset="/img/loading.gif" alt="" /></p><p>ä¸Šå›¾è¯´æ˜ï¼š</p><ul><li><p>é¦–å…ˆæ‰§è¡Œ <code>SynchronousQueue.offer(Runnable task)</code> æäº¤ä»»åŠ¡åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æœå½“å‰ <code>maximumPool</code> ä¸­æœ‰é—²çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹æ‰§è¡Œ <code>offer</code> æ“ä½œä¸ç©ºé—²çº¿ç¨‹æ‰§è¡Œçš„ <code>poll</code> æ“ä½œé…å¯¹æˆåŠŸï¼Œä¸»çº¿ç¨‹æŠŠä»»åŠ¡äº¤ç»™ç©ºé—²çº¿ç¨‹æ‰§è¡Œï¼Œ<code>execute()</code> æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå¦åˆ™æ‰§è¡Œä¸‹é¢çš„æ­¥éª¤ 2ï¼›</p></li><li><p>å½“åˆå§‹ <code>maximumPool</code> ä¸ºç©ºï¼Œæˆ–è€… <code>maximumPool</code> ä¸­æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œå°†æ²¡æœ‰çº¿ç¨‹æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¥éª¤ 1 å°†å¤±è´¥ï¼Œæ­¤æ—¶ <code>CachedThreadPool</code> ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œ<code>execute</code> æ–¹æ³•æ‰§è¡Œå®Œæˆï¼›</p></li></ul><p>å½±å“ï¼š<code>CachedThreadPool</code> å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code>ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ <code>OOM</code>ã€‚</p><h1 id="çº¿ç¨‹æ± å¤§å°ç¡®å®š"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± å¤§å°ç¡®å®š"></a> çº¿ç¨‹æ± å¤§å°ç¡®å®š</h1><blockquote><p>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</p><p>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº <code>CPU</code> æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª <code>CPU</code> æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼Œ<code>CPU</code> é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚å½“ä¸€ä¸ªçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œçš„æ—¶å€™å°±ä¼šé‡æ–°å¤„äºå°±ç»ªçŠ¶æ€è®©ç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å±äºä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ¦‚æ‹¬æ¥è¯´å°±æ˜¯ï¼šå½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ <code>CPU</code> æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>ä¸Šä¸‹æ–‡åˆ‡æ¢é€šå¸¸æ˜¯<strong>è®¡ç®—å¯†é›†å‹</strong>çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒéœ€è¦ç›¸å½“å¯è§‚çš„å¤„ç†å™¨æ—¶é—´ï¼Œåœ¨æ¯ç§’å‡ åä¸Šç™¾æ¬¡çš„åˆ‡æ¢ä¸­ï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½éœ€è¦çº³ç§’é‡çº§çš„æ—¶é—´ã€‚æ‰€ä»¥ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ <code>CPU</code> æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚</p><p><code>Linux</code> ç›¸æ¯”ä¸å…¶ä»–æ“ä½œç³»ç»Ÿï¼ˆåŒ…æ‹¬å…¶ä»–ç±» <code>Unix</code> ç³»ç»Ÿï¼‰æœ‰å¾ˆå¤šçš„ä¼˜ç‚¹ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹å°±æ˜¯ï¼Œå…¶ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œæ¨¡å¼åˆ‡æ¢çš„æ—¶é—´æ¶ˆè€—éå¸¸å°‘ã€‚</p></blockquote><p>å¦‚æœæˆ‘ä»¬è®¾ç½®çš„çº¿ç¨‹æ± æ•°é‡å¤ªå°çš„è¯ï¼Œå¦‚æœåŒä¸€æ—¶é—´æœ‰å¤§é‡ä»»åŠ¡/è¯·æ±‚éœ€è¦å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚/ä»»åŠ¡åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œï¼Œç”šè‡³ä¼šå‡ºç°ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¹‹åä»»åŠ¡/è¯·æ±‚æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œæˆ–è€…å¤§é‡ä»»åŠ¡å †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—å¯¼è‡´ <code>OOM</code>ã€‚è¿™æ ·å¾ˆæ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„ï¼ <code>CPU</code> æ ¹æœ¬æ²¡æœ‰å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®çº¿ç¨‹æ•°é‡å¤ªå¤§ï¼Œå¤§é‡çº¿ç¨‹å¯èƒ½ä¼šåŒæ—¶åœ¨äº‰å– <code>CPU</code> èµ„æºï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œå¢åŠ çº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå½±å“äº†æ•´ä½“æ‰§è¡Œæ•ˆç‡ã€‚</p><p>æœ‰ä¸€ä¸ªç®€å•å¹¶ä¸”é€‚ç”¨é¢æ¯”è¾ƒå¹¿çš„å…¬å¼ï¼š</p><ul><li><p><code>CPU</code> å¯†é›†å‹ä»»åŠ¡(<code>N + 1</code>)ï¼šè¿™ç§ä»»åŠ¡æ¶ˆè€—çš„ä¸»è¦æ˜¯ <code>CPU</code> èµ„æºï¼Œå¯ä»¥å°†çº¿ç¨‹æ•°è®¾ç½®ä¸º <code>Nï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰+ 1</code>ï¼Œæ¯” <code>CPU</code> æ ¸å¿ƒæ•°å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹å¶å‘çš„ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…å…¶å®ƒåŸå› å¯¼è‡´çš„ä»»åŠ¡æš‚åœè€Œå¸¦æ¥çš„å½±å“ã€‚ä¸€æ—¦ä»»åŠ¡æš‚åœï¼Œ<code>CPU</code> å°±ä¼šå¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å……åˆ†åˆ©ç”¨ <code>CPU</code> çš„ç©ºé—²æ—¶é—´ã€‚</p></li><li><p><code>I/O</code> å¯†é›†å‹ä»»åŠ¡(<code>2N</code>)ï¼šè¿™ç§ä»»åŠ¡åº”ç”¨èµ·æ¥ï¼Œç³»ç»Ÿä¼šç”¨å¤§éƒ¨åˆ†çš„æ—¶é—´æ¥å¤„ç† <code>I/O</code> äº¤äº’ï¼Œè€Œçº¿ç¨‹åœ¨å¤„ç† <code>I/O</code> çš„æ—¶é—´æ®µå†…ä¸ä¼šå ç”¨ <code>CPU</code> æ¥å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥å°† <code>CPU</code> äº¤å‡ºç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚å› æ­¤åœ¨ <code>I/O</code> å¯†é›†å‹ä»»åŠ¡çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›çº¿ç¨‹ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ <code>2N</code>ã€‚</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¹¶å‘</tag>
      
      <tag>çº¿ç¨‹æ± </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶å‘-å®¹å™¨</title>
    <link href="/2020/07/24/concurrent-container/"/>
    <url>/2020/07/24/concurrent-container/</url>
    
    <content type="html"><![CDATA[<h1 id="åŒæ­¥å®¹å™¨"><a class="markdownIt-Anchor" href="#åŒæ­¥å®¹å™¨"></a> åŒæ­¥å®¹å™¨</h1><h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2><p>åœ¨ <code>Java</code> ä¸­ï¼ŒåŒæ­¥å®¹å™¨ä¸»è¦åŒ…æ‹¬ <code>2</code> ç±»ï¼š</p><ul><li><p><code>Vector</code>, <code>Stack</code>, <code>HashTable</code></p><ul><li><code>Vector</code> - <code>Vector</code> å®ç°äº† <code>List</code> æ¥å£ã€‚<code>Vector</code> å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå’Œ <code>ArrayList</code> ç±»ä¼¼ã€‚ä½†æ˜¯ <code>Vector</code> ä¸­çš„æ–¹æ³•éƒ½æ˜¯ <code>synchronized</code> æ–¹æ³•ï¼Œå³è¿›è¡Œäº†åŒæ­¥æªæ–½ã€‚</li><li><code>Stack</code> - <code>Stack</code> ç»§æ‰¿äº <code>Vector</code> ç±»ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåŒæ­¥å®¹å™¨ï¼Œå®ƒçš„æ–¹æ³•ä¹Ÿç”¨ <code>synchronized</code> è¿›è¡Œäº†åŒæ­¥ã€‚</li><li><code>Hashtable</code>- <code>Hashtable</code> å®ç°äº† <code>Map</code> æ¥å£ï¼Œä½†æ˜¯ <code>Hashtable</code> ç”¨ <code>synchronized</code> è¿›è¡Œäº†åŒæ­¥ã€‚</li></ul></li><li><p><code>Collections</code> ç±»ä¸­æä¾›çš„é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºçš„ç±»ï¼ˆç”± <code>Collections.synchronizedXXX</code> ç­‰æ–¹æ³•ï¼‰ã€‚</p></li></ul><h2 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h2><p>åŒæ­¥å®¹å™¨çš„åŒæ­¥åŸç†å°±æ˜¯åœ¨æ–¹æ³•ä¸Šç”¨ <code>synchronized</code> ä¿®é¥°ã€‚</p><h3 id="æ€§èƒ½é—®é¢˜"><a class="markdownIt-Anchor" href="#æ€§èƒ½é—®é¢˜"></a> æ€§èƒ½é—®é¢˜</h3><p><code>synchronized</code> çš„äº’æ–¥åŒæ­¥ä¼šäº§ç”Ÿé˜»å¡å’Œå”¤é†’çº¿ç¨‹çš„å¼€é”€ã€‚æ˜¾ç„¶ï¼Œè¿™ç§æ–¹å¼æ¯”æ²¡æœ‰ä½¿ç”¨ <code>synchronized</code> çš„å®¹å™¨æ€§èƒ½è¦å·®ã€‚</p><h3 id="å®‰å…¨é—®é¢˜"><a class="markdownIt-Anchor" href="#å®‰å…¨é—®é¢˜"></a> å®‰å…¨é—®é¢˜</h3><p>åŒæ­¥å®¹å™¨çœŸçš„ç»å¯¹å®‰å…¨å—ï¼Ÿ</p><p>å…¶å®ä¹Ÿæœªå¿…ã€‚åœ¨åšå¤åˆæ“ä½œï¼ˆéåŸå­æ“ä½œï¼‰æ—¶ï¼Œä»ç„¶éœ€è¦åŠ é”æ¥ä¿æŠ¤ã€‚å¸¸è§å¤åˆæ“ä½œå¦‚ä¸‹ï¼š</p><ul><li><p>è¿­ä»£ï¼šåå¤è®¿é—®å…ƒç´ ï¼Œç›´åˆ°éå†å®Œå…¨éƒ¨å…ƒç´ ï¼›</p></li><li><p>è·³è½¬ï¼šæ ¹æ®æŒ‡å®šé¡ºåºå¯»æ‰¾å½“å‰å…ƒç´ çš„ä¸‹ä¸€ä¸ªï¼ˆä¸‹ <code>n</code> ä¸ªï¼‰å…ƒç´ ï¼›</p></li><li><p>æ¡ä»¶è¿ç®—ï¼šä¾‹å¦‚è‹¥æ²¡æœ‰åˆ™æ·»åŠ ç­‰ï¼›</p></li></ul><p>âŒ ä¸å®‰å…¨çš„ç¤ºä¾‹</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : ConcurrentContainerTest.java 2020/07/24 Fri 1:56 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcurrentContainerTest</span> </span>&#123;    <span class="hljs-keyword">static</span> Vector&lt;Integer&gt; vector = <span class="hljs-keyword">new</span> Vector&lt;&gt;();    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;            vector.clear();            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;                vector.add(i);            &#125;            Thread t1 = <span class="hljs-keyword">new</span> Thread(() -&gt; &#123;                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; vector.size(); i++) &#123;                    vector.remove(i);                &#125;            &#125;);            Thread t2 = <span class="hljs-keyword">new</span> Thread(() -&gt; &#123;                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; vector.size(); i++) &#123;                    vector.get(i);                &#125;            &#125;);            t1.start();            t2.start();            <span class="hljs-keyword">while</span> (Thread.activeCount() &gt; <span class="hljs-number">10</span>) &#123;                System.out.println(<span class="hljs-string">"åŒæ—¶å­˜åœ¨åä¸ªä»¥ä¸Šçº¿ç¨‹ï¼Œ é€€å‡º"</span>);                <span class="hljs-keyword">return</span>;            &#125;        &#125;    &#125;&#125;</code></pre><p>ä»¥ä¸Šç¨‹åºæ‰§è¡Œæ—¶å¯èƒ½ä¼šå‡ºç°æ•°ç»„è¶Šç•Œé”™è¯¯ã€‚</p><p>è¿™æ˜¯å› ä¸ºï¼Œå¯¹äº <code>Vector</code>ï¼Œè™½ç„¶èƒ½ä¿è¯æ¯ä¸€ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®å®ƒï¼Œä½†æ˜¯ä¸æ’é™¤è¿™ç§å¯èƒ½ï¼š<br />å½“æŸä¸ªçº¿ç¨‹è¿›è¡Œè¯»æ“ä½œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½å·²ç»åˆ é™¤äº†è¯¥çº¿ç¨‹æ‰€è¦è¯»çš„é‚£ä¸ªå…ƒç´ ã€‚</p><p>å› æ­¤ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¿…é¡»åœ¨æ–¹æ³•è°ƒç”¨ç«¯åšé¢å¤–çš„åŒæ­¥æªæ–½ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">synchronized</span> (vector) &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; vector.size(); i++) &#123;        vector.remove(i);    &#125;&#125;<span class="hljs-keyword">synchronized</span> (vector) &#123;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; vector.size(); i++) &#123;        vector.remove(i);    &#125;&#125;</code></pre><h1 id="å¹¶å‘å®¹å™¨ç®€ä»‹"><a class="markdownIt-Anchor" href="#å¹¶å‘å®¹å™¨ç®€ä»‹"></a> å¹¶å‘å®¹å™¨ç®€ä»‹</h1><blockquote><p>åŒæ­¥å®¹å™¨å°†æ‰€æœ‰å¯¹å®¹å™¨çŠ¶æ€çš„è®¿é—®éƒ½ä¸²è¡ŒåŒ–ï¼Œä»¥ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ï¼Œè¿™ç§ç­–ç•¥ä¼šä¸¥é‡é™ä½å¹¶å‘æ€§ã€‚</p><p>Java 1.5 åæä¾›äº†å¤šç§å¹¶å‘å®¹å™¨ï¼Œä½¿ç”¨å¹¶å‘å®¹å™¨æ¥æ›¿ä»£åŒæ­¥å®¹å™¨ï¼Œå¯ä»¥æå¤§åœ°æé«˜ä¼¸ç¼©æ€§å¹¶é™ä½é£é™©ã€‚</p></blockquote><p>J.U.C åŒ…ä¸­æä¾›äº†å‡ ä¸ªéå¸¸æœ‰ç”¨çš„å¹¶å‘å®¹å™¨ä½œä¸ºçº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼š</p><table><thead><tr><th style="text-align:center">å¹¶å‘å®¹å™¨</th><th style="text-align:center">å¯¹åº”çš„æ™®é€šå®¹å™¨</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><code>ConcurrentHashMap</code></td><td style="text-align:center"><code>HashMap</code></td><td style="text-align:center"><code>Java 1.8</code> ä¹‹å‰é‡‡ç”¨<strong>åˆ†æ®µé”æœºåˆ¶</strong>ç»†åŒ–é”ç²’åº¦ï¼Œé™ä½é˜»å¡ï¼Œä»è€Œæé«˜å¹¶å‘æ€§ï¼›<code>Java 1.8</code> ä¹‹ååŸºäº <code>CAS</code> å®ç°ã€‚</td></tr><tr><td style="text-align:center"><code>ConcurrentSkipListMap</code></td><td style="text-align:center"><code>SortedMap</code></td><td style="text-align:center">åŸºäºè·³è¡¨å®ç°çš„</td></tr><tr><td style="text-align:center"><code>CopyOnWriteArrayList</code></td><td style="text-align:center"><code>ArrayList</code></td><td style="text-align:center">å†™æ—¶å¤åˆ¶</td></tr><tr><td style="text-align:center"><code>CopyOnWriteArraySet</code></td><td style="text-align:center"><code>Set</code></td><td style="text-align:center">åŸºäº <code>CopyOnWriteArrayList</code> å®ç°ã€‚</td></tr><tr><td style="text-align:center"><code>ConcurrentSkipListSet</code></td><td style="text-align:center"><code>SortedSet</code></td><td style="text-align:center">åŸºäº <code>ConcurrentSkipListMap</code> å®ç°ã€‚</td></tr><tr><td style="text-align:center"><code>ConcurrentLinkedQueue</code></td><td style="text-align:center"><code>Queue</code></td><td style="text-align:center">çº¿ç¨‹å®‰å…¨çš„æ— ç•Œé˜Ÿåˆ—ã€‚åº•å±‚é‡‡ç”¨å•é“¾è¡¨ã€‚æ”¯æŒ <code>FIFO</code>ã€‚</td></tr><tr><td style="text-align:center"><code>ConcurrentLinkedDeque</code></td><td style="text-align:center"><code>Deque</code></td><td style="text-align:center">çº¿ç¨‹å®‰å…¨çš„æ— ç•ŒåŒç«¯é˜Ÿåˆ—ã€‚åº•å±‚é‡‡ç”¨åŒå‘é“¾è¡¨ã€‚æ”¯æŒ <code>FIFO</code> å’Œ <code>FILO</code>ã€‚</td></tr><tr><td style="text-align:center"><code>ArrayBlockingQueue</code></td><td style="text-align:center"><code>Queue</code></td><td style="text-align:center">æ•°ç»„å®ç°çš„é˜»å¡é˜Ÿåˆ—ã€‚</td></tr><tr><td style="text-align:center"><code>LinkedBlockingQueue</code></td><td style="text-align:center"><code>Queue</code></td><td style="text-align:center">é“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ã€‚</td></tr><tr><td style="text-align:center"><code>LinkedBlockingDeque</code></td><td style="text-align:center"><code>Deque</code></td><td style="text-align:center">åŒå‘é“¾è¡¨å®ç°çš„åŒç«¯é˜»å¡é˜Ÿåˆ—ã€‚</td></tr></tbody></table><h1 id="concurrenthashmap"><a class="markdownIt-Anchor" href="#concurrenthashmap"></a> <code>ConcurrentHashMap</code></h1><blockquote><p><code>ConcurrentHashMap</code> æ˜¯çº¿ç¨‹å®‰å…¨çš„ <code>HashMap</code> ï¼Œç”¨äºæ›¿ä»£ <code>Hashtable</code>ã€‚</p></blockquote><h2 id="ç‰¹æ€§"><a class="markdownIt-Anchor" href="#ç‰¹æ€§"></a> ç‰¹æ€§</h2><p><code>ConcurrentHashMap</code> å®ç°äº† <code>ConcurrentMap</code> æ¥å£ï¼Œè€Œ <code>ConcurrentMap</code> æ¥å£æ‰©å±•äº† <code>Map</code> æ¥å£ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcurrentHashMap</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMap</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt;</span><span class="hljs-class">    <span class="hljs-keyword">implements</span> <span class="hljs-title">ConcurrentMap</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt;, <span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-comment">// ...</span>&#125;</code></pre><p><code>ConcurrentHashMap</code> çš„å®ç°åŒ…å«äº† <code>HashMap</code> æ‰€æœ‰çš„åŸºæœ¬ç‰¹æ€§ï¼Œå¦‚ï¼šæ•°æ®ç»“æ„ã€è¯»å†™ç­–ç•¥ç­‰ã€‚</p><p><code>ConcurrentHashMap</code> æ²¡æœ‰å®ç°å¯¹ <code>Map</code> åŠ é”ä»¥æä¾›ç‹¬å è®¿é—®ã€‚å› æ­¤æ— æ³•é€šè¿‡åœ¨å®¢æˆ·ç«¯åŠ é”çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„åŸå­æ“ä½œã€‚ä½†æ˜¯ï¼Œä¸€äº›å¸¸è§çš„å¤åˆæ“ä½œï¼Œå¦‚ï¼šâ€œè‹¥æ²¡æœ‰åˆ™æ·»åŠ â€ã€â€œè‹¥ç›¸ç­‰åˆ™ç§»é™¤â€ã€â€œè‹¥ç›¸ç­‰åˆ™æ›¿æ¢â€ï¼Œéƒ½å·²ç»å®ç°ä¸ºåŸå­æ“ä½œï¼Œå¹¶ä¸”æ˜¯å›´ç»• <code>ConcurrentMap</code> çš„æ‰©å±•æ¥å£è€Œå®ç°ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ConcurrentMap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Map</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; </span>&#123;    <span class="hljs-comment">// ä»…å½“ K æ²¡æœ‰ç›¸åº”çš„æ˜ å°„å€¼æ‰æ’å…¥</span>    <span class="hljs-function">V <span class="hljs-title">putIfAbsent</span><span class="hljs-params">(K key, V value)</span></span>;    <span class="hljs-comment">// ä»…å½“ K è¢«æ˜ å°„åˆ° V æ—¶æ‰ç§»é™¤</span>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">remove</span><span class="hljs-params">(Object key, Object value)</span></span>;    <span class="hljs-comment">// ä»…å½“ K è¢«æ˜ å°„åˆ° oldValue æ—¶æ‰æ›¿æ¢ä¸º newValue</span>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">replace</span><span class="hljs-params">(K key, V oldValue, V newValue)</span></span>;    <span class="hljs-comment">// ä»…å½“ K è¢«æ˜ å°„åˆ°æŸä¸ªå€¼æ—¶æ‰æ›¿æ¢ä¸º newValue</span>    <span class="hljs-function">V <span class="hljs-title">replace</span><span class="hljs-params">(K key, V value)</span></span>;&#125;</code></pre><p>ä¸åŒäº <code>Hashtable</code>ï¼Œ<code>ConcurrentHashMap</code> æä¾›çš„è¿­ä»£å™¨ä¸ä¼šæŠ›å‡º <code>ConcurrentModificationException</code>ï¼Œå› æ­¤ä¸éœ€è¦åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å¯¹å®¹å™¨åŠ é”ã€‚</p><blockquote><p>ğŸ”” æ³¨æ„ï¼šä¸€äº›éœ€è¦å¯¹æ•´ä¸ª <code>Map</code> è¿›è¡Œè®¡ç®—çš„æ–¹æ³•ï¼Œå¦‚ <code>size</code> å’Œ <code>isEmpty</code> ï¼Œç”±äºè¿”å›çš„ç»“æœåœ¨è®¡ç®—æ—¶å¯èƒ½å·²ç»è¿‡æœŸï¼Œæ‰€ä»¥å¹¶éå®æ—¶çš„ç²¾ç¡®å€¼ã€‚è¿™æ˜¯ä¸€ç§ç­–ç•¥ä¸Šçš„æƒè¡¡ï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œè¿™ç±»æ–¹æ³•ç”±äºæ€»åœ¨ä¸æ–­å˜åŒ–ï¼Œæ‰€ä»¥è·å–å…¶å®æ—¶ç²¾ç¡®å€¼çš„æ„ä¹‰ä¸å¤§ã€‚<code>ConcurrentHashMap</code> å¼±åŒ–è¿™ç±»æ–¹æ³•ï¼Œä»¥æ¢å–æ›´é‡è¦æ“ä½œï¼ˆå¦‚ï¼š<code>get</code>ã€<code>put</code>ã€<code>containesKey</code>ã€<code>remove</code> ç­‰ï¼‰çš„æ€§èƒ½ã€‚</p></blockquote><h2 id="ç”¨æ³•"><a class="markdownIt-Anchor" href="#ç”¨æ³•"></a> ç”¨æ³•</h2><p>åŒ <code>HashMap</code></p><h2 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h2><p><code>ConcurrentHashMap</code> åœ¨ <code>Java 1.8</code> ä¹‹å‰å’Œ <code>Java 1.8</code> ä¹‹åçš„å®ç°æœ‰å¾ˆå¤§å·®å¼‚ï¼š</p><ul><li><code>Java 1.8</code> ä¹‹å‰é‡‡ç”¨<strong>åˆ†æ®µé”æœºåˆ¶</strong>ç»†åŒ–é”ç²’åº¦ï¼Œé™ä½é˜»å¡ï¼Œä»è€Œæé«˜å¹¶å‘æ€§ã€‚</li><li><code>Java 1.8</code> ä¹‹ååŸºäº <code>CAS</code> å®ç°ã€‚</li></ul><h3 id="java-17-çš„å®ç°"><a class="markdownIt-Anchor" href="#java-17-çš„å®ç°"></a> Java 1.7 çš„å®ç°</h3><p>æ¯ä¸€ä¸ª <code>segment</code> éƒ½æ˜¯ä¸€ä¸ª <code>HashEntry&lt;K,V&gt;[] table</code>ï¼Œ <code>table</code> ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ª <code>HashEntry</code> çš„å•å‘é˜Ÿåˆ—ã€‚æ¯”å¦‚ <code>table[3]</code> ä¸ºé¦–èŠ‚ç‚¹ï¼Œ<code>table[3]-&gt;next</code> ä¸ºèŠ‚ç‚¹ <code>1</code>ï¼Œä¹‹åä¸ºèŠ‚ç‚¹ <code>2</code>ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcurrentHashMap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractMap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt;</span><span class="hljs-class">        <span class="hljs-keyword">implements</span> <span class="hljs-title">ConcurrentMap</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt;, <span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-comment">// å°†æ•´ä¸ª hashmap åˆ†æˆå‡ ä¸ªå°çš„ mapï¼Œæ¯ä¸ª segment éƒ½æ˜¯ä¸€ä¸ªé”ï¼›ä¸ hashtable ç›¸æ¯”ï¼Œè¿™ä¹ˆè®¾è®¡çš„ç›®çš„æ˜¯å¯¹äº put, remove ç­‰æ“ä½œï¼Œå¯ä»¥å‡å°‘å¹¶å‘å†²çªï¼Œå¯¹</span>    <span class="hljs-comment">// ä¸å±äºåŒä¸€ä¸ªç‰‡æ®µçš„èŠ‚ç‚¹å¯ä»¥å¹¶å‘æ“ä½œï¼Œå¤§å¤§æé«˜äº†æ€§èƒ½</span>    <span class="hljs-keyword">final</span> Segment&lt;K,V&gt;[] segments;    <span class="hljs-comment">// æœ¬è´¨ä¸Š Segment ç±»å°±æ˜¯ä¸€ä¸ªå°çš„ hashmapï¼Œé‡Œé¢ table æ•°ç»„å­˜å‚¨äº†å„ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼Œç»§æ‰¿äº† ReentrantLock, å¯ä»¥ä½œä¸ºäº’æ–¥é”ä½¿ç”¨</span>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Segment</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;        <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> HashEntry&lt;K,V&gt;[] table;        <span class="hljs-keyword">transient</span> <span class="hljs-keyword">int</span> count;    &#125;    <span class="hljs-comment">// åŸºæœ¬èŠ‚ç‚¹ï¼Œå­˜å‚¨ Key, Value å€¼</span>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HashEntry</span>&lt;<span class="hljs-title">K</span>,<span class="hljs-title">V</span>&gt; </span>&#123;        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> hash;        <span class="hljs-keyword">final</span> K key;        <span class="hljs-keyword">volatile</span> V value;        <span class="hljs-keyword">volatile</span> HashEntry&lt;K,V&gt; next;    &#125;&#125;</code></pre><h3 id="java-18-çš„å®ç°"><a class="markdownIt-Anchor" href="#java-18-çš„å®ç°"></a> Java 1.8 çš„å®ç°</h3><p><code>JDK 8</code> ä¸­ä¸»è¦åšäº† 2 æ–¹é¢çš„æ”¹è¿›</p><ul><li><p>å–æ¶ˆ <code>segments</code> å­—æ®µï¼Œç›´æ¥é‡‡ç”¨ <code>transient volatile HashEntry&lt;K,V&gt;[] table</code> ä¿å­˜æ•°æ®ï¼Œé‡‡ç”¨ <code>table</code> æ•°ç»„å…ƒç´ ä½œä¸ºé”ï¼Œä»è€Œå®ç°äº†å¯¹æ¯ä¸€è¡Œæ•°æ®è¿›è¡ŒåŠ é”ï¼Œè¿›ä¸€æ­¥å‡å°‘å¹¶å‘å†²çªçš„æ¦‚ç‡ã€‚</p></li><li><p>å°†åŸå…ˆ <strong>æ•°ç»„ï¼‹å•é“¾è¡¨</strong> çš„æ•°æ®ç»“æ„ï¼Œå˜æ›´ä¸º <strong>æ•°ç»„ï¼‹å•é“¾è¡¨ï¼‹çº¢é»‘æ ‘</strong> çš„ç»“æ„ã€‚å¯¹äº <code>hash</code> è¡¨æ¥è¯´ï¼Œæœ€æ ¸å¿ƒçš„èƒ½åŠ›åœ¨äºå°† <code>key hash</code> ä¹‹åèƒ½å‡åŒ€çš„åˆ†å¸ƒåœ¨æ•°ç»„ä¸­ã€‚å¦‚æœ <code>hash</code> ä¹‹åæ•£åˆ—çš„å¾ˆå‡åŒ€ï¼Œé‚£ä¹ˆ <code>table</code> æ•°ç»„ä¸­çš„æ¯ä¸ªé˜Ÿåˆ—é•¿åº¦ä¸»è¦ä¸º <code>0</code> æˆ–è€… <code>1</code>ã€‚ä½†å®é™…æƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ç†æƒ³ï¼Œè™½ç„¶ <code>ConcurrentHashMap</code> ç±»é»˜è®¤çš„åŠ è½½å› å­ä¸º <code>0.75</code>ï¼Œä½†æ˜¯åœ¨æ•°æ®é‡è¿‡å¤§æˆ–è€…è¿æ°”ä¸ä½³çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ä¸€äº›é˜Ÿåˆ—é•¿åº¦è¿‡é•¿çš„æƒ…å†µï¼Œå¦‚æœè¿˜æ˜¯é‡‡ç”¨å•å‘åˆ—è¡¨æ–¹å¼ï¼Œé‚£ä¹ˆæŸ¥è¯¢æŸä¸ªèŠ‚ç‚¹çš„æ—¶é—´å¤æ‚åº¦ä¸º <code>O(n)</code>ï¼›å› æ­¤ï¼Œå¯¹äºä¸ªæ•°è¶…è¿‡ <code>8</code>(é»˜è®¤å€¼)çš„åˆ—è¡¨ï¼Œ<code>JDK 1.8</code> ä¸­é‡‡ç”¨äº†çº¢é»‘æ ‘çš„ç»“æ„ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦å¯ä»¥é™ä½åˆ° <code>O(logN)</code>ï¼Œå¯ä»¥æ”¹è¿›æ€§èƒ½ã€‚</p></li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">final</span> V <span class="hljs-title">putVal</span><span class="hljs-params">(K key, V value, <span class="hljs-keyword">boolean</span> onlyIfAbsent)</span> </span>&#123;    <span class="hljs-keyword">if</span> (key == <span class="hljs-keyword">null</span> || value == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();    <span class="hljs-keyword">int</span> hash = spread(key.hashCode());    <span class="hljs-keyword">int</span> binCount = <span class="hljs-number">0</span>;    <span class="hljs-keyword">for</span> (Node&lt;K,V&gt;[] tab = table;;) &#123;        Node&lt;K,V&gt; f; <span class="hljs-keyword">int</span> n, i, fh;        <span class="hljs-comment">// å¦‚æœ table ä¸ºç©ºï¼Œåˆå§‹åŒ–ï¼›å¦åˆ™ï¼Œæ ¹æ® hash å€¼è®¡ç®—å¾—åˆ°æ•°ç»„ç´¢å¼•iï¼Œå¦‚æœ tab[i] ä¸ºç©ºï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹ Node å³å¯ã€‚æ³¨ï¼štab[i] å®è´¨ä¸ºé“¾è¡¨æˆ–è€…çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹ã€‚</span>        <span class="hljs-keyword">if</span> (tab == <span class="hljs-keyword">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)            tab = initTable();        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((f = tabAt(tab, i = (n - <span class="hljs-number">1</span>) &amp; hash)) == <span class="hljs-keyword">null</span>) &#123;            <span class="hljs-keyword">if</span> (casTabAt(tab, i, <span class="hljs-keyword">null</span>,                         <span class="hljs-keyword">new</span> Node&lt;K,V&gt;(hash, key, value, <span class="hljs-keyword">null</span>)))                <span class="hljs-keyword">break</span>;                   <span class="hljs-comment">// no lock when adding to empty bin</span>        &#125;        <span class="hljs-comment">// å¦‚æœ tab[i] ä¸ä¸ºç©ºå¹¶ä¸” hash å€¼ä¸º MOVEDï¼Œè¯´æ˜è¯¥é“¾è¡¨æ­£åœ¨è¿›è¡Œ transfer æ“ä½œï¼Œè¿”å›æ‰©å®¹å®Œæˆåçš„ tableã€‚</span>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((fh = f.hash) == MOVED)            tab = helpTransfer(tab, f);        <span class="hljs-keyword">else</span> &#123;            V oldVal = <span class="hljs-keyword">null</span>;            <span class="hljs-comment">// é’ˆå¯¹é¦–ä¸ªèŠ‚ç‚¹è¿›è¡ŒåŠ é”æ“ä½œï¼Œè€Œä¸æ˜¯ segmentï¼Œè¿›ä¸€æ­¥å‡å°‘çº¿ç¨‹å†²çª</span>            <span class="hljs-keyword">synchronized</span> (f) &#123;                <span class="hljs-keyword">if</span> (tabAt(tab, i) == f) &#123;                    <span class="hljs-keyword">if</span> (fh &gt;= <span class="hljs-number">0</span>) &#123;                        binCount = <span class="hljs-number">1</span>;                        <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = f;; ++binCount) &#123;                            K ek;                            <span class="hljs-comment">// å¦‚æœåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°å€¼ä¸º key çš„èŠ‚ç‚¹ eï¼Œç›´æ¥è®¾ç½® e.val = value å³å¯ã€‚</span>                            <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;                                ((ek = e.key) == key ||                                 (ek != <span class="hljs-keyword">null</span> &amp;&amp; key.equals(ek)))) &#123;                                oldVal = e.val;                                <span class="hljs-keyword">if</span> (!onlyIfAbsent)                                    e.val = value;                                <span class="hljs-keyword">break</span>;                            &#125;                            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°å€¼ä¸º key çš„èŠ‚ç‚¹ï¼Œç›´æ¥æ–°å»º Node å¹¶åŠ å…¥é“¾è¡¨å³å¯ã€‚</span>                            Node&lt;K,V&gt; pred = e;                            <span class="hljs-keyword">if</span> ((e = e.next) == <span class="hljs-keyword">null</span>) &#123;                                pred.next = <span class="hljs-keyword">new</span> Node&lt;K,V&gt;(hash, key,                                                          value, <span class="hljs-keyword">null</span>);                                <span class="hljs-keyword">break</span>;                            &#125;                        &#125;                    &#125;                    <span class="hljs-comment">// å¦‚æœé¦–èŠ‚ç‚¹ä¸º TreeBin ç±»å‹ï¼Œè¯´æ˜ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œæ‰§è¡Œ utTreeVal æ“ä½œã€‚</span>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> TreeBin) &#123;                        Node&lt;K,V&gt; p;                        binCount = <span class="hljs-number">2</span>;                        <span class="hljs-keyword">if</span> ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,                                                       value)) != <span class="hljs-keyword">null</span>) &#123;                            oldVal = p.val;                            <span class="hljs-keyword">if</span> (!onlyIfAbsent)                                p.val = value;                        &#125;                    &#125;                &#125;            &#125;            <span class="hljs-keyword">if</span> (binCount != <span class="hljs-number">0</span>) &#123;                <span class="hljs-comment">// å¦‚æœèŠ‚ç‚¹æ•° &gt;ï¼8ï¼Œé‚£ä¹ˆè½¬æ¢é“¾è¡¨ç»“æ„ä¸ºçº¢é»‘æ ‘ç»“æ„ã€‚</span>                <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD)                    treeifyBin(tab, i);                <span class="hljs-keyword">if</span> (oldVal != <span class="hljs-keyword">null</span>)                    <span class="hljs-keyword">return</span> oldVal;                <span class="hljs-keyword">break</span>;            &#125;        &#125;    &#125;    <span class="hljs-comment">// è®¡æ•°å¢åŠ 1ï¼Œæœ‰å¯èƒ½è§¦å‘ transfer æ“ä½œ(æ‰©å®¹)ã€‚</span>    addCount(<span class="hljs-number">1L</span>, binCount);    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;&#125;</code></pre><h1 id="copyonwritearraylist"><a class="markdownIt-Anchor" href="#copyonwritearraylist"></a> <code>CopyOnWriteArrayList</code></h1><p>æ¯ä¸ª <code>CopyOnWriteArrayList</code> å¯¹è±¡é‡Œæœ‰ä¸€ä¸ª <code>array</code> æ•°ç»„ç”¨æ¥å­˜æ”¾å…·ä½“å…ƒç´ ã€‚<code>ReentrantLock</code> ç‹¬å é”ç”¨æ¥ä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹ <code>array</code> è¿›è¡Œä¿®æ”¹ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200724151232.png" srcset="/img/loading.gif" alt="" /></p><h2 id="è¦ç‚¹"><a class="markdownIt-Anchor" href="#è¦ç‚¹"></a> è¦ç‚¹</h2><ul><li><p>å¥½å¤„ï¼š<strong>ä»»ä½•çš„è¯»æ“ä½œéƒ½ä¸ç”¨åŠ é”</strong>ï¼Œè€Œä¸”ä¿è¯è¯»å–åˆ°çš„æ˜¯è¯»é‚£ä¸€åˆ» <code>List</code> å®Œæ•´çš„å¿«ç…§æ•°æ®ã€‚ç”±äºè¯»æ“ä½œæ— æ³•æ„ŸçŸ¥æœ€æ–°æ­£åœ¨å˜åŒ–çš„æ•°æ®ï¼Œæ‰€ä»¥ <code>CopyOnWriteArrayList</code> æ˜¯<strong>å¼±ä¸€è‡´æ€§</strong>çš„ã€‚</p></li><li><p>å†™æ—¶å¤åˆ¶æŠ€æœ¯å› ä¸ºæ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦å®Œæ•´æ‹·è´ä¸€æ¬¡åº•å±‚æ•°ç»„ï¼Œæ‰€ä»¥æœ‰é¢å¤–çš„æ€§èƒ½å¼€é”€ï¼Œä½†æ˜¯ç‰¹åˆ«é€‚ç”¨äº<strong>è¯»å¤šå†™å°‘</strong>çš„æ•°æ®è®¿é—®åœºæ™¯ã€‚</p></li></ul><h2 id="å¼±ä¸€è‡´æ€§é—®é¢˜"><a class="markdownIt-Anchor" href="#å¼±ä¸€è‡´æ€§é—®é¢˜"></a> å¼±ä¸€è‡´æ€§é—®é¢˜</h2><p>çº¿ç¨‹1åœ¨æ‰§è¡Œå®Œæ­¥éª¤ <code>A</code> åï¼Œæ‰§è¡Œæ­¥éª¤ <code>B</code> å‰ï¼Œçº¿ç¨‹2è¿›è¡Œäº† <code>remove</code> æ“ä½œã€‚<br />è™½ç„¶çº¿ç¨‹2å·²ç»åˆ é™¤äº† <code>index</code> å¤„çš„å…ƒç´ ï¼Œä½†ç”±äº <code>array</code>æŒ‡å‘çš„æ•°ç»„å¼•ç”¨è®¡æ•°ä¸º 1 è€Œä¸æ˜¯ 0ï¼Œä»ä¼šè¿”å› <code>index</code> å¤„çš„å…ƒç´ ã€‚</p><h2 id="æ·»åŠ å…ƒç´ "><a class="markdownIt-Anchor" href="#æ·»åŠ å…ƒç´ "></a> æ·»åŠ å…ƒç´ </h2><p>å…ˆå°†åŸå®¹å™¨ copy ä¸€ä»½ï¼Œç„¶ååœ¨æ–°å‰¯æœ¬ä¸Šæ‰§è¡Œå†™æ“ä½œï¼Œä¹‹åå†åˆ‡æ¢å¼•ç”¨ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123;    <span class="hljs-comment">// 1.è·å–ç‹¬å é”</span>    <span class="hljs-keyword">final</span> ReentrantLock lock = <span class="hljs-keyword">this</span>.lock;    lock.lock();    <span class="hljs-keyword">try</span> &#123;        <span class="hljs-comment">// 2.è·å– array æ•°ç»„</span>        Object[] elements = getArray();        <span class="hljs-keyword">int</span> len = elements.length;        <span class="hljs-comment">// 3.å¤åˆ¶ array åˆ°æ–°æ•°ç»„</span>        Object[] newElements = Arrays.copyOf(elements, len + <span class="hljs-number">1</span>);        <span class="hljs-comment">// 4.æ·»åŠ å…ƒç´ åˆ°æ–°æ•°ç»„</span>        newElements[len] = e;        <span class="hljs-comment">// 5.ç”¨æ–°æ•°ç»„æ›¿æ¢åŸæ•°ç»„</span>        setArray(newElements);        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    &#125; <span class="hljs-keyword">finally</span> &#123;        <span class="hljs-comment">// 6.é‡Šæ”¾é”</span>        lock.unlock();    &#125;&#125;</code></pre><h2 id="åˆ é™¤å…ƒç´ "><a class="markdownIt-Anchor" href="#åˆ é™¤å…ƒç´ "></a> åˆ é™¤å…ƒç´ </h2><p>å°†é™¤è¦åˆ é™¤å…ƒç´ ä¹‹å¤–çš„å…¶ä»–å…ƒç´ æ‹·è´åˆ°æ–°å‰¯æœ¬ä¸­ï¼Œç„¶ååˆ‡æ¢å¼•ç”¨ï¼Œå°†åŸå®¹å™¨å¼•ç”¨æŒ‡å‘æ–°å‰¯æœ¬ã€‚åŒå±å†™æ“ä½œï¼Œéœ€è¦åŠ é”ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;    <span class="hljs-comment">// è·å–ç‹¬å é”</span>    <span class="hljs-keyword">final</span> ReentrantLock lock = <span class="hljs-keyword">this</span>.lock;    lock.lock();    <span class="hljs-keyword">try</span> &#123;        Object[] elements = getArray();        <span class="hljs-keyword">int</span> len = elements.length;        E oldValue = get(elements, index);        <span class="hljs-comment">// éœ€è¦ç§»åŠ¨çš„å…ƒç´ ä¸ªæ•°</span>        <span class="hljs-keyword">int</span> numMoved = len - index - <span class="hljs-number">1</span>;        <span class="hljs-comment">// è‹¥åˆ é™¤çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ </span>        <span class="hljs-keyword">if</span> (numMoved == <span class="hljs-number">0</span>)           <span class="hljs-comment">// æ‹·è´å‰len-1ä¸ªæ•°æ®åˆ°æ–°å‰¯æœ¬ä¸Šï¼Œå†åˆ‡æ¢å¼•ç”¨</span>           setArray(Arrays.copyOf(elements, len - <span class="hljs-number">1</span>));        <span class="hljs-keyword">else</span> &#123;            Object[] newElements = <span class="hljs-keyword">new</span> Object[len - <span class="hljs-number">1</span>];            <span class="hljs-comment">// åˆ†ä¸¤å—å¤åˆ¶åˆ°æ–°æ•°ç»„</span>            System.arraycopy(elements, <span class="hljs-number">0</span>, newElements, <span class="hljs-number">0</span>, index);            System.arraycopy(elements, index + <span class="hljs-number">1</span>, newElements, index,                             numMoved);            <span class="hljs-comment">// è®¾ç½®æ–°æ•°ç»„</span>            setArray(newElements);        &#125;        <span class="hljs-keyword">return</span> oldValue;    &#125; <span class="hljs-keyword">finally</span> &#123;        <span class="hljs-comment">// é‡Šæ”¾é”</span>        lock.unlock();    &#125;&#125;</code></pre><h2 id="è¯»æ“ä½œ"><a class="markdownIt-Anchor" href="#è¯»æ“ä½œ"></a> è¯»æ“ä½œ</h2><p><code>E get(int index)</code><br />è¯»æ“ä½œæ˜¯ä¸ç”¨åŠ é”çš„ï¼Œæ€§èƒ½å¾ˆé«˜ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;    <span class="hljs-keyword">return</span> get(getArray(), index);&#125;<span class="hljs-comment">// A.è·å– array æ•°ç»„</span><span class="hljs-keyword">final</span> Object[] getArray() &#123;    <span class="hljs-keyword">return</span> array;&#125;<span class="hljs-comment">// B.é€šè¿‡ä¸‹æ ‡è®¿é—®æŒ‡å®šä½ç½®çš„æ•°ç»„å…ƒç´ </span><span class="hljs-function"><span class="hljs-keyword">private</span> E <span class="hljs-title">get</span><span class="hljs-params">(Object[] a, <span class="hljs-keyword">int</span> index)</span> </span>&#123;    <span class="hljs-keyword">return</span> (E) a[index];&#125;</code></pre><h2 id="ä¿®æ”¹æŒ‡å®šå…ƒç´ "><a class="markdownIt-Anchor" href="#ä¿®æ”¹æŒ‡å®šå…ƒç´ "></a> ä¿®æ”¹æŒ‡å®šå…ƒç´ </h2><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> E <span class="hljs-title">set</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index, E element)</span> </span>&#123;    <span class="hljs-comment">// è·å–ç‹¬å é”</span>    <span class="hljs-keyword">final</span> ReentrantLock lock = <span class="hljs-keyword">this</span>.lock;    lock.lock();    <span class="hljs-keyword">try</span> &#123;        <span class="hljs-comment">// è·å– array æ•°ç»„</span>        Object[] elements = getArray();        <span class="hljs-comment">// æ‰¾åˆ°åŸä½ç½®ä¸Šçš„å€¼</span>        E oldValue = get(elements, index);        <span class="hljs-keyword">if</span> (oldValue != element) &#123;            <span class="hljs-keyword">int</span> len = elements.length;            <span class="hljs-comment">// å¤åˆ¶ array åˆ°æ–°æ•°ç»„</span>            Object[] newElements = Arrays.copyOf(elements, len);            <span class="hljs-comment">// è®¾ç½® index ä½ç½®çš„å…ƒç´ </span>            newElements[index] = element;            <span class="hljs-comment">// ç”¨æ–°æ•°ç»„æ›¿æ¢æ—§æ•°ç»„</span>            setArray(newElements);        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// Not quite a no-op; ensures volatile write semantics</span>            setArray(elements);        &#125;        <span class="hljs-keyword">return</span> oldValue;    &#125; <span class="hljs-keyword">finally</span> &#123;        <span class="hljs-comment">// é‡Šæ”¾é”</span>        lock.unlock();    &#125;&#125;</code></pre><h1 id="blockingqueue"><a class="markdownIt-Anchor" href="#blockingqueue"></a> <code>BlockingQueue</code></h1><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BlockingQueue</span>&lt;<span class="hljs-title">E</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">Queue</span>&lt;<span class="hljs-title">E</span>&gt; </span>&#123;&#125;</code></pre><p>åœ¨ <code>BlockingQueue</code> ä¸­ï¼Œå¦‚æœè·å–é˜Ÿåˆ—å…ƒç´ ä½†æ˜¯é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œä¼šé˜»å¡ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­æœ‰å…ƒç´ å†è¿”å›ï¼›å¦‚æœæ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œé‚£ä¹ˆç­‰åˆ°é˜Ÿåˆ—å¯ä»¥æ”¾å…¥æ–°å…ƒç´ æ—¶å†æ”¾å…¥ã€‚</p><p><code>BlockingQueue</code> å¯¹æ’å…¥æ“ä½œã€ç§»é™¤æ“ä½œã€è·å–å…ƒç´ æ“ä½œæä¾›äº†å››ç§ä¸åŒçš„æ–¹æ³•ç”¨äºä¸åŒçš„åœºæ™¯ä¸­ä½¿ç”¨ï¼š</p><p>æŠ›å‡ºå¼‚å¸¸ï¼›</p><ul><li>è¿”å›ç‰¹æ®Šå€¼ï¼ˆ<code>null</code> æˆ– <code>true</code>/<code>false</code>ï¼Œå–å†³äºå…·ä½“çš„æ“ä½œï¼‰ï¼›</li><li>é˜»å¡ç­‰å¾…æ­¤æ“ä½œï¼Œç›´åˆ°è¿™ä¸ªæ“ä½œæˆåŠŸï¼›</li><li>é˜»å¡ç­‰å¾…æ­¤æ“ä½œï¼Œç›´åˆ°æˆåŠŸæˆ–è€…è¶…æ—¶æŒ‡å®šæ—¶é—´ã€‚<br />æ€»ç»“å¦‚ä¸‹ï¼š</li></ul><table><thead><tr><th style="text-align:center">Operation</th><th style="text-align:center">Throws exception</th><th style="text-align:center">Special value</th><th style="text-align:center">Blocks</th><th style="text-align:center">Times out</th></tr></thead><tbody><tr><td style="text-align:center">Insert</td><td style="text-align:center">add(e)</td><td style="text-align:center">offer(e)</td><td style="text-align:center">put(e)</td><td style="text-align:center">offer(e, time, unit)</td></tr><tr><td style="text-align:center">Remove</td><td style="text-align:center">remove()</td><td style="text-align:center">poll()</td><td style="text-align:center">take()</td><td style="text-align:center">poll(time, unit)</td></tr><tr><td style="text-align:center">Examine</td><td style="text-align:center">element()</td><td style="text-align:center">peek()</td><td style="text-align:center">not applicable</td><td style="text-align:center">not applicable</td></tr></tbody></table><p><code>BlockingQueue</code> çš„å„ä¸ªå®ç°ç±»éƒ½éµå¾ªäº†è¿™äº›è§„åˆ™ã€‚</p><p><code>BlockingQueue</code> ä¸æ¥å— <code>null</code> å€¼å…ƒç´ ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¹¶å‘</tag>
      
      <tag>å®¹å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶å‘-åŸå­ç±»</title>
    <link href="/2020/07/21/concurrent-atomic/"/>
    <url>/2020/07/21/concurrent-atomic/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h1><h2 id="ä¸ºä½•éœ€è¦åŸå­å˜é‡ç±»"><a class="markdownIt-Anchor" href="#ä¸ºä½•éœ€è¦åŸå­å˜é‡ç±»"></a> ä¸ºä½•éœ€è¦åŸå­å˜é‡ç±»</h2><p>ä¿è¯çº¿ç¨‹å®‰å…¨æ˜¯ <code>Java</code> å¹¶å‘ç¼–ç¨‹å¿…é¡»è¦è§£å†³çš„é‡è¦é—®é¢˜ã€‚<code>Java</code> ä»åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§è¿™ä¸‰å¤§ç‰¹æ€§å…¥æ‰‹ï¼Œç¡®ä¿å¤šçº¿ç¨‹çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p><ul><li><p>ç¡®ä¿çº¿ç¨‹å®‰å…¨æœ€å¸¸è§çš„åšæ³•æ˜¯åˆ©ç”¨é”æœºåˆ¶ï¼ˆ<code>Lock</code>ã€<code>sychronized</code>ï¼‰æ¥å¯¹å…±äº«æ•°æ®åšäº’æ–¥åŒæ­¥ï¼Œè¿™æ ·åœ¨åŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡ŒæŸä¸ªæ–¹æ³•æˆ–è€…æŸä¸ªä»£ç å—ï¼Œé‚£ä¹ˆæ“ä½œå¿…ç„¶æ˜¯åŸå­æ€§çš„ï¼Œçº¿ç¨‹å®‰å…¨çš„ã€‚äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p></li><li><p><code>volatile</code> æ˜¯è½»é‡çº§çš„é”ï¼ˆè‡ªç„¶æ¯”æ™®é€šé”æ€§èƒ½è¦å¥½ï¼‰ï¼Œå®ƒä¿è¯äº†å…±äº«å˜é‡åœ¨å¤šçº¿ç¨‹ä¸­çš„å¯è§æ€§ï¼Œä½†æ— æ³•ä¿è¯åŸå­æ€§ã€‚æ‰€ä»¥ï¼Œå®ƒåªèƒ½åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ä½¿ç”¨ã€‚</p></li><li><p>ä¸ºäº†å…¼é¡¾åŸå­æ€§ä»¥åŠé”å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œ<code>Java</code> å¼•å…¥äº† <code>CAS</code> ï¼ˆä¸»è¦ä½“ç°åœ¨ Unsafe ç±»ï¼‰æ¥å®ç°éé˜»å¡åŒæ­¥ï¼ˆä¹Ÿå«ä¹è§‚é”ï¼‰ã€‚å¹¶åŸºäº <code>CAS</code> ï¼Œæä¾›äº†ä¸€å¥—åŸå­å·¥å…·ç±»ã€‚</p></li></ul><h2 id="åŸå­å˜é‡ç±»çš„ä½œç”¨"><a class="markdownIt-Anchor" href="#åŸå­å˜é‡ç±»çš„ä½œç”¨"></a> åŸå­å˜é‡ç±»çš„ä½œç”¨</h2><p>åŸå­å˜é‡ç±» <strong>æ¯”é”çš„ç²’åº¦æ›´ç»†ï¼Œæ›´è½»é‡çº§</strong>ï¼Œå¹¶ä¸”å¯¹äºåœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸Šå®ç°é«˜æ€§èƒ½çš„å¹¶å‘ä»£ç æ¥è¯´æ˜¯éå¸¸å…³é”®çš„ã€‚åŸå­å˜é‡å°†å‘ç”Ÿç«äº‰çš„èŒƒå›´ç¼©å°åˆ°å•ä¸ªå˜é‡ä¸Šã€‚</p><p>åŸå­å˜é‡ç±»ç›¸å½“äºä¸€ç§æ³›åŒ–çš„ <code>volatile</code> å˜é‡ï¼Œèƒ½å¤Ÿæ”¯æŒ<strong>åŸå­çš„ã€æœ‰æ¡ä»¶çš„è¯»/æ”¹/å†™</strong>æ“ä½œã€‚</p><p>åŸå­ç±»åœ¨å†…éƒ¨ä½¿ç”¨ <code>CAS</code> æŒ‡ä»¤ï¼ˆåŸºäºç¡¬ä»¶çš„æ”¯æŒï¼‰æ¥å®ç°åŒæ­¥ã€‚è¿™äº›æŒ‡ä»¤é€šå¸¸æ¯”é”æ›´å¿«ã€‚</p><p>åŸå­å˜é‡ç±»å¯ä»¥åˆ†ä¸º <code>4</code> ç»„ï¼š</p><ul><li>åŸºæœ¬ç±»å‹<ul><li><code>AtomicBoolean</code> - å¸ƒå°”ç±»å‹åŸå­ç±»</li><li><code>AtomicInteger</code> - æ•´å‹åŸå­ç±»</li><li><code>AtomicLong</code> - é•¿æ•´å‹åŸå­ç±»</li></ul></li><li>å¼•ç”¨ç±»å‹<ul><li><code>AtomicReference</code> - å¼•ç”¨ç±»å‹åŸå­ç±»</li><li><code>AtomicMarkableReference</code> - å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹åŸå­ç±»</li><li><code>AtomicStampedReference</code> - å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹åŸå­ç±»</li></ul></li><li>æ•°ç»„ç±»å‹<ul><li><code>AtomicIntegerArray</code> - æ•´å½¢æ•°ç»„åŸå­ç±»</li><li><code>AtomicLongArray</code> - é•¿æ•´å‹æ•°ç»„åŸå­ç±»</li><li><code>AtomicReferenceArray</code> - å¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»</li></ul></li><li>å±æ€§æ›´æ–°å™¨ç±»å‹<ul><li><code>AtomicIntegerFieldUpdater</code> - æ•´å‹å­—æ®µçš„åŸå­æ›´æ–°å™¨ã€‚</li><li><code>AtomicLongFieldUpdater</code> - é•¿æ•´å‹å­—æ®µçš„åŸå­æ›´æ–°å™¨ã€‚</li><li><code>AtomicReferenceFieldUpdater</code> - åŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µã€‚</li></ul></li></ul><h1 id="åŸºæœ¬ç±»å‹"><a class="markdownIt-Anchor" href="#åŸºæœ¬ç±»å‹"></a> åŸºæœ¬ç±»å‹</h1><p>è¿™ä¸€ç±»å‹çš„åŸå­ç±»æ˜¯é’ˆå¯¹ <code>Java</code> åŸºæœ¬ç±»å‹è¿›è¡Œæ“ä½œã€‚</p><ul><li><p><code>AtomicBoolean</code> - å¸ƒå°”ç±»å‹åŸå­ç±»</p></li><li><p><code>AtomicInteger</code> - æ•´å‹åŸå­ç±»</p></li><li><p><code>AtomicLong</code> - é•¿æ•´å‹åŸå­ç±»</p></li></ul><p>ä»¥ä¸Šç±»éƒ½æ”¯æŒ <code>CAS</code>ï¼Œæ­¤å¤–ï¼Œ<code>AtomicInteger</code>ã€<code>AtomicLong</code> è¿˜æ”¯æŒç®—æœ¯è¿ç®—ã€‚</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">()</span> <span class="hljs-comment">// è·å–å½“å‰å€¼</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAndSet</span><span class="hljs-params">(<span class="hljs-keyword">int</span> newValue)</span> <span class="hljs-comment">// è·å–å½“å‰å€¼ï¼Œå¹¶è®¾ç½®æ–°å€¼</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAndIncrement</span><span class="hljs-params">()</span><span class="hljs-comment">// è·å–å½“å‰å€¼ï¼Œå¹¶è‡ªå¢</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAndDecrement</span><span class="hljs-params">()</span> <span class="hljs-comment">// è·å–å½“å‰å€¼ï¼Œå¹¶è‡ªå‡</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAndAdd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> delta)</span> <span class="hljs-comment">// è·å–å½“å‰å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸå€¼</span></span><span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">compareAndSet</span><span class="hljs-params">(<span class="hljs-keyword">int</span> expect, <span class="hljs-keyword">int</span> update)</span> <span class="hljs-comment">// å¦‚æœè¾“å…¥å€¼ï¼ˆupdateï¼‰ç­‰äºé¢„æœŸå€¼ï¼Œå°†è¯¥å€¼è®¾ç½®ä¸ºè¾“å…¥å€¼</span></span><span class="hljs-function"><span class="hljs-comment">// æœ€ç»ˆè®¾ç½®ä¸º newValueï¼Œä½¿ç”¨ lazySet è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lazySet</span><span class="hljs-params">(<span class="hljs-keyword">int</span> newValue)</span></span></code></pre><h1 id="å¼•ç”¨ç±»å‹"><a class="markdownIt-Anchor" href="#å¼•ç”¨ç±»å‹"></a> å¼•ç”¨ç±»å‹</h1><ul><li><p><code>AtomicReference</code> - å¼•ç”¨ç±»å‹åŸå­ç±»</p></li><li><p><code>AtomicMarkableReference</code> - å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹åŸå­ç±»</p></li><li><p><code>AtomicStampedReference</code> - å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹åŸå­ç±»</p></li></ul><blockquote><p><code>AtomicStampedReference</code> ç±»åœ¨å¼•ç”¨ç±»å‹åŸå­ç±»ä¸­ï¼Œå½»åº•åœ°è§£å†³äº† <code>ABA</code> é—®é¢˜ï¼Œå…¶å®ƒçš„ <code>CAS</code> èƒ½åŠ›ä¸å¦å¤–ä¸¤ä¸ªç±»ç›¸è¿‘ï¼Œæ‰€ä»¥æœ€å…·ä»£è¡¨æ€§ã€‚å› æ­¤ï¼Œæœ¬èŠ‚åªé’ˆå¯¹ <code>AtomicStampedReference</code> è¿›è¡Œè¯´æ˜ã€‚</p></blockquote><h2 id="atomicreference"><a class="markdownIt-Anchor" href="#atomicreference"></a> AtomicReference</h2><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * åŸºäº AtomicReference å®ç°è‡ªæ—‹é”</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : AtomicRefTest.java 2020/07/21 Tue 4:00 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicRefTest</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> ticket = <span class="hljs-number">10</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        SpinLock lock = <span class="hljs-keyword">new</span> SpinLock();        ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number">3</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;            executorService.execute(<span class="hljs-keyword">new</span> MyThread(lock));        &#125;        executorService.shutdown();    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * SpinLock</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpinLock</span> </span>&#123;        <span class="hljs-keyword">private</span> AtomicReference&lt;Thread&gt; atomicReference = <span class="hljs-keyword">new</span> AtomicReference&lt;&gt;();        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>&#123;            Thread current = Thread.currentThread();            <span class="hljs-comment">// è‡ªæ—‹ï¼Œä¸ºå½“å‰çº¿ç¨‹åŠ é”</span>            <span class="hljs-keyword">while</span> (!atomicReference.compareAndSet(<span class="hljs-keyword">null</span>, current)) &#123;            &#125;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;            Thread current = Thread.currentThread();            <span class="hljs-comment">// åªæœ‰å½“å‰çº¿ç¨‹æ‰é‡Šæ”¾é”</span>            atomicReference.compareAndSet(current, <span class="hljs-keyword">null</span>);        &#125;    &#125;    <span class="hljs-comment">/**</span><span class="hljs-comment">     * sell ticket by spin lock</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;        <span class="hljs-keyword">private</span> SpinLock lock;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyThread</span><span class="hljs-params">(SpinLock lock)</span> </span>&#123;            <span class="hljs-keyword">this</span>.lock = lock;        &#125;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">while</span> (ticket &gt; <span class="hljs-number">0</span>) &#123;                lock.lock();                <span class="hljs-keyword">if</span> (ticket &gt; <span class="hljs-number">0</span>) &#123;                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" sell ticket "</span> + ticket);                    ticket--;                &#125;                lock.unlock();            &#125;        &#125;            &#125;&#125;</code></pre><h2 id="atomicmarkablereference"><a class="markdownIt-Anchor" href="#atomicmarkablereference"></a> AtomicMarkableReference</h2><p>åŸå­ç±»çš„å®ç°åŸºäº <code>CAS</code> æœºåˆ¶ï¼Œè€Œ <code>CAS</code> å­˜åœ¨ <code>ABA</code> é—®é¢˜ã€‚æ­£æ˜¯ä¸ºäº†è§£å†³ <code>ABA</code> é—®é¢˜ï¼Œæ‰æœ‰äº† <code>AtomicMarkableReference</code> å’Œ <code>AtomicStampedReference</code>ã€‚</p><p><code>AtomicMarkableReference</code> ä½¿ç”¨ä¸€ä¸ªå¸ƒå°”å€¼ä½œä¸ºæ ‡è®°ï¼Œä¿®æ”¹æ—¶åœ¨ <code>true</code> / <code>false</code> ä¹‹é—´åˆ‡æ¢ã€‚è¿™ç§ç­–ç•¥ä¸èƒ½æ ¹æœ¬ä¸Šè§£å†³ <code>ABA</code> é—®é¢˜ï¼Œä½†æ˜¯å¯ä»¥é™ä½ <code>ABA</code> å‘ç”Ÿçš„å‡ ç‡ã€‚å¸¸ç”¨äºç¼“å­˜æˆ–è€…çŠ¶æ€æè¿°è¿™æ ·çš„åœºæ™¯ã€‚</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * AtomicMarkableReference ä½¿ç”¨</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : AtomicMarkableRefTest.java 2020/07/21 Tue 4:32 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicMarkableRefTest</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String INIT_TEXT = <span class="hljs-string">"abc"</span>;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;        <span class="hljs-keyword">final</span> AtomicMarkableReference&lt;String&gt; amr = <span class="hljs-keyword">new</span> AtomicMarkableReference&lt;&gt;(INIT_TEXT, <span class="hljs-keyword">false</span>);        ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number">3</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;            executorService.submit(() -&gt; &#123;                <span class="hljs-keyword">try</span> &#123;                    Thread.sleep(Math.abs((<span class="hljs-keyword">int</span>) Math.random() * <span class="hljs-number">100</span>));                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;                    e.printStackTrace();                &#125;                String name = Thread.currentThread().getName(); Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// è‹¥å˜é‡ä¸º INIT &amp;&amp; å·²è¢«æ ‡è®°ï¼Œåˆ™ä¿®æ”¹</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (amr.compareAndSet(INIT_TEXT, name, amr.isMarked(), !amr.isMarked())) &#123; Â  Â  Â  Â  Â  Â  Â  Â String name = Thread.currentThread().getName();                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" ä¿®æ”¹äº†å¯¹è±¡"</span>);                    System.out.println(<span class="hljs-string">"æ–°çš„å¯¹è±¡ä¸ºï¼š"</span> + amr.getReference());                &#125;            &#125;);        &#125;        executorService.shutdown();        executorService.awaitTermination(<span class="hljs-number">3</span>, TimeUnit.SECONDS);    &#125;&#125;</code></pre><h2 id="atomicstampedreference"><a class="markdownIt-Anchor" href="#atomicstampedreference"></a> AtomicStampedReference</h2><p><code>AtomicStampedReference</code> ä½¿ç”¨ä¸€ä¸ªæ•´å‹å€¼åšä¸ºç‰ˆæœ¬å·ï¼Œæ¯æ¬¡æ›´æ–°å‰å…ˆæ¯”è¾ƒç‰ˆæœ¬å·ï¼Œå¦‚æœä¸€è‡´ï¼Œæ‰è¿›è¡Œä¿®æ”¹ã€‚é€šè¿‡è¿™ç§ç­–ç•¥ï¼Œå¯ä»¥æ ¹æœ¬ä¸Šè§£å†³ <code>ABA</code> é—®é¢˜ã€‚</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * AtomicStampedReference ä½¿ç”¨</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : AtomicStampedRefTest.java 2020/07/21 Tue 7:02 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicStampedRefTest</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> String INIT_REF = <span class="hljs-string">"pool-1-thread-3"</span>;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> AtomicStampedReference&lt;String&gt; asr = <span class="hljs-keyword">new</span> AtomicStampedReference&lt;&gt;(INIT_REF, <span class="hljs-number">0</span>);    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;        System.out.println(<span class="hljs-string">"åˆå§‹å¯¹è±¡ä¸º: "</span> + asr.getReference());        ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number">3</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;            executorService.submit(() -&gt; &#123;                <span class="hljs-keyword">try</span> &#123;                    Thread.sleep(Math.abs((<span class="hljs-keyword">int</span>) Math.random() * <span class="hljs-number">100</span>));                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;                    e.printStackTrace();                &#125;                <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> stamp = asr.getStamp();                String name = Thread.currentThread().getName(); Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// è‹¥å˜é‡ä¸º INIT &amp;&amp; ç‰ˆæœ¬å·ä¸º stampï¼Œåˆ™ä¿®æ”¹</span>                <span class="hljs-keyword">if</span> (asr.compareAndSet(INIT_REF, name, stamp, stamp + <span class="hljs-number">1</span>)) &#123;                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" ä¿®æ”¹äº†å¯¹è±¡"</span>);                    System.out.println(<span class="hljs-string">"æ–°çš„å¯¹è±¡ä¸ºï¼š"</span> + asr.getReference());                &#125;            &#125;);        &#125;        executorService.shutdown();        executorService.awaitTermination(<span class="hljs-number">3</span>, TimeUnit.SECONDS);    &#125;&#125;</code></pre><h1 id="æ•°ç»„ç±»å‹"><a class="markdownIt-Anchor" href="#æ•°ç»„ç±»å‹"></a> æ•°ç»„ç±»å‹</h1><ul><li><p><code>AtomicIntegerArray</code> - æ•´å½¢æ•°ç»„åŸå­ç±»</p></li><li><p><code>AtomicLongArray</code> - é•¿æ•´å‹æ•°ç»„åŸå­ç±»</p></li><li><p><code>AtomicReferenceArray</code> - å¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±»</p></li></ul><p>æ•°ç»„ç±»å‹çš„åŸå­ç±»ä¸º <strong>æ•°ç»„å…ƒç´ </strong> æä¾›äº† <code>volatile</code> ç±»å‹çš„è®¿é—®è¯­ä¹‰ï¼Œè¿™æ˜¯æ™®é€šæ•°ç»„æ‰€ä¸å…·å¤‡çš„ç‰¹æ€§ â€”â€” <code>volatile</code> ç±»å‹çš„æ•°ç»„ä»…åœ¨<strong>æ•°ç»„å¼•ç”¨</strong>ä¸Šå…·æœ‰ <code>volatile</code> è¯­ä¹‰ã€‚</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * AtomicIntegerArray ä½¿ç”¨</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : AtomicIntegerArrayTest.java 2020/07/21 Tue 7:17 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicIntegerArrayTest</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AtomicIntegerArray atomicIntegerArray = <span class="hljs-keyword">new</span> AtomicIntegerArray(<span class="hljs-number">10</span>);    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;        System.out.println(<span class="hljs-string">"Init Values: "</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; atomicIntegerArray.length(); i++) &#123;            atomicIntegerArray.set(i, i);            System.out.print(atomicIntegerArray.get(i) + <span class="hljs-string">" "</span>);        &#125;        System.out.println();        Thread t1 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Increasement());        Thread t2 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Compare());        t1.start();        t2.start();        t1.join();        t2.join();        System.out.println(<span class="hljs-string">"Final Values: "</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; atomicIntegerArray.length(); i++) &#123;            System.out.print(atomicIntegerArray.get(i) + <span class="hljs-string">" "</span>);        &#125;        System.out.println();    &#125;    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Increasement</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123; Â  Â  Â   <span class="hljs-comment">// å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è‡ªå¢ 1</span> Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; atomicIntegerArray.length(); i++) &#123;                <span class="hljs-keyword">int</span> value = atomicIntegerArray.incrementAndGet(i);                System.out.println(Thread.currentThread().getName() + <span class="hljs-string">", index = "</span> + i + <span class="hljs-string">", value = "</span> + value);            &#125;        &#125;    &#125;    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Compare</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;        <span class="hljs-meta">@Override</span>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123; Â  Â  Â   <span class="hljs-comment">// æ‰¾åˆ°æ•°ç»„å€¼ä¸º 2 çš„å…ƒç´ ï¼Œä¿®æ”¹ä¸º 3</span> Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; atomicIntegerArray.length(); i++) &#123;                <span class="hljs-keyword">boolean</span> swapped = atomicIntegerArray.compareAndSet(i, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);                <span class="hljs-keyword">if</span> (swapped) &#123;                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" swapped, index = "</span> + i + <span class="hljs-string">", value = 3"</span>);                &#125;            &#125;        &#125;    &#125;&#125;</code></pre><h1 id="å±æ€§æ›´æ–°å™¨ç±»å‹"><a class="markdownIt-Anchor" href="#å±æ€§æ›´æ–°å™¨ç±»å‹"></a> å±æ€§æ›´æ–°å™¨ç±»å‹</h1><p>æ›´æ–°å™¨ç±»æ”¯æŒåŸºäº<strong>åå°„</strong>æœºåˆ¶çš„æ›´æ–°å­—æ®µå€¼çš„åŸå­æ“ä½œã€‚</p><ul><li><p><code>AtomicIntegerFieldUpdater</code> - æ•´å‹å­—æ®µçš„åŸå­æ›´æ–°å™¨ã€‚</p></li><li><p><code>AtomicLongFieldUpdater</code> - é•¿æ•´å‹å­—æ®µçš„åŸå­æ›´æ–°å™¨ã€‚</p></li><li><p><code>AtomicReferenceFieldUpdater</code> - åŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µã€‚</p></li></ul><p>è¿™äº›ç±»çš„ä½¿ç”¨æœ‰ä¸€å®šé™åˆ¶ï¼š</p><ul><li>å› ä¸ºå¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹åŸå­ç±»éƒ½æ˜¯æŠ½è±¡ç±»ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨éƒ½å¿…é¡»ä½¿ç”¨é™æ€æ–¹æ³• <code>newUpdater()</code> åˆ›å»ºä¸€ä¸ªæ›´æ–°å™¨ï¼Œå¹¶ä¸”éœ€è¦è®¾ç½®æƒ³è¦æ›´æ–°çš„ç±»å’Œå±æ€§ã€‚</li><li>å­—æ®µå¿…é¡»æ˜¯ <code>volatile</code> ç±»å‹çš„ï¼›</li><li>ä¸èƒ½ä½œç”¨äºé™æ€å˜é‡ï¼ˆ<code>static</code>ï¼‰ï¼›</li><li>ä¸èƒ½ä½œç”¨äºå¸¸é‡ï¼ˆ<code>final</code>ï¼‰ï¼›</li></ul><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * AtomicReferenceFieldUpdater ä½¿ç”¨</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> likailee.llk</span><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> : AtomicFieldUpdaterTest.java 2020/07/21 Tue 7:33 PM likai</span><span class="hljs-comment"> */</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AtomicFieldUpdaterTest</span> </span>&#123;    <span class="hljs-keyword">static</span> User user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">"begin"</span>);    <span class="hljs-keyword">static</span> AtomicReferenceFieldUpdater&lt;User, String&gt; updater =            AtomicReferenceFieldUpdater.newUpdater(User.class, String.class, "name");    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number">3</span>);        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;            executorService.submit(() -&gt; &#123; Â  Â  Â  Â  Â   <span class="hljs-comment">// è‹¥ name çš„å€¼ä¸º â€beginâ€œï¼Œåˆ™ä¿®æ”¹ä¸º â€œendâ€œ</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (updater.compareAndSet(user, <span class="hljs-string">"begin"</span>, <span class="hljs-string">"end"</span>)) &#123;                    <span class="hljs-keyword">try</span> &#123;                        TimeUnit.SECONDS.sleep(<span class="hljs-number">1</span>);                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;                        e.printStackTrace();                    &#125;                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" å·²ä¿®æ”¹ name = "</span> + user.getName());                &#125; <span class="hljs-keyword">else</span> &#123;                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">"å·²è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹"</span>);                &#125;            &#125;);        &#125;        executorService.shutdown();    &#125;    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;        <span class="hljs-keyword">volatile</span> String name;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(String name)</span> </span>&#123;            <span class="hljs-keyword">this</span>.name = name;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">return</span> name;        &#125;        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;            <span class="hljs-keyword">this</span>.name = name;        &#125;    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å¹¶å‘-é”åŸç†</title>
    <link href="/2020/07/17/concurrent-lock/"/>
    <url>/2020/07/17/concurrent-lock/</url>
    
    <content type="html"><![CDATA[<h1 id="å¹¶å‘é”"><a class="markdownIt-Anchor" href="#å¹¶å‘é”"></a> å¹¶å‘é”</h1><h2 id="ä¹è§‚é”å’Œæ‚²è§‚é”"><a class="markdownIt-Anchor" href="#ä¹è§‚é”å’Œæ‚²è§‚é”"></a> ä¹è§‚é”å’Œæ‚²è§‚é”</h2><p>ä¹è§‚é”å’Œæ‚²è§‚é”æ˜¯ä¸¤ç§æ€æƒ³ï¼Œç”¨äºè§£å†³å¹¶å‘åœºæ™¯ä¸‹çš„æ•°æ®ç«äº‰é—®é¢˜ã€‚</p><h3 id="ä¹è§‚é”"><a class="markdownIt-Anchor" href="#ä¹è§‚é”"></a> ä¹è§‚é”</h3><p>ä¹è§‚é”åœ¨æ“ä½œæ•°æ®æ—¶éå¸¸ä¹è§‚ï¼Œè®¤ä¸ºåˆ«äººä¸ä¼šåŒæ—¶ä¿®æ”¹æ•°æ®ã€‚å› æ­¤<strong>ä¹è§‚é”ä¸ä¼šä¸Šé”</strong>ï¼Œåªæ˜¯åœ¨æ‰§è¡Œæ›´æ–°çš„æ—¶å€™åˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæ˜¯å¦ä¿®æ”¹äº†æ•°æ®ï¼šå¦‚æœåˆ«äººä¿®æ”¹äº†æ•°æ®åˆ™æ”¾å¼ƒæ“ä½œï¼Œå¦åˆ™æ‰§è¡Œæ“ä½œã€‚</p><h4 id="å®ç°æ–¹å¼"><a class="markdownIt-Anchor" href="#å®ç°æ–¹å¼"></a> å®ç°æ–¹å¼</h4><ol><li><code>CAS</code> æœºåˆ¶</li></ol><p><code>CAS</code> æ“ä½œåŒ…æ‹¬äº† 3 ä¸ªæ“ä½œæ•°ï¼š<br />(1) éœ€è¦è¯»å†™çš„å†…å­˜ä½ç½®(<code>V</code>)<br />(2) è¿›è¡Œæ¯”è¾ƒçš„é¢„æœŸå€¼(<code>A</code>)<br />(3) æ‹Ÿå†™å…¥çš„æ–°å€¼(<code>B</code>)</p><p><code>CAS</code> æ“ä½œé€»è¾‘å¦‚ä¸‹ï¼šå¦‚æœå†…å­˜ä½ç½® <code>V</code> çš„å€¼ç­‰äºé¢„æœŸçš„ <code>A</code> å€¼ï¼Œåˆ™å°†è¯¥ä½ç½®æ›´æ–°ä¸ºæ–°å€¼ <code>B</code>ï¼Œå¦åˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚è®¸å¤š <code>CAS</code> çš„æ“ä½œæ˜¯è‡ªæ—‹çš„ï¼šå¦‚æœæ“ä½œä¸æˆåŠŸï¼Œä¼šä¸€ç›´é‡è¯•ï¼Œç›´åˆ°æ“ä½œæˆåŠŸä¸ºæ­¢ã€‚</p><blockquote><p><code>CAS</code> æ˜¯ç”± <code>CPU</code> æ”¯æŒçš„åŸå­æ“ä½œï¼Œå…¶åŸå­æ€§æ˜¯åœ¨ç¡¬ä»¶å±‚é¢è¿›è¡Œä¿è¯çš„ã€‚</p></blockquote><ol start="2"><li>ç‰ˆæœ¬å·æœºåˆ¶<br />ç‰ˆæœ¬å·æœºåˆ¶çš„åŸºæœ¬æ€è·¯æ˜¯åœ¨æ•°æ®ä¸­å¢åŠ ä¸€ä¸ªå­—æ®µ <code>version</code>ï¼Œè¡¨ç¤ºè¯¥æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œæ¯å½“æ•°æ®è¢«ä¿®æ”¹ï¼Œç‰ˆæœ¬å· <code>+1</code>ã€‚</li></ol><ul><li>å½“æŸä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®æ—¶ï¼Œå°†è¯¥æ•°æ®çš„ç‰ˆæœ¬å·ä¸€èµ·æŸ¥å‡ºæ¥ï¼›</li><li>å½“è¯¥çº¿ç¨‹æ›´æ–°æ•°æ®æ—¶ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬å·ä¸ä¹‹å‰è¯»å–çš„ç‰ˆæœ¬å·æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´æ‰è¿›è¡Œæ“ä½œã€‚</li></ul><h3 id="æ‚²è§‚é”"><a class="markdownIt-Anchor" href="#æ‚²è§‚é”"></a> æ‚²è§‚é”</h3><p>æ‚²è§‚é”åœ¨æ“ä½œæ•°æ®æ—¶æ¯”è¾ƒæ‚²è§‚ï¼Œè®¤ä¸ºåˆ«äººä¼šåŒæ—¶ä¿®æ”¹æ•°æ®ã€‚å› æ­¤æ“ä½œæ•°æ®æ—¶ç›´æ¥æŠŠæ•°æ®é”ä½ï¼Œç›´åˆ°æ“ä½œå®Œæˆåæ‰ä¼šé‡Šæ”¾é”ï¼›ä¸Šé”æœŸé—´å…¶ä»–äººä¸èƒ½ä¿®æ”¹æ•°æ®ã€‚</p><h4 id="å®ç°æ–¹å¼-2"><a class="markdownIt-Anchor" href="#å®ç°æ–¹å¼-2"></a> å®ç°æ–¹å¼</h4><p>æ‚²è§‚é”çš„å®ç°æ–¹å¼æ˜¯<strong>åŠ é”</strong>ï¼ŒåŠ é”æ—¢å¯ä»¥æ˜¯å¯¹<strong>ä»£ç å—åŠ é”</strong>ï¼ˆå¦‚ <code>Java</code>çš„ <code>synchronized</code> å…³é”®å­—å’Œ <code>Lock</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹<strong>æ•°æ®åŠ é”</strong>ï¼ˆå¦‚ <code>MySQL</code> ä¸­çš„æ’å®ƒé”ï¼‰ã€‚</p><h2 id="å…¬å¹³é”ä¸éå…¬å¹³é”"><a class="markdownIt-Anchor" href="#å…¬å¹³é”ä¸éå…¬å¹³é”"></a> å…¬å¹³é”ä¸éå…¬å¹³é”</h2><p>æ ¹æ®çº¿ç¨‹è·å–é”çš„æŠ¢å æœºåˆ¶ï¼Œé”å¯åˆ†ä¸ºå…¬å¹³é”ä¸éå…¬å¹³é”ã€‚</p><ul><li>å…¬å¹³é”è¡¨ç¤ºçº¿ç¨‹è·å–é”çš„é¡ºåºæ˜¯æŒ‰ç…§çº¿ç¨‹è¯·æ±‚é”çš„æ—¶é—´æ—©æ™šæ¥å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯æœ€æ—©è¯·æ±‚é”çš„çº¿ç¨‹å°†æœ€æ—©è·å–åˆ°é”ã€‚</li><li>éå…¬å¹³é”åœ¨è¿è¡Œæ—¶é—¯å…¥ï¼Œä¹Ÿå°±æ˜¯å…ˆæ¥ä¸ä¸€å®šå…ˆå¾—ï¼Œå¦‚ <code>synchronized</code>ã€‚</li><li><code>ReentrantLock</code>ã€<code>ReentrantReadWriteLock</code>ï¼Œé»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œä½†æ”¯æŒå…¬å¹³é”ã€‚</li><li>åœ¨æ²¡æœ‰å…¬å¹³æ€§éœ€æ±‚çš„æƒ…å†µä¸‹å°½é‡ä½¿ç”¨éå…¬å¹³é”ï¼Œå› ä¸ºå…¬å¹³é”ä¼šå¸¦æ¥æ€§èƒ½å¼€é”€ã€‚</li></ul><h2 id="ç‹¬å é”ä¸å…±äº«é”"><a class="markdownIt-Anchor" href="#ç‹¬å é”ä¸å…±äº«é”"></a> ç‹¬å é”ä¸å…±äº«é”</h2><p>æ ¹æ®é”åªèƒ½è¢«å•ä¸ªçº¿ç¨‹æŒæœ‰è¿˜æ˜¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹å…±åŒæŒæœ‰ï¼Œé”å¯åˆ†ä¸ºç‹¬å é”ä¸å…±äº«é”ã€‚</p><ul><li>ç‹¬å é”æ˜¯ä¸€ç§æ‚²è§‚é”ï¼Œæ¯æ¬¡è®¿é—®èµ„æºéƒ½åŠ ä¸Šäº†äº’æ–¥é”ï¼Œåœ¨åŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¯»å–æ•°æ®ã€‚</li><li>å…±äº«é”æ˜¯ä¸€ç§ä¹è§‚é”ï¼Œå®ƒæ”¾å®½äº†åŠ é”çš„æ¡ä»¶ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œè¯»æ“ä½œã€‚</li></ul><h2 id="å¯é‡å…¥é”"><a class="markdownIt-Anchor" href="#å¯é‡å…¥é”"></a> å¯é‡å…¥é”</h2><p>å½“ä¸€ä¸ªçº¿ç¨‹å†æ¬¡è·å–å®ƒå·²ç»è·å–çš„çæ—¶ï¼Œå¦‚æœä¸è¢«é˜»å¡ï¼Œé‚£ä¹ˆè¯¥é”æ˜¯å¯è¢«é‡å…¥çš„ã€‚</p><p><code>synchronized</code> å†…éƒ¨é”æ˜¯å¯é‡å…¥é”ï¼Œåœ¨å…¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ ‡ç¤ºï¼Œç”¨æ¥æ ‡ç¤ºè¯¥é”ç›®å‰è¢«å“ªä¸ªçº¿ç¨‹å ç”¨ï¼Œç„¶åå…³è”ä¸€ä¸ªè®¡æ•°å™¨ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è·å–äº†è¯¥é”æ—¶ï¼Œè®¡æ•°å™¨çš„å€¼ä¼šå˜æˆ <code>1</code>ï¼Œè¿™æ—¶å…¶ä»–çº¿ç¨‹å†æ¥è·å–è¯¥é”æ—¶ä¼šå‘ç°é”çš„æ‰€æœ‰è€…ä¸æ˜¯è‡ªå·±è€Œè¢«é˜»å¡æŒ‚èµ·ã€‚</p><p>ä½†æ˜¯å½“è·å–äº†è¯¥é”çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶å‘ç°é”æ‹¥æœ‰è€…æ˜¯è‡ªå·±ï¼Œå°±ä¼šæŠŠè®¡æ•°å™¨å€¼ <code>+1</code>ï¼Œå½“é‡Šæ”¾é”åå€¼ <code>-1</code>ã€‚å½“è®¡æ•°å™¨å€¼ä¸º <code>0</code>ï¼Œçº¿ç¨‹æ ‡ç¤ºè¢«é‡ç½®ä¸º <code>null</code>ï¼Œè¿™æ—¶å€™è¢«é˜»å¡çš„çº¿ç¨‹ä¼šè¢«å”¤é†’æ¥ç«äº‰è¯¥é”ã€‚</p><h2 id="è‡ªæ—‹é”"><a class="markdownIt-Anchor" href="#è‡ªæ—‹é”"></a> è‡ªæ—‹é”</h2><p>å½“å‰çº¿ç¨‹åœ¨è·å–é”æ—¶ï¼Œå¦‚æœå‘ç°é”å·²è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œå®ƒä¸é©¬ä¸Šé˜»å¡è‡ªå·±ï¼Œåœ¨ä¸æ”¾å¼ƒ <code>CPU</code> ä½¿ç”¨æƒçš„æƒ…å†µä¸‹ï¼Œå¤šæ¬¡å°è¯•è·å–ï¼ˆé»˜è®¤10æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>-XX:PreBlockSpinsh</code> å‚æ•°è®¾ç½®è¯¥å€¼ï¼‰ï¼Œå¾ˆæœ‰å¯èƒ½åœ¨åé¢å‡ æ¬¡å°è¯•ä¸­å…¶ä»–çº¿ç¨‹å·²ç»é‡Šæ”¾äº†é”ã€‚å¦‚æœå°è¯•æŒ‡å®šæ¬¡æ•°åä»æ²¡æœ‰è·å–åˆ°é”åˆ™å½“å‰çº¿ç¨‹æ‰ä¼šè¢«é˜»å¡æŒ‚èµ·ã€‚<br />è‡ªæ—‹é”æ˜¯ä½¿ç”¨ <code>CPU</code> æ—¶é—´æ¢å–çº¿ç¨‹é˜»å¡ä¸è°ƒåº¦çš„å¼€é”€ï¼Œä½†æ˜¯å¾ˆæœ‰å¯èƒ½è¿™äº› <code>CPU</code> æ—¶é—´ç™½ç™½æµªè´¹äº†ã€‚</p><h1 id="æ­»é”"><a class="markdownIt-Anchor" href="#æ­»é”"></a> æ­»é”</h1><h2 id="å®šä¹‰"><a class="markdownIt-Anchor" href="#å®šä¹‰"></a> å®šä¹‰</h2><p>æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ç›¸äº’ç­‰å¾…çš„ç°è±¡ï¼Œåœ¨æ— å¤–åŠ›ä½œç”¨çš„æƒ…å†µä¸‹ï¼Œè¿™äº›çº¿ç¨‹ä¼šä¸€ç›´ç›¸äº’ç­‰å¾…è€Œæ— æ³•ç»§ç»­è¿è¡Œä¸‹å»</p><h2 id="åŸºæœ¬æ¡ä»¶"><a class="markdownIt-Anchor" href="#åŸºæœ¬æ¡ä»¶"></a> åŸºæœ¬æ¡ä»¶</h2><ol><li>äº’æ–¥</li><li>è¯·æ±‚å¹¶æŒæœ‰</li><li>ä¸å¯å‰¥å¤º</li><li>ç¯è·¯ç­‰å¾…</li></ol><h2 id="é¿å…æ­»é”"><a class="markdownIt-Anchor" href="#é¿å…æ­»é”"></a> é¿å…æ­»é”</h2><blockquote><p>ä½¿ç”¨ç”³è¯·èµ„æºçš„æœ‰åºæ€§ï¼Œç ´åè¯·æ±‚å¹¶æŒæœ‰å’Œç¯è·¯ç­‰å¾…æ¡ä»¶ã€‚</p></blockquote><ul><li><p>é¿å…ä¸€ä¸ªçº¿ç¨‹åŒæ—¶è·å–å¤šä¸ªé”ã€‚</p></li><li><p>é¿å…ä¸€ä¸ªçº¿ç¨‹åœ¨é”å†…åŒæ—¶å ç”¨å¤šä¸ªèµ„æºï¼Œå°½é‡ä¿è¯æ¯ä¸ªé”åªå ç”¨ä¸€ä¸ªèµ„æºã€‚</p></li><li><p>å°è¯•ä½¿ç”¨å®šæ—¶é” <code>lock.tryLock(timeout)</code>ï¼Œé¿å…é”ä¸€ç›´ä¸èƒ½é‡Šæ”¾ã€‚</p></li><li><p>å¯¹äºæ•°æ®åº“é”ï¼ŒåŠ é”å’Œè§£é”å¿…é¡»åœ¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ä¸­é‡Œï¼Œå¦åˆ™ä¼šå‡ºç°è§£é”å¤±è´¥çš„æƒ…å†µã€‚</p></li></ul><h1 id="aqs"><a class="markdownIt-Anchor" href="#aqs"></a> AQS</h1><blockquote><p><code>AbstractQueuedSynchronizer</code>ï¼ˆç®€ç§° <code>AQS</code>ï¼‰æ˜¯é˜Ÿåˆ—åŒæ­¥å™¨ï¼Œé¡¾åæ€ä¹‰ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯å¤„ç†åŒæ­¥ã€‚å®ƒæ˜¯å¹¶å‘é”å’Œå¾ˆå¤šåŒæ­¥å·¥å…·ç±»çš„å®ç°åŸºçŸ³ï¼ˆå¦‚ <code>ReentrantLock</code>ã€<code>ReentrantReadWriteLock</code>ã€<code>Semaphore</code> ç­‰ï¼‰ã€‚</p><p>å› æ­¤ï¼Œè¦æƒ³æ·±å…¥ç†è§£ <code>ReentrantLock</code>ã€<code>ReentrantReadWriteLock</code> ç­‰å¹¶å‘é”å’ŒåŒæ­¥å·¥å…·ï¼Œå¿…é¡»å…ˆç†è§£ <code>AQS</code> çš„è¦ç‚¹å’ŒåŸç†ã€‚</p></blockquote><h2 id="aqs-çš„è¦ç‚¹"><a class="markdownIt-Anchor" href="#aqs-çš„è¦ç‚¹"></a> <code>AQS</code> çš„è¦ç‚¹</h2><p>åœ¨ <code>java.util.concurrent.locks</code> åŒ…ä¸­çš„ç›¸å…³é”(å¸¸ç”¨çš„æœ‰ <code>ReentrantLock</code>ã€ <code>ReadWriteLock</code>)éƒ½æ˜¯åŸºäº <code>AQS</code> æ¥å®ç°ã€‚è¿™äº›é”éƒ½æ²¡æœ‰ç›´æ¥ç»§æ‰¿ <code>AQS</code>ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸€ä¸ª <code>Sync</code> ç±»å»ç»§æ‰¿ <code>AQS</code>ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢ï¼Ÿå› ä¸ºé”é¢å‘çš„æ˜¯ä½¿ç”¨ç”¨æˆ·ï¼Œè€ŒåŒæ­¥å™¨é¢å‘çš„åˆ™æ˜¯çº¿ç¨‹æ§åˆ¶ï¼Œé‚£ä¹ˆåœ¨é”çš„å®ç°ä¸­èšåˆåŒæ­¥å™¨è€Œä¸æ˜¯ç›´æ¥ç»§æ‰¿ <code>AQS</code> å°±å¯ä»¥å¾ˆå¥½çš„éš”ç¦»äºŒè€…æ‰€å…³æ³¨çš„äº‹æƒ…ã€‚</p><p><strong><code>AQS</code> æä¾›äº†å¯¹ç‹¬äº«é”ä¸å…±äº«é”çš„æ”¯æŒã€‚</strong></p><h3 id="ç‹¬äº«é”-api"><a class="markdownIt-Anchor" href="#ç‹¬äº«é”-api"></a> ç‹¬äº«é” <code>API</code></h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquire</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquireInterruptibly</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryAcquireNanos</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg, <span class="hljs-keyword">long</span> nanosTimeout)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">release</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span></code></pre><ul><li><code>acquire</code> - è·å–ç‹¬å é”ã€‚</li><li><code>acquireInterruptibly</code> - è·å–å¯ä¸­æ–­çš„ç‹¬å é”ã€‚</li><li><code>tryAcquireNanos</code> - å°è¯•åœ¨æŒ‡å®šæ—¶é—´å†…è·å–å¯ä¸­æ–­çš„ç‹¬å é”ã€‚åœ¨ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸‹å›è¿”å›ï¼š<ul><li>åœ¨è¶…æ—¶æ—¶é—´å†…ï¼Œå½“å‰çº¿ç¨‹æˆåŠŸè·å–äº†é”ï¼›</li><li>å½“å‰çº¿ç¨‹åœ¨è¶…æ—¶æ—¶é—´å†…è¢«ä¸­æ–­ï¼›</li><li>è¶…æ—¶æ—¶é—´ç»“æŸï¼Œä»æœªè·å¾—é”è¿”å› falseã€‚</li></ul></li><li><code>release</code> - é‡Šæ”¾ç‹¬å é”ã€‚</li></ul><h3 id="å…±äº«é”-api"><a class="markdownIt-Anchor" href="#å…±äº«é”-api"></a> å…±äº«é” <code>API</code></h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquireShared</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquireSharedInterruptibly</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryAcquireSharedNanos</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg, <span class="hljs-keyword">long</span> nanosTimeout)</span></span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">releaseShared</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span></span></code></pre><ul><li><code>acquireShared</code> - è·å–å…±äº«é”ã€‚</li><li><code>acquireSharedInterruptibly</code> - è·å–å¯ä¸­æ–­çš„å…±äº«é”ã€‚</li><li><code>tryAcquireSharedNanos</code> - å°è¯•åœ¨æŒ‡å®šæ—¶é—´å†…è·å–å¯ä¸­æ–­çš„å…±äº«é”ã€‚</li><li><code>release</code> - é‡Šæ”¾å…±äº«é”ã€‚</li></ul><h2 id="aqs-çš„åŸç†"><a class="markdownIt-Anchor" href="#aqs-çš„åŸç†"></a> <code>AQS</code> çš„åŸç†</h2><h3 id="aqs-çš„æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#aqs-çš„æ•°æ®ç»“æ„"></a> <code>AQS</code> çš„æ•°æ®ç»“æ„</h3><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractQueuedSynchronizer</span></span><span class="hljs-class">    <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractOwnableSynchronizer</span></span><span class="hljs-class">    <span class="hljs-keyword">implements</span> <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-comment">/** ç­‰å¾…é˜Ÿåˆ—çš„é˜Ÿå¤´ï¼Œæ‡’åŠ è½½ã€‚åªèƒ½é€šè¿‡ setHead æ–¹æ³•ä¿®æ”¹ã€‚ */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;    <span class="hljs-comment">/** ç­‰å¾…é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œæ‡’åŠ è½½ã€‚åªèƒ½é€šè¿‡ enq æ–¹æ³•æ·»åŠ æ–°çš„ç­‰å¾…èŠ‚ç‚¹ã€‚*/</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;    <span class="hljs-comment">/** åŒæ­¥çŠ¶æ€ */</span>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> state;&#125;</code></pre><ul><li><p><code>state</code> - <code>AQS</code> ä½¿ç”¨ä¸€ä¸ªæ•´å‹çš„ <code>volatile</code> å˜é‡æ¥ ç»´æŠ¤åŒæ­¥çŠ¶æ€ã€‚</p><ul><li>è¿™ä¸ªæ•´æ•°çŠ¶æ€çš„æ„ä¹‰ç”±å­ç±»æ¥èµ‹äºˆï¼Œå¦‚ <code>ReentrantLock</code> ä¸­è¯¥çŠ¶æ€å€¼è¡¨ç¤ºæ‰€æœ‰è€…çº¿ç¨‹å·²ç»é‡å¤è·å–è¯¥é”çš„æ¬¡æ•°ï¼Œ<code>Semaphore</code> ä¸­è¯¥çŠ¶æ€å€¼è¡¨ç¤ºå‰©ä½™çš„è®¸å¯æ•°é‡ã€‚</li></ul></li><li><p><code>head</code> å’Œ <code>tail</code> - <code>AQS</code> ç»´æŠ¤äº†ä¸€ä¸ª <code>Node</code> ç±»å‹ï¼ˆ<code>AQS</code> çš„å†…éƒ¨ç±»ï¼‰çš„åŒé“¾è¡¨æ¥å®ŒæˆåŒæ­¥çŠ¶æ€çš„ç®¡ç†ã€‚è¿™ä¸ªåŒé“¾è¡¨æ˜¯ä¸€ä¸ªåŒå‘çš„ <code>FIFO</code> é˜Ÿåˆ—ï¼Œé€šè¿‡ <code>head</code> å’Œ <code>tail</code> æŒ‡é’ˆè¿›è¡Œè®¿é—®ã€‚å½“æœ‰çº¿ç¨‹è·å–é”å¤±è´¥åï¼Œå°±è¢«æ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200718161601.png" srcset="/img/loading.gif" alt="AQSç»“æ„" /></p><p><code>Node</code> çš„æºç </p><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;    <span class="hljs-comment">/** è¯¥ç­‰å¾…åŒæ­¥çš„èŠ‚ç‚¹å¤„äºå…±äº«æ¨¡å¼ */</span>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Node SHARED = <span class="hljs-keyword">new</span> Node();    <span class="hljs-comment">/** è¯¥ç­‰å¾…åŒæ­¥çš„èŠ‚ç‚¹å¤„äºç‹¬å æ¨¡å¼ */</span>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Node EXCLUSIVE = <span class="hljs-keyword">null</span>;    <span class="hljs-comment">/** çº¿ç¨‹ç­‰å¾…çŠ¶æ€ï¼ŒçŠ¶æ€å€¼æœ‰: 0ã€1ã€-1ã€-2ã€-3 */</span>    <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> waitStatus;    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CANCELLED =  <span class="hljs-number">1</span>;    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> SIGNAL    = -<span class="hljs-number">1</span>;    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CONDITION = -<span class="hljs-number">2</span>;    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> PROPAGATE = -<span class="hljs-number">3</span>;    <span class="hljs-comment">/** å‰é©±èŠ‚ç‚¹ */</span>    <span class="hljs-keyword">volatile</span> Node prev;    <span class="hljs-comment">/** åç»§èŠ‚ç‚¹ */</span>    <span class="hljs-keyword">volatile</span> Node next;    <span class="hljs-comment">/** ç­‰å¾…é”çš„çº¿ç¨‹ */</span>    <span class="hljs-keyword">volatile</span> Thread thread;        <span class="hljs-comment">/** å’ŒèŠ‚ç‚¹æ˜¯å¦å…±äº«æœ‰å…³ */</span>    Node nextWaiter;&#125;</code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œ<code>Node</code> æ˜¯ä¸€ä¸ªåŒé“¾è¡¨ç»“æ„ã€‚</p><p><code>waitStatus</code> - <code>Node</code> ä½¿ç”¨ä¸€ä¸ªæ•´å‹çš„ <code>volatile</code> å˜é‡æ¥ ç»´æŠ¤ <code>AQS</code> åŒæ­¥é˜Ÿåˆ—ä¸­çº¿ç¨‹èŠ‚ç‚¹çš„çŠ¶æ€ã€‚<code>waitStatus</code> æœ‰äº”ä¸ªçŠ¶æ€å€¼ï¼š</p><ul><li><p><code>CANCELLED(1)</code> - æ­¤çŠ¶æ€è¡¨ç¤ºï¼šè¯¥èŠ‚ç‚¹çš„çº¿ç¨‹å¯èƒ½ç”±äºè¶…æ—¶æˆ–è¢«ä¸­æ–­è€Œ <strong>å¤„äºè¢«å–æ¶ˆ(ä½œåºŸ)çŠ¶æ€</strong>ï¼Œä¸€æ—¦å¤„äºè¿™ä¸ªçŠ¶æ€ï¼Œè¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹åº”è¯¥ä»ç­‰å¾…é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚</p></li><li><p><code>SIGNAL(-1)</code> - æ­¤çŠ¶æ€è¡¨ç¤ºï¼šåç»§èŠ‚ç‚¹ä¼šè¢«æŒ‚èµ·ï¼Œå› æ­¤åœ¨å½“å‰èŠ‚ç‚¹é‡Šæ”¾é”æˆ–è¢«å–æ¶ˆä¹‹åï¼Œå¿…é¡»å”¤é†’(<code>unparking</code>)å…¶åç»§ç»“ç‚¹ã€‚</p></li><li><p><code>CONDITION(-2)</code> - æ­¤çŠ¶æ€è¡¨ç¤ºï¼šè¯¥èŠ‚ç‚¹çš„çº¿ç¨‹ å¤„äºç­‰å¾…æ¡ä»¶çŠ¶æ€ï¼Œä¸ä¼šè¢«å½“ä½œæ˜¯åŒæ­¥é˜Ÿåˆ—ä¸Šçš„èŠ‚ç‚¹ï¼Œç›´åˆ°è¢«å”¤é†’(<code>signal</code>)ï¼Œè®¾ç½®å…¶å€¼ä¸º 0ï¼Œå†é‡æ–°è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p></li><li><p><code>PROPAGATE(-3)</code> - æ­¤çŠ¶æ€è¡¨ç¤ºï¼šä¸‹ä¸€ä¸ª <code>acquireShared</code> åº”æ— æ¡ä»¶ä¼ æ’­ã€‚</p></li><li><p><code>0</code> - éä»¥ä¸ŠçŠ¶æ€ã€‚</p></li></ul><h3 id="ç‹¬å é”çš„è·å–å’Œé‡Šæ”¾"><a class="markdownIt-Anchor" href="#ç‹¬å é”çš„è·å–å’Œé‡Šæ”¾"></a> ç‹¬å é”çš„è·å–å’Œé‡Šæ”¾</h3><h4 id="è·å–ç‹¬å é”"><a class="markdownIt-Anchor" href="#è·å–ç‹¬å é”"></a> è·å–ç‹¬å é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>acquire(int arg)</code> æ–¹æ³•è·å–ç‹¬å é”ï¼Œå…¶å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å…ˆå°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœè·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œåˆ™ç»“æŸæ–¹æ³•ï¼Œç›´æ¥è¿”å›ã€‚</p></li><li><p>å¦‚æœè·å–åŒæ­¥çŠ¶æ€ä¸æˆåŠŸï¼Œ<code>AQS</code> ä¼šä¸æ–­å°è¯•åˆ©ç”¨ <code>CAS</code> æ“ä½œå°†å½“å‰çº¿ç¨‹æ’å…¥ç­‰å¾…åŒæ­¥é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚</p></li><li><p>æ¥ç€ï¼Œä¸æ–­å°è¯•ä¸ºç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹èŠ‚ç‚¹è·å–ç‹¬å é”ã€‚<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200718161748.png" srcset="/img/loading.gif" alt="è·å–é”å‰" /><br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200718162338.png" srcset="/img/loading.gif" alt="è·å–é”" /><br />è¯¦ç»†æµç¨‹å¯ä»¥ç”¨ä¸‹å›¾æ¥è¡¨ç¤ºï¼Œè¯·ç»“åˆæºç æ¥ç†è§£ï¼ˆä¸€å›¾èƒœåƒè¨€ï¼‰ï¼š<br /><img src="https://raw.githubusercontent.com/LikaiLee/likailee.github.io/img/20200718162114.png" srcset="/img/loading.gif" alt="AQSè·å–é”å·¥ä½œæµç¨‹" /></p></li></ol><h4 id="é‡Šæ”¾ç‹¬å é”"><a class="markdownIt-Anchor" href="#é‡Šæ”¾ç‹¬å é”"></a> é‡Šæ”¾ç‹¬å é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>release(int arg)</code> æ–¹æ³•é‡Šæ”¾ç‹¬å é”ï¼Œå…¶å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å…ˆå°è¯•è·å–è§£é”çº¿ç¨‹çš„åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœè·å–åŒæ­¥çŠ¶æ€ä¸æˆåŠŸï¼Œåˆ™ç»“æŸæ–¹æ³•ï¼Œç›´æ¥è¿”å›ã€‚</p></li><li><p>å¦‚æœè·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œ<code>AQS</code> ä¼šå°è¯•å”¤é†’å½“å‰çº¿ç¨‹èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ã€‚</p></li></ol><h4 id="è·å–å¯ä¸­æ–­çš„ç‹¬å é”"><a class="markdownIt-Anchor" href="#è·å–å¯ä¸­æ–­çš„ç‹¬å é”"></a> è·å–å¯ä¸­æ–­çš„ç‹¬å é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>acquireInterruptibly(int arg)</code> æ–¹æ³•è·å–å¯ä¸­æ–­çš„ç‹¬å é”ã€‚</p><p><code>acquireInterruptibly(int arg)</code> å®ç°æ–¹å¼ç›¸è¾ƒäºè·å–ç‹¬å é”æ–¹æ³•ï¼ˆ<code>acquire</code>ï¼‰éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«ä»…åœ¨äºå®ƒä¼šé€šè¿‡ <code>Thread.interrupted</code> æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç«‹å³æŠ›å‡ºä¸­æ–­å¼‚å¸¸ï¼ˆ<code>InterruptedException</code>ï¼‰ã€‚</p><h4 id="è·å–è¶…æ—¶ç­‰å¾…å¼çš„ç‹¬å é”"><a class="markdownIt-Anchor" href="#è·å–è¶…æ—¶ç­‰å¾…å¼çš„ç‹¬å é”"></a> è·å–è¶…æ—¶ç­‰å¾…å¼çš„ç‹¬å é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>tryAcquireNanos(int arg)</code> æ–¹æ³•è·å–è¶…æ—¶ç­‰å¾…çš„ç‹¬å é”ã€‚</p><p><code>doAcquireNanos</code> çš„å®ç°æ–¹å¼ ç›¸è¾ƒäºè·å–ç‹¬å é”æ–¹æ³•ï¼ˆ <code>acquire</code>ï¼‰éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå®ƒä¼šæ ¹æ®è¶…æ—¶æ—¶é—´å’Œå½“å‰æ—¶é—´è®¡ç®—å‡ºæˆªæ­¢æ—¶é—´ã€‚åœ¨è·å–é”çš„æµç¨‹ä¸­ï¼Œä¼šä¸æ–­åˆ¤æ–­æ˜¯å¦è¶…æ—¶ï¼Œå¦‚æœè¶…æ—¶ï¼Œç›´æ¥è¿”å› <code>false</code>ï¼›å¦‚æœæ²¡è¶…æ—¶ï¼Œåˆ™ç”¨ <code>LockSupport.parkNanos</code> æ¥é˜»å¡å½“å‰çº¿ç¨‹ã€‚</p><h3 id="å…±äº«é”çš„è·å–å’Œé‡Šæ”¾"><a class="markdownIt-Anchor" href="#å…±äº«é”çš„è·å–å’Œé‡Šæ”¾"></a> å…±äº«é”çš„è·å–å’Œé‡Šæ”¾</h3><h4 id="è·å–å…±äº«é”"><a class="markdownIt-Anchor" href="#è·å–å…±äº«é”"></a> è·å–å…±äº«é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>acquireShared(int arg)</code> æ–¹æ³•è·å–å…±äº«é”ã€‚</p><p><code>acquireShared</code> æ–¹æ³•å’Œ <code>acquire</code> æ–¹æ³•çš„é€»è¾‘å¾ˆç›¸ä¼¼ï¼ŒåŒºåˆ«ä»…åœ¨äºè‡ªæ—‹çš„æ¡ä»¶ä»¥åŠèŠ‚ç‚¹å‡ºé˜Ÿçš„æ“ä½œæœ‰æ‰€ä¸åŒã€‚</p><p>æˆåŠŸè·å¾—å…±äº«é”çš„æ¡ä»¶å¦‚ä¸‹ï¼š</p><ul><li><p><code>tryAcquireShared(arg)</code> è¿”å›å€¼å¤§äºç­‰äº <code>0</code> ï¼ˆè¿™æ„å‘³ç€å…±äº«é”çš„ permit è¿˜æ²¡æœ‰ç”¨å®Œï¼‰ã€‚</p></li><li><p>å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ã€‚</p></li></ul><h4 id="é‡Šæ”¾å…±äº«é”"><a class="markdownIt-Anchor" href="#é‡Šæ”¾å…±äº«é”"></a> é‡Šæ”¾å…±äº«é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>releaseShared(int arg)</code> æ–¹æ³•é‡Šæ”¾å…±äº«é”ã€‚</p><p><code>releaseShared</code> é¦–å…ˆä¼šå°è¯•é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è§£é”ä¸€ä¸ªæˆ–å¤šä¸ªåç»§çº¿ç¨‹èŠ‚ç‚¹ã€‚é‡Šæ”¾å…±äº«é”å’Œé‡Šæ”¾ç‹¬äº«é”æµç¨‹å¤§ä½“ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºï¼š</p><p>å¯¹äºç‹¬äº«æ¨¡å¼ï¼Œå¦‚æœéœ€è¦ <code>SIGNAL</code>ï¼Œé‡Šæ”¾ä»…ç›¸å½“äºè°ƒç”¨å¤´èŠ‚ç‚¹çš„ <code>unparkSuccessor</code>ã€‚</p><h4 id="è·å–å¯ä¸­æ–­çš„å…±äº«é”"><a class="markdownIt-Anchor" href="#è·å–å¯ä¸­æ–­çš„å…±äº«é”"></a> è·å–å¯ä¸­æ–­çš„å…±äº«é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>acquireSharedInterruptibly(int arg)</code> æ–¹æ³•è·å–å¯ä¸­æ–­çš„å…±äº«é”ã€‚</p><p><code>acquireSharedInterruptibly</code> æ–¹æ³•ä¸ <code>acquireInterruptibly</code> å‡ ä¹ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚</p><h4 id="è·å–è¶…æ—¶ç­‰å¾…å¼çš„å…±äº«é”"><a class="markdownIt-Anchor" href="#è·å–è¶…æ—¶ç­‰å¾…å¼çš„å…±äº«é”"></a> è·å–è¶…æ—¶ç­‰å¾…å¼çš„å…±äº«é”</h4><p><code>AQS</code> ä¸­ä½¿ç”¨ <code>tryAcquireSharedNanos(int arg)</code> æ–¹æ³•è·å–è¶…æ—¶ç­‰å¾…å¼çš„å…±äº«é”ã€‚</p><p><code>tryAcquireSharedNanos</code> æ–¹æ³•ä¸ <code>tryAcquireNanos</code> å‡ ä¹ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚</p><h1 id="reentrantlock"><a class="markdownIt-Anchor" href="#reentrantlock"></a> <code>ReentrantLock</code></h1><blockquote><p><code>ReentrantLock</code> ç±»æ˜¯ <code>Lock</code> æ¥å£çš„å…·ä½“å®ç°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯é‡å…¥é”ã€‚ä¸å†…ç½®é” <code>synchronized</code> ä¸åŒï¼Œ<code>ReentrantLock</code> æä¾›äº†ä¸€ç»„æ— æ¡ä»¶çš„ã€å¯è½®è¯¢çš„ã€å®šæ—¶çš„ä»¥åŠå¯ä¸­æ–­çš„é”æ“ä½œï¼Œæ‰€æœ‰è·å–é”ã€é‡Šæ”¾é”çš„æ“ä½œéƒ½æ˜¯æ˜¾å¼çš„æ“ä½œã€‚</p></blockquote><h2 id="ç‰¹æ€§"><a class="markdownIt-Anchor" href="#ç‰¹æ€§"></a> ç‰¹æ€§</h2><ul><li><p><code>ReentrantLock</code> æä¾›äº†ä¸ <code>synchronized</code> ç›¸åŒçš„äº’æ–¥æ€§ã€å†…å­˜å¯è§æ€§å’Œå¯é‡å…¥æ€§ã€‚</p></li><li><p><code>ReentrantLock</code> æ”¯æŒå…¬å¹³é”å’Œ**éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰**ä¸¤ç§æ¨¡å¼ã€‚</p></li><li><p><code>ReentrantLock</code> å®ç°äº† <code>Lock</code> æ¥å£ï¼Œæ”¯æŒäº† <code>synchronized</code> æ‰€ä¸å…·å¤‡çš„çµæ´»æ€§ã€‚</p><ul><li><p><code>synchronized</code> æ— æ³•ä¸­æ–­ä¸€ä¸ªæ­£åœ¨ç­‰å¾…è·å–é”çš„çº¿ç¨‹</p></li><li><p><code>synchronized</code> æ— æ³•åœ¨è¯·æ±‚è·å–ä¸€ä¸ªé”æ—¶æ— ä¼‘æ­¢åœ°ç­‰å¾…</p></li></ul></li></ul><p><code>Lcok</code> æ¥å£</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Lock</span> </span>&#123;    <span class="hljs-comment">// è·å–é”</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span></span>;    <span class="hljs-comment">// é”æœªè¢«å¦ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œä¸”çº¿ç¨‹æ²¡æœ‰è¢«ä¸­æ–­çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½è·å–é”ã€‚</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-comment">// å°è¯•è·å–é”ï¼Œä»…åœ¨è°ƒç”¨æ—¶é”æœªè¢«å¦ä¸€ä¸ªçº¿ç¨‹æŒæœ‰çš„æƒ…å†µä¸‹ï¼Œæ‰è·å–è¯¥é”ã€‚</span>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span></span>;    <span class="hljs-comment">// å’Œ tryLock() ç±»ä¼¼ï¼ŒåŒºåˆ«ä»…åœ¨äºé™å®šæ—¶é—´ï¼Œå¦‚æœé™å®šæ—¶é—´å†…æœªè·å–åˆ°é”ï¼Œè§†ä¸ºå¤±è´¥ã€‚</span>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">(<span class="hljs-keyword">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-comment">// é‡Šæ”¾é”</span>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span></span>;    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªç»‘å®šåˆ° Lock å¯¹è±¡ä¸Šçš„ Condition å®ä¾‹</span>    <span class="hljs-function">Condition <span class="hljs-title">newCondition</span><span class="hljs-params">()</span></span>;&#125;</code></pre><h2 id="ç”¨æ³•"><a class="markdownIt-Anchor" href="#ç”¨æ³•"></a> ç”¨æ³•</h2><h3 id="æ„é€ æ–¹æ³•"><a class="markdownIt-Anchor" href="#æ„é€ æ–¹æ³•"></a> æ„é€ æ–¹æ³•</h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ReentrantLock</span><span class="hljs-params">()</span> </span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ReentrantLock</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> fair)</span> </span>&#123;&#125;</code></pre><ul><li><code>ReentrantLock()</code> - é»˜è®¤æ„é€ æ–¹æ³•ä¼šåˆå§‹åŒ–ä¸€ä¸ªéå…¬å¹³é”ï¼ˆ<code>NonfairSync</code>ï¼‰ï¼›</li><li><code>ReentrantLock(boolean)</code> - <code>new ReentrantLock(true)</code> ä¼šåˆå§‹åŒ–ä¸€ä¸ªå…¬å¹³é”ï¼ˆ<code>FairSync</code>ï¼‰ã€‚</li></ul><h3 id="lock-å’Œ-unlock-æ–¹æ³•"><a class="markdownIt-Anchor" href="#lock-å’Œ-unlock-æ–¹æ³•"></a> <code>lock</code> å’Œ <code>unlock</code> æ–¹æ³•</h3><ul><li><p><code>lock()</code> - <strong>æ— æ¡ä»¶è·å–é”</strong>ã€‚å¦‚æœå½“å‰çº¿ç¨‹æ— æ³•è·å–é”ï¼Œåˆ™å½“å‰çº¿ç¨‹è¿›å…¥ä¼‘çœ çŠ¶æ€ä¸å¯ç”¨ï¼Œç›´è‡³å½“å‰çº¿ç¨‹è·å–åˆ°é”ã€‚å¦‚æœè¯¥é”æ²¡æœ‰è¢«å¦ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œåˆ™è·å–è¯¥é”å¹¶ç«‹å³è¿”å›ï¼Œå°†é”çš„æŒæœ‰è®¡æ•°è®¾ç½®ä¸º <code>1</code>ã€‚</p></li><li><p><code>unlock()</code> - ç”¨äºé‡Šæ”¾é”ã€‚</p></li></ul><blockquote><p>ğŸ”” æ³¨æ„ï¼šè·å–é”æ“ä½œ <code>lock()</code> å¿…é¡»åœ¨ <code>try catch</code> å—ä¸­è¿›è¡Œï¼Œå¹¶ä¸”å°†é‡Šæ”¾é”æ“ä½œ <code>unlock()</code> æ”¾åœ¨ <code>finally</code> å—ä¸­è¿›è¡Œï¼Œä»¥ä¿è¯é”ä¸€å®šè¢«è¢«é‡Šæ”¾ï¼Œé˜²æ­¢æ­»é”çš„å‘ç”Ÿã€‚</p></blockquote><h3 id="trylock-æ–¹æ³•"><a class="markdownIt-Anchor" href="#trylock-æ–¹æ³•"></a> <code>tryLock</code> æ–¹æ³•</h3><p>ä¸æ— æ¡ä»¶è·å–é”ç›¸æ¯”ï¼Œ<code>tryLock</code> æœ‰æ›´å®Œå–„çš„å®¹é”™æœºåˆ¶ã€‚</p><ul><li><p><code>tryLock()</code> - å¯è½®è¯¢è·å–é”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å› <code>true</code>ï¼›å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› <code>false</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•æ— è®ºæˆè´¥éƒ½ä¼š<strong>ç«‹å³è¿”å›</strong>ï¼Œè·å–ä¸åˆ°é”ï¼ˆé”å·²è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼‰æ—¶ä¸ä¼šä¸€ç›´ç­‰å¾…ã€‚</p></li><li><p><code>tryLock(long, TimeUnit)</code> - å¯å®šæ—¶è·å–é”ã€‚å’Œ <code>tryLock()</code> ç±»ä¼¼ï¼ŒåŒºåˆ«ä»…åœ¨äºè¿™ä¸ªæ–¹æ³•åœ¨è·å–ä¸åˆ°é”æ—¶ä¼šç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œåœ¨æ—¶é—´æœŸé™ä¹‹å†…å¦‚æœè¿˜è·å–ä¸åˆ°é”ï¼Œå°±è¿”å› <code>false</code>ã€‚å¦‚æœå¦‚æœä¸€å¼€å§‹æ‹¿åˆ°é”æˆ–è€…åœ¨ç­‰å¾…æœŸé—´å†…æ‹¿åˆ°äº†é”ï¼Œåˆ™è¿”å› <code>true</code>ã€‚</p></li></ul><h3 id="lockinterruptibly-æ–¹æ³•"><a class="markdownIt-Anchor" href="#lockinterruptibly-æ–¹æ³•"></a> <code>lockInterruptibly</code> æ–¹æ³•</h3><p><code>lockInterruptibly()</code> - å¯ä¸­æ–­è·å–é”ã€‚å¯ä¸­æ–­è·å–é”å¯ä»¥åœ¨è·å¾—é”çš„åŒæ—¶ä¿æŒå¯¹ä¸­æ–­çš„å“åº”ã€‚å¯ä¸­æ–­è·å–é”æ¯”å…¶å®ƒè·å–é”çš„æ–¹å¼ç¨å¾®å¤æ‚ä¸€äº›ï¼Œéœ€è¦ä¸¤ä¸ª <code>try-catch</code> å—ï¼ˆå¦‚æœåœ¨è·å–é”çš„æ“ä½œä¸­æŠ›å‡ºäº† <code>InterruptedException</code> ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ <code>try-finally</code> åŠ é”æ¨¡å¼ï¼‰ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼šå‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶é€šè¿‡ <code>lock.lockInterruptibly()</code> è·å–æŸä¸ªé”æ—¶ï¼Œè‹¥çº¿ç¨‹ <code>A</code> è·å–åˆ°äº†é”ï¼Œåˆ™çº¿ç¨‹ <code>B</code> åªèƒ½ç­‰å¾…ã€‚è‹¥æ­¤æ—¶å¯¹çº¿ç¨‹ <code>B</code> è°ƒç”¨ <code>threadB.interrupt()</code> æ–¹æ³•èƒ½å¤Ÿä¸­æ–­çº¿ç¨‹ <code>B</code> çš„ç­‰å¾…è¿‡ç¨‹ã€‚ç”±äº <code>lockInterruptibly()</code> çš„å£°æ˜ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œæ‰€ä»¥ <code>lock.lockInterruptibly()</code> å¿…é¡»æ”¾åœ¨ <code>try</code> å—ä¸­æˆ–è€…åœ¨è°ƒç”¨ <code>lockInterruptibly()</code> çš„æ–¹æ³•å¤–å£°æ˜æŠ›å‡º <code>InterruptedException</code>ã€‚</p><blockquote><p>ğŸ”” æ³¨æ„ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è·å–äº†é”ä¹‹åï¼Œæ˜¯ä¸ä¼šè¢« <code>interrupt()</code> æ–¹æ³•ä¸­æ–­çš„ã€‚å•ç‹¬è°ƒç”¨ <code>interrupt()</code> æ–¹æ³•ä¸èƒ½ä¸­æ–­æ­£åœ¨è¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹ï¼Œåªèƒ½ä¸­æ–­é˜»å¡çŠ¶æ€ä¸­çš„çº¿ç¨‹ã€‚å› æ­¤å½“é€šè¿‡ <code>lockInterruptibly()</code> æ–¹æ³•è·å–æŸä¸ªé”æ—¶ï¼Œå¦‚æœæœªè·å–åˆ°é”ï¼Œåªæœ‰åœ¨ç­‰å¾…çš„çŠ¶æ€ä¸‹ï¼Œæ‰å¯ä»¥å“åº”ä¸­æ–­ã€‚</p></blockquote><h3 id="newcondition-æ–¹æ³•"><a class="markdownIt-Anchor" href="#newcondition-æ–¹æ³•"></a> <code>newCondition</code> æ–¹æ³•</h3><p><code>newCondition()</code> - è¿”å›ä¸€ä¸ªç»‘å®šåˆ° <code>Lock</code> å¯¹è±¡ä¸Šçš„ <code>Condition</code> å®ä¾‹ã€‚</p><h2 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h2><h3 id="reentrantlock-çš„æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#reentrantlock-çš„æ•°æ®ç»“æ„"></a> <code>ReentrantLock</code> çš„æ•°æ®ç»“æ„</h3><p>å®ƒæœ‰ä¸€ä¸ªæ ¸å¿ƒå­—æ®µï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;</code></pre><p><code>sync</code> - å†…éƒ¨æŠ½è±¡ç±» <code>ReentrantLock.Sync</code> å¯¹è±¡ï¼Œ<code>Sync</code> ç»§æ‰¿è‡ª <code>AQS</code>ã€‚å®ƒæœ‰ä¸¤ä¸ªå­ç±»ï¼š</p><ol><li><p><code>ReentrantLock.FairSync</code> - å…¬å¹³é”ã€‚</p></li><li><p><code>ReentrantLock.NonfairSync</code> - éå…¬å¹³é”ã€‚</p></li></ol><h3 id="è·å–é”å’Œé‡Šæ”¾é”"><a class="markdownIt-Anchor" href="#è·å–é”å’Œé‡Šæ”¾é”"></a> è·å–é”å’Œé‡Šæ”¾é”</h3><p><code>ReentrantLock</code> è·å–é”å’Œé‡Šæ”¾é”çš„æ¥å£ï¼Œä»è¡¨è±¡çœ‹ï¼Œæ˜¯è°ƒç”¨ <code>ReentrantLock.FairSync</code> æˆ– <code>ReentrantLock.NonfairSync</code> ä¸­å„è‡ªçš„å®ç°ï¼›ä»æœ¬è´¨ä¸Šçœ‹ï¼Œæ˜¯åŸºäº <code>AQS</code> çš„å®ç°ã€‚</p><ul><li><p><code>void lock()</code> è°ƒç”¨ <code>Sync</code> çš„ <code>lock()</code> æ–¹æ³•ã€‚</p></li><li><p><code>void lockInterruptibly()</code> ç›´æ¥è°ƒç”¨ <code>AQS</code> çš„ è·å–å¯ä¸­æ–­çš„ç‹¬å é” æ–¹æ³• <code>lockInterruptibly()</code>ã€‚</p></li><li><p><code>boolean tryLock()</code> è°ƒç”¨ <code>Sync</code> çš„ <code>nonfairTryAcquire()</code> ã€‚</p></li><li><p><code>boolean tryLock(long time, TimeUnit unit)</code> ç›´æ¥è°ƒç”¨ <code>AQS</code> çš„ è·å–è¶…æ—¶ç­‰å¾…å¼çš„ç‹¬å é” æ–¹æ³• <code>tryAcquireNanos(int arg, long nanosTimeout)</code>ã€‚</p></li><li><p><code>void unlock()</code> ç›´æ¥è°ƒç”¨ <code>AQS</code> çš„ é‡Šæ”¾ç‹¬å é” æ–¹æ³• <code>release(int arg)</code> ã€‚</p></li></ul><h1 id="reentrantreadwritelock"><a class="markdownIt-Anchor" href="#reentrantreadwritelock"></a> <code>ReentrantReadWriteLock</code></h1><blockquote><p><code>ReentrantReadWriteLock</code> ç±»æ˜¯ <code>ReadWriteLock</code> æ¥å£çš„å…·ä½“å®ç°ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>å¯é‡å…¥</strong>çš„è¯»å†™é”ã€‚<code>ReentrantReadWriteLock</code> ç»´æŠ¤äº†ä¸€å¯¹è¯»å†™é”ï¼Œå°†è¯»å†™é”åˆ†å¼€ï¼Œæœ‰åˆ©äºæé«˜å¹¶å‘æ•ˆç‡ã€‚</p></blockquote><p><code>ReentrantLock</code> å®ç°äº†ä¸€ç§æ ‡å‡†çš„äº’æ–¥é”ï¼šæ¯æ¬¡æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰ <code>ReentrantLock</code>ã€‚ä½†å¯¹äºç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§æ¥è¯´ï¼Œäº’æ–¥é€šå¸¸æ˜¯ä¸€ç§è¿‡äºå¼ºç¡¬çš„åŠ é”ç­–ç•¥ï¼Œå› æ­¤ä¹Ÿå°±ä¸å¿…è¦åœ°é™åˆ¶äº†å¹¶å‘æ€§ã€‚å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œè¯»æ“ä½œæ¯”å†™æ“ä½œé¢‘ç¹ï¼Œåªè¦ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½è¯»å–åˆ°æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”åœ¨è¯»æ•°æ®æ—¶ä¸ä¼šæœ‰å…¶å®ƒçº¿ç¨‹åœ¨ä¿®æ”¹æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è¿™ç§ç­–ç•¥å‡å°‘äº†äº’æ–¥åŒæ­¥ï¼Œè‡ªç„¶ä¹Ÿæå‡äº†å¹¶å‘æ€§èƒ½ï¼Œ<code>ReentrantReadWriteLock</code> å°±æ˜¯è¿™ç§ç­–ç•¥çš„å…·ä½“å®ç°ã€‚</p><h2 id="ç‰¹æ€§-2"><a class="markdownIt-Anchor" href="#ç‰¹æ€§-2"></a> ç‰¹æ€§</h2><ul><li><p><code>ReentrantReadWriteLock</code> é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚å¦‚æœæ˜¯å†™å¤šè¯»å°‘çš„åœºæ™¯ï¼Œç”±äº <code>ReentrantReadWriteLock</code> å…¶å†…éƒ¨å®ç°æ¯” <code>ReentrantLock</code> å¤æ‚ï¼Œæ€§èƒ½å¯èƒ½åè€Œè¦å·®ä¸€äº›ã€‚å¦‚æœå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚ç”±äº <code>ReentrantReadWriteLock</code> çš„è¯»å†™é”ï¼ˆ<code>ReadLock</code>ã€<code>WriteLock</code>ï¼‰éƒ½å®ç°äº† <code>Lock</code> æ¥å£ï¼Œæ‰€ä»¥è¦æ›¿æ¢ä¸º <code>ReentrantLock</code> ä¹Ÿè¾ƒä¸ºå®¹æ˜“ã€‚</p></li><li><p><code>ReentrantReadWriteLock</code> å®ç°äº† <code>ReadWriteLock</code> æ¥å£ï¼Œæ”¯æŒäº† <code>ReentrantLock</code> æ‰€ä¸å…·å¤‡çš„è¯»å†™é”åˆ†ç¦»ã€‚<code>ReentrantReadWriteLock</code> ç»´æŠ¤äº†ä¸€å¯¹è¯»å†™é”ï¼ˆ<code>ReadLock</code>ã€<code>WriteLock</code>ï¼‰ã€‚å°†è¯»å†™é”åˆ†å¼€ï¼Œæœ‰åˆ©äºæé«˜å¹¶å‘æ•ˆç‡ã€‚<code>ReentrantReadWriteLock</code> çš„åŠ é”ç­–ç•¥æ˜¯ï¼š<strong>å…è®¸å¤šä¸ªè¯»æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä½†æ¯æ¬¡åªå…è®¸ä¸€ä¸ªå†™æ“ä½œ</strong>ã€‚</p></li><li><p><code>ReentrantReadWriteLock</code> ä¸ºè¯»å†™é”éƒ½æä¾›äº†å¯é‡å…¥çš„åŠ é”è¯­ä¹‰ã€‚</p></li><li><p><code>ReentrantReadWriteLock</code> æ”¯æŒå…¬å¹³é”å’Œéå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰ä¸¤ç§æ¨¡å¼ã€‚</p></li></ul><p><code>ReadWriteLock</code> æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ReadWriteLock</span> </span>&#123;    <span class="hljs-comment">// è¿”å›ç”¨äºè¯»æ“ä½œçš„é”</span>    <span class="hljs-function">Lock <span class="hljs-title">readLock</span><span class="hljs-params">()</span></span>;    <span class="hljs-comment">// è¿”å›ç”¨äºå†™æ“ä½œçš„é”</span>    <span class="hljs-function">Lock <span class="hljs-title">writeLock</span><span class="hljs-params">()</span></span>;&#125;</code></pre><h2 id="ç”¨æ³•-2"><a class="markdownIt-Anchor" href="#ç”¨æ³•-2"></a> ç”¨æ³•</h2><h3 id="æ„é€ æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#æ„é€ æ–¹æ³•-2"></a> æ„é€ æ–¹æ³•</h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ReentrantReadWriteLock</span><span class="hljs-params">()</span> </span>&#123;&#125;<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ReentrantReadWriteLock</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> fair)</span> </span>&#123;&#125;</code></pre><ul><li><p><code>ReentrantReadWriteLock()</code> - é»˜è®¤æ„é€ æ–¹æ³•ä¼šåˆå§‹åŒ–ä¸€ä¸ªéå…¬å¹³é”ï¼ˆ<code>NonfairSync</code>ï¼‰ã€‚åœ¨éå…¬å¹³çš„é”ä¸­ï¼Œçº¿ç¨‹è·å¾—é”çš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚å†™çº¿ç¨‹é™çº§ä¸ºè¯»çº¿ç¨‹æ˜¯å¯ä»¥çš„ï¼Œä½†è¯»çº¿ç¨‹å‡çº§ä¸ºå†™çº¿ç¨‹æ˜¯ä¸å¯ä»¥çš„ï¼ˆè¿™æ ·ä¼šå¯¼è‡´æ­»é”ï¼‰ã€‚</p></li><li><p><code>ReentrantReadWriteLock(boolean)</code> - <code>new ReentrantLock(true)</code> ä¼šåˆå§‹åŒ–ä¸€ä¸ªå…¬å¹³é”ï¼ˆ<code>FairSync</code>ï¼‰ã€‚å¯¹äºå…¬å¹³é”ï¼Œç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹å°†ä¼˜å…ˆè·å¾—é”ã€‚å¦‚æœè¿™ä¸ªé”æ˜¯è¯»çº¿ç¨‹æŒæœ‰ï¼Œåˆ™å¦ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚å†™é”ï¼Œé‚£ä¹ˆå…¶ä»–è¯»çº¿ç¨‹éƒ½ä¸èƒ½è·å¾—è¯»é”ï¼Œç›´åˆ°å†™çº¿ç¨‹é‡Šæ”¾å†™é”ã€‚</p></li></ul><h3 id="ä½¿ç”¨å®ä¾‹"><a class="markdownIt-Anchor" href="#ä½¿ç”¨å®ä¾‹"></a> ä½¿ç”¨å®ä¾‹</h3><p><code>ReentrantReadWriteLock</code> ä¸ <code>ReentrantLock</code> ç”¨æ³•ä¸Šçš„å·®å¼‚ï¼Œä¸»è¦åœ¨äº<strong>è¯»å†™é”çš„é…åˆä½¿ç”¨</strong>ã€‚æœ¬æ–‡ä»¥ä¸€ä¸ªå…¸å‹ä½¿ç”¨åœºæ™¯æ¥è¿›è¡Œè®²è§£ã€‚</p><p>ç¤ºä¾‹ï¼šåŸºäº <code>ReentrantReadWriteLock</code> å®ç°ä¸€ä¸ªç®€å•çš„æœ¬åœ°ç¼“å­˜</p><pre><code class="hljs java"><span class="hljs-comment">/**</span><span class="hljs-comment"> * ç®€å•çš„æ— ç•Œç¼“å­˜å®ç°</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * ä½¿ç”¨ WeakHashMap å­˜å‚¨é”®å€¼å¯¹ã€‚WeakHashMap ä¸­å­˜å‚¨çš„å¯¹è±¡æ˜¯å¼±å¼•ç”¨ï¼ŒJVM GC æ—¶ä¼šè‡ªåŠ¨æ¸…é™¤æ²¡æœ‰è¢«å¼•ç”¨çš„å¼±å¼•ç”¨å¯¹è±¡ã€‚</span><span class="hljs-comment"> */</span><span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UnboundedCache</span>&lt;<span class="hljs-title">K</span>, <span class="hljs-title">V</span>&gt; </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;K, V&gt; cacheMap = <span class="hljs-keyword">new</span> WeakHashMap&lt;&gt;();    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantReadWriteLock cacheLock = <span class="hljs-keyword">new</span> ReentrantReadWriteLock();    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">get</span><span class="hljs-params">(K key)</span> </span>&#123;        cacheLock.readLock().lock();        V value;        <span class="hljs-keyword">try</span> &#123;            value = cacheMap.get(key);            String log = String.format(<span class="hljs-string">"%s è¯»æ•°æ® %s:%s"</span>, Thread.currentThread().getName(), key, value);            System.out.println(log);        &#125; <span class="hljs-keyword">finally</span> &#123;            cacheLock.readLock().unlock();        &#125;        <span class="hljs-keyword">return</span> value;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">put</span><span class="hljs-params">(K key, V value)</span> </span>&#123;        cacheLock.writeLock().lock();        <span class="hljs-keyword">try</span> &#123;            cacheMap.put(key, value);            String log = String.format(<span class="hljs-string">"%s å†™å…¥æ•°æ® %s:%s"</span>, Thread.currentThread().getName(), key, value);            System.out.println(log);        &#125; <span class="hljs-keyword">finally</span> &#123;            cacheLock.writeLock().unlock();        &#125;        <span class="hljs-keyword">return</span> value;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> V <span class="hljs-title">remove</span><span class="hljs-params">(K key)</span> </span>&#123;        cacheLock.writeLock().lock();        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-keyword">return</span> cacheMap.remove(key);        &#125; <span class="hljs-keyword">finally</span> &#123;            cacheLock.writeLock().unlock();        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span> </span>&#123;        cacheLock.writeLock().lock();        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-keyword">this</span>.cacheMap.clear();        &#125; <span class="hljs-keyword">finally</span> &#123;            cacheLock.writeLock().unlock();        &#125;    &#125;&#125;</code></pre><ul><li><p>ä½¿ç”¨ <code>WeakHashMap</code> è€Œä¸æ˜¯ <code>HashMap</code> æ¥å­˜å‚¨é”®å€¼å¯¹ã€‚<code>WeakHashMap</code> ä¸­å­˜å‚¨çš„å¯¹è±¡æ˜¯å¼±å¼•ç”¨ï¼Œ<code>JVM GC</code> æ—¶ä¼šè‡ªåŠ¨æ¸…é™¤æ²¡æœ‰è¢«å¼•ç”¨çš„å¼±å¼•ç”¨å¯¹è±¡ã€‚</p></li><li><p>å‘ Map å†™æ•°æ®å‰åŠ å†™é”ï¼Œå†™å®Œåï¼Œé‡Šæ”¾å†™é”ã€‚</p></li><li><p>å‘ Map è¯»æ•°æ®å‰åŠ è¯»é”ï¼Œè¯»å®Œåï¼Œé‡Šæ”¾è¯»é”ã€‚</p></li></ul><h2 id="åŸç†-2"><a class="markdownIt-Anchor" href="#åŸç†-2"></a> åŸç†</h2><h3 id="reentrantreadwritelock-çš„æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#reentrantreadwritelock-çš„æ•°æ®ç»“æ„"></a> <code>ReentrantReadWriteLock</code> çš„æ•°æ®ç»“æ„</h3><pre><code class="hljs java"><span class="hljs-comment">/** Inner class providing readlock */</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantReadWriteLock.ReadLock readerLock;<span class="hljs-comment">/** Inner class providing writelock */</span><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReentrantReadWriteLock.WriteLock writerLock;<span class="hljs-comment">/** Performs all synchronization mechanics */</span><span class="hljs-keyword">final</span> Sync sync;<span class="hljs-keyword">public</span> ReentrantReadWriteLock.<span class="hljs-function">WriteLock <span class="hljs-title">writeLock</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> writerLock; &#125;<span class="hljs-keyword">public</span> ReentrantReadWriteLock.<span class="hljs-function">ReadLock  <span class="hljs-title">readLock</span><span class="hljs-params">()</span>  </span>&#123; <span class="hljs-keyword">return</span> readerLock; &#125;</code></pre><ul><li><p><code>sync</code> - å†…éƒ¨ç±» <code>ReentrantReadWriteLock.Sync</code> å¯¹è±¡ã€‚ä¸ <code>ReentrantLock</code> ç±»ä¼¼ï¼Œå®ƒæœ‰ä¸¤ä¸ªå­ç±»ï¼š<code>ReentrantReadWriteLock.FairSync</code> å’Œ <code>ReentrantReadWriteLock.NonfairSync</code> ï¼Œåˆ†åˆ«è¡¨ç¤ºå…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°ã€‚</p></li><li><p><code>readerLock</code> - å†…éƒ¨ç±» <code>ReentrantReadWriteLock.ReadLock</code> å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€æŠŠè¯»é”ã€‚</p></li><li><p><code>writerLock</code> - å†…éƒ¨ç±» <code>ReentrantReadWriteLock.WriteLock</code> å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€æŠŠå†™é”ã€‚</p></li></ul><h3 id="è·å–é”å’Œé‡Šæ”¾é”-2"><a class="markdownIt-Anchor" href="#è·å–é”å’Œé‡Šæ”¾é”-2"></a> è·å–é”å’Œé‡Šæ”¾é”</h3><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReadLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Lock</span>, <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-comment">// è°ƒç”¨ AQS è·å–å…±äº«é”æ–¹æ³•</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>&#123;        sync.acquireShared(<span class="hljs-number">1</span>);    &#125;    <span class="hljs-comment">// è°ƒç”¨ AQS é‡Šæ”¾å…±äº«é”æ–¹æ³•</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;        sync.releaseShared(<span class="hljs-number">1</span>);    &#125;&#125;<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WriteLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Lock</span>, <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-comment">// è°ƒç”¨ AQS è·å–ç‹¬å é”æ–¹æ³•</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>&#123;        sync.acquire(<span class="hljs-number">1</span>);    &#125;    <span class="hljs-comment">// è°ƒç”¨ AQS é‡Šæ”¾ç‹¬å é”æ–¹æ³•</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>&#123;        sync.release(<span class="hljs-number">1</span>);    &#125;&#125;</code></pre><h1 id="condition"><a class="markdownIt-Anchor" href="#condition"></a> Condition</h1><p><code>Java 1.5</code> ä¹‹å‰ï¼Œä¸»è¦æ˜¯åˆ©ç”¨ <code>Object</code> ç±»ä¸­çš„ <code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> é…åˆ <code>synchronized</code> æ¥è¿›è¡Œçº¿ç¨‹é—´é€šä¿¡ã€‚</p><p><code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> éœ€è¦é…åˆ <code>synchronized</code> ä½¿ç”¨ï¼Œä¸é€‚ç”¨äº <code>Lock</code>ã€‚è€Œä½¿ç”¨ <code>Lock</code> çš„çº¿ç¨‹ï¼Œå½¼æ­¤é—´é€šä¿¡åº”è¯¥ä½¿ç”¨ <code>Condition</code>ã€‚<br />è¿™å¯ä»¥ç†è§£ä¸ºï¼Œä»€ä¹ˆæ ·çš„é”é…ä»€ä¹ˆæ ·çš„é’¥åŒ™ã€‚å†…ç½®é”ï¼ˆ<code>synchronized</code>ï¼‰é…åˆå†…ç½®æ¡ä»¶é˜Ÿåˆ—ï¼ˆ<code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code>ï¼‰ï¼Œæ˜¾å¼é”ï¼ˆ<code>Lock</code>ï¼‰é…åˆæ˜¾å¼æ¡ä»¶é˜Ÿåˆ—ï¼ˆ<code>Condition</code>ï¼‰ã€‚</p><h2 id="ç‰¹æ€§-3"><a class="markdownIt-Anchor" href="#ç‰¹æ€§-3"></a> ç‰¹æ€§</h2><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Condition</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">awaitUninterruptibly</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">long</span> <span class="hljs-title">awaitNanos</span><span class="hljs-params">(<span class="hljs-keyword">long</span> nanosTimeout)</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">await</span><span class="hljs-params">(<span class="hljs-keyword">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">awaitUntil</span><span class="hljs-params">(Date deadline)</span> <span class="hljs-keyword">throws</span> InterruptedException</span>;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">signal</span><span class="hljs-params">()</span></span>;    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">signalAll</span><span class="hljs-params">()</span></span>;&#125;</code></pre><p>å…¶ä¸­ï¼Œ<code>await</code>ã€<code>signal</code>ã€<code>signalAll</code> ä¸ <code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code> ç›¸å¯¹åº”ï¼ŒåŠŸèƒ½ä¹Ÿç›¸ä¼¼ã€‚é™¤æ­¤ä»¥å¤–ï¼Œ<code>Condition</code> ç›¸æ¯”å†…ç½®æ¡ä»¶é˜Ÿåˆ—ï¼ˆ<code>wait</code>ã€<code>notify</code>ã€<code>notifyAll</code>ï¼‰ï¼Œæä¾›äº†æ›´ä¸ºä¸°å¯Œçš„åŠŸèƒ½ï¼š</p><ul><li><p>æ¯ä¸ªé”ï¼ˆ<code>Lock</code>ï¼‰ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ª <code>Condition</code>ï¼Œè¿™æ„å‘³ç€é”çš„çŠ¶æ€æ¡ä»¶å¯ä»¥æœ‰å¤šä¸ªã€‚</p></li><li><p>æ”¯æŒå…¬å¹³çš„æˆ–éå…¬å¹³çš„é˜Ÿåˆ—æ“ä½œã€‚</p></li><li><p>æ”¯æŒå¯ä¸­æ–­çš„æ¡ä»¶ç­‰å¾…ï¼Œç›¸å…³æ–¹æ³•ï¼š<code>awaitUninterruptibly()</code>ã€‚</p></li><li><p>æ”¯æŒå¯å®šæ—¶çš„ç­‰å¾…ï¼Œç›¸å…³æ–¹æ³•ï¼š<code>awaitNanos(long)</code> ã€<code>await(long, TimeUnit)</code>ã€<code>awaitUntil(Date)</code>ã€‚</p></li></ul><h2 id="ç”¨æ³•-3"><a class="markdownIt-Anchor" href="#ç”¨æ³•-3"></a> ç”¨æ³•</h2><p>è¿™é‡Œä»¥ <code>Condition</code> æ¥å®ç°ä¸€ä¸ªæ¶ˆè´¹è€…ã€ç”Ÿäº§è€…æ¨¡å¼ã€‚</p><blockquote><p>ğŸ”” æ³¨æ„ï¼šäº‹å®ä¸Šï¼Œè§£å†³æ­¤ç±»é—®é¢˜ä½¿ç”¨ <code>CountDownLatch</code>ã€<code>Semaphore</code> ç­‰å·¥å…·æ›´ä¸ºä¾¿æ·ã€å®‰å…¨ã€‚</p></blockquote><p>æ¶ˆæ¯ç±»ï¼š</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Message</span> </span>&#123;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Lock lock = <span class="hljs-keyword">new</span> ReentrantLock();    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition consumeCondition = lock.newCondition();    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Condition produceCondition = lock.newCondition();    <span class="hljs-keyword">private</span> String message;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> state;    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> end;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">consume</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-comment">//lock</span>        lock.lock();        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-comment">// no new message wait for new message</span>            <span class="hljs-keyword">while</span> (!state) &#123;                consumeCondition.await();            &#125;            System.out.println(<span class="hljs-string">"consume message : "</span> + message);            state = <span class="hljs-keyword">false</span>;            <span class="hljs-comment">// message consumed, notify waiting thread</span>            produceCondition.signal();        &#125; <span class="hljs-keyword">catch</span> (InterruptedException ie) &#123;            System.out.println(<span class="hljs-string">"Thread interrupted - viewMessage"</span>);        &#125; <span class="hljs-keyword">finally</span> &#123;            lock.unlock();        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">(String message)</span> </span>&#123;        lock.lock();        <span class="hljs-keyword">try</span> &#123;            <span class="hljs-comment">// last message not consumed, wait for it be consumed</span>            <span class="hljs-keyword">while</span> (state) &#123;                produceCondition.await();            &#125;            System.out.println(<span class="hljs-string">"produce msg: "</span> + message);            <span class="hljs-keyword">this</span>.message = message;            state = <span class="hljs-keyword">true</span>;            <span class="hljs-comment">// new message added, notify waiting thread</span>            consumeCondition.signal();        &#125; <span class="hljs-keyword">catch</span> (InterruptedException ie) &#123;            System.out.println(<span class="hljs-string">"Thread interrupted - publishMessage"</span>);        &#125; <span class="hljs-keyword">finally</span> &#123;            lock.unlock();        &#125;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isEnd</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> end;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEnd</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> end)</span> </span>&#123;        <span class="hljs-keyword">this</span>.end = end;    &#125;&#125;</code></pre><p>ç”Ÿäº§è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MessageProducer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;    <span class="hljs-keyword">private</span> Message message;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MessageProducer</span><span class="hljs-params">(Message msg)</span> </span>&#123;        message = msg;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;        produce();    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span> </span>&#123;        List&lt;String&gt; msgs = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();        msgs.add(<span class="hljs-string">"Begin"</span>);        msgs.add(<span class="hljs-string">"Msg1"</span>);        msgs.add(<span class="hljs-string">"Msg2"</span>);        <span class="hljs-keyword">for</span> (String msg : msgs) &#123;            message.produce(msg);            <span class="hljs-keyword">try</span> &#123;                Thread.sleep(<span class="hljs-number">100</span>);            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;                e.printStackTrace();            &#125;        &#125;        message.produce(<span class="hljs-string">"End"</span>);        message.setEnd(<span class="hljs-keyword">true</span>);    &#125;&#125;</code></pre><p>æ¶ˆè´¹è€…ï¼š</p><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MessageConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;    <span class="hljs-keyword">private</span> Message message;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MessageConsumer</span><span class="hljs-params">(Message msg)</span> </span>&#123;        message = msg;    &#125;    <span class="hljs-meta">@Override</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">while</span> (!message.isEnd()) &#123; message.consume(); &#125;    &#125;&#125;</code></pre><p>æµ‹è¯•ï¼š</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LockConditionDemo</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;        Message msg = <span class="hljs-keyword">new</span> Message();        Thread producer = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> MessageProducer(msg));        Thread consumer = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> MessageConsumer(msg));        producer.start();        consumer.start();    &#125;&#125;</code></pre>]]></content>
    
    
    <categories>
      
      <category>å¹¶å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é”</tag>
      
      <tag>å¹¶å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Overview</title>
    <link href="/2018/12/28/overview/"/>
    <url>/2018/12/28/overview/</url>
    
    <content type="html"><![CDATA[<p>During the past six months, I was focusing on preparing for the entrance exam of postgraduate schools, owing to that, I could barely write posts or sorting out my blog. Whatâ€™s worse, I figured out that I got my server expired and lost most of my posts that I have written in the almost past three years, in which I have made some records in my study and lives, including programming thoughts and life experiences.</p><p>As youâ€™ll find out, I plan to migrate my blog from cloud server to git pages, itâ€™s kind of a large project. Thanks to the exam which I have mentioned above, actually I did not expect that I could spend a surprisingly large amount of time in concentrating on one thing. Itâ€™s helpful in building up a hard-working, persistent personality.</p><p>In short, now that Iâ€™ve finished my exam, I plan to get a vacation for a couple of weeks and then back to my blogâ€™s migration.</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
